#include <gtest/gtest.h>

#include "superpositeur/Circuit.hpp"
#include "superpositeur/DefaultOperations.hpp"

namespace superpositeur {
namespace {
Circuit randomCircuit() {
    using namespace std::complex_literals;

    Circuit c;
    c.addInstruction(CircuitInstruction({ Matrix{ { -0.16591497612394399 + 0.3460932058948201i, 0.3174409161425393 + 0.17749726186381706i, -0.4521073193201138 + 0.4449696870803347i, 0.4000581205648322 + -0.39745710446237237i }, { 0.7367914361283467 + -0.4485516276998958i, -0.024063266400285943 + 0.19826406087182868i, -0.31256831698083226 + 0.2878664535526287i, 0.10602099871122755 + 0.15571010976664024i }, { -0.0002500218597094455 + -0.2401719887447523i, -0.5477874750507319 + -0.02369238006545949i, -0.22327189579158588 + -0.21745622360579855i, -0.08577446547690765 + -0.7329325337660517i }, { -0.2203411486685953 + -0.048976136860753i, -0.26785155693626433 + -0.67487880757762i, -0.43493322378616067 + 0.3615666518739321i, -0.15147493871362708 + 0.28107515861844634i } } }, { QubitIndex{ 5 }, QubitIndex{ 4 } }));

    c.addInstruction(CircuitInstruction({ Matrix{ { 0.2877691216410616 + -0.8583275823360679i, 0.34951435090224353 + 0.24145892517038153i }, { -0.10474806185973923 + 0.4116922850475593i, 0.7809888924673383 + 0.4578139969590136i } } }, { QubitIndex{ 1 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 5 }, QubitIndex{ 7 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 1 }, QubitIndex{ 5 } }));

    c.addInstruction(CircuitInstruction({ Matrix{ { -0.01131556289565916 + 0.1914631048094403i, -0.3797906685061611 + 0.5693043522764929i, 0.4591688395924552 + 0.18250048525512688i, -0.20589072573274514 + -0.4564340026925847i }, { -0.7742969890236567 + 0.2445692587870763i, -0.2503531738883983 + -0.1505429878517005i, 0.11825198271294662 + -0.32379607966511603i, -0.269036948829449 + 0.2531834021424518i }, { 0.19285863705173475 + 0.2611559690655139i, 0.06351007007452947 + -0.31143199021303924i, 0.3760832129779047 + 0.5906591729308106i, -0.3414929212803724 + 0.43202480886099287i }, { 0.012545179206109605 + 0.4453196743834803i, 0.3629339879934478 + -0.4621333211938085i, 0.32556465024739134 + -0.2017942860071139i, 0.18019319072851403 + -0.5263666578977813i } } }, { QubitIndex{ 5 }, QubitIndex{ 3 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 5 }, QubitIndex{ 4 } }));

    c.addInstruction(CircuitInstruction({ Matrix{ { 0.05056111933257367 + 0.09850557214733285i, 0.014992533453142437 + -0.04699569291296013i, -0.05259453072126134 + 0.06782992123660059i, -0.0775664136264437 + 0.035733339761077974i }, { -0.1888008721506757 + -0.08162304635043352i, 0.1154502316723594 + 0.038667920378038935i, 0.043981127692650814 + -0.22910042829379404i, 0.1124592660362916 + 0.019804615766731495i }, { -0.05468939879601019 + -0.05190226089724435i, -0.05796489382899814 + 0.07199132681803767i, -0.005791226083129354 + 0.0027092205131137716i, 0.012851603080478056 + -0.0021038108152508844i }, { -0.026549701485931866 + 0.053625476333887694i, 0.036137344037261224 + 0.07655701558075577i, -0.13337710052303245 + -0.021369925402947517i, -0.03376374748690796 + -0.034687796851042084i } }, Matrix{ { 0.04861357298825294 + -0.08253530169738686i, 0.040996252493467805 + -0.02071939040119652i, -0.02947722958930549 + 0.059556558311576975i, -0.049024540360023 + 0.1801451113998937i }, { 0.04044361094527975 + 0.06629586075042287i, 0.13745933179313977 + 0.030486678830270557i, 0.05473006079952934 + 0.14667352493150565i, -0.10817188146948789 + -0.05009178492907318i }, { -0.14065024464167178 + -0.08025377760746281i, 0.14523079230125532 + -0.05459056172571633i, 0.0703313307677279 + -0.026245628313473962i, -0.07585600639438451 + -0.02345284965802809i }, { -0.05572231123507858 + 0.14592401758737103i, -0.06789091245819269 + 0.06235213273505519i, 0.07537313354014082 + -0.26768278212085633i, 0.044293749464720526 + 0.15335629522690505i } }, Matrix{ { -0.08990091216304402 + 0.02211903820678072i, 0.10159844014316269 + 0.06457265471831411i, 0.08399678561117882 + -0.0834875436731621i, -0.056855084261780334 + 0.03354909244148388i }, { 0.05728769005810192 + 0.04055417090029234i, 0.01321371572302424 + 0.12280221840086557i, 0.1786298044557794 + 0.03623744237744831i, 0.11165291714190055 + -0.07120780475290611i }, { 0.052758175899950265 + 0.08157754214710489i, 0.08134291418636545 + -0.11550840718383587i, -0.11424377174157678 + 0.0844458921788972i, -0.04336427261944087 + 0.14646877791442386i }, { 0.09128080374087709 + 0.06332746684070281i, -0.01263705933938157 + -0.005923648070432674i, -0.079335837074197 + -0.07543435988924005i, 0.06885443755142154 + 0.1938060068400094i } }, Matrix{ { 0.07972131858838954 + -0.01109510073893923i, 0.15406110351504237 + -0.10559323268782238i, 0.08971842978905367 + 0.06836044114237536i, 0.13751813284074435 + 0.08228735802648539i }, { 0.11955269820564021 + -0.010799128402101232i, 0.05687929994040028 + -0.06683550749517489i, -0.10021213151591947 + 0.030656257101292564i, -0.15181025948776128 + -0.07787959682993632i }, { -0.03115527634759956 + 0.1395448263044833i, -0.023324182685560482 + 0.08260369183932564i, 0.047857114414180654 + 0.06295316344093915i, 0.028579915284991434 + -0.027658574513042274i }, { -0.010404217466385425 + 0.17801386959435533i, 0.08624852675244107 + -0.05790033730636337i, -0.007095335263156183 + 0.049682855094652756i, 0.15824801421232634 + 0.010784774294127185i } }, Matrix{ { 0.10236670620330558 + 0.07507220211071294i, -0.20765452882399457 + 0.05828291914931008i, 0.12954996893598067 + -0.014770120993261747i, -0.05160457063085591 + -0.04753087655782028i }, { -0.0034040175980495076 + 0.08589112937406188i, 0.06071812997490312 + -0.006733924518591429i, 0.0899842758024664 + -0.047415876798151985i, 0.1793415993258962 + 0.025195956699085743i }, { -0.02026155225467479 + -0.08953393723222454i, 0.07114495808256847 + -0.15957451286643523i, 0.0720383469290423 + 0.07133839504072906i, -0.08157454968313892 + 0.03933990494535631i }, { 0.017894489418979056 + -0.08767320592953873i, 0.2419963985393695 + -0.1764385883632064i, 0.039613631349879594 + 0.0247432802241428i, -0.0377252715438509 + 0.24598184466644146i } }, Matrix{ { 0.004767128689438397 + 0.04038599128790108i, 0.06404467908800665 + 0.029562258806674034i, -0.06153286142725773 + -0.06525592071062453i, -0.1324541046672984 + 0.03400770346223715i }, { -0.08988314168146061 + 0.16515350178257307i, 0.023731097189591727 + -0.009819713223833343i, -0.05581673233620523 + -0.019440300281379327i, 0.2374301710353933 + -0.10261402402043306i }, { 0.17653588441016504 + 0.06948532199817911i, 0.04982062154656857 + 0.1275552305005183i, 0.07395401548157192 + 0.0319071980040563i, -0.10616241988369488 + 0.06622432868315305i }, { -0.0127634910645485 + 0.13432807484419354i, 0.02370732428782384 + 0.10096380352916941i, -0.018839698630286547 + -0.006906522630455598i, 0.008698428775233453 + 0.046133141796430056i } }, Matrix{ { 0.183344409006318 + 0.1263077328122787i, -0.02792015471998062 + 0.0016783694128771898i, -0.024178856680223487 + -0.10222727333061148i, 0.0736059605075767 + -0.01443796817849964i }, { 0.09827277562350499 + 0.0307445780685596i, -0.0765184322166781 + -0.16012867075391352i, -0.060272582274488805 + 0.046584741970690104i, 0.046681798737140005 + 0.06585353961605868i }, { -0.04949211098725892 + -0.006665257918100238i, 0.07049280379943548 + 0.13878127307725285i, -0.0561850797681163 + 0.07100026982575888i, -0.05065931038065849 + 0.022728685518796636i }, { 0.18669735694950743 + -0.021123288411309605i, 0.024355196134340545 + 0.07206512054520317i, 0.053938535199395864 + -0.10104966822126968i, -0.08621054417859828 + -0.010622381639407872i } }, Matrix{ { -0.024150683623899254 + -0.08637756663222403i, -0.07638380743592851 + -0.1384420867398089i, -0.0036784870308649853 + 0.12541891981307446i, -0.031671126749340486 + 0.04576852973940721i }, { 0.12092052044218858 + -0.04892289518295471i, -0.1570374605290752 + -0.06477107998448318i, -0.14219463487643036 + -0.12526115222691064i, -0.09094862048726543 + -0.06692728110783369i }, { -0.15150324514826644 + -0.05892715190801818i, -0.08733183844311515 + 0.03146419515404323i, -0.07289182838482758 + 0.09055103701549748i, -0.006925711856287939 + -0.05991114439243465i }, { -0.0064555366626163685 + -0.024542281048724232i, 0.0018891812700695691 + 0.0735529187642461i, -0.12752941942303744 + 0.17994259402457574i, 0.13305940508072925 + 0.11102153308356834i } }, Matrix{ { 0.02840189641583302 + -0.018529446831579966i, -0.053765920706543194 + 0.15602521478992987i, 0.1594296578904299 + -0.05499562953199802i, 0.11644277426410521 + 0.026458309336841963i }, { -0.08465592826040759 + 0.2120313814940861i, -0.10410123728210793 + -0.00579859461035523i, -0.174972453018208 + 0.0539957146193972i, -0.035812435467683076 + 0.2546315192314775i }, { 0.12427587509831037 + 0.00026288273983909345i, -0.12612594289129242 + -0.017736505712313312i, 0.0058848886713972195 + 0.007252302726769668i, -0.06562628026565843 + 0.1462999557185419i }, { -0.029223889556731688 + -0.14724418762100347i, 0.10568170933321559 + 0.009017454374079201i, 0.1745664132314271 + 0.005560477401123214i, 0.023640069001777314 + -0.026878097548002397i } }, Matrix{ { -0.20861809325792965 + 0.07271133113025667i, 0.14976615499377588 + 0.1684864300392751i, 0.19927171410404676 + -0.06954335322179202i, -0.014951828152922782 + 0.10713664417347975i }, { -0.14176493698776052 + -0.1292697481873311i, -0.04321479854286255 + -0.05345314385385857i, -0.05307928598240738 + 0.001071343983354489i, -0.029419818010031067 + -0.013247257498053729i }, { 0.09773839004399157 + 0.1121864270781485i, 0.07772954402684565 + 0.0272402991830573i, 0.0925228178025652 + -0.006487844629344199i, -0.12756324886092862 + 0.04663170320087141i }, { 0.11728609184390057 + 0.04577518505968902i, -0.07800024010959397 + -0.0022093305212592396i, 0.016315736483722275 + 0.10732186617974794i, -0.037021068603520925 + 0.15396839368936996i } }, Matrix{ { -0.1874814405691096 + -0.028044708296842035i, 0.08966035667746315 + -0.11686014387544776i, 0.006104959209690121 + -0.01602295701033863i, -0.011771325095123275 + -0.0013761849500189898i }, { 0.017573661521878163 + 0.1147981730005261i, 0.024393926990760217 + -0.07556933509088415i, 0.07976756390152318 + -0.0447809378707031i, -0.04745509039980934 + -0.0010200919851151334i }, { 0.09210250266580243 + -0.07406103568604368i, 0.045082137450760354 + -0.02433331906770492i, -0.11961510849498766 + -0.1303096658721716i, 0.15881779613123287 + 0.013910203331782191i }, { 0.13124223173122815 + 0.002428578547328844i, -0.05119455258464799 + -0.022339419360324804i, 0.06375715964667569 + -0.0865920032772918i, -0.034598646521716715 + -0.017325648296421612i } }, Matrix{ { 0.005929978242492763 + -0.06256623035389389i, 0.04206820162031145 + 0.06175066376697915i, 0.1276814692757185 + 0.004807855526706529i, -0.05684596489677972 + -0.07096710609971127i }, { 0.12426648483570364 + -0.1074453211821244i, 0.04895253875388521 + 0.14311805936095412i, -0.09650161470993004 + -0.11648315083180881i, 0.011942501140585296 + 0.01592459019894979i }, { -0.029675160776354827 + -0.021707330501738033i, 0.16458053228595348 + 0.04560833458885016i, 0.033407651688421365 + 0.1550677758383402i, 0.02993979597126407 + 0.006476889778155657i }, { 0.10185543222329702 + -0.062227629344907616i, 0.1917434331489932 + -0.025038674180173474i, -0.002441203562575828 + -0.0046867280752702425i, 0.09910554978426672 + -0.048112149181195094i } }, Matrix{ { 0.023937593911578677 + -0.0035444538766020973i, -0.016001879787699836 + 0.03554241712809634i, 0.03862993954675583 + 0.09144020482221489i, 0.13505763879534433 + 0.032413392401430256i }, { 0.07135946653484453 + -0.024691012033695985i, -0.0824533254059473 + -0.10572854481600852i, -0.04186774737532722 + -0.056379919369352514i, -0.14598854890215635 + 0.03441749015829474i }, { 0.018046203058646303 + 0.10612783554859288i, 0.04715448774311746 + -0.01908817103866615i, 0.1504329526980121 + 0.04558192416658187i, -0.06832333793066848 + -0.03466301479594663i }, { -0.06776251222995015 + 0.16248940144172033i, 0.010671162212542036 + 0.18469810003482967i, -0.17815440347083292 + 0.03594302186981855i, 0.09370732220947885 + -0.0001503840256245237i } }, Matrix{ { 0.011147886843548829 + -0.02834133719814084i, -0.0873533813088251 + 0.0405868604185728i, -0.0171093416081988 + -0.020104168147630143i, 0.025322734534902965 + 0.06217026367327099i }, { -0.06534135367130753 + 0.07128209897098964i, -0.02142300040071458 + 0.019988944125343588i, 0.08335055251831261 + -0.027768277452584974i, 0.11376500961178228 + 0.037989795131847456i }, { 0.06171017564939313 + 0.04929327890361823i, 0.022923038828874753 + -0.10118968262623752i, 0.027863553400622264 + 0.15732240708630305i, 0.06610321125071858 + 0.13236859454301975i }, { 0.11777150954041402 + 0.01214387974923512i, 0.0402831953300031 + 0.021997848268647008i, -0.1104133718227841 + 0.03257331773108821i, 0.03895497801141676 + 0.015161748134992973i } }, Matrix{ { -0.01962383443116284 + -0.050585901547972316i, -0.013647166240425397 + 0.017668718355820512i, 0.021703442518257506 + 0.1130516167368204i, -0.07251032478865556 + 0.07319547649116839i }, { 0.034246141882437554 + 0.07225819742873264i, -0.012392381858201325 + -0.3096756080989358i, 0.10225400516536984 + 0.08216583043815356i, 0.004028950356506405 + -0.04447692663442267i }, { -0.0952772008188736 + 0.04132658367959343i, -0.01603911579599872 + -0.06253380342346287i, -0.005029038122219407 + 0.15871587978297244i, -0.061265543138211115 + -0.12933448672490158i }, { -0.056683830099410186 + 0.1494246404319944i, -0.05020511450340691 + -0.027102091106591578i, 0.0151140108886349 + 0.11553413786223246i, -0.045962481133923344 + -0.05950836297429263i } }, Matrix{ { -0.029422790862943683 + -0.07380832898132621i, -0.05361697400100365 + -0.05993546832370617i, -0.056717649214670283 + -0.03693351798103653i, 0.0003324471185960691 + 0.14672999265098233i }, { 0.03447458289783022 + 0.028887228890985137i, 0.009969753951211366 + -0.023792918197022655i, -0.07300262971510724 + -0.06527363620642879i, 0.1318983157558511 + 0.03887275576890498i }, { 0.029028644646721086 + 0.0350076912603653i, 0.08071166233655569 + 0.03582113425855829i, -0.03334023121097888 + -0.051164140528419125i, 0.010093826002612763 + 0.14236819296317546i }, { -0.03744556675773134 + -0.04238644479261236i, -0.05236317946180186 + -0.04863651001673837i, -0.001390337956497979 + -0.053295978620861925i, 0.11280989485579007 + -0.133057112063877i } } }, { QubitIndex{ 5 }, QubitIndex{ 7 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 2 }, QubitIndex{ 7 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 3 }, QubitIndex{ 4 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 2 }, QubitIndex{ 6 } }));

    c.addInstruction(CircuitInstruction({ Matrix{ { -0.7220832226975185 + -0.6602700387884575i, -0.10910002780151692 + -0.17531822298541197i }, { -0.11690213425656837 + -0.17021511796345726i, 0.31555417637239164 + 0.9261675152999522i } } }, { QubitIndex{ 5 } }));

    c.addInstruction(CircuitInstruction({ Matrix{ { 0.15896504302742984 + -0.18504601970544798i, 0.49981637853258065 + -0.0043800553415433985i }, { -0.1615558626006916 + -0.3390614440908458i, -0.009932249238559843 + -0.09233297666938532i } }, Matrix{ { 0.29290906258097016 + 0.18232491708021378i, 0.005090608020362319 + -0.28595800646741665i }, { -0.0021060664775596756 + -0.4643177581409274i, -0.33007974398908674 + 0.13265012483312408i } }, Matrix{ { 0.398870954210347 + 0.21821861283413307i, 0.013431025463418844 + 0.46890468407512226i }, { 0.0872055191613023 + 0.036297929007268324i, 0.24104720799741228 + -0.18055253919969122i } }, Matrix{ { 0.062027096146775935 + 0.4102359340833353i, 0.20075258774251162 + -0.32202723236741926i }, { -0.11316834237348757 + -0.25338491746336245i, 0.2614193606258796 + -0.10047682756866426i } } }, { QubitIndex{ 3 } }));

    c.addInstruction(CircuitInstruction({ Matrix{ { 0.1969963299676123 + -0.23490086323390125i, 0.27162980144037213 + -0.2114445521717701i }, { -0.27860611569670435 + -0.3623676229057401i, 0.23258714354045212 + 0.06574039000406695i } }, Matrix{ { 0.21904560232431336 + 0.2338435435661143i, -0.3941247524657805 + -0.0355203688846133i }, { 0.2420918543152064 + 0.12267233639815281i, 0.1512039579066305 + -0.14248873004526913i } }, Matrix{ { -0.125434196867318 + -0.24551516837526183i, -0.3642992783216163 + -0.30165964213560803i }, { -0.20144080762747826 + 0.12260534415809161i, 0.368637442151284 + -0.3767379694362763i } }, Matrix{ { -0.05190073200090224 + -0.21415335649242478i, -0.0852946971962834 + 0.2543216082426451i }, { 0.4588860849503756 + -0.36056612667978216i, 0.07945808266645599 + -0.2086201427952022i } } }, { QubitIndex{ 5 } }));

    c.addInstruction(CircuitInstruction({ Matrix{ { 0.11310262276524652 + 0.031761754716839785i, -0.6261483230538222 + 0.23484782227112092i, -0.45330038223924796 + 0.07560956590399875i, 0.4375963864065519 + -0.36918169670477424i }, { -0.025432973255489804 + 0.5258390334344135i, -0.07744060956884814 + -0.38937796812211684i, -0.44047640326235016 + 0.3887432014581641i, -0.4689240898320137 + -0.014271796774835227i }, { -0.5435930908592436 + 0.15382367766078642i, -0.5614439131228635 + 0.2408914724377218i, 0.29011513591141225 + -0.2536121261944198i, -0.3905611270673872 + 0.081073806319786i }, { -0.5246555379778267 + 0.33856588233204943i, 0.14799978511683043 + 0.004541186137983266i, 0.2531119389693041 + 0.48073866310931246i, 0.5392489458823039 + 0.047121221669697566i } } }, { QubitIndex{ 5 }, QubitIndex{ 7 } }));

    c.addInstruction(CircuitInstruction({ Matrix{ { -0.4664271684446437 + -0.27036836581845836i, 0.4333256027112104 + 0.21604888769711783i, 0.13287524135165357 + 0.5233409122707106i, -0.39586557431359715 + 0.1632401614613849i }, { -0.6904139554702592 + 0.08205772317704765i, 0.08144925675444778 + -0.08719166990588344i, -0.33727566915474294 + -0.05771558731822776i, 0.4216687623100519 + -0.4554867948697556i }, { -0.11307231452280375 + 0.2340449877133217i, -0.4114402522528532 + 0.6576719492784915i, 0.338187794385024 + 0.26312906722516227i, 0.375430820469254 + 0.07788408133281498i }, { -0.3905491745227017 + -0.0764897454214745i, -0.34881347255839656 + 0.16682061848904256i, 0.2388790020598323 + -0.5922004946310329i, -0.523322847932674 + -0.10241726953485032i } } }, { QubitIndex{ 3 }, QubitIndex{ 7 } }));

    c.addInstruction(CircuitInstruction({ Matrix{ { -0.11039604797103375 + 0.4131445074158337i, 0.6495529622025651 + 0.6286535435980442i }, { 0.8102967730792413 + -0.4006787592596762i, -0.020824258241110782 + 0.4271323233896053i } } }, { QubitIndex{ 3 } }));

    c.addInstruction(CircuitInstruction({ Matrix{ { 0.13322028190979585 + 0.02493916941001782i, -0.13422600773807003 + 0.02193731714516971i, -0.13356405952357644 + -0.1364881506512292i, -0.07529927371945562 + 0.07167128956000603i }, { -0.09445811679023924 + 0.0001327905411782006i, 0.013185171797654055 + -0.041992242536921666i, -0.07145523900132113 + -0.036213435796072564i, -0.07625915547948876 + 0.10216659897035298i }, { 0.035187307299926064 + 0.07281271102780333i, 0.12372723677551645 + -0.10833077572051214i, -0.020423294732345082 + -0.07368500788041872i, -0.06660568882978096 + 0.06384448222915429i }, { 0.18993346174756198 + -0.06251569707513674i, -0.17677466688291216 + -0.07482504757217462i, -0.017778037337330497 + -0.027457101695409974i, 0.1025268876762018 + -0.09905597224844687i } }, Matrix{ { -0.10541030375652774 + -0.047435453921412685i, 0.0681921457606715 + 0.02056367366355983i, 0.08237958055788802 + -0.1740777800813024i, 0.015371277744563651 + 0.06750824127594934i }, { -0.012262925850509707 + 0.12483835609457496i, -0.07184284333952266 + -0.18525264463676783i, -0.03956229686281397 + 0.037339759876428166i, -0.04615810339181897 + -0.09494729521880908i }, { 0.005803321014050598 + -0.12158650914250578i, 0.11470004248363776 + -0.043747635782425486i, 0.012254228802339572 + 0.0840405705628144i, -0.034170957833129144 + -0.039420793561934044i }, { -0.0949021624337491 + -0.0536234544973755i, 0.19440182806848122 + -0.011188292558192103i, -0.07462154831876477 + 0.035033366282188345i, 0.13729421331651318 + -0.03027174522557689i } }, Matrix{ { 0.08191073717752032 + -0.10675453701376302i, 0.01364123354097982 + -0.07794231834376611i, -0.05294798956064845 + -0.015731512171553625i, -0.06203041943319429 + 0.005144145742311975i }, { -0.08097106266810612 + -0.06943822111446099i, -0.0045263253586941225 + 0.030044763128022095i, 0.06864704182365342 + 0.19316500137347725i, -0.0497163130471592 + 0.05556961599229082i }, { -0.06644912368431691 + -0.07181443934033553i, 0.03490101724685799 + 0.07272483326617489i, 0.009700981487381813 + -0.013503322111333399i, -0.2774718891658208 + -0.04798541200052205i }, { 0.06580307599855234 + 0.042726304235426046i, 0.1799837810245212 + -0.11354131788356929i, 0.0805617402861985 + 0.07693367878241085i, -0.0523959608296739 + -0.05872527817729619i } }, Matrix{ { -0.09838843659966534 + -0.07432975660554628i, -0.15684760369328787 + -0.02360203516681329i, 0.17178512107428554 + -0.06628899295932038i, -0.0762879541111941 + -0.011852833521305632i }, { -0.06251741177984801 + 0.08067147772984003i, 0.06465465884250328 + -0.06345760747994683i, 0.008620556928885538 + 0.041965418164102944i, 0.02377905569428324 + 0.17156212549637717i }, { 0.0233569795373722 + -0.064924197480276i, 0.005514083764876245 + -0.023458239856834734i, 0.02448180633767349 + 0.07859678127987371i, 0.08815587052127317 + -0.17697172649328516i }, { -0.04605417698419622 + -0.13094520711742574i, 0.10834430860469677 + -0.0760423673881663i, -0.0420193727910127 + -0.09290893650397826i, -0.060637202003319464 + 0.07495587430710997i } }, Matrix{ { -0.06487300320892288 + -0.0023858240694394216i, 0.1379851338716417 + -0.09282858293628755i, -0.1920875308469016 + -0.04614726336749017i, 0.03137066685389137 + -0.08156017884917754i }, { 0.04050064056798998 + 0.12703053201755474i, -0.024538496379889727 + -0.09114582903405337i, -0.00015494224474624116 + 0.022411115857598276i, -0.07705341292120618 + 0.023745316686091058i }, { 0.1617023149605798 + -0.010016556348393938i, 0.029992053753734885 + -0.039513920671738645i, 0.02905830635358395 + -0.08610599834156471i, 0.08966200008950903 + 0.01871711734966973i }, { 0.0748346973590285 + 0.1798653199558894i, 0.08132034355077197 + -0.007484219982301983i, 0.05764341165332861 + 0.013505808729278021i, -0.22345814514793486 + 0.09587390906839349i } }, Matrix{ { 0.031062248471547736 + 0.04087850840468233i, 0.027622629221653417 + -0.07080932557621546i, 0.04285025137543281 + 0.09187574858216582i, 0.03715872617258418 + -0.1665101312238489i }, { 0.10597520772131633 + 0.018877848238073768i, -0.03835049786068186 + -0.040510475784754835i, -0.10371510648557392 + -0.016224198080325637i, 0.020322055046746668 + 0.06586860401840809i }, { -0.011433023883105353 + 0.023616700923740373i, -0.04150009542554072 + -0.07966077581375935i, -0.01936056041143871 + 0.1476319908217877i, -0.12467249586592734 + 0.0801139700327207i }, { 0.05477252100216576 + 0.03883491682526367i, 0.02931254349759172 + 0.12836679521939898i, -0.03372050872537831 + 0.01180350009917311i, -0.025514573594310436 + 0.10274483313938633i } }, Matrix{ { -0.07913425911785338 + 0.12947352660550632i, 0.007777916147646359 + 0.0465610979116603i, -0.13723858424391527 + -0.15736477941233631i, -0.02256455794769249 + -0.11145079769343715i }, { 0.027871692658452206 + -0.018114841494360583i, 0.04234243185381815 + -0.21059550779648933i, -0.05575750454331604 + -0.13085246814608958i, 0.039709353919783516 + -0.11349468587792812i }, { -0.016807015557742506 + -0.08475747360442344i, -0.1566800978155968 + -0.022922394683804415i, -0.05674151703816748 + 0.0445483617673165i, 0.1507702373579449 + -0.11952631729738084i }, { -0.007946320697914755 + 0.05524077864247264i, -0.033546964619886405 + -0.16278843389768394i, -0.01704583622618516 + -0.019952820295044398i, 0.00258143259658991 + 0.047949338593675915i } }, Matrix{ { 0.03961662081760928 + 0.1193350825068196i, -0.07046652658755474 + 0.07477791585793458i, -0.11573980948553375 + 0.04033328030623192i, -0.01098355965411887 + 0.02159560967626172i }, { 0.09135926672178678 + 0.11425713977195025i, -0.046125683439587166 + 0.15674005337467067i, -0.02006403987836647 + -0.007013604191259142i, 0.1783182660811213 + -0.14282947206795743i }, { -0.01870974724025853 + 0.10654602079185635i, 0.12954068720645043 + 0.0056303670150199886i, -0.22587557929448904 + -0.006437300676697862i, 0.04872283015295881 + -0.05272692478243597i }, { 0.015954822773240864 + 0.14149597507391412i, -0.07836588326801239 + -0.159930638827756i, -0.08311834343031227 + -0.024870148855281212i, 0.05768971988675083 + -0.024193063054786825i } }, Matrix{ { 0.11271740399874211 + 0.16053620254344997i, -0.020621100524499805 + -0.01223214572668303i, -0.04951752154597015 + -0.10995283444888851i, -0.04244786571508412 + -0.04405049817800089i }, { 0.003769059332339468 + 0.11232122295383164i, -0.08129692979095876 + -0.03590115085231059i, 0.03807905598058771 + 0.004849542641710669i, -0.10402696152022221 + 0.05040548534144402i }, { -0.09866745224268932 + 0.025312658943583147i, -0.050120754512283414 + 0.16948689520667876i, -0.1578531877413373 + 0.08518452816927602i, 0.04029965493989381 + -0.0075693156256993336i }, { 0.06479886885464635 + -0.07258793558376372i, -0.14668315524746176 + 0.1620942567091829i, 0.02022059665522853 + 0.07694714169500413i, 0.011408878620677425 + 0.007456938376551821i } }, Matrix{ { 0.04941054943677317 + 0.2052214811001368i, 0.060692656855960044 + 0.09174531519637663i, -0.04054499795256444 + -0.047096361078680864i, -0.13627661533921978 + -0.02758008203101431i }, { -0.017302849480336963 + 0.09909015913558115i, 0.023187652525450263 + 0.024185562378287218i, -0.0028924041959312347 + -0.025175506225373952i, 0.14401512119301826 + 0.020721395964967162i }, { 0.0589473448963903 + -0.07159053859230535i, -0.044153695597457326 + 0.02532232585657683i, 0.07858704622374811 + -0.10042959794353505i, -0.08358849496537914 + 0.008677300174265686i }, { 0.10972280301053133 + 0.024038557054795386i, -0.08560812484667554 + 0.12494572140870853i, -0.19790347017402762 + 0.03241239624625875i, -0.043743277461389174 + -0.07961389979695384i } }, Matrix{ { 0.03680858574587388 + 0.13305460567585642i, -0.025608071025419524 + 0.054307296247615544i, -0.012608859838621448 + -0.0915767087139883i, 0.010433948351762024 + 0.11063841378385929i }, { 0.008153900350336373 + 0.0992078825824651i, 0.059086015789593355 + 0.005978748550010891i, -0.02258343565409496 + 0.012273254021098115i, -0.03269701508913195 + 0.05837712120126098i }, { 0.05268181983363733 + -0.024221142909434376i, 0.00803634831818882 + 0.06351110941076112i, 0.05662249346658242 + 0.05143323213357102i, -0.07527429527905509 + 0.05148929454273445i }, { 0.02962179960983321 + -0.04802177390906861i, -0.061953280248298645 + 0.03757450222452494i, 0.03325057501148047 + 0.0548725575210142i, 0.0014058781932050186 + -0.06238512042923418i } }, Matrix{ { 0.127801496630478 + 0.009881723030735142i, 0.09882323454173982 + -0.022555972287436728i, 0.18532139448110302 + 0.08478637578451746i, 0.1304967915681551 + -0.05311629476994254i }, { -0.07442819941991752 + 0.07405060186561098i, 0.030007976939515013 + -0.011921154553339693i, 0.12884774014857728 + -0.04529721318657079i, -0.026884260746385044 + 0.04486817603515983i }, { 0.0010850986808320878 + 0.17688043768270356i, 0.09134314260551536 + 0.03901745496686273i, -0.013356508697519028 + -0.038315831923727575i, -0.041101379810812376 + 0.07825933428248565i }, { 0.17166994052656026 + -0.07592308593282196i, 0.19640007901578535 + 0.09839762869189032i, -0.11220591995646466 + -0.09448515537161241i, -0.14186951233726242 + -0.009785278515780555i } }, Matrix{ { 0.0685975072296228 + 0.05365527103590797i, 0.06057169959593161 + -0.018548921572007625i, 0.02873934611789966 + 0.03867294488478309i, 0.028498908835343745 + -0.03485211568885733i }, { 0.03513737350854218 + 0.1372423851548131i, -0.11042415654876599 + -0.10955266542155451i, -0.0714165089405176 + -0.014990259019780246i, 0.02796949413748746 + 0.07139133688800928i }, { 0.021398563698817357 + 0.023550237012342386i, -0.05485195994296495 + -0.08351634843203483i, -0.09790744260132456 + 0.02078254360828597i, -0.20925274785725326 + -0.03018880087862511i }, { -0.14117061414961046 + -0.03995504884505189i, 0.006364300005372881 + -0.028459776330873782i, 0.09792241559649653 + -0.03327256845152116i, 0.01793838608824501 + 0.04287873071561358i } }, Matrix{ { -0.18756824970117578 + -0.0607597469683812i, 0.05441533768569778 + -0.01950480034015492i, -0.2361812182582316 + 0.1911691045506849i, -0.03756208624967815 + 0.17440133949568343i }, { -0.030078098657906473 + 0.021937765490417517i, -0.03516402718248342 + 0.02899855277078922i, -0.014755109058533888 + 0.02562755427315033i, 0.009331144365229548 + -0.0960264460898653i }, { -0.12458400071465571 + -0.10429697974503939i, -0.19685938799776811 + 0.09991688959250501i, -0.1532629004757442 + -0.13363770248386037i, 0.09085545902814766 + 0.019156014768205425i }, { 0.085248553726554 + -0.09501810867208897i, 0.10133720998843526 + 0.09400972692817722i, -0.012487523384140277 + 0.018506400192832305i, 0.11717038215044459 + 0.017401596364470705i } }, Matrix{ { 0.08551905502153122 + -0.04367840333047725i, 0.10766064210428836 + -0.04303154926612268i, -0.13753703110254809 + -0.23169096641049453i, -0.13834021448251888 + -0.13048531868421892i }, { 0.0013594080449378443 + 0.06707264738194862i, 0.06831998365720288 + 0.07848803264000688i, 0.16476403304604909 + 0.11059262708434944i, 0.019965098240591485 + -0.04762271528058548i }, { -0.2291992389579215 + -0.030341365721978632i, -0.17350374367078675 + -0.004110575487916806i, 0.08032263561245434 + -0.0006295509724950155i, 0.03755723200195839 + 0.01852895568285764i }, { -0.1605482820029596 + 0.0491127351199029i, -0.10080864763892412 + -0.13803580431962953i, -0.058892564679541876 + 0.07950857559660925i, -0.01883162677639289 + -0.16705316461253084i } }, Matrix{ { 0.15427800178939535 + -0.028681427223522887i, -0.07437033132537739 + 0.008349489357070411i, 0.09440412287495549 + -0.03221571504478599i, 0.08255963395932664 + 0.03881964481197159i }, { 0.10172339690812018 + -0.057407714024143845i, 0.07885314740341336 + -0.07835529366221279i, 0.028368047953453126 + 0.06926858120635294i, 0.04435032023093943 + -0.019019522753045307i }, { -0.018460253595087676 + 0.01881881529399452i, 0.08644352820559942 + 0.04672610794031133i, -0.012246787455234822 + -0.09490757308267095i, 0.09466985584270796 + 0.1957048728807114i }, { -0.046379429328694544 + 0.14163340083889006i, 0.06591615141889742 + -0.028230762353803722i, -0.06131274795889207 + 0.0867242962706517i, 0.03098885507053459 + -0.22010048851784222i } } }, { QubitIndex{ 3 }, QubitIndex{ 6 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 1 }, QubitIndex{ 0 } }));

    c.addInstruction(CircuitInstruction({ Matrix{ { -0.4267626750535749 + 0.20950440816117014i, -0.41263445885567795 + -0.1482870850235953i, 0.5316413844812133 + -0.04259703911310868i, -0.07014546695980481 + -0.5406919732647487i }, { -0.5850401403490322 + 0.0912013860588084i, 0.6758172468885252 + -0.007941758798874085i, -0.1633028575138032 + -0.37835462871932884i, 0.019349349582453747 + -0.14974602820026045i }, { 0.06838277703770962 + -0.22873658098544467i, -0.28076290290230266 + 0.13873316221181925i, -0.6555232178913444 + -0.1313746259023504i, 0.12955636249981645 + -0.6173927775658639i }, { -0.49914036228311254 + -0.3424239106240608i, -0.4469466629524841 + -0.23046844379980033i, -0.24338504303528402 + -0.19878788072034995i, -0.24095943459043223 + 0.4731948766081786i } } }, { QubitIndex{ 2 }, QubitIndex{ 7 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 7 }, QubitIndex{ 4 } }));


    
    return c;
}

TEST(RandomizedIntegrationTests, 8_20_2_10_30_80) {
    auto c = randomCircuit();

    c.execute();
}
}

}

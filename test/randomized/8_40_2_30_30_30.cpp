#include "gtest/gtest.h"
#include "gmock/gmock.h"
#include <chrono>
#include <iostream>

#include "superpositeur/Circuit.hpp"
#include "superpositeur/DefaultOperations.hpp"

namespace superpositeur {

using namespace std::complex_literals;

using testing::ElementsAreArray;
using testing::DoubleNear;

namespace {
Circuit randomCircuit() {

    Circuit c;
    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 0 }, QubitIndex{ 5 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { -0.021142701762584037 + 0.011629392782987554i, 0.032913397828549504 + -0.04402039258418927i, -0.10987574938829074 + -0.07214008602717868i, 0.05193862402564804 + 0.07319234988574867i }, { -0.040611397046999245 + 0.024971628666163894i, 0.015539652344444639 + 0.23890319331773102i, -0.060863716453640214 + 0.10365823017630252i, -0.07385874233447229 + -0.07458129199603478i }, { -0.11906969453656632 + -0.0976778054465438i, -0.03875552277217545 + 0.01665790406372137i, -0.08936423480005046 + 0.12100402883881492i, 0.08541399202631199 + -0.07952541524529572i }, { -0.0646789317512464 + -0.15737772819437093i, 0.10617368025483609 + -0.1360805449589067i, -0.02449227462199157 + 0.08540607452214988i, -0.05437196812480387 + 0.03485412487961561i } }), Matrix({ { 0.08229329002178133 + 0.1632242727853502i, 0.018550876055094114 + 0.08716589784541058i, -0.04651080405223663 + 0.04628398256181867i, -0.033297698019822186 + 0.00437905791460992i }, { 0.14085779227691592 + -0.002315350905645186i, -0.08939285117103443 + 0.0583579452680311i, 0.1584634285536247 + -0.14204852671796614i, 0.05692064770300013 + 0.025459640716251238i }, { -0.15576664239825336 + -0.02082369639852986i, -0.018861113059274928 + -0.06697726070381546i, -0.01557750713017124 + 0.212955371936274i, 0.04279207285020286 + -0.005524259510628936i }, { 0.02529082849275753 + -0.09496414981174818i, 0.03697793434493637 + 0.17376681316389286i, -0.07276352415891739 + 0.16199268356912258i, -0.17206417560239842 + 0.2155127804703981i } }), Matrix({ { -0.0762420838290198 + 0.07874392494994549i, -0.13446035246997012 + -0.012979655438116928i, 0.08806232162346285 + -0.034108582728828434i, -0.02755601100931754 + 0.06566128981752367i }, { -0.02959864424932585 + 0.0892080857832896i, 0.07711155182651813 + 0.07773603614051809i, 0.018799327252922108 + -0.056412585002580055i, 0.0893463386788956 + -0.04275952972637207i }, { -0.001820475574124708 + 0.11264873040753069i, 0.0022573227258553354 + 0.015457842168645613i, 0.025621292029018444 + -0.013366170910519452i, 0.024186651940992898 + 0.08281571346921429i }, { 0.05511502923053444 + 0.05705466091057063i, -0.056775618802855435 + -0.09779604632509678i, -0.023285067918508904 + -0.08778397207840745i, -0.17133167037689656 + -0.047476725469073756i } }), Matrix({ { -0.022212940243124202 + -0.01041348965047302i, -0.029621796375132823 + 0.04338628671906694i, -0.1426870110819643 + 0.05803221249258891i, 0.04662370209669172 + 0.10695582378096874i }, { -0.08677423700035916 + 0.04881338960249043i, 0.2015607935707241 + 0.011467554497498965i, -0.06478507668911507 + -0.029889488332700116i, -0.03468295546320688 + -0.08058047631343591i }, { 0.04855992103730858 + 0.07175625982521007i, 0.12672772865429432 + -0.03595246582820769i, 0.03251769460511018 + 0.1299745322874243i, -0.0577222777402631 + 0.0066382186048779745i }, { -0.08829849616528765 + -0.0663806350395821i, -0.04859012328516852 + -0.11499104408648796i, -0.1377525605479138 + -0.1192460581024045i, -0.006868563923201907 + -0.058328902492584295i } }), Matrix({ { -0.0005888015188063999 + 0.006198543147932166i, 0.060894599375903725 + -0.020868970402994406i, 0.06993592219115223 + 0.12097464286835027i, 0.10478511761696797 + 0.0990967239848009i }, { -0.11202709554709119 + 0.10719158643281716i, -0.05335561365688595 + -0.04098520994486693i, -0.09275416899164775 + -0.09832088896137958i, -0.1422781129537403 + 0.11531664777698326i }, { -0.12840350130814185 + -0.18918041651160517i, -0.13557514732312378 + 0.11110477848186698i, -0.06900614447918992 + -0.12115923609921554i, -0.13417428196754758 + 0.014469848714205131i }, { 0.14466695102692034 + 0.030259253463394652i, -0.07186132979516832 + -0.17519288417142578i, -0.026791800769728355 + 0.1914636505763748i, 0.06814251767421796 + -0.10847445015616917i } }), Matrix({ { -0.105730479434774 + -0.08978686050684395i, -0.08560934826464703 + -0.024931271262682773i, -0.0030617655097770345 + 0.05631594783844307i, -0.005358744627464747 + -0.17127785055066155i }, { 0.04337961755711283 + 0.13302413102080918i, -0.11105245333450592 + 0.20384016134301128i, 0.03691262433245367 + 0.16309568131026136i, 0.021822562765527583 + 0.0025769552073752096i }, { 0.0004606474802298932 + -0.003902210390249931i, 0.0801540458557069 + -0.02557292868508548i, -0.08562148911343447 + -0.009617561900574759i, 0.04517836106046371 + 0.023492967761881683i }, { -0.06399103647544764 + 0.05266251025140559i, 0.06511648308242261 + 0.06342860627857472i, -0.12242681723151942 + 0.01869891631074742i, 0.01086770416563824 + 0.1274183298446371i } }), Matrix({ { -0.0969325877118618 + 0.04076554257982495i, -0.11167053239220737 + 0.19655915074345728i, -0.016355418719648917 + 0.0806780781054859i, -0.027134459847492676 + -0.04485914981129274i }, { -0.03412160097680441 + -0.02731203596893103i, 0.22044198164992104 + -0.09884602923537046i, 0.0015996978466833536 + 0.16564301704520965i, 0.01368371479795398 + -0.10729108272416295i }, { 0.0959640954206662 + -0.0037434612939941515i, 0.0015442593035847423 + 0.10764738885254703i, -0.14505897048535296 + 0.11218115607246422i, -0.014002137286684228 + -0.03539339415863111i }, { 0.1307164774489773 + -0.0070194664378743655i, -0.006114649727842576 + -0.1386464359147373i, -0.12315615328087788 + 0.04236402278817285i, -0.037085354378937875 + -0.06249900564180529i } }), Matrix({ { 0.05102087159399515 + -0.14011501359212383i, 0.026708102328481684 + -0.011131330218373725i, 0.08891165037117905 + 0.04812763917671635i, -0.06935778849346844 + -0.08473102342803375i }, { -0.14764533037853222 + 0.07792580111431938i, 0.011648289964485725 + -0.02976637776902723i, 0.016533486687696563 + 0.15512446565130322i, 0.08274282252534762 + -0.201499429835314i }, { -0.03704225182241834 + 0.009869969846605299i, 0.08715655166005096 + -0.0664275559955984i, 0.05618917078421767 + 0.05362231557664823i, 0.2229397845011248 + 0.0099322783865402i }, { -0.08924255334299706 + -0.07999720160224848i, 0.09205343394612663 + 0.038055623797769514i, 0.20116805765162918 + -0.04571590702974551i, -0.06439895656087552 + 0.11407057122680678i } }), Matrix({ { 0.0212413983579065 + 0.025683898036893974i, -0.0043105082692800455 + -0.026399575835191907i, -0.028082543505162406 + -0.012419299205929542i, -0.05931459997245617 + 0.15391530046560833i }, { 0.0474437289110346 + -0.03841691325532746i, -0.041210476654503087 + 0.038955247918629365i, 0.05859514705065076 + 0.13421571946966107i, -0.0798508971543198 + -0.06964207095652324i }, { -0.045447303549545216 + -0.005451413608213268i, 0.026912325762574255 + 0.1949452197064626i, 0.054038070634947845 + 0.05607440617322308i, 0.007391016283491783 + -0.03649569840907129i }, { -0.09926034997632066 + -0.014553073909544764i, -0.14934384990238936 + 0.03297853581658762i, -0.0928299708495912 + -0.06050724896054114i, -0.11385308708235735 + -0.08071191667265278i } }), Matrix({ { 0.03654000201593966 + 0.0646037077878193i, -0.03140040939898112 + 0.011268685325405845i, 0.02527390039718382 + 0.038068998228731735i, -0.04270079012249025 + -0.20520814000235965i }, { 0.1417114856193041 + -0.12002759287433402i, 0.05843692582146666 + -0.038704905764431224i, -0.1486969664293223 + -0.03800843033320406i, -0.1486523331811985 + 0.016858505123624083i }, { 0.021474416385084957 + -0.06919659897707482i, 0.06715491085090258 + -0.08651365411864693i, -0.10338892861036185 + 0.10088085013073138i, 0.04822520838272751 + 0.014808327006881769i }, { 0.0279191807909409 + -0.0056589518877873685i, 0.014190472646045308 + 0.16268083735375974i, 0.0033695082232275326 + -0.051391915522371406i, 0.049325880643272826 + -0.20240840243112054i } }), Matrix({ { 0.11271055571742045 + -0.10452372985767461i, 0.036014581232103694 + -0.06285743521562842i, 0.01475262411755475 + -0.11361549297930028i, -0.12049435244048894 + 0.17959335689839478i }, { 0.057597087776294235 + 0.013435248590490145i, -0.029749696677919418 + -0.06672744564433479i, -0.028197206846763648 + -0.04689847339351727i, 0.00018381305393411733 + -0.03525617800869956i }, { -0.06647762772534563 + 0.05522311470131086i, -0.0641091661887627 + -0.07592249056145998i, 0.14852633805635168 + 0.038962935215301406i, -0.0038109378918220345 + 0.10454152782017131i }, { -0.023505920491417472 + 0.09524423888431302i, -0.0481577304848479 + -0.1762257841036605i, 0.01926778236733071 + 0.008035333261052236i, -0.07277395974290155 + 0.03989139590367228i } }), Matrix({ { 0.17849091848462253 + 0.030246317475618647i, -0.12073192546855926 + 0.073817856973486i, -0.03851521211264519 + 0.03626766439184332i, 0.047557799605332386 + -0.03109463955208561i }, { 0.04189469763799692 + 0.0023546953466805774i, 0.025292853903024385 + -0.006766262045027414i, 0.18545576544992484 + -0.04032188357983181i, 0.15577032332945986 + 0.03107579448020167i }, { -0.013413699555304878 + -0.05129166589823279i, -0.10189996906888685 + 0.056809653999198705i, 0.027529436619874115 + 0.06338756945391417i, 0.05367786693281784 + 0.07994934911598937i }, { -0.011536392757062582 + 0.15289279452734175i, 0.10414117094674552 + -0.0612597386727516i, 0.007968288076363413 + 0.028792311134718i, -0.2239215551083307 + 0.029781006198260185i } }), Matrix({ { 0.12562474834439705 + 0.05643500494585359i, 0.09897085047437278 + 0.0405330964806994i, 0.10758185499365837 + -0.1061739489818171i, 0.08456002539373779 + -0.0213925194629978i }, { 0.07007090862409962 + 0.12550026210921422i, -0.12751656569637834 + -0.04801506070892108i, -0.044370491540286515 + 0.0032772226926177173i, 0.11638951370841692 + 0.07431664952956941i }, { -0.12522656489664663 + -0.015257550876591705i, 0.06152397641638468 + -0.016704774752277243i, 0.04096371328679408 + 0.003289047414578893i, -0.13306506002073706 + 0.11046792393270521i }, { 0.02606349982977433 + -0.13141298342863955i, 0.03162610955252709 + 0.10341034317631081i, 0.03642757446544555 + 0.08950960683439298i, -0.09061635104340768 + 0.09935445960864309i } }), Matrix({ { -0.06366172763848105 + 0.01165183962031141i, 0.037309975940508014 + 0.12540900741965424i, -0.13691231979940752 + -0.0937390834905711i, -0.04056187219723314 + -0.018612247384163123i }, { 0.06302311003827014 + 0.03622563085916862i, -0.010132186442729918 + 0.15636802451018753i, -0.07689158403422508 + -0.04248000096293894i, 0.10267113440889813 + 0.018064976510548756i }, { 0.1736447080782259 + -0.10406157146839792i, 0.10154359651910362 + 0.07097904969914555i, 0.08125571574424686 + -0.1366027144477721i, 0.02414526125072786 + -0.06900167085622191i }, { -0.0475735470447618 + -0.1095106992528124i, -0.09185700212655733 + 0.0433752228241859i, -0.0017991478402904781 + 0.1551293838950883i, -0.04031334151628417 + -0.09216614176520874i } }), Matrix({ { 0.1265116758454931 + -0.15627907056351764i, -0.08793017208221356 + -0.10860872171708363i, 0.06546672998891336 + 0.14902108689650795i, -0.09095290858324816 + 0.0779663361279907i }, { -0.16485083987923452 + 0.11223772760091644i, 0.04598937896668353 + -0.051613299964506774i, -0.09852434185136906 + -0.03442069022643682i, 0.05284564365139952 + -0.12192911878765915i }, { -0.01136028644889199 + 0.17695877501832663i, 0.124436394164456 + 0.031157426445280502i, -0.12253313182818695 + -0.1153316536343736i, 0.008536195333359873 + 0.056942772742307614i }, { -0.053563720043241565 + 0.09183886057760081i, -0.01313840317250097 + 0.03491343539411862i, -0.1028439139575032 + -0.05474156225908434i, 0.021097982379114123 + 0.047422258115787895i } }), Matrix({ { 0.13673596675836422 + -0.14388631189979198i, 0.0860878607813809 + 0.15682000325783008i, -0.011313854361985716 + -0.033700741950177915i, 0.06598798742766183 + -0.004528804934999488i }, { 0.026281687217814813 + -0.057986475090575806i, -0.10997173833749306 + 0.004358400550988602i, -0.10445991972558169 + 0.006438029380326686i, 0.07189192884171802 + 0.05465391508389008i }, { 0.15200677034693047 + -0.024813615999270084i, -0.046812975660502715 + 0.010214306971912083i, 0.030628491705085026 + 0.0536622754415166i, -0.010054334409264098 + 0.11505527459683962i }, { 0.1135791809054246 + 0.16816678061626283i, 0.01718556676587543 + 0.025124822882718112i, -0.030679229552569548 + -0.04304028908811605i, -0.13869456457963936 + 0.02280820664132459i } }) }, { QubitIndex{ 2 }, QubitIndex{ 5 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { 0.11495942223162903 + 0.152947812500329i, -0.1666153853539096 + 0.2086571521984678i }, { 0.04999514050511201 + -0.4846001810729517i, -0.1497845758618517 + -0.19026567957415613i } }), Matrix({ { 0.08668119854791262 + 0.20178807856415165i, -0.0863312658119545 + -0.10116391298856794i }, { 0.1420209540029042 + -0.08227145191043728i, -0.19047778698478693 + 0.10827548783306318i } }), Matrix({ { -0.2917571243379123 + -0.04958198312324315i, -0.183488826780774 + 0.16263308687684197i }, { -0.4914382495232599 + -0.2524875671701631i, 0.370584407729886 + 0.07648462245898166i } }), Matrix({ { -0.051434321518722285 + 0.06176354006516276i, 0.508782241904802 + 0.5106428285388072i }, { 0.48795945410130676 + 0.11609080856440454i, 0.18879634518506525 + 0.21403870132570335i } }) }, { QubitIndex{ 2 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 4 }, QubitIndex{ 5 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { -0.22254632108250827 + -0.22835856460682333i, 0.11574434418864317 + -0.10589230543055951i }, { 0.25255940602852256 + -0.08192627103918788i, -0.1937361248863514 + 0.11845628096921072i } }), Matrix({ { -0.3983993557171446 + -0.06813435325980775i, -0.26983357123211527 + -0.22682324861132694i }, { -0.09673274270080906 + 0.6113001849181958i, -0.06261617167841466 + -0.0127421393755128i } }), Matrix({ { 0.07719665256296498 + -0.18732111554937064i, -0.43672009926760824 + 0.2973692026266457i }, { 0.046572926401938705 + 0.08145873224414074i, 0.3475090322901841 + 0.4233117502223184i } }), Matrix({ { -0.23610351725879353 + -0.19232355886639002i, -0.3356995946851394 + 0.29004344987217523i }, { 0.24583545761508627 + 0.2799937084189557i, -0.13131961466600964 + -0.048061267666364205i } }) }, { QubitIndex{ 0 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { 0.2712256546493639 + 0.27016486732326234i, -0.7439267252919565 + 0.094662788315555i, -0.40004784735525367 + -0.3249761968912671i, 0.05930123582649278 + 0.1479700217574648i }, { -0.28094078320948807 + -0.27884092153915196i, 0.27332082526635104 + 0.15408479625850355i, -0.43263286966819625 + -0.6708386711807588i, -0.19109627413575833 + -0.2667585241094625i }, { -0.008852203153510957 + -0.7449769249562023i, -0.35528214409628617 + -0.17795878557148176i, 0.023780334875645737 + 0.13930145327659088i, -0.44975300313769084 + 0.25453511636561904i }, { -0.3642560796787172 + -0.09495332394542907i, -0.4095334419225328 + -0.11641827439778954i, -0.04848575213582762 + 0.273560233293632i, 0.19147749429159344 + -0.7504537426131607i } }) }, { QubitIndex{ 6 }, QubitIndex{ 4 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 6 }, QubitIndex{ 3 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 3 }, QubitIndex{ 0 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { -0.30792046158485875 + -0.4990559668422313i, 0.2932503781751639 + -0.3132844336822039i, -0.3445417659026906 + -0.4692468157598474i, -0.2263586176533363 + -0.2860863231107836i }, { -0.29231352616404216 + -0.0693699049168634i, -0.1877150968159052 + 0.2830450794522529i, 0.5518039526846199 + -0.11683276146757128i, -0.6900806469166477 + 0.006352050001690396i }, { 0.2624858435082985 + 0.05768112485559447i, -0.0017301058857761425 + -0.8275544714108295i, 0.40873842731189414 + -0.07309772801173818i, -0.11452930062870689 + 0.23957740475745523i }, { -0.6991753184032189 + 0.06925816875135071i, 0.0653742790042498 + -0.1066883872033329i, 0.41126467393187854 + -0.03757511505261729i, 0.5622992897358161 + -0.06300761338662267i } }) }, { QubitIndex{ 2 }, QubitIndex{ 4 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { 0.08099229596728197 + 0.026530298731819002i, -0.05708112481108785 + -0.10236022697837473i, -0.07079981269210721 + -0.06096528070957123i, -0.04292006066768745 + -0.18425926578028218i }, { -0.05797135539284074 + -0.004556151484911838i, -0.09594081947866395 + -0.015973916119622334i, 0.06663869832009287 + 0.035007686133905896i, -0.10257721130474137 + -0.022068504285195693i }, { 0.05168350695010591 + -0.19428608732274932i, 0.039852432908005976 + -0.11865541662937587i, 0.10386981897274052 + 0.1577360449262779i, -0.009236427077881559 + 0.048579520525910753i }, { 0.01548440480942321 + 0.07246862539103206i, 0.07259678744811489 + 0.05637976923300622i, 0.11277844072277857 + 0.01171638332914457i, 0.09549610074228414 + -0.009426528580040547i } }), Matrix({ { 0.0971741912793244 + -0.14126434518038428i, -0.02386661557949125 + 0.0843163263191691i, 0.0027421687096075113 + -0.001841866102435996i, -0.07530525677290048 + 0.0231804340732281i }, { 0.03695304340644484 + 0.04811147862799093i, -0.017036772848092862 + -0.1280098090508863i, -0.08199831101654725 + 0.05911831688336191i, 0.01817164556916418 + -0.031870802271249304i }, { 0.1546238572767493 + 0.053889786367314584i, 0.03299206678007285 + -0.13590528966055201i, 0.01913725948940488 + 0.0539785375663471i, 0.04591137408143336 + -0.18332142161234216i }, { 0.06429510441259989 + -0.09111972035151988i, -0.05446403078198464 + 0.07937044132401866i, -0.04011754185555595 + -0.02955779002366749i, 0.029652904077798393 + -0.050493246543408324i } }), Matrix({ { 0.03325866110083653 + -0.03187165308958766i, 0.10475152615196069 + 0.13726943687494056i, -0.08927467598652626 + -0.044495039781341575i, 0.025163044115900184 + 0.003721845258458745i }, { -0.03148576900442267 + 0.09385074067531538i, -0.11778868265642162 + 0.17120082892500257i, 0.037945881568719725 + -0.14099954090162803i, 0.0655049271092509 + -0.005142514214878859i }, { 0.0009066060161871336 + 0.09311499148553067i, -0.03280982618523996 + 0.08113109945206522i, -0.08801640466162938 + 0.013658352069169084i, -0.120141941431108 + -0.07388553061482693i }, { -0.028757783028820486 + -0.1904221414329573i, 0.041892078531044694 + -0.13596719275944755i, -0.03818137132840852 + -0.061411387575110374i, 0.0022804191643357587 + 0.06990787409236456i } }), Matrix({ { -0.001845178696391823 + -0.05926715057567315i, 0.1098973767638256 + -0.019375297134943573i, -0.028617447994273706 + 0.0757938211341035i, 0.10256765949183716 + 0.10190076106610606i }, { -0.0407360246187616 + 0.1415205455832932i, 0.022463872127737265 + -0.01424926473850665i, 0.06671978947487807 + 0.11688692732164613i, 0.14889589249691518 + -0.03343894631293615i }, { -0.0029357912468312626 + 0.05095342369370888i, -0.004517098335144372 + -0.08457131012482022i, 0.05715275274572799 + -0.0019053660399762412i, 0.024816687857917265 + 0.09741606369387815i }, { -0.013391232929504485 + 0.025995432943119404i, -0.12942793124263982 + 0.03548453363773281i, 0.04589696677241141 + -0.17955858941049616i, 0.016294681642426007 + 0.12246521389437827i } }), Matrix({ { 0.15976185791946895 + 0.015901084221555974i, 0.008626141761022162 + 0.0191259748157172i, 0.07978941112420454 + 0.06323381346418668i, -0.08895537542457191 + -0.07394277526254127i }, { 0.07981602160531663 + -0.025279876105543008i, -0.0024070648673057316 + -0.06862945604072294i, -0.07931049352049825 + 0.046517813393162036i, -0.04345338014147689 + -0.060665386070588516i }, { 0.01509532969663606 + 0.030389365895763364i, 0.012839193008272468 + -0.03406992198152852i, 0.09469127784234627 + -0.04805284608881104i, -0.11855928914076777 + -0.014119943876277186i }, { -0.03280682394579378 + -0.0025885260898397154i, 0.03959539572853116 + 0.04491850754715146i, -0.035687341991058275 + -0.26274565856610377i, 0.048829582177201035 + -0.15727665062467164i } }), Matrix({ { -0.036133128099307646 + -0.0006585746292726313i, 0.021713451942983616 + -0.17691783368038053i, -0.047027212063575324 + -0.014339625923890474i, -0.028633541624996598 + -0.14376707236185368i }, { 0.1848745772876283 + -0.04436735107663192i, -0.06916915094814531 + -0.07476082674264728i, -0.01871545799957959 + 0.13813525479276217i, 0.043254937252488905 + 0.010245605139092085i }, { 0.018023047710622585 + 0.045288682484191295i, 0.12035855303196479 + 0.03141805154300268i, -0.08416236815018734 + 0.050139041719120606i, -0.09442556173514023 + -0.07752082723295046i }, { 0.14762572180144581 + -0.07969512457724381i, -0.006647455426731527 + -0.06411429355602434i, 0.04078611550957564 + -0.047310916970898446i, 0.002986440809591027 + -0.03169934521676438i } }), Matrix({ { -0.05610526704886714 + 0.017380754602414443i, -0.04939635535038262 + -0.009792800941269436i, -0.19461980504279802 + -0.2403519859823966i, 0.0035416163085963343 + 0.04377099336354667i }, { -0.009210614072190296 + 0.001554263944550422i, 0.01630674592084211 + 0.034730096757728694i, 0.18405170162765636 + -0.01902555774975i, -0.005688203784166718 + -0.07430620124665914i }, { 0.03648814583573841 + 0.07919383359192105i, -0.07802282495159393 + 0.0238997706040946i, -0.041384570986467556 + 0.04269633066766977i, 0.10852659547665816 + -0.014520292957287106i }, { -0.14459877009674915 + 0.027604390345494792i, 0.06064485375876258 + 0.09043124455042345i, 0.10549325939859275 + -0.15530567283976235i, -0.19751795874049036 + -0.1271564720893035i } }), Matrix({ { -0.10504367853039617 + 0.09882048080116117i, 0.09467230084176399 + 0.004720021529207375i, 0.0050361236835493595 + 0.16098866242501064i, -0.1835570897559811 + 0.0026297855402992085i }, { 0.058516664613619644 + -0.1290174520648615i, -0.1771055653331925 + -0.06620925173305753i, 0.0849785115596928 + -0.0037381092556977077i, -0.04762318182845066 + 0.004543461200415614i }, { 0.027275362668893053 + 0.06427747727149877i, 0.06761543866096513 + 0.0004178028049457094i, 5.51941969317163e-05 + 0.12037098710609631i, 0.05008750895251468 + 0.10737440817230713i }, { -0.06199535086000514 + 0.16062401983367822i, 0.05671584950724036 + 0.017739934696847207i, 0.03764955503038042 + -0.05081048528616933i, 0.07157700792694367 + 0.0011808128006101867i } }), Matrix({ { -0.14538617041645116 + 0.02297407795612732i, -0.016650844628565347 + -0.0012487797295484824i, -0.012465095649523429 + -0.0934012121623927i, -0.05291501854824547 + 0.24923014784997427i }, { 0.14318196698161126 + -0.07651643659483122i, 0.054825098581810804 + -0.08365964227357978i, -0.031184151544517005 + -0.12424749697652619i, 0.04665885666699763 + 0.0336210109472265i }, { -0.036359194570724146 + 0.12537215283768155i, -0.17337194804236658 + -0.24196082952898215i, 0.02189346598940508 + -0.08483579232509694i, 0.11204503214272549 + 0.0548997483912648i }, { 0.015025833968133308 + -0.22703707847743215i, 0.006690873747059301 + -0.06331598806093551i, -0.13575621643769495 + 0.1618843423322553i, -0.03878612077440578 + 0.14960605538620617i } }), Matrix({ { -0.03565549786621311 + 0.012707012310728197i, 0.05921951407661621 + 0.030674940094998757i, -0.02369694390220822 + -0.06369012625164688i, 0.02509668211473074 + -0.14906385343784018i }, { -0.08403596655278395 + -0.0778685656666733i, -0.08760809323200235 + 0.03582934063671357i, -0.07977182561074875 + -0.06354586017770808i, -0.13406307153257713 + -0.026314079070988972i }, { 0.1775860219850002 + 0.03881117295110099i, 0.005421188394223553 + -0.018257678130802205i, 0.0067372582302260555 + 0.0653321141818378i, 0.05421832525172622 + 0.014330003370362413i }, { 0.054878955098176495 + 0.01716804960165572i, -0.09488073067836432 + -0.017620052713514724i, 0.0904555217014794 + 0.11403445975624656i, 0.07503577907050737 + 0.09908128129208582i } }), Matrix({ { 0.11079413150093455 + -0.17291184185279043i, 0.06480289413613231 + -0.04016943214845438i, 0.06785519874952388 + -0.1027378558250037i, -0.07935259763802278 + 0.19769663916596592i }, { 0.008166694288556884 + 0.03628572611098972i, -0.008488772109708841 + -0.22445918391179268i, -0.00048634920652660155 + 0.13442243279223393i, 0.004270996321448382 + -0.10707059815208753i }, { -0.06270261561429467 + -0.031919706727693044i, 0.1202153904677885 + -0.08557475907379458i, 0.12885920530907732 + -0.1801570272939993i, -0.09775627007833787 + -0.038153975836722406i }, { -0.03069649304371746 + 0.09415137149432115i, 0.1642611081688166 + 0.00390556500290663i, 0.13356918339341217 + -0.0009378762709689979i, -0.00475041361705538 + 0.074374891248705i } }), Matrix({ { 0.004717759871912716 + 0.15340031058281522i, -0.08651068235711441 + 0.06245852901650311i, 0.11561462575660275 + -0.10693408902316814i, 0.15954323069339177 + 0.028928986893361014i }, { -0.06680737760762388 + 0.015283041696012065i, -0.07998597044654436 + -0.06313771910485379i, -0.03392195734224832 + -0.030401260244545283i, 0.024676506244992565 + 0.049396431343554786i }, { 0.023913948336533403 + 0.011404435014120818i, 0.15760120228771732 + 0.09990640768843821i, 0.15274208930188876 + 0.03658938807116352i, 0.004514285350909475 + 0.0031214718159422086i }, { 0.18055611484635006 + 0.0006758000077856756i, 0.07661796733311471 + -0.009942302526187425i, 0.08653907798442367 + -0.16989396225643488i, 0.08271916014854423 + 0.16052030726681324i } }), Matrix({ { -0.04865097580622213 + 0.02339371998435345i, -0.02288427590655531 + -0.04334218229742839i, -0.017992327957280337 + 0.05003818826836318i, -0.00630918544232837 + -0.13155656397745663i }, { -0.005474353703770828 + 0.004781840703771552i, 0.11242385531361551 + 0.07813451500000085i, 0.023588753885002332 + 0.05856518113273477i, 0.0035871539902957356 + 0.21846635566022135i }, { 0.08114857376646775 + -0.0014960103462842798i, -0.030081867194254625 + 0.026280214133711656i, 0.012718143331532088 + -0.03630325242111779i, -0.10514266107345618 + 0.091170239452266i }, { -0.08612768833828999 + -0.010446066860501601i, 0.23709911848028709 + -0.07652805572277237i, 0.017077356733932906 + -0.0846167775603247i, -0.02996237675889433 + -0.09233612212063456i } }), Matrix({ { 0.0357880907771343 + 0.024153972459279548i, 0.056412533488704765 + -0.006642749470137295i, -0.09832071635174015 + 0.024384491616167923i, -0.04477453391509808 + -0.08255783717852423i }, { -0.08518444434544842 + -0.043260190644928226i, -0.02220046624655081 + -0.04970835344646921i, -0.09621730486171585 + -0.13098181086491842i, 0.10439092385050808 + -0.060127896757816816i }, { -0.04453075640061791 + -0.07159637231683688i, 0.13087338827619474 + 0.11727638095135674i, 0.022714371764189858 + 0.06613348080480115i, -0.018999237961286962 + -0.06788726921971783i }, { -0.07617016337712482 + -0.08306250184778118i, 0.20628758746555345 + 0.1278163707605267i, -0.02287810636004966 + 0.09490659487568796i, -0.0005598245576134205 + 0.0008888494473250694i } }), Matrix({ { -0.026582782805904197 + 0.22205287881400693i, 0.04374941975982069 + 0.0902393842772319i, 0.12017293630383748 + -0.08144617052777205i, -0.09324717462177454 + 0.019268525887157825i }, { -0.07325171638147665 + -0.06306819663232704i, 0.02918567320166349 + 0.17023671131493068i, -0.11699572129625681 + -0.07047301564807712i, -0.021904692359201415 + 0.18697028665075974i }, { 0.06499327670853797 + 0.003975717167529251i, -0.02612008999983266 + 0.0810066538170357i, 0.00558816675358043 + -0.03516730767551349i, 0.017025274476752367 + 0.08475301920078973i }, { 0.19420497011660154 + -0.08538653164147485i, -0.08045892896362825 + -0.09931116264540188i, -0.005114662266896297 + 0.06461937429807356i, 0.08983326836586863 + 0.08819428057530546i } }), Matrix({ { 0.18531794575214014 + -0.053916081851471835i, 0.03687784387575368 + 0.021863372134806942i, -0.03384766330218683 + -0.04750598477192376i, 0.02587723200754399 + 0.20863166327115776i }, { 0.05747257112889586 + -0.12560006410355554i, 0.09576517856171538 + 0.16294242493461966i, 0.025266443993778625 + 0.09666940886874467i, 0.03770833891047219 + -0.059229519763947275i }, { -0.15021613886528234 + -0.15383245407295537i, 0.12442270394803548 + -0.09991051627318623i, -0.00834367648887699 + -0.07700488510983809i, -0.024241061545129654 + -0.11367478454022995i }, { 0.09965219633286466 + -0.13036748275459734i, 0.10936116663407752 + -0.01458916568547243i, -0.008639167002919243 + -0.14359912756089946i, -0.09328152336630306 + -0.03823951737285834i } }) }, { QubitIndex{ 3 }, QubitIndex{ 2 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 2 }, QubitIndex{ 4 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { -0.0503181637306096 + 0.010168087358001182i, -0.16896068463286348 + -0.07379961599385387i, -0.013585505586395777 + 0.03411089857801014i, 0.10404518567353238 + -0.064981307604364i }, { -0.1022644784883586 + -0.04607508716228063i, 0.06869091650944059 + -0.05835461044348939i, -0.09580653534397206 + -0.0620274120059855i, -0.10797654746250131 + 0.07701451729572106i }, { -0.04564133202769299 + 0.12876331171180985i, -0.00038658742685129723 + -0.23129144060833823i, -0.032735292908136725 + -0.018593787671642794i, -0.12982431770989805 + 0.06322722199187189i }, { -0.17708534032202894 + 0.25350414638796787i, -0.03664490994413313 + 0.06277923137769151i, 0.028261953876191615 + -0.0048210656194163795i, -0.11013196058481554 + -0.05916478628212469i } }), Matrix({ { -0.06647550510665003 + 0.02276544043539955i, -0.08541490754552798 + -0.10457581674424653i, -0.036602030001254705 + -0.03324224449699894i, -0.00874887562737852 + -0.06765475477257475i }, { 0.05156122647315576 + -0.11326809627032344i, -0.06248016531693115 + -0.06928710389309888i, 0.12268504813556538 + -0.08369817512656809i, 0.050460479231969196 + -0.07795647508758949i }, { -0.06252248058474484 + 0.07335288413049314i, -0.08000365819665234 + -0.061590853851440974i, -0.014139793806762424 + -0.08433926466592583i, 0.13672162032628446 + 0.0434342662387322i }, { 0.11933130191203559 + 0.06386833366460731i, 0.10223051912593828 + 0.02395304063715601i, 0.131365775682865 + 0.0484464988651815i, -0.10913708885483131 + -0.15721484252966203i } }), Matrix({ { 0.09374191667709082 + 0.010316872635612128i, 0.04962636569115586 + 0.025926776087495156i, 0.056726574752403953 + -0.028687807030862066i, -0.05266275706971685 + 0.012379425608067285i }, { 0.04968930532269312 + -0.04242320506748401i, -0.04685326375326076 + -0.07330646836272621i, -0.05755019167948373 + 0.029262476233832393i, -0.02819532839369376 + -0.04172841642417671i }, { -0.11167951082008469 + 0.12020385390908726i, -0.11259746017460633 + -0.033368243322589475i, 0.07087763268062698 + -0.037631549823690824i, 0.09644671919681337 + -0.04634324700189944i }, { -0.0246045519111911 + 0.0642445317696393i, -0.027139179301979347 + -0.04148633834336258i, 0.0578729099566537 + 0.19125729009244896i, 0.10208652882296973 + 0.08943556203472673i } }), Matrix({ { -0.06889914333609233 + -0.029607290169876413i, -0.08310722469958907 + -0.11980023621116889i, -0.11799174968799926 + -0.04322195961353763i, -0.042091741301903136 + -0.008464588927842954i }, { 0.09742312657186772 + 0.020909750674690412i, 0.0035555245026178267 + 0.030819524545669056i, 0.10484097087052376 + 0.08069378886186912i, -0.13638647096463943 + -0.02479154019847722i }, { 0.07273342446396211 + -0.05912532820750226i, -0.24512854518796878 + 0.11856758101518014i, -0.15081824614733216 + -0.09359263158613008i, -0.12300426000799654 + -0.0779209903239677i }, { 0.020501926290214936 + -0.12417234962713143i, -0.007375507003234319 + 0.046306354468432884i, 0.11843079145366317 + 0.034963374314961534i, -0.03931122871036988 + -0.12886016666863898i } }), Matrix({ { -0.08985288224640603 + 0.13473702335392704i, -0.04957507266318502 + -0.01343535358972349i, 0.06191587438952662 + -0.04538397758040504i, -0.16259341163591665 + -0.17218310359434338i }, { 0.0716401862764063 + -0.1165842859014858i, 0.11650892020753915 + 0.07892419021727957i, -0.05975117422732395 + 0.20954905879923094i, -0.09330702013932958 + 0.07880581458281054i }, { -0.19217539155704927 + 0.013750571261323497i, -0.0007221672756688242 + -0.16818802592089965i, -0.015496522147740218 + -0.08346126741365997i, 0.0062022202259718285 + -0.03940583501452356i }, { 0.004758824188788001 + 0.11523885568338452i, 0.11074644873667866 + 0.08101931407672612i, 0.15148871843086748 + -0.07310349024583401i, 0.04880329226331018 + -0.027851609236175755i } }), Matrix({ { -0.12864244681175233 + -0.05392800038522047i, -0.11042010429083907 + 0.07706236539858886i, 0.08911661134634727 + 0.016763490979692368i, 0.01610902745745642 + -0.09248293413509731i }, { 0.0276161927607941 + 0.15221483237868239i, 0.0959423754901487 + 0.0022635343530313596i, -0.024911084304865574 + -0.03613057739394689i, -0.0788989691346356 + -0.05306222370934312i }, { -0.03414878667774313 + 0.14456018457801667i, 0.006138557256521626 + -0.13188456812445665i, 0.02140076722063584 + -0.0028566443694314075i, 0.05495660227265611 + -0.03197309838551954i }, { -0.04820168243226091 + -0.08672694245830477i, -0.060743276518588615 + 0.04637763139972865i, 0.03666509553337404 + -0.11337963964333171i, -0.03273418094864654 + 0.05626159814796288i } }), Matrix({ { 0.027528433054334743 + -0.07534603238930551i, 0.0030339176531682683 + 0.09316483551435477i, 0.0670922065541493 + -0.07432544758462507i, 0.06627821351055888 + 0.13387549784900024i }, { 0.11388574917974888 + -0.01912320341391055i, 0.1020032697948779 + 0.1342384002983257i, 0.06244420372630881 + -0.039497405348394854i, 0.12242496733405422 + 0.030713049760035076i }, { -0.02751018644267034 + -0.029195176701152254i, 0.04048291099305424 + -0.10586287581701471i, -0.007816655734675357 + 0.14595283291165354i, 0.038754893840510465 + 0.04928960658999757i }, { 0.0683557656606019 + -0.02379438866394449i, 0.1255677020742414 + -0.046172979097710384i, 0.0029017051541301046 + -0.05470747371351696i, 0.1150587882968108 + -0.10143927760119138i } }), Matrix({ { -0.11227261136154523 + -0.005792203218785704i, -0.12693735109401677 + 0.05532805104028844i, 0.08461887495736113 + 0.15548020938069473i, -0.08226152981014373 + 0.018404168340819847i }, { 0.08855031238065858 + -0.05408861285911748i, -0.17594378962708856 + -0.07220819480364377i, -0.10711661673984346 + -0.05585827206817213i, 0.04844802125632124 + -0.012645129823200067i }, { 0.003562223979125089 + 0.07977653224518404i, -0.031949816482322334 + -0.22297716467836132i, 0.04544108289651428 + -0.00397704071160659i, -0.06320684696167649 + -0.011401628593423257i }, { -0.006036832440475897 + -0.059132492252282176i, -0.021301820158506974 + -0.14519773471967443i, 0.06597744600458866 + 0.11387197001133925i, -0.08586226412711573 + 0.090639414715619i } }), Matrix({ { 0.08753873262490577 + 0.06021450932465824i, 0.15951106489301062 + -0.09726892548405393i, 0.035174581389175515 + -0.06268346822043065i, -0.2023527995965384 + -0.0997516391695589i }, { 0.005593674112230917 + 0.05627614733438545i, -0.184167093560943 + -0.04351865534984165i, -0.07790595626697995 + -0.017120036875290963i, 0.23170431770725908 + 0.12430764092024445i }, { 0.1433226206759047 + 0.0703407487983903i, 0.02729061863372856 + 0.07141267002187808i, 0.024258387704849647 + 0.068081611343289i, 0.07172303243776441 + 0.02788087242650668i }, { 0.07282974478564491 + -0.0027294809633885905i, 0.07257525298287465 + -0.044875614265337135i, -0.04896213081980692 + -0.30116635165187133i, 0.08004137562080205 + 0.05821101286985376i } }), Matrix({ { 0.16115303404738204 + 0.06234807816448886i, 0.038834977081345604 + 0.01474503950327842i, 0.004036098857504092 + 0.0063330143782821015i, -0.10677078482391993 + 0.01064710066852211i }, { 0.0066956968396363475 + -0.09826343002707684i, -0.1000144867066121 + 0.01577162126903815i, -0.009348086308163243 + 0.09979911965575976i, -0.09909595626250578 + 0.10066932926510264i }, { -0.11821443899649868 + -0.17292227609437738i, 0.03520229362253296 + 0.12949747458935154i, -0.0009300219513848681 + -0.051477235167549866i, -0.13201785138064281 + 0.07877628171612765i }, { -0.08101261465258645 + 0.0763403534289136i, 0.0722901179073148 + 0.12962852600383382i, -0.11324678671926758 + -0.025450296947539655i, 0.008091434041420974 + -0.012112828411317337i } }), Matrix({ { -0.08237721229687008 + 0.032879956180156454i, 0.24597123304855725 + 0.06553521386422406i, -0.009533644645049843 + 0.0481465003852725i, 0.030482507337980077 + -0.032363773323054436i }, { -0.036665900780009766 + 0.08714569305310518i, 0.02004348564165329 + 0.09215240382466146i, -0.07369488389896588 + -0.1915944210981532i, -0.013906194117221785 + 0.13429198833389958i }, { -0.01999371881667727 + 0.03941677621016533i, 0.16468334078589378 + 0.08994446172834898i, -0.13234590006472252 + -0.05177090051835442i, -0.012294469340941009 + 0.06968146760662465i }, { 0.05503327962444464 + -0.09066761713241707i, 0.07598684210102828 + 0.051546377870502494i, -0.1714227121235266 + 0.03742288223901088i, 0.1935550274050607 + -0.0026626695039696324i } }), Matrix({ { 0.09671718723618496 + -0.017491677753682437i, -0.0867449333772198 + 0.003978771980618952i, -0.013718702464666669 + 0.03317454609558608i, -0.04288233714644118 + 0.07414905790800963i }, { -0.12159872979046914 + -0.14024323007513953i, -0.07477514841480831 + -0.043905195888829955i, 0.13004520996170596 + 0.02341517761237466i, -0.026093504114266277 + -0.007942339550595652i }, { 0.007238439826299844 + 0.015277914278177424i, 0.053675494235243856 + -0.02974487156965902i, 0.03355898360944219 + -0.18356670941543263i, 0.11764788541415369 + -0.10204011325618914i }, { 0.06400108325096351 + 0.05621489541315312i, -0.009711091596591283 + 0.06953703101025246i, -0.028078202633774595 + -0.018115261870085997i, 0.008112766961257565 + -0.13313791089341626i } }), Matrix({ { -0.11030630625167141 + 0.11006395117504497i, 0.02778501829429228 + -0.06694342836891722i, 0.06869638073565149 + 0.05646015378920174i, -0.11950721430645216 + -0.013877026720103462i }, { 0.013458940455646037 + 0.15156099778262097i, -0.0552939573032355 + 0.07466986324505716i, 0.01164893342378116 + 0.12223244599624607i, 0.005103842701898573 + 0.022773001380002898i }, { -0.14019044339155914 + -0.026939683121795076i, -0.04953262160150293 + -0.04018388546223927i, -0.17047687740258607 + 0.09365723558926595i, 0.12498149657838362 + -0.13343802136217411i }, { 0.010258944883510587 + -0.04337400046715264i, -0.03349969886402586 + -0.032434209103133965i, 0.11927038491060954 + 0.009291839366203623i, 0.07804605055223905 + 0.0945714602024794i } }), Matrix({ { 0.009825977304871373 + 0.11235975207921017i, -0.0033009302334127185 + -0.0026640353093088163i, 0.13578416957513137 + -0.03880863518579785i, 0.0665593431537482 + -0.013489060552020102i }, { 0.06453980017590151 + 0.05537943407240719i, -0.17843413345371367 + 0.07458541235860605i, 0.09317294804698623 + -0.1610429699570817i, -0.03247484192917235 + 0.022085379032639584i }, { 0.1319594391388647 + 0.14587980773067297i, 0.12288004580019296 + -0.11771069387535438i, -0.03038510900666774 + 0.018221277403036352i, -0.060691437257148324 + -0.05383932632704726i }, { 0.06582476849128255 + -0.015337906735324995i, 0.03364018370548615 + 0.00992636593359953i, -0.04931928299772968 + 0.11888985862125974i, -0.1169104124194661 + -0.08012571468361618i } }), Matrix({ { 0.021437530784222385 + -0.0012186417018971883i, 0.038195860631161926 + 0.09775329933235585i, 0.15416287025889552 + -0.002996149205532373i, -0.06230005153011178 + 0.10636562571980006i }, { -0.20563250994691673 + 0.08710764299664434i, -0.00014729204538321323 + 0.06620003172244554i, -0.027542099050491625 + 0.0033513087793352677i, -0.034766020023294 + 0.1337225813383743i }, { 0.03955248481593474 + -0.04669689272789765i, 0.031098465176529075 + 0.0031910984657362103i, 0.12488721090869141 + 0.21051091408582426i, 0.12055130005660415 + 0.046913967292627284i }, { 0.03988510447414596 + 0.07687530409409582i, -0.03787185648730151 + 0.09120154881925178i, -0.07162116295159325 + 0.02362578562221717i, -0.10132628635205349 + 0.08354557836875158i } }), Matrix({ { 0.09980536925307106 + 0.0836995975717264i, 0.007004158476365143 + -0.003982759615245246i, 0.014753000178875215 + 0.0963737287182293i, 0.17790566677769623 + 0.0029461054099237053i }, { 0.04087272118414658 + 0.030495421555400276i, 0.011495435828561478 + -0.03571888108453402i, 0.06602409571450543 + 0.06076322289172518i, 0.04377848012761083 + -0.14486323310400637i }, { -0.1753820949554204 + -0.12919075712526792i, 0.09307932940967983 + 0.06416640480241934i, -0.1083773813250972 + -0.08054348660128649i, -0.14080500769119994 + -0.11750575261573991i }, { -0.0515678242492538 + 0.14076009517276852i, 0.013690083639486213 + -0.0673118104502499i, -0.04219719435485243 + -0.1302077036552398i, 0.0999178175607453 + 0.03338864319055982i } }) }, { QubitIndex{ 7 }, QubitIndex{ 2 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { -0.07409461384249161 + -0.0045843795945467464i, -0.07434755915778973 + 0.0563454102933259i, 0.040993794690774854 + 0.01621406057932022i, -0.032165220704026144 + -0.024852734318228254i }, { 0.04459362961535874 + -0.01784900212993637i, -0.0742591260994101 + -0.011819614610098719i, -0.03402681900090344 + -0.013270095764049462i, 0.18299164657617903 + -0.14421935980129316i }, { 0.019543304711665915 + 0.2162445301858422i, 0.015888220747352067 + -0.07449572407177205i, -0.08429055892684166 + 0.06751789229657527i, -0.05144469153518373 + 0.09768002543871691i }, { 0.04249902765656993 + 0.0348448191684577i, -0.04964478577169029 + 0.08863933685949825i, 0.017806241533097095 + 0.06868662991879397i, 0.1379086595168998 + -0.1031282018517895i } }), Matrix({ { -0.10714529492697435 + -0.013452127686030182i, 0.2321870187452288 + 0.018061193916214045i, -0.08236487777034024 + 0.1579723151678089i, -0.11744309265202474 + -0.03600407895419951i }, { 0.08633463913977049 + 0.024185053654987666i, 0.15583580736452673 + -0.0005564207588388792i, 0.12208998549657342 + 0.03989582800600606i, 0.10531667494045133 + 0.15935041533214453i }, { 0.10499126697252624 + -0.022458548977937157i, 0.04300230147644611 + -0.07320482278095551i, 0.08473490444911791 + -0.029921538391226202i, -0.0796957191055875 + 0.026524530568529197i }, { 0.02889688849991809 + 0.03126490804150889i, 0.07923035039795173 + 0.04321859019975436i, -0.015598241952666517 + -0.12415415815237701i, -0.17413576578592216 + 0.09604695100510272i } }), Matrix({ { -0.11250418052293334 + -0.010776064208295745i, 0.10985478726374578 + 0.1715920736620823i, -0.024583062216824977 + -0.03449849044882012i, 0.07336611307370611 + 0.11029250346181604i }, { 0.12497090044180242 + 0.034194144157149095i, 0.002674509590428184 + 0.003491633789023266i, -0.06276938110899186 + -0.05750894712390499i, 0.060366543135911485 + -0.18658101866674695i }, { -0.0033397233105689024 + 0.025725351636225146i, 0.01367442259602591 + 0.01945425653949001i, 0.21332716002387625 + -0.01442734176986799i, -0.009598352919347233 + -0.07683503279768815i }, { -0.14486570875072316 + 0.11104903613088221i, -0.04997748836382017 + -0.14634358361730115i, 0.08235643937108961 + 0.061755362425948646i, -0.025265349697030978 + 0.09496771698773476i } }), Matrix({ { -0.10560960889456403 + -0.15508491277351777i, -0.0207396205950462 + -0.053093909536095704i, -0.022335952884852635 + -0.021541454861222855i, 0.15003989656598435 + -0.013692306101201727i }, { 0.10930448391729763 + 0.09328137780107736i, -0.09186838206764796 + 0.13472576217870183i, -0.027517995867940168 + -0.10866386001701796i, 0.09988823352142395 + -0.09433129874949013i }, { 0.03630519408336146 + 0.053468724632004395i, -0.07670408142085015 + 0.009306810320819717i, -0.025343923011046245 + 0.012790527563441897i, 0.02009359648155346 + 0.023554230106636733i }, { 0.01838293042979249 + -0.11629137575053403i, 0.1020668778777987 + -0.1670808380383985i, 0.13257967151890612 + -0.032007481455385345i, -0.11838768852560536 + 0.056745443518609384i } }), Matrix({ { -0.02281717083683452 + 0.143436790069156i, -0.1513922377857999 + -0.0007589659109218343i, 0.11326923600892193 + -0.05529867436971122i, 0.03754427879653057 + -0.016637828798444054i }, { -0.05789103769715719 + -0.1443662686002162i, 0.01601547869312566 + -0.017304986280525285i, 0.07108257555881398 + -0.16525747617153588i, -0.03987693556575436 + 0.04298897103017703i }, { -0.017502685443955845 + -0.08847883802013826i, 0.05014997701039894 + -0.044817498270261366i, -0.13686503540072867 + -0.030252777421341512i, 0.030841050459725867 + 0.1464359395820783i }, { -0.004616815832442711 + -0.13127987810954625i, -0.07401695079416139 + -0.04307543036023525i, -0.16788010069042741 + 0.020112087596094144i, -0.1187528556467709 + -0.15216469007098107i } }), Matrix({ { -0.27698290816902693 + -0.1320564514803564i, 0.017110345456024873 + -0.026267413308376196i, -0.017332958553936663 + 0.04544052614621978i, 0.1280841622131159 + 0.011720485453755383i }, { 0.11956829775463776 + 0.02160373644456932i, -0.042217564469184614 + 0.04254420043557831i, -0.11477625388713203 + -0.012591864914466252i, -0.027933488171437162 + 0.16117407009119897i }, { -0.013957390774704903 + 0.07211098730232371i, -0.029128508954617723 + 0.1809996354645031i, 0.09350133092340443 + -0.035001271354895794i, 0.01834536321754664 + 0.03725090423053952i }, { -0.06434154321261927 + 0.022556963632601516i, -0.03169392153908255 + 0.1558921103658243i, -0.06260887711206432 + -0.053117036653578566i, 0.06484905980070907 + 0.1027834717023783i } }), Matrix({ { -0.15617885676687074 + 0.09347947385619335i, -0.10245273966972886 + -0.015517054337912705i, -0.054598000532132325 + -0.13217281479301835i, 0.0026053360586554587 + 0.017955816373040747i }, { 0.002000166737884525 + 0.05934140702240302i, 0.0011541124027494634 + 0.04545369790642444i, 0.040042681863298984 + -0.046582693844080154i, 0.08179098474885955 + 0.0544383800215274i }, { -0.1261901069786844 + -0.07790782589931307i, 0.11875118062236285 + 0.05314206791999999i, 0.10450214652473852 + -0.07169930132282894i, 0.15743106726372413 + -0.024169445629512065i }, { -0.03490152795435196 + 0.253759767562249i, -0.15067256676343566 + 0.0169113505684598i, -0.032244023326966985 + -0.10898699375748683i, -0.09949367391648499 + 0.09699346903630457i } }), Matrix({ { 0.11171979490838661 + 0.01198065986030202i, 0.030978704915482744 + -0.09628152332187546i, -0.06390645348443474 + 0.016776946630458752i, 0.12387242684827693 + -0.05948109061563475i }, { 0.13569116157573224 + 0.10617304845811193i, 0.016634926777706397 + -0.1309607102828859i, -0.06509259911292803 + 0.0363231473332425i, -0.07069079002117805 + 0.03876755638505913i }, { 0.1309215209474503 + 0.04468508258333919i, -0.0760276861066358 + 0.001861298234288496i, 0.021848174879960172 + 0.1036601041493745i, -0.05070107285483093 + -0.04717562815219102i }, { 0.044576037224339865 + 0.063109094313336i, 0.06824211813159313 + 0.015072895226341731i, 0.050920344430486236 + -0.05131107934558125i, 0.1646934945182195 + -0.023474282677700933i } }), Matrix({ { 0.020811356430614047 + -0.13059220026640073i, 0.07996393558784184 + -0.03450060586506397i, 0.02908921361336076 + -0.12524732794750762i, 0.04441411586454376 + -0.10866910381966943i }, { 0.106826705879355 + 0.07358292482229113i, 0.21409155921452652 + 0.10235467535994774i, 0.04804297812214109 + 0.03200177102290365i, 0.02780230411348811 + -0.003215999430793839i }, { 0.035700828934373444 + -0.02658887070068528i, -0.02431793119062231 + 0.04161158196022505i, 0.05638520917730918 + -0.047163933162287314i, 0.11864330936982134 + -0.05424970723570064i }, { -0.05892086383488507 + 0.00693964770038353i, 0.10083164081564876 + -0.06698920322297222i, -0.09674460038536974 + 0.0914110357162965i, 0.02832349417547278 + 0.07436789802615398i } }), Matrix({ { -0.017384594582393924 + 0.09290034118832177i, 0.04642332594677737 + -0.0912692099797017i, -0.01060569946062047 + -0.04507542874012216i, -0.0092051618352987 + -0.08412676539933367i }, { -0.014036604546415216 + -0.01992340658801011i, 0.047716901553366234 + -0.10175438565451368i, -0.0706519465058057 + 0.04661693548618346i, -0.07763923066004626 + -0.0010316168646851984i }, { 0.054997368488600346 + -0.00031402805689349886i, 0.07488273529486499 + -0.19686944669779965i, 0.11600741019901706 + -0.08703408897985472i, 0.05817965170442098 + 0.058196032984854124i }, { -0.13857687055559137 + 0.1590089216321989i, 0.020563756106778616 + 0.046792341789813174i, -0.04329008045350129 + 0.06914347963052288i, 0.1307613918269165 + -0.05438735480018478i } }), Matrix({ { 0.07079329583225634 + 0.02998618410129892i, -0.02080687750585259 + 0.12484455952558794i, 0.044561486282026275 + -0.0013146391332521789i, -0.04203698173731413 + 0.04892578956866337i }, { 0.09030239641255311 + 0.050811220241113154i, 0.1663300294279353 + -0.04245666485916876i, 0.08079123290062794 + 0.1945051985797731i, -0.09374989590578024 + -0.05259726538424153i }, { -0.04279805156769353 + 0.07360533096213143i, 0.0252582324068734 + 0.008492712775348422i, 0.06448353232771598 + 0.05293534257086712i, 0.07477980417451038 + -0.0060011988807091255i }, { 0.08491204747794454 + -0.02650071165908878i, 0.08865164618919309 + -0.07407938710199498i, 0.045796054340589705 + 0.02495158469530218i, -0.23205352688811395 + 0.10503359574371235i } }), Matrix({ { -0.03156976141487215 + 0.020249237075640865i, 0.09346106011718146 + 0.005271338019467121i, 0.07523881750077238 + -0.014157194745842743i, -3.796659991953518e-05 + 0.06196474635763174i }, { -0.11152439919206193 + 0.019646130544073454i, 0.06903554271465767 + 0.08830760239091556i, -0.02357276409315932 + 0.24851412947899282i, 0.10491596412023974 + 0.0024845893307904555i }, { -0.00988296688819894 + 0.026750593190068804i, -0.055837147747837865 + 0.023182219421762025i, -0.07992829769950356 + 0.07979853292598921i, -0.017672579077227905 + -0.14810695670160196i }, { -0.036898583310505405 + 0.07596462544508004i, 0.14797116925927944 + -0.1916328855745596i, -0.18193769325670625 + 0.03272748040126931i, 0.05271218257219208 + 0.014015387566650536i } }), Matrix({ { -0.1473719367315971 + 0.06525304300203946i, 0.11053574850373121 + -0.09400237807061396i, -0.011186898941383031 + 0.08740841071377163i, 0.08686650175173814 + 0.017299333349758365i }, { -0.09057127596249931 + -0.17839342146785123i, -0.11465098531921747 + -0.0038940465261073864i, -0.14129770460266372 + 0.16496464389221552i, 0.010543693560267214 + 0.08899027602204368i }, { 0.018309844093684267 + -0.013224638885145771i, -0.03435679967598379 + 0.08265341510624831i, 0.10578094471108171 + 0.21718448083370953i, -0.08777562818929507 + -0.09710242104084535i }, { -0.0825226850833183 + 0.027729725522452568i, -0.12104651185045237 + -0.12480341627374693i, -0.10044910490247758 + -0.05170648739238119i, -0.07755256794033705 + -0.055279979675408035i } }), Matrix({ { 0.04378427066159478 + 0.09008709924799053i, 0.19491557272412655 + -0.06969098246911114i, -0.14149574957999875 + -0.035768187723020976i, 0.04111942385694355 + -0.07147923072846596i }, { 0.007842352089226207 + -0.0373111481966133i, -0.026009611074813782 + -0.010680654718795046i, -0.049502210257299326 + -0.012989649907783571i, 0.022998053475218595 + -0.04782045620711918i }, { 0.1681263383271667 + 0.15318607865295314i, 0.005141520494711565 + 0.10684490797657104i, -0.17119981194897987 + -0.05581993491330712i, -0.07203946041328994 + 0.17330683563012225i }, { 0.03853374145557416 + 0.057317748059801076i, 0.058866453343166786 + -0.21126035602860377i, 0.026917433105881145 + 0.07079150356211661i, 0.017236130322410004 + -0.07722564593059787i } }), Matrix({ { 0.013982032328067948 + 0.04230691171323856i, -0.055983886653620876 + 0.0004971664351278459i, -0.06195418751184194 + -0.10521881129979488i, 0.005188701238880857 + -0.0775587203373589i }, { -0.10168439163444082 + 0.006832892827980103i, 0.010284367311450717 + -0.008809875755171505i, -0.07262878995538219 + -0.019036016351756026i, -0.09721471742531917 + -0.03109965897383519i }, { 0.13365802959683917 + -0.053445123987640335i, -0.03318290158113144 + 0.10215269611377098i, 0.06512090447279412 + -0.07297582126037462i, 0.14635390817405425 + -0.05666912922897186i }, { -0.09163362988643621 + 0.09568940484632182i, 0.06213428439849511 + 0.06703170492862383i, 0.06127502886460159 + 0.06905173980687161i, -0.11421936490285363 + 0.10474394003436732i } }), Matrix({ { 0.11585342142217184 + -0.07745651849405864i, -0.14139736486828475 + 0.043257180751557586i, -0.017128825227843657 + 0.11655441769500706i, -0.06556176387570398 + -0.15004382514815975i }, { -0.10682004924680205 + 0.03177362982903031i, 0.07637887485628925 + 0.10206328424065284i, 0.001710221707253904 + -0.21869073830614832i, -0.08121125720840927 + -0.12925538382317042i }, { -0.015805203856270936 + -0.025631051700683725i, 0.02274751262024662 + 0.04291765693983253i, -0.11230182258989105 + -0.10297846764220747i, 0.059447353084175626 + 0.06531827387328752i }, { -0.09389758464025161 + -0.0712861081390846i, -0.010168865510296122 + 0.10995486260284672i, 0.1662113280812288 + 0.10417703566441838i, 0.05483526114491673 + -0.10994636960455464i } }) }, { QubitIndex{ 6 }, QubitIndex{ 0 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { 0.3558446215822624 + -0.11737478068851978i, -0.5700997927998617 + -0.7311525096714455i }, { 0.5417253134021591 + 0.7524170724861519i, -0.21254326669279344 + 0.30858968491227556i } }) }, { QubitIndex{ 4 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 1 }, QubitIndex{ 5 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { 0.4461561766001338 + -0.563003433850074i, -0.6761359565528124 + 0.16374360387810222i }, { -0.6731047765850822 + -0.17578896237512118i, -0.43603342952169716 + -0.5708791893080111i } }) }, { QubitIndex{ 4 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { 0.0065264992298481594 + 0.07884695995608414i, -0.0047301617429656925 + 0.02077182399735822i, 0.09376745853548273 + 0.08809166760095627i, 0.15147487032138332 + -0.09618295464161203i }, { -0.0003444091081724991 + -0.023671576959228054i, -0.07112218649971025 + 0.13545167118948961i, 0.043039700032182944 + -0.043860643094065684i, -0.10532704735566507 + 0.09036327748462795i }, { -0.10200588237002521 + -0.04960903273840086i, 0.06628503099972044 + -0.009777251088933138i, -0.05423265875075047 + -0.07026984702490952i, -0.04730365855135022 + 0.004054273192161061i }, { 0.2208885336474037 + 0.17232380599113878i, 0.10617876594639024 + 0.0023860369058798293i, -0.1278571371194385 + -0.0640339915009491i, 0.028981219424080544 + 0.09364365839114518i } }), Matrix({ { -0.005417750241724023 + -0.14956250436823254i, 0.009365175182111307 + 0.10370187054870807i, 0.05446132156984166 + 0.06835423795107175i, -0.01752651628812586 + 0.03274904363257076i }, { -0.0544080217438167 + 0.07175716570186576i, -0.040405351469934396 + 0.19366615541110896i, -0.011165211416374925 + 0.12980133386594686i, -0.15887000662361114 + -0.11085627611602714i }, { -0.005900955849785944 + 0.13303795837528443i, 0.09785272025437022 + 0.14097486853209232i, 0.01722489149238765 + -0.0648586009179477i, -0.01363788352519962 + -0.017064171197767066i }, { 0.013260693076012874 + -0.023466711491814694i, 0.1729276266374589 + -0.01717901134641871i, -0.13653912157114104 + -0.06024907446413229i, -0.08251870061092906 + -0.03487947256265528i } }), Matrix({ { -0.04716957942706834 + 0.008462620447063729i, 0.15287794319588058 + 0.08161043568540699i, 0.021649285107870276 + 0.21542944329209582i, 0.003968598525155986 + 0.005312907237603375i }, { -0.15969813490839244 + 0.029850137523703933i, 0.027947591871209324 + 0.0038362890177147746i, 0.02383274463031816 + -0.07018828991211952i, 0.05381123579568157 + -0.06341914239758607i }, { 0.05271404776515652 + 0.01308626367097781i, -0.0031835594266949683 + -0.0437726140664883i, 0.005173621677951737 + 0.20450948413980843i, -0.11254470624523974 + -0.04183321214523221i }, { -0.09628747472077309 + 0.16665923025117282i, -0.033297994350110466 + -0.011021626597296576i, -0.03827172026266078 + -0.010006668125449102i, -0.13182495358591553 + 0.08426868477265916i } }), Matrix({ { -0.11716758672091732 + 0.10806253322707304i, -0.125009192171844 + 0.02994180171008784i, -0.14878789115340574 + 0.03822833204601361i, -0.0894421185979632 + 0.0026743811482301564i }, { -0.05960924544787451 + 0.11949716633391197i, -0.1263262926760914 + -0.05392528630993052i, -0.045535281397205814 + -0.011326733972439213i, 0.1867006425742562 + 0.029761051276565968i }, { -0.14085365586088977 + -0.010662369728986583i, -0.07975502859539588 + -0.1405170615585337i, 0.0720492927914935 + 0.11307715891369792i, -0.06653912668191933 + 0.0469432406109306i }, { -0.015407352421947289 + 0.06525971913186446i, 0.060137292063662744 + 0.02456806089928149i, 0.007101331010489907 + 0.016460086905831044i, 0.0353767357698766 + -0.12279828989021511i } }), Matrix({ { -0.1887161037242344 + 0.05009749293986194i, -0.02396555335707246 + 0.020017324819667434i, -0.13158892839478806 + 0.052482660475160425i, -0.051363587422988556 + -0.019331310938066237i }, { -0.10759729649461229 + -0.01421312960223687i, 0.013399217124764603 + 0.11857669988145754i, 0.0059757808016060515 + 0.1448507419878795i, -0.11144245653280657 + -0.10162258389629104i }, { 0.035498266400194795 + -0.02034232208255251i, -0.07003854310573203 + -0.13202974439963203i, 0.11922173242272138 + -0.15479155138854528i, -0.02476341453002414 + 0.0248150989396141i }, { 0.07604584463003441 + 0.008516222855216141i, -0.0014336351531477535 + 0.08113656956334209i, -0.012283618037200726 + -0.08970870249397185i, -0.08466878238011834 + 0.06618942493086617i } }), Matrix({ { -0.013905337968564854 + 0.04411001818159171i, 0.08198754910600536 + -0.02201996060134088i, 0.10161837612512735 + -0.053302867091538406i, -0.11400156009645103 + -0.08028388334620902i }, { 0.13259050422634808 + 0.03725446488741803i, -0.1124794600034626 + -0.15156650511356232i, 0.0834862053419262 + -0.15709527552653754i, -0.10617950663484586 + 0.17247423862839403i }, { 0.10252363157496097 + -0.21179142842691712i, 0.03256694754723333 + 0.12487853282910248i, 0.15607912695431658 + 0.12208746338490514i, -0.08478752026306893 + 0.017035591875902326i }, { 0.08734094472879991 + 0.022745200269843908i, 0.06172379747562805 + 0.19025485203447529i, 0.065431908223201 + -0.1418750457547192i, 0.16127896992603927 + -0.11084811587396504i } }), Matrix({ { 0.05683475437589268 + -0.028827829139602412i, -0.0510302546887283 + -0.017130781640034915i, -0.07945542599920676 + 0.22520154318099306i, 0.06992227069577274 + 0.056484427354392824i }, { -0.09695868898773725 + 0.08079078417010505i, -0.04484768530247366 + -0.042976445339478704i, 0.11150891520838183 + -0.008154818290339554i, 0.0012309508472159022 + -0.19481639626626088i }, { 0.09623546440974357 + -0.05060080826999478i, 0.03815144614817661 + -0.08181179557886735i, 0.0315882741678432 + 0.0227374360590795i, 0.03395701751811176 + -0.1602308240546006i }, { 0.04287029957401166 + -0.03794299543848836i, 0.0700419829572936 + 0.13399272285476507i, -0.03370232251139818 + 0.04212964235604073i, -0.0029105243536526625 + 0.019071512687338314i } }), Matrix({ { 0.05494025651076195 + -0.03094165001458849i, -0.11135060363388725 + -0.14338909369404101i, -0.07067368619736397 + 0.0212083279872477i, 0.029669289161708978 + -0.08070797354010203i }, { 0.007754656709796212 + 0.030865016877451617i, -0.016910675142819447 + -0.1525602107592538i, 0.07124013834958903 + 0.04436899284780471i, -0.0550330351022405 + 0.015509988468625637i }, { 0.04674286650401367 + -0.17552389131756185i, 0.13905230430174725 + -0.020661832040983125i, 0.028394732187389634 + -0.21256505942184206i, 0.025343952886471177 + 0.010760933844044309i }, { -0.006916856739072459 + -0.0366018689231165i, 0.0652984991423408 + 0.046972491854499705i, 0.16580198480443947 + -0.10793148164465037i, 0.1926500300333274 + 0.10766311312125992i } }), Matrix({ { -0.011260149345787672 + -0.1381716438399568i, -0.10349478024797525 + -0.023306030673965788i, -0.02484927291601445 + 0.0449277065140097i, -0.1278732915917795 + 0.05204356538723227i }, { -0.05446371845757483 + -0.138622067979241i, -0.1942370462550371 + 0.06938319409392762i, 0.007128473035671671 + 0.04607707950645762i, 0.06194428064461195 + 0.10505170488449479i }, { -0.04601326578389209 + -0.0690788416519148i, 0.08219050475899467 + 0.1501723620015508i, 0.005614555725978648 + 0.04837223070699324i, 0.03035255131010586 + -0.064486304682067i }, { 0.02189189010881693 + 0.024065549015312025i, -0.08524536857084468 + -0.09843547428343793i, 0.18274505762722082 + -0.12099694086621189i, -0.0063056847030585625 + -0.15029477735721117i } }), Matrix({ { 0.07640437618138046 + 0.07679039467057858i, -0.05941511394910923 + -0.1160843130885238i, -0.07485592084092513 + 0.035076159037056936i, -0.031164443328406916 + -0.12470551189867933i }, { -0.04318250790326124 + -0.09488489764442713i, -0.03203323322370989 + 0.11225785872239855i, -0.1130065773508469 + 0.03709339071155674i, 0.10230714997770742 + -0.03506757706971253i }, { -0.021937452729439144 + 0.07454694185172969i, 0.1139658739397357 + 0.08841038602328782i, -0.10803638479470618 + 0.07217878677452322i, 0.08633841690284468 + 0.02695700512071858i }, { -0.09004015792684207 + -0.00816299609153968i, 0.030912360599278512 + 0.14037728727499696i, -0.08312788918313914 + -0.0549586464108487i, -0.024077484384198725 + 0.11350304444771048i } }), Matrix({ { -0.17462496079697648 + -0.07658168734896091i, 0.018403962963329797 + 0.0489122202226223i, -0.06301179548385427 + -0.0022218706771213034i, -0.04036449746021315 + 0.07393075885348062i }, { -0.1143026985133608 + 0.05559627298151179i, 0.0026961812584480617 + 0.02595734821269728i, -0.04235343916853226 + 0.014629183669061073i, -0.0896543258968419 + -0.04805402107169549i }, { 0.012322958621189409 + -0.08385482386450542i, 0.16410633137614672 + 0.04289135769113004i, 0.04378211377354016 + 0.12956432301658055i, 0.093344015296103 + 0.056502554238340455i }, { -0.00941621507304467 + -0.06502155177435807i, 0.12587024967104152 + 0.1065186573120783i, 0.04128632879178792 + -0.1434852880989093i, -0.06054421925785549 + -0.0372732100813074i } }), Matrix({ { -0.06431632407245917 + 0.04105247414948422i, -0.10524444400104399 + -0.023645024357008333i, 0.14130485216328065 + 0.1856562772558016i, -0.010422680495662095 + -0.05353843311794935i }, { -0.0830235780795163 + 0.11156756227672704i, -0.19444499811692967 + 0.012679845685501687i, 0.058793454214569094 + -0.024949343108277608i, 0.32380083880475535 + -0.033733845183179866i }, { -0.10829929892501892 + -0.05417054480005908i, -0.15790502724367225 + -0.027292234402812067i, 0.10478637296392006 + 0.09696539154959262i, 0.10318713662867937 + -0.011873252797086564i }, { -0.06092265248877649 + -0.10423949265587835i, 0.09401392988476084 + -0.018837033563697626i, -0.08903550982155803 + -0.08487401746262087i, 0.09797978522573562 + -0.10264561193713896i } }), Matrix({ { 0.00881811646417249 + 0.0838096812309025i, -0.050216087895131406 + -0.05000897514121097i, -0.12459602585512296 + -0.050910775108983515i, 0.016139255721253586 + -0.05350015537581413i }, { -0.18924469132053245 + 0.06573320362884143i, 0.056840682100768286 + 0.05759391049505954i, -0.051902757797285544 + 0.024052114792731186i, 0.08195053471517182 + -0.0630112586064707i }, { 0.026585876706884073 + -0.13850633552507527i, -0.13832205314223733 + 0.14519101994699044i, 0.01608095634706578 + 0.05973779416426469i, -0.1702108849375606 + 0.05831158905401029i }, { -0.04077252371984526 + 0.015507914413419071i, -0.0026727881177805537 + 0.04060056318285425i, 0.020987901998306534 + -0.025838790267396338i, -0.11852647459659316 + 0.022547675402775556i } }), Matrix({ { -0.008907201925354966 + 0.053443154008229764i, 0.07735631212388468 + 0.029241745553401137i, -0.015321419895454512 + -0.1670051036605502i, 0.02952540962713887 + -0.023076547393367952i }, { -0.04056182847410841 + -0.15808433806425923i, -0.0026079951262569447 + -0.02636048823653144i, -0.01572225339278948 + -0.12743513681432803i, 0.001000298554192988 + -0.009294272647331023i }, { 0.07593938404550314 + -0.043589728317302526i, -0.0505513026257644 + 0.059344250899470714i, 0.03678263711894393 + -0.0028306844496073253i, 0.11704575060106887 + -0.08567272618749873i }, { 0.057071800922814206 + 0.030164346334655708i, 0.0779426935804645 + 0.06053108740056064i, -0.01962467371995129 + -0.11083441104456926i, -0.06857450175353398 + 0.15097537514057718i } }), Matrix({ { 0.13720616389191415 + 0.015598002731939802i, 0.022182444290554947 + -0.04835912390414363i, -0.04500603569359713 + -0.02332089625052313i, 0.00812631415458804 + -0.06054418442473638i }, { 0.06644669988712909 + -0.15453141656255845i, 0.1244437259214362 + -0.03679189457770607i, -0.012041976568636302 + 0.1610422504041618i, 0.06589784392515122 + -0.03967035473382621i }, { -0.16994940331084205 + 0.040832200793100314i, -0.05571772122176085 + -0.18004407782564022i, 0.09415330531367243 + -0.04839673885743784i, 0.04385736421804503 + -0.03976675906663604i }, { 0.17197189792878895 + -0.038251379224350956i, -0.06258461119997098 + -0.01667273585146968i, 0.008321725579208294 + -0.027976072668148482i, 0.09873433319451343 + 0.05991301808058651i } }), Matrix({ { -0.19446191518534708 + 0.03495024922501527i, 0.024446478541419257 + -0.10348854809480723i, 0.00688734774708244 + -0.033132533674453866i, -0.08643094028393439 + 0.1571605996986132i }, { -0.11407240989912566 + 0.11405834138637558i, 0.060635565305979106 + 0.1381248504410001i, -0.12191883074129506 + 0.07092269166977373i, -0.10205390846300785 + 0.05085488748797257i }, { -0.013897595895909496 + 0.0018313048696670616i, -0.019745447038304043 + -0.0029565416109187557i, -0.009901254784816696 + 0.023145187358428524i, 0.1251460219132022 + 0.04364490668067313i }, { -0.05290816455572873 + 0.08916834285337029i, -0.014208540492051204 + 0.0063622818076835685i, 0.03156776209681245 + -0.013454696775947914i, 0.06567177577045405 + 0.09200744296018193i } }) }, { QubitIndex{ 1 }, QubitIndex{ 2 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { 0.4616548652537962 + 0.07571013487767449i, 0.22900704578617725 + -0.22196356644814724i }, { -0.134612809684615 + 0.43826621919678116i, 0.33495938789496943 + -0.22962656832293724i } }), Matrix({ { -0.08131898837072966 + -0.1884815075668912i, -0.21387384507217402 + -0.2015205339396447i }, { -0.32263233879461145 + 0.36164968258924424i, -0.42652551061700467 + -0.18796618046637062i } }), Matrix({ { 0.1284695607746987 + -0.0833975539503455i, 0.250054052802675 + 0.3488699122111641i }, { 0.35821187344224825 + -0.13766758912158789i, 0.08219478521986687 + -0.03640546512210754i } }), Matrix({ { 0.1656753944072226 + 0.20746117918919466i, 0.0730581301431617 + -0.03620225047168998i }, { 0.11601662954762644 + 0.19811277342088654i, -0.2499939332620983 + -0.4102320157608697i } }) }, { QubitIndex{ 1 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { -0.2644625338068882 + 0.05807329558741957i, -0.506993714672614 + 0.33167830906927687i, -0.1627284714660003 + -0.6718112039513322i, -0.16436519758658907 + 0.23410930303938704i }, { 0.5986704420033077 + 0.621069298819761i, -0.07927702099051724 + 0.07046273621001779i, 0.22274665649329872 + -0.2840575421639159i, 0.156637456473465 + -0.2996276550556306i }, { -0.17950718506278135 + 0.31861421024199876i, 0.09918898448427793 + 0.11874770390690993i, -0.08211556546472021 + 0.17869008482994908i, -0.8223523899179043 + -0.35691191911269177i }, { 0.06827953257488087 + 0.21012793593715898i, -0.32243504115591426 + -0.70270420642876i, -0.5931339898477299 + 0.03746128881712445i, -0.010798370629961584 + 0.009935572025117946i } }) }, { QubitIndex{ 2 }, QubitIndex{ 7 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { 0.5673995624906655 + -0.33850680517672205i, 0.05379925158890539 + -0.7487165818004323i }, { -0.42181435612658963 + -0.6209215154107324i, 0.660648357568494 + 0.008536293551723681i } }) }, { QubitIndex{ 7 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { -0.04271304129535558 + 0.12460511109473905i, 0.020222356946425046 + 0.07628257414218309i, 0.05925144005760682 + -0.009786156096856236i, 0.03916827544163972 + -0.025919484500778776i }, { -0.05843589204711896 + -0.0547251779182835i, 0.19666997341455525 + 0.0034495452889939282i, -0.005683601925889518 + 0.09535700090389096i, -0.034160991673248244 + -0.015817999163772654i }, { 0.03980733227762754 + -0.11830724635777311i, 0.10914120068987403 + 0.008251510647753446i, -0.07634209573886612 + -0.11828086110039643i, 0.05301840694455809 + 0.024593294032543723i }, { 0.06816328030833967 + 0.11887875915668193i, 0.10472491139634105 + 0.113376008796747i, 0.1184071767057766 + 0.015762161562988142i, -0.044897645171104394 + -0.2127565845672796i } }), Matrix({ { 0.10068645817375231 + -0.09906209031799132i, 0.06021532703080974 + -0.03005985364014684i, -0.06015686593964324 + -0.014022939856353497i, -0.03013994897683672 + -0.03010453809081914i }, { -0.013931437965955517 + 0.09120170142833872i, -0.027076916687722948 + -0.1126639898754026i, 0.08492834640917846 + -0.028858201315904504i, 0.15239590826535926 + 0.07725287494817862i }, { -0.018664407384074464 + 0.030253537888026285i, -0.08388045599219489 + 0.08261402996497771i, 0.05673148232420069 + -0.08905298868881888i, -0.06845330186867693 + 0.1954188683709259i }, { -0.07075103973027427 + -0.08019346261119664i, 0.017061088473584736 + 0.029425703306692017i, -0.0752233278774066 + -0.15845104181040717i, -0.041250598750486665 + -0.15722619422562617i } }), Matrix({ { -0.030592193622685254 + 0.02123954757887264i, 0.0620199904570741 + 0.1467929150278722i, -0.07836026371102786 + -0.1296002338129013i, -0.013188833058623017 + -0.03854212002886554i }, { 0.11922674774555056 + 0.08188572773782839i, -0.14833603916707644 + -0.03223533428927517i, 0.0506623606455611 + -0.003061371254511085i, 0.17256936254980218 + -0.15523505505368249i }, { 0.025082338600575044 + 0.16074446894432434i, -0.05345458869282456 + -0.08381280426011468i, 0.043713581330706436 + -0.12062961723244922i, -0.010067730670803944 + 0.043573333137163925i }, { 0.009797675239336908 + 0.09668700529681297i, -0.21239637243663664 + -0.022681445992670742i, 0.036376255162349436 + 0.14932520301269353i, -0.10843898711854026 + 0.025061360956483803i } }), Matrix({ { 0.11709051106387149 + 0.27078481159800144i, 0.06068375768661898 + -0.05850142618692821i, 0.07853715137282266 + 0.014129777281877873i, -0.07513336498324483 + -0.22560847707723367i }, { 0.12691670044029688 + -0.010361237374536201i, -0.07972633933766254 + -0.10521911294471817i, 0.10500391983857549 + 0.09437043717247756i, -0.08059650786517322 + 0.18996656291656014i }, { -0.02939547646746115 + 0.06780022903404592i, -0.06178407083573137 + 0.02096104228724238i, 0.07646484804438049 + 0.0531468512779611i, -0.08830944625969948 + -0.0002602332125602883i }, { 0.028825831607433773 + 0.09368222003665762i, -0.04635393795212923 + 0.11869516540393732i, 0.08289107501175115 + -0.10517210165320401i, -0.03625900014912604 + -0.005810095245396006i } }), Matrix({ { -0.018124273386990398 + 0.07461649555313062i, -0.1133123806803539 + 0.18354465405989348i, -0.06096497989563343 + 0.17491567914211234i, -0.028467742187884133 + 0.04923125451451978i }, { 0.05278544023991061 + -0.16672678558732332i, 0.11175259395958795 + 0.12365298653273814i, 0.041678684350487605 + 0.12687299640232483i, -0.06504932660936152 + -0.03426712708308696i }, { -0.024162337865920085 + -0.044031610028901214i, -0.11192251953528248 + -0.21661395691996965i, -0.01165816130604225 + 0.0383427666068465i, -0.001732273083266901 + -0.03084827314085253i }, { -0.061652523096647475 + -0.05008063003738191i, -0.05541635702717871 + -0.04168753933205076i, -0.11850019275203091 + -0.10389612848208483i, 0.014996178693530853 + -0.09689195118195477i } }), Matrix({ { -0.0012980212121409661 + -0.09412664200251764i, -0.13566739768810693 + 0.10716214067108523i, 0.1210002450178435 + 0.13870194780605133i, -0.22634801812385205 + -0.021863545167816946i }, { -0.14048910532241504 + -0.05164827628380993i, -0.016586102334029695 + 0.004788368786092509i, 0.17444641036790484 + 0.009415716443191433i, 0.04723023533476417 + 0.02128709663859779i }, { -0.10764202058793476 + 0.0014503107538152427i, -0.04900647219054673 + -0.09955961581407587i, -0.025618745332607818 + -0.05788178161983765i, -0.09676268668701686 + -0.052131930922508805i }, { 0.04970863125945337 + 0.03232831771807107i, -0.01390975570890982 + 0.04253256699281507i, 0.02566657717773465 + 0.0491969372144146i, -0.04763939513808571 + 0.24063389882546468i } }), Matrix({ { -0.05417917642757997 + 0.019348217109554398i, -0.08934446368945054 + -0.02339130611816409i, -0.11436608363093773 + 0.04222172616869859i, 0.11289970232112036 + -0.06694051677868434i }, { 0.11573910988492797 + 0.05355772315339907i, -0.02487192363097573 + -0.10549281479497578i, -0.02235428119989204 + 0.028145242488311205i, 0.09900603490998926 + 0.06164494307893652i }, { 0.08837199821903038 + -0.023828296479542037i, -0.013791951187896926 + 0.002097852317980102i, -0.00492296062841509 + -0.01909670968594537i, -0.024096117982875104 + 0.03436519475477672i }, { -0.004548538198278327 + -0.05897412558180932i, 0.12720426534764942 + 0.007573847062057461i, -0.05115300873405754 + -0.0034796176966093192i, 0.013988552057496927 + -0.0340537611009318i } }), Matrix({ { 0.09514556303504383 + -0.011501567502190176i, 0.006672619442767517 + -0.0014118487478392448i, 0.024195024408377546 + 0.1251362826657736i, 0.015697236497143597 + 0.041221321490335826i }, { -0.062144804563207715 + 0.16759691997121332i, -0.028106123644429493 + 0.007045785469834096i, -0.11201830898767319 + -0.03804412675577065i, -0.07245725768975882 + -0.1313613390928373i }, { 0.1725132095578715 + 0.0327907817060404i, 0.07789879115401768 + 0.07038788096082531i, -0.12174989445520201 + 0.09510217678509077i, -0.1735915197033712 + 0.01586575039871851i }, { -0.041067901357819396 + 0.20107381067679364i, -0.145807751962506 + 0.0996342788270254i, 0.039975084270410445 + -0.018687317232794275i, 0.052992408277744533 + -0.004757064268268639i } }), Matrix({ { -0.13815263606197456 + 0.010909015027905034i, 0.07522713501531433 + -0.1193305483534312i, 0.11525296268866068 + -0.015716883064327433i, -0.0870907523131938 + -0.04775212127510168i }, { 0.05723299861510749 + -0.05174702907001275i, -0.006223550880250277 + 0.09532466962274251i, 0.08415306320254813 + -0.06662388796638131i, 0.12740410591469364 + 0.09431722097279102i }, { -0.0018981295174593559 + 0.0595716859536406i, 0.2171527950549007 + -0.0160842936380467i, -0.18962904633600144 + 0.0314934661243025i, 0.002873423457805528 + -0.08579996693446419i }, { -0.06361905296792393 + 0.19450100778632745i, 0.19182453284150447 + 0.10476368078307623i, -0.04352749381917229 + 0.07763224672997271i, -0.023474151559094644 + 0.07467049845113909i } }), Matrix({ { 0.07392423333965903 + 0.14509494265854686i, -0.02903079875204582 + 8.594503300698925e-05i, -0.07322651555316116 + -0.04644577512138685i, 0.15173170984880324 + 0.16023270120019184i }, { 0.021764695634826692 + 0.1423515891500052i, 0.1027441073206463 + 0.1556473302213376i, -0.022692868946434765 + 0.14165281001016458i, -0.025424384772146924 + 0.006295492768969078i }, { 0.036810503712479785 + -0.01420624984774342i, 0.08012408270530601 + -0.0484024147999064i, 0.02411191932929859 + -0.11915794055256455i, -0.05741178403491649 + -0.17067515891369023i }, { 0.08859792520370065 + 0.007757447619013591i, 0.04796691039977799 + -0.09737710576721462i, -0.14502358483610941 + 0.06360654327128727i, 0.04942397126104279 + 0.073298347912788i } }), Matrix({ { 0.16922030308118546 + 0.1150543586890402i, -0.011449712806746982 + -0.00045123746004452716i, -0.025269424581807923 + -0.1448285642957871i, -0.08926939024170485 + 0.08117066211486008i }, { -0.06614872491447683 + -0.09815753980346482i, 0.0006131072203276098 + -0.034397353157962475i, 0.24800223387638035 + 0.055857218964817566i, -0.05484799906826299 + -0.11787647315725805i }, { -0.05995143464287325 + -0.03543178039245111i, 0.20154272826534234 + -0.0644755747681947i, -0.006447161706901201 + -0.13352033108450015i, -0.08498389489445743 + 0.02463928834612241i }, { 0.0011861399245477779 + 0.21257001136199388i, 0.07773383089910907 + -0.026628181945345036i, 0.015479733238757449 + -0.007294882654125055i, -0.048485334241251836 + 0.21958982827098447i } }), Matrix({ { 0.07362776557947795 + -0.013891392774476864i, -0.06309192230980308 + 0.06845438341228666i, 0.03409114861413476 + 0.10902663678365329i, -0.052178412678573274 + -0.013433247343236214i }, { -0.074607689647736 + -0.07246226084216953i, -0.18760224292735145 + -0.07191938883701575i, -0.2346704954873437 + -0.03431047351874591i, -0.07851843393830778 + 0.09971828576721714i }, { -0.017446464344937778 + 0.011234506700354644i, 0.07591210711959107 + -0.040561506023701004i, -0.0031645156875049684 + 0.08343091674231187i, -0.01029481621204172 + -0.01892544479019189i }, { 0.107571665696298 + -0.053627581423830104i, -0.09560582852788704 + 0.048028181057098i, 0.0015420987441962634 + -0.03708851722646979i, 0.009471871415923802 + 0.0032302783765461693i } }), Matrix({ { 0.01907225062993341 + 0.04896568611908855i, 0.11709168554244 + -0.042226769615969245i, -0.12921626186228735 + 0.17527731906240276i, 0.12200936844221849 + -0.09958579632564121i }, { -0.02223610978136846 + 0.188741570538904i, -0.007364855861523732 + -0.12259391606079986i, 0.022614015303902005 + 0.228877328830451i, 0.12136722902636632 + -0.0764970259373459i }, { -0.10006628154825577 + -0.06655849630100566i, 0.0011708969489809512 + -0.08701578975720861i, 0.020710349262596094 + 0.033404027024544355i, 0.026663092794124727 + 0.0841391306574866i }, { -0.01726253920133819 + 0.0006421923769521715i, 0.01605055970461519 + 0.0004358598960183558i, 0.04566944051719923 + -0.0808054513623846i, -0.026854420822316663 + -0.009234341455238855i } }), Matrix({ { 0.06994487448227746 + 0.07259905753627531i, 0.070566801226244 + -0.08038859590044735i, -0.025967512036757828 + -0.022967503015605267i, 0.05109112095241529 + 0.028953800354379878i }, { 0.09276401976276019 + -0.054279135000279206i, -0.10656708858454665 + -0.019549853000178037i, 0.003027847154920406 + -0.02383476080719334i, 0.06497803729290291 + 0.032432928688608906i }, { 0.023206742693333532 + -0.02478061925220609i, -0.1080939181108103 + -0.028284877925232526i, -0.02523562591948486 + -0.11440125111738222i, -0.13298304402997774 + 0.03925160422090224i }, { -0.08948375790523401 + -0.06112602934188689i, 0.024271426444217255 + 0.0880023757585396i, -0.07111790209162984 + 0.05366154113845271i, -0.06008056031576573 + 0.07526921263133078i } }), Matrix({ { 0.057606528636684216 + -0.13550165074777315i, -0.10434641052102339 + -0.013083537109963917i, -0.06667588415459219 + -0.026768360316088924i, 0.026015125322628247 + -0.03898642857070632i }, { -0.1268519939591099 + 0.05913150603399126i, -0.004794028486099903 + 0.041702399984133505i, -0.14104396779341732 + -0.03030403401023231i, -0.06597955256496069 + -0.15983443132602937i }, { 0.008605966252399476 + -0.032621848268891834i, -0.01337987639951002 + -0.06744068324752524i, -0.061651581745564316 + -0.01083918702617438i, 0.05860350565490139 + 0.164139384003808i }, { 0.06682055909696204 + -0.21438006630075393i, 0.06456474959530821 + 0.05590426774192348i, 0.00963057746992859 + 0.1220838702521179i, -0.0626582343617409 + -0.023859742112811527i } }), Matrix({ { 0.08427535250762977 + -0.12199657445236331i, -0.03170252593007935 + -0.032032364708103396i, -0.15696709983017387 + 0.008996910448580446i, -0.09310605625190696 + 0.06154500679473594i }, { 0.023002560419770703 + 0.10492517872363406i, 0.1091078234496314 + 0.042197526601598465i, -0.011721296064830244 + -0.10192378372049231i, 0.0038277718803861275 + 0.024699106608178232i }, { -0.04189715297675077 + -0.05386945734243622i, -0.04049087786211366 + 0.0030104348053522174i, -0.08253845422891565 + 0.036739061931795304i, -0.09255678837404022 + 0.025122431350683854i }, { -0.025434739820228744 + -0.05027807635683145i, 0.21843771739462983 + -0.031909424691549886i, 0.09354015219652545 + 0.06867363151794814i, 0.0336122644291822 + 0.023918590132467797i } }) }, { QubitIndex{ 7 }, QubitIndex{ 5 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 1 }, QubitIndex{ 0 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { -0.03107028087191166 + -0.17208647894674478i, 0.23876905908547202 + 0.4159947474639682i }, { -0.0029373688330861184 + 0.046154463078005664i, 0.035209058130687185 + 0.48383927270899424i } }), Matrix({ { -0.22460044723406727 + -0.21417842934794185i, -0.12046839651006633 + 0.16343489154458174i }, { -0.24250817433779365 + 0.18252212842207616i, 0.24363915874553352 + -0.0011642695365374212i } }), Matrix({ { -0.15377636332108244 + 0.4148365219822435i, 0.010210231257939212 + 0.029025534138697726i }, { 0.276880060012622 + 0.17522172830677124i, -0.37830231952668597 + -0.23149782693973853i } }), Matrix({ { 0.3119256031415772 + -0.18326213952783937i, -0.0350554695082667 + -0.06263540150748496i }, { 0.3344235303576901 + -0.48271761248793993i, 0.41014460365140304 + -0.250980674008666i } }) }, { QubitIndex{ 5 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { 0.20015432527011723 + 0.06852478187065349i, -0.1654949610668952 + 0.3039037661397374i }, { 0.06562562432255309 + 0.5248530893926138i, -0.027020351396618403 + -0.3145497895750807i } }), Matrix({ { -0.11413940666031673 + 0.08944695137037757i, 0.09210446240587615 + -0.05598624161452445i }, { -0.20532693209405828 + 0.30372665655708914i, -0.12008151901010962 + -0.26157460838598134i } }), Matrix({ { 0.09693449947392038 + -0.09612972551959229i, -0.3520428935019616 + 0.38887369759293494i }, { 0.09942420761674861 + -0.3928422152378017i, 0.10548550863730889 + -0.17942079578987963i } }), Matrix({ { 0.20909042861261215 + 0.39556439364050994i, 0.1807736515618968 + 0.25569708620832177i }, { 0.21747982442535083 + 0.2994873098951818i, 0.5177869251034111 + -0.038527032448692905i } }) }, { QubitIndex{ 6 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { 0.03874375180923395 + 0.22624046093483235i, -0.9550134145989277 + -0.1877859245732641i }, { -0.1658876226810567 + -0.9590596812362443i, -0.22529484993650453 + -0.04390962377826546i } }) }, { QubitIndex{ 7 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { 0.10842451173654899 + -0.3120709469764453i, 0.2822756587510136 + -0.307879606082747i }, { 0.07486326182681387 + 0.07123006269876836i, 0.3154824617197589 + 0.26453304027357905i } }), Matrix({ { -0.09033740949146915 + 0.11595941548785171i, -0.005881712647449938 + -0.1292365453486517i }, { 0.2613386228322193 + -0.21757680905435992i, -0.16192534482392823 + 0.08361650504250667i } }), Matrix({ { 0.0234521888814284 + 0.2344243673601005i, 0.2327460656909907 + 0.1539587255834048i }, { -0.18340077365329038 + -0.49235465196288947i, 0.21661963813731325 + -0.055209700835985843i } }), Matrix({ { -0.45811178690621146 + 0.24732025786824413i, 0.5556789277942067 + 0.19009856109068207i }, { -0.3302361794460542 + 0.17688768345275596i, -0.3342107035060763 + -0.14702361764133265i } }) }, { QubitIndex{ 4 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 1 }, QubitIndex{ 3 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 7 }, QubitIndex{ 3 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { -0.18387381206708617 + -0.03480361002817511i, -0.315165004009636 + 0.5764578034820282i, -0.24481309475429475 + 0.17756670221524967i, 0.6126658161537937 + 0.2579220107610779i }, { 0.03501469729284281 + -0.05174028816169812i, 0.3895335815477237 + 0.420830387961849i, 0.07724371224088333 + -0.7685576941655891i, -0.04467182462513125 + 0.2619526573862143i }, { -0.2434497442424994 + 0.302831500467321i, 0.41546479359011823 + -0.11411255591516872i, 0.28626533957054734 + 0.3726084839137997i, -0.008427583759193058 + 0.6652343069404956i }, { 0.809375007266499 + 0.3937174691129247i, 0.0183182472032154 + 0.2314401999562607i, -0.2417042650962279 + 0.18078499901722278i, -0.1535192187583952 + 0.14603496029281116i } }) }, { QubitIndex{ 0 }, QubitIndex{ 6 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { -0.159513858294005 + -0.02473504293048631i, -0.19746435327966663 + -0.5568084662824215i }, { -0.029628765669662313 + -0.26194217586222507i, 0.2115296319411167 + -0.25839657112768605i } }), Matrix({ { -0.07273049123030355 + 0.3291520852145992i, 0.11377744704738176 + 0.2220192521527783i }, { 0.35146331692835214 + 0.18791685354604817i, 0.29971111100863124 + 0.08313272411789134i } }), Matrix({ { -0.11998282671204036 + -0.1025446861092059i, 0.1146006200344668 + -0.3536872897855447i }, { -0.07621107386729134 + 0.4092928914839294i, 0.19347563595562917 + -0.15902293957182087i } }), Matrix({ { -0.3918937102129682 + -0.4076863864706711i, 0.2504610100019135 + 0.2047248881628073i }, { 0.01695225953610535 + 0.33714325410497054i, 0.2148128193178409 + -0.1695472484047563i } }) }, { QubitIndex{ 3 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { 0.383246397318423 + 0.24987039646612966i, 0.017939732619373535 + -0.23658852734706828i, 0.40378355851122333 + -0.23019639943695683i, -0.6816104618745659 + 0.23187637322292132i }, { -0.2844111728241715 + 0.18840071661466484i, -0.10330682098459451 + -0.4861255862409905i, 0.5848276565753837 + -0.17060301490585614i, 0.5081860751551089 + 0.08510702861569974i }, { 0.6988563702673406 + -0.22641067080015517i, 0.4350202279850067 + 0.038952315029196785i, 0.2441851522609113 + -0.014388243272203893i, 0.36191281362611916 + -0.28064890073969984i }, { 0.3640705550062702 + 0.0457498800673493i, -0.42477845996879027 + -0.5705409960778306i, -0.26632805743430943 + 0.5311079312776025i, 0.04992933548721676 + -0.06250283039516613i } }) }, { QubitIndex{ 1 }, QubitIndex{ 0 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 1 }, QubitIndex{ 5 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { -0.15216236774856837 + -0.08561072560384676i, -0.08102194847689921 + -0.016383395395890038i, 0.05804831929558756 + -0.12142482431484977i, -0.042889326129085414 + -0.11960637977905642i }, { 0.16718631592171923 + -0.09436468589542917i, 0.05600224737400305 + 0.09582313649271733i, -0.06239333635689797 + -0.08619211188570004i, 0.08433147307754414 + 0.05977667991089748i }, { 0.08566281343435904 + -0.17594338504860493i, -0.08218058495821526 + 0.130901410569738i, 0.08556347861873992 + 0.22483409182794967i, 0.04459035278700386 + -0.10359843011165412i }, { -0.03878181869443444 + 0.19079208666938977i, -0.01183425110818097 + 0.16744383056999507i, 0.032255173346883624 + 0.19762038926316172i, -0.007746134009429798 + 0.049705475289648346i } }), Matrix({ { 0.14187145052427397 + 0.06626028380388892i, 0.09348411725016913 + -0.03387619079729772i, 0.0477368450139815 + -0.06585368962196693i, -0.0609585057539271 + 0.05611704170330326i }, { 0.1215189501380353 + -0.05964113377343117i, -0.009860148673660543 + -0.1597894797150866i, -0.039967148254436514 + 0.046072121307414816i, -0.11791125129505887 + -0.18203675292397462i }, { -0.06861344775966062 + 0.08063449193676207i, -0.1343446301570356 + -0.03335598048767652i, -0.1522249066558314 + 0.0896573203716318i, 0.17370694509614515 + 0.12446993960554156i }, { -0.02136888216502515 + -0.08438106660722997i, 0.009121369910342757 + -0.04048971437407227i, -0.06513208543628381 + 0.00632831080667745i, -0.08299046562134753 + 0.11002896476746858i } }), Matrix({ { 0.10240376223189553 + 0.05894600614210218i, 0.057039132861942884 + -0.15494344039594976i, -0.07557637479311821 + -0.006319548236411484i, -0.03317940757256401 + 0.06238164551732321i }, { -0.0032449938475662726 + 0.061881337186554496i, -0.11799427691041273 + 0.10661648993802207i, 0.028077964837005233 + -0.06837299877020102i, -0.06016315322919282 + 0.02933541284490048i }, { -0.09873082499351586 + 0.13079868622077043i, 0.010616000474338897 + 0.08991618060821291i, -0.0030543431697195537 + -0.08313312697048995i, 0.09731550177102492 + -0.09554571934817892i }, { -0.154553702466251 + 0.11185641173646015i, -0.07359922598767217 + 0.023347068892138695i, -0.2008596472704475 + -0.09166569318367083i, 0.13897573061769528 + -0.1053756310788231i } }), Matrix({ { -0.025714593381606435 + 0.055420106203098875i, -0.026912209574517607 + 0.05539165627863634i, -0.15954293049116489 + -0.1092818856413601i, -0.14161760539310198 + 0.019983026444751247i }, { 0.09874611491894109 + 0.007867853807748801i, 0.06028832257748733 + 0.09235118094109165i, -0.06572317756655113 + -0.06220694925169376i, -0.07258518133030435 + 0.09902661485683886i }, { -0.07116365950381655 + 0.024632092832877327i, 0.12269820769319831 + 0.012318926093893325i, -0.008959293052820444 + 0.09042563477511589i, 0.04690660885876998 + 0.0027533874044121495i }, { -0.13962147271904055 + 0.04520874687914394i, 0.018681156037352816 + -0.035607196556479544i, -0.03014631159443996 + -0.04237617439611686i, 0.011190824766030425 + -0.05920875520078651i } }), Matrix({ { -0.03523695015220425 + -0.013853924525211942i, 0.02371084765248702 + 0.03778915484333653i, 0.009447638625388442 + -0.011277123005997132i, 0.002540165804545606 + -0.02902199104412971i }, { -0.022139184844706436 + 0.02068545029845722i, -0.03582175670396641 + 0.028555462305939826i, 0.06046520454531827 + -0.004876773010863587i, 0.00950630952909105 + -0.001888953817677775i }, { 0.17913637276422406 + -0.09871414028586468i, -0.07463033344418683 + 0.07397475134952804i, -0.012370568936228713 + 0.017081536210761895i, 0.14084310680564827 + -0.022617624843169024i }, { 0.09549571904781042 + 0.0704694131064542i, 0.0055161337795172315 + -0.2408391944650336i, 0.13394482345012865 + 0.030337186938706184i, -0.029380821167276985 + -0.01107185536006903i } }), Matrix({ { -0.0008055464437665259 + -0.11422391339000354i, -0.008230955000566649 + 0.07393755870549885i, -0.04508401432033866 + 0.10035890288897523i, 0.018156075302819437 + -0.1973884840382638i }, { -0.016323327423544583 + -0.016413752848043157i, 0.1119489116282189 + 0.009906923918562547i, 0.058567592115965676 + -0.08539200504324075i, 0.1278003206672685 + 0.015194642992685123i }, { -0.021778295810002166 + 0.07921810783814175i, 0.02947043562579774 + -0.08798221536426377i, 0.041083867367591995 + -0.09580146090174974i, 0.05170736607918777 + -0.049627837181525865i }, { 0.08562699449048308 + 0.018973622002275876i, 0.022970396992593692 + 0.05350062514543477i, 0.018132053136571964 + -0.07902189594432604i, 0.04943545423375647 + -0.1531280837113486i } }), Matrix({ { 0.07079240615652138 + -0.07810388111595527i, 0.011607762327805653 + 0.09686996248269523i, -0.010053127256284579 + -0.01992434020134389i, -0.0261399661608508 + -0.010262063680089237i }, { 0.11518828766998879 + 0.083245676933901i, 0.0150910600654359 + -0.013732358402607382i, 0.09794224015555981 + -0.1119307904001535i, 0.09780818594473129 + -0.08321389042012577i }, { -0.07675918943786522 + -0.018568338561453273i, -0.054545847687298976 + 0.06389769334663878i, 0.021676445570293898 + 0.07317075853428863i, 0.06009283762566127 + -0.09438374502624425i }, { 0.0059899520224771415 + -0.06012082436892769i, -0.10035852190022383 + 0.0077560684439361i, 0.09151886373057931 + 0.11486661515913009i, -0.1221683783912366 + 0.005988993858038342i } }), Matrix({ { 0.005875230353248165 + 0.0287394014344406i, 0.07739168549976168 + -0.06933979602056309i, 0.0037901289438103504 + -0.0418381123462992i, -0.020538153064003962 + 0.050426892078492325i }, { 0.20625933976453986 + 0.04438217105656298i, 0.1593232454834519 + -0.10436422589301221i, 0.07657020759142 + 0.03968827162702531i, -0.03370181355363476 + 0.03237777920177693i }, { -0.19900785273700367 + -0.054764618354389887i, 0.0968154045082422 + -0.07539957234830295i, 0.15434866795233415 + 0.02079618599639148i, 0.09572111964511161 + 0.16185575283132606i }, { -0.05795923930611943 + -0.03475821991608093i, -0.06358894035665603 + 0.10021632000220065i, -0.14366399040194638 + 0.014535850565251024i, -0.12985301664301185 + 0.07496993030210564i } }), Matrix({ { -0.011257618758829056 + 0.004631192159131904i, -0.12729942925974405 + -0.13089272594978996i, 0.002110718928033975 + 0.12811907300574935i, -0.09874358995437801 + -0.08779884024222755i }, { -0.018842012811010708 + -0.013965292239081226i, 0.0849099481716478 + -0.015916214787165584i, 0.07388046176402832 + -0.1961835230080238i, 0.036423235539929995 + -0.050847436958838484i }, { 0.02893517212495224 + -0.0452801583057851i, 0.07997408334553868 + 0.1046937254652295i, -0.04164838473305768 + -0.020104035690841245i, 0.13660869875605683 + 0.11150226092499393i }, { -0.06188834939981259 + 0.24662001054295404i, 0.13350473540930585 + 0.0034604532657652853i, -0.06972430398411898 + 0.07400082258542004i, -0.1978611098855135 + 0.008179357239595907i } }), Matrix({ { 0.047216406951181476 + 0.025056678023777576i, -0.022862477299449832 + -0.16751300940844213i, -0.0975243922513529 + -0.04870788837441497i, 0.09762524745556021 + 0.01761031555399534i }, { 0.08179668132872542 + 0.02249928468634715i, 0.1283905269394991 + -0.035262576663334155i, 0.04506139259427828 + -0.04790232074348966i, -0.08318687728283139 + -0.04268571358196684i }, { -0.005853006477784765 + -0.02546773660847022i, -0.0935122438914754 + -0.01127418407024832i, -0.0023760102404133733 + -0.07801401784226936i, -0.05705382842673019 + 0.07331131843821881i }, { -0.04456684008157455 + 0.005447337582929693i, -0.07798741622647509 + 0.21668802495472747i, -0.025443416132245895 + -0.11939933136408083i, 0.13119620359195885 + 0.014642478949979817i } }), Matrix({ { 0.09373693335863052 + 0.11989996914225985i, -0.0821407768018341 + 0.06537355934254323i, 0.10667702357040913 + -0.084563555839627i, 0.012289453705893247 + -0.023567317647327855i }, { -0.025882965455706994 + 0.10349856198293698i, 0.014132671678259916 + -0.11326414994727278i, -0.10646080526397829 + 0.1676900615268216i, 0.059672263407439516 + 0.07565199387167211i }, { -0.1238847850344268 + 0.07747184685410095i, -0.014588966580170046 + -0.03683663937704977i, 0.0882770206643975 + 0.05847680548595338i, -0.014812192740422739 + 0.07358801279704838i }, { 0.0738925351055695 + -0.0440095536051321i, 0.0324106525484979 + -0.006454484952025301i, -0.04106677368920004 + -0.09514153726717374i, -0.07196444010486436 + -0.0883399993880885i } }), Matrix({ { -0.11543637799470438 + -0.06189833975553719i, -0.05163071509494867 + -0.1406484658904556i, -0.03715674944158679 + 0.03971003774685871i, 0.09634236582304748 + -0.029717484261559752i }, { 0.0295461351749955 + -0.07187352018420394i, 0.045473152687835444 + 0.062170809660931386i, 0.004402337288327852 + -0.07059690542626348i, 0.010741082770175641 + 0.15717895011119837i }, { -0.048956515314470615 + -0.026295703196135254i, 0.05440982044015577 + 0.15599879694779104i, -0.09864671603503758 + -0.07264861980625185i, -0.001528248164144891 + -0.0322004539785333i }, { -0.1457484476270007 + -0.07097703227564435i, 0.03634432363556739 + -0.1991027241529426i, 0.022285296068897557 + -0.17390368291380104i, -0.05690054154495147 + -0.05980845392986434i } }), Matrix({ { -0.0663795516564101 + 0.06098507013691009i, -0.0028487037830850315 + 0.012076863861709967i, 0.06018398610889427 + -0.3022766371146236i, -0.2101506881851616 + 0.14158242331225585i }, { -0.00353780663149154 + 0.1638853957689774i, -0.07288233703286075 + -0.12318625578238213i, -0.21249322775082075 + 0.026273713301180085i, 0.0029459765566676906 + -0.0035760969042768808i }, { 0.06560116768505356 + -0.029113808683537634i, 0.06565797063157643 + 0.024952158510352818i, -0.09868069760456588 + -0.07312241475544741i, 0.0972699299531186 + 0.15727642295570088i }, { 0.013241503775137414 + 0.059700152941104055i, 0.006244643726753415 + 0.07145122911431262i, 0.0761953271549273 + 0.01587662115430172i, -0.09247474986660494 + 0.19583348275747298i } }), Matrix({ { 0.012698745121573339 + -0.18453249044200803i, -0.08327735154520062 + -0.04003326270776713i, 0.015038527826914637 + 0.13121275437201216i, -0.032277451030466545 + -0.025695789570245344i }, { -0.04650486795727645 + 0.07602169268864982i, -0.19737278240756642 + -0.13415999060912492i, -0.00908211668195946 + -0.08745671165492842i, -0.04929248636857436 + 0.019969161128195505i }, { -0.006539130974463553 + 0.1957842741090151i, -0.00577503009497808 + -0.010778913889145545i, 0.11919153904204474 + 0.0980731420031199i, 0.028113269503931337 + 0.06490564485066519i }, { 0.0581862439064336 + -0.052048670536569655i, -0.014944942207475373 + 0.0008057739445484264i, -0.07653436742860685 + -0.05986575890071017i, -0.00788846159616246 + -0.011804916605030193i } }), Matrix({ { 0.13502087011083655 + -0.031627192919486326i, -0.052863889732574894 + 0.017379441987190894i, 0.004492813510125804 + -0.08367603647548359i, -0.05862788515088704 + -0.051152853053645655i }, { 0.06053149187108895 + -0.06632123643386409i, 0.012603827494359433 + 0.04643015434138059i, -0.07162683159492789 + 0.020420069531601262i, -0.16324259313536488 + 0.05677351029141901i }, { -0.04000533428226104 + 0.021703777369570132i, 0.07402252879506552 + 0.06168739732701455i, -0.07344635402664126 + 0.07967397935151556i, -0.11280009614607871 + 0.0030326214928238955i }, { 0.0672557382328371 + 0.061949990744332446i, -0.16605451178830774 + 0.07996967028013088i, 0.045322368945089564 + -0.05592524845923117i, 0.16765903958406675 + 0.012095929015161254i } }), Matrix({ { 0.09111941798351665 + -0.10576263650625355i, -0.2153472948711919 + 0.1256412062588714i, -0.007291323912745663 + -0.04490739916358112i, -0.07844814979410329 + 0.10123729490004364i }, { -0.01394612340050458 + -0.09732950389208204i, -0.0644232133448207 + -0.012479948951602239i, -0.14885453600546789 + 0.004181676199192211i, -0.03797204365450626 + -0.15401869096938509i }, { -0.22059906338212468 + -0.07833611001437882i, -0.12651398878472025 + -0.08600608797627177i, 0.09507387581910078 + 0.03240799858879209i, 0.18277792196600512 + 0.08616820724070504i }, { 0.04665166864939489 + 0.04206918570706318i, -0.1534217235269757 + 0.00026158372433239573i, 0.07139338918239771 + -0.050145368705085167i, -0.010374022896034002 + 0.018064992386451192i } }) }, { QubitIndex{ 4 }, QubitIndex{ 2 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { -0.0070435798949697315 + -0.05622385523904197i, 0.1173667779213702 + 0.14311789248857842i, 0.06958652171398891 + -0.07217539932200227i, -0.13779548077117376 + -0.01022177962648525i }, { -0.09343750266028794 + -0.01500090708395924i, 0.008213698227237188 + 0.1013130874079476i, 0.03213163323763449 + -0.012294250966256188i, -0.1438229283969014 + -0.025794696251928973i }, { 0.05743305144983292 + 0.05562974976644226i, -0.08086387858622952 + -0.0425127501940356i, -0.05662025287911554 + 0.10886972623804772i, 0.03853462814273934 + 0.21799538074487804i }, { -0.06844884591372481 + -0.10012860953942465i, -0.06351592949218654 + -0.020981911755984062i, 0.11831403152020913 + 0.028360499691412334i, -0.15573014955309306 + 0.05405535071202618i } }), Matrix({ { -0.010520881227506128 + 0.021256787562488548i, 0.01677318652944719 + 0.09540984221321114i, -0.04270411466293361 + 0.00406004507252357i, -0.024620066102116495 + -0.09313094440931285i }, { -0.1368997793498746 + 0.10443184425146493i, -0.10846208740632417 + 0.021602154640379196i, -0.17107029734011614 + 0.05395256645705166i, -0.04591482635870212 + 0.045629440679834876i }, { -0.013216627212883967 + -0.042696032459546895i, 0.10017255246595637 + -0.048920625078339296i, 0.09611409677274736 + 0.03413671640389438i, 0.06918184388831285 + 0.07390224480219845i }, { -0.047532309163097974 + -0.049280950231066635i, -0.14535931893993947 + 0.14219076711577033i, -0.02899709557970759 + -0.03811014377327232i, 0.01733222125076222 + -0.006146837383735156i } }), Matrix({ { 0.001892419278629698 + -0.04753736930461948i, 0.09566944419578206 + 0.0008939032886017436i, 0.13496714329313966 + 0.028468871991291268i, -0.05223376658759383 + -0.1561556659090857i }, { -0.20378097676724732 + 0.17490566378451478i, -0.09590698964911067 + -0.11385656548654995i, -0.0732235164057623 + 0.04486302417616951i, 0.034600472219848494 + -0.02534695960155757i }, { -0.05021796278447371 + 0.057713036863720854i, -0.010820310488919089 + 0.018519324347773872i, 0.1469284011997685 + -0.08695029374941121i, 0.2519586403386663 + 0.1273684053588248i }, { 0.017445984106804785 + 0.05150095398214554i, 0.04165423837230557 + 0.03179779090882967i, -0.11588627124252723 + -0.14490405626667263i, 0.17593647163258597 + 0.1628066594513871i } }), Matrix({ { -0.058222878932946885 + -0.030184215862422693i, 0.004407080944944823 + -0.11112579252151628i, 0.01674584362323605 + -0.04171990327282278i, 0.17437626666662492 + 0.022711448134584547i }, { 0.13420049259402597 + 0.1288932874298075i, 0.11339435376457212 + -0.023523882013384362i, -0.12495227967448926 + -0.08618588354866556i, -0.07574368870994469 + 0.11709234957714101i }, { -0.027840652525784583 + 0.039700994586425564i, -0.045525298533403015 + -0.008272661450392198i, 0.01791308275356364 + -0.10514356912801744i, 0.0548890305800972 + 0.019246505214855394i }, { 0.05140444011898406 + 0.1138631121900333i, -0.10919139784887366 + 0.010110309484899068i, 0.022798731851988382 + 0.08326895017818364i, -0.059002779728583546 + 0.01149367870172872i } }), Matrix({ { -0.13791672586108145 + 0.1288168180752172i, -0.015052037559808234 + -0.03510498180579812i, -0.04011158798982901 + 0.16434359071426916i, -0.08581507419784129 + -0.021573160981767828i }, { 0.08758844511176558 + 0.022393436248707405i, -0.030080275528384187 + 0.142105900099529i, -0.1151009001116 + -0.023109664266816453i, 0.01767245432586714 + -0.07227665868234637i }, { -0.04887028080686714 + -0.05078881768354162i, -0.11432661454185193 + 0.04284757506916806i, 0.020649586248083603 + -0.05158866417308273i, -0.007311193574894639 + 0.04540170434192417i }, { -0.06715375348822553 + 0.09071642680477351i, 0.08531749960170407 + -0.0038592692615967653i, -0.20738440295177946 + 0.21236201164992277i, 0.06613225192896151 + 0.10995307655841566i } }), Matrix({ { -0.056006373664921 + 0.02624925011976798i, 0.019455972752517016 + 0.042589165174281i, -0.09973091573357909 + -0.0651365526966505i, -0.00016060230011623075 + -0.12914009676765104i }, { 0.08914032605478457 + 0.006170249077270169i, -0.06189644675801346 + -0.01421663867991109i, 0.0030300107077431073 + 0.013625985487697867i, -0.08811896773534987 + 0.1073482977475504i }, { 0.037277691446972565 + -0.1128737003275354i, -0.08405326982074976 + -0.2052801890929307i, 0.13416183006741797 + 0.014317201394333135i, 0.0550837023251707 + -0.08367975108672136i }, { 0.023557542285585622 + 0.08214806275881191i, 0.03665125269558611 + -0.026547774351958445i, 0.12559066603869667 + -0.07300864719686083i, 0.0033190553124122757 + -0.0433826503639591i } }), Matrix({ { 0.03224717893285909 + -0.014351123423486252i, 0.004556918896682394 + -0.012166231979854874i, 0.05148125545584653 + 0.04267535490635756i, -0.06832269844237862 + 0.1574635591383171i }, { -0.07327654303336749 + -0.07279176619857039i, -0.17305931119105336 + -0.03730238026666026i, -0.07234135821934282 + 0.08562189151140034i, 0.06324761615463712 + 0.02202283326519144i }, { -0.06005818637485834 + 0.1323274467116088i, 0.046734781522614385 + -0.06365963795421699i, 0.16165320261172092 + -0.15599903693522169i, 0.18319804184579763 + -0.1389106356004611i }, { -0.19262903079934587 + -0.10713188903236899i, 0.07720386190200096 + 0.12126292251588057i, -0.06756352421930155 + 0.18473372355347012i, -0.03647438208541571 + -0.09189639616300735i } }), Matrix({ { 0.006965962302200642 + -0.04063325033706531i, -0.13016999195452864 + 0.0687260883950025i, 0.11571795189752097 + 0.06583903446311037i, 0.1633465790572114 + 0.13037645479540924i }, { 0.15073853005774276 + -0.056137393973474226i, 0.012813410289882102 + 0.036506053885542795i, 0.04799222633777433 + 0.0732303630873625i, 0.13688563214022975 + -0.13854993611848365i }, { 0.11535154845812218 + 0.09417269569873543i, 0.2238562020126327 + -0.15820898797352223i, 0.12866063613977713 + -0.0768204234087848i, -0.013733708320780875 + -0.09862482176980006i }, { -0.04959835505076408 + -0.028251621559444263i, 0.007272859939673643 + -0.09891458940168811i, 0.05196538333840084 + 0.09262166014331627i, -0.007323103192653206 + -0.054269248955335386i } }), Matrix({ { -0.00020760848420357282 + 0.22737460211094035i, -0.14804517741453174 + -0.012425624619291345i, 0.10843495240280945 + 0.09745250458434089i, -0.09429823942281526 + -0.05916581847299372i }, { 0.058634701213359404 + 0.018084974564057655i, 0.04272764849519597 + 0.1304887714125967i, -0.050031417987244885 + 0.033980877147688195i, 0.017217524682811125 + 0.0012178422994423774i }, { -0.14106780180025646 + 0.009913250325011193i, 0.015465118108552481 + -0.0815441694082335i, -0.11699458807518885 + -0.0340402841352238i, 0.13333588148758704 + 0.15543865845511354i }, { 0.13128242624095363 + -0.021119542187361864i, 0.11726680573858159 + -0.021474293240960216i, -0.05064106675347109 + -0.020218300344880234i, -0.019690471233862875 + 0.0774282781625642i } }), Matrix({ { -0.05709027296106747 + 0.16634636194076333i, -0.01738405154868435 + -0.11496269547154682i, 0.11475429274637793 + 0.060513342970771176i, -0.011584550953170012 + 0.033207514166979896i }, { 0.019367121652343253 + 0.07945938554334098i, 0.06187991432591201 + -0.12817086172489006i, 0.06969373595480756 + -0.08968399091497754i, -0.12194189847273659 + -0.04912092912195431i }, { 0.07989248417895146 + 0.006677863485447996i, -0.021205977086828136 + -0.017585143259652863i, 0.010720791099876465 + -0.03705060118048478i, 0.02865098774079373 + 0.1385618808647811i }, { -0.21811019852761598 + -0.048937976487924785i, -0.08867665630907318 + -0.08189642069926563i, 0.049398524590628136 + -0.1271741575533095i, 0.11661954127077892 + 0.13332320100706366i } }), Matrix({ { 0.01398973438618658 + -0.07413905270526533i, -0.05260896087142594 + 0.0720608153474884i, 0.044794280171050395 + 0.0193581971632176i, 0.04836660321304815 + -0.06674208382755899i }, { -0.003107538260118244 + 0.004657422471640669i, -0.03175925602243706 + -0.07777296694043767i, -0.0005535288211133425 + 0.15088963603945754i, -0.016940697896576266 + -0.059306651176116866i }, { 0.0481145408350847 + -0.027323609705409212i, -0.05870484297931131 + -0.07671196873194328i, -0.11463466714285397 + -0.038228419073835236i, -0.01763564648314175 + -0.11157471044719972i }, { -0.10796169144930946 + -0.050254898001498544i, -0.13387291034833151 + -0.05045177261885147i, -0.007362499727690827 + -0.009587810869614329i, -0.06173983201143511 + -0.08774762833351668i } }), Matrix({ { 0.008732461030330787 + 0.06017933701278402i, -0.008785231711515427 + -0.042731244997926764i, -0.10354439442600388 + -0.20805147869474178i, -0.015410612025294583 + -0.0479480762584479i }, { -0.08895287199432561 + -0.04423043048847433i, -0.13231576504182105 + -0.0963816253350413i, 0.08532699726373667 + 0.04014293846626517i, 0.056300755311634275 + -0.016158310602731412i }, { 0.1114466123136878 + -0.0787138282676587i, 0.18449736985539752 + 0.05951157322171408i, -0.014885561408085267 + -0.045579404017688036i, -0.07349497790030407 + -0.03988238187080441i }, { 0.14641528972491547 + -0.11272975575032414i, 0.03895264689286116 + -0.10458789000630671i, 0.06358639669547382 + 0.18700849468640127i, -0.13863186075261658 + -0.05782905279651788i } }), Matrix({ { -0.06726984058989013 + -0.016639129440494876i, -0.08662899578342005 + 0.03372722731281247i, 0.03441426879571555 + 0.05688827560516256i, -0.029037335981156247 + 0.010147520616863569i }, { 0.11734944501680425 + 0.10941530648186913i, -0.17657346896843745 + -0.12658620619508568i, 0.009257179262261139 + 0.035386188142866266i, 0.055269327229647114 + 0.01905407190595825i }, { 0.186879062449967 + 0.05487262262966156i, -0.1339761682406127 + -0.1369825002185447i, -0.030284114528198364 + 0.01957356171355151i, -0.09886912486599021 + -0.014437185300274801i }, { -0.021248811306333194 + 0.0961990402777299i, 0.014404307534874075 + -0.08010367233305539i, -0.06747579219684205 + -0.052568985968910006i, -0.06390012427551742 + 0.06184105793233482i } }), Matrix({ { 0.2053171868573992 + 0.015866555308699758i, -0.03134033965210439 + 0.09123330011103271i, 0.1693521768116981 + -0.08916988444865044i, 0.07345910281530317 + 0.05365801609773128i }, { 0.09645764929197406 + 0.011826474595790863i, -0.04775176973761763 + 0.048821448729462376i, 0.0351437505835289 + -0.022619739541234276i, -0.008626507423610362 + -0.12588860920894762i }, { 0.047699306303038785 + 0.07566875181176179i, 0.0021468520145495346 + -0.05952431665245759i, 0.034400292113299834 + 0.0886738009477905i, 0.15889791777268103 + -0.04697021625871081i }, { 0.028443697491534622 + -0.15680607010946793i, -0.09822634699092754 + 0.11338922863067874i, -0.0982264057411707 + 0.20370954844995073i, 0.025528352890015836 + 0.04747000738377248i } }), Matrix({ { -0.017771760363071973 + 0.08178017556126409i, -0.08940608646564448 + 0.032833387681815235i, 0.052042647640470174 + 0.029005603189105195i, -0.13147711876589327 + 0.0036804363748594586i }, { 0.0060024108655242076 + -0.05921685707944719i, 0.0335651433467675 + 0.11456387035944349i, -0.07387314242357465 + 0.043340974185651235i, -0.02696976786163885 + -0.03973718815392994i }, { -0.027672221089745142 + 0.04297214185338571i, 0.014179665729523255 + -0.04118633135772048i, -0.125662886779819 + 0.04355716737041446i, 0.02741815155973061 + -0.06606523651867666i }, { 0.035464275849639605 + 0.13738462917347477i, 0.13895553628632906 + -0.06619195838834281i, -0.004616283294297751 + -0.05680686920518611i, -0.053325329319875284 + 0.033241958166446116i } }), Matrix({ { 0.10085766054394284 + -0.06111897365231254i, -0.01882697004267691 + -0.14292183891672836i, -0.00535322514540951 + -0.06116208925863579i, 0.11131345543191923 + 0.03337182283014562i }, { 0.010825277833074739 + -0.09127123990177524i, -0.1408834396563313 + 0.06911521299109867i, -0.047187343788102326 + 0.004949055783395135i, -0.0871006336393594 + 0.0437821925479628i }, { 0.027563409184331665 + -0.21994758521895877i, 0.0897850464124983 + 0.002421459372095259i, 0.0895328952412485 + -0.013989195315319338i, 0.07284843340229999 + 0.027227360144893346i }, { -0.12542418104013894 + 0.0002192829003610725i, -0.21832860352718542 + 0.0006695506981010233i, 0.14217816359580876 + -0.09913111847919563i, -0.17008995170709246 + -0.009838662402805268i } }) }, { QubitIndex{ 3 }, QubitIndex{ 2 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { 0.16014076464071758 + -0.007914751915126562i, -0.021796388225163377 + 0.03458716366349825i, -0.03599836271194917 + -0.13781954204916227i, -0.12135063737996603 + -0.05819051514416646i }, { -0.2296536571482067 + 0.014262163312709072i, 0.013395503867091624 + 0.06860342418986111i, -0.2017185448550441 + -0.11880745434704104i, -0.00836201413173769 + -0.034849450731625355i }, { 0.2224401438114748 + -0.17855083784433587i, -0.003609195548266502 + 0.04093405223369959i, -0.024580086859818807 + 0.06469856183421857i, -0.002741808503698777 + -0.08670312343409957i }, { 0.05371288479509022 + -0.01320852324539087i, -0.07462567606594278 + -0.0923090151744074i, -0.0028608369916200173 + -0.0672019605504436i, 0.16447017872434824 + -0.05837358646542174i } }), Matrix({ { -0.0810076222710056 + 0.061709065105471195i, 0.08290526031379147 + -0.018862423288064742i, 0.04827839277829945 + 0.08962901632259637i, 0.054745357699260706 + -0.22110097135502857i }, { 0.004461164978588413 + -0.05128223481569303i, -0.031495161109654966 + 0.004543502982206683i, 0.01801808737714269 + 0.09487292875067775i, 0.1479165518570072 + -0.12177255328475352i }, { -0.11557248461918285 + -0.015817962365445002i, -0.11189973034526546 + -0.08323274210447881i, 0.22421574565439323 + -0.15179678841599362i, 0.08426466163016369 + 0.08523618637039862i }, { -0.09555936641932788 + 0.11183563569545167i, 0.025980924711509583 + 0.022029687521645806i, -0.12052279256254876 + 0.05045461297861083i, 0.04452942552654593 + -0.044836915919698066i } }), Matrix({ { -0.12585350302032255 + 0.010643352177872047i, 0.01220078783811494 + -0.15543452950485306i, 0.013887053588024414 + 0.004454982145845149i, -0.10218178848780884 + -0.02840798909070556i }, { -0.02061309615918934 + 0.0010989915546167526i, 0.0044217319197565 + -0.0028253636180599257i, -0.026528888740461717 + -0.014882786602239396i, 0.026325325308328457 + 0.06554698053648203i }, { 0.08803317507508965 + -0.12709460908712517i, 0.05178029138516563 + -0.044194110005389864i, -0.047610704760940516 + 0.01180381104528043i, 0.07097501150068006 + -0.10100584567599838i }, { -0.18347092499906162 + 0.028095051330567652i, -0.053351684274677486 + -0.03748057124119713i, -0.0431244258851225 + 0.009504526276403675i, 0.0023195026328443305 + 0.024057156828242207i } }), Matrix({ { 0.13741934303868922 + 0.06310369908022817i, 0.09861927304600929 + 0.019119664440790916i, 0.048386060079000946 + -0.0402067855486677i, 0.005939837775823839 + 0.29509782609726537i }, { -0.22302515828752173 + -0.012852492808347847i, -0.0434126928520074 + -0.00448950056722476i, -0.08134774873485674 + 0.0799605168428331i, 0.045828363029201624 + 0.08469176517740065i }, { -0.1108570428461192 + -0.007122360800335748i, -0.02830234568684157 + 0.03916770054154343i, 0.13653640685100343 + -0.08007691799459415i, -0.0674220835214129 + 0.020614261778014068i }, { 0.0991629277639445 + 0.0038994317635592706i, 0.043699548483508516 + 0.003484978945055706i, 0.05638963267716176 + 0.05904227361252699i, -0.02867024170004379 + -0.09837766541051572i } }), Matrix({ { -0.10572253679177827 + -0.084161234322903i, 0.10452344682830836 + 0.0016904025117555786i, 0.011583248189697139 + 0.11091661407799984i, 0.0008176611972058234 + -0.00584390334207893i }, { 0.15580445706273757 + 0.08036883939532027i, 0.044107943430161334 + -0.00718400180691298i, -0.07574337779191831 + -0.026323684565870184i, 0.015089431018352677 + 0.04999618608445727i }, { 0.02884075598336068 + 0.01857844192059032i, 0.06873978077672359 + 0.027874744460158543i, 0.20428613235192586 + -0.1143304796229561i, -0.11574118328474144 + 0.06600218233824212i }, { -0.008363406122958529 + 0.07349729283284986i, -0.04109923041108951 + 0.03173633615052163i, -0.016836080625550205 + 0.06598978029223063i, 0.1492448779631138 + -0.037690067274450824i } }), Matrix({ { 0.11020289163822589 + 0.11317099398738899i, 0.07333497780534738 + 0.013770791924577626i, 0.04126149621672101 + -0.20145957942712525i, 0.0756360149999102 + -0.0038180044293458907i }, { -0.050908573031708815 + -0.10002560958533163i, 0.07085833105858855 + -0.036590408911944816i, -0.0916623073868066 + -0.052825691462492615i, -0.008138401234135643 + 0.008303136120036426i }, { 0.047469488061500364 + -0.03409925408431975i, -0.2827671540714328 + -0.02508659671190862i, -0.07637300964239621 + -0.02854738882537368i, 0.002797282078055159 + -0.012581838636842523i }, { 0.13975779322695914 + 0.23542936703844064i, -0.014086222259070889 + 0.019166054862083785i, 0.0932536186032751 + 0.07395681284638911i, -0.09691930335841313 + -0.08791889748139763i } }), Matrix({ { 0.05215643581456556 + -0.026178222089789656i, 0.019032080707508954 + -0.027167914273733145i, -0.0761743465380424 + 0.11012637949365556i, 0.01879386496646645 + -0.11365017191498672i }, { -0.017782665344729953 + -0.08705720757712632i, 0.07236464214645877 + -0.10399975877355484i, 0.0715137047962191 + 0.09345929457292576i, 0.060773662344121925 + -0.032198469290285664i }, { 0.007770459682652753 + 0.014329846137450555i, 0.08913993752199727 + -0.1525347923075924i, -0.04426842761292293 + -0.07904804618527131i, 0.11376425311986682 + 0.06132559403282799i }, { -0.10823126525050662 + -0.04940052232497548i, 0.04490916590016509 + 0.021663733740207074i, -0.17285163694822472 + -0.07508868818289692i, 0.10983189276366853 + 0.01203476741631349i } }), Matrix({ { 0.008888173498015964 + 0.047516722609972147i, -0.13835876401785493 + -0.06440233311464538i, -0.14489313120865352 + -0.10020711631858925i, -0.06148310031488873 + -0.11481375902841091i }, { -0.038395957739578775 + -0.05389225526063467i, -0.03592768771760136 + 0.05518734988470264i, 0.004025081514362148 + 0.0001800602317914828i, -0.11101556205021847 + -0.16033903339456587i }, { -0.014151210241235411 + 0.06325342789681508i, -0.04933434789141551 + -0.18766855924155743i, -0.12871162437579065 + 0.09389531074211431i, -0.03331903802446866 + 0.08053224474851421i }, { -0.05411625632453762 + -0.06979850934181316i, -0.18453385543551154 + -0.057095704555086474i, 0.0011848832828746402 + -0.038729885531161204i, -0.04261323725625237 + 0.07206993063595148i } }), Matrix({ { 0.026037900822157952 + 0.03656371392091968i, -0.022233924121601484 + -0.09950994219833113i, -0.005456381249251597 + -0.07265505785609698i, 0.014271594867673031 + 0.0010610337198754185i }, { -0.08351990950026261 + 0.12939685099888742i, 0.08314310263004156 + -0.03598480587508349i, -0.21509672280490072 + -0.10804426681234668i, -0.054185566761029896 + -0.006341938676802512i }, { -0.06013118198540964 + -0.15297247806032294i, 0.01733497960367272 + 0.10667246492761374i, -0.04241542307593719 + 0.0779671696796939i, 0.08206012257427454 + 0.03034961383295114i }, { -0.06254324223736774 + -0.07228980494628046i, 0.08248012117179668 + -0.12123284477006943i, 0.023145484247065123 + 0.0017098207581850108i, -0.1597194686333015 + 0.02605450566711414i } }), Matrix({ { 0.06893556679630251 + -0.11326665104529991i, -0.049497584501578144 + 0.09682167708823554i, -0.04211588797849303 + 0.08606820564263556i, -0.04996319392388825 + 0.019873707846698584i }, { 0.10535964735353039 + 0.07100305033500047i, -0.018640894463362596 + 0.1627896750387134i, 0.028733391541617363 + 0.04356760964096303i, 0.07458457820000154 + -0.2003986022932781i }, { 0.01623943589270343 + 0.0852658042584243i, -0.04759631340805471 + -0.18408668602401743i, 0.0072204355449579085 + -0.08925381802465694i, 0.048014237563534956 + -0.12938940667631993i }, { -0.015503172393844005 + 0.03227451327935271i, 0.07413942029715943 + -0.02924165871355201i, 0.003655193544981074 + 0.08588909768248641i, 0.0003893059105281372 + 0.09745609499095868i } }), Matrix({ { 0.024036251210380763 + -0.12457004004997929i, -0.2174872810629241 + 0.023881026844125845i, -0.09849923295950135 + -0.25197532592137334i, -0.12301779055043024 + -0.11199279565569437i }, { -0.008736133404000148 + -0.08231365348273098i, 0.018842704083319665 + -0.01262223703669142i, 0.05798176919540378 + 0.004849714756222681i, -0.17235674810180784 + 0.09798807435737447i }, { 0.06412235916085846 + -0.03785990032593885i, 0.0772341113970287 + 0.054425517098699895i, -0.009873889862147772 + 0.0025006646147765566i, 0.05834705895222552 + 0.020367427444169094i }, { -0.06212399644877704 + 0.042458287211657335i, -0.014401592891907435 + 0.044307664703417904i, 0.08874587114561612 + 0.012970952184395i, 0.04914862232660432 + -0.088905623148987i } }), Matrix({ { 0.02191615129291168 + 0.04215901051396588i, -0.05586105557715376 + 0.12093597209999696i, 0.04032593696494423 + -0.08567321094686717i, -0.06819065729569096 + 0.13920859601060703i }, { 0.12441414949250076 + 0.012085955523209018i, 0.147659901030047 + 0.25470256732307095i, -0.07955391685221208 + 0.0572406557110027i, -0.059182745482245475 + 0.1266578882366831i }, { 0.015530870876494535 + 0.06448076693104245i, -0.034610618086974944 + -0.017788328624258904i, -0.015820282642570214 + 0.0927349182230829i, -0.04695287724184417 + -0.059025531370519545i }, { -0.13656696805911003 + 0.050640145656579046i, 0.043309071858956286 + -0.09638939533743048i, -0.08900704140340698 + 0.0244587305310814i, -0.034543706715618475 + 0.04590938241491657i } }), Matrix({ { 0.1476306003136071 + -0.04495346193351282i, -0.09682669631364997 + -0.07110175363644641i, -0.022510452145982417 + -0.11153336774964626i, 0.05588377382700751 + -0.059198203886198016i }, { 0.08812275653068138 + 0.10610313775263179i, 0.045876339028156445 + -0.1065510510976514i, -0.18946688361543465 + 0.004467072666329938i, -0.039193990143896934 + 0.03637323897968182i }, { -0.014830147172532674 + 0.09431354832385949i, -0.029714083220969394 + 0.03864315896264097i, -0.030083661193527882 + -0.038593514419161125i, 0.0389578881104496 + 0.07601308790268041i }, { -0.05317413384488048 + -0.10085050411538418i, 0.016404068567092978 + 0.07488743367819155i, -0.013727289016941048 + 0.06132948970733603i, 0.10634997709025495 + -0.09425790040622486i } }), Matrix({ { 0.0569341174009996 + -0.013977334153117681i, -0.14635440102794264 + -0.0467374124345662i, 0.014636855146239101 + 0.014886058712938539i, -0.10470390493683246 + 0.07718288406057185i }, { -0.09705751993988157 + -0.04854859629600463i, -0.026121677566347007 + 0.11068661713567346i, -0.011503464129367058 + 0.16500147912243474i, -0.12461806087599824 + -0.07062885375189998i }, { -0.01959765270030172 + -0.010083185156023088i, -0.15529537174339555 + 0.11823661934036381i, 0.12959662669170624 + 0.10841114664385322i, 0.22097008095495452 + 0.13972077448205056i }, { -0.005907639011723814 + 0.07972576559075752i, 0.18169603401363282 + 0.08362394743015175i, -0.028329617329733242 + -0.050294503769962265i, -0.0385214242635059 + -0.04486946885858119i } }), Matrix({ { -0.06691524315970969 + 0.14099755269154765i, 0.0670524885058415 + 0.045672691479481005i, 0.035689154827350446 + 0.03805770308270757i, 0.1280622409591877 + -0.07167588468598936i }, { 0.07578377024146665 + -0.1880702783996275i, 0.16229739767346718 + -0.0012329639836403334i, -0.07997614491933144 + -0.10553420808990593i, 0.09444750203028769 + -0.11094860562910083i }, { 0.07254138539151031 + -0.02123351925405121i, 0.08132612629395142 + -0.10936349915938172i, 0.03580065082515236 + -0.047978868476056036i, -0.11908407460624017 + 0.09695825440954992i }, { -0.059462306583920856 + -0.020628607405082523i, -0.02381635826647792 + 0.20198918812453395i, 0.0736698337668801 + -0.1268697516386394i, 0.05303673446075275 + -0.1476947434299693i } }), Matrix({ { -0.011631355866254196 + 0.027729638673089137i, -0.19491511911521595 + 0.10962769241079576i, -0.022018618312535508 + 0.01800302571344363i, -0.08294879666579365 + 0.019990454867769587i }, { 0.11777189256414221 + -0.05212003432703536i, -0.04176858118096294 + 0.04531622305110745i, 0.07928001205294391 + 0.09973916095974224i, -0.058563502266815406 + -0.0004459008889000266i }, { 0.007193529650795355 + 0.09227946393615521i, 0.08134028512593475 + -0.07356301663996002i, -0.1491161448651505 + 0.013567855285870041i, -0.03468526511122837 + -0.06760787456957999i }, { -0.1775204910780697 + -0.03354202835193324i, -0.10887224058018294 + -0.028350646377453635i, 0.21017815622373875 + -0.0419233346743154i, -0.03661255441835579 + -0.0702467796758454i } }) }, { QubitIndex{ 3 }, QubitIndex{ 5 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { -0.46508874120376675 + -0.057084033201170496i, 0.09756485974647014 + -0.6880062571842434i, -0.1537034399469793 + -0.35100942179263694i, -0.19988770703246156 + -0.3328286452749107i }, { 0.12463282076357632 + 0.3058472661543188i, 0.24668063760074233 + -0.5166070560773992i, 0.031090302275337683 + 0.02411073020611646i, 0.4046892682073848 + 0.6307682493669963i }, { 0.38538754932612934 + 0.00744287218216544i, 0.2516363655883981 + -0.3436859161055432i, -0.05710362822432277 + 0.7048035723138277i, -0.27427305629950965 + -0.3078076700598073i }, { 0.2770504474381527 + -0.6678488420187806i, -0.04502043336443534 + -0.07698436221563845i, -0.5821565736966363 + -0.11271436445146721i, -0.10762115780290268 + 0.3256906883588787i } }) }, { QubitIndex{ 4 }, QubitIndex{ 5 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { 0.5157523803764912 + 0.7949400931559708i, -0.185968378098265 + 0.2597797004707264i }, { -0.315869900400913 + 0.04791593106553266i, 0.4745511154858082 + 0.8202021143364698i } }) }, { QubitIndex{ 2 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { 0.35123461313469795 + 0.24842207889372486i, -0.3723080061285026 + 0.274806037656609i }, { 0.09441870608095673 + -0.16181494344162928i, 0.006017747035670957 + 0.050158921695067075i } }), Matrix({ { 0.43379478013495826 + -0.21940443771628787i, 0.035842151410036896 + 0.04796182356754219i }, { -0.22645632154838902 + 0.11568250737930398i, -0.5871697271360584 + 0.0006064650073847321i } }), Matrix({ { -0.07437794527373504 + -0.09690968411051416i, -0.1910574977345209 + 0.4316216871337346i }, { -0.11945581975446504 + -0.3680530240335178i, -0.16817378459058238 + 0.056667920419275805i } }), Matrix({ { 0.22300534775945768 + 0.2626575042255632i, 0.12607548464554155 + -0.38024227804219496i }, { -0.4376209477650057 + 0.06286407608054854i, -0.05456828593834808 + 0.13119362785648003i } }) }, { QubitIndex{ 5 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 2 }, QubitIndex{ 7 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { 0.11847642881717646 + -0.2497422770059331i, 0.1678930070200739 + -0.1250495927120104i, -0.23564632530974663 + -0.17892712778855066i, 0.41044470413866957 + 0.7897833282621325i }, { -0.007356654135858034 + -0.15331954103884513i, 0.12360243637108434 + 0.865572867243741i, -0.4398223779715512 + 0.12639111508242473i, 0.01615923432118281 + -0.04759714487202594i }, { -0.8900654654839779 + 0.011032943969761427i, -0.1219640560334212 + 0.182223603740701i, 0.27854096025955977 + -0.0925794381250726i, -0.029670262350103865 + 0.26934128016697056i }, { -0.14555842477371364 + -0.29411836927286344i, 0.3688038294922634 + -0.08708415124676011i, -0.1469520203445254 + -0.7715481443071552i, -0.04084535719186522 + -0.3607733877600402i } }) }, { QubitIndex{ 6 }, QubitIndex{ 5 } }));


    return c;
}

TEST(RandomizedIntegrationTests, 8_40_2_30_30_30) {
    auto c = randomCircuit();
    
    auto s = c.execute();

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, false, false, false, false}), Matrix({ { 0.5016469079557511 + 1.221421509940701e-18i, -0.02167320750874447 + -0.00038513219099055806i }, { -0.02167320750874447 + 0.00038513219099056i, 0.49835309204424755 + 1.3298417271892515e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.5016469079557511, 1.0e-7), DoubleNear(0.49835309204424755, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, false, false, false, false}), Matrix({ { 0.5411357980321276 + 1.954952042262925e-18i, -0.0191777357676226 + -0.028414863273553616i }, { -0.019177735767622595 + 0.028414863273553616i, 0.4588642019678709 + -6.005463596032989e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.5411357980321276, 1.0e-7), DoubleNear(0.4588642019678709, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, false, false, false, false}), Matrix({ { 0.49501306216815816 + 4.0149361699853836e-19i, 8.230067231996109e-05 + 0.00047176564900225837i }, { 8.230067231996098e-05 + -0.00047176564900225837i, 0.5049869378318403 + 9.529120656610879e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.49501306216815816, 1.0e-7), DoubleNear(0.5049869378318403, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, false, false, false, false}), Matrix({ { 0.5355813412197908 + -3.4558944247975454e-19i, -0.0670000036273011 + -0.005689727039592009i }, { -0.0670000036273011 + 0.0056897270395920106i, 0.46441865878020777 + 1.6999951251393808e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, false, false, false, false}), ElementsAreArray({ DoubleNear(0.5355813412197908, 1.0e-7), DoubleNear(0.46441865878020777, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, true, false, false, false}), Matrix({ { 0.48354650530597276 + 1.4941661189565858e-18i, -0.010323094469676108 + 0.004553718839732419i }, { -0.010323094469676102 + -0.004553718839732417i, 0.5164534946940258 + -1.3976043629695956e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, true, false, false, false}), ElementsAreArray({ DoubleNear(0.48354650530597276, 1.0e-7), DoubleNear(0.5164534946940258, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, true, false, false}), Matrix({ { 0.5254410504992182 + 1.8228149024912543e-18i, 0.07835613775150037 + 0.02346714614603907i }, { 0.07835613775150037 + -0.023467146146039078i, 0.4745589495007805 + -4.684092198316281e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, true, false, false}), ElementsAreArray({ DoubleNear(0.5254410504992182, 1.0e-7), DoubleNear(0.4745589495007805, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, false, true, false}), Matrix({ { 0.4920041714971699 + 1.6999951251393808e-18i, 0.0022571560132326396 + -0.0032110183937131276i }, { 0.002257156013232638 + 0.0032110183937131276i, 0.5079958285028288 + -3.4558944247975454e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, false, true, false}), ElementsAreArray({ DoubleNear(0.4920041714971699, 1.0e-7), DoubleNear(0.5079958285028288, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, false, false, true}), Matrix({ { 0.5004183044565087 + 2.3793155488373297e-18i, 0.00033058498894453914 + 0.00042251253244824174i }, { 0.0003305849889445391 + -0.00042251253244824304i, 0.49958169554348986 + -1.0249098661777034e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, false, false, true}), ElementsAreArray({ DoubleNear(0.5004183044565087, 1.0e-7), DoubleNear(0.49958169554348986, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, true, false, false, false, false, false, false}), Matrix({ { 0.2731268688809857 + 1.748276003132876e-18i, -0.021714955928771058 + 0.008171208629072085i, -0.00995413446805679 + -0.012160555896385167i, -0.01239410606165907 + -0.0024479544236905232i }, { -0.021714955928771054 + -0.008171208629072082i, 0.26800892915114205 + 2.0667603913004928e-19i, 0.023210612108049606 + 0.00787479171075237i, -0.009223601299565811 + -0.01625430737716845i }, { -0.009954134468056788 + 0.012160555896385167i, 0.023210612108049606 + -0.00787479171075237i, 0.22852003907476537 + -5.268544931921748e-19i, 4.1748420026585216e-05 + -0.008556340820062644i }, { -0.012394106061659069 + 0.0024479544236905245i, -0.00922360129956581 + 0.01625430737716845i, 4.174842002658587e-05 + 0.008556340820062642i, 0.23034416289310555 + -7.369186641112413e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, true, false, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.2731268688809857, 1.0e-7), DoubleNear(0.26800892915114205, 1.0e-7), DoubleNear(0.22852003907476537, 1.0e-7), DoubleNear(0.23034416289310555, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, true, false, false, false, false, false}), Matrix({ { 0.24831867608078131 + -8.91078660511524e-19i, -0.010629267286278905 + -0.00016421454694634074i, 4.1537217743556034e-05 + 0.00023885124253990073i, -1.0794948054906975e-05 + -2.565583685756428e-05i }, { -0.010629267286278905 + 0.00016421454694634172i, 0.24669438608737687 + 1.2925722775100623e-18i, -2.153854522119109e-05 + -1.654037570270093e-05i, 4.0763454576405085e-05 + 0.0002329144064623577i }, { 4.153721774355595e-05 + -0.00023885124253990073i, -2.1538545221191067e-05 + 1.6540375702700973e-05i, 0.2533282318749697 + 2.112500170452225e-18i, -0.011043940222465565 + -0.00022091764404421688i }, { -1.0794948054906965e-05 + 2.5655836857564275e-05i, 4.0763454576404976e-05 + -0.00023291440646235772i, -0.011043940222465565 + 0.00022091764404421808i, 0.2516587059568707 + -1.1595881047911372e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, true, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.24831867608078131, 1.0e-7), DoubleNear(0.24669438608737687, 1.0e-7), DoubleNear(0.2533282318749697, 1.0e-7), DoubleNear(0.2516587059568707, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, true, false, false, false, false}), Matrix({ { 0.2686710044736999 + 8.453388813597917e-19i, -0.011608620494256233 + -0.00021631291266403622i, -0.03358621452086814 + -0.002926287953820117i, 0.001653635826209367 + 0.0007199532818402111i }, { -0.011608620494256233 + 0.00021631291266403698i, 0.266910336746091 + -1.1909283238395463e-18i, 0.000933590535781236 + 0.0004135330150326722i, -0.03341378910643295 + -0.0027634390857718925i }, { -0.03358621452086814 + 0.002926287953820118i, 0.0009335905357812358 + -0.00041353301503267194i, 0.23297590348205116 + 3.7608262858090935e-19i, -0.010064587014488239 + -0.0001688192783265215i }, { 0.0016536358262093664 + -0.0007199532818402113i, -0.03341378910643295 + 0.0027634390857718925i, -0.010064587014488235 + 0.00016881927832652303i, 0.23144275529815658 + 1.3239124965584714e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, true, false, false, false, false}), ElementsAreArray({ DoubleNear(0.2686710044736999, 1.0e-7), DoubleNear(0.266910336746091, 1.0e-7), DoubleNear(0.23297590348205116, 1.0e-7), DoubleNear(0.23144275529815658, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, true, false, false, false}), Matrix({ { 0.24254885761947625 + 1.7296412782932813e-18i, -0.010382616881344642 + -0.00027346944732414575i, -0.005210736530746284 + 0.0022667834548869203i, 0.0005090255189657124 + -0.00015937850893955085i }, { -0.010382616881344642 + 0.00027346944732414683i, 0.24099764768649648 + -2.354751593366955e-19i, 0.0003536633411781193 + 0.00014689986490372525i, -0.005112357938929824 + 0.0022869353848454996i }, { -0.005210736530746278 + -0.0022667834548869203i, 0.0003536633411781189 + -0.00014689986490372568i, 0.2590980503362748 + -5.082197683525802e-19i, -0.01129059062739983 + -0.00011166274366641187i }, { 0.0005090255189657122 + 0.00015937850893955072i, -0.005112357938929824 + -0.002286935384845497i, -0.011290590627399826 + 0.00011166274366641328i, 0.2573554443577511 + 3.6845933205562065e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, true, false, false, false}), ElementsAreArray({ DoubleNear(0.24254885761947625, 1.0e-7), DoubleNear(0.24099764768649648, 1.0e-7), DoubleNear(0.2590980503362748, 1.0e-7), DoubleNear(0.2573554443577511, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, false, true, false, false}), Matrix({ { 0.26371129571914226 + 1.5517643593698782e-18i, -0.007356774296545528 + -0.0068185437960435104i, 0.0353141548773831 + 0.014585380732342067i, -0.000412582260200336 + -0.012487005257170225i }, { -0.007356774296545527 + 0.0068185437960435104i, 0.26172975478007593 + 2.710505431213761e-19i, 0.0015067036645532751 + -0.013382521287313431i, 0.04304198287411727 + 0.008881765413697007i }, { 0.0353141548773831 + -0.01458538073234207i, 0.0015067036645532743 + 0.013382521287313431i, 0.2379356122366088 + -3.3034284942917713e-19i, -0.014316433212198942 + 0.006433411605052952i }, { -0.0004125822602003351 + 0.012487005257170225i, 0.04304198287411727 + -0.008881765413697009i, -0.014316433212198942 + -0.0064334116050529504i, 0.23662333726417162 + -1.3806637040245096e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, false, true, false, false}), ElementsAreArray({ DoubleNear(0.26371129571914226, 1.0e-7), DoubleNear(0.26172975478007593, 1.0e-7), DoubleNear(0.2379356122366088, 1.0e-7), DoubleNear(0.23662333726417162, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, false, false, true, false}), Matrix({ { 0.246965868312599 + 1.5670109524204556e-18i, -0.017843578462243236 + 0.002952010452453091i, -0.0015424707984908518 + 0.003838346853191071i, -0.006592552396993157 + 0.014002019452745275i }, { -0.017843578462243232 + -0.00295201045245309i, 0.24503830318457084 + 1.3298417271892515e-19i, 0.0013315253906323599 + 0.006276649911991028i, 0.0037996268117234913 + -0.007049365246904199i }, { -0.0015424707984908552 + -0.0038383468531910693i, 0.0013315253906323588 + -0.006276649911991028i, 0.25468103964315203 + -3.4558944247975454e-19i, -0.003829629046501236 + -0.0033371426434436495i }, { -0.006592552396993155 + -0.014002019452745273i, 0.003799626811723492 + 0.007049365246904197i, -0.003829629046501236 + 0.00333714264344365i, 0.25331478885967673 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, false, false, true, false}), ElementsAreArray({ DoubleNear(0.246965868312599, 1.0e-7), DoubleNear(0.24503830318457084, 1.0e-7), DoubleNear(0.25468103964315203, 1.0e-7), DoubleNear(0.25331478885967673, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, false, false, false, true}), Matrix({ { 0.25097928963290184 + 2.0091621508872004e-18i, -0.010884707445878177 + -0.00016859680030892137i, 0.00020732044250534933 + 0.00021253343246825353i, -0.00019308855348185454 + -6.147494923877806e-05i }, { -0.010884707445878175 + 0.00016859680030892137i, 0.24943901482360692 + 3.7015339795012925e-19i, -0.0001905052099818517 + 4.619413985893202e-05i, 0.00012326454643918984 + 0.0002099790999799882i }, { 0.0002073204425053493 + -0.00021253343246825413i, -0.00019050520998185183 + -4.6194139858931834e-05i, 0.25066761832284923 + -7.877406409464993e-19i, -0.010788500062866293 + -0.00021653539068163669i }, { -0.00019308855348185435 + 6.147494923877825e-05i, 0.00012326454643918976 + -0.00020997909997998892i, -0.010788500062866293 + 0.00021653539068163864i, 0.24891407722064063 + -2.371692252312041e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, false, false, false, true}), ElementsAreArray({ DoubleNear(0.25097928963290184, 1.0e-7), DoubleNear(0.24943901482360692, 1.0e-7), DoubleNear(0.25066761832284923, 1.0e-7), DoubleNear(0.24891407722064063, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, true, false, false, false, false, false}), Matrix({ { 0.2677981101396577 + 3.6591823321385775e-19i, -0.009486640481574491 + -0.01402145707173326i, 6.704313453025163e-05 + 0.00027562737509504565i, 5.682716579083417e-06 + -2.4452225543194732e-05i }, { -0.00948664048157449 + 0.014021457071733261i, 0.22721495202850045 + 3.5575383784680614e-20i, -2.771580612401425e-05 + -1.496255401905961e-06i, 1.5257537789709514e-05 + 0.00019613827390721277i }, { 6.704313453025147e-05 + -0.00027562737509504565i, -2.771580612401425e-05 + 1.4962554019060083e-06i, 0.27333768789247 + 1.5890338090490674e-18i, -0.009691095286048109 + -0.014393406201820353i }, { 5.682716579083437e-06 + 2.445222554319471e-05i, 1.525753778970946e-05 + -0.00019613827390721277i, -0.009691095286048107 + 0.014393406201820353i, 0.23164924993937044 + -6.361217433879796e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, true, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.2677981101396577, 1.0e-7), DoubleNear(0.22721495202850045, 1.0e-7), DoubleNear(0.27333768789247, 1.0e-7), DoubleNear(0.23164924993937044, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, true, false, false, false, false}), Matrix({ { 0.28960179691274435 + -6.776263578034403e-21i, -0.010753419170909979 + -0.01621734885138277i, -0.0323976248600652 + -0.0139113501606082i, 0.001972324708510093 + 0.002275788657606123i }, { -0.010753419170909977 + 0.01621734885138277i, 0.2459795443070465 + -3.3881317890172014e-19i, 0.004469064053543204 + -0.0022778123638561073i, -0.03460237876723589 + 0.008221623121016191i }, { -0.032397624860065206 + 0.0139113501606082i, 0.004469064053543205 + 0.0022778123638561077i, 0.25153400111938334 + 1.9617283058409596e-18i, -0.00842431659671262 + -0.012197514422170846i }, { 0.0019723247085100927 + -0.0022757886576061236i, -0.034602378767235896 + -0.008221623121016191i, -0.00842431659671262 + 0.012197514422170846i, 0.2128846576608244 + -2.617331807015788e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, true, false, false, false, false}), ElementsAreArray({ DoubleNear(0.28960179691274435, 1.0e-7), DoubleNear(0.2459795443070465, 1.0e-7), DoubleNear(0.25153400111938334, 1.0e-7), DoubleNear(0.2128846576608244, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, true, false, false, false}), Matrix({ { 0.2590609343553648 + 1.8973538018496328e-19i, -0.009698474316802716 + -0.01488157834787832i, -0.010424510939759327 + 0.00021794547664746823i, 0.0005982035291103524 + 0.000537483226386066i }, { -0.009698474316802716 + 0.01488157834787832i, 0.22448557095060798 + 1.3044307387716225e-18i, 0.00012462792873685786 + -0.0005298603527745507i, 0.00010141647008321845 + 0.00433577336308495i }, { -0.01042451093975932 + -0.00021794547664746823i, 0.00012462792873685748 + 0.0005298603527745516i, 0.28207486367676293 + 1.765216662077962e-18i, -0.009479261450819882 + -0.013533284925675295i }, { 0.0005982035291103522 + -0.0005374832263860658i, 0.00010141647008322062 + -0.004335773363084949i, -0.00947926145081988 + 0.013533284925675295i, 0.23437863101726295 + -1.9049770983749215e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, true, false, false, false}), ElementsAreArray({ DoubleNear(0.2590609343553648, 1.0e-7), DoubleNear(0.22448557095060798, 1.0e-7), DoubleNear(0.28207486367676293, 1.0e-7), DoubleNear(0.23437863101726295, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, false, true, false, false}), Matrix({ { 0.28319328232314506 + 1.1316360175317453e-18i, -0.010038534549787401 + -0.015567024716098363i, 0.042568578595717534 + 0.015219983862975727i, -0.001639260330890827 + -0.0029986786852723513i }, { -0.010038534549787398 + 0.015567024716098363i, 0.24224776817607307 + 6.911788849595091e-19i, -0.0031420925888954046 + 0.0009676945784524968i, 0.03578755915578284 + 0.008247162283063346i }, { 0.04256857859571753 + -0.015219983862975729i, -0.0031420925888954046 + -0.0009676945784524964i, 0.25794251570898263 + 8.233160247311799e-19i, -0.009139201217835199 + -0.012847838557455252i }, { -0.001639260330890827 + 0.002998678685272351i, 0.03578755915578284 + -0.00824716228306335i, -0.009139201217835199 + 0.012847838557455252i, 0.21661643379179785 + -1.291725244562808e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, false, true, false, false}), ElementsAreArray({ DoubleNear(0.28319328232314506, 1.0e-7), DoubleNear(0.24224776817607307, 1.0e-7), DoubleNear(0.25794251570898263, 1.0e-7), DoubleNear(0.21661643379179785, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, false, false, true, false}), Matrix({ { 0.2690389063594435 + 9.994988777600744e-19i, -0.010163018914705686 + -0.013963393947371784i, 0.0026713764894779842 + -0.0036209526724816556i, -0.0008755891170576461 + 0.003145016249288226i }, { -0.010163018914705682 + 0.013963393947371784i, 0.22296526513772633 + 7.004962473793064e-19i, -0.0010088624693872401 + 0.002488454596162177i, -0.0004142204762453447 + 0.0004099342787685287i }, { 0.0026713764894779834 + 0.0036209526724816565i, -0.0010088624693872397 + -0.002488454596162178i, 0.27209689167268414 + 9.554531645028508e-19i, -0.009014716852916915 + -0.01445146932618183i }, { -0.0008755891170576463 + -0.003145016249288226i, -0.0004142204762453464 + -0.00040993427876852913i, -0.009014716852916913 + 0.01445146932618183i, 0.2358989368301446 + -1.3010426069826053e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, false, false, true, false}), ElementsAreArray({ DoubleNear(0.2690389063594435, 1.0e-7), DoubleNear(0.22296526513772633, 1.0e-7), DoubleNear(0.27209689167268414, 1.0e-7), DoubleNear(0.2358989368301446, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, false, false, false, true}), Matrix({ { 0.2707379972461599 + 2.3310346708438345e-18i, -0.009590631657049294 + -0.014202801003792379i, 0.00034300709368383705 + 0.0002180777330219957i, 1.2335860609193996e-05 + -6.467744100212757e-05i }, { -0.009590631657049292 + 0.014202801003792377i, 0.22968030721034888 + 4.828087799349512e-20i, -1.6929570220258866e-05 + 4.9647697450571866e-05i, -1.242210473929788e-05 + 0.00020443479942624604i }, { 0.000343007093683837 + -0.00021807773302199662i, -1.6929570220259035e-05 + -4.9647697450571764e-05i, 0.27039780078596776 + -3.7608262858090935e-19i, -0.009587104110573307 + -0.014212062269761235i }, { 1.2335860609194209e-05 + 6.467744100212774e-05i, -1.2422104739297988e-05 + -0.00020443479942624645i, -0.009587104110573303 + 0.014212062269761237i, 0.22918389475752204 + -6.488272375967941e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, false, false, false, true}), ElementsAreArray({ DoubleNear(0.2707379972461599, 1.0e-7), DoubleNear(0.22968030721034888, 1.0e-7), DoubleNear(0.27039780078596776, 1.0e-7), DoubleNear(0.22918389475752204, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, true, false, false, false, false}), Matrix({ { 0.26020118134304343 + 2.0328790734103208e-20i, 4.698590986770081e-05 + 0.00032219177940270784i, -0.03463330629715977 + 0.000333401639586216i, 2.4526490823527247e-05 + -1.7761777826175148e-05i }, { 4.6985909867700644e-05 + -0.0003221917794027079i, 0.27538015987674747 + -3.6591823321385775e-19i, -6.308689026197452e-05 + -1.0916157103647835e-05i, -0.03236669733014134 + -0.006023128679178225i }, { -0.034633306297159765 + -0.0003334016395862153i, -6.308689026197452e-05 + 1.0916157103647842e-05i, 0.23481188082511475 + 3.8116482626443515e-19i, 3.531476245226031e-05 + 0.00014957386959955053i }, { 2.4526490823527253e-05 + 1.7761777826175148e-05i, -0.03236669733014134 + 0.006023128679178226i, 3.531476245226026e-05 + -0.00014957386959955058i, 0.229606777955093 + 1.3188302988749456e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, true, false, false, false, false}), ElementsAreArray({ DoubleNear(0.26020118134304343, 1.0e-7), DoubleNear(0.27538015987674747, 1.0e-7), DoubleNear(0.23481188082511475, 1.0e-7), DoubleNear(0.229606777955093, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, true, false, false, false}), Matrix({ { 0.24052667121556812 + 4.777265822514254e-19i, 4.654123829640343e-05 + 0.0002142712319571589i, -0.004472868892658219 + 0.003486435174026825i, 1.9988541106027162e-05 + -4.312900254055358e-05i }, { 4.654123829640335e-05 + -0.00021427123195715895i, 0.24301983409040462 + 1.0164395367051604e-18i, -8.330248431819868e-06 + 3.279998663794606e-05i, -0.005850225577017891 + 0.0010672836657055942i }, { -0.004472868892658214 + -0.003486435174026823i, -8.330248431819865e-06 + -3.279998663794606e-05i, 0.25448639095259007 + -7.623296525288703e-20i, 3.575943402355766e-05 + 0.0002574944170450995i }, { 1.9988541106027172e-05 + 4.312900254055359e-05i, -0.005850225577017885 + -0.0010672836657055946i, 3.5759434023557526e-05 + -0.0002574944170450995i, 0.26196710374143584 + -6.352747104407253e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, true, false, false, false}), ElementsAreArray({ DoubleNear(0.24052667121556812, 1.0e-7), DoubleNear(0.24301983409040462, 1.0e-7), DoubleNear(0.25448639095259007, 1.0e-7), DoubleNear(0.26196710374143584, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, false, true, false, false}), Matrix({ { 0.2600998448703132 + 1.5280474368467578e-18i, 4.298874491431875e-05 + 0.0002477322022648625i, 0.03882018464529026 + 0.011603977485765863i, -3.549942336523821e-06 + 4.0170198644444396e-05i }, { 4.2988744914318694e-05 + -0.0002477322022648625i, 0.26534120562890495 + 2.947674656444965e-19i, 1.9459955417336904e-05 + -3.2137506514491856e-05i, 0.039535953106210116 + 0.011863168660273211i }, { 0.03882018464529026 + -0.011603977485765863i, 1.945995541733692e-05 + 3.213750651449186e-05i, 0.23491321729784498 + -1.1265538198482195e-18i, 3.931192740564234e-05 + 0.00022403344673739588i }, { -3.549942336523818e-06 + -4.01701986444444e-05i, 0.039535953106210116 + -0.011863168660273215i, 3.931192740564226e-05 + -0.0002240334467373959i, 0.23964573220293547 + 6.581446000165914e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, false, true, false, false}), ElementsAreArray({ DoubleNear(0.2600998448703132, 1.0e-7), DoubleNear(0.26534120562890495, 1.0e-7), DoubleNear(0.23491321729784498, 1.0e-7), DoubleNear(0.23964573220293547, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, false, false, true, false}), Matrix({ { 0.24341572526331817 + 1.2349740370967699e-18i, 4.435477067138392e-05 + 0.00023307118700724024i, 0.001111387092083842 + -0.00160899704390081i, 4.727896266729347e-06 + -4.190489036382196e-07i }, { 4.4354770671383836e-05 + -0.0002330711870072402i, 0.24858844623385162 + 4.650210880426109e-19i, 3.9439105576825575e-07 + -1.1800759964614018e-06i, 0.0011457689211487967 + -0.001602021349812317i }, { 0.001111387092083839 + 0.0016089970439008095i, 3.9439105576823627e-07 + 1.1800759964613997e-06i, 0.25159733690484 + -8.334804200982315e-19i, 3.7945901648577175e-05 + 0.00023869446199501816i }, { 4.727896266729343e-06 + 4.190489036382306e-07i, 0.0011457689211487984 + 0.0016020213498123183i, 3.794590164857712e-05 + -0.0002386944619950182i, 0.2563984915979888 + 4.87890977618477e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, false, false, true, false}), ElementsAreArray({ DoubleNear(0.24341572526331817, 1.0e-7), DoubleNear(0.24858844623385162, 1.0e-7), DoubleNear(0.25159733690484, 1.0e-7), DoubleNear(0.2563984915979888, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, false, false, false, true}), Matrix({ { 0.22473847492470417 + 2.6105555434377536e-18i, 0.00037230143468330363 + 0.00020087297908912295i, 3.6545076810550484e-06 + -5.485093262672283e-05i, 0.009401368269915968 + 0.008251602900670396i }, { 0.0003723014346833036 + -0.000200872979089123i, 0.27567982953180453 + -2.31239994600424e-19i, 0.010940538833326845 + -0.01017804383677806i, 0.0003269304812634841 + 0.0004773634650749646i }, { 3.6545076810548493e-06 + 5.485093262672218e-05i, 0.010940538833326845 + 0.010178043836778061i, 0.270274587243454 + -2.2090619264392153e-18i, -0.00029000076236334254 + 0.00027089266991313544i }, { 0.009401368269915965 + -0.008251602900670394i, 0.0003269304812634842 + -0.00047736346507496526i, -0.0002900007623633426 + -0.0002708926699131354i, 0.22930710830003587 + 1.1841520602615119e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, false, false, false, true}), ElementsAreArray({ DoubleNear(0.22473847492470417, 1.0e-7), DoubleNear(0.27567982953180453, 1.0e-7), DoubleNear(0.270274587243454, 1.0e-7), DoubleNear(0.22930710830003587, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, true, false, false, false}), Matrix({ { 0.26535008113959363 + -4.573977915173222e-19i, -0.03568457665569631 + -0.010412636141822298i, -0.001647396069492302 + -0.013148395169570587i, -0.0030587086584639026 + -0.0064335353183161085i }, { -0.03568457665569631 + 0.010412636141822296i, 0.21819642416637908 + 1.951563910473908e-18i, 0.00852227162722036 + -0.0009417893474547071i, -0.008675698400183807 + 0.017702114009303008i }, { -0.0016473960694922984 + 0.013148395169570587i, 0.008522271627220362 + 0.0009417893474547078i, 0.2702312600801972 + 1.1180834903756764e-19i, -0.03131542697160479 + 0.004722909102230289i }, { -0.003058708658463903 + 0.0064335353183161085i, -0.008675698400183802 + -0.017702114009303008i, -0.03131542697160479 + -0.0047229091022302876i, 0.2462222346138287 + -2.515687853345272e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, true, false, false, false}), ElementsAreArray({ DoubleNear(0.26535008113959363, 1.0e-7), DoubleNear(0.21819642416637908, 1.0e-7), DoubleNear(0.2702312600801972, 1.0e-7), DoubleNear(0.2462222346138287, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, false, true, false, false}), Matrix({ { 0.28134215098106974 + 1.5246593050577406e-18i, -0.035229249934178725 + -0.002922815472734462i, 0.04263313043792588 + 0.01341273564747632i, -0.004742717789600107 + -0.0029674878032258686i }, { -0.035229249934178725 + 0.0029228154727344623i, 0.24409889951814837 + 2.981555974335137e-19i, -0.006526463393896448 + -0.0009107053939011274i, 0.03572300731357449 + 0.010054410498562753i }, { 0.04263313043792588 + -0.013412735647476323i, -0.006526463393896448 + 0.0009107053939011274i, 0.2542391902387211 + -1.870248747537495e-18i, -0.03177075369312238 + -0.0027669115668575474i }, { -0.004742717789600107 + 0.00296748780322587i, 0.03572300731357449 + -0.010054410498562753i, -0.031770753693122385 + 0.0027669115668575483i, 0.22031975926205938 + 1.401839527705867e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, false, true, false, false}), ElementsAreArray({ DoubleNear(0.28134215098106974, 1.0e-7), DoubleNear(0.24409889951814837, 1.0e-7), DoubleNear(0.2542391902387211, 1.0e-7), DoubleNear(0.22031975926205938, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, false, false, true, false}), Matrix({ { 0.26630419752450174 + 6.437450399132683e-19i, -0.034013541570530825 + -0.0048306947219476275i, 0.0025226394600795597 + -0.0014639328732598989i, -0.0006360148457982193 + -0.0009047498855852536i }, { -0.034013541570530825 + 0.004830694721947628i, 0.2256999739726681 + 1.0562500852261125e-18i, -0.0007363754986234697 + 0.001137805272208328i, -0.00026548344684692053 + -0.0017470855204532283i }, { 0.002522639460079559 + 0.0014639328732598978i, -0.0007363754986234697 + -0.001137805272208327i, 0.2692771436952891 + -9.893344823930228e-19i, -0.03298646205677028 + -0.0008590323176443814i }, { -0.0006360148457982193 + 0.0009047498855852527i, -0.00026548344684692183 + 0.0017470855204532302i, -0.03298646205677028 + 0.0008590323176443823i, 0.23871868480753963 + 6.437450399132683e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, false, false, true, false}), ElementsAreArray({ DoubleNear(0.26630419752450174, 1.0e-7), DoubleNear(0.2256999739726681, 1.0e-7), DoubleNear(0.2692771436952891, 1.0e-7), DoubleNear(0.23871868480753963, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, false, false, false, true}), Matrix({ { 0.26846436396730733 + 1.085896238380013e-18i, -0.033379165373313494 + -0.0031217342684117825i, 0.00019425973663237108 + 0.00019038736824829888i, -3.395259773438121e-05 + -7.834067905847334e-05i }, { -0.033379165373313494 + 0.003121734268411783i, 0.23195394048920148 + 1.2934193104573166e-18i, -1.930825983401622e-05 + -6.1017183698835964e-05i, 0.0001363252523121681 + 0.00023212516419994286i }, { 0.000194259736632371 + -0.00019038736824829953i, -1.9308259834016193e-05 + 6.101718369883608e-05i, 0.2671169772524835 + -1.4314856808597676e-18i, -0.03362083825398761 + -0.0025679927711802263i }, { -3.39525977343812e-05 + 7.834067905847347e-05i, 0.00013632525231216806 + -0.00023212516419994354i, -0.03362083825398761 + 0.0025679927711802276i, 0.2324647182910063 + 4.0657581468206416e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, false, false, false, true}), ElementsAreArray({ DoubleNear(0.26846436396730733, 1.0e-7), DoubleNear(0.23195394048920148, 1.0e-7), DoubleNear(0.2671169772524835, 1.0e-7), DoubleNear(0.2324647182910063, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, true, true, false, false}), Matrix({ { 0.2540893473564596 + 9.690056916589196e-19i, -0.005045022856323504 + 0.00251359176688874i, 0.037984814461004546 + 0.01066148653937688i, -0.0011174627888684522 + -0.005937624467099473i }, { -0.0050450228563235 + -0.00251359176688874i, 0.2713517031427586 + 8.538092108323347e-19i, -0.005805196560967304 + -0.0012761577747170364i, 0.04037132329049582 + 0.012805659606662193i }, { 0.037984814461004546 + -0.010661486539376881i, -0.005805196560967304 + 0.001276157774717038i, 0.22945715794951316 + 5.251604272976662e-19i, -0.005278071613352605 + 0.0020401270728436787i }, { -0.0011174627888684507 + 0.005937624467099471i, 0.04037132329049582 + -0.012805659606662195i, -0.0052780716133526 + -0.002040127072843677i, 0.24510179155126732 + -9.935696471292943e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, true, true, false, false}), ElementsAreArray({ DoubleNear(0.2540893473564596, 1.0e-7), DoubleNear(0.2713517031427586, 1.0e-7), DoubleNear(0.22945715794951316, 1.0e-7), DoubleNear(0.24510179155126732, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, true, false, true, false}), Matrix({ { 0.23362983046266061 + 1.480613591800517e-18i, -0.01615244304527463 + -0.0033286629754823043i, 5.092679015692358e-05 + -0.0020227720832026053i, -0.004962656917084176 + -0.004715216166187976i }, { -0.016152443045274627 + 0.0033286629754823056i, 0.25837434103450924 + 2.193815333388638e-19i, -0.005826411799790571 + 0.0027004916717187797i, 0.0022062292230757155 + -0.001188246310510522i }, { 5.092679015692098e-05 + 0.002022772083202607i, -0.005826411799790571 + -0.0027004916717187806i, 0.2499166748433121 + 1.3552527156068805e-20i, 0.005829348575598522 + 0.007882381815214723i }, { -0.004962656917084174 + 0.004715216166187976i, 0.0022062292230757164 + 0.001188246310510521i, 0.005829348575598525 + -0.007882381815214723i, 0.2580791536595166 + -3.5914196963582334e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, true, false, true, false}), ElementsAreArray({ DoubleNear(0.23362983046266061, 1.0e-7), DoubleNear(0.25837434103450924, 1.0e-7), DoubleNear(0.2499166748433121, 1.0e-7), DoubleNear(0.2580791536595166, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, true, false, false, true}), Matrix({ { 0.24187177710686877 + 2.5478751053409354e-18i, -0.0052137931533965285 + 0.002178361115483994i, 0.00014288164005115577 + 0.00023438184845760228i, -1.3644415705651973e-05 + 2.2103802830778858e-05i }, { -0.005213793153396525 + -0.002178361115483994i, 0.25854652734963995 + -1.6855955650360577e-19i, 1.4516822240505127e-06 + 3.27544866944755e-05i, 0.00018770334889338337 + 0.00018813068399063944i }, { 0.0001428816400511558 + -0.00023438184845760282i, 1.45168222405053e-06 + -3.27544866944755e-05i, 0.24167472819910396 + -1.0537089863843496e-18i, -0.00510930131627958 + 0.0023753577242484245i }, { -1.3644415705651995e-05 + -2.2103802830778787e-05i, 0.00018770334889338326 + -0.00018813068399064028i, -0.0051093013162795764 + -0.0023753577242484236i, 0.2579069673443859 + 2.879912020664621e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, true, false, false, true}), ElementsAreArray({ DoubleNear(0.24187177710686877, 1.0e-7), DoubleNear(0.25854652734963995, 1.0e-7), DoubleNear(0.24167472819910396, 1.0e-7), DoubleNear(0.2579069673443859, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, true, true, false}), Matrix({ { 0.23441127614927093 + 1.6737371037744975e-18i, 0.023869939744038157 + 0.028004556782701674i, -0.010743475025318965 + -0.006693963076242883i, 0.032341109728033585 + -0.029747659937527128i }, { 0.023869939744038157 + -0.02800455678270168i, 0.2575928953478989 + 2.625802136488331e-20i, 0.03567955922365837 + 0.04438477700532139i, 0.013000631038551605 + 0.0034829446825297558i }, { -0.010743475025318966 + 0.00669396307624288i, 0.03567955922365837 + -0.044384777005321396i, 0.2910297743499472 + 1.4907779871675686e-19i, 0.05448619800746221 + -0.004537410636662603i }, { 0.032341109728033585 + 0.029747659937527128i, 0.013000631038551605 + -0.0034829446825297523i, 0.05448619800746221 + 0.0045374106366626015i, 0.21696605415288156 + -4.946672411965114e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, true, true, false}), ElementsAreArray({ DoubleNear(0.23441127614927093, 1.0e-7), DoubleNear(0.2575928953478989, 1.0e-7), DoubleNear(0.2910297743499472, 1.0e-7), DoubleNear(0.21696605415288156, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, true, false, true}), Matrix({ { 0.2629326967424117 + 1.060485249962384e-18i, 0.03920596415231127 + 0.011743179758698223i, 0.00017605542028736133 + 0.00022076158014478132i, 5.593015132447975e-06 + 5.229966227744091e-05i }, { 0.03920596415231127 + -0.011743179758698225i, 0.23748560771409705 + 1.3188302988749456e-18i, 2.5475572540519595e-05 + 1.3736073622942394e-05i, 0.0001545295686571778 + 0.00020175095230346042i }, { 0.00017605542028736133 + -0.000220761580144782i, 2.5475572540519473e-05 + -1.3736073622942607e-05i, 0.2625083537568064 + 7.623296525288703e-19i, 0.0391501735991891 + 0.01172396638734085i }, { 5.593015132447938e-06 + -5.229966227744103e-05i, 0.00015452956865717775 + -0.00020175095230346108i, 0.0391501735991891 + -0.011723966387340854i, 0.23707334178668343 + -1.7872395187065737e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, true, false, true}), ElementsAreArray({ DoubleNear(0.2629326967424117, 1.0e-7), DoubleNear(0.23748560771409705, 1.0e-7), DoubleNear(0.2625083537568064, 1.0e-7), DoubleNear(0.23707334178668343, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, false, true, true}), Matrix({ { 0.24621462056503546 + 1.9049770983749215e-18i, 0.0011297268978926502 + -0.00160549637180935i, 0.0001691563460887629 + 0.00020466450033954808i, -4.4265606866006954e-06 + 7.814478454537611e-06i }, { 0.0011297268978926476 + 0.001605496371809351i, 0.2542036838914733 + 4.743384504624082e-19i, -5.6900876942989505e-06 + -7.743494715675674e-06i, 0.00016142864285577623 + 0.00021784803210869367i }, { 0.0001691563460887629 + -0.00020466450033954873i, -5.690087694298981e-06 + 7.743494715675679e-06i, 0.24578955093213442 + -2.0498197323554068e-19i, 0.0011274291153399894 + -0.0016055220219037775i }, { -4.426560686600631e-06 + -7.81447845453774e-06i, 0.00016142864285577618 + -0.00021784803210869434i, 0.0011274291153399903 + 0.0016055220219037766i, 0.25379214461135546 + -8.199278929421627e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, false, true, true}), ElementsAreArray({ DoubleNear(0.24621462056503546, 1.0e-7), DoubleNear(0.2542036838914733, 1.0e-7), DoubleNear(0.24578955093213442, 1.0e-7), DoubleNear(0.25379214461135546, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, true, true, false, false, false, false, false}), Matrix({ { 0.13509526909329342 + 2.236166980751353e-19i, -0.010651720000105582 + 0.004111413278028301i, -0.004919334351058935 + -0.006025506179054783i, -0.006192903804867589 + -0.001150244793072518i, 4.13173983569068e-05 + 0.00014658692323298326i, -1.4810053678245326e-05 + -2.0309169409098137e-05i, -1.3173256687478526e-07 + -1.0443232727489813e-05i, 3.2491419752217357e-06 + -1.2900864796458323e-05i }, { -0.010651720000105584 + -0.004111413278028298i, 0.1327028410463643 + 1.4230153513872246e-19i, 0.01149499083516392 + 0.003918399373382751i, -0.004567306130515556 + -0.007995950892678478i, -1.1872179957478973e-05 + -1.7740697355990417e-05i, 2.5725736173344834e-05 + 0.00012904045186206236i, 3.896694088026205e-06 + 1.4070631350632445e-05i, 5.814449145958201e-06 + -1.4008992815704918e-05i }, { -0.0049193343510589346 + 0.006025506179054783i, 0.01149499083516392 + -0.003918399373382752i, 0.1132234069874879 + -1.1146953585866592e-18i, 2.245271382667795e-05 + -0.004275627824974641i, -1.167411676564886e-05 + -3.718193629291487e-06i, 1.0861727317581217e-05 + 8.9640962089196e-06i, 2.1981938664926242e-07 + 9.226431930691746e-05i, 4.015105623338353e-06 + -5.346667448466142e-06i }, { -0.006192903804867587 + 0.0011502447930725186i, -0.004567306130515557 + 0.007995950892678478i, 2.2452713826679252e-05 + 0.00427562782497464i, 0.11399154504101257 + 1.1502707423713399e-18i, -9.58403212849552e-06 + 2.0535767766281763e-06i, -1.604168935836539e-05 + 2.2219382273855276e-06i, -9.666365263712125e-06 + 1.2003216532894914e-06i, 1.5037718403060238e-05 + 0.00010387395460029531i }, { 4.131739835690672e-05 + -0.00014658692323298326i, -1.1872179957478958e-05 + 1.7740697355990444e-05i, -1.167411676564887e-05 + 3.7181936292915148e-06i, -9.584032128495514e-06 + -2.0535767766281628e-06i, 0.13803159978769228 + 1.5246593050577406e-18i, -0.011063235928665472 + 0.004059795351043785i, -0.005034800116997854 + -0.006135049717330383i, -0.006201202256791482 + -0.001297709630618005i }, { -1.4810053678245302e-05 + 2.030916940909815e-05i, 2.572573617334474e-05 + -0.00012904045186206239i, 1.0861727317581216e-05 + -8.96409620891959e-06i, -1.6041689358365382e-05 + -2.2219382273855107e-06i, -0.011063235928665472 + -0.004059795351043783i, 0.13530608810477773 + 6.437450399132683e-20i, 0.011715621272885684 + 0.003956392337369618i, -0.004656295169050254 + -0.00825835648448997i }, { -1.3173256687477086e-07 + 1.0443232727489816e-05i, 3.896694088026213e-06 + -1.4070631350632435e-05i, 2.1981938664924886e-07 + -9.226431930691744e-05i, -9.666365263712111e-06 + -1.2003216532894702e-06i, -0.005034800116997853 + 0.006135049717330383i, 0.011715621272885684 + -0.003956392337369618i, 0.11529663208727746 + 5.878408653944844e-19i, 1.929570619990705e-05 + -0.004280712995088002i }, { 3.24914197522175e-06 + 1.2900864796458326e-05i, 5.814449145958207e-06 + 1.4008992815704897e-05i, 4.015105623338338e-06 + 5.346667448466121e-06i, 1.5037718403060224e-05 + -0.00010387395460029534i, -0.00620120225679148 + 0.001297709630618006i, -0.004656295169050253 + 0.00825835648448997i, 1.9295706199907374e-05 + 0.004280712995088001i, 0.11635261785209297 + -1.223962608782464e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, true, true, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.13509526909329342, 1.0e-7), DoubleNear(0.1327028410463643, 1.0e-7), DoubleNear(0.1132234069874879, 1.0e-7), DoubleNear(0.11399154504101257, 1.0e-7), DoubleNear(0.13803159978769228, 1.0e-7), DoubleNear(0.13530608810477773, 1.0e-7), DoubleNear(0.11529663208727746, 1.0e-7), DoubleNear(0.11635261785209297, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, true, false, true, false, false, false, false}), Matrix({ { 0.1461782731040809 + 4.811147140404426e-19i, -0.011631399027242596 + 0.004362749738283035i, -0.005592744263687306 + -0.006943136201311879i, -0.007008153929889742 + -0.0014576706543269952i, -0.016349587082571893 + -0.00702775621969484i, 0.0014999986554719495 + 7.09347171721128e-05i, 0.0009996286948155868 + 0.0009626133094803252i, 0.0011143013031592111 + 5.902714686548854e-05i }, { -0.011631399027242596 + -0.0043627497382830345i, 0.14342352380866344 + -4.87890977618477e-19i, 0.013131842570236378 + 0.004565779948494631i, -0.005160674907222674 + -0.009274212650070888i, 0.0010943238743220695 + 0.001060108176420108i, -0.016048037777493314 + -0.00688359394091336i, -0.002120758307540846 + -0.00044573291799967346i, 0.0009726960136945064 + 0.001313175348125798i }, { -0.005592744263687303 + 0.00694313620131188i, 0.013131842570236378 + -0.004565779948494631i, 0.12249273136961897 + 3.6422416731934915e-19i, 2.2778532986362284e-05 + -0.004579062650947072i, 0.002130249730413746 + -0.00085237420362157i, -0.0035184236978645297 + -0.0006204006888294736i, -0.017236627438296254 + 0.004101468265874724i, 0.00015363717073741737 + 0.0006490185646680983i }, { -0.00700815392988974 + 0.0014576706543269961i, -0.005160674907222674 + 0.009274212650070888i, 2.2778532986362718e-05 + 0.004579062650947071i, 0.12348681293742754 + -7.030373462210693e-19i, 0.0017828302981477912 + 0.0005484488116830469i, 0.002338814323129458 + -0.0014254381602345375i, -0.0001607333385408337 + -0.0006465751613874359i, -0.017365751328939638 + 0.004120154855141468i }, { -0.016349587082571893 + 0.00702775621969484i, 0.0010943238743220695 + -0.0010601081764201078i, 0.002130249730413746 + 0.00085237420362157i, 0.0017828302981477916 + -0.0005484488116830472i, 0.12694859577690476 + 1.2671612890924333e-18i, -0.01008355690152846 + 0.003808458890789051i, -0.004361390204369485 + -0.005217419695073286i, -0.005385952131769328 + -0.000990283769363528i }, { 0.001499998655471949 + -7.093471717211278e-05i, -0.016048037777493314 + 0.00688359394091336i, -0.0035184236978645297 + 0.0006204006888294739i, 0.0023388143231294583 + 0.0014254381602345377i, -0.01008355690152846 + -0.0038084588907890474i, 0.12458540534247858 + 6.945670167485263e-19i, 0.010078769537813226 + 0.003309011762257739i, -0.004062926392343137 + -0.00698009472709756i }, { 0.0009996286948155868 + -0.0009626133094803254i, -0.0021207583075408465 + 0.0004457329179996738i, -0.017236627438296254 + -0.004101468265874722i, -0.00016073333854083364 + 0.000646575161387436i, -0.004361390204369484 + 0.005217419695073286i, 0.010078769537813226 + -0.0033090117622577384i, 0.1060273077051464 + -8.91078660511524e-19i, 1.8969887040222932e-05 + -0.003977278169115572i }, { 0.0011143013031592111 + -5.902714686548855e-05i, 0.0009726960136945058 + -0.0013131753481257981i, 0.00015363717073741724 + -0.0006490185646680985i, -0.017365751328939638 + -0.004120154855141467i, -0.0053859521317693275 + 0.0009902837693635284i, -0.004062926392343136 + 0.00698009472709756i, 1.89698870402238e-05 + 0.003977278169115571i, 0.106857349955678 + 6.293454798099452e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, true, false, true, false, false, false, false}), ElementsAreArray({ DoubleNear(0.1461782731040809, 1.0e-7), DoubleNear(0.14342352380866344, 1.0e-7), DoubleNear(0.12249273136961897, 1.0e-7), DoubleNear(0.12348681293742754, 1.0e-7), DoubleNear(0.12694859577690476, 1.0e-7), DoubleNear(0.12458540534247858, 1.0e-7), DoubleNear(0.1060273077051464, 1.0e-7), DoubleNear(0.106857349955678, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, true, false, false, true, false, false, false}), Matrix({ { 0.13075665244140353 + 1.2536087619363645e-18i, -0.010390796559740088 + 0.003935690813724281i, -0.00505727623047943 + -0.006388890271499366i, -0.006415996091876168 + -0.0013778478967571301i, -0.005268398818201929 + 0.00010670410829262736i, 0.000412964530739166 + -0.00017234894294945345i, 0.00029581599593662695 + 0.00021954414415710597i, 0.00029249979591883203 + -4.18032397667523e-06i }, { -0.01039079655974009 + -0.003935690813724279i, 0.12830428191396123 + -1.0638733817514012e-18i, 0.01196111905323172 + 0.004292137310574459i, -0.004641198086323286 + -0.008492688076378953i, 0.0004287727836367512 + 0.00016234453894269242i, -0.005156112121557399 + 0.00011124136835484119i, -0.000570720523545221 + -4.762701514944703e-05i, 0.0003023875331737254 + 0.00031793908222896i }, { -0.00505727623047943 + 0.006388890271499368i, 0.01196111905323172 + -0.004292137310574458i, 0.11179220517807273 + 4.760325163569168e-19i, 8.179678395448084e-06 + -0.004209160261048428i, 7.674831147011225e-05 + -0.00023277230519094653i, -0.0002866250680907218 + 0.0002527058973668753i, 5.7662287455644565e-05 + 0.0021600793465942924i, 9.606098822654642e-05 + 1.2970434009902622e-05i }, { -0.006415996091876166 + 0.001377847896757131i, -0.004641198086323286 + 0.008492688076378953i, 8.179678395448193e-06 + 0.004209160261048427i, 0.11269336577253522 + 8.283982224147057e-19i, 0.00016901554951696384 + -0.00013510553302447493i, 4.787961726674558e-05 + -0.0002970880475836042i, -7.51094424586319e-05 + -1.544467403896719e-05i, 4.3754182627573236e-05 + 0.0021756940164906575i }, { -0.005268398818201924 + -0.00010670410829262736i, 0.0004287727836367511 + -0.00016234453894269267i, 7.674831147011204e-05 + 0.00023277230519094715i, 0.0001690155495169642 + 0.00013510553302447487i, 0.14237021643958214 + 4.946672411965114e-19i, -0.011324159369030968 + 0.004235517815347804i, -0.004896858237577359 + -0.0057716656248858i, -0.005978109969782901 + -0.001070106526933393i }, { 0.00041296453073916555 + 0.0001723489429494535i, -0.005156112121557397 + -0.00011124136835484097i, -0.0002866250680907215 + -0.00025270589736687584i, 4.787961726674544e-05 + 0.0002970880475836044i, -0.011324159369030966 + -0.004235517815347801i, 0.1397046472371808 + 1.2705494208814505e-18i, 0.011249493054817884 + 0.003582654400177911i, -0.004582403213242523 + -0.007761619300789495i }, { 0.0002958159959366267 + -0.0002195441441571057i, -0.0005707205235452207 + 4.7627015149446865e-05i, 5.766228745564695e-05 + -0.002160079346594293i, -7.510944245863214e-05 + 1.5444674038967073e-05i, -0.0048968582375773576 + 0.0057716656248858i, 0.011249493054817884 + -0.003582654400177911i, 0.11672783389669261 + -1.0028870095490916e-18i, 3.356874163113724e-05 + -0.004347180559014216i }, { 0.000292499795918832 + 4.1803239766750134e-06i, 0.00030238753317372543 + -0.00031793908222896i, 9.606098822654657e-05 + -1.2970434009902798e-05i, 4.375418262757345e-05 + -0.0021756940164906566i, -0.0059781099697829 + 0.0010701065269333935i, -0.004582403213242523 + 0.007761619300789496i, 3.3568741631138e-05 + 0.004347180559014215i, 0.1176507971205703 + -9.020900888258299e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, true, false, false, true, false, false, false}), ElementsAreArray({ DoubleNear(0.13075665244140353, 1.0e-7), DoubleNear(0.12830428191396123, 1.0e-7), DoubleNear(0.11179220517807273, 1.0e-7), DoubleNear(0.11269336577253522, 1.0e-7), DoubleNear(0.14237021643958214, 1.0e-7), DoubleNear(0.1397046472371808, 1.0e-7), DoubleNear(0.11672783389669261, 1.0e-7), DoubleNear(0.1176507971205703, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, true, false, false, false, true, false, false}), Matrix({ { 0.14301301590328383 + 7.995991022080595e-19i, -0.00880740103687537 + 0.000673760332556614i, -0.004096013864748024 + -0.005988274482113835i, -0.0073568409096194266 + -0.0015698720556172573i, 0.017279496181462232 + 0.006797460989862681i, 0.0006658608114494622 + -0.007663668795043443i, 0.0020773561119489742 + -0.002833216995006405i, -0.0016085884616894737 + -0.0004400117165458935i }, { -0.008807401036875369 + -0.000673760332556612i, 0.14018026641986125 + 3.3203691532368573e-19i, 0.011895282809273997 + 0.003955694832568113i, -0.005942520685039376 + -0.009578750233984527i, 0.0023080431914946197 + -0.011825685854547515i, 0.0252890824142553 + 0.008422522873113045i, 0.001320456157902979 + 0.0021251461771038095i, -0.0037166164428398007 + -0.0001654616902659466i }, { -0.004096013864748024 + 0.005988274482113835i, 0.011895282809273997 + -0.003955694832568113i, 0.1206982798158584 + 7.521652571618187e-19i, 0.0014506267403298408 + -0.007492304128600124i, -0.0009954477501910352 + -0.0038689550717739656i, 0.0027921102615096408 + 0.00024365943589859016i, 0.018034658695920865 + 0.007787919742479385i, -0.0010784430716497995 + -0.004823336462126782i }, { -0.007356840909619425 + 0.0015698720556172581i, -0.005942520685039375 + 0.00957875023398453i, 0.0014506267403298413 + 0.007492304128600123i, 0.12154948836021467 + -6.098637220230962e-20i, 0.00043879926761223155 + 0.0012868822642116346i, -0.002146644838704369 + 0.004836649650226461i, -0.0008013395269413448 + -0.001556835432765918i, 0.01775290045986197 + 0.00045924254058396117i }, { 0.017279496181462232 + -0.006797460989862681i, 0.0023080431914946197 + 0.011825685854547512i, -0.0009954477501910356 + 0.003868955071773966i, 0.000438799267612232 + -0.0012868822642116344i, 0.13011385297770187 + 9.486769009248164e-19i, -0.012907554891895687 + 0.007497448296515472i, -0.0058581206033087654 + -0.006172281414271331i, -0.005037265152039643 + -0.000878082368073266i }, { 0.0006658608114494639 + 0.007663668795043444i, 0.0252890824142553 + -0.008422522873113049i, 0.002792110261509641 + -0.00024365943589858976i, -0.002146644838704368 + -0.004836649650226462i, -0.012907554891895687 + -0.007497448296515469i, 0.1278286627312808 + -1.2536087619363645e-19i, 0.011315329298775607 + 0.0039190968781842575i, -0.0032810806145264345 + -0.00667555714318392i }, { 0.002077356111948974 + 0.0028332169950064058i, 0.0013204561579029796 + -0.0021251461771038104i, 0.018034658695920865 + -0.007787919742479386i, -0.0008013395269413449 + 0.0015568354327659185i, -0.005858120603308764 + 0.006172281414271331i, 0.011315329298775609 + -0.0039190968781842575i, 0.10782175925890695 + -1.2790197503539935e-18i, -0.0014088783203032556 + -0.0010640366914625198i }, { -0.0016085884616894735 + 0.0004400117165458932i, -0.0037166164428398007 + 0.00016546169026594552i, -0.001078443071649799 + 0.004823336462126782i, 0.01775290045986197 + -0.00045924254058396204i, -0.005037265152039641 + 0.0008780823680732664i, -0.003281080614526435 + 0.00667555714318392i, -0.0014088783203032554 + 0.0010640366914625187i, 0.10879467453289088 + -1.2705494208814505e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, true, false, false, false, true, false, false}), ElementsAreArray({ DoubleNear(0.14301301590328383, 1.0e-7), DoubleNear(0.14018026641986125, 1.0e-7), DoubleNear(0.1206982798158584, 1.0e-7), DoubleNear(0.12154948836021467, 1.0e-7), DoubleNear(0.13011385297770187, 1.0e-7), DoubleNear(0.1278286627312808, 1.0e-7), DoubleNear(0.10782175925890695, 1.0e-7), DoubleNear(0.10879467453289088, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, true, false, false, false, false, true, false}), Matrix({ { 0.13407492581951697 + 1.294266343404571e-18i, -0.015493332506647976 + 0.006099656918264163i, -0.006622199794557315 + -0.0064180400974537585i, -0.005372105719974573 + -0.0007674008726557113i, -0.002115956247932674 + 0.01026466531687575i, 0.0001704617104220337 + 0.006792767291695985i, 0.0023693160259744507 + 0.0007479870059221637i, 0.00041027719227068236 + -0.001342259923323394i }, { -0.015493332506647972 + -0.006099656918264159i, 0.1349639805399266 + -2.947674656444965e-19i, 0.012108832196150894 + 0.004438341397024386i, -0.0035408191201483693 + -0.007545353849918026i, -0.0014387388963241644 + 0.0008151185031475864i, 0.004787332737410659 + -0.013885617989357406i, 0.0017700218777492505 + -0.0004897924854495872i, -0.0032449051430320968 + 0.0023970292433660623i }, { -0.0066221997945573145 + 0.0064180400974537585i, 0.012108832196150894 + -0.004438341397024386i, 0.11289094249308207 + 2.727446090158847e-19i, -0.002350245955595259 + -0.003147646465811071i, -0.0025597701545285395 + -0.0008009437097442204i, -0.0006739268405433151 + -0.0014903499579530803i, 0.0005734854494418217 + -0.0064263184636846795i, -0.006763014107415191 + 0.007209252161049289i }, { -0.0053721057199745716 + 0.0007674008726557119i, -0.0035408191201483693 + 0.007545353849918026i, -0.0023502459555952582 + 0.0031476464658110703i, 0.11007432264464426 + 4.2775163836342167e-19i, 0.00116890228740342 + -0.000890403078304954i, 0.0015509076851412996 + 0.0032893983059063972i, 0.002770264286956524 + 0.005461531408843442i, -0.0009877059256871669 + 0.006836252742453208i }, { -0.0021159562479326757 + -0.01026466531687575i, -0.001438738896324164 + -0.0008151185031475862i, -0.0025597701545285395 + 0.0008009437097442202i, 0.00116890228740342 + 0.0008904030783049537i, 0.13905194306146873 + 4.54009659728305e-19i, -0.006221623422123082 + 0.0020715517108079234i, -0.003331934673499474 + -0.005742515798931409i, -0.007022000341684497 + -0.001680553551034812i }, { 0.00017046171042203555 + -0.006792767291695985i, 0.00478733273741066 + 0.013885617989357404i, -0.0006739268405433155 + 0.00149034995795308i, 0.0015509076851412996 + -0.0032893983059063977i, -0.006221623422123082 + -0.0020715517108079217i, 0.13304494861121544 + 5.014435047745458e-19i, 0.011101779911898712 + 0.0034364503137279843i, -0.005682782179417441 + -0.008708953527250422i }, { 0.0023693160259744507 + -0.0007479870059221635i, 0.0017700218777492505 + 0.000489792485449588i, 0.000573485449441821 + 0.0064263184636846795i, 0.002770264286956523 + -0.005461531408843442i, -0.0033319346734994723 + 0.005742515798931409i, 0.011101779911898712 + -0.0034364503137279847i, 0.11562909658168329 + -7.995991022080595e-19i, 0.002391994375621844 + -0.005408694354251573i }, { 0.0004102771922706824 + 0.0013422599233233942i, -0.0032449051430320968 + -0.0023970292433660623i, -0.006763014107415192 + -0.007209252161049288i, -0.0009877059256871673 + -0.006836252742453208i, -0.007022000341684495 + 0.0016805535510348126i, -0.005682782179417441 + 0.008708953527250422i, 0.002391994375621844 + 0.005408694354251571i, 0.1202698402484613 + -5.014435047745458e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, true, false, false, false, false, true, false}), ElementsAreArray({ DoubleNear(0.13407492581951697, 1.0e-7), DoubleNear(0.1349639805399266, 1.0e-7), DoubleNear(0.11289094249308207, 1.0e-7), DoubleNear(0.11007432264464426, 1.0e-7), DoubleNear(0.13905194306146873, 1.0e-7), DoubleNear(0.13304494861121544, 1.0e-7), DoubleNear(0.11562909658168329, 1.0e-7), DoubleNear(0.1202698402484613, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, true, false, false, false, false, false, true}), Matrix({ { 0.13662896872891295 + 2.0972535774016476e-18i, -0.010906116496901746 + 0.0040817316740240535i, -0.004971957532299021 + -0.006080234803446912i, -0.006193654439477449 + -0.0012391623338544183i, 0.000346553379603526 + 0.00011202373966527225i, -0.00018814250020481098 + -0.00016022884194270454i, -4.504708096423937e-06 + 6.82111807287116e-06i, 8.578873627431379e-05 + -7.54022690876294e-05i }, { -0.010906116496901746 + -0.004081731674024052i, 0.134109028517247 + 2.337810934421869e-19i, 0.01160249185427966 + 0.003944641328511844i, -0.004618674124750274 + -0.008122566200345467i, -0.0001925607736524476 + 0.00014099299819109195i, -3.5462859196890305e-06 + 0.00010605399335672348i, -9.669963327707794e-06 + -2.334261463757053e-05i, 1.684056870561794e-05 + -7.149855907499875e-05i }, { -0.00497195753229902 + 0.006080234803446912i, 0.01160249185427966 + -0.003944641328511844i, 0.1143503209039889 + -8.809142651444724e-20i, 2.140905102356928e-05 + -0.004250328474332975i, -1.476586700569214e-05 + -1.5303555395704784e-05i, -5.423915448070846e-06 + 4.398480638908691e-05i, -0.0001392329370981767 + 0.00010050969280298128i, -4.946053277043577e-06 + 9.875389270392648e-05i }, { -0.006193654439477447 + 0.0012391623338544192i, -0.004618674124750274 + 0.008122566200345467i, 2.140905102356993e-05 + 0.004250328474332973i, 0.11532998630635996 + 1.3637230450794235e-19i, 8.133592107941086e-05 + 7.108877259078217e-05i, -2.163703214566728e-06 + 6.495125284627665e-05i, 2.055563670595896e-06 + -9.479885833215993e-05i, 0.00012681083235887886 + 0.00010392510662326473i }, { 0.00034655337960352606 + -0.0001120237396652728i, -0.00019256077365244773 + -0.00014099299819109174i, -1.4765867005692183e-05 + 1.5303555395704866e-05i, 8.13359210794108e-05 + -7.108877259078224e-05i, 0.13649790015207275 + -3.4897757426877174e-19i, -0.010808839431869312 + 0.004089476955048032i, -0.004982176935757769 + -0.006080321092938255i, -0.006200451622181621 + -0.001208792089836105i }, { -0.0001881425002048108 + 0.0001602288419427048i, -3.5462859196890847e-06 + -0.0001060539933567238i, -5.423915448070858e-06 + -4.398480638908687e-05i, -2.1637032145668515e-06 + -6.495125284627661e-05i, -0.01080883943186931 + -0.004089476955048029i, 0.13389990063389504 + -2.710505431213761e-20i, 0.011608120253769946 + 0.003930150382240526i, -0.004604927174815536 + -0.008131741176822981i }, { -4.504708096423815e-06 + -6.821118072871092e-06i, -9.66996332770779e-06 + 2.3342614637570543e-05i, -0.0001392329370981768 + -0.00010050969280298133i, 2.0555636705959232e-06 + 9.47988583321599e-05i, -0.004982176935757768 + 0.006080321092938256i, 0.011608120253769946 + -0.003930150382240526i, 0.11416971817077645 + -4.387630666777276e-19i, 2.0339369003015938e-05 + -0.0043060123457296685i }, { 8.578873627431383e-05 + 7.540226908762934e-05i, 1.684056870561804e-05 + 7.149855907499882e-05i, -4.9460532770435805e-06 + -9.875389270392655e-05i, 0.00012681083235887886 + -0.00010392510662326511i, -0.0062004516221816205 + 0.0012087920898361053i, -0.004604927174815535 + 0.008131741176822981i, 2.0339369003015938e-05 + 0.0043060123457296685i, 0.11501417658674559 + -2.1006417091906648e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, true, false, false, false, false, false, true}), ElementsAreArray({ DoubleNear(0.13662896872891295, 1.0e-7), DoubleNear(0.134109028517247, 1.0e-7), DoubleNear(0.1143503209039889, 1.0e-7), DoubleNear(0.11532998630635996, 1.0e-7), DoubleNear(0.13649790015207275, 1.0e-7), DoubleNear(0.13389990063389504, 1.0e-7), DoubleNear(0.11416971817077645, 1.0e-7), DoubleNear(0.11501417658674559, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, true, true, false, false, false, false}), Matrix({ { 0.13052417303854585 + -9.24959978401696e-19i, -0.0055807113044963755 + -0.0001058234809561749i, 2.4056566558611632e-05 + 0.00016546576445114727i, -2.4980056479383485e-06 + -2.0694525691813612e-05i, -0.017363391606056745 + 0.0001322532407699505i, 0.0008406664215501447 + 0.00029754623293224504i, 1.233508959632793e-05 + -9.729230632258952e-06i, -6.423223377721717e-07 + 3.9236948296708344e-07i }, { -0.0055807113044963755 + 0.0001058234809561755i, 0.12967700830449758 + 9.452887691357992e-19i, -1.4182698907249419e-05 + -1.5986400457502837e-05i, 2.2929343309089175e-05 + 0.0001567260149515606i, 0.000471347671737256 + 0.00014125168308950307i, -0.01726991469110302 + 0.00020114839881626536i, -1.5441210365424346e-06 + -7.936645097101188e-07i, 1.2191401227199316e-05 + -8.032547193916198e-06i }, { 2.405656655861155e-05 + -0.00016546576445114727i, -1.418269890724941e-05 + 1.598640045750285e-05i, 0.138146831435154 + 1.7702988597614877e-18i, -0.006027909189759858 + -0.000110489431707861i, -3.261077956721216e-05 + -4.353511451537359e-06i, 5.086562659528539e-06 + 1.3389445566478596e-06i, -0.0162228229148114 + -0.0030585411945900677i, 0.0008129694046592221 + 0.0004224070489079661i }, { -2.4980056479383544e-06 + 2.069452569181361e-05i, 2.2929343309089094e-05 + -0.0001567260149515606i, -0.006027909189759858 + 0.00011048943170786154i, 0.13723332844159344 + -2.1362170929753455e-18i, 4.909978650609715e-06 + -2.7103508691508556e-06i, -3.0476110694762355e-05 + -6.56264565211048e-06i, 0.00046224286404398 + 0.00027228133194316916i, -0.01614387441532993 + -0.0029645874845881572i }, { -0.017363391606056745 + -0.00013225324076994942i, 0.0004713476717372559 + -0.00014125168308950302i, -3.261077956721216e-05 + 4.353511451537359e-06i, 4.909978650609716e-06 + 2.7103508691508573e-06i, 0.11779450304223543 + 3.3881317890172014e-20i, -0.00504855598178253 + -5.8391065990165674e-05i, 1.7480651184944395e-05 + 7.338547808875344e-05i, -8.296942406968623e-06 + -4.961311165750667e-06i }, { 0.0008406664215501444 + -0.00029754623293224526i, -0.01726991469110302 + -0.00020114839881626583i, 5.086562659528541e-06 + -1.3389445566478638e-06i, -3.047611069476235e-05 + 6.562645652110483e-06i, -0.005048555981782528 + 5.839106599016643e-05i, 0.11701737778287932 + 3.4728350837426314e-19i, -7.355846313941673e-06 + -5.539752451980899e-07i, 1.783411126731591e-05 + 7.61883915107971e-05i }, { 1.2335089596327932e-05 + 9.729230632258941e-06i, -1.544121036542437e-06 + 7.936645097101154e-07i, -0.0162228229148114 + 0.0030585411945900673i, 0.0004622428640439799 + -0.0002722813319431689i, 1.7480651184944375e-05 + -7.338547808875342e-05i, -7.355846313941661e-06 + 5.539752451981197e-07i, 0.11518140043981573 + 3.4220131069073734e-19i, -0.005016031032705709 + -0.00011042821233635594i }, { -6.423223377721709e-07 + -3.9236948296707815e-07i, 1.219140122719932e-05 + 8.0325471939162e-06i, 0.0008129694046592218 + -0.0004224070489079661i, -0.016143874415329933 + 0.0029645874845881585i, -8.29694240696861e-06 + 4.9613111657506685e-06i, 1.7834111267315883e-05 + -7.618839151079713e-05i, -0.005016031032705706 + 0.0001104282123363567i, 0.11442537751527726 + 9.766289881842083e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, true, true, false, false, false, false}), ElementsAreArray({ DoubleNear(0.13052417303854585, 1.0e-7), DoubleNear(0.12967700830449758, 1.0e-7), DoubleNear(0.138146831435154, 1.0e-7), DoubleNear(0.13723332844159344, 1.0e-7), DoubleNear(0.11779450304223543, 1.0e-7), DoubleNear(0.11701737778287932, 1.0e-7), DoubleNear(0.11518140043981573, 1.0e-7), DoubleNear(0.11442537751527726, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, true, false, true, false, false, false}), Matrix({ { 0.1206517587362516 + 1.7279472123987727e-19i, -0.0051276463687439724 + -0.00010708571018507127i, 2.3008897860857502e-05 + 0.00010682033357280421i, -5.489518996177346e-06 + -1.008016249043447e-05i, -0.0022541546440483264 + 0.0017414466940219257i, 0.00022039562631773576 + -9.080748507692437e-05i, 9.775300590796754e-06 + -2.3261677174586757e-05i, -2.5846800821439778e-06 + 3.4884371443131866e-06i }, { -0.0051276463687439724 + 0.00010708571018507187i, 0.11987491247931653 + 3.049318610115481e-19i, -9.03263951861598e-06 + -5.372108519161856e-06i, 2.3532340435545928e-05 + 0.0001074508983843547i, 0.00014339375732883816 + 3.054062926504726e-05i, -0.0022187142486098915 + 0.0017449884800048985i, 7.224749772634917e-07 + 4.143062240625144e-06i, 1.0213240515230408e-05 + -1.986732536596682e-05i }, { 2.3008897860857488e-05 + -0.00010682033357280421i, -9.032639518615984e-06 + 5.37210851916188e-06i, 0.12189709888322466 + 1.556846557053404e-18i, -0.00525497051260067 + -0.00016638373713907437i, -4.441237240836197e-06 + 1.8140499168406468e-05i, 2.8799089992242845e-06 + -4.587371382251044e-06i, -0.002956581886697957 + 0.000525336760864994i, 0.00028862989264797663 + -6.857102386262644e-05i }, { -5.489518996177341e-06 + 1.0080162490434465e-05i, 2.35323404355459e-05 + -0.00010745089838435474i, -0.00525497051260067 + 0.00016638373713907497i, 0.12112273520717995 + -5.404070203482436e-19i, -2.8114826486301445e-07 + -3.333530737875453e-06i, -3.8890111909836675e-06 + 1.4659487469539589e-05i, 0.0002102695838492812 + 0.00011635923563867798i, -0.0028936436903199327 + 0.0005419469048406001i }, { -0.0022541546440483238 + -0.0017414466940219254i, 0.00014339375732883806 + -3.054062926504727e-05i, -4.441237240836194e-06 + -1.8140499168406465e-05i, -2.8114826486301064e-07 + 3.3335307378754547e-06i, 0.1276669173445297 + -1.0638733817514012e-18i, -0.005501620917534933 + -5.712883676126942e-05i, 1.8528319882698532e-05 + 0.00013203090896709652i, -5.305429058729627e-06 + -1.5575674367129812e-05i }, { 0.00022039562631773538 + 9.080748507692414e-05i, -0.002218714248609891 + -0.0017449884800048972i, 2.8799089992242874e-06 + 4.5873713822510445e-06i, -3.889011190983671e-06 + -1.4659487469539592e-05i, -0.005501620917534932 + 5.712883676127007e-05i, 0.12681947360806034 + 9.876404164985142e-19i, -1.2505905702575114e-05 + -1.116826718353907e-05i, 1.7231114140859143e-05 + 0.00012546350807800298i }, { 9.775300590796762e-06 + 2.3261677174586753e-05i, 7.224749772634912e-07 + -4.143062240625144e-06i, -0.002956581886697953 + -0.0005253367608649947i, 0.00021026958384928087 + -0.0001163592356386783i, 1.8528319882698478e-05 + -0.0001320309089670965i, -1.2505905702575088e-05 + 1.1168267183539093e-05i, 0.13143113299174508 + 5.55653613398821e-19i, -0.005788969709864896 + -5.4533906905142456e-05i }, { -2.584680082143976e-06 + -3.4884371443131866e-06i, 1.0213240515230411e-05 + 1.986732536596683e-05i, 0.0002886298926479768 + 6.857102386262652e-05i, -0.002893643690319932 + -0.0005419469048406001i, -5.305429058729623e-06 + 1.5575674367129812e-05i, 1.7231114140859075e-05 + -0.00012546350807800298i, -0.005788969709864894 + 5.4533906905143324e-05i, 0.13053597074969076 + -6.191810844428935e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, true, false, true, false, false, false}), ElementsAreArray({ DoubleNear(0.1206517587362516, 1.0e-7), DoubleNear(0.11987491247931653, 1.0e-7), DoubleNear(0.12189709888322466, 1.0e-7), DoubleNear(0.12112273520717995, 1.0e-7), DoubleNear(0.1276669173445297, 1.0e-7), DoubleNear(0.12681947360806034, 1.0e-7), DoubleNear(0.13143113299174508, 1.0e-7), DoubleNear(0.13053597074969076, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, true, false, false, true, false, false}), Matrix({ { 0.1305174121312535 + 2.0667603913004928e-19i, -0.003582997145507619 + -0.003359457351959858i, 2.4749632514474475e-05 + 0.0001285581366604008i, -2.287251928811926e-06 + -1.2899126652861236e-05i, 0.01755189267197837 + 0.007127673889139539i, -0.00018643090769807124 + -0.006172854620064342i, -1.6813175608381528e-05 + 2.1986961748393282e-05i, 5.9270250224428285e-06 + -2.7986419951246068e-06i }, { -0.003582997145507618 + 0.0033594573519598585i, 0.12958243273905973 + 1.3213713977167085e-18i, -1.480178912744471e-05 + -5.784872371391766e-06i, 1.82391123998443e-05 + 0.00011917406560446172i, 0.0007801422350407663 + -0.006587905991555621i, 0.021268291973311884 + 0.004476303596626322i, 5.8541888263177395e-06 + -6.358366201493063e-06i, 1.3263233271857703e-05 + 1.8183236896051107e-05i }, { 2.4749632514474434e-05 + -0.0001285581366604008i, -1.48017891274447e-05 + 5.78487237139179e-06i, 0.13319388358788875 + 1.345088320239829e-18i, -0.00377377715103791 + -0.0034590864440836515i, 1.1726356161347498e-05 + -3.339917651505688e-07i, -8.476668211347247e-06 + -1.87159165626876e-06i, 0.01776226220540473 + 0.007457706843202528i, -0.00022615135250226518 + -0.006314150637105881i }, { -2.287251928811928e-06 + 1.2899126652861233e-05i, 1.8239112399844246e-05 + -0.00011917406560446173i, -0.003773777151037908 + 0.003459086444083652i, 0.1321473220410162 + -1.0503208545953324e-18i, -1.2396562107899538e-05 + -2.8657346264819257e-06i, 7.73359925598941e-06 + -3.180351474934129e-05i, 0.0007265614295125087 + -0.006794615295757811i, 0.021773690900805387 + 0.004405461817070685i }, { 0.01755189267197837 + -0.007127673889139539i, 0.0007801422350407659 + 0.0065879059915556195i, 1.1726356161347515e-05 + 3.3399176515057724e-07i, -1.2396562107899546e-05 + 2.8657346264819283e-06i, 0.1178012639495278 + -1.0977546996415732e-18i, -0.007046270140771286 + 0.0031952428050135177i, 1.678758522908156e-05 + 0.00011029310587949996i, -8.507696126095046e-06 + -1.2756710204703045e-05i }, { -0.00018643090769806994 + 0.006172854620064342i, 0.021268291973311888 + -0.004476303596626324i, -8.476668211347245e-06 + 1.871591656268765e-06i, 7.733599255989414e-06 + 3.180351474934128e-05i, -0.0070462701407712856 + -0.003195242805013517i, 0.11711195334831716 + -2.879912020664621e-20i, -6.736756093746382e-06 + -1.0755503331309162e-05i, 2.252434217656077e-05 + 0.00011374034085789596i }, { -1.681317560838151e-05 + -2.1986961748393295e-05i, 5.854188826317743e-06 + 6.358366201493079e-06i, 0.01776226220540473 + -0.007457706843202528i, 0.0007265614295125084 + 0.006794615295757811i, 1.6787585229081518e-05 + -0.00011029310587949993i, -6.736756093746371e-06 + 1.0755503331309184e-05i, 0.12013434828708099 + 7.674118502123961e-19i, -0.007270163071427656 + 0.0032381688000394345i }, { 5.927025022442824e-06 + 2.7986419951246076e-06i, 1.3263233271857693e-05 + -1.8183236896051107e-05i, -0.00022615135250226518 + 0.006314150637105883i, 0.021773690900805387 + -0.0044054618170706866i, -8.507696126095036e-06 + 1.2756710204703042e-05i, 2.2524342176560744e-05 + -0.00011374034085789598i, -0.007270163071427656 + -0.0032381688000394336i, 0.11951138391585449 + -1.0926725019580474e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, true, false, false, true, false, false}), ElementsAreArray({ DoubleNear(0.1305174121312535, 1.0e-7), DoubleNear(0.12958243273905973, 1.0e-7), DoubleNear(0.13319388358788875, 1.0e-7), DoubleNear(0.1321473220410162, 1.0e-7), DoubleNear(0.1178012639495278, 1.0e-7), DoubleNear(0.11711195334831716, 1.0e-7), DoubleNear(0.12013434828708099, 1.0e-7), DoubleNear(0.11951138391585449, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, true, false, false, false, true, false}), Matrix({ { 0.12217098028877629 + 4.0318768289304696e-19i, -0.008767125342869279 + 0.0014737262038937214i, 2.3740911695600118e-05 + 0.0001191098580685251i, -8.733815118752176e-06 + -1.6552937792312196e-05i, -0.0007210873149141579 + 0.0019092194927306494i, -0.0032530481662079685 + 0.006870033042093927i, -5.448709504352479e-06 + -5.760137849976586e-06i, -1.1994777475137993e-05 + 5.133552827605514e-06i }, { -0.008767125342869279 + -0.0014737262038937208i, 0.12124474497454192 + 8.317863542037229e-19i, -1.135501342843154e-05 + -1.3101707202324712e-05i, 2.0613858975783813e-05 + 0.00011396132893871512i, 0.0006706569694834598 + 0.0030674880664808696i, 0.0018324744069979997 + -0.00351821653663146i, -7.386101174181978e-06 + 4.075997880434315e-06i, 1.0176605771081828e-05 + 5.341088946338369e-06i }, { 2.374091169560009e-05 + -0.00011910985806852509i, -1.1355013428431526e-05 + 1.3101707202324735e-05i, 0.12479488802382274 + 1.1638232695274087e-18i, -0.009076453119373957 + 0.0014782842485593698i, -1.954159629097587e-06 + 4.763155414590576e-06i, 1.0212146142931246e-05 + 1.0766288275282467e-05i, -0.0008213834835766945 + 0.0019291273604604214i, -0.003339504230785189 + 0.007131986410651348i }, { -8.733815118752168e-06 + 1.655293779231219e-05i, 2.061385897578376e-05 + -0.00011396132893871515i, -0.009076453119373955 + -0.0014782842485593691i, 0.12379355821002892 + -6.988021814847978e-19i, 3.974485200717071e-06 + 5.817932944741218e-06i, 2.3485506848658435e-06 + -5.943231411051978e-06i, 0.0006608684211488996 + 0.0032091618455101587i, 0.0019671524047254916 + -0.0035311487102727378i }, { -0.0007210873149141605 + -0.001909219492730649i, 0.0006706569694834594 + -0.0030674880664808696i, -1.9541596290975992e-06 + -4.763155414590574e-06i, 3.974485200717069e-06 + -5.817932944741207e-06i, 0.12614769579200502 + -1.294266343404571e-18i, -0.0018621419434096272 + -0.001637940750840062i, 1.7796306047955916e-05 + 0.00011974138447137564i, -2.0611329361547966e-06 + -9.102899065252084e-06i }, { -0.003253048166207968 + -0.006870033042093925i, 0.0018324744069980001 + 0.0035182165366314582i, 1.0212146142931236e-05 + -1.076628827528245e-05i, 2.348550684865837e-06 + 5.943231411051975e-06i, -0.0018621419434096274 + 0.0016379407508400625i, 0.12544964111283496 + 4.607859233063394e-19i, -1.0183531792759553e-05 + -3.4386685003762168e-06i, 2.014959560062126e-05 + 0.00011895307752364255i }, { -5.448709504352478e-06 + 5.760137849976589e-06i, -7.386101174181985e-06 + -4.075997880434321e-06i, -0.0008213834835766941 + -0.0019291273604604207i, 0.0006608684211488994 + -0.0032091618455101596i, 1.7796306047955862e-05 + -0.00011974138447137563i, -1.0183531792759541e-05 + 3.438668500376238e-06i, 0.128533343851147 + 9.486769009248164e-19i, -0.0019674871030916094 + -0.0016992018926035865i }, { -1.1994777475137988e-05 + -5.13355282760553e-06i, 1.0176605771081817e-05 + -5.341088946338359e-06i, -0.003339504230785189 + -0.007131986410651348i, 0.0019671524047254925 + 0.0035311487102727386i, -2.0611329361547966e-06 + 9.102899065252089e-06i, 2.0149595600621218e-05 + -0.00011895307752364257i, -0.0019674871030916094 + 0.0016992018926035872i, 0.12786514774684177 + -4.607859233063394e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, true, false, false, false, true, false}), ElementsAreArray({ DoubleNear(0.12217098028877629, 1.0e-7), DoubleNear(0.12124474497454192, 1.0e-7), DoubleNear(0.12479488802382274, 1.0e-7), DoubleNear(0.12379355821002892, 1.0e-7), DoubleNear(0.12614769579200502, 1.0e-7), DoubleNear(0.12544964111283496, 1.0e-7), DoubleNear(0.128533343851147, 1.0e-7), DoubleNear(0.12786514774684177, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, true, false, false, false, false, true}), Matrix({ { 0.11271139743335082 + 5.573476792933296e-19i, -0.004843065417372642 + -6.124992712231239e-05i, 0.00018783277243217584 + 9.934328948927592e-05i, -1.6945930921175867e-05 + -9.96914829833897e-06i, 2.251428433966231e-05 + -7.354016226806389e-05i, -0.00012648204540107138 + 9.645714555787553e-05i, 0.0047382216701822326 + 0.004158569035376297i, -0.00021750276913959593 + -0.00023397311375368334i }, { -0.004843065417372641 + 6.124992712231271e-05i, 0.11202707749135336 + 2.053207864144424e-18i, -2.053221129107717e-05 + -4.216159035217916e-06i, 0.00018446866225112782 + 0.00010152968959984703i, -4.9100208066943545e-05 + 0.00014576259136500576i, -1.8859776658607263e-05 + 1.8689229641341055e-05i, -0.00024183695254705064 + -0.0001689082733774826i, 0.004663146599733735 + 0.004093033865294097i }, { 0.00018783277243217576 + -9.934328948927595e-05i, -2.0532211291077163e-05 + 4.216159035217947e-06i, 0.138267892199551 + 1.4518144715938708e-18i, -0.0060416420285055355 + -0.00010734687318660855i, 0.005463650767076313 + -0.005087335758138646i, -0.0002551467217302223 + 0.00037650897969655967i, 0.00018480615816568701 + 0.0002860735947363174i, -6.660650808078315e-05 + -0.0001579320947966536i }, { -1.694593092117587e-05 + 9.969148298338969e-06i, 0.00018446866225112777 + -0.00010152968959984708i, -0.006041642028505534 + 0.00010734687318660866i, 0.13741193733225357 + -1.6830544661942948e-18i, -0.00018250389844418565 + 0.0003166850770012527i, 0.005476888066250533 + -0.005090708078639415i, -0.00014140500191490817 + -9.956845150607373e-05i, 0.0001421243230977971 + 0.00019128987033864716i }, { 2.251428433966228e-05 + 7.354016226806363e-05i, -4.9100208066943545e-05 + -0.0001457625913650057i, 0.005463650767076313 + 0.005087335758138646i, -0.00018250389844418608 + -0.0003166850770012532i, 0.1356072786474305 + -1.4484263398048536e-18i, -0.005786201868906263 + -0.00010296461982402835i, -0.0001462955546886198 + 0.0001395079530506248i, 6.1509828662688935e-06 + -1.5686688559225308e-05i }, { -0.00012648204540107128 + -9.64571455578754e-05i, -1.8859776658607432e-05 + -1.868922964134144e-05i, -0.00025514672173022196 + -0.00037650897969655897i, 0.005476888066250533 + 0.005090708078639414i, -0.005786201868906264 + 0.000102964619824029i, 0.1346673085960235 + -7.606355866343617e-19i, -1.0063339301139205e-06 + -1.2324216667483013e-05i, -0.00014370520767472274 + 0.00013138471686251066i }, { 0.00473822167018223 + -0.0041585690353762965i, -0.00024183695254705062 + 0.00016890827337748295i, 0.00018480615816568701 + -0.0002860735947363178i, -0.00014140500191490827 + 9.956845150607388e-05i, -0.0001462955546886198 + -0.00013950795305062478i, -1.0063339301139057e-06 + 1.2324216667483027e-05i, 0.11506033967541873 + 6.606856988583543e-19i, -0.005002298193960031 + -0.00011357077085760833i }, { -0.00021750276913959607 + 0.00023397311375368307i, 0.004663146599733735 + -0.004093033865294099i, -6.66065080807831e-05 + 0.00015793209479665366i, 0.0001421243230977972 + -0.0001912898703386475i, 6.150982866268907e-06 + 1.5686688559225308e-05i, -0.0001437052076747228 + -0.00013138471686251064i, -0.005002298193960031 + 0.00011357077085760942i, 0.11424676862461713 + 5.234663614031576e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, true, false, false, false, false, true}), ElementsAreArray({ DoubleNear(0.11271139743335082, 1.0e-7), DoubleNear(0.11202707749135336, 1.0e-7), DoubleNear(0.138267892199551, 1.0e-7), DoubleNear(0.13741193733225357, 1.0e-7), DoubleNear(0.1356072786474305, 1.0e-7), DoubleNear(0.1346673085960235, 1.0e-7), DoubleNear(0.11506033967541873, 1.0e-7), DoubleNear(0.11424676862461713, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, true, true, false, false, false}), Matrix({ { 0.13309570891455313 + 9.605353621863766e-19i, -0.005679345889923601 + -0.00016858151914593143i, -0.017881961144868022 + -0.005242741337315121i, 0.0007512911299042024 + 0.0004591174615766374i, -0.0008343802123346844 + -0.006612266168676701i, 0.00016990419485250855 + 0.0003226525523988031i, -0.0015192081408710368 + -0.003208470487031072i, -0.00011576865939187068 + 0.00011256725494171351i }, { -0.005679345889923601 + 0.00016858151914593198i, 0.13225437222504052 + -1.4179331537036988e-18i, 0.0005611693903650205 + 0.00023912260379494658i, -0.017802615510828294 + -0.005169894804507177i, 3.4194523645202644e-05 + 0.00041932075759738233i, -0.0008130158571576179 + -0.006536129000893887i, 6.468937537420567e-05 + -3.927067281851832e-05i, -0.0015395005175928656 + -0.0032250648312850366i }, { -0.017881961144868022 + 0.00524274133731512i, 0.0005611693903650207 + -0.0002391226037949465i, 0.10945314870492312 + 7.691059161069047e-19i, -0.0047032709914210415 + -0.0001048879281782142i, 0.004276541863224682 + -0.00048795214076234193i, -0.00011633071591178547 + 0.00010868195602225774i, -0.004376356318411599 + 0.00887904962356362i, 0.0003391213241132039 + -0.000482031061338354i }, { 0.0007512911299042023 + -0.0004591174615766374i, -0.01780261551082829 + 0.005169894804507177i, -0.004703270991421041 + 0.0001048879281782148i, 0.10874327546145596 + 1.1824579943670033e-18i, -0.00026569697159958063 + 0.00010862142377428457i, 0.004245729763995679 + -0.00045383720669236517i, 0.00031946881753291674 + -0.00027242089269365706i, -0.004299342081772207 + 0.008823064385739387i }, { -0.0008343802123346821 + 0.006612266168676701i, 3.4194523645202366e-05 + -0.00041932075759738255i, 0.004276541863224683 + 0.0004879521407623418i, -0.00026569697159958063 + -0.00010862142377428434i, 0.1355752955591467 + -1.1519648082658485e-19i, -0.0059292746043326326 + -4.773139351810457e-05i, -0.01570425337600012 + 0.002316453383495003i, 0.0009023446963051646 + 0.0002608358202635737i }, { 0.00016990419485250836 + -0.000322652552398803i, -0.0008130158571576163 + 0.006536129000893887i, -0.00011633071591178552 + -0.00010868195602225778i, 0.004245729763995679 + 0.0004538372066923658i, -0.0059292746043326326 + 4.7731393518105005e-05i, 0.1346559645210505 + 2.270048298641525e-19i, 0.0003724211454162154 + 0.00017441041123772557i, -0.015611173595604658 + 0.0024064557187352857i }, { -0.0015192081408710372 + 0.0032084704870310714i, 6.46893753742059e-05 + 3.9270672818518396e-05i, -0.004376356318411595 + -0.00887904962356362i, 0.0003194688175329165 + 0.00027242089269365695i, -0.015704253376000125 + -0.002316453383495002i, 0.00037242114541621504 + -0.0001744104112377254i, 0.12352275477712805 + -3.9302328752599536e-19i, -0.005361316023067197 + -6.393135014830725e-05i }, { -0.00011576865939187073 + -0.00011256725494171346i, -0.0015395005175928656 + 0.003225064831285036i, 0.0003391213241132038 + 0.00048203106133835373i, -0.0042993420817722065 + -0.008823064385739383i, 0.000902344696305164 + -0.0002608358202635739i, -0.01561117359560466 + -0.002406455718735285i, -0.0053613160230671945 + 6.393135014830833e-05i, 0.12269947983670063 + 1.4145450219146816e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, true, true, false, false, false}), ElementsAreArray({ DoubleNear(0.13309570891455313, 1.0e-7), DoubleNear(0.13225437222504052, 1.0e-7), DoubleNear(0.10945314870492312, 1.0e-7), DoubleNear(0.10874327546145596, 1.0e-7), DoubleNear(0.1355752955591467, 1.0e-7), DoubleNear(0.1346559645210505, 1.0e-7), DoubleNear(0.12352275477712805, 1.0e-7), DoubleNear(0.12269947983670063, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, true, false, true, false, false}), Matrix({ { 0.1411957379863409 + 1.4772254600114998e-18i, -0.004121267636219396 + -0.0036701768189289835i, -0.01762435101425534 + -0.0014518081449764859i, 0.0006388945292943823 + 0.0008872509223554026i, 0.019242386031603935 + 0.008247270429065617i, -0.00038573661346819315 + -0.006599465546051027i, -0.0022184614487075404 + -0.0016068868547839967i, 5.254524581905395e-05 + 0.0008796910411151178i }, { -0.004121267636219396 + 0.0036701768189289835i, 0.14014641299472888 + 4.743384504624082e-20i, 0.00032510646188574295 + -0.00014341245169213589i, -0.017604898919923374 + -0.0014710073277579762i, 0.0007926439628197488 + -0.0073540785607542035i, 0.023390744406321946 + 0.005165465218410702i, -0.0004867717538008902 + 0.0008563486794093449i, -0.0025242563408925667 + -0.001360600948441872i }, { -0.017624351014255343 + 0.0014518081449764863i, 0.0003251064618857428 + 0.00014341245169213608i, 0.1225155577328013 + 7.453889935837843e-20i, -0.003235506660326133 + -0.003148366977114526i, -0.0029716705733088843 + -0.0007897177363013921i, 0.00017449284704730637 + 0.0007093190055232607i, 0.016071768845779162 + 0.00633811030327645i, -2.6845646732141966e-05 + -0.005887539711119196i }, { 0.000638894529294382 + -0.0008872509223554028i, -0.017604898919923374 + 0.0014710073277579762i, -0.0032355066603261306 + 0.003148366977114527i, 0.12158334178534706 + 2.236166980751353e-19i, 0.00035437730915300887 + 0.0009620022491847108i, -0.0035547928205875647 + -0.0001209876575997353i, 0.0007140597017335261 + -0.00602844272655923i, 0.019651238467795325 + 0.0037163001952863037i }, { 0.019242386031603935 + -0.008247270429065617i, 0.0007926439628197488 + 0.0073540785607542i, -0.002971670573308884 + 0.0007897177363013919i, 0.00035437730915300887 + -0.0009620022491847106i, 0.12747526648735896 + -6.318865786517081e-19i, -0.007487352858036837 + 0.0034538639062649474i, -0.015961863506612804 + -0.0014744798088436317i, 0.0010147412969149848 + -0.00016729764051519146i }, { -0.00038573661346819315 + 0.006599465546051029i, 0.023390744406321946 + -0.005165465218410705i, 0.00017449284704730604 + -0.0007093190055232605i, -0.0035547928205875642 + 0.00012098765759973532i, -0.007487352858036837 + -0.0034538639062649465i, 0.12676392375136214 + -1.238362168885787e-18i, 0.000608484073895493 + 0.0005569454667248081i, -0.01580889018650957 + -0.0012924317580139159i }, { -0.0022184614487075404 + 0.0016068868547839974i, -0.0004867717538008903 + -0.0008563486794093448i, 0.016071768845779162 + -0.00633811030327645i, 0.0007140597017335257 + 0.00602844272655923i, -0.015961863506612804 + 0.0014744798088436317i, 0.0006084840738954929 + -0.000556945466724808i, 0.11046034574924987 + 3.015437292225309e-19i, -0.006829080354162105 + 0.002979547698788005i }, { 5.2545245819053514e-05 + -0.0008796910411151178i, -0.0025242563408925667 + 0.0013606009484418724i, -2.6845646732141532e-05 + 0.005887539711119197i, 0.019651238467795325 + -0.003716300195286305i, 0.0010147412969149843 + 0.0001672976405151914i, -0.015808890186509578 + 0.0012924317580139163i, -0.006829080354162105 + -0.002979547698788004i, 0.10985941351280953 + 1.1002957984833361e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, true, false, true, false, false}), ElementsAreArray({ DoubleNear(0.1411957379863409, 1.0e-7), DoubleNear(0.14014641299472888, 1.0e-7), DoubleNear(0.1225155577328013, 1.0e-7), DoubleNear(0.12158334178534706, 1.0e-7), DoubleNear(0.12747526648735896, 1.0e-7), DoubleNear(0.12676392375136214, 1.0e-7), DoubleNear(0.11046034574924987, 1.0e-7), DoubleNear(0.10985941351280953, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, true, false, false, true, false}), Matrix({ { 0.13368132219957438 + 9.131015171401358e-19i, -0.00965582240639121 + 0.0016117796055160971i, -0.017091822037980153 + -0.002387713694142081i, 0.001414575295589142 + 0.0002935807863754925i, -0.00019137689777649165 + 0.002165159390967503i, -0.003577715033151994 + 0.007479208711192122i, 0.0002559132735234764 + -0.000550960525210053i, 0.000556439906801114 + -0.0010384137191277302i }, { -0.00965582240639121 + -0.0016117796055160967i, 0.1326228753249274 + -2.693564772268675e-19i, 0.0009098868298609083 + 0.000609405393967792i, -0.016921719532550665 + -0.0024429810278055464i, 0.0007587558463193129 + 0.003339154744507435i, 0.002714016357856051 + -0.0036290922642274017i, -0.00024521987971828745 + -0.00038794159168570525i, -0.0008919281193216957 + -0.00035378936037520057i }, { -0.017091822037980153 + 0.002387713694142081i, 0.0009098868298609082 + -0.0006094053939677919i, 0.11328454611302466 + 6.539094352803199e-19i, -0.008187756055852024 + 0.001340230846936994i, -0.0006331209079989928 + 0.00022963991716605582i, 0.00047544837224469455 + -0.000848772278449459i, -0.0013510939007143614 + 0.001673187462223568i, -0.003014837363841163 + 0.006522810741553153i }, { 0.0014145752955891417 + -0.0002935807863754926i, -0.016921719532550672 + 0.002442981027805547i, -0.008187756055852022 + -0.0013402308469369934i, 0.11241542785964347 + 4.0234064994579266e-19i, -4.53877231057129e-05 + -0.0004927460301022476i, -0.00010325459062447695 + 0.0009081653550422722i, 0.0005727695443130468 + 0.002937495167483593i, 0.0010856104538674407 + -0.0034202729826767965i }, { -0.00019137689777649295 + -0.002165159390967503i, 0.0007587558463193124 + -0.003339154744507435i, -0.0006331209079989927 + -0.00022963991716605511i, -4.538772310571281e-05 + 0.0004927460301022476i, 0.1349896822741255 + -6.776263578034403e-20i, -0.0019527980878650234 + -0.0018280925181801333i, -0.016494392482887994 + -0.0005385742596780362i, 0.00023906053062022515 + 0.00042637249546471857i }, { -0.0035777150331519933 + -0.007479208711192122i, 0.002714016357856052 + 0.003629092264227401i, 0.00047544837224469444 + 0.0008487722784494588i, -0.00010325459062447749 + -0.0009081653550422717i, -0.0019527980878650234 + 0.0018280925181801337i, 0.1342874614211636 + -9.215718466126788e-19i, 2.370370592032759e-05 + -0.0001958723789351198i, -0.01649206957388228 + -0.0003204580579663456i }, { 0.0002559132735234766 + 0.0005509605252100526i, -0.00024521987971828745 + 0.00038794159168570514i, -0.0013510939007143619 + -0.0016731874622235663i, 0.0005727695443130463 + -0.0029374951674835934i, -0.016494392482887997 + 0.0005385742596780367i, 2.3703705920327428e-05 + 0.00019587237893512003i, 0.11969135736902653 + -2.778268066994105e-19i, -0.0018768309586362148 + -0.0015090501252635156i }, { 0.0005564399068011138 + 0.0010384137191277302i, -0.0008919281193216959 + 0.00035378936037520025i, -0.0030148373638411623 + -0.006522810741553151i, 0.0010856104538674398 + 0.0034202729826767965i, 0.00023906053062022482 + -0.00042637249546471874i, -0.01649206957388228 + 0.0003204580579663457i, -0.0018768309586362133 + 0.0015090501252635164i, 0.11902732743851313 + 9.215718466126788e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, true, false, false, true, false}), ElementsAreArray({ DoubleNear(0.13368132219957438, 1.0e-7), DoubleNear(0.1326228753249274, 1.0e-7), DoubleNear(0.11328454611302466, 1.0e-7), DoubleNear(0.11241542785964347, 1.0e-7), DoubleNear(0.1349896822741255, 1.0e-7), DoubleNear(0.1342874614211636, 1.0e-7), DoubleNear(0.11969135736902653, 1.0e-7), DoubleNear(0.11902732743851313, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, true, false, false, false, true}), Matrix({ { 0.13464653389502373 + 2.117582368135751e-18i, -0.005835568374190265 + -9.529780610965932e-05i, -0.01672536352236271 + -0.0016013633192068107i, 0.0008302461766933558 + 0.0003583211580328428i, 0.00011765647597744847 + 9.75050755722996e-05i, -0.000101702944399476 + -3.3022879566754835e-05i, -3.404093853787748e-05 + -3.353697974604837e-05i, 2.6346399380520945e-05 + 1.2276807607140621e-05i }, { -0.005835568374190265 + 9.52978061096591e-05i, 0.1338178300722836 + -1.0316861297557378e-18i, 0.00046357968952954456 + 0.00021496418385743047i, -0.016653801850950785 + -0.0015203709492049725i, -0.00010248058622796573 + 2.059168019394614e-05i, 7.660326065492263e-05 + 9.288229267599929e-05i, 1.6507066934314346e-05 + -2.029137673084167e-05i, 8.834080349626851e-08 + -4.480369931242498e-05i }, { -0.01672536352236271 + 0.0016013633192068103i, 0.0004635796895295444 + -0.00021496418385743023i, 0.1163327557378781 + -1.0842021724855044e-19i, -0.005049139071687912 + -7.329899419926162e-05i, -2.7969552357934683e-05 + -3.603579683383247e-05i, 1.970411876559952e-05 + 2.0151198107605018e-05i, 8.966396652790087e-05 + 0.00011502835689595394i, -9.138560908237856e-05 + -2.8452069672023228e-05i }, { 0.0008302461766933555 + -0.0003583211580328429i, -0.016653801850950785 + 0.0015203709492049725i, -0.00504913907168791 + 7.329899419926227e-05i, 0.11562118475132335 + 1.401839527705867e-18i, 2.8748866318354605e-05 + -1.0881022339287934e-05i, 8.66129252391847e-06 + -2.498138686500349e-05i, -8.802462375388598e-05 + 2.5602459664985874e-05i, 4.666128578426721e-05 + 0.00011709680730398892i }, { 0.00011765647597744844 + -9.750507557229995e-05i, -0.00010248058622796578 + -2.0591680193946052e-05i, -2.7969552357934662e-05 + 3.6035796833832515e-05i, 2.8748866318354618e-05 + 1.0881022339287907e-05i, 0.13402447057867617 + -1.2722434867759591e-18i, -0.005773052120065968 + -0.0001210151065543769i, -0.016860850998505435 + -0.0013249246346133067i, 0.0008233896495160114 + 0.0003616321238073683i }, { -0.00010170294439947592 + 3.3022879566754944e-05i, 7.660326065492254e-05 + -9.288229267599959e-05i, 1.9704118765599497e-05 + -2.0151198107605025e-05i, 8.661292523918475e-06 + 2.4981386865003564e-05i, -0.005773052120065968 + 0.00012101510655437788i, 0.1330925066738074 + -1.5924219408380846e-19i, 0.00047001084625169137 + 0.00019856883117524174i, -0.016759987255482167 + -0.0012430681365669198i }, { -3.404093853787748e-05 + 3.353697974604842e-05i, 1.6507066934314377e-05 + 2.0291376730841658e-05i, 8.966396652790084e-05 + -0.00011502835689595418i, -8.802462375388605e-05 + -2.5602459664985786e-05i, -0.016860850998505438 + 0.0013249246346133075i, 0.0004700108462516913 + -0.00019856883117524168i, 0.11664314774417307 + 4.845028458294598e-19i, -0.005015447942800327 + -9.55202841272599e-05i }, { 2.634639938052093e-05 + -1.2276807607140643e-05i, 8.834080349627783e-08 + 4.480369931242505e-05i, -9.138560908237843e-05 + 2.8452069672023313e-05i, 4.6661285784267215e-05 + -0.00011709680730398936i, 0.000823389649516011 + -0.00036163212380736846i, -0.016759987255482167 + 0.00124306813656692i, -0.005015447942800325 + 9.552028412726076e-05i, 0.11582157054683323 + -7.792703114739563e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, true, false, false, false, true}), ElementsAreArray({ DoubleNear(0.13464653389502373, 1.0e-7), DoubleNear(0.1338178300722836, 1.0e-7), DoubleNear(0.1163327557378781, 1.0e-7), DoubleNear(0.11562118475132335, 1.0e-7), DoubleNear(0.13402447057867617, 1.0e-7), DoubleNear(0.1330925066738074, 1.0e-7), DoubleNear(0.11664314774417307, 1.0e-7), DoubleNear(0.11582157054683323, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, true, true, false, false}), Matrix({ { 0.12784880786481467 + 1.1519648082658485e-18i, -0.003307289143168155 + -0.0034356904242385717i, -0.0024054111848221486 + 0.001583547589820235i, 0.0010129535917617941 + 0.00034804795654793465i, 0.017105147308136892 + 0.006704251055283881i, 0.00015785377345694726 + -0.006150039545553177i, -0.0005460996564601926 + -0.0030502372480506103i, 0.0007762652012937868 + 0.0001901899791243657i }, { -0.003307289143168155 + 0.003435690424238572i, 0.12624053949164493 + -1.8295911660692887e-19i, 0.00072638646348193 + 0.0003369519400662339i, -0.002639611671501356 + 0.0009300441770685059i, 0.0007765684110879885 + -0.006176961279634982i, 0.020879667152867654 + 0.003957235484092997i, -0.0004931795346818858 + 0.0010732140271173698i, -0.0005713631324082595 + -0.0028873872190488623i }, { -0.002405411184822145 + -0.0015835475898202354i, 0.0007263864634819297 + -0.0003369519400662339i, 0.13586248785432758 + 3.9979955110402976e-19i, -0.0040494851533773735 + -0.003382853371804938i, -0.0027728412777400266 + -0.0005938874816636315i, 0.0004907128405504488 + -0.000542039276231841i, 0.01820900756924621 + 0.007881129677058184i, -0.0005704360336572828 + -0.006336965711617048i }, { 0.0010129535917617941 + -0.0003480479565479346i, -0.0026396116715013554 + -0.0009300441770685046i, -0.004049485153377372 + 0.0033828533718049387i, 0.135489215288431 + 4.54009659728305e-19i, 0.0005098383006070851 + 0.0009504836666598669i, -0.003032355283227277 + -0.0006822702930534047i, 0.0007301352534652864 + -0.007205560007678451i, 0.022162315721249617 + 0.004924529929604009i }, { 0.01710514730813689 + -0.006704251055283883i, 0.0007765684110879884 + 0.006176961279634979i, -0.002772841277740028 + 0.0005938874816636323i, 0.0005098383006070853 + -0.0009504836666598669i, 0.11470004975466158 + 5.776764700274328e-19i, -0.007075327738176486 + 0.003162220976914426i, -0.0028053253459241357 + 0.000683235865066685i, -0.0005039280727960818 + -0.0005074264654874855i }, { 0.0001578537734569477 + 0.006150039545553177i, 0.020879667152867654 + -0.003957235484092999i, 0.0004907128405504485 + 0.0005420392762318408i, -0.003032355283227277 + 0.0006822702930534052i, -0.007075327738176488 + -0.0031622209769144255i, 0.11475710819485155 + -5.251604272976662e-20i, -0.0003727231223038107 + -0.00019005207516250858i, -0.0024727462674284696 + 0.0013568912077769934i }, { -0.0005460996564601921 + 0.0030502372480506103i, -0.0004931795346818858 + -0.0010732140271173698i, 0.01820900756924621 + -0.007881129677058184i, 0.0007301352534652859 + 0.0072055600076784505i, -0.0028053253459241322 + -0.0006832358650666849i, -0.0003727231223038108 + 0.00019005207516250829i, 0.12323556248194721 + -9.0801931945661e-19i, -0.007241105474022456 + 0.003271190628138526i }, { 0.0007762652012937867 + -0.00019018997912436574i, -0.0005713631324082586 + 0.0028873872190488615i, -0.0005704360336572819 + 0.006336965711617048i, 0.022162315721249617 + -0.00492452992960401i, -0.000503928072796082 + 0.0005074264654874853i, -0.002472746267428468 + -0.001356891207776993i, -0.007241105474022454 + -0.0032711906281385253i, 0.1218662290693201 + -8.555032767268433e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, true, true, false, false}), ElementsAreArray({ DoubleNear(0.12784880786481467, 1.0e-7), DoubleNear(0.12624053949164493, 1.0e-7), DoubleNear(0.13586248785432758, 1.0e-7), DoubleNear(0.135489215288431, 1.0e-7), DoubleNear(0.11470004975466158, 1.0e-7), DoubleNear(0.11475710819485155, 1.0e-7), DoubleNear(0.12323556248194721, 1.0e-7), DoubleNear(0.1218662290693201, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, true, false, true, false}), Matrix({ { 0.11728368924129978 + 1.3637230450794235e-18i, -0.00838582677181186 + 0.0013292538935253339i, -0.008113333921620352 + -0.0016881918465230072i, 0.0009437966782081859 + 7.747856755206592e-05i, -0.0012364665609614696 + 0.0015258843816139916i, -0.0031464543067411354 + 0.006854156134871109i, -0.0023475650481070078 + -0.002503285429271933i, 0.00017838568725360565 + 9.545929868881951e-06i }, { -0.00838582677181186 + -0.0013292538935253332i, 0.11634614122136085 + 1.1689054672109345e-19i, 0.0004954387652603674 + 0.0006335325571496476i, -0.008039109123654279 + -0.001640471128959297i, 0.0006119887566286655 + 0.003191862451021334i, 0.0012873933511183932 + -0.0035486564648165974i, -0.00024341834679156315 + 1.881087131804074e-05i, -0.002615091868977167 + -0.0022119307369160425i }, { -0.008113333921620348 + 0.0016881918465230074i, 0.0004954387652603672 + -0.0006335325571496477i, 0.12968217907129925 + 2.0328790734103208e-19i, -0.009457751690431372 + 0.0016227565589277575i, -0.002779314425476912 + 0.001096165767466308i, 0.00015060377059202145 + -9.052492131549146e-05i, -0.0003060042375293828 + 0.0023124624715770794i, -0.003446098090252022 + 0.007147863317874166i }, { 0.0009437966782081857 + -7.747856755206607e-05i, -0.008039109123654279 + 0.0016404711289592978i, -0.009457751690431372 + -0.0016227565589277564i, 0.12869216196320998 + 1.6093625997831706e-20i, -5.197935689287331e-05 + 0.0001893054158014513i, -0.0030470973743136585 + 0.001604325904252472i, 0.0007195366340036942 + 0.003084787460969694i, 0.002512233460605098 + -0.003500708782087601i }, { -0.0012364665609614735 + -0.0015258843816139903i, 0.0006119887566286655 + -0.0031918624510213337i, -0.0027793144254769113 + -0.001096165767466308i, -5.197935689287315e-05 + -0.00018930541580145153i, 0.12526516837817647 + 3.6591823321385775e-19i, -0.0019967901095327817 + -0.0016027233408494796i, 0.0029025973908740673 + 0.003954975301409928i, -0.0004347711592424735 + -0.0002368570764916168i }, { -0.003146454306741135 + -0.0068541561348711075i, 0.0012873933511183939 + 0.0035486564648165974i, 0.00015060377059202112 + 9.05249213154915e-05i, -0.0030470973743136594 + -0.0016043259042524726i, -0.001996790109532782 + 0.00160272334084948i, 0.12465150646513562 + -3.5236570605778894e-19i, -0.00014177542408224807 + -0.00048663269224592234i, 0.002926751184724454 + 0.003927406513804796i }, { -0.002347565048107007 + 0.002503285429271934i, -0.0002434183467915633 + -1.881087131804047e-05i, -0.0003060042375293815 + -0.002312462471577079i, 0.0007195366340036934 + -0.0030847874609696946i, 0.00290259739087407 + -0.003954975301409928i, -0.00014177542408224829 + 0.000486632692245922i, 0.12941587126497556 + -7.115076756936123e-19i, -0.0018328389369684553 + -0.0017344193025941694i }, { 0.00017838568725360535 + -9.545929868882025e-06i, -0.0026150918689771675 + 0.0022119307369160434i, -0.003446098090252021 + -0.0071478633178741645i, 0.002512233460605098 + 0.0035007087820876i, -0.00043477115924247346 + 0.0002368570764916168i, 0.0029267511847244554 + -0.003927406513804795i, -0.001832838936968455 + 0.0017344193025941698i, 0.1286632823945411 + 3.5236570605778894e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, true, false, true, false}), ElementsAreArray({ DoubleNear(0.11728368924129978, 1.0e-7), DoubleNear(0.11634614122136085, 1.0e-7), DoubleNear(0.12968217907129925, 1.0e-7), DoubleNear(0.12869216196320998, 1.0e-7), DoubleNear(0.12526516837817647, 1.0e-7), DoubleNear(0.12465150646513562, 1.0e-7), DoubleNear(0.12941587126497556, 1.0e-7), DoubleNear(0.1286632823945411, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, true, false, false, true}), Matrix({ { 0.12129527500539211 + 1.8465318250143747e-18i, -0.005213208162551072 + -0.00012234735568657814i, -0.0026323082474620646 + 0.0010833286441698068i, 0.0002537243544997198 + -7.515861059477576e-05i, 8.647393002449512e-05 + 0.00011677106003837016i, -9.186660531880194e-05 + -2.6481137987374598e-05i, -6.620810467766002e-06 + 8.262759336430864e-06i, -8.576376604725049e-07 + 1.500386942336479e-06i }, { -0.005213208162551071 + 0.00012234735568657825i, 0.12057650210147666 + 7.013432803265607e-19i, 0.0001790486268340924 + 7.240645596089541e-05i, -0.0025814849059344644 + 0.0010950324713141879i, -8.817379280416334e-05 + 2.0007646036811558e-05i, 5.640771002666065e-05 + 0.00011761078841923213i, 4.901692854434022e-06 + 2.8407870643819175e-07i, -7.023605237885973e-06 + 1.3841043494347992e-05i }, { -0.002632308247462061 + -0.0010833286441698073i, 0.00017904862683409213 + -7.240645596089552e-05i, 0.12968401462750972 + 1.6263032587282567e-19i, -0.005671499283327105 + -4.624944462234279e-05i, 2.1311719244128952e-07 + 1.7327200674004125e-05i, 3.719770661855058e-06 + 7.046913586453783e-07i, 0.0001208465124808542 + 9.576237242988337e-05i, -0.0001012219481630526 + -3.4993811251403465e-05i }, { 0.00025372435449971977 + 7.515861059477575e-05i, -0.0025814849059344644 + -0.0010950324713141868i, -0.005671499283327103 + 4.6249444622343226e-05i, 0.12886251272213028 + -3.3118988237643143e-19i, 3.034634452447877e-06 + -4.534759110097243e-07i, 1.2385650316092214e-06 + 1.5427286020471372e-05i, -0.00010233141717768837 + 2.6186493822120456e-05i, 6.685683641252917e-05 + 9.236831156075607e-05i }, { 8.64739300244951e-05 + -0.00011677106003837044i, -8.817379280416342e-05 + -2.0007646036811466e-05i, 2.1311719244127703e-07 + -1.7327200674004112e-05i, 3.0346344524478756e-06 + 4.5347591100973193e-07i, 0.12125358261408413 + -1.1689054672109345e-19i, -0.00516940871879357 + -0.0001511220916375676i, -0.0025784282832842197 + 0.0011834548107171133i, 0.0002553011644659926 + -8.421989834477509e-05i }, { -9.186660531880186e-05 + 2.6481137987374696e-05i, 5.640771002666067e-05 + -0.00011761078841923236i, 3.7197706618550575e-06 + -7.046913586453762e-07i, 1.2385650316092536e-06 + -1.542728602047139e-05i, -0.005169408718793571 + 0.00015112209163756858i, 0.12042114558501982 + -9.368184396632562e-19i, 0.00017461471434402688 + 7.449340894282984e-05i, -0.0025308730329953602 + 0.0011919029135313117i }, { -6.620810467766014e-06 + -8.262759336430817e-06i, 4.901692854434037e-06 + -2.840787064381875e-07i, 0.0001208465124808542 + -9.576237242988368e-05i, -0.00010233141717768841 + -2.618649382212037e-05i, -0.002578428283284217 + -0.001183454810717113i, 0.00017461471434402677 + -7.449340894283017e-05i, 0.12941403570876508 + -6.708500942254059e-19i, -0.005619091344072724 + -6.541329904406908e-05i }, { -8.576376604725036e-07 + -1.5003869423364833e-06i, -7.023605237885981e-06 + -1.3841043494347965e-05i, -0.00010122194816305249 + 3.499381125140355e-05i, 6.685683641252909e-05 + -9.236831156075656e-05i, 0.00025530116446599246 + 8.421989834477497e-05i, -0.0025308730329953594 + -0.0011919029135313104i, -0.005619091344072723 + 6.541329904407006e-05i, 0.1284929316356208 + 6.996492144320521e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, true, false, false, true}), ElementsAreArray({ DoubleNear(0.12129527500539211, 1.0e-7), DoubleNear(0.12057650210147666, 1.0e-7), DoubleNear(0.12968401462750972, 1.0e-7), DoubleNear(0.12886251272213028, 1.0e-7), DoubleNear(0.12125358261408413, 1.0e-7), DoubleNear(0.12042114558501982, 1.0e-7), DoubleNear(0.12941403570876508, 1.0e-7), DoubleNear(0.1284929316356208, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, false, true, true, false}), Matrix({ { 0.11489977195480755 + 1.748276003132876e-18i, -0.015339548929820574 + -0.0004396568055557887i, 0.010272897705586825 + 0.016345732756706997i, -0.015819947504050195 + -0.001858975674926937i, -0.008499172068690428 + -0.0008695879911936621i, -0.00788352755147705 + 0.003653588174375193i, 0.01467363986520222 + -0.015410781109273842i, -0.004566516991969029 + 0.004408551043195605i }, { -0.015339548929820573 + 0.0004396568055557892i, 0.11951150419446341 + -7.453889935837843e-20i, -0.0022045820833628106 + -0.021363431981746214i, 0.013597042038451333 + 0.01165882402599468i, 0.002295817124308666 + -0.0007669345204881016i, -0.0022443029566285373 + -0.005824375085049221i, 0.0027717621987454434 + -0.0010476491427295841i, 0.017667469862831364 + -0.014336878828253288i }, { 0.010272897705586825 + -0.016345732756706997i, -0.0022045820833628115 + 0.021363431981746214i, 0.13206609635779146 + -1.8126505071242027e-19i, -0.0025040295324226594 + 0.00339166725800888i, 0.01692844332739702 + 0.024761737126067163i, 0.0024454263673863294 + 0.006237638269834447i, 0.006956701270199575 + 0.004707934844384733i, 0.0012909751544838929 + 0.010348431278370082i }, { -0.01581994750405019 + 0.0018589756749269378i, 0.013597042038451333 + -0.01165882402599468i, -0.0025040295324226594 + -0.003391667258008879i, 0.12552679899010744 + 2.0752307207730358e-19i, 0.0017421669270878347 + -0.0037737626357854815i, 0.01875111589626135 + 0.019623039879254227i, -0.0009642917336763067 + 0.007043584432479129i, 0.006043929768352029 + -0.0012249901618549765i }, { -0.00849917206869043 + 0.0008695879911936617i, 0.0022958171243086653 + 0.0007669345204881016i, 0.01692844332739702 + -0.024761737126067163i, 0.0017421669270878343 + 0.0037737626357854815i, 0.14881152376433468 + -1.9651164376299768e-19i, 0.007982774633275047 + -0.006378886990487722i, 0.025041257171796272 + -0.0017603520243649287i, 0.01540736524384986 + -0.010628029582243287i }, { -0.00788352755147705 + -0.0036535881743751924i, -0.0022443029566285378 + 0.005824375085049219i, 0.002445426367386331 + -0.006237638269834445i, 0.018751115896261345 + -0.01962303987925423i, 0.007982774633275045 + 0.006378886990487722i, 0.14221825058561252 + 3.4558944247975454e-19i, 0.0037112857479160858 + 0.007980910694432783i, 0.02944494083566594 + -0.002777058612297675i }, { 0.01467363986520222 + 0.015410781109273838i, 0.002771762198745443 + 0.0010476491427295854i, 0.006956701270199574 + -0.004707934844384731i, -0.0009642917336763067 + -0.00704358443247913i, 0.025041257171796272 + 0.0017603520243649287i, 0.0037112857479160858 + -0.007980910694432783i, 0.10586951587881734 + -1.4907779871675686e-19i, -0.011812403679776283 + 0.003041744347044072i }, { -0.004566516991969027 + -0.004408551043195605i, 0.017667469862831364 + 0.01433687882825329i, 0.0012909751544838929 + -0.010348431278370079i, 0.0060439297683520295 + 0.0012249901618549782i, 0.015407365243849858 + 0.010628029582243289i, 0.02944494083566594 + 0.0027770586122976724i, -0.011812403679776283 + -0.0030417443470440713i, 0.1110965382740642 + -3.4558944247975454e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, false, true, true, false}), ElementsAreArray({ DoubleNear(0.11489977195480755, 1.0e-7), DoubleNear(0.11951150419446341, 1.0e-7), DoubleNear(0.13206609635779146, 1.0e-7), DoubleNear(0.12552679899010744, 1.0e-7), DoubleNear(0.14881152376433468, 1.0e-7), DoubleNear(0.14221825058561252, 1.0e-7), DoubleNear(0.10586951587881734, 1.0e-7), DoubleNear(0.1110965382740642, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, false, true, false, true}), Matrix({ { 0.13193630693526576 + 9.181837148236616e-19i, -0.00370069516802346 + -0.0034025357774495808i, 0.017664239306602107 + 0.007309411873270895i, -0.00022148872301561671 + -0.006242902900742969i, 0.00019673753750954113 + 0.0001131242032185055i, -0.0001067719075080817 + -4.997973268720914e-05i, -0.00013667939607588803 + 0.00021158809598779724i, 4.156018720612865e-06 + -2.993605814871458e-05i }, { -0.00370069516802346 + 0.0034025357774495803i, 0.13099638980714598 + 1.4230153513872246e-19i, 0.0007347468616931262 + -0.006695362769567271i, 0.02154172484570916 + 0.0044337678854273295i, -0.00011073427994269298 + 4.475647503814037e-05i, -2.06821172221798e-05 + 0.00010763737692627584i, -4.8642399778228e-05 + -7.308355410779878e-05i, 0.00014227241120833597 + -0.00015928843371035634i }, { 0.017664239306602107 + -0.007309411873270895i, 0.0007347468616931256 + 0.006695362769567271i, 0.11904298269763607 + 1.0909784360635388e-18i, -0.007184012277854717 + 0.0032339389771406596i, -0.00011969867813323357 + -0.00018507990745221861i, -6.14651254097966e-05 + 7.279601652009207e-05i, 1.0582904995808187e-05 + 9.940922924974805e-05i, -8.631664597377285e-05 + -1.1495216551568931e-05i }, { -0.00022148872301561671 + 0.00624290290074297i, 0.02154172484570916 + -0.00443376788542733i, -0.007184012277854714 + -0.0032339389771406588i, 0.11844262501646094 + 2.278518628114068e-19i, -7.1037939249723846e-06 + 3.0146028329260303e-05i, 0.00014517425067375316 + 0.00019881598107516102i, -7.977093003915871e-05 + 1.437664820791646e-06i, 0.00014394666366136961 + 0.00010234172305371236i }, { 0.0001967375375095411 + -0.00011312420321850575i, -0.00011073427994269302 + -4.475647503814028e-05i, -0.00011969867813323368 + 0.0001850799074522185i, -7.103793924972428e-06 + -3.014602832926021e-05i, 0.1317749887838765 + 6.335806445462167e-19i, -0.0036560791285220676 + -0.0034160080185939292i, 0.01764991557078099 + 0.007275968859071173i, -0.00019109353718471927 + -0.006244102356427255i }, { -0.00010677190750808159 + 4.99797326872092e-05i, -2.0682117222179815e-05 + -0.00010763737692627624i, -6.146512540979656e-05 + -7.279601652009212e-05i, 0.00014517425067375316 + -0.00019881598107516108i, -0.0036560791285220667 + 0.00341600801859393i, 0.13073336497292995 + 1.2874900798265365e-19i, 0.0007719568028601489 + -0.0066871585177461605i, 0.02150025802840811 + 0.004447997528269677i }, { -0.00013667939607588795 + -0.00021158809598779735i, -4.8642399778228045e-05 + 7.308355410779873e-05i, 1.0582904995808163e-05 + -9.940922924974837e-05i, -7.97709300391588e-05 + -1.4376648207915511e-06i, 0.01764991557078099 + -0.007275968859071174i, 0.0007719568028601487 + 0.0066871585177461605i, 0.11889262953897273 + -1.421321285492716e-18i, -0.007132420934344226 + 0.0031994726279122926i }, { 4.156018720612888e-06 + 2.993605814871467e-05i, 0.0001422724112083359 + 0.0001592884337103563i, -8.631664597377276e-05 + 1.1495216551569053e-05i, 0.00014394666366136956 + -0.0001023417230537127i, -0.0001910935371847184 + 0.006244102356427256i, 0.02150025802840811 + -0.004447997528269678i, -0.007132420934344227 + -0.0031994726279122917i, 0.11818071224771069 + -3.6591823321385775e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, false, true, false, true}), ElementsAreArray({ DoubleNear(0.13193630693526576, 1.0e-7), DoubleNear(0.13099638980714598, 1.0e-7), DoubleNear(0.11904298269763607, 1.0e-7), DoubleNear(0.11844262501646094, 1.0e-7), DoubleNear(0.1317749887838765, 1.0e-7), DoubleNear(0.13073336497292995, 1.0e-7), DoubleNear(0.11889262953897273, 1.0e-7), DoubleNear(0.11818071224771069, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, false, false, true, true}), Matrix({ { 0.12356763267843456 + 1.3383120566617945e-18i, -0.008950060113078978 + 0.0014879280331193756i, -0.0007706140490819019 + 0.0019027050694478353i, -0.003314181815309955 + 0.00703725579460558i, 0.00012784478339547106 + 0.0001033343481953429i, -0.00012075619632772611 + -3.2098994345544776e-05i, -0.00011696558693825238 + -3.1574890053903944e-05i, -2.06168469422965e-05 + 0.00013830772542676984i }, { -0.008950060113078978 + -0.0014879280331193754i, 0.12264698788660086 + 5.666650417131269e-19i, 0.0006597128874587455 + 0.0031695432854085557i, 0.001900340946974552 + -0.0035082014412571847i, -0.0001172606479769663 + 1.7626017339899323e-05i, 4.1311562693291875e-05 + 0.00010133015214420517i, -2.170143694310474e-05 + 9.717188299163937e-05i, 0.00011253902625165169 + 3.9389368508441554e-05i }, { -0.0007706140490819054 + -0.0019027050694478335i, 0.0006597128874587447 + -0.003169543285408556i, 0.12741165695446727 + 6.708500942254059e-19i, -0.001934647332799199 + -0.001656524833428297i, -0.00011567002375658448 + 2.6643275335907393e-05i, -1.3585889173926269e-05 + -9.59266715155401e-05i, 7.947565910987827e-05 + 0.00010919908427291063i, -7.233235715412844e-05 + -2.937595489323329e-05i }, { -0.0033141818153099543 + -0.007037255794605578i, 0.001900340946974552 + 0.0035082014412571847i, -0.0019346473327991973 + 0.0016565248334282968i, 0.12679202693700606 + -1.9651164376299768e-19i, -5.0768610122443276e-06 + -0.00014562780491163418i, 0.00010997993606228556 + -3.4386770051583065e-05i, -7.32445620048854e-05 + 2.8568122519032695e-05i, 8.195298374589795e-05 + 0.00010864894783578304i }, { 0.00012784478339547106 + -0.00010333434819534319i, -0.00011726064797696635 + -1.762601733989924e-05i, -0.00011567002375658449 + -2.6643275335907413e-05i, -5.076861012244351e-06 + 0.00014562780491163415i, 0.12339823563416445 + 2.286988957586611e-19i, -0.008893518349164256 + 0.0014640824193337156i, -0.0007718567494089498 + 0.0019356417837432358i, -0.003278370581683202 + 0.006964763658139694i }, { -0.00012075619632772602 + 3.209899434554489e-05i, 4.131156269329185e-05 + -0.0001013301521442055i, -1.3585889173926235e-05 + 9.592667151554018e-05i, 0.00010997993606228552 + 3.438677005158309e-05i, -0.008893518349164254 + -0.0014640824193337145i, 0.12239131529796998 + -4.336808689942018e-19i, 0.0006718125031736142 + 0.003107106626582472i, 0.0018992858647489392 + -0.0035411638056470135i }, { -0.00011696558693825236 + 3.1574890053903856e-05i, -2.1701436943104753e-05 + -9.717188299163931e-05i, 7.947565910987823e-05 + -0.00010919908427291094i, -7.324456200488548e-05 + -2.8568122519032593e-05i, -0.0007718567494089498 + -0.0019356417837432356i, 0.000671812503173614 + -0.0031071066265824726i, 0.12726938268868476 + -1.0164395367051604e-18i, -0.0018949817137020371 + -0.0016806178100153522i }, { -2.0616846942296488e-05 + -0.00013830772542676987i, 0.00011253902625165173 + -3.938936850844159e-05i, -7.233235715412833e-05 + 2.9375954893233362e-05i, 8.195298374589791e-05 + -0.00010864894783578342i, -0.0032783705816832012 + -0.006964763658139694i, 0.0018992858647489401 + 0.0035411638056470126i, -0.0018949817137020389 + 0.001680617810015353i, 0.12652276192267065 + 1.9651164376299768e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, false, false, true, true}), ElementsAreArray({ DoubleNear(0.12356763267843456, 1.0e-7), DoubleNear(0.12264698788660086, 1.0e-7), DoubleNear(0.12741165695446727, 1.0e-7), DoubleNear(0.12679202693700606, 1.0e-7), DoubleNear(0.12339823563416445, 1.0e-7), DoubleNear(0.12239131529796998, 1.0e-7), DoubleNear(0.12726938268868476, 1.0e-7), DoubleNear(0.12652276192267065, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, true, true, false, false, false, false}), Matrix({ { 0.1402937575820496 + -5.929230630780102e-19i, -0.005060468628986103 + -0.007765707220927998i, 3.8231883485594884e-05 + 0.00020486641668780736i, 1.3304410399817813e-05 + -1.8100935456694656e-05i, -0.016739718671318557 + -0.005322565765156741i, 0.0011080922411080764 + 0.0012391517878750158i, 1.2617233826087385e-05 + -1.4933078611531134e-05i, 9.469829484276374e-06 + -3.887281031418572e-06i }, { -0.005060468628986102 + 0.007765707220927998i, 0.11990742376099384 + 6.132518538121134e-19i, -2.1822565377087858e-05 + -4.837887383754827e-06i, 8.754026382105923e-06 + 0.00011732536271490049i, 0.002231868043131753 + -0.00128186650604698i, -0.017893587625841208 + 0.0056559674047429575i, -4.292761444602789e-06 + -1.9421633164987518e-06i, 1.1909256997439859e-05 + -2.828699214644013e-06i }, { 3.8231883485594775e-05 + -0.0002048664166878074i, -2.1822565377087854e-05 + 4.837887383754861e-06i, 0.14930803933069475 + 5.861467994999758e-19i, -0.005692950541923877 + -0.008451641630454771i, -2.9727690499871313e-05 + 2.0867803255670205e-05i, -2.643137644876257e-06 + 1.0177091771826191e-05i, -0.01565790618874665 + -0.008588784395451458i, 0.0008642324674020169 + 0.0010366368697311075i }, { 1.3304410399817832e-05 + 1.810093545669465e-05i, 8.754026382105896e-06 + -0.00011732536271490048i, -0.005692950541923876 + 0.00845164163045477i, 0.12607212054605266 + -9.520650327138336e-19i, 1.2232859000801297e-05 + -4.928394239763416e-06i, -3.3359199762103205e-05 + -3.178396035931805e-05i, 0.0022371960104114507 + -0.0009959458578091274i, -0.016708791141394685 + 0.0025656557162732343i }, { -0.016739718671318557 + 0.005322565765156741i, 0.002231868043131754 + 0.0012818665060469804i, -2.972769049987132e-05 + -2.08678032556702e-05i, 1.2232859000801304e-05 + 4.92839423976342e-06i, 0.1275043525576081 + 9.58841296291868e-19i, -0.004426171852588388 + -0.006255749850805263i, 2.8811251044656735e-05 + 7.076095840723825e-05i, -7.621693820734398e-06 + -6.351290086500074e-06i }, { 0.001108092241108076 + -0.001239151787875016i, -0.017893587625841208 + -0.005655967404742956i, -2.643137644876253e-06 + -1.0177091771826196e-05i, -3.33591997621032e-05 + 3.178396035931805e-05i, -0.004426171852588388 + 0.006255749850805263i, 0.10730752826750664 + -5.776764700274328e-19i, -5.89324074692639e-06 + 3.341631981848866e-06i, 6.5035114076035635e-06 + 7.881291119231228e-05i }, { 1.2617233826087393e-05 + 1.4933078611531133e-05i, -4.292761444602785e-06 + 1.94216331649875e-06i, -0.01565790618874665 + 0.008588784395451458i, 0.0022371960104114507 + 0.0009959458578091276i, 2.88112510446567e-05 + -7.076095840723826e-05i, -5.8932407469263965e-06 + -3.3416319818488555e-06i, 0.12402964856177526 + 1.0028870095490916e-18i, -0.003998144744124231 + -0.005941764571365584i }, { 9.469829484276374e-06 + 3.887281031418577e-06i, 1.1909256997439864e-05 + 2.8286992146440106e-06i, 0.0008642324674020165 + -0.0010366368697311075i, -0.016708791141394685 + -0.002565655716273233i, -7.621693820734397e-06 + 6.351290086500065e-06i, 6.5035114076035635e-06 + -7.88129111923123e-05i, -0.003998144744124231 + 0.005941764571365584i, 0.10557712939331776 + 3.1594328932585403e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, true, true, false, false, false, false}), ElementsAreArray({ DoubleNear(0.1402937575820496, 1.0e-7), DoubleNear(0.11990742376099384, 1.0e-7), DoubleNear(0.14930803933069475, 1.0e-7), DoubleNear(0.12607212054605266, 1.0e-7), DoubleNear(0.1275043525576081, 1.0e-7), DoubleNear(0.10730752826750664, 1.0e-7), DoubleNear(0.12402964856177526, 1.0e-7), DoubleNear(0.10557712939331776, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, true, false, true, false, false, false}), Matrix({ { 0.12925976286302238 + 5.454892180317694e-19i, -0.00493515263464195 + -0.007425534260929821i, 2.5942911484736338e-05 + 0.00011038754829552025i, -4.476695292511009e-06 + -1.215356650983961e-05i, -0.004318199993597919 + 0.0007989763305212843i, 0.00017749428050934299 + 0.00020676150184984797i, 1.8602223168759842e-06 + -3.504454896625968e-05i, -1.1311224409512937e-05 + 4.173149683785351e-09i }, { -0.00493515263464195 + 0.007425534260929822i, 0.11126690835254574 + -6.776263578034403e-20i, -1.208617296457353e-05 + 8.646015860371286e-07i, 2.0598326811667092e-05 + 0.00010388368366163867i, -7.647337614552125e-05 + -0.00017962873445155408i, -0.00015466889906029925 + 0.00268745884350554i, 5.370600646809031e-06 + 2.1443545634363225e-06i, 1.8128318789151178e-05 + -8.084453574293896e-06i }, { 2.5942911484736283e-05 + -0.00011038754829552026i, -1.2086172964573524e-05 + -8.646015860371108e-07i, 0.12980117149234238 + -3.5575383784680614e-19i, -0.004763321682160766 + -0.007456044086948497i, -2.0780813748589553e-05 + 4.04231007812151e-05i, 4.591194184025789e-06 + -1.2593475460580165e-06i, -0.006106310946161408 + -0.000581030853873816i, 0.00042070924860100937 + 0.000330721724536218i }, { -4.4766952925109905e-06 + 1.2153566509839609e-05i, 2.0598326811667092e-05 + -0.00010388368366163867i, -0.004763321682160766 + 0.007456044086948499i, 0.11321866259806224 + 1.3721933745519665e-18i, -8.980841001896735e-06 + -2.846032089855683e-06i, 1.2450565316769688e-05 + -7.623114143269045e-06i, 0.00020110130488237913 + -0.0003502316183229966i, 0.0002560853691435175 + 0.00164831451957941i }, { -0.004318199993597916 + -0.0007989763305212834i, -7.647337614552147e-05 + 0.00017962873445155468i, -2.0780813748589563e-05 + -4.0423100781215095e-05i, -8.980841001896736e-06 + 2.846032089855688e-06i, 0.13853834727663533 + -1.7957098481791167e-19i, -0.004551487846932541 + -0.006595922810803439i, 4.1100223045515295e-05 + 0.00016523982679952535i, 1.0159411871594427e-05 + -1.229865903335512e-05i }, { 0.0001774942805093428 + -0.00020676150184984778i, -0.00015466889906029838 + -0.002687458843505539i, 4.591194184025791e-06 + 1.2593475460580125e-06i, 1.2450565316769695e-05 + 7.623114143269032e-06i, -0.004551487846932541 + 0.006595922810803439i, 0.11594804367595475 + 1.0333801956502464e-19i, -1.562963315944072e-05 + -2.3608569879430904e-06i, -5.340789021957592e-06 + 9.22545902455741e-05i }, { 1.8602223168760045e-06 + 3.504454896625968e-05i, 5.370600646809032e-06 + -2.144354563436323e-06i, -0.006106310946161405 + 0.000581030853873815i, 0.00020110130488237886 + 0.0003502316183229969i, 4.110022304551521e-05 + -0.0001652398267995254i, -1.5629633159440726e-05 + 2.3608569879431166e-06i, 0.1435365164001276 + 1.9447876468958736e-18i, -0.004927773603887341 + -0.006937362114871856i }, { -1.1311224409512939e-05 + -4.173149683780269e-09i, 1.812831878915117e-05 + 8.0844535742939e-06i, 0.00042070924860100937 + -0.0003307217245362179i, 0.0002560853691435188 + -0.00164831451957941i, 1.0159411871594426e-05 + 1.2298659033355101e-05i, -5.340789021957633e-06 + -9.22545902455741e-05i, -0.004927773603887341 + 0.006937362114871856i, 0.11843058734130821 + -2.008315117939946e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, true, false, true, false, false, false}), ElementsAreArray({ DoubleNear(0.12925976286302238, 1.0e-7), DoubleNear(0.11126690835254574, 1.0e-7), DoubleNear(0.12980117149234238, 1.0e-7), DoubleNear(0.11321866259806224, 1.0e-7), DoubleNear(0.13853834727663533, 1.0e-7), DoubleNear(0.11594804367595475, 1.0e-7), DoubleNear(0.1435365164001276, 1.0e-7), DoubleNear(0.11843058734130821, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, true, false, false, true, false, false}), Matrix({ { 0.14016860334343348 + 9.9272261418204e-19i, -0.004965946884614122 + -0.007694349459516519i, 3.288962482963739e-05 + 0.00014232636012117807i, 3.4896750712352347e-06 + -1.4192493216217063e-05i, 0.02103316239158488 + 0.007619426354822105i, -0.0007867389590107703 + -0.00143862354445491i, 1.1960250883530582e-05 + 1.640191775753213e-05i, 2.267802927483344e-06 + -5.002460652512813e-06i }, { -0.00496594688461412 + 0.007694349459516521i, 0.11993124152687973 + 5.353248226647178e-19i, -1.598123929366913e-05 + -1.9230238963995754e-06i, 1.0099120084681402e-05 + 0.00010540584214368442i, -0.0015914039558062054 + 0.0005045766795067079i, 0.01778702225370537 + 0.003984551130943755i, 3.3765118431006056e-07 + -4.984260023500807e-07i, -1.5510193220054403e-05 + 2.376828088691226e-05i }, { 3.288962482963732e-05 + -0.00014232636012117807i, -1.598123929366913e-05 + 1.923023896399601e-06i, 0.14302467897971158 + 1.3891340334970526e-19i, -0.0050725876651732775 + -0.007872675256581843i, 7.654584671929552e-06 + -3.135544215302852e-05i, -5.456043354104132e-06 + -2.3474041512721687e-06i, 0.02153541620413265 + 0.0076005575081536225i, -0.0008525213718800567 + -0.0015600551408174413i }, { 3.4896750712352474e-06 + 1.4192493216217053e-05i, 1.0099120084681374e-05 + -0.00010540584214368442i, -0.0050725876651732775 + 0.007872675256581843i, 0.12231652664919335 + 1.5585406229479126e-19i, 7.582761088638577e-07 + -9.608875080382567e-09i, 1.180537074540735e-05 + -7.820643614633316e-07i, -0.0015506886330891988 + 0.0004631178989457887i, 0.018000536902077466 + 0.004262611152119591i }, { 0.02103316239158488 + -0.007619426354822106i, -0.0015914039558062054 + -0.0005045766795067079i, 7.654584671929562e-06 + 3.135544215302852e-05i, 7.582761088638535e-07 + 9.608875080382143e-09i, 0.1276295067962242 + -6.2680438096818225e-19i, -0.004520693596960369 + -0.006327107612216741i, 3.4153509700614245e-05 + 0.00013330101497386755i, 2.1930415078481823e-06 + -1.0259732326977667e-05i }, { -0.0007867389590107705 + 0.00143862354445491i, 0.017787022253705372 + -0.003984551130943756i, -5.4560433541041294e-06 + 2.347404151272168e-06i, 1.1805370745407364e-05 + 7.820643614633485e-07i, -0.004520693596960369 + 0.006327107612216741i, 0.10728371050162075 + -4.997494388800372e-19i, -1.1734566830345117e-05 + 4.2676849449361453e-07i, 5.158417705028112e-06 + 9.073243176352836e-05i }, { 1.1960250883530578e-05 + -1.640191775753212e-05i, 3.376511843100629e-07 + 4.984260023500925e-07i, 0.02153541620413265 + -0.007600557508153623i, -0.0015506886330891993 + -0.0004631178989457886i, 3.415350970061415e-05 + -0.00013330101497386758i, -1.1734566830345117e-05 + -4.2676849449359335e-07i, 0.1303130089127584 + 1.4501204056993622e-18i, -0.00461850762087483 + -0.0065207309452385105i }, { 2.2678029274833406e-06 + 5.0024606525128056e-06i, -1.5510193220054393e-05 + -2.3768280886912278e-05i, -0.0008525213718800567 + 0.001560055140817441i, 0.018000536902077466 + -0.0042626111521195924i, 2.193041507848189e-06 + 1.0259732326977659e-05i, 5.158417705028085e-06 + -9.073243176352836e-05i, -0.00461850762087483 + 0.006520730945238511i, 0.10933272329017708 + -7.919758056827708e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, true, false, false, true, false, false}), ElementsAreArray({ DoubleNear(0.14016860334343348, 1.0e-7), DoubleNear(0.11993124152687973, 1.0e-7), DoubleNear(0.14302467897971158, 1.0e-7), DoubleNear(0.12231652664919335, 1.0e-7), DoubleNear(0.1276295067962242, 1.0e-7), DoubleNear(0.10728371050162075, 1.0e-7), DoubleNear(0.1303130089127584, 1.0e-7), DoubleNear(0.10933272329017708, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, true, false, false, false, true, false}), Matrix({ { 0.13303017021229283 + 5.082197683525802e-19i, -0.004993164940371201 + -0.006888099606710091i, 3.329271112029586e-05 + 0.00013431727272212083i, 2.6578415290309764e-06 + -1.3341483500970899e-05i, 0.0012674007508351615 + -0.0019158014451357728i, -0.0004647189258661729 + 0.001538164074565652i, -4.095324885708372e-06 + 1.2155030182714395e-05i, 6.06738591284545e-08 + 3.0087848726033285e-06i }, { -0.004993164940371201 + 0.006888099606710091i, 0.11038555505102537 + 7.267542687441897e-19i, -1.520287796018544e-05 + -1.937892843816799e-06i, 1.1062059551088097e-05 + 9.875391428511941e-05i, -0.00044912884028317353 + 0.0011947800898398416i, -0.00015601365875131997 + 0.0003068044012349625i, -4.485201350345913e-06 + -1.5750353920969995e-07i, 8.82322115243772e-06 + -1.2574079086352617e-05i }, { 3.3292711120295766e-05 + -0.00013431727272212083i, -1.5202877960185443e-05 + 1.9378928438168245e-06i, 0.1360087361471507 + 4.912791094074942e-19i, -0.005169853974334485 + -0.007075294340661693i, 1.1850867503867213e-05 + 7.879931863206534e-06i, 3.7253599290519453e-06 + -5.661265912758854e-07i, 0.0014039757386428227 + -0.0017051512273458832i, -0.0004108701911914734 + 0.001606852174722574i }, { 2.6578415290309857e-06 + 1.3341483500970889e-05i, 1.1062059551088084e-05 + -9.875391428511941e-05i, -0.005169853974334484 + 0.0070752943406616935i, 0.11257971008670095 + -2.625802136488331e-20i, 3.904621403540388e-07 + 4.39937908105694e-06i, -1.1456476448098954e-05 + -9.060007859667935e-06i, -0.0005597336291040665 + 0.0012936745063223355i, -0.00025820681749402536 + 0.0001031298775335663i }, { 0.0012674007508351604 + 0.0019158014451357722i, -0.0004491288402831735 + -0.0011947800898398423i, 1.1850867503867195e-05 + -7.879931863206523e-06i, 3.904621403540405e-07 + -4.399379081056948e-06i, 0.13476793992736485 + -1.4230153513872246e-19i, -0.004493475541203291 + -0.007133357465023169i, 3.375042340995577e-05 + 0.0001413101023729248i, 3.02487505005244e-06 + -1.1110742042223834e-05i }, { -0.0004647189258661731 + -0.0015381640745656517i, -0.00015601365875132084 + -0.0003068044012349623i, 3.72535992905194e-06 + 5.661265912758964e-07i, -1.1456476448098956e-05 + 9.060007859667923e-06i, -0.004493475541203291 + 0.007133357465023171i, 0.11682939697747509 + -6.911788849595091e-19i, -1.251292816382881e-05 + 4.4163744191083815e-07i, 4.19547823862143e-06 + 9.738435962209336e-05i }, { -4.095324885708379e-06 + -1.2155030182714389e-05i, -4.4852013503459205e-06 + 1.5750353920969317e-07i, 0.0014039757386428234 + 0.001705151227345885i, -0.0005597336291040663 + -0.0012936745063223355i, 3.375042340995569e-05 + -0.00014131010237292485i, -1.2512928163828806e-05 + -4.416374419108178e-07i, 0.13732895174531928 + 1.0977546996415732e-18i, -0.004521241311713624 + -0.00731811186115866i }, { 6.067385912845196e-08 + -3.008784872603324e-06i, 8.823221152437719e-06 + 1.257407908635262e-05i, -0.00041087019119147327 + -0.0016068521747225738i, -0.00025820681749402536 + -0.00010312987753356674i, 3.0248750500524516e-06 + 1.1110742042223822e-05i, 4.195478238621389e-06 + -9.738435962209336e-05i, -0.004521241311713623 + 0.00731811186115866i, 0.11906953985266949 + -6.098637220230962e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, true, false, false, false, true, false}), ElementsAreArray({ DoubleNear(0.13303017021229283, 1.0e-7), DoubleNear(0.11038555505102537, 1.0e-7), DoubleNear(0.1360087361471507, 1.0e-7), DoubleNear(0.11257971008670095, 1.0e-7), DoubleNear(0.13476793992736485, 1.0e-7), DoubleNear(0.11682939697747509, 1.0e-7), DoubleNear(0.13732895174531928, 1.0e-7), DoubleNear(0.11906953985266949, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, true, false, false, false, false, true}), Matrix({ { 0.12156407999639143 + 1.819426770702237e-18i, -0.00426043269542742 + -0.00629006322498377i, 0.0002131493038460202 + 0.00011826377728827174i, -8.204331780341519e-06 + -2.7285592501945877e-05i, 7.311708982308639e-05 + -0.00016654792453503145i, -7.855174372417515e-05 + -2.107397244972607e-05i, 0.005205832291885759 + 0.004436762516104884i, 9.535952892717243e-06 + -0.0004279490781978788i }, { -0.00426043269542742 + 0.00629006322498377i, 0.10317439492831276 + 7.911287727355165e-19i, -1.7578201667769395e-05 + 1.3180101459873488e-05i, 0.00015915213083728347 + 8.260920180085122e-05i, 9.196378267369449e-05 + 1.9929795720045605e-05i, -6.946258214203134e-05 + 0.00011169699190830856i, -0.00045378689714282706 + 0.00019347854120355617i, 0.004195535978030207 + 0.0038148403845655104i }, { 0.0002131493038460201 + -0.00011826377728827177i, -1.7578201667769395e-05 + -1.3180101459873458e-05i, 0.14917391724976847 + 5.116079001415974e-19i, -0.0053301989616218745 + -0.007912737778808607i, 0.005776198907973801 + -0.005645219609460583i, -0.0005133186548142369 + -1.7200634454949526e-05i, 0.00026989000386075065 + 0.00038462565755702715i, 9.088760433336915e-05 + -4.360346855240152e-05i }, { -8.204331780341519e-06 + 2.7285592501945883e-05i, 0.00015915213083728344 + -8.260920180085124e-05i, -0.005330198961621874 + 0.007912737778808607i, 0.1265059122820361 + -7.428478947420214e-19i, 0.00020574963062617777 + 0.0005044349995209296i, 0.005164339925353045 + -0.004532824227317476i, -0.00010889335289395336 + 2.9717901730526247e-05i, 5.704047740273346e-05 + 9.273780751793741e-05i }, { 7.311708982308616e-05 + 0.000166547924535031i, 9.196378267369437e-05 + -1.9929795720045646e-05i, 0.005776198907973799 + 0.005645219609460584i, 0.00020574963062617766 + -0.00050443499952093i, 0.14623403014326627 + -1.4535085374883794e-18i, -0.005226207786147071 + -0.00773139384674949i, -0.00014610616931576856 + 0.0001573635978067739i, 1.3887048359424935e-05 + 2.8333669587511425e-06i }, { -7.855174372417513e-05 + 2.1073972449726226e-05i, -6.94625821420313e-05 + -0.00011169699190830881i, -0.0005133186548142366 + 1.7200634454949787e-05i, 0.005164339925353046 + 0.004532824227317477i, -0.005226207786147069 + 0.007731393846749491i, 0.1240405571001877 + -7.555533889508359e-19i, -1.0137604456244855e-05 + -1.4676356861779449e-05i, -0.00014389459304757395 + 0.00011352907210636155i }, { 0.00520583229188576 + -0.004436762516104884i, -0.00045378689714282674 + -0.00019347854120355606i, 0.0002698900038607508 + -0.00038462565755702764i, -0.00010889335289395341 + -2.9717901730526118e-05i, -0.00014610616931576864 + -0.00015736359780677388i, -1.0137604456244853e-05 + 1.4676356861779466e-05i, 0.12416377064270151 + 1.07742590890747e-18i, -0.004360896324426234 + -0.006480668423011746i }, { 9.53595289271732e-06 + 0.0004279490781978788i, 0.004195535978030206 + -0.0038148403845655113i, 9.088760433336932e-05 + 4.36034685524015e-05i, 5.70404774027334e-05 + -9.273780751793763e-05i, 1.3887048359424956e-05 + -2.833366958751174e-06i, -0.00014389459304757398 + -0.00011352907210636153i, -0.004360896324426234 + 0.006480668423011746i, 0.10514333765733436 + 1.0672615135404184e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, true, false, false, false, false, true}), ElementsAreArray({ DoubleNear(0.12156407999639143, 1.0e-7), DoubleNear(0.10317439492831276, 1.0e-7), DoubleNear(0.14917391724976847, 1.0e-7), DoubleNear(0.1265059122820361, 1.0e-7), DoubleNear(0.14623403014326627, 1.0e-7), DoubleNear(0.1240405571001877, 1.0e-7), DoubleNear(0.12416377064270151, 1.0e-7), DoubleNear(0.10514333765733436, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, true, true, false, false, false}), Matrix({ { 0.14164379752104217 + -7.148958074826295e-19i, -0.005386205027554018 + -0.008898668700070013i, -0.016444877143899472 + -0.008584156286642707i, 0.00034686500774523254 + 0.0026788408194968315i, -0.0023687522460435146 + -0.009256302118123803i, 0.00015668957311293016 + 0.0004185739997351102i, 0.0005555769788675431 + -0.0008866207854057949i, -0.0019422991088887918 + 0.001384700195216128i }, { -0.005386205027554018 + 0.008898668700070014i, 0.12370628361855149 + 2.574980159653073e-19i, 0.0031623844731714775 + -0.0015671642164402392i, -0.01923969951179684 + -0.001828479855179591i, 0.0007759484498555117 + 0.0005813103923817145i, 0.0007213561765512127 + -0.0038920930514467853i, 0.0010330622686070844 + 0.001125773009506415i, -0.0036142856373314455 + -0.005546914532910313i }, { -0.016444877143899472 + 0.008584156286642707i, 0.003162384473171478 + 0.0015671642164402397i, 0.11741713683432262 + 9.046311876675928e-19i, -0.004312269289248698 + -0.005982909647808307i, 0.004705247366323346 + -0.0027355377015093477i, 0.0001746575950033381 + 0.0006180071739721488i, -0.008055758693715814 + 0.00947424759477127i, 0.0004415139559974222 + 0.00011890922665095578i }, { 0.0003468650077452323 + -0.0026788408194968315i, -0.01923969951179684 + 0.0018284798551795917i, -0.004312269289248698 + 0.005982909647808307i, 0.10077928733205647 + 1.0469327228063152e-18i, -0.0003017363912700896 + -0.00045711263330829564i, 0.0038170242608970154 + 0.0017937483540546406i, -0.0006513205211186538 + -0.0011111707451562651i, -0.0006199397064679947 + 0.008227866414531736i }, { -0.002368752246043513 + 0.009256302118123803i, 0.0007759484498555114 + -0.0005813103923817141i, 0.004705247366323345 + 0.0027355377015093486i, -0.00030173639127008966 + 0.00045711263330829564i, 0.1479579993917022 + 7.081195439045951e-19i, -0.005367214143355961 + -0.007318680151312754i, -0.015952747716165734 + -0.005327193873965494i, 0.0016254597007648607 + -0.0004030521618907081i }, { 0.0001566895731129299 + -0.00041857399973510996i, 0.0007213561765512139 + 0.003892093051446786i, 0.00017465759500333804 + -0.0006180071739721488i, 0.0038170242608970167 + -0.0017937483540546408i, -0.005367214143355959 + 0.007318680151312755i, 0.122273260688495 + -5.963111948670274e-19i, 0.0013066795803717266 + -0.0007106481474158681i, -0.01536267925543905 + 0.010050102976195782i }, { 0.0005555769788675432 + 0.0008866207854057949i, 0.0010330622686070842 + -0.0011257730095064152i, -0.008055758693715808 + -0.009474247594771272i, -0.0006513205211186539 + 0.0011111707451562656i, -0.015952747716165734 + 0.005327193873965493i, 0.0013066795803717266 + 0.0007106481474158683i, 0.13411686428506073 + 1.0570971181733668e-18i, -0.004112047307463921 + -0.0062146047743625405i }, { -0.0019422991088887918 + -0.001384700195216128i, -0.0036142856373314464 + 0.005546914532910313i, 0.00044151395599742227 + -0.00011890922665095578i, -0.0006199397064679934 + -0.008227866414531736i, 0.0016254597007648603 + 0.00040305216189070797i, -0.015362679255439052 + -0.01005010297619578i, -0.004112047307463921 + 0.00621460477436254i, 0.11210537032876794 + -1.308665903507894e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, true, true, false, false, false}), ElementsAreArray({ DoubleNear(0.14164379752104217, 1.0e-7), DoubleNear(0.12370628361855149, 1.0e-7), DoubleNear(0.11741713683432262, 1.0e-7), DoubleNear(0.10077928733205647, 1.0e-7), DoubleNear(0.1479579993917022, 1.0e-7), DoubleNear(0.122273260688495, 1.0e-7), DoubleNear(0.13411686428506073, 1.0e-7), DoubleNear(0.11210537032876794, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, true, false, true, false, false}), Matrix({ { 0.15155144519607777 + 1.8295911660692887e-19i, -0.00566417909977731 + -0.008823584981070966i, -0.016971655216250707 + -0.007294784584484127i, 0.0010264651948247105 + 0.0012007418857587428i, 0.023059501972575617 + 0.00847614173950245i, -0.0009374832051912906 + -0.0017515374543346457i, -0.002033217278986959 + -0.002568157212852194i, 0.0001675099397262367 + 0.0002720211515989724i }, { -0.00566417909977731 + 0.008823584981070966i, 0.129790705784992 + 1.3417001884508117e-18i, 0.002404296902096055 + -0.0013561469184148645i, -0.018257594717928007 + 0.004371969111749666i, -0.0018010911233669507 + 0.000516293937554162i, 0.019573628465350268 + 0.004936593907973871i, 0.0005022756743794945 + 3.1952717229713116e-05i, -0.002709500510613148 + -0.0003993305903736746i }, { -0.01697165521625071 + 0.007294784584484126i, 0.002404296902096056 + 0.001356146918414865i, 0.13164183712706728 + 9.486769009248164e-19i, -0.00437435545001009 + -0.006743439735027397i, -0.0035109337440813637 + 0.0002504275162017298i, 0.00040302956309162325 + 0.0002763512721400994i, 0.019509076623141917 + 0.006743842123473277i, -0.0007017771256995364 + -0.0012471412309377056i }, { 0.0010264651948247102 + -0.0012007418857587428i, -0.01825759471792801 + -0.004371969111749664i, -0.00437435545001009 + 0.006743439735027397i, 0.11245706239108105 + -6.505213034913027e-19i, 0.0003035622551366152 + -2.561965381702305e-05i, -0.003015529649815085 + -0.0011611329101028573i, -0.001341001465528454 + 0.00045140064089833464i, 0.01621393069043257 + 0.0033105683750894763i }, { 0.023059501972575613 + -0.00847614173950245i, -0.0018010911233669507 + -0.0005162939375541622i, -0.0035109337440813637 + -0.00025042751620172986i, 0.0003035622551366152 + 2.5619653817022834e-05i, 0.13805035171666658 + -1.8973538018496328e-19i, -0.005089240071132669 + -0.007393763870311801i, -0.015425969643814496 + -0.0066165655761240725i, 0.0009458595136853826 + 0.0010750467718473808i }, { -0.0009374832051912908 + 0.0017515374543346455i, 0.019573628465350268 + -0.004936593907973873i, 0.0004030295630916234 + -0.0002763512721400994i, -0.003015529649815085 + 0.0011611329101028573i, -0.005089240071132669 + 0.007393763870311801i, 0.11618883852205449 + -1.6805133673525319e-18i, 0.0020647671514471486 + -0.000921665445441243i, -0.016344784049307882 + 0.003849654009266526i }, { -0.0020332172789869598 + 0.0025681572128521944i, 0.0005022756743794947 + -3.195271722971325e-05i, 0.019509076623141917 + -0.006743842123473278i, -0.0013410014655284542 + -0.0004514006408983344i, -0.015425969643814496 + 0.006616565576124073i, 0.0020647671514471486 + 0.0009216654454412429i, 0.11989216399231606 + 1.0130514049161432e-18i, -0.004049961146702531 + -0.0054540746871434495i }, { 0.00016750993972623686 + -0.0002720211515989722i, -0.0027095005106131474 + 0.0003993305903736753i, -0.0007017771256995363 + 0.0012471412309377054i, 0.016213930690432574 + -0.0033105683750894767i, 0.0009458595136853823 + -0.0010750467718473808i, -0.016344784049307885 + -0.003849654009266525i, -0.00404996114670253 + 0.0054540746871434495i, 0.10042759526974335 + 3.8878812278972386e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, true, false, true, false, false}), ElementsAreArray({ DoubleNear(0.15155144519607777, 1.0e-7), DoubleNear(0.129790705784992, 1.0e-7), DoubleNear(0.13164183712706728, 1.0e-7), DoubleNear(0.11245706239108105, 1.0e-7), DoubleNear(0.13805035171666658, 1.0e-7), DoubleNear(0.11618883852205449, 1.0e-7), DoubleNear(0.11989216399231606, 1.0e-7), DoubleNear(0.10042759526974335, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, true, false, false, true, false}), Matrix({ { 0.14513993266905925 + 1.5585406229479126e-19i, -0.005871194752086259 + -0.00800635290665018i, -0.016788058851945648 + -0.008004735292568605i, 0.0011561651347703726 + 0.0010245626500448174i, 0.0019644533180859587 + -0.0018054346262741392i, -0.0005819490543322216 + 0.0017526681697639702i, -0.0004779660263881149 + -0.00040853407275801977i, 0.00012749341462230923 + -0.00030452046218776844i }, { -0.0058711947520862584 + 0.00800635290665018i, 0.12116426485544249 + 4.87890977618477e-19i, 0.002143890028911864 + -0.0011561549643360695i, -0.01722548271858517 + 0.003174040570620978i, -0.0006408374009194048 + 0.0014280820933260793i, 0.0005581861419936009 + 0.0003415017530142407i, 0.0002615933952830314 + -0.0002888773822595726i, -0.00015804881941010426 + -0.0004962158128272338i }, { -0.016788058851945648 + 0.008004735292568605i, 0.002143890028911864 + 0.0011561549643360697i, 0.1238989736903843 + 8.436448154652831e-19i, -0.004291824162619426 + -0.005957041040721605i, -0.0004977892584237093 + 0.0007547578128208095i, -0.00017458581716039013 + -0.00041200845725572466i, 0.0007069231713920255 + -0.0018155180462075165i, -0.0002936400627254246 + 0.001392348079524256i }, { 0.0011561651347703722 + -0.0010245626500448174i, -0.017225482718585178 + -0.003174040570620976i, -0.004291824162619425 + 0.0059570410407216055i, 0.10180100028228381 + 2.1260526976082939e-19i, 0.00013431254271327217 + -0.0001749233908226813i, -0.00023858624019976025 + 0.0003830474593875184i, -0.00036802506846783537 + 0.0010603725028360976i, -0.0009724066182389462 + 6.843252575428814e-05i }, { 0.001964453318085958 + 0.0018054346262741398i, -0.0006408374009194047 + -0.0014280820933260797i, -0.0004977892584237097 + -0.000754757812820809i, 0.00013431254271327215 + 0.0001749233908226813i, 0.1444618642436851 + -1.6263032587282567e-19i, -0.00488222441882372 + -0.00821099594473259i, -0.015609566008119557 + -0.005906614868039594i, 0.0008161595737397207 + 0.001251226007561306i }, { -0.0005819490543322219 + -0.00175266816976397i, 0.0005581861419936016 + -0.000341501753014242i, -0.00017458581716039008 + 0.0004120084572557247i, -0.00023858624019976014 + -0.0003830474593875178i, -0.00488222441882372 + 0.00821099594473259i, 0.124815279451604 + -8.267041565201971e-19i, 0.00232517402463134 + -0.001121657399520038i, -0.017376896048650718 + 0.005047582550395214i }, { -0.00047796602638811513 + 0.00040853407275801966i, 0.0002615933952830313 + 0.0002888773822595726i, 0.0007069231713920259 + 0.0018155180462075173i, -0.00036802506846783526 + -0.0010603725028360978i, -0.015609566008119559 + 0.005906614868039594i, 0.0023251740246313405 + 0.001121657399520038i, 0.12763502742899907 + 1.1180834903756764e-18i, -0.004132492434093194 + -0.006240473381449241i }, { 0.00012749341462230918 + 0.00030452046218776833i, -0.00015804881941010424 + 0.000496215812827233i, -0.0002936400627254245 + -0.0013923480795242557i, -0.0009724066182389478 + -6.843252575428727e-05i, 0.0008161595737397203 + -0.0012512260075613062i, -0.017376896048650718 + -0.005047582550395213i, -0.0041324924340931934 + 0.006240473381449241i, 0.11108365737854058 + -4.743384504624082e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, true, false, false, true, false}), ElementsAreArray({ DoubleNear(0.14513993266905925, 1.0e-7), DoubleNear(0.12116426485544249, 1.0e-7), DoubleNear(0.1238989736903843, 1.0e-7), DoubleNear(0.10180100028228381, 1.0e-7), DoubleNear(0.1444618642436851, 1.0e-7), DoubleNear(0.124815279451604, 1.0e-7), DoubleNear(0.12763502742899907, 1.0e-7), DoubleNear(0.11108365737854058, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, true, false, false, false, true}), Matrix({ { 0.14512134066398907 + 1.2739375526704677e-18i, -0.005407291421181713 + -0.008122499782707364i, -0.01611200352816833 + -0.007096259857124484i, 0.0009907488670505512 + 0.0011078676145017334i, 0.0001958041545093013 + 0.00010270157221040801i, 5.532519490540609e-06 + -3.816172167258118e-05i, -3.376595660881257e-05 + -2.736733838979112e-05i, 2.706931149159103e-06 + -8.312825858603617e-06i }, { -0.005407291421181713 + 0.008122499782707363i, 0.1233430233033182 + -1.8804131429045468e-19i, 0.0022071308303784837 + -0.0011219429134940746i, -0.01726716184514516 + 0.0039745255887127014i, -1.3926076206945033e-05 + 3.212161868948704e-05i, -1.5444178769301998e-06 + 8.768579603789088e-05i, 1.175028079998965e-05 + -2.4220086673110212e-05i, -1.8664112556863867e-07 + -5.0973340668682216e-05i }, { -0.01611200352816833 + 0.007096259857124483i, 0.002207130830378484 + 0.0011219429134940746i, 0.1256166565821708 + 1.0570971181733668e-18i, -0.004183340235867581 + -0.006080301221085015i, -3.853326880910843e-05 + -3.574411690641959e-05i, 2.691849210224699e-06 + 2.545992672543069e-05i, 0.00014720293917453575 + 0.00011537616081158771i, 6.8033411186533834e-06 + -2.6515719329546394e-05i }, { 0.000990748867050551 + -0.0011078676145017334i, -0.017267161845145165 + -0.003974525588712701i, -0.004183340235867581 + 0.006080301221085015i, 0.10633728390703065 + 2.363221922839498e-19i, 8.316257025309186e-06 + 1.215368561824116e-05i, 1.9225008975092208e-05 + -2.5273066792416362e-05i, -3.003494013313836e-06 + 1.752607876108482e-05i, -1.0877686862367687e-05 + 0.00011674900338835514i }, { 0.00019580415450930124 + -0.00010270157221040847i, -1.3926076206945123e-05 + -3.212161868948699e-05i, -3.85332688091084e-05 + 3.574411690641969e-05i, 8.316257025309174e-06 + -1.215368561824114e-05i, 0.14448045624875527 + -1.2807138162485021e-18i, -0.0053461277497282664 + -0.008094849068675403i, -0.01628562133189687 + -0.006815090303483717i, 0.000981575841459542 + 0.00116792104310439i }, { 5.532519490540724e-06 + 3.816172167258127e-05i, -1.5444178769302946e-06 + -8.768579603789107e-05i, 2.691849210224661e-06 + -2.5459926725430733e-05i, 1.9225008975092215e-05 + 2.52730667924164e-05i, -0.005346127749728266 + 0.008094849068675405i, 0.1226365210037283 + -1.5077186461126546e-19i, 0.00226193322316472 + -0.0011558694503620327i, -0.01733521692209073 + 0.0042470975323034895i }, { -3.3765956608812576e-05 + 2.736733838979121e-05i, 1.1750280799989688e-05 + 2.422008667311017e-05i, 0.0001472029391745357 + -0.00011537616081158814i, -3.0034940133139133e-06 + -1.752607876108477e-05i, -0.016285621331896875 + 0.006815090303483717i, 0.002261933223164721 + 0.0011558694503620332i, 0.12591734453721254 + 9.046311876675928e-19i, -0.004240976360845038 + -0.006117213201085832i }, { 2.706931149159109e-06 + 8.312825858603618e-06i, -1.8664112556863486e-07 + 5.097334066868226e-05i, 6.803341118653485e-06 + 2.6515719329546455e-05i, -1.087768686236766e-05 + -0.0001167490033883554i, 0.0009815758414595415 + -0.0011679210431043902i, -0.01733521692209073 + -0.0042470975323034895i, -0.004240976360845038 + 0.006117213201085832i, 0.10654737375379375 + -4.980553729855286e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, true, false, false, false, true}), ElementsAreArray({ DoubleNear(0.14512134066398907, 1.0e-7), DoubleNear(0.1233430233033182, 1.0e-7), DoubleNear(0.1256166565821708, 1.0e-7), DoubleNear(0.10633728390703065, 1.0e-7), DoubleNear(0.14448045624875527, 1.0e-7), DoubleNear(0.1226365210037283, 1.0e-7), DoubleNear(0.12591734453721254, 1.0e-7), DoubleNear(0.10654737375379375, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, true, true, false, false}), Matrix({ { 0.13560245422046502 + 4.404571325722362e-19i, -0.005064487702846972 + -0.00818356145448688i, -0.00544784407923851 + 0.00015506585708932184i, 0.0006186211805051377 + 0.000515391476802682i, 0.019936171637915504 + 0.006459360647967646i, -0.0007863793339604377 + -0.0016136050335729033i, -0.00037254849472483884 + -0.0036296488597280453i, -0.00030919043430200244 + 0.00014290928190144924i }, { -0.005064487702846971 + 0.00818356145448688i, 0.11848689313599456 + 5.285485590866834e-19i, 0.0002821410131225421 + -1.285387835004719e-05i, 0.0004028212229150068 + 0.0023585259097994183i, -0.0016484464909319915 + 0.0005588485372837594i, 0.018048642823089038 + 0.004202125891409232i, 0.00024317073212961894 + 0.0002634225719766009i, -0.0007449142941436132 + -0.0023079756073714278i }, { -0.005447844079238508 + -0.00015506585708932184i, 0.00028214101312254187 + 1.2853878350047637e-05i, 0.14759082810268004 + 6.911788849595091e-19i, -0.004974046846940429 + -0.007383463261611484i, -0.0037140850044921625 + -4.428391584634689e-05i, 0.00024196503629241462 + 0.00029647228813740585i, 0.022632406957802026 + 0.008760623215008081i, -0.0008528809969303892 + -0.001385073651699448i }, { 0.0006186211805051377 + -0.000515391476802682i, 0.00040282122291500724 + -0.0023585259097994174i, -0.004974046846940428 + 0.007383463261611484i, 0.12376087504007852 + 1.6263032587282567e-19i, 0.00028482285393195076 + -0.00023636248777637186i, -0.0020911115564751417 + -0.0012318738588706893i, -0.001493646097963413 + 0.00040884604116873724i, 0.017738916332693797 + 0.004045036391654114i }, { 0.019936171637915504 + -0.00645936064796765i, -0.0016484464909319917 + -0.0005588485372837593i, -0.0037140850044921634 + 4.428391584634781e-05i, 0.0002848228539319508 + 0.0002363624877763718i, 0.12345848013489975 + -2.507217523872729e-19i, -0.004633986613955745 + -0.00669801689339144i, -0.004976666860520816 + 6.287961955814638e-05i, -2.0417651394785406e-05 + 2.2091749583383878e-05i }, { -0.0007863793339604381 + 0.0016136050335729033i, 0.018048642823089038 + -0.004202125891409233i, 0.00024196503629241457 + -0.00029647228813740574i, -0.0020911115564751417 + 0.00123187385887069i, -0.004633986613955745 + 0.006698016893391442i, 0.10599867781461342 + 7.758821796849391e-19i, -0.00015751308438568428 + -0.0005170064744245036i, -0.00030140475283178835 + 0.001977247453285531i }, { -0.00037254849472483813 + 0.003629648859728045i, 0.00024317073212961915 + -0.0002634225719766007i, 0.022632406957802026 + -0.00876062321500808i, -0.001493646097963413 + -0.00040884604116873724i, -0.004976666860520813 + -6.287961955814638e-05i, -0.00015751308438568433 + 0.000517006474424504i, 0.13448403557408287 + 1.0740377771184528e-18i, -0.004505214603879454 + -0.00614982166406381i }, { -0.0003091904343020025 + -0.00014290928190144905i, -0.0007449142941436126 + 0.002307975607371427i, -0.000852880996930389 + 0.0013850736516994476i, 0.017738916332693797 + -0.0040450363916541155i, -2.0417651394785528e-05 + -2.209174958338377e-05i, -0.0003014047528317866 + -0.0019772474532855303i, -0.004505214603879454 + 0.00614982166406381i, 0.11061775597718443 + -2.067607424247747e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, true, true, false, false}), ElementsAreArray({ DoubleNear(0.13560245422046502, 1.0e-7), DoubleNear(0.11848689313599456, 1.0e-7), DoubleNear(0.14759082810268004, 1.0e-7), DoubleNear(0.12376087504007852, 1.0e-7), DoubleNear(0.12345848013489975, 1.0e-7), DoubleNear(0.10599867781461342, 1.0e-7), DoubleNear(0.13448403557408287, 1.0e-7), DoubleNear(0.11061775597718443, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, true, false, true, false}), Matrix({ { 0.12514736676154584 + 4.2012834183813297e-19i, -0.0050730120864133 + -0.0073279719819851425i, -0.01038370840737463 + -0.00389098605574572i, 0.0001295572356032488 + 0.0011167726954937462i, -7.175877082619335e-05 + -0.0021677513901399146i, -0.00047389366996602675 + 0.0015777111193472288i, -0.002095189330738616 + -0.003022387868051282i, -0.0002406579020584249 + 0.00044606821569117i }, { -0.0050730120864133 + 0.007327971981985143i, 0.10848246370111479 + 1.060485249962384e-18i, 0.0008525108155312299 + -0.000560975109812564i, -0.0057687346379 + 0.0005623230802634158i, -0.00047463486504651807 + 0.0013409661220855802i, 0.00012268556098311693 + 0.00014497930693730906i, 0.00046954378456769976 + -9.61913232966615e-05i, -0.002867467586345559 + -0.0016928282981366935i }, { -0.010383708407374627 + 0.0038909860557457205i, 0.0008525108155312298 + 0.0005609751098125643i, 0.1438915395978977 + 5.793705359219414e-19i, -0.0050900068282923846 + -0.006635421965386641i, -0.002789767982270721 + 0.0020985729152741776i, 0.0005148903634036964 + 0.00015473699798566694i, 0.0027431352603041774 + -0.0014532012823417417i, -0.0004016954470916194 + 0.0015673051299409972i }, { 0.00012955723560324853 + -0.001116772695493746i, -0.005768734637899999 + -0.0005623230802634146i, -0.005090006828292384 + 0.006635421965386641i, 0.11448280143661153 + -3.5998900258307764e-19i, -5.045708147350368e-05 + -0.0004870687619044469i, -0.003036643817519849 + 0.0006019187564446017i, -0.000534227604340722 + 0.0011474884740765967i, -0.000536906037228462 + 0.00026495497183121974i }, { -7.175877082619465e-05 + 0.002167751390139915i, -0.00047463486504651774 + -0.0013409661220855807i, -0.0027897679822707216 + -0.0020985729152741784i, -5.0457081473503706e-05 + 0.0004870687619044471i, 0.13391356759381895 + -2.303929616531697e-19i, -0.004625462230389416 + -0.007553606365893177i, -4.0802532384696895e-05 + 0.004108931532393188i, 0.0004686462935071036 + -0.0005792894691076801i }, { -0.000473893669966027 + -0.0015777111193472286i, 0.00012268556098311584 + -0.00014497930693730798i, 0.0005148903634036963 + -0.00015473699798566694i, -0.0030366438175198495 + -0.0006019187564446024i, -0.004625462230389416 + 0.007553606365893178i, 0.11600310724949317 + 2.439454888092385e-19i, -0.000727882886794372 + 3.1114757038013265e-05i, 0.005870151107983218 + 0.003773450282821534i }, { -0.0020951893307386152 + 0.003022387868051283i, 0.00046954378456769976 + 9.619132329666142e-05i, 0.0027431352603041782 + 0.0014532012823417419i, -0.0005342276043407221 + -0.0011474884740765969i, -4.0802532384694116e-05 + -0.004108931532393188i, -0.0007278828867943723 + -3.1114757038012756e-05i, 0.13818332407886524 + 1.1858461261560205e-18i, -0.004389254622527498 + -0.0068978629602886535i }, { -0.00024065790205842505 + -0.0004460682156911701i, -0.0028674675863455588 + 0.0016928282981366937i, -0.0004016954470916194 + -0.0015673051299409972i, -0.000536906037228462 + -0.00026495497183122115i, 0.0004686462935071036 + 0.0005792894691076802i, 0.005870151107983219 + -0.003773450282821534i, -0.004389254622527497 + 0.0068978629602886535i, 0.11989582958065141 + -1.5449880957918438e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, true, false, true, false}), ElementsAreArray({ DoubleNear(0.12514736676154584, 1.0e-7), DoubleNear(0.10848246370111479, 1.0e-7), DoubleNear(0.1438915395978977, 1.0e-7), DoubleNear(0.11448280143661153, 1.0e-7), DoubleNear(0.13391356759381895, 1.0e-7), DoubleNear(0.11600310724949317, 1.0e-7), DoubleNear(0.13818332407886524, 1.0e-7), DoubleNear(0.11989582958065141, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, true, false, false, true}), Matrix({ { 0.1295476700933757 + 8.504210790433175e-19i, -0.004827246531273642 + -0.007423891404844668i, -0.005252704977124148 + 4.504762531960891e-05i, 0.00031743458652527617 + 0.00027194073935950616i, 0.00014718441587453443 + 0.00011881381991403725i, 4.892804525283719e-06 + -3.3510613676625015e-05i, -9.274208282321182e-06 + 7.678876856689866e-06i, -5.709260091919719e-06 + 4.203717832507159e-07i }, { -0.004827246531273642 + 0.007423891404844668i, 0.1123241070134931 + 1.6974540262976179e-18i, 6.574630598705746e-05 + -0.00027322039105845625i, 3.891182372761778e-05 + 0.002133313490164385i, -1.2064976627304218e-05 + 2.6434859274271746e-05i, -4.302775823378658e-06 + 0.00011556802854356506i, -1.0009226109923486e-05 + -6.386948694417872e-06i, -4.370207423330788e-06 + 1.4424925974088992e-05i }, { -0.005252704977124144 + -4.504762531960934e-05i, 6.574630598705719e-05 + 0.00027322039105845663i, 0.14119032715278423 + 1.480613591800517e-18i, -0.004763385125775652 + -0.0067789095989477105i, -6.5768496151826825e-06 + 1.1368476199745662e-05i, -7.899106372419696e-06 + 5.4411887508048665e-06i, 0.0001958226778093026 + 9.926391310795848e-05i, 7.443056083910273e-06 + -3.1166827325502566e-05i }, { 0.00031743458652527606 + -0.00027194073935950605i, 3.891182372761908e-05 + -0.002133313490164384i, -0.004763385125775652 + 0.00677890959894771i, 0.11735620019685576 + -1.6491731483041228e-18i, -9.561196022551119e-06 + 2.50147412439948e-06i, 8.028531839233196e-06 + 2.138601049472984e-05i, -4.864593592954646e-06 + 2.3212838176300116e-05i, -8.119328915919208e-06 + 8.886677088268097e-05i }, { 0.00014718441587453445 + -0.00011881381991403761i, -1.2064976627304291e-05 + -2.64348592742717e-05i, -6.576849615182676e-06 + -1.1368476199745648e-05i, -9.561196022551119e-06 + -2.5014741243994724e-06i, 0.1295132642619891 + -6.606856988583543e-19i, -0.004871227785529075 + -0.007457686943033651i, -0.005171805962635181 + 0.00017289785132785932i, 0.0002807689425850762 + 0.00026554248702655983i }, { 4.892804525283817e-06 + 3.351061367662509e-05i, -4.302775823378672e-06 + -0.0001155680285435652i, -7.899106372419731e-06 + -5.44118875080486e-06i, 8.028531839233203e-06 + -2.138601049472985e-05i, -0.004871227785529075 + 0.007457686943033651i, 0.11216146393711487 + -3.9302328752599536e-19i, 5.88816227498004e-05 + -0.0002566399617160945i, 6.250464635560067e-05 + 0.0022024598729205648i }, { -9.2742082823212e-06 + -7.67887685668982e-06i, -1.0009226109923464e-05 + 6.386948694417874e-06i, 0.00019582267780930254 + -9.926391310795901e-05i, -4.8645935929547396e-06 + -2.3212838176300055e-05i, -0.005171805962635177 + -0.00017289785132785888i, 5.888162274980029e-05 + 0.00025663996171609496i, 0.14088453652397873 + 2.846030702774449e-19i, -0.00471587632504423 + -0.006754375326727584i }, { -5.709260091919724e-06 + -4.203717832507108e-07i, -4.370207423330796e-06 + -1.4424925974088963e-05i, 7.44305608391039e-06 + 3.116682732550265e-05i, -8.119328915919276e-06 + -8.886677088268126e-05i, 0.0002807689425850761 + -0.00026554248702655967i, 6.250464635560154e-05 + -0.0022024598729205643i, -0.004715876325044229 + 0.006754375326727585i, 0.11702243082040718 + -2.558039500707987e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, true, false, false, true}), ElementsAreArray({ DoubleNear(0.1295476700933757, 1.0e-7), DoubleNear(0.1123241070134931, 1.0e-7), DoubleNear(0.14119032715278423, 1.0e-7), DoubleNear(0.11735620019685576, 1.0e-7), DoubleNear(0.1295132642619891, 1.0e-7), DoubleNear(0.11216146393711487, 1.0e-7), DoubleNear(0.14088453652397873, 1.0e-7), DoubleNear(0.11702243082040718, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, false, true, true, false}), Matrix({ { 0.12954396817087283 + 5.014435047745458e-19i, -0.006477458646305676 + -0.006564979643109037i, 0.015152509271571418 + 0.017552497855915675i, -0.0010547101360256642 + -0.00039228809791535575i, -0.004545183759127576 + -0.0043298287830651535i, -0.0015233809258508799 + 0.0019089431949153692i, 0.01786731080567611 + -0.0160992046719014i, -0.0021851311995463646 + 9.696514723649501e-05i }, { -0.006477458646305674 + 0.006564979643109035i, 0.1048673079783981 + 1.1722935989999517e-18i, -0.0016929396286619706 + -0.0011530512329843983i, 0.008717430472466741 + 0.010452058926786002i, -0.00029765177398599434 + 0.0006231672367025241i, -0.006198291266191388 + -0.00236413429317773i, 0.00023762825092059196 + 0.0013582017928846252i, 0.014473798922357475 + -0.013648455265625727i }, { 0.015152509271571418 + -0.017552497855915675i, -0.0016929396286619709 + 0.0011530512329843987i, 0.1394949381885707 + 4.980553729855286e-19i, -0.0036855602684000093 + -0.007398414304262748i, 0.0193992683805155 + 0.023855022319091874i, 0.001237128775518497 + -0.0005656822440529961i, 0.00721656024860556 + 0.0007088761105834972i, 0.0006477918087932338 + 0.0012360730543728566i }, { -0.0010547101360256642 + 0.0003922880979153556i, 0.00871743047246674 + -0.010452058926786002i, -0.0036855602684000093 + 0.0073984143042627485i, 0.11809795715932822 + -4.717973516206453e-19i, -0.002055242377239791 + 0.000639056139898951i, 0.01628029084314287 + 0.020529754686229515i, -0.0007112106954012457 + 0.0018652873594596528i, 0.005784070789946043 + 0.0027740685719462588i }, { -0.004545183759127576 + 0.004329828783065153i, -0.00029765177398599423 + -0.0006231672367025248i, 0.01939926838051549 + -0.023855022319091874i, -0.002055242377239791 + -0.0006390561398989508i, 0.15364931415227223 + 6.301925127571995e-19i, -0.0035610759034817247 + -0.009002045072989327i, 0.027416069324146114 + -0.0023325139929399477i, -0.0005845501948651629 + -0.0026063905873569956i }, { -0.00152338092585088 + -0.0019089431949153692i, -0.00619829126619139 + 0.0023641342931777277i, 0.0012371287755184972 + 0.0005656822440529962i, 0.01628029084314287 + -0.020529754686229515i, -0.003561075903481724 + 0.009002045072989327i, 0.13738046019767497 + -4.811147140404426e-19i, -0.0014491529602334336 + 0.0021207458114368954i, 0.027070128683316097 + -0.0022048966437226555i }, { 0.017867310805676107 + 0.0160992046719014i, 0.00023762825092059196 + -0.001358201792884625i, 0.00721656024860556 + -0.000708876110583496i, -0.0007112106954012456 + -0.001865287359459653i, 0.027416069324146114 + 0.002332513992939946i, -0.001449152960233434 + -0.0021207458114368954i, 0.11844757752041193 + 3.2526065174565133e-19i, -0.00545364094943519 + -0.005449424253192503i }, { -0.0021851311995463646 + -9.696514723649482e-05i, 0.014473798922357476 + 0.013648455265625727i, 0.0006477918087932338 + -0.0012360730543728563i, 0.005784070789946044 + -0.002774068571946257i, -0.0005845501948651627 + 0.002606390587356995i, 0.027070128683316097 + 0.0022048966437226546i, -0.005453640949435189 + 0.005449424253192503i, 0.09851847663246961 + -8.199278929421627e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, false, true, true, false}), ElementsAreArray({ DoubleNear(0.12954396817087283, 1.0e-7), DoubleNear(0.1048673079783981, 1.0e-7), DoubleNear(0.1394949381885707, 1.0e-7), DoubleNear(0.11809795715932822, 1.0e-7), DoubleNear(0.15364931415227223, 1.0e-7), DoubleNear(0.13738046019767497, 1.0e-7), DoubleNear(0.11844757752041193, 1.0e-7), DoubleNear(0.09851847663246961, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, false, true, false, true}), Matrix({ { 0.14168162686419136 + 9.317362419797304e-19i, -0.005018801316234216 + -0.007777588742327067i, 0.021297542648618245 + 0.007627195250535535i, -0.0008324874817404892 + -0.001503616343530294i, 0.0001264856134042868 + 0.00011262942365871086i, 3.730742978369102e-07 + -2.7270997966126032e-05i, 0.00010985835771127011 + -0.00024474609100623483i, -1.9041575366444494e-05 + -6.197107290864823e-05i }, { -0.005018801316234215 + 0.0077775887423270655i, 0.12125106987822037 + 1.2874900798265365e-19i, -0.0015607872962283044 + 0.0004890094408054411i, 0.017908421503693026 + 0.004115984508162689i, -1.3106662495712985e-05 + 1.9307724810158937e-05i, 4.9569806883074556e-05 + 0.00010813215648607045i, 4.786815831745722e-05 + -2.645179557466747e-05i, -0.00010426534257882214 + 0.00029704575328367574i }, { 0.021297542648618245 + -0.007627195250535534i, -0.0015607872962283046 + -0.0004890094408054412i, 0.12905637038196854 + 1.3992984288641042e-18i, -0.004571830340815078 + -0.0064252122614653125i, 0.00011470296715054547 + 0.00028197847727438213i, 4.61317545559246e-05 + 2.5458304700344412e-05i, 0.00021652148027955024 + 0.00010544830936328484i, 1.1962786311357085e-05 + -3.740644303600154e-05i }, { -0.0008324874817404892 + 0.001503616343530294i, 0.017908421503693022 + -0.00411598450816269i, -0.004571830340815078 + 0.0064252122614653125i, 0.1084292373321285 + -8.046812998915853e-20i, -2.541076523692833e-05 + 5.8789065705304325e-05i, -8.922739461002588e-05 + -0.0002682424036514397i, -3.8229077245458805e-06 + 3.033997264041293e-05i, -6.199191162237244e-05 + 9.630264294017559e-05i }, { 0.00012648561340428678 + -0.00011262942365871139i, -1.310666249571308e-05 + -1.9307724810158907e-05i, 0.00011470296715054544 + -0.00028197847727438224i, -2.5410765236928337e-05 + -5.878906570530431e-05i, 0.1415116554589537 + 1.9989977555201488e-19i, -0.005019733233553185 + -0.007789435973771297i, 0.02127103594709929 + 0.007592788612440192i, -0.0008067728491503378 + -0.0014950623417420573i }, { 3.7307429783702537e-07 + 2.7270997966126093e-05i, 4.956980688307453e-05 + -0.00010813215648607062i, 4.613175455592465e-05 + -2.545830470034434e-05i, -8.922739461002596e-05 + 0.0002682424036514396i, -0.005019733233553183 + 0.007789435973771297i, 0.12099669829785271 + 5.624298769768554e-19i, -0.0015813052926671 + 0.0004786851376470557i, 0.017879137652089813 + 0.004131177774900656i }, { 0.0001098583577112701 + 0.00024474609100623483i, 4.786815831745719e-05 + 2.6451795574667524e-05i, 0.00021652148027955024 + -0.00010544830936328522i, -3.822907724545955e-06 + -3.033997264041285e-05i, 0.021271035947099285 + -0.007592788612440195i, -0.0015813052926671 + -0.0004786851376470552i, 0.1288861453270141 + -5.759824041329242e-19i, -0.004567370877020121 + -0.006422626295989939i }, { -1.904157536644452e-05 + 6.197107290864826e-05i, -0.00010426534257882215 + -0.00029704575328367585i, 1.1962786311357184e-05 + 3.7406443036001644e-05i, -6.199191162237252e-05 + -9.630264294017583e-05i, -0.0008067728491503378 + 0.0014950623417420569i, 0.017879137652089816 + -0.004131177774900658i, -0.004567370877020121 + 0.006422626295989939i, 0.10818719645966934 + -1.2112571145736495e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, false, true, false, true}), ElementsAreArray({ DoubleNear(0.14168162686419136, 1.0e-7), DoubleNear(0.12125106987822037, 1.0e-7), DoubleNear(0.12905637038196854, 1.0e-7), DoubleNear(0.1084292373321285, 1.0e-7), DoubleNear(0.1415116554589537, 1.0e-7), DoubleNear(0.12099669829785271, 1.0e-7), DoubleNear(0.1288861453270141, 1.0e-7), DoubleNear(0.10818719645966934, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, false, false, true, true}), Matrix({ { 0.13461725251565426 + 1.0909784360635388e-18i, -0.005083502905092245 + -0.0069746739181996125i, 0.0013422427975189584 + -0.0018359629849965626i, -0.00043410340375282547 + 0.001572792552697625i, 7.848386213231615e-05 + 0.00010632493692766095i, -1.727068996520558e-05 + -2.2960616789286383e-05i, 3.8959401407575715e-05 + 0.00027413282520168385i, 4.87359175626143e-05 + 3.628954076407071e-05i }, { -0.005083502905092244 + 0.0069746739181996125i, 0.11159736804938117 + 8.139986623113826e-19i, -0.0005123740990124497 + 0.0012500536758420565i, -0.00021251589962630827 + 0.00023046661318721316i, -2.980982437304463e-05 + 1.325441635575519e-05i, 9.06724839564468e-05 + 9.833956341188713e-05i, -5.4487665123238145e-05 + 4.28955530582223e-05i, -4.338596209417641e-05 + -0.0002663183467471462i }, { 0.0013422427975189571 + 0.001835962984996564i, -0.0005123740990124496 + -0.001250053675842057i, 0.13612074473050562 + 1.2400562347802957e-18i, -0.004507128751957049 + -0.007228127085592766i, 4.3978611002667194e-05 + -0.0002709539082223025i, -4.9690654016989024e-05 + -4.695312981322926e-05i, 0.0002645232315515209 + 0.00011175279609433475i, 2.9606550574399576e-05 + -4.171682421284119e-05i }, { -0.00043410340375282563 + -0.0015727925526976248i, -0.00021251589962631 + -0.00023046661318721338i, -0.004507128751957049 + 0.0072281270855927655i, 0.11808293916096771 + -7.657177843178875e-19i, 5.429037869993589e-05 + -3.449330014546835e-05i, -4.9668698696966135e-05 + 0.00026321041350662683i, 1.2880254152785764e-05 + 3.6393281094816676e-05i, -0.00010309458869574468 + 0.00010609523601435891i }, { 7.848386213231613e-05 + -0.00010632493692766137i, -2.9809824373044704e-05 + -1.3254416355755132e-05i, 4.3978611002667235e-05 + 0.0002709539082223025i, 5.4290378699935916e-05 + 3.449330014546839e-05i, 0.13442165384378926 + -9.147955830346444e-20i, -0.0050795160096134395 + -0.006988720029172172i, 0.0013291336919590258 + -0.0017849896874850932i, -0.0004414857133048207 + 0.001572223696590601i }, { -1.7270689965205475e-05 + 2.2960616789286465e-05i, 9.067248395644672e-05 + -9.833956341188734e-05i, -4.969065401698898e-05 + 4.695312981322928e-05i, -4.966869869696622e-05 + -0.00026321041350662683i, -0.005079516009613439 + 0.006988720029172172i, 0.11136789708834516 + -1.1350241493207625e-19i, -0.0004964883703747903 + 0.0012384009203201206i, -0.0002017045766190364 + 0.00017946766558131553i }, { 3.895940140757568e-05 + -0.00027413282520168385i, -5.448766512323817e-05 + -4.289555305822232e-05i, 0.00026452323155152087 + -0.00011175279609433524i, 1.2880254152785669e-05 + -3.639328109481663e-05i, 0.0013291336919590262 + 0.0017849896874850926i, -0.0004964883703747901 + -0.0012384009203201209i, 0.13597614694217852 + -2.846030702774449e-19i, -0.004507588100959866 + -0.007223342240589064i }, { 4.873591756261427e-05 + -3.628954076407068e-05i, -4.3385962094176305e-05 + 0.0002663183467471461i, 2.9606550574399684e-05 + 4.171682421284127e-05i, -0.00010309458869574471 + -0.0001060952360143591i, -0.0004414857133048207 + -0.001572223696590601i, -0.0002017045766190364 + -0.00017946766558131575i, -0.004507588100959865 + 0.007223342240589065i, 0.11781599766917689 + -5.353248226647178e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, false, false, true, true}), ElementsAreArray({ DoubleNear(0.13461725251565426, 1.0e-7), DoubleNear(0.11159736804938117, 1.0e-7), DoubleNear(0.13612074473050562, 1.0e-7), DoubleNear(0.11808293916096771, 1.0e-7), DoubleNear(0.13442165384378926, 1.0e-7), DoubleNear(0.11136789708834516, 1.0e-7), DoubleNear(0.13597614694217852, 1.0e-7), DoubleNear(0.11781599766917689, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, true, true, false, false, false}), Matrix({ { 0.13000676368348904 + -3.5067164016328034e-19i, 2.498721922231872e-05 + 0.0001480208102288693i, -0.01901959134033258 + -0.0037778690399188114i, 1.3797266773386392e-05 + 3.979726913001203e-06i, 0.0001636890353607154 + -0.006179027152564357i, 1.1310557886894218e-05 + -3.454880929827115e-05i, -0.0023748186335975463 + -0.002917495343445358i, 6.444806203623925e-06 + 2.188252683317382e-05i }, { 2.4987219222318707e-05 + -0.0001480208102288693i, 0.1353433174561046 + -1.0672615135404184e-19i, -3.918986253800889e-05 + -9.45560501835893e-06i, -0.016664985315363735 + -0.006634767101903486i, -3.5369111703028452e-06 + 3.653806614875368e-05i, -0.0018110851048530171 + -0.006969368017006232i, -2.666814440589611e-05 + -1.634123779514968e-05i, -0.0006838900248663562 + -0.0035160399748707504i }, { -0.01901959134033258 + 0.003777869039918811i, -3.918986253800889e-05 + 9.455605018358926e-06i, 0.11051990753207908 + 8.283982224147057e-19i, 2.155401907408471e-05 + 6.62504217282896e-05i, 0.0036365137155498738 + -0.0001556266928536954i, -2.73870853818548e-06 + 1.6197089030239525e-05i, -0.004636557928018934 + 0.00966546232659118i, 8.677983219132942e-06 + -8.580193242282432e-06i }, { 1.3797266773386392e-05 + -3.9797269130012e-06i, -0.016664985315363735 + 0.006634767101903487i, 2.1554019074084676e-05 + -6.625042172828963e-05i, 0.1076765166343 + 1.1231656880592022e-18i, -1.1282556440782675e-05 + -2.6842484537558566e-05i, 0.0048857579116704875 + -0.0007861626546010117i, -4.793337261517023e-06 + -3.7380795108076174e-06i, -0.004039140472164873 + 0.008036651682711825i }, { 0.0001636890353607179 + 0.006179027152564359i, -3.5369111703028554e-06 + -3.653806614875368e-05i, 0.0036365137155498746 + 0.0001556266928536957i, -1.1282556440782668e-05 + 2.6842484537558573e-05i, 0.13019441765955436 + 3.7100043089738355e-19i, 2.19986906453821e-05 + 0.0001741709691738386i, -0.015613714956827182 + 0.004111270679505027i, 1.0729224050140852e-05 + -2.174150473917635e-05i }, { 1.1310557886894235e-05 + 3.4548809298271155e-05i, -0.0018110851048530163 + 0.00696936801700623i, -2.7387085381854824e-06 + -1.6197089030239525e-05i, 0.0048857579116704875 + 0.0007861626546010119i, 2.1998690645381937e-05 + -0.0001741709691738386i, 0.14003684242064285 + -2.591920818598159e-19i, -2.3897027723965622e-05 + -1.4605520852889058e-06i, -0.015701712014777602 + 0.0006116384227252613i }, { -0.0023748186335975467 + 0.002917495343445358i, -2.6668144405896105e-05 + 1.634123779514968e-05i, -0.004636557928018932 + -0.00966546232659118i, -4.793337261517008e-06 + 3.7380795108076216e-06i, -0.015613714956827182 + -0.004111270679505026i, -2.3897027723965625e-05 + 1.4605520852889092e-06i, 0.12429197329303568 + -4.472333961502706e-19i, 1.3760743378175596e-05 + 8.332344787126091e-05i }, { 6.444806203623918e-06 + -2.1882526833173825e-05i, -0.0006838900248663561 + 0.00351603997487075i, 8.677983219132938e-06 + 8.580193242282428e-06i, -0.00403914047216487 + -0.008036651682711825i, 1.072922405014086e-05 + 2.1741504739176345e-05i, -0.015701712014777602 + -0.0006116384227252611i, 1.3760743378175575e-05 + -8.332344787126094e-05i, 0.12193026132079299 + 1.9566461081574338e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, true, true, false, false, false}), ElementsAreArray({ DoubleNear(0.13000676368348904, 1.0e-7), DoubleNear(0.1353433174561046, 1.0e-7), DoubleNear(0.11051990753207908, 1.0e-7), DoubleNear(0.1076765166343, 1.0e-7), DoubleNear(0.13019441765955436, 1.0e-7), DoubleNear(0.14003684242064285, 1.0e-7), DoubleNear(0.12429197329303568, 1.0e-7), DoubleNear(0.12193026132079299, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, true, false, true, false, false}), Matrix({ { 0.1366891293303766 + 1.395910297075087e-18i, 2.434449150711063e-05 + 0.00016753864268011608i, -0.018210026957972497 + 0.00020976211315298286i, 1.3432545155653028e-05 + -9.32417827825087e-06i, 0.020718604973181644 + 0.006490914324462357i, -8.445156663128398e-07 + 2.886793923229496e-05i, -0.002520148438659601 + -0.0012682431999484968i, 3.402058047325933e-06 + -8.111643235009783e-07i }, { 2.4344491507110547e-05 + -0.0001675386426801161i, 0.14465302165069316 + 1.2874900798265365e-19i, -3.329548028980056e-05 + -6.122863985752018e-06i, -0.01701922297620622 + -0.0031325775858874446i, 9.56840259234432e-06 + -2.5247048394817736e-05i, 0.02191452546474424 + 0.006921821323013964i, -4.1491003825662455e-06 + 7.944657306515011e-07i, -0.0022225693509405056 + -0.0016992446032773718i }, { -0.018210026957972497 + -0.00020976211315298248i, -3.329548028980055e-05 + 6.122863985752018e-06i, 0.12341071553993657 + 1.3213713977167085e-19i, 1.8644253407208147e-05 + 8.019355958474639e-05i, -0.0033079833436377264 + -0.0007075919360032916i, -5.132197306294349e-06 + 3.7407567857974367e-07i, 0.01810157967210861 + 0.005113063161303506i, -2.7054266702109823e-06 + 1.1302259412149433e-05i }, { 1.3432545155653036e-05 + 9.324178278250866e-06i, -0.01701922297620622 + 0.0031325775858874446i, 1.864425340720812e-05 + -8.019355958474643e-05i, 0.12068818397821177 + 1.6601845766184287e-19i, 5.415763662963295e-07 + 4.128499054587902e-06i, -0.0032184800502587222 + -0.0002031134578978358i, 9.891552824992587e-06 + -6.890458119674119e-06i, 0.017621427641465875 + 0.004941347337259248i }, { 0.020718604973181644 + -0.006490914324462357i, 9.568402592344336e-06 + 2.5247048394817736e-05i, -0.0033079833436377264 + 0.0007075919360032917i, 5.415763662963273e-07 + -4.128499054587903e-06i, 0.12351205201266682 + -1.3755815063409838e-18i, 2.264141836059019e-05 + 0.00015465313672259178i, -0.016423279339187268 + 0.0001236395264332332i, 1.1093945667874217e-05 + -8.437599547924276e-06i }, { -8.445156663128296e-07 + -2.886793923229496e-05i, 0.021914525464744237 + -0.006921821323013965i, -5.132197306294348e-06 + -3.7407567857974155e-07i, -0.0032184800502587222 + 0.00020311345789783563i, 2.264141836059011e-05 + -0.00015465313672259176i, 0.13072713822605425 + -4.946672411965114e-19i, -2.9791409972173956e-05 + -4.793293117895817e-06i, -0.015347474353935114 + -0.0028905510932907804i }, { -0.002520148438659601 + 0.0012682431999484975i, -4.149100382566245e-06 + -7.944657306515028e-07i, 0.01810157967210861 + -0.005113063161303506i, 9.891552824992592e-06 + 6.890458119674127e-06i, -0.016423279339187268 + -0.0001236395264332327i, -2.9791409972173963e-05 + 4.79329311789582e-06i, 0.11140116528517816 + 2.490276864927643e-19i, 1.6670509045052145e-05 + 6.938031001480414e-05i }, { 3.4020580473259366e-06 + 8.111643235009781e-07i, -0.0022225693509405064 + 0.0016992446032773724i, -2.7054266702109882e-06 + -1.1302259412149437e-05i, 0.017621427641465875 + -0.004941347337259249i, 1.1093945667874219e-05 + 8.437599547924278e-06i, -0.015347474353935112 + 0.0028905510932907812i, 1.667050904505213e-05 + -6.938031001480414e-05i, 0.10891859397688122 + 1.1528118412131028e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, true, false, true, false, false}), ElementsAreArray({ DoubleNear(0.1366891293303766, 1.0e-7), DoubleNear(0.14465302165069316, 1.0e-7), DoubleNear(0.12341071553993657, 1.0e-7), DoubleNear(0.12068818397821177, 1.0e-7), DoubleNear(0.12351205201266682, 1.0e-7), DoubleNear(0.13072713822605425, 1.0e-7), DoubleNear(0.11140116528517816, 1.0e-7), DoubleNear(0.10891859397688122, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, true, false, false, true, false}), Matrix({ { 0.12925183224287634 + 6.844026213814747e-19i, 2.4023238077714427e-05 + 0.00016076289245115944i, -0.01752615598235805 + -0.0009093708197865735i, 1.4392900431080021e-05 + -1.3023496833999106e-05i, 0.001196758853044341 + -0.0007228652340788748i, -1.3040443614652062e-06 + 2.433333183558233e-06i, -0.0003055946642925645 + -0.0004682664114977022i, 1.439045541322286e-06 + -2.454067717633843e-06i }, { 2.4023238077714346e-05 + -0.00016076289245115942i, 0.1370523652816254 + -4.0657581468206416e-20i, -2.7647866946498963e-05 + -3.705204806234915e-06i, -0.016487385588172775 + -0.003921323902161054i, 3.208013002268684e-06 + -2.8736287616534693e-06i, 0.0013258806070352185 + -0.0007410676391810235i, 2.3064945765455668e-08 + 7.931400045415532e-07i, -0.0003304201815056548 + -0.0004364834740875514i }, { -0.01752615598235805 + 0.0009093708197865738i, -2.7647866946498963e-05 + 3.705204806234918e-06i, 0.11416389302044189 + 5.505714157152952e-19i, 2.0331532593669503e-05 + 7.230829455608079e-05i, -0.00037936345651542265 + 0.0005934659514619664i, 2.0834725955937814e-06 + -1.611935310284067e-06i, -8.537176096049914e-05 + -0.0008861318098219351i, 6.031940628194555e-06 + -2.852382087196454e-06i }, { 1.4392900431080025e-05 + 1.3023496833999106e-05i, -0.016487385588172775 + 0.003921323902161054i, 2.0331532593669483e-05 + -7.230829455608082e-05i, 0.11153608095222622 + 5.056786695108173e-19i, -1.3723523289598514e-08 + 1.6577264638892901e-06i, -0.0003570120421080469 + 0.0005443393207463613i, -2.813621946500429e-06 + 1.6935527651920675e-06i, -0.0001801116858864214 + -0.0008609537106312932i }, { 0.0011967588530443383 + 0.0007228652340788746i, 3.2080130022686746e-06 + 2.8736287616534676e-06i, -0.00037936345651542276 + -0.0005934659514619661i, -1.3723523289596397e-08 + -1.6577264638892942e-06i, 0.1309493491001671 + -6.640738306473715e-19i, 2.2962671789986393e-05 + 0.00016142888695154842i, -0.017107150314801717 + 0.0012427724593727894i, 1.0133590392447224e-05 + -4.73828099217604e-06i }, { -1.3040443614652121e-06 + -2.433333183558227e-06i, 0.001325880607035221 + 0.0007410676391810232i, 2.0834725955937776e-06 + 1.6119353102840626e-06i, -0.00035701204210804717 + -0.0005443393207463609i, 2.2962671789986312e-05 + -0.00016142888695154848i, 0.138327794595122 + -3.2526065174565133e-19i, -3.543902331547555e-05 + -7.210952297412924e-06i, -0.01587931174196856 + -0.0021018047770171707i }, { -0.00030559466429256493 + 0.00046826641149770186i, 2.3064945765452703e-08 + -7.931400045415504e-07i, -8.537176096049914e-05 + 0.0008861318098219351i, -2.8136219465004375e-06 + -1.693552765192068e-06i, -0.017107150314801714 + -0.001242772459372789i, -3.543902331547555e-05 + 7.210952297412924e-06i, 0.12064798780467287 + -1.6940658945086007e-19i, 1.4983229858590802e-05 + 7.726557504346974e-05i }, { 1.4390455413222914e-06 + 2.454067717633845e-06i, -0.00033042018150565447 + 0.0004364834740875508i, 6.031940628194554e-06 + 2.852382087196459e-06i, -0.0001801116858864227 + 0.0008609537106312949i, 1.013359039244723e-05 + 4.738280992176039e-06i, -0.015879311741968563 + 0.0021018047770171716i, 1.4983229858590775e-05 + -7.726557504346975e-05i, 0.11807069700286676 + 8.131516293641283e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, true, false, false, true, false}), ElementsAreArray({ DoubleNear(0.12925183224287634, 1.0e-7), DoubleNear(0.1370523652816254, 1.0e-7), DoubleNear(0.11416389302044189, 1.0e-7), DoubleNear(0.11153608095222622, 1.0e-7), DoubleNear(0.1309493491001671, 1.0e-7), DoubleNear(0.138327794595122, 1.0e-7), DoubleNear(0.12064798780467287, 1.0e-7), DoubleNear(0.11807069700286676, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, true, false, false, false, true}), Matrix({ { 0.11813906928831591 + 1.7381116077658243e-18i, 0.0002527937501017713 + 0.0001372886177825913i, -0.01573222161449046 + 0.00019379389920743707i, 2.22174799518716e-06 + -2.5505198319970313e-05i, 2.276096091416257e-05 + -6.007880882523578e-05i, 0.00511306600258362 + 0.006944229897009349i, -1.3964155590338304e-05 + -3.106632636690193e-05i, 0.0008755780627865473 + -5.442407206625641e-05i }, { 0.0002527937501017712 + -0.00013728861778259136i, 0.1503252946789914 + -6.522153693858113e-19i, -1.4309221435076402e-05 + -5.239117371101299e-05i, -0.017646943758823037 + -0.00331552816761922i, 0.00600287331538521 + -0.008442490037825693i, 0.0001714987757182085 + 0.0002504661770735346i, -0.0026200063480608356 + -0.00020725808486740852i, -1.9988442144042897e-05 + -4.7274352691571405e-05i }, { -0.01573222161449046 + -0.0001937938992074369i, -1.4309221435076399e-05 + 5.2391173711012995e-05i, 0.10659940563638828 + 8.724439356719293e-19i, 0.00011950768458153236 + 6.358436130653163e-05i, 2.9694236581298887e-05 + -1.760819798213965e-05i, -0.002218492564834832 + 0.00020547105058468597i, -1.910645323310752e-05 + 5.227876198512948e-06i, 0.004288302267332346 + 0.0013073730036610451i }, { 2.2217479951871693e-06 + 2.5505198319970313e-05i, -0.017646943758823037 + 0.00331552816761922i, 0.00011950768458153234 + -6.358436130653167e-05i, 0.12535453485281317 + 4.2097537478538727e-19i, 0.0010553596661374736 + 0.00011757046044579793i, -4.90024964153151e-05 + -4.340898571669631e-05i, 0.004937665517941636 + -0.0017355537989523673i, 0.00015543170554527561 + 0.0002268972880014299i }, { 2.2760960914162424e-05 + 6.007880882523548e-05i, 0.00600287331538521 + 0.008442490037825693i, 2.96942365812989e-05 + 1.760819798213971e-05i, 0.0010553596661374734 + -0.0001175704604457978i, 0.14206211205472752 + -1.717782817031721e-18i, -0.0002058078402340705 + 0.00018490316162011656i, -0.01890108468266931 + 0.00013960774037877894i, 2.2304742828340087e-05 + 7.743420493795166e-06i }, { 0.00511306600258362 + -0.006944229897009348i, 0.00017149877571820854 + -0.000250466177073535i, -0.0022184925648348324 + -0.00020547105058468578i, -4.9002496415315094e-05 + 4.340898571669637e-05i, -0.00020580784023407054 + -0.00018490316162011653i, 0.12505486519775605 + 2.862971361719535e-19i, -4.877766882689811e-05 + 4.147501660736515e-05i, -0.014719753571318299 + -0.0027076005115590053i }, { -1.3964155590338306e-05 + 3.106632636690198e-05i, -0.0026200063480608356 + 0.0002072580848674086i, -1.9106453233107576e-05 + -5.2278761985133035e-06i, 0.004937665517941636 + 0.0017355537989523669i, -0.018901084682669305 + -0.0001396077403787784i, -4.877766882689812e-05 + -4.147501660736515e-05i, 0.12821247518872647 + -4.912791094074942e-19i, -8.419292212927205e-05 + 8.598950829301889e-05i }, { 0.0008755780627865476 + 5.442407206625632e-05i, -1.99884421440429e-05 + 4.7274352691571486e-05i, 0.004288302267332346 + -0.0013073730036610458i, 0.00015543170554527561 + -0.00022689728800143026i, 2.2304742828340084e-05 + -7.743420493795167e-06i, -0.0147197535713183 + 0.0027076005115590058i, -8.419292212927208e-05 + -8.59895082930189e-05i, 0.10425224310227982 + 8.978549240895584e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, true, false, false, false, true}), ElementsAreArray({ DoubleNear(0.11813906928831591, 1.0e-7), DoubleNear(0.1503252946789914, 1.0e-7), DoubleNear(0.10659940563638828, 1.0e-7), DoubleNear(0.12535453485281317, 1.0e-7), DoubleNear(0.14206211205472752, 1.0e-7), DoubleNear(0.12505486519775605, 1.0e-7), DoubleNear(0.12821247518872647, 1.0e-7), DoubleNear(0.10425224310227982, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, true, true, false, false}), Matrix({ { 0.12636483349391703 + 5.251604272976662e-19i, 2.4864126982375188e-05 + 0.00011501782730370333i, -0.0021557875268014793 + 0.0018769889631661011i, 9.618034611648437e-06 + -2.3531535077086492e-05i, 0.019129034421463922 + 0.005521283231405966i, 3.3469926535082213e-07 + 1.3567578859350055e-05i, -0.000744695200047547 + -0.0029584794643632128i, -1.1032624350856339e-07 + -7.466278311514298e-07i }, { 2.4864126982375147e-05 + -0.00011501782730370335i, 0.12772451386254255 + 4.438452643612534e-19i, -4.5418806344936715e-06 + 1.7858300876166993e-05i, -0.0028892353295220247 + 0.0006366028037226393i, 7.628324033835827e-06 + -8.560328258486222e-06i, 0.018855780039540623 + 0.005140203307970914i, 1.8042982685239215e-06 + -1.1771613800476456e-06i, -0.0003727675888209053 + -0.00297914500273626i }, { -0.002155787526801478 + -0.0018769889631661i, -4.5418806344936715e-06 + -1.7858300876166996e-05i, 0.13373501137639618 + 1.0028870095490916e-18i, 1.8124617931943588e-05 + 0.00013271437496115913i, -0.002932683205040717 + -0.0009220026645481905i, -6.712195733118039e-06 + -3.522218844297673e-06i, 0.01969115022382633 + 0.006082694254359896i, -3.884641601874642e-06 + 2.6602619785094338e-05i }, { 9.618034611648444e-06 + 2.353153507708649e-05i, -0.002889235329522023 + -0.0006366028037226401i, 1.812461793194352e-05 + -0.00013271437496115916i, 0.1376166917663624 + -1.4907779871675686e-19i, 5.49372663864315e-06 + 5.147043996902154e-06i, -0.002872513355926587 + -0.00035415511016884577i, 1.183163138350108e-05 + -2.3577178256005634e-05i, 0.020680173066669492 + 0.006722965352302298i }, { 0.01912903442146392 + -0.005521283231405967i, 7.628324033835838e-06 + 8.560328258486219e-06i, -0.002932683205040717 + 0.0009220026645481913i, 5.49372663864315e-06 + -5.1470439969021536e-06i, 0.11416183772165109 + -4.743384504624082e-20i, 2.1677111314028256e-05 + 9.925340465345558e-05i, -0.00231708136585674 + 0.0016094462108607237i, 1.0370506494378725e-05 + -1.9597467463467087e-05i }, { 3.3469926535082043e-07 + -1.356757885935006e-05i, 0.018855780039540623 + -0.005140203307970916i, -6.712195733118039e-06 + 3.522218844297671e-06i, -0.002872513355926588 + 0.0003541551101688466i, 2.1677111314028222e-05 + -9.925340465345558e-05i, 0.11529532022786206 + 5.72594272343907e-19i, -3.7883677973261932e-06 + 1.4941685761779066e-05i, -0.002960990247495865 + 0.00043068086198295476i }, { -0.0007446952000475459 + 0.0029584794643632128i, 1.8042982685239211e-06 + 1.177161380047644e-06i, 0.019691150223826333 + -0.006082694254359896i, 1.1831631383501089e-05 + 2.3577178256005644e-05i, -0.0023170813658567367 + -0.0016094462108607226i, -3.788367797326195e-06 + -1.4941685761779066e-05i, 0.12075137957619386 + -1.0791199748019786e-18i, 1.7634816091614087e-05 + 0.00012478004208394034i }, { -1.1032624350856699e-07 + 7.466278311514309e-07i, -0.0003727675888209048 + 0.002979145002736259i, -3.884641601874638e-06 + -2.660261978509434e-05i, 0.020680173066669492 + -0.006722965352302299i, 1.0370506494378726e-05 + 1.9597467463467094e-05i, -0.0029609902474958634 + -0.00043068086198295487i, 1.7634816091614033e-05 + -0.00012478004208394034i, 0.12435041197507343 + 8.555032767268433e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, true, true, false, false}), ElementsAreArray({ DoubleNear(0.12636483349391703, 1.0e-7), DoubleNear(0.12772451386254255, 1.0e-7), DoubleNear(0.13373501137639618, 1.0e-7), DoubleNear(0.1376166917663624, 1.0e-7), DoubleNear(0.11416183772165109, 1.0e-7), DoubleNear(0.11529532022786206, 1.0e-7), DoubleNear(0.12075137957619386, 1.0e-7), DoubleNear(0.12435041197507343, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, true, false, true, false}), Matrix({ { 0.11676186475633521 + 6.606856988583543e-19i, 2.505763374445677e-05 + 9.531629772675825e-05i, -0.008113338163769312 + -0.0009255270795856512i, 1.3055186385273925e-05 + -1.8950600167993895e-05i, 0.0003876012492232872 + -0.0009556368097373418i, 6.062232929167081e-06 + -8.128171311414182e-06i, -0.0027353940826569424 + -0.0022951088040203656i, 3.82069047324541e-06 + 9.250095467259396e-07i }, { 2.5057633744456735e-05 + -9.531629772675825e-05i, 0.11686796570632543 + 8.199278929421627e-19i, -1.0431249860067334e-05 + 1.062110127000433e-05i, -0.008039104881505318 + -0.0024031358958966527i, -3.8770366836095915e-06 + 6.341873618693015e-06i, -0.0003366744590663634 + -0.0010671352734652633i, -5.0869457902788295e-06 + -3.163117866268499e-06i, -0.002227262834427233 + -0.0024201073621676105i }, { -0.008113338163769312 + 0.0009255270795856532i, -1.0431249860067334e-05 + -1.0621101270004332e-05i, 0.12665386050698302 + 5.742883382384156e-19i, 1.929713692692717e-05 + 0.00013775488928048199i, -0.0031317589829305617 + 0.0012127660537409087i, -2.0167052530040607e-06 + 2.0549412229291903e-06i, 0.0007237858428605546 + -0.0006533602341634681i, -1.3343366624377342e-06 + 7.709122407775963e-06i }, { 1.3055186385273925e-05 + 1.8950600167993895e-05i, -0.008039104881505315 + 0.002403135895896652i, 1.9297136926927087e-05 + -0.00013775488928048196i, 0.13172048052752622 + -3.5490680489955184e-19i, 4.934982635341912e-07 + -1.1842758161282778e-06i, -0.002694652816860009 + 0.0014877256179778706i, 4.271427739377846e-06 + -7.521949615154417e-06i, 0.00148244338021516 + -0.0005348860763470533i }, { 0.0003876012492232848 + 0.000955636809737342i, -3.877036683609594e-06 + -6.3418736186930195e-06i, -0.0031317589829305626 + -0.0012127660537409087i, 4.934982635341972e-07 + 1.184275816128277e-06i, 0.1237648064592329 + -1.8295911660692887e-19i, 2.1483604551946668e-05 + 0.00011895493423040065i, 0.003640469271111094 + 0.004411962253612477i, 6.933354720753236e-06 + -2.4178402372559684e-05i }, { 6.062232929167084e-06 + 8.128171311414182e-06i, -0.00033667445906636426 + 0.001067135273465265i, -2.0167052530040602e-06 + -2.0549412229291937e-06i, -0.002694652816860009 + -0.0014877256179778716i, 2.1483604551946628e-05 + -0.00011895493423040068i, 0.12615186838407916 + 1.9651164376299768e-19i, 2.101001428247468e-06 + 2.217888536794173e-05i, 0.0021888793044874274 + 0.003470419561602247i }, { -0.0027353940826569416 + 0.002295108804020366i, -5.086945790278834e-06 + 3.163117866268499e-06i, 0.0007237858428605544 + 0.0006533602341634674i, 4.27142773937783e-06 + 7.521949615154419e-06i, 0.003640469271111096 + -0.004411962253612476i, 2.1010014282474695e-06 + -2.2178885367941728e-05i, 0.12783253044560705 + -6.505213034913027e-19i, 1.6462297096630506e-05 + 0.0001197395277646175i }, { 3.820690473245416e-06 + -9.250095467259404e-07i, -0.0022272628344272324 + 0.0024201073621676105i, -1.334336662437741e-06 + -7.709122407775953e-06i, 0.0014824433802151625 + 0.0005348860763470531i, 6.933354720753245e-06 + 2.4178402372559687e-05i, 0.0021888793044874295 + -0.0034704195616022467i, 1.646229709663044e-05 + -0.00011973952776461752i, 0.1302466232139096 + 2.913793338554793e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, true, false, true, false}), ElementsAreArray({ DoubleNear(0.11676186475633521, 1.0e-7), DoubleNear(0.11686796570632543, 1.0e-7), DoubleNear(0.12665386050698302, 1.0e-7), DoubleNear(0.13172048052752622, 1.0e-7), DoubleNear(0.1237648064592329, 1.0e-7), DoubleNear(0.12615186838407916, 1.0e-7), DoubleNear(0.12783253044560705, 1.0e-7), DoubleNear(0.1302466232139096, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, true, false, false, true}), Matrix({ { 0.10920376132224377 + 2.1158883022412422e-18i, 0.00017365804139390348 + 8.266723057160906e-05i, -0.002053225867110637 + 0.0015889984349938525i, -2.306568312660908e-05 + -3.6088156940573056e-05i, -1.3590454851222132e-05 + -7.229409771604545e-07i, 0.004333086868267441 + 0.004169208132381782i, -1.778059118881796e-05 + 1.789056820875638e-05i, 0.0007577151674583862 + -0.0005232480799675911i }, { 0.00017365804139390345 + -8.266723057160909e-05i, 0.132668015784625 + 4.3198680309969317e-19i, -2.7064291815576047e-05 + 1.3180920016118042e-05i, -0.003160567286285893 + 0.0005893626804901421i, 0.005040950426389543 + -0.0051717667179258285i, 0.0001564720949023779 + 0.00023510478943476276i, -0.0005594262196793435 + 0.0005414379706008515i, 4.136175483165988e-06 + 4.213234622022477e-06i }, { -0.0020532258671106343 + -0.0015889984349938522i, -2.706429181557605e-05 + -1.3180920016118037e-05i, 0.11553471360246043 + 4.946672411965114e-19i, 0.00019864339328940015 + 0.0001182057485175139i, -1.4100766589800892e-06 + 2.825773959805697e-05i, -0.000465598813369958 + -0.00047298756172263235i, 1.7244962532277182e-05 + -5.4127991649562384e-05i, 0.005068281401648525 + 0.004082394768288613i }, { -2.3065683126609083e-05 + 3.6088156940573056e-05i, -0.0031605672862858904 + -0.0005893626804901418i, 0.00019864339328940007 + -0.00011820574851751393i, 0.14301181374717956 + -6.632267977001172e-19i, 0.0008897106112759434 + 0.000608562926656116i, 2.8617588830306002e-06 + 4.49674709641853e-06i, 0.005899588406937302 + -0.005006277118852231i, 0.00017045838636110618 + 0.0002422586756402018i }, { -1.3590454851222192e-05 + 7.229409771602089e-07i, 0.005040950426389542 + 0.005171766717925827i, -1.4100766589800841e-06 + -2.825773959805697e-05i, 0.000889710611275944 + -0.0006085629266561164i, 0.13132290989332435 + -1.6381617199898169e-18i, -0.00012711680309750005 + 0.00013160400138554983i, -0.002419643025547582 + 0.0018974367390329726i, 4.305422423263624e-05 + -7.040845599980526e-06i }, { 0.004333086868267442 + -0.004169208132381783i, 0.00015647209490237798 + -0.00023510478943476303i, -0.000465598813369958 + 0.0004729875617226321i, 2.8617588830306155e-06 + -4.496747096418532e-06i, -0.0001271168030975001 + -0.00013160400138554986i, 0.1103518183057796 + 5.844527336054672e-19i, 1.873404338375618e-05 + 1.961906662182802e-05i, -0.0026896582907319972 + 0.00047792098521545214i }, { -1.7780591188817968e-05 + -1.7890568208756342e-05i, -0.0005594262196793423 + -0.0005414379706008516i, 1.724496253227704e-05 + 5.4127991649561964e-05i, 0.005899588406937303 + 0.005006277118852233i, -0.0024196430255475805 + -0.0018974367390329704i, 1.8734043383756186e-05 + -1.9619066621828025e-05i, 0.13895167735012964 + -5.709002064493984e-19i, -0.0001628839592658425 + 0.00013928866852758558i }, { 0.0007577151674583861 + 0.0005232480799675912i, 4.136175483165973e-06 + -4.213234622022443e-06i, 0.005068281401648524 + -0.004082394768288611i, 0.0001704583863611062 + -0.00024225867564020223i, 4.3054224232636255e-05 + 7.040845599980533e-06i, -0.0026896582907319955 + -0.0004779209852154528i, -0.00016288395926584255 + -0.00013928866852758556i, 0.11895528999425627 + 5.996993266560446e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, true, false, false, true}), ElementsAreArray({ DoubleNear(0.10920376132224377, 1.0e-7), DoubleNear(0.132668015784625, 1.0e-7), DoubleNear(0.11553471360246043, 1.0e-7), DoubleNear(0.14301181374717956, 1.0e-7), DoubleNear(0.13132290989332435, 1.0e-7), DoubleNear(0.1103518183057796, 1.0e-7), DoubleNear(0.13895167735012964, 1.0e-7), DoubleNear(0.11895528999425627, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, false, true, true, false}), Matrix({ { 0.11596789327192146 + 1.866860615748478e-18i, 2.1659580603899462e-05 + 0.00011106678565192859i, 0.011826914273213635 + 0.013873836954795174i, -9.477610561251284e-06 + 1.4321431258398464e-05i, -0.005330333837775526 + -0.003277752416881315i, 4.504812170598133e-06 + -7.804077759119265e-06i, 0.016069522526666068 + -0.014696682523144754i, 1.8969557876265943e-05 + 1.1585102744350368e-05i }, { 2.165958060389942e-05 + -0.00011106678565192859i, 0.11844338287734947 + -1.9312351197398048e-19i, 1.4938777943714223e-05 + -6.958495623158677e-06i, 0.012043025470824522 + 0.014130719827906504i, -3.113595100803441e-06 + 2.8158039521006188e-06i, -0.005413141187543439 + -0.003416210659361568i, -1.1378856206012037e-05 + -1.6009011840182774e-05i, 0.016271587201367513 + -0.015050977414382376i }, { 0.011826914273213635 + -0.013873836954795174i, 1.4938777943714227e-05 + 6.958495623158685e-06i, 0.12744783199139675 + -6.318865786517081e-19i, 2.269519006748447e-05 + 0.00012200440135531164i, 0.01758539908843061 + 0.021994756885895504i, -1.742851240154686e-05 + 2.3110217342256172e-05i, 0.006441720929859368 + 0.001668755372980505i, 2.2308409613121424e-07 + 7.385028855481044e-06i }, { -9.477610561251281e-06 + -1.4321431258398466e-05i, 0.01204302547082452 + -0.014130719827906505i, 2.2695190067484414e-05 + -0.00012200440135531162i, 0.13014506335650217 + 6.581446000165914e-19i, 2.2792801169164188e-05 + -1.2490321074336515e-05i, 0.018094160135227758 + 0.022390020119425886i, 3.5079861565716967e-06 + -3.995879948562021e-06i, 0.006558910108692235 + 0.0018141893095492516i }, { -0.005330333837775527 + 0.0032777524168813143i, -3.1135951008034554e-06 + -2.81580395210062e-06i, 0.017585399088430608 + -0.021994756885895507i, 2.2792801169164195e-05 + 1.249032107433651e-05i, 0.14413195159839173 + -3.3881317890172014e-19i, 2.13291643104193e-05 + 0.00013666541661293388i, 0.02699327037207662 + -0.002269859469029312i, 5.927668224727465e-06 + 2.584876738604593e-05i }, { 4.504812170598134e-06 + 7.804077759119278e-06i, -0.005413141187543439 + 0.003416210659361566i, -1.7428512401546862e-05 + -2.3110217342256176e-05i, 0.018094160135227758 + -0.022390020119425886i, 2.132916431041926e-05 + -0.00013666541661293394i, 0.14689782275155547 + 4.87890977618477e-19i, 4.521177473622681e-06 + -2.517901089133318e-05i, 0.02749292763538559 + -0.002267551167633292i }, { 0.016069522526666068 + 0.014696682523144752i, -1.137885620601204e-05 + 1.6009011840182777e-05i, 0.006441720929859366 + -0.001668755372980505i, 3.5079861565716916e-06 + 3.99587994856202e-06i, 0.02699327037207662 + 0.002269859469029311i, 4.521177473622698e-06 + 2.517901089133318e-05i, 0.10746538530644822 + -4.946672411965114e-19i, 1.661673733815786e-05 + 0.00010202904538208428i }, { 1.896955787626595e-05 + -1.1585102744350373e-05i, 0.016271587201367517 + 0.015050977414382372i, 2.230840961312083e-07 + -7.385028855481048e-06i, 0.006558910108692238 + -0.0018141893095492477i, 5.927668224727463e-06 + -2.5848767386045934e-05i, 0.02749292763538559 + 0.0022675511676332897i, 1.6616737338157847e-05 + -0.00010202904538208428i, 0.10950066884643331 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, false, true, true, false}), ElementsAreArray({ DoubleNear(0.11596789327192146, 1.0e-7), DoubleNear(0.11844338287734947, 1.0e-7), DoubleNear(0.12744783199139675, 1.0e-7), DoubleNear(0.13014506335650217, 1.0e-7), DoubleNear(0.14413195159839173, 1.0e-7), DoubleNear(0.14689782275155547, 1.0e-7), DoubleNear(0.10746538530644822, 1.0e-7), DoubleNear(0.10950066884643331, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, false, true, false, true}), Matrix({ { 0.11808326345495007 + 1.4941661189565858e-18i, 0.0001946132538469399 + 0.00010566343171328914i, 0.0176174339177577 + 0.005262332807960701i, 2.5603276164817084e-05 + 2.4837101877852305e-05i, 3.4782037886471846e-06 + -2.4327401672433642e-05i, 0.004941333475391628 + 0.004342659358311216i, 6.803136110950755e-06 + 6.255571299225741e-06i, 0.0005240664067753663 + 0.0008312607167936298i }, { 0.00019461325384693984 + -0.00010566343171328918i, 0.14484943328746164 + -4.336808689942018e-19i, 3.271268234040421e-05 + -4.484402635995058e-06i, 0.02158853023455357 + 0.006480846950737524i, 0.0057413862726139004 + -0.005348694911574232i, 0.00017257721649871415 + 0.00024508898181721495i, 0.0010713468984351663 + -0.0005509760935173844i, -1.2101209785027794e-06 + 4.604409097821517e-05i }, { 0.0176174339177577 + -0.0052623328079607i, 3.271268234040421e-05 + 4.48440263599506e-06i, 0.10665521146975411 + 1.1163894244811678e-18i, 0.00017768818083636374 + 9.520954737583382e-05i, -1.7316437354340296e-05 + -4.977137340208175e-06i, 0.0009099997237045911 + 0.00042832122204739643i, 1.7630389240786377e-07 + -3.052353095428919e-05i, 0.004460034794524339 + 0.003908943542359178i }, { 2.5603276164817077e-05 + -2.483710187785231e-05i, 0.02158853023455357 + -0.006480846950737525i, 0.00017768818083636372 + -9.520954737583383e-05i, 0.1308303962443429 + 2.0244087439377778e-19i, 0.0005859020195358647 + -0.0010186392345716304i, 4.279200989485989e-05 + 1.871321096315057e-05i, 0.005199152560712945 + -0.004829348925203827i, 0.00015435326476476993 + 0.0002322744832577496i }, { 3.478203788647093e-06 + 2.4327401672433334e-05i, 0.005741386272613901 + 0.005348694911574233i, -1.731643735434039e-05 + 4.977137340208021e-06i, 0.0005859020195358643 + 0.0010186392345716304i, 0.1420165814153631 + 3.3881317890172014e-20i, -0.00015162450893262114 + 0.00014206877055157334i, 0.021202750727532554 + 0.006341644677805161i, -2.9153218501340905e-05 + 1.533309676659209e-05i }, { 0.004941333475391628 + -0.004342659358311215i, 0.00017257721649871423 + -0.00024508898181721533i, 0.0009099997237045909 + -0.0004283212220473968i, 4.279200989485986e-05 + -1.8713210963150624e-05i, -0.00015162450893262114 + -0.00014206877055157334i, 0.1204917723414433 + 7.284483346386983e-19i, -1.325272692306731e-05 + -2.7653103878496795e-05i, 0.017947422871656547 + 0.005382321709535688i }, { 6.8031361109507615e-06 + -6.255571299225765e-06i, 0.0010713468984351665 + 0.0005509760935173843i, 1.763038924077562e-07 + 3.052353095428884e-05i, 0.005199152560712945 + 0.004829348925203827i, 0.021202750727532554 + -0.006341644677805163i, -1.325272692306729e-05 + 2.7653103878496802e-05i, 0.12825800582809085 + -2.2429432443293873e-18i, -0.0001383762534307214 + 0.00012882389936156208i }, { 0.000524066406775366 + -0.0008312607167936294i, -1.2101209785028235e-06 + -4.604409097821526e-05i, 0.0044600347945243386 + -0.003908943542359179i, 0.00015435326476476998 + -0.0002322744832577499i, -2.9153218501340895e-05 + -1.5333096766592088e-05i, 0.017947422871656547 + -0.00538232170953569i, -0.00013837625343072145 + -0.00012882389936156208i, 0.10881533595859258 + 4.557037256228136e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, false, true, false, true}), ElementsAreArray({ DoubleNear(0.11808326345495007, 1.0e-7), DoubleNear(0.14484943328746164, 1.0e-7), DoubleNear(0.10665521146975411, 1.0e-7), DoubleNear(0.1308303962443429, 1.0e-7), DoubleNear(0.1420165814153631, 1.0e-7), DoubleNear(0.1204917723414433, 1.0e-7), DoubleNear(0.12825800582809085, 1.0e-7), DoubleNear(0.10881533595859258, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, false, false, true, true}), Matrix({ { 0.11049432031986313 + 1.9329291856343134e-18i, 0.00018577500762527186 + 9.674887914233206e-05i, 0.0004954383649923956 + -0.0007331536233527509i, 3.424730960299903e-06 + -2.0077391860252178e-06i, 5.713697859178486e-06 + -3.410980868821969e-05i, 0.004580550656826457 + 0.004076016064251435i, 4.680024185109633e-06 + 5.524481419997649e-06i, 1.0525906537230088e-05 + -3.694095974638716e-05i }, { 0.0001857750076252718 + -9.674887914233207e-05i, 0.1357203002451723 + -2.795208725939191e-20i, -3.9367897286743087e-07 + 3.2721099176254964e-07i, 0.0006342885329002532 + -0.0008723427484565985i, 0.005328795946453379 + -0.005030625036193651i, 0.00016344264822958446 + 0.00023877430902776776i, -4.49032317126495e-05 + -3.878733999474913e-05i, -9.106584871710329e-06 + 2.2899970345399625e-06i }, { 0.0004954383649923939 + 0.0007331536233527523i, -3.9367897286743426e-07 + -3.2721099176255303e-07i, 0.11424415460484105 + 6.776263578034403e-19i, 0.00018652642705803177 + 0.0001041240999467909i, -1.0617318973081082e-05 + -4.868704696815658e-06i, -2.389117781654459e-05 + 4.131470984785178e-05i, -2.0591901781234375e-06 + -2.074112393850314e-05i, 0.00482081761308951 + 0.00417558683641896i }, { 3.4247309602999133e-06 + 2.0077391860252246e-06i, 0.0006342885329002532 + 0.0008723427484565987i, 0.00018652642705803174 + -0.00010412409994679094i, 0.13995952928663224 + -2.0328790734103208e-19i, 2.5922781784608703e-05 + 1.8380591846565406e-05i, 4.927231278782132e-06 + -2.8747900188600163e-06i, 0.0056117428868734665 + -0.005147418800584409i, 0.00016348783303389965 + 0.00023858915604719683i }, { 5.713697859178381e-06 + 3.410980868821936e-05i, 0.005328795946453379 + 0.005030625036193652i, -1.0617318973081082e-05 + 4.8687046968156594e-06i, 2.5922781784608838e-05 + -1.8380591846565406e-05i, 0.13292140494345506 + -6.979551485375435e-19i, -0.00014142023695388795 + 0.00013632230786490818i, 0.0006159487270914464 + -0.0008758434205480591i, 1.3031653064294438e-06 + 1.5886902823869982e-06i }, { 0.004580550656826455 + -0.004076016064251435i, 0.0001634426482295845 + -0.00023877430902776806i, -2.389117781654486e-05 + -4.1314709847851524e-05i, 4.927231278782101e-06 + 2.8747900188600196e-06i, -0.00014142023695388797 + -0.00013632230786490813i, 0.11286814598867935 + 4.929731753020028e-19i, 7.880700286356866e-07 + -1.5072869882239515e-06i, 0.0005114803882485435 + -0.0007296786013557185i }, { 4.680024185109684e-06 + -5.524481419997753e-06i, -4.49032317126498e-05 + 3.8787339994749266e-05i, -2.0591901781235316e-06 + 2.0741123938502822e-05i, 0.0056117428868734665 + 0.005147418800584409i, 0.0006159487270914451 + 0.0008758434205480572i, 7.880700286356705e-07 + 1.5072869882239527e-06i, 0.1373531822999989 + -1.5111067779016718e-18i, -0.0001485805254094546 + 0.00013457036204822726i }, { 1.052590653722998e-05 + 3.694095974638689e-05i, -9.106584871710315e-06 + -2.289997034539988e-06i, 0.0048208176130895095 + -0.0041755868364189595i, 0.0001634878330338997 + -0.00023858915604719718i, 1.3031653064294294e-06 + -1.588690282386994e-06i, 0.0005114803882485452 + 0.0007296786013557197i, -0.00014858052540945462 + -0.00013457036204822726i, 0.11643896231135653 + 6.911788849595091e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, false, false, true, true}), ElementsAreArray({ DoubleNear(0.11049432031986313, 1.0e-7), DoubleNear(0.1357203002451723, 1.0e-7), DoubleNear(0.11424415460484105, 1.0e-7), DoubleNear(0.13995952928663224, 1.0e-7), DoubleNear(0.13292140494345506, 1.0e-7), DoubleNear(0.11286814598867935, 1.0e-7), DoubleNear(0.1373531822999989, 1.0e-7), DoubleNear(0.11643896231135653, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, true, true, false, false}), Matrix({ { 0.13954681497772592 + 3.9302328752599536e-19i, -0.018707996569717323 + -0.0054592693006862035i, -0.0007326009605883435 + -0.006702941996252336i, -0.0016420208388300593 + -0.0034755243534321323i, 0.019341438806942668 + 0.004544971196936744i, -0.003251589918173302 + -0.0020199124281192983i, 0.0021373985096167798 + -0.003698003133231111i, -0.0007545145754095456 + 0.0001052100869770759i }, { -0.01870799656971732 + 0.0054592693006862035i, 0.11454253237873364 + 5.759824041329242e-19i, 0.004284033731998871 + -0.0004973772989516647i, -0.00431242189573516 + 0.009216533763141077i, -0.0036144417235192045 + -0.0007805115131480681i, 0.018643375654061874 + 0.006116515342440136i, 0.0014297777293626427 + 0.0025310873453472304i, -0.0032548612984852317 + -0.0022396213338683616i }, { -0.0007326009605883418 + 0.006702941996252336i, 0.004284033731998871 + 0.0004973772989516649i, 0.14179533600334385 + 1.1316360175317453e-18i, -0.016521253364461398 + 0.002536453827951742i, -0.0024952225618887613 + 0.002520118517287836i, 0.0028127215035625504 + 0.0009065088121059584i, 0.023291691630983217 + 0.008867764450539575i, -0.0014911278714268047 + -0.0009475753751065701i }, { -0.0016420208388300593 + 0.0034755243534321323i, -0.004312421895735158 + -0.009216533763141075i, -0.016521253364461398 + -0.002536453827951741i, 0.1295563671394147 + -2.778268066994105e-19i, 0.00024436155156628105 + -5.601064564731205e-05i, -0.0033099739990785433 + -0.003796276292004872i, -0.002912021670377244 + -0.00013019388075305937i, 0.01707963165951261 + 0.003937895156122619i }, { 0.019341438806942668 + -0.0045449711969367465i, -0.003614441723519204 + 0.0007805115131480679i, -0.0024952225618887617 + -0.0025201185172878345i, 0.000244361551566281 + 5.601064564731198e-05i, 0.1258032661618677 + -8.504210790433175e-19i, -0.016976580085978993 + -0.004953366841136094i, -0.0009147951089039585 + -0.006445453173318252i, -0.0014166878196338432 + -0.002958010964883976i }, { -0.0032515899181733026 + 0.002019912428119299i, 0.018643375654061874 + -0.0061165153424401365i, 0.002812721503562551 + -0.0009065088121059585i, -0.0033099739990785433 + 0.003796276292004873i, -0.016976580085978993 + 0.004953366841136094i, 0.10365389178764545 + 1.3755815063409838e-18i, 0.004238237895221491 + -0.00044441204850304255i, -0.004363276504448646 + 0.00848558024616193i }, { 0.0021373985096167806 + 0.0036980031332311107i, 0.0014297777293626425 + -0.0025310873453472304i, 0.023291691630983213 + -0.008867764450539576i, -0.0029120216703772436 + 0.0001301938807530595i, -0.0009147951089039566 + 0.006445453173318252i, 0.004238237895221491 + 0.0004444120485030428i, 0.12843592407685334 + -1.0198276684941776e-18i, -0.014794173607143388 + 0.002186455274278547i }, { -0.0007545145754095458 + -0.00010521008697707587i, -0.0032548612984852317 + 0.0022396213338683616i, -0.0014911278714268045 + 0.0009475753751065708i, 0.017079631659512613 + -0.003937895156122619i, -0.0014166878196338435 + 0.0029580109648839757i, -0.004363276504448643 + -0.00848558024616193i, -0.014794173607143388 + -0.002186455274278546i, 0.11666586747441395 + 2.625802136488331e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, true, true, false, false}), ElementsAreArray({ DoubleNear(0.13954681497772592, 1.0e-7), DoubleNear(0.11454253237873364, 1.0e-7), DoubleNear(0.14179533600334385, 1.0e-7), DoubleNear(0.1295563671394147, 1.0e-7), DoubleNear(0.1258032661618677, 1.0e-7), DoubleNear(0.10365389178764545, 1.0e-7), DoubleNear(0.12843592407685334, 1.0e-7), DoubleNear(0.11666586747441395, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, true, false, true, false}), Matrix({ { 0.12538402226733597 + 3.3881317890172014e-21i, -0.01893512684432208 + -0.005236885796807211i, -0.0038692269879976814 + -0.01151965840642354i, -0.0009744684107570376 + -0.0012878690811079449i, -0.0020590151176800085 + -0.0013520611795001898i, -0.0010355433792390454 + 8.666593273029771e-05i, -0.0005612489546581937 + -0.0035798535805984123i, -5.012815810310502e-05 + 0.0011075575098977823i }, { -0.01893512684432208 + 0.005236885796807211i, 0.10824580819532467 + 1.4772254600114998e-18i, 0.008494653362999354 + 0.0009035192416741813i, -0.012283216057276948 + 0.008190995430941235i, -0.0009554865570433981 + -0.0001282509689459681i, 0.002109941907836932 + -0.0006707109037024157i, 0.0024451328547174292 + 0.0014477023799977845i, -0.004401407962425982 + -0.0011353625855895638i }, { -0.0038692269879976792 + 0.01151965840642354i, 0.008494653362999356 + -0.0009035192416741813i, 0.1409201752571658 + 6.403569081242511e-19i, -0.015078414726208739 + 0.0004061910748595828i, -0.0013737167370572807 + 0.0029178657880053324i, 0.0026243378328931585 + -0.000645618128570385i, 0.004581654577759569 + -0.00011187169375970933i, 0.00039952853344082625 + -0.0009914158183155514i }, { -0.0009744684107570378 + 0.0012878690811079447i, -0.012283216057276947 + -0.008190995430941234i, -0.015078414726208739 + -0.0004061910748595819i, 0.11745416577734344 + -4.2097537478538727e-19i, 0.00034672546125839805 + -0.0010016181301271453i, -0.00445269506273329 + -0.00021737411628655265i, 0.00021911105841992853 + 0.001266056241154296i, -0.0023754253546838526 + -0.0010763746167508125i }, { -0.0020590151176800107 + 0.00135206117950019i, -0.0009554865570433981 + 0.00012825096894596876i, -0.0013737167370572814 + -0.0029178657880053337i, 0.00034672546125839827 + 0.0010016181301271453i, 0.1399660588722577 + -4.607859233063394e-19i, -0.01674944981137423 + -0.0051757503450150875i, 0.0022218309185053796 + -0.0016287367631470494i, -0.002084240247706865 + -0.005145666237208164i }, { -0.0010355433792390456 + -8.666593273029826e-05i, 0.0021099419078369312 + 0.0006707109037024171i, 0.002624337832893158 + 0.0006456181285703847i, -0.0044526950627332895 + 0.00021737411628655308i, -0.01674944981137423 + 0.0051757503450150875i, 0.1099506159710544 + 4.743384504624082e-19i, 2.761826422100573e-05 + -0.0018453085891288884i, 0.0036075176570931422 + 0.009511118578361772i }, { -0.0005612489546581935 + 0.0035798535805984127i, 0.002445132854717429 + -0.0014477023799977845i, 0.0045816545777595695 + 0.00011187169375970803i, 0.00021911105841992832 + -0.0012660562411542957i, 0.002221830918505381 + 0.0016287367631470499i, 2.7618264221005947e-05 + 0.001845308589128889i, 0.12931108482303139 + -5.285485590866834e-19i, -0.016237012245396046 + 0.004316718027370706i }, { -5.012815810310486e-05 + -0.0011075575098977823i, -0.0044014079624259805 + 0.0011353625855895636i, 0.00039952853344082625 + 0.000991415818315551i, -0.002375425354683853 + 0.001076374616750813i, -0.0020842402477068652 + 0.005145666237208163i, 0.0036075176570931444 + -0.009511118578361772i, -0.016237012245396046 + -0.004316718027370705i, 0.12876806883648523 + 1.6940658945086007e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, true, false, true, false}), ElementsAreArray({ DoubleNear(0.12538402226733597, 1.0e-7), DoubleNear(0.10824580819532467, 1.0e-7), DoubleNear(0.1409201752571658, 1.0e-7), DoubleNear(0.11745416577734344, 1.0e-7), DoubleNear(0.1399660588722577, 1.0e-7), DoubleNear(0.1099506159710544, 1.0e-7), DoubleNear(0.12931108482303139, 1.0e-7), DoubleNear(0.12876806883648523, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, true, false, false, true}), Matrix({ { 0.13291305299852568 + 9.740878893424454e-19i, -0.017722654064597797 + -0.005329959812359534i, -0.0009044991461057974 + -0.006607939675580007i, -0.0014491753542336073 + -0.00324141426081207i, 7.920824575761851e-05 + 0.0001125542292351965i, -1.594743168731549e-05 + -5.1811533545676914e-05i, -8.035067125041606e-06 + 1.9797207690459466e-05i, -1.824301093836183e-06 + -2.8286664580293398e-05i }, { -0.017722654064597797 + 0.005329959812359533i, 0.10895872410834309 + 1.57378721599849e-18i, 0.0043176382294423605 + -0.00050005260563943i, -0.004309294007290732 + 0.008786300791064001i, 3.4028082439651324e-06 + -3.7748231221675316e-05i, 6.367339429353729e-05 + 0.00012182761922240578i, 2.145826702420264e-05 + -1.4456496389265487e-05i, -5.6093485806103654e-06 + 2.3065951403193914e-06i }, { -0.0009044991461057959 + 0.006607939675580007i, 0.0043176382294423605 + 0.0005000526056394303i, 0.1355513109687816 + 1.1180834903756764e-19i, -0.015656511308715697 + 0.0022082255439477513i, -1.0729253686429335e-05 + 3.6814200100397207e-05i, 6.963227476593354e-07 + -1.2391872046544853e-05i, 0.00011505149087475257 + 7.783313901310238e-05i, -1.8005166047065713e-05 + -2.6529145512796422e-05i }, { -0.0014491753542336075 + 0.00324141426081207i, -0.004309294007290729 + -0.008786300791064001i, -0.015656511308715697 + -0.0022082255439477504i, 0.12299521638085838 + -2.803679055411734e-19i, 1.593709624629136e-05 + -2.0487132724467053e-05i, 1.2180935910479846e-05 + -4.059713405921708e-06i, -2.271106807798135e-05 + -2.3268952477160648e-05i, 7.265185801863077e-05 + 0.00011029754497753706i }, { 7.920824575761848e-05 + -0.00011255422923519676i, 3.4028082439651472e-06 + 3.774823122167537e-05i, -1.0729253686429331e-05 + -3.681420010039719e-05i, 1.593709624629135e-05 + 2.0487132724467046e-05i, 0.13243702814106795 + -1.4314856808597676e-18i, -0.017961922591098516 + -0.005082676329462764i, -0.0007428969233865047 + -0.006540455493990581i, -0.0016095333042302953 + -0.003192121057504039i }, { -1.5947431687315487e-05 + 5.181153354567698e-05i, 6.36733942935373e-05 + -0.00012182761922240606i, 6.963227476593354e-07 + 1.2391872046544836e-05i, 1.2180935910479862e-05 + 4.059713405921692e-06i, -0.017961922591098516 + 0.005082676329462764i, 0.109237700058036 + 3.7777669447541795e-19i, 0.004204633397778001 + -0.0004417367418152772i, -0.004366404392893075 + 0.008915813218239007i }, { -8.035067125041592e-06 + -1.9797207690459422e-05i, 2.145826702420264e-05 + 1.445649638926547e-05i, 0.0001150514908747525 + -7.783313901310277e-05i, -2.2711068077981335e-05 + 2.326895247716071e-05i, -0.0007428969233865025 + 0.006540455493990581i, 0.004204633397778002 + 0.0004417367418152774i, 0.13467994911141562 + 0.0i, -0.01565891566288909 + 0.0025146835582825376i }, { -1.8243010938361711e-06 + 2.8286664580293395e-05i, -5.609348580610402e-06 + -2.3065951403193617e-06i, -1.8005166047065713e-05 + 2.652914551279649e-05i, 7.265185801863076e-05 + -0.0001102975449775375i, -0.0016095333042302955 + 0.003192121057504038i, -0.004366404392893073 + -0.008915813218239005i, -0.01565891566288909 + -0.0025146835582825367i, 0.1232270182329703 + 2.879912020664621e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, true, false, false, true}), ElementsAreArray({ DoubleNear(0.13291305299852568, 1.0e-7), DoubleNear(0.10895872410834309, 1.0e-7), DoubleNear(0.1355513109687816, 1.0e-7), DoubleNear(0.12299521638085838, 1.0e-7), DoubleNear(0.13243702814106795, 1.0e-7), DoubleNear(0.109237700058036, 1.0e-7), DoubleNear(0.13467994911141562, 1.0e-7), DoubleNear(0.1232270182329703, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, false, true, true, false}), Matrix({ { 0.12693304201704925 + 1.7279472123987727e-18i, -0.01621140433231423 + -0.002404474197400328i, 0.012925166721109022 + 0.015459120913938938i, -0.0010197360225072901 + -0.0024633175636386805i, -0.00490323667377905 + -0.004795375327890089i, -0.0005230551891028975 + 0.0003457181002829447i, 0.017605808130923096 + -0.015934521291408446i, -0.0025150761509928035 + 0.001538087109099038i }, { -0.01621140433231423 + 0.002404474197400328i, 0.10747823413222171 + -5.421010862427522e-20i, -0.002312777150881063 + -0.0017160556793526772i, 0.010944773022929136 + 0.012545435868762738i, 0.001313925995533901 + 0.0015268940880655397i, -0.0058402383515399146 + -0.0018985877483527936i, -0.0021723394972120577 + 0.002476444270269234i, 0.014735301597110489 + -0.013813138646118682i }, { 0.012925166721109022 + -0.015459120913938942i, -0.002312777150881063 + 0.0017160556793526772i, 0.1393711555074525 + -1.0842021724855044e-18i, -0.017802137238216595 + -0.0024262205245472995i, 0.019618089231527483 + 0.024731985190715615i, -0.0015935312642774173 + -0.003965419783680767i, 0.00742587613385861 + 0.0033314424546301907i, -0.0001129596566953218 + -0.0012504679858681982i }, { -0.0010197360225072903 + 0.0024633175636386813i, 0.010944773022929134 + -0.012545435868762736i, -0.017802137238216595 + 0.0024262205245473003i, 0.11822173984044641 + 1.1104601938503877e-18i, -0.003563266590818788 + -0.002910822217331884i, 0.016061469992130883 + 0.019652791814605775i, -0.002050301494157371 + -0.00038908881585721165i, 0.005574754904692994 + 0.0001515022278995653i }, { -0.004903236673779052 + 0.004795375327890088i, 0.001313925995533901 + -0.0015268940880655394i, 0.019618089231527483 + -0.02473198519071562i, -0.003563266590818788 + 0.002910822217331884i, 0.15440910896402052 + -2.0328790734103208e-19i, -0.01901784560186449 + -0.0005183412753341338i, 0.02970796371681686 + -0.0020463852664626197i, -0.0037229817670928166 + -0.0005041702395871879i }, { -0.0005230551891028978 + -0.000345718100282945i, -0.005840238351539916 + 0.0018985877483527927i, -0.001593531264277417 + 0.003965419783680768i, 0.016061469992130886 + -0.019652791814605775i, -0.019017845601864487 + 0.0005183412753341343i, 0.13662066538592665 + 3.5236570605778894e-19i, -0.004213686243015385 + 0.0008053502854515498i, 0.02477823429064535 + -0.002491025370199984i }, { 0.017605808130923096 + 0.015934521291408446i, -0.0021723394972120577 + -0.0024764442702692336i, 0.00742587613385861 + -0.00333144245463019i, -0.0020503014941573704 + 0.00038908881585721246i, 0.02970796371681686 + 0.0020463852664626184i, -0.004213686243015385 + -0.0008053502854515499i, 0.11486803473126857 + -7.860465750519907e-19i, -0.013968616454905786 + -0.0003406910423102476i }, { -0.0025150761509928035 + -0.0015380871090990384i, 0.014735301597110487 + 0.013813138646118682i, -0.00011295965669532159 + 0.0012504679858681977i, 0.005574754904692994 + -0.00015150222789956248i, -0.0037229817670928166 + 0.0005041702395871887i, 0.02477823429064535 + 0.0024910253701999822i, -0.013968616454905788 + 0.00034069104231024803i, 0.10209801942161298 + 2.913793338554793e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, false, true, true, false}), ElementsAreArray({ DoubleNear(0.12693304201704925, 1.0e-7), DoubleNear(0.10747823413222171, 1.0e-7), DoubleNear(0.1393711555074525, 1.0e-7), DoubleNear(0.11822173984044641, 1.0e-7), DoubleNear(0.15440910896402052, 1.0e-7), DoubleNear(0.13662066538592665, 1.0e-7), DoubleNear(0.11486803473126857, 1.0e-7), DoubleNear(0.10209801942161298, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, false, true, false, true}), Matrix({ { 0.14102095188371772 + 8.605854744103691e-19i, -0.01755055706133425 + -0.001606662396577627i, 0.021368231864546255 + 0.006723835829294437i, -0.002355440923939296 + -0.0015007454853096839i, 9.74985238020448e-05 + 9.957256078050455e-05i, -1.2736754661877099e-05 + -4.336964577762591e-05i, 8.768999226236535e-06 + 3.0904868041941e-05i, -2.194618685579647e-06 + 1.8733557124173914e-05i }, { -0.01755055706133425 + 0.001606662396577627i, 0.121911744858694 + 1.9989977555201488e-19i, -0.0032572850111389122 + -0.000431447944074005i, 0.017837732287765015 + 0.0050193439294037865i, -4.934515915215133e-06 + -3.0178583702759244e-05i, 7.855689648531655e-05 + 0.00012118901936427679i, -1.5674152760347062e-05 + 1.117464462957213e-05i, -3.1759840937885593e-06 + 2.1394794235499904e-05i }, { 0.021368231864546255 + -0.006723835829294436i, -0.0032572850111389122 + 0.0004314479440740051i, 0.12744341208358956 + 2.253107639696439e-19i, -0.015828608311979245 + -0.0015150718718341554i, 1.4421379442301851e-05 + -1.5340401875291909e-06i, -1.6575087627285212e-05 + -2.3744084579283307e-05i, 9.676121283032628e-05 + 9.081480746779434e-05i, -2.1215843072504108e-05 + -3.4971033280847426e-05i }, { -0.002355440923939296 + 0.0015007454853096845i, 0.017837732287765015 + -0.005019343929403788i, -0.01582860831197925 + 0.0015150718718341559i, 0.11004219563050747 + 1.0935195349053017e-18i, -2.595082612649524e-06 + -2.557005653584039e-05i, 1.1054193098217744e-05 + 1.5270113810471584e-05i, -1.4373743918801085e-05 + -3.083859999607671e-05i, 5.776835582685152e-05 + 0.00011093614483566607i }, { 9.749852380204474e-05 + -9.957256078050489e-05i, -4.9345159152151194e-06 + 3.01785837027593e-05i, 1.4421379442301757e-05 + 1.5340401875290867e-06i, -2.5950826126495226e-06 + 2.5570056535840402e-05i, 0.14032119909735202 + 6.640738306473715e-19i, -0.01767869287284447 + -0.0013161530761568348i, 0.02126489857337963 + 0.006688899818181882i, -0.002387276865660811 + -0.0014667423179161847i }, { -1.273675466187709e-05 + 4.336964577762598e-05i, 7.855689648531658e-05 + -0.00012118901936427712i, -1.6575087627285202e-05 + 2.3744084579283324e-05i, 1.1054193098217715e-05 + -1.5270113810471692e-05i, -0.01767869287284447 + 0.0013161530761568352i, 0.12218715465945437 + 9.825582188149884e-20i, -0.0032691783827575364 + -0.00047925744982712235i, 0.01788527502580947 + 0.005035066569158968i }, { 8.768999226236494e-06 + -3.090486804194106e-05i, -1.5674152760347076e-05 + -1.1174644629572115e-05i, 9.676121283032624e-05 + -9.081480746779464e-05i, -1.4373743918801072e-05 + 3.083859999607678e-05i, 0.021264898573379626 + -0.006688899818181887i, -0.003269178382757536 + 0.00047925744982712224i, 0.12679577815513152 + -2.095559511507139e-18i, -0.015942145381143136 + -0.0012518396950233917i }, { -2.1946186855796556e-06 + -1.87335571241739e-05i, -3.175984093788556e-06 + -2.1394794235499965e-05i, -2.121584307250411e-05 + 3.4971033280847494e-05i, 5.776835582685149e-05 + -0.00011093614483566642i, -0.002387276865660811 + 0.0014667423179161852i, 0.01788527502580947 + -0.005035066569158966i, -0.015942145381143136 + 0.0012518396950233924i, 0.11027756363155192 + 3.083199928005653e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, false, true, false, true}), ElementsAreArray({ DoubleNear(0.14102095188371772, 1.0e-7), DoubleNear(0.121911744858694, 1.0e-7), DoubleNear(0.12744341208358956, 1.0e-7), DoubleNear(0.11004219563050747, 1.0e-7), DoubleNear(0.14032119909735202, 1.0e-7), DoubleNear(0.12218715465945437, 1.0e-7), DoubleNear(0.12679577815513152, 1.0e-7), DoubleNear(0.11027756363155192, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, false, false, true, true}), Matrix({ { 0.13349545897365805 + 1.0587911840678754e-18i, -0.016950258698821455 + -0.002546700513954404i, 0.0012667350460237748 + -0.0007316167063633296i, -0.00031851340739216084 + -0.000452640048024299i, 0.00010214103540384897 + 8.97846302582116e-05i, -7.232024656100327e-06 + -3.690449017995199e-05i, -9.109182064583628e-07 + 1.7036305458410303e-06i, -7.947175265805587e-06 + -1.5863237264875174e-05i }, { -0.016950258698821455 + 0.002546700513954404i, 0.11271916159137739 + 8.46185914307046e-19i, -0.0003678020278901591 + 0.0005650575387375469i, -0.00013700814813112552 + -0.0008738796654460199i, -7.49234772691319e-06 + -2.4230971534010546e-05i, 6.701531068491396e-05 + 0.00011487987008133648i, -4.836722325689959e-07 + -1.9469016162239406e-05i, -3.5156424801423327e-06 + 6.110847908696581e-06i }, { 0.001266735046023774 + 0.0007316167063633294i, -0.0003678020278901588 + -0.0005650575387375466i, 0.13496890499364925 + 2.710505431213761e-20i, -0.016428906674492042 + -0.0005750337544573784i, 1.054306189290045e-06 + -3.3523912441497616e-06i, 2.815485082455028e-06 + 2.2297175239539405e-05i, 9.211870122852211e-05 + 0.00010060273799008729i, -2.672057307828088e-05 + -4.143618887852135e-05i }, { -0.00031851340739216105 + 0.00045264004802429876i, -0.00013700814813112682 + 0.0008738796654460219i, -0.016428906674492042 + 0.000575033754457379i, 0.11923477889782408 + 4.472333961502706e-19i, -1.0331443278192427e-05 + 1.8396772103754512e-05i, -6.7443938835889955e-06 + -4.391103471525912e-06i, -1.1815912107103028e-05 + -3.678621216482542e-05i, 6.930994162725411e-05 + 0.00011724529411860638i }, { 0.00010214103540384893 + -8.978463025821189e-05i, -7.492347726913184e-06 + 2.4230971534010607e-05i, 1.0543061892900483e-06 + 3.3523912441497566e-06i, -1.0331443278192432e-05 + -1.8396772103754512e-05i, 0.13280873855084369 + -4.1504614415460717e-19i, -0.01706328287170937 + -0.0022839942079932235i, 0.0012559044140557848 + -0.0007323161668965693i, -0.0003175014384060585 + -0.0004521098375609546i }, { -7.232024656100322e-06 + 3.690449017995206e-05i, 6.701531068491396e-05 + -0.00011487987008133682i, 2.8154850824550234e-06 + -2.229717523953941e-05i, -6.744393883589029e-06 + 4.3911034715259225e-06i, -0.01706328287170937 + 0.0022839942079932243i, 0.11298081238129074 + 2.1006417091906648e-19i, -0.0003685734707333106 + 0.000572747733470781i, -0.000128475298715795 + -0.0008732058550072083i }, { -9.109182064583391e-07 + -1.7036305458410963e-06i, -4.836722325690014e-07 + 1.9469016162239413e-05i, 9.211870122852205e-05 + -0.00010060273799008764i, -1.1815912107103007e-05 + 3.678621216482547e-05i, 0.0012559044140557848 + 0.0007323161668965684i, -0.0003685734707333109 + -0.0005727477334707804i, 0.13430823870163985 + -1.0164395367051604e-18i, -0.016557555382278235 + -0.00028399856318700304i }, { -7.947175265805587e-06 + 1.586323726487519e-05i, -3.515642480142292e-06 + -6.1108479086966445e-06i, -2.672057307828088e-05 + 4.143618887852141e-05i, 6.93099416272541e-05 + -0.00011724529411860671i, -0.0003175014384060583 + 0.000452109837560954i, -0.000128475298715795 + 0.0008732058550072082i, -0.016557555382278235 + 0.00028399856318700326i, 0.11948390590971555 + 1.9651164376299768e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, false, false, true, true}), ElementsAreArray({ DoubleNear(0.13349545897365805, 1.0e-7), DoubleNear(0.11271916159137739, 1.0e-7), DoubleNear(0.13496890499364925, 1.0e-7), DoubleNear(0.11923477889782408, 1.0e-7), DoubleNear(0.13280873855084369, 1.0e-7), DoubleNear(0.11298081238129074, 1.0e-7), DoubleNear(0.13430823870163985, 1.0e-7), DoubleNear(0.11948390590971555, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, true, true, true, false}), Matrix({ { 0.1111009826120591 + 1.3417001884508117e-18i, -0.00792628617112134 + -0.0016509791381915983i, 0.011602230912932209 + 0.01345662607345834i, 0.0007600570790709488 + -0.0027686050823375937i, -0.006033341141668032 + -0.0017762803796281686i, -0.006114740222107934 + 0.0026165019199597497i, 0.01646340152745628 + -0.013961667320107042i, -0.0008933153725790593 + -0.0018161391236753222i }, { -0.007926286171121339 + 0.001650979138191598i, 0.12331029353721185 + 3.3203691532368573e-19i, -0.002440505962892137 + -0.0015703774394190766i, 0.01226770883110595 + 0.014547930709243338i, -0.0006440720600600053 + 0.007108697164066333i, -0.004710133883650933 + -0.004917682696614715i, -0.0024158187087985486 + 0.001997609256281843i, 0.015877708200577306 + -0.015785992617420086i }, { 0.011602230912932207 + -0.01345662607345834i, -0.0024405059628921375 + 0.001570377439419077i, 0.12252884785060153 + 1.3891340334970526e-19i, -0.00822615687415329 + -0.001677683837290706i, 0.015538868619327406 + 0.021369332764255903i, 0.001058244034169094 + -0.003976044770583081i, 0.006084267931824955 + -0.0002464917035744366i, 0.0011520833050237583 + -0.007331718086147725i }, { 0.0007600570790709497 + 0.0027686050823375933i, 0.01226770883110595 + -0.014547930709243338i, -0.008226156874153286 + 0.0016776838372907074i, 0.1350640474972974 + -1.1265538198482195e-19i, -0.005147516965817037 + -0.004698113902422137i, 0.02014069060433096 + 0.023015444241065487i, -0.005182339739730565 + -0.0044082054923475535i, 0.006916363106726648 + 0.003729436386104193i }, { -0.006033341141668033 + 0.0017762803796281682i, -0.0006440720600600057 + -0.007108697164066334i, 0.015538868619327406 + -0.021369332764255903i, -0.005147516965817039 + 0.004698113902422138i, 0.14298836474440046 + -3.7269449679189215e-19i, 0.0028812633147978373 + 0.004164570905080338i, 0.026382583548072335 + -0.002795139534081459i, -0.001877519867939401 + -0.003169019384761879i }, { -0.006114740222107933 + -0.0026165019199597492i, -0.004710133883650934 + 0.004917682696614712i, 0.0010582440341690943 + 0.00397604477058308i, 0.02014069060433096 + -0.02301544424106549i, 0.0028812633147978386 + -0.004164570905080338i, 0.14804140960554674 + 5.21772295508649e-19i, -0.0033646905980751667 + 0.0002942196647020401i, 0.02810361445938988 + -0.0017422711025811442i }, { 0.016463401527456276 + 0.013961667320107042i, -0.0024158187087985486 + -0.001997609256281844i, 0.006084267931824955 + 0.0002464917035744389i, -0.005182339739730565 + 0.0044082054923475535i, 0.026382583548072335 + 0.002795139534081457i, -0.003364690598075167 + -0.00029421966470203915i, 0.10692831009891163 + 3.8624702394796095e-19i, 0.0029480852608006845 + 0.0037178109101343847i }, { -0.0008933153725790594 + 0.0018161391236753226i, 0.015877708200577302 + 0.015785992617420086i, 0.0011520833050237592 + 0.007331718086147725i, 0.00691636310672665 + -0.003729436386104191i, -0.0018775198679394003 + 0.003169019384761878i, 0.02810361445938988 + 0.001742271102581144i, 0.002948085260800686 + -0.0037178109101343843i, 0.11003774405396992 + -8.809142651444724e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, true, true, true, false}), ElementsAreArray({ DoubleNear(0.1111009826120591, 1.0e-7), DoubleNear(0.12331029353721185, 1.0e-7), DoubleNear(0.12252884785060153, 1.0e-7), DoubleNear(0.1350640474972974, 1.0e-7), DoubleNear(0.14298836474440046, 1.0e-7), DoubleNear(0.14804140960554674, 1.0e-7), DoubleNear(0.10692831009891163, 1.0e-7), DoubleNear(0.11003774405396992, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, true, true, false, true}), Matrix({ { 0.12709308911288436 + 1.1756817307889689e-18i, -0.0025509421154045185 + 0.001204890874798171i, 0.01897927063987588 + 0.005313565024507822i, -0.0005429789624341988 + -0.0029681094624335585i, 8.560921048273966e-05 + 0.00012459554197546214i, -1.5198622715026089e-05 + 8.746016023890145e-06i, -9.769076406857262e-06 + 3.2480232913719006e-05i, 2.9210243669632765e-06 + 2.0370943302025865e-06i }, { -0.002550942115404517 + -0.0012048908747981717i, 0.13583960762952738 + -1.1519648082658485e-19i, -0.0028989540636782793 + -0.0006150336313286703i, 0.02022669351243539 + 0.006429614734190401i, -6.205116398311881e-06 + 1.835315656945562e-05i, 9.044620980462167e-05 + 9.616603816931917e-05i, 5.802730769117398e-06 + 2.5905183585112986e-06i, 1.5362091539305236e-05 + 1.9819429363721905e-05i }, { 0.01897927063987588 + -0.005313565024507823i, -0.00289895406367828 + 0.0006150336313286714i, 0.11477868799398441 + 1.3721933745519665e-18i, -0.0026628510379920105 + 0.000973470240685823i, 8.493989867607027e-06 + 5.893809897003165e-06i, 6.004500174237381e-06 + -4.855348457554623e-06i, 5.7272429568416106e-05 + 0.00010978630648214014i, 1.5542070093741156e-06 + 1.3357786806888713e-05i }, { -0.0005429789624341979 + 0.002968109462433558i, 0.02022669351243539 + -0.006429614734190401i, -0.002662851037992007 + -0.0009734702406858219i, 0.1227069197201126 + -5.336307567702092e-20i, 5.501974880754135e-07 + -2.0225019055472635e-06i, 1.698158267291257e-05 + 7.842263725939226e-06i, 7.656798622362393e-06 + 1.4401330125019879e-05i, 9.725713908876169e-05 + 9.196464582132027e-05i }, { 8.56092104827397e-05 + -0.00012459554197546242i, -6.205116398311878e-06 + -1.835315656945562e-05i, 8.493989867606942e-06 + -5.893809897003286e-06i, 5.501974880754084e-07 + 2.022501905547253e-06i, 0.12699625824357522 + -2.0667603913004928e-19i, -0.0024940807409189855 + 0.0013087008920905688i, 0.019005543821128665 + 0.005347921514869057i, -0.0005744838264342534 + -0.002969515004665914i }, { -1.5198622715026106e-05 + -8.746016023890093e-06i, 9.044620980462161e-05 + -9.61660381693196e-05i, 6.004500174237392e-06 + 4.855348457554632e-06i, 1.698158267291253e-05 + -7.84226372593932e-06i, -0.002494080740918983 + -0.0013087008920905684i, 0.13551209551323118 + 9.690056916589196e-19i, -0.0029062424972890245 + -0.0006611241433883661i, 0.020144629778060436 + 0.006376044872471792i }, { -9.769076406857279e-06 + -3.248023291371907e-05i, 5.8027307691174e-06 + -2.590518358511297e-06i, 5.7272429568416086e-05 + -0.00010978630648214039i, 7.656798622362407e-06 + -1.440133012501988e-05i, 0.01900554382112866 + -0.005347921514869059i, -0.0029062424972890245 + 0.0006611241433883666i, 0.11467846995552873 + -8.470329472543003e-19i, -0.0026152205753605944 + 0.0010666568321578557i }, { 2.921024366963286e-06 + -2.0370943302026e-06i, 1.5362091539305215e-05 + -1.981942936372196e-05i, 1.5542070093741107e-06 + -1.3357786806888693e-05i, 9.725713908876165e-05 + -9.196464582132067e-05i, -0.0005744838264342527 + 0.0029695150046659133i, 0.020144629778060436 + -0.006376044872471794i, -0.0026152205753605926 + -0.001066656832157855i, 0.1223948718311547 + -9.402065714522734e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, true, true, false, true}), ElementsAreArray({ DoubleNear(0.12709308911288436, 1.0e-7), DoubleNear(0.13583960762952738, 1.0e-7), DoubleNear(0.11477868799398441, 1.0e-7), DoubleNear(0.1227069197201126, 1.0e-7), DoubleNear(0.12699625824357522, 1.0e-7), DoubleNear(0.13551209551323118, 1.0e-7), DoubleNear(0.11467846995552873, 1.0e-7), DoubleNear(0.1223948718311547, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, true, false, true, true}), Matrix({ { 0.11681414021146588 + 1.6737371037744975e-18i, -0.008065655454629833 + -0.0017224324616026973i, -5.281724490132592e-06 + -0.0010151485873567583i, -0.0024580355732934716 + -0.0023598040094218505i, 7.158048855752545e-05 + 0.00012011564664703058i, -6.4696618085779675e-06 + -2.38109768408788e-06i, -6.672256667523786e-06 + -2.7596057340483762e-06i, 8.381080053533968e-06 + -4.356118554385811e-06i }, { -0.008065655454629832 + 0.0017224324616026976i, 0.12940048035356955 + 2.31239994600424e-19i, -0.002891243310888533 + 0.0013611362170119793i, 0.0011350086223827819 + -0.0005903477844525914i, -1.3956662047144247e-06 + 9.420962511531628e-06i, 9.757585753123747e-05 + 8.454885369251749e-05i, 4.0360238168262035e-06 + -3.7919094562954214e-06i, 2.2456959809230903e-06 + 1.0574084188585987e-05i }, { -5.281724490134327e-06 + 0.0010151485873567613i, -0.002891243310888533 + -0.0013611362170119793i, 0.1250576368954029 + 8.74138001566438e-19i, 0.002851862301233305 + 0.0039007935770866914i, -1.0894881650787784e-05 + 8.727693418247617e-06i, 8.206435441882427e-07 + -7.051479383589186e-06i, 7.130115149363032e-05 + 0.0001142662018105717i, -7.174753897074006e-06 + 2.4484900514866737e-05i }, { -0.0024580355732934708 + 0.0023598040094218505i, 0.0011350086223827814 + 0.0005903477844525899i, 0.0028518623012333067 + -0.0039007935770866914i, 0.1291460469960704 + -3.9979955110402976e-19i, 7.039700159700134e-07 + -5.233592028120293e-06i, 5.204793956488834e-06 + -1.647118813392329e-05i, 2.8473484287649374e-06 + 2.3333524182943872e-05i, 9.012749136214589e-05 + 0.00010358183029812195i }, { 7.158048855752542e-05 + -0.00012011564664703083i, -1.3956662047144285e-06 + -9.42096251153162e-06i, -1.0894881650787808e-05 + -8.727693418247634e-06i, 7.039700159700062e-07 + 5.233592028120296e-06i, 0.11681569025119475 + -1.9312351197398048e-19i, -0.008086787590644797 + -0.001606230513879607i, 5.6208514647056174e-05 + -0.001007623495845847i, -0.0025046213437907045 + -0.0023554121567661256i }, { -6.469661808577969e-06 + 2.381097684087921e-06i, 9.757585753123747e-05 + -8.454885369251789e-05i, 8.206435441882495e-07 + 7.0514793835891915e-06i, 5.204793956488827e-06 + 1.6471188133923315e-05i, -0.008086787590644795 + 0.0016062305138796079i, 0.1289738606809397 + -1.1858461261560205e-20i, -0.0029351684889020375 + 0.0013393554547068004i, 0.0010712206006929337 + -0.0005978985260579306i }, { -6.6722566675237655e-06 + 2.7596057340483042e-06i, 4.036023816826208e-06 + 3.79190945629544e-06i, 7.130115149363037e-05 + -0.00011426620181057198i, 2.8473484287649586e-06 + -2.3333524182943882e-05i, 5.6208514647055306e-05 + 0.0010076234958458457i, -0.002935168488902038 + -0.0013393554547068013i, 0.1248590379479092 + -8.605854744103691e-19i, 0.002977486274365217 + 0.0039815882381280315i }, { 8.381080053533982e-06 + 4.356118554385801e-06i, 2.2456959809231344e-06 + -1.0574084188586045e-05i, -7.174753897074026e-06 + -2.4484900514866707e-05i, 9.01274913621458e-05 + -0.00010358183029812238i, -0.0025046213437907036 + 0.0023554121567661256i, 0.001071220600692935 + 0.0005978985260579311i, 0.0029774862743652186 + -0.0039815882381280315i, 0.1289331066634462 + 4.0657581468206416e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, true, false, true, true}), ElementsAreArray({ DoubleNear(0.11681414021146588, 1.0e-7), DoubleNear(0.12940048035356955, 1.0e-7), DoubleNear(0.1250576368954029, 1.0e-7), DoubleNear(0.1291460469960704, 1.0e-7), DoubleNear(0.11681569025119475, 1.0e-7), DoubleNear(0.1289738606809397, 1.0e-7), DoubleNear(0.1248590379479092, 1.0e-7), DoubleNear(0.1289331066634462, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, true, true, true}), Matrix({ { 0.11730750782621087 + 1.2841019480375193e-18i, 0.011956107364685867 + 0.014020210492578499i, -0.005374819500025219 + -0.003343830088618195i, 0.01618008278859977 + -0.014885353798131308i, 7.68622131547859e-05 + 9.602912427513308e-05i, -9.799664513591496e-06 + 2.7771419923160997e-05i, -8.69460727154385e-06 + -7.0150480930763385e-06i, 2.0016083080533643e-05 + 1.6607667200606527e-06i }, { 0.011956107364685867 + -0.014020210492578499i, 0.12890711273882458 + 6.2087515033740215e-19i, 0.017866165965803312 + 0.022202683075319543i, 0.006504546397917869 + 0.0017383337168088452i, 1.337075077272774e-05 + -7.430239771390088e-06i, 9.229413293397701e-05 + 0.000108635376064415i, -1.2664037334346134e-05 + 3.6267250703751335e-05i, 4.268046584943155e-06 + 1.482952654761395e-05i }, { -0.00537481950002522 + 0.0033438300886181925i, 0.017866165965803312 + -0.022202683075319547i, 0.14562518891620085 + -2.236166980751353e-19i, 0.027249856787625405 + -0.0022770307338802753i, -1.116304924006878e-05 + -4.146699928645598e-06i, 2.601489527622307e-05 + -8.238736869273232e-06i, 9.919320713257544e-05 + 0.00012473245586964825i, 1.539267964603947e-05 + 2.4528242354279914e-05i }, { 0.016180082788599767 + 0.014885353798131308i, 0.006504546397917868 + -0.0017383337168088416i, 0.027249856787625405 + 0.0022770307338802745i, 0.10857849497527246 + 6.979551485375435e-19i, -4.7084575688509845e-06 + 2.6240761597680157e-05i, 5.47296154576983e-06 + -3.5967947870300763e-06i, 1.2104821767791855e-05 + 2.1166313394332482e-05i, 6.223543572320078e-05 + 9.311557623904542e-05i }, { 7.686221315478589e-05 + -9.602912427513342e-05i, 1.3370750772727684e-05 + 7.430239771390007e-06i, -1.1163049240068818e-05 + 4.146699928645577e-06i, -4.708457568850996e-06 + -2.624076159768023e-05i, 0.11710376832306008 + 3.8963515573697816e-19i, 0.011913832379352292 + 0.013984346290123177i, -0.005368655525293746 + -0.0033501329876246882i, 0.016161026939433814 + -0.014862306139395822i }, { -9.79966451359151e-06 + -2.7771419923161014e-05i, 9.2294132933977e-05 + -0.00010863537606441529i, 2.6014895276223103e-05 + 8.23873686927316e-06i, 5.472961545769837e-06 + 3.5967947870301017e-06i, 0.01191383237935229 + -0.01398434629012318i, 0.12868578260907435 + -5.946171289725188e-19i, 0.017813393257855054 + 0.022182093930001846i, 0.006496084640633735 + 0.0017446109657209107i }, { -8.694607271543817e-06 + 7.015048093076266e-06i, -1.2664037334346145e-05 + -3.626725070375142e-05i, 9.919320713257543e-05 + -0.00012473245586964857i, 1.2104821767791787e-05 + -2.1166313394332614e-05i, -0.005368655525293746 + 0.0033501329876246874i, 0.017813393257855054 + -0.022182093930001846i, 0.14540458543374635 + 3.7269449679189215e-19i, 0.02723634121983681 + -0.0022603799027823284i }, { 2.001608308053368e-05 + -1.6607667200607204e-06i, 4.268046584943186e-06 + -1.4829526547614006e-05i, 1.5392679646039447e-05 + -2.4528242354280012e-05i, 6.223543572320074e-05 + -9.311557623904577e-05i, 0.016161026939433814 + 0.014862306139395822i, 0.006496084640633736 + -0.0017446109657209107i, 0.02723634121983681 + 0.0022603799027823266i, 0.10838755917760909 + -1.1926223897340549e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, true, true, true}), ElementsAreArray({ DoubleNear(0.11730750782621087, 1.0e-7), DoubleNear(0.12890711273882458, 1.0e-7), DoubleNear(0.14562518891620085, 1.0e-7), DoubleNear(0.10857849497527246, 1.0e-7), DoubleNear(0.11710376832306008, 1.0e-7), DoubleNear(0.12868578260907435, 1.0e-7), DoubleNear(0.14540458543374635, 1.0e-7), DoubleNear(0.10838755917760909, 1.0e-7) }));


}
}

}

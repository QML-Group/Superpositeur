#include <gtest/gtest.h>

#include "superpositeur/Circuit.hpp"
#include "superpositeur/DefaultOperations.hpp"

namespace superpositeur {
namespace {
Circuit randomCircuit() {
    using namespace std::complex_literals;

    Circuit c;
    c.addInstruction(CircuitInstruction({ Matrix{ { 0.4496737888723812 + -0.12382614661797416i, 0.2815219574914882 + -0.4226595617319358i, 0.12658886514446271 + -0.3382568193591004i, -0.489534204671956 + -0.3930377808510619i }, { -0.8253349261640859 + 0.11257695364086492i, 0.09486448680119672 + -0.27899246496891866i, -0.0915910507730033 + -0.2983601229613277i, -0.02936627799937863 + -0.34791171431620327i }, { -0.03184616482291182 + 0.20718528706071773i, 0.29148507075257546 + 0.377039697746801i, 0.14039489786206832 + -0.6833511308869322i, -0.11526700699698038 + 0.4785097910501049i }, { 0.18727887466221632 + 0.09795897046447839i, -0.5964046551689541 + -0.2691602182816194i, 0.26933275287827296 + -0.4614436830428625i, 0.4858063497148779 + -0.07554279304963873i } } }, { QubitIndex{ 6 }, QubitIndex{ 0 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 4 }, QubitIndex{ 5 } }));

    c.addInstruction(CircuitInstruction({ Matrix{ { -0.3264856817067707 + 0.4625477539278966i, 0.13751968885904192 + -0.3135471516959164i, -0.10649079962556074 + 0.19856946172905368i, -0.6016699836162474 + -0.38659578773595105i }, { 0.29547719266813555 + 0.01815913352566803i, 0.6363667722423647 + -0.43687298851592216i, 0.04459817853287172 + 0.458601458824393i, 0.3080107458838826 + 0.09678782169931657i }, { -0.604588321669243 + 0.2609493224024044i, -0.31936665984998497 + -0.05429911475451235i, -0.00761164146590191 + 0.42510368460317394i, 0.41023735082186114 + 0.3352151419516951i }, { -0.28879235739604997 + 0.2734913823282256i, 0.333362112432142 + -0.26623689946814627i, 0.246353782988239 + -0.7038922621806653i, 0.1120847369637141 + 0.3017806522087536i } } }, { QubitIndex{ 0 }, QubitIndex{ 6 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 5 }, QubitIndex{ 3 } }));

    c.addInstruction(CircuitInstruction({ Matrix{ { 0.13280305644899193 + 0.7274953305238312i, 0.489969226934558 + -0.46156694955442734i }, { -0.40098571951566797 + 0.5406702738345522i, -0.7380441112618026 + -0.04665830652679731i } } }, { QubitIndex{ 6 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 4 }, QubitIndex{ 1 } }));

    c.addInstruction(CircuitInstruction({ Matrix{ { -0.6233191914971632 + -0.24366962005251783i, -0.7258394178206341 + 0.15891960644485387i }, { 0.4671819485603802 + -0.5777883078724513i, -0.061313317053325725 + 0.6664400763588081i } } }, { QubitIndex{ 7 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 4 }, QubitIndex{ 1 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 7 }, QubitIndex{ 0 } }));

    c.addInstruction(CircuitInstruction({ Matrix{ { -0.9021704216346422 + 0.097250203257859i, -0.21395049590853912 + 0.361740395303548i }, { 0.3417516115336912 + -0.24461554388060072i, -0.01837971373297171 + 0.9072107020032429i } } }, { QubitIndex{ 3 } }));


    
    return c;
}

TEST(RandomizedIntegrationTests, 8_10_2_10_30_80) {
    auto c = randomCircuit();

    c.execute();
}
}

}

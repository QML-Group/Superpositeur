#include "gtest/gtest.h"
#include "gmock/gmock.h"
#include <chrono>
#include <iostream>

#include "superpositeur/Circuit.hpp"
#include "superpositeur/DefaultOperations.hpp"

namespace superpositeur {

using namespace std::complex_literals;

using testing::ElementsAreArray;
using testing::DoubleNear;

namespace {
Circuit randomCircuit() {

    Circuit c;
    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 1 }, QubitIndex{ 8 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { -0.012721910297434746 + -0.1712488134963603i, -0.10056772441127869 + -0.3331286041376959i }, { -0.46153830384584216 + -0.16411872096940067i, -0.24393083336553925 + 0.24374109401900135i } }), Matrix({ { 0.19777710913876811 + -0.23696363916120816i, 0.4639301806589262 + 0.1530325334449319i }, { -0.24924134478315807 + -0.2567123731476189i, -0.07190635496214534 + 0.2579337144844507i } }), Matrix({ { 0.2596072581149677 + 0.2868991912142357i, -0.21336122897355667 + -0.32723635250106287i }, { 0.3491336014768981 + -0.379198353733581i, 0.0972095798751661 + 0.09730045377442034i } }), Matrix({ { 0.020284182936041367 + 0.24561242749828127i, -0.06526448725771075 + -0.21499401378690686i }, { 0.10505332473148053 + -0.14178696529925572i, 0.45472480375065444 + -0.1444601959112834i } }) }, { QubitIndex{ 5 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { 0.036462283343569046 + -0.00758295515068049i, 0.029866220601096637 + -0.14752186936963102i, 0.045953269866020115 + -0.11514418631419303i, 0.0045810708003196565 + 0.00036839532833385483i }, { -0.03934727524718198 + 0.1457924816421566i, -0.06531394952974631 + -0.08064536568125578i, 0.0017800748143153603 + 0.018557944770824033i, 0.038953989320151254 + 0.09445159656009458i }, { 0.03306222724465908 + 0.04350471264987261i, -0.037866206329771356 + 0.1252410815914644i, -0.019775961419118717 + 0.11024255393166406i, 0.1303647497669991 + -0.03405990400389364i }, { 0.0184480419995532 + -0.011867927032369831i, 0.1083451263566086 + 0.09241509582654324i, 0.1422675090845773 + -0.0078103196916886174i, -0.07468194367675463 + 0.0218809349509176i } }), Matrix({ { -0.08098006133045317 + 0.08129066544044768i, -0.01092682383936561 + -0.17423260678678945i, -0.1642075795279878 + 0.07366136372951176i, -0.07170365067274753 + 0.09810775894963235i }, { 0.1810480272843389 + -0.0678451807974923i, -0.029877431354987414 + -0.034444363061954995i, 0.04370040989014366 + -0.07549909967787029i, -0.13566810144523522 + 0.1205843767504652i }, { 0.034209070582462246 + 0.08593929909635209i, -0.006403321185975914 + -0.044800042749395426i, -0.07588645716902188 + 0.052614257991908865i, 0.016737314728795773 + 0.029856432714405287i }, { 0.03709249396940039 + 0.17903600953372176i, 0.07105842181241633 + -0.09308852875932011i, -0.08038488758232143 + -0.006376671781945752i, -0.19018027517707478 + -0.13408165367057803i } }), Matrix({ { 0.03030081287399856 + -0.20399189192068068i, -0.055795257357555035 + -0.006406983328888027i, 0.054735463335172194 + 0.07143433936921839i, 0.0520647142219019 + 0.057742234094867013i }, { 0.026793388708060303 + 0.017726457836340595i, -0.06132345908172509 + -0.06006616195978883i, -0.04559996428851143 + 0.09514180573261684i, 0.03662819022786118 + -0.09089199050338247i }, { 0.05226885409258079 + 0.04081052120920881i, 0.049844203812643345 + -0.03994512028017868i, -0.031430409463644476 + -0.04547084345164827i, 0.15936958983287408 + 0.08969226341234635i }, { 0.1613436880518146 + -0.007848237638013848i, 0.014645334109198823 + -0.027734827029170732i, -0.2821105410336112 + 0.08986844379286628i, 0.011078749858675026 + 0.07473364047549412i } }), Matrix({ { -0.1574387051858754 + 0.11848078143556036i, -0.130514338544337 + -0.11816897196794172i, 0.06083756594597478 + -0.061647536577211365i, -0.07399327240581645 + 0.030759382460632333i }, { 0.07988794304289108 + -0.036330628323080136i, -0.06901853318110407 + 0.008914285705944817i, -0.14176025577452459 + -0.08790999867435789i, -0.00741541358094222 + -0.004671745031056073i }, { 0.04018435432017128 + 0.0149052150446485i, 0.010505474782331938 + 0.005084963875254309i, 0.023666293417805125 + 0.09252937898156574i, -0.16402345970531199 + -0.07006569414344639i }, { 0.02942825431795864 + -0.17245993682112892i, -0.11392879045023231 + 0.03373635283250041i, -0.015680859607614974 + 0.003617436715023909i, -0.1404911172961774 + -0.0803168744248444i } }), Matrix({ { -0.12998700671438587 + -0.04091366973981832i, 0.033469743623444854 + 0.13302295240284684i, -0.11877369961242581 + -0.08663885411517036i, 0.05907665489438123 + 0.03568423816670753i }, { -0.0008658711815327642 + 0.012420051620672551i, -0.024499523324297237 + 0.060388508115630006i, 0.08723156672521742 + 0.06555566863267666i, 0.04713447287364936 + -0.012005685282239921i }, { -0.07269001439758928 + 0.11226722745234455i, 0.11829781044976997 + 0.09672094928811022i, 0.13241584009608068 + 0.11631616583393951i, -0.0011749424579225781 + 0.07209213228386074i }, { 0.13720456267836287 + -0.11111294130048845i, -0.039851406540495106 + 0.078087829736884i, 0.017835276763418766 + -0.23376246235494288i, 0.04073846948745742 + -0.07562082613487077i } }), Matrix({ { -0.06901019425884611 + -0.11136722445659264i, -0.11355349969303609 + -0.053684471707495254i, -0.23159501055187462 + 0.0051372255939019455i, -0.005278937101754208 + -0.16443108812819893i }, { -0.0952194223603686 + -0.1961140872704918i, 0.060198094167323975 + -0.12929325611092712i, -0.027149128442778194 + 0.11926945413372926i, 0.1020696018701452 + -0.04374631397287519i }, { 0.0644126930671042 + 0.012928844930375659i, 0.09449165481458174 + 0.22638327992755047i, 0.04540972517475237 + 0.03335850485053487i, 0.033328718040807774 + -0.002073536845442001i }, { -0.10236195887295194 + 0.11107350404910292i, -0.12082536016535496 + 0.022219996157997073i, -0.033043716906204695 + 0.056118742897194505i, 0.1280509546618584 + -0.07784456726877477i } }), Matrix({ { -0.010929332802036113 + 0.08399822831914304i, 0.018330062344098584 + -0.031863541575876245i, -0.047242759799885174 + -0.06932002264203874i, 0.09908252234899707 + -0.054124198243355244i }, { -0.09720944906322156 + 0.10570369134345467i, 0.06137165327935379 + 0.026631403204017103i, -0.04192690181328742 + -0.12561331750518773i, 0.03563528678837132 + -0.04908746281664091i }, { -0.08666937182788002 + 0.11698520317508755i, 0.050492845965645544 + -0.07620713798435179i, 0.041943299803423276 + -0.03297794649949131i, 0.16961779076044473 + 0.14490200096004488i }, { 0.011920105303240098 + 0.01213113823113423i, -0.017442067198641525 + 0.09234807388033478i, 0.08699657626650369 + 0.07735833902151687i, 0.06207232582227965 + -0.031227254382483395i } }), Matrix({ { -0.03649136627435262 + -0.016823132733335355i, 0.014515268042029105 + -0.04152843557706749i, 0.032518749129967245 + 0.08150508679784109i, -0.04023592324947157 + -0.0499406283015468i }, { -0.08002576159211781 + 0.1199545845042706i, -0.18169916263241068 + -0.04813653446114469i, 0.10769225448695058 + -0.12122591752004627i, -0.012835489247655603 + 0.005265083876212447i }, { 0.12530710069281964 + -0.20982031450084565i, -0.07198469373335291 + -0.01849112997328547i, 0.02500257026421132 + -0.005918927610568484i, 0.0009693090801092696 + 0.006574998842944875i }, { 0.0329430958608473 + 0.05505940884920243i, -0.08795424019773024 + 0.09608698222069095i, 0.04901223517635081 + 0.05753783052192231i, 0.15743477382605492 + -0.09906137211334137i } }), Matrix({ { 0.03302013220422379 + -0.13278808454758062i, -0.15834533586763208 + 0.034403198304920134i, 0.012282746092410958 + 0.027555745733208726i, 0.08200047383957434 + 0.06995867783256994i }, { -0.003401186442861537 + 0.020846320157100307i, 0.030530758392346258 + -0.03616095894238012i, -0.02364483394452296 + 0.03822632127445886i, 0.08973943979866238 + 0.0941098772679425i }, { 0.03443228383839006 + 0.012270729283879634i, 0.02052957406972448 + 0.04702464998879751i, -0.09328325371736733 + 0.07122303716330725i, -0.009464572426918788 + 0.0706689516955858i }, { -0.05025388152834376 + 0.05612928339843147i, -0.0033058048222997355 + 0.09910666646706742i, 0.12397437047019795 + 0.062104989527814645i, -0.09711883969864171 + -0.12350552130956606i } }), Matrix({ { -0.1472392654543684 + 0.08014627070063958i, -0.09527439333350844 + 0.05565746139705251i, -0.10887939602686296 + -0.0756277560763265i, 0.007531363417256978 + 0.039551681667186776i }, { -0.08459854881243146 + -0.04565459975475078i, 0.05803197816855732 + 0.12765961451896665i, 0.02607333295029109 + 0.09946619253301484i, 0.06684013346837535 + -0.2068306744432614i }, { -0.05342455575526667 + -0.04292512231121287i, 0.04727948158905283 + 0.12579877097255496i, 0.08306931707128452 + 0.060975626978912276i, -0.0058873546058779485 + 0.1928241080036108i }, { 0.08430665763222776 + -0.18992666139900963i, -0.012698024772868752 + 0.006085369054156456i, 0.09756125510489756 + -0.15473945812718848i, 0.12492567837617445 + -0.09272204991771832i } }), Matrix({ { 0.09232592016174265 + -0.11363153466859677i, 0.1363016583618782 + -0.04088362578054575i, -0.10721403568418314 + -0.03480122161399582i, 0.05588688160425891 + -0.11248728455038674i }, { 0.03257378840389906 + -0.03865643772741543i, -0.03344652796266598 + 0.04817293036188271i, -0.005693190632203526 + -0.18342014294211187i, 0.04419000980848603 + -0.07581690799742147i }, { 0.03778366834636964 + 0.033477585769655975i, -0.1758101508582056 + 0.040306172280693664i, -0.0988293769974325 + -0.05513789332050384i, 0.09322824409936331 + 0.07938062832987805i }, { 0.12569006305689032 + -0.06569695041676318i, -0.024040581285088965 + 0.17277006061008582i, -0.06250424892683173 + -0.1195932764245308i, -0.12618624054343008 + -0.10606790050917231i } }), Matrix({ { 0.08685066420161681 + 0.13071912432330024i, 0.11733782273195294 + 0.013159462841083372i, -0.04870843044297052 + -0.04552199633346174i, -0.1571332889204612 + 0.05397065658881804i }, { -0.0112536352615052 + 0.02095466395363476i, -0.03337418585199981 + -0.03529748720105951i, -0.19133322513199533 + -0.077334949764715i, 0.07618378188953256 + -0.008352501454548751i }, { -0.14808322171751048 + 0.034478133531849184i, -0.10798595779392636 + 0.04938724140754537i, 0.03510500863069025 + -0.13981739797942905i, 0.10602911412257265 + -0.12085229473833786i }, { -0.01623395575165376 + -0.0003959746934859594i, -0.11520801620236731 + 0.03768523945405877i, -0.057460867516177905 + -0.06995624970052644i, -0.04375918746257276 + 0.09745972280642251i } }), Matrix({ { 0.011187989038860511 + -0.004185622913407546i, 0.14759897045860826 + 0.06075266590221791i, -0.048618478362065 + 0.1743947896088328i, 0.11021993560303353 + 0.1379186176462977i }, { 0.03554621325205002 + 0.023960580888379348i, 0.14946884848296643 + -0.037393972464472826i, -0.06737616407453448 + -0.08236420649227845i, 0.14816267389834747 + -0.009306189247859666i }, { 0.005561504738183865 + -0.04288565914203955i, 0.04606458737757234 + 0.00300572018974565i, -0.005331683900834862 + -0.04720144053908303i, -0.20329635157861217 + -0.032281742861498035i }, { -0.05623341887383315 + 0.07110690530047264i, 0.01990174165030006 + -0.0864293720692095i, 0.09966712517619057 + 0.059569924509909514i, -0.04476262543781694 + -0.12285617108868313i } }), Matrix({ { -0.0848810913803756 + 0.11396279456739677i, -0.005858041298868588 + -0.017533765603238334i, -0.06169190024256834 + 0.21934745419320972i, -0.010359401471469975 + 0.10908118715283224i }, { 0.05652263151518299 + 0.027888258533573535i, -0.10475799074624649 + -0.09925560541568698i, -0.08701935273343969 + 0.0033351420258097625i, 0.08895361184635049 + -0.04529109283452154i }, { 0.034481872902378786 + 0.0955947344798318i, 0.028451993107286827 + 0.1496198614757403i, -0.03085352158214727 + 0.015719909658330533i, 0.07993740225853632 + 0.07053378041270746i }, { 0.004814174865862633 + 0.0973071156084764i, -0.2029100681527103 + -0.1518216405908963i, 0.053819992683530125 + -0.05027647986711751i, -0.14688180174282234 + -0.002274541916053741i } }), Matrix({ { 0.09585395784369026 + 0.019938743646105928i, 0.02519517665595084 + -0.09113314299672648i, -0.07173670272100498 + 0.12885316018626303i, 0.004524410369708449 + -0.13258521420331598i }, { 0.05778989797644716 + 0.06122138039720525i, 0.16793106491170728 + 0.04403759145801401i, -0.07320639132734488 + 0.030944936471374467i, -0.09753344662333854 + -0.07597651393799389i }, { 0.06816066036613709 + -0.1433903046485629i, 0.1317988302939386 + -0.049641884076509595i, -0.01484342066446255 + -0.03910909104058548i, 0.012743647823513398 + 0.004633019792393919i }, { 0.07057468527846199 + 0.013448055607864615i, -0.03456964722072694 + 0.19875671354656718i, 0.07262763982108372 + -0.03227691852032471i, -0.08845580090829447 + -0.0004973134850751855i } }), Matrix({ { 0.16107609999807868 + 0.01302412320248671i, 0.05379885407159675 + -0.05962449835960062i, 0.016453262956273636 + 0.016011038812161267i, -0.07707600342968117 + 0.046985725801862874i }, { -0.19137333814845228 + -0.014186518823826275i, 0.08020727382137718 + 0.0084026447816252i, 0.023229336875507635 + -0.1932438549106494i, 0.06248665755305874 + 0.05829466982811694i }, { -0.08080786082665146 + 0.03490204055803684i, 0.05046944526310266 + -0.1763699073850528i, 0.046195873925125405 + 0.014885827744041971i, 0.0052214698849409056 + -0.028071824769707508i }, { 0.19561434733303448 + 0.11383649722945965i, 0.08900750507020849 + -0.14889343375297184i, -0.004015707255202269 + 0.01940138176541972i, 0.13172179226323108 + -0.05732161926335412i } }) }, { QubitIndex{ 5 }, QubitIndex{ 3 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { -0.02229647130470691 + -0.11882130604703958i, 0.0305219221985103 + -0.013882752184074582i, 0.03307756511075655 + 0.0734686356342692i, 0.02052814692157331 + 0.010794792686787152i }, { -0.018472852662455432 + -0.25559460154978214i, -0.05629026628432223 + 0.07142393597585535i, -0.0651474176098198 + -0.02131227629478628i, -0.02883621313062265 + -0.043352292918837076i }, { 0.1661854998550848 + -0.06173099063514835i, 0.018646888796135363 + -0.09844976511822767i, -0.07604197234200138 + 0.03380679206279256i, -0.2602010347304838 + -0.07512212014692886i }, { -0.005627668292856906 + 0.13496071773315238i, -0.09560062703980321 + -0.06158762731474879i, 0.05111884776657578 + 0.006015198476214602i, 0.0202233758554323 + -0.05839103845991381i } }), Matrix({ { -0.16425690300593393 + 0.0870921459994394i, 0.00346741818618972 + -0.15945725283943107i, -0.08228603793189102 + -0.13072393288427034i, 0.02567389838565611 + 0.11261980900366399i }, { -0.04155784145033003 + 0.013558506332452487i, -0.27165211883726825 + 0.059552302183650485i, 0.06592528832292016 + -0.05357502104837769i, 0.055985263427347914 + -0.0840566102271077i }, { 0.01787709482873759 + 0.05900804153492931i, -0.033869514421123244 + -0.0808823627332093i, -0.10106611233537909 + -0.016238691326605145i, -0.18861462105973478 + 0.08369612962055747i }, { -0.0059942266420313995 + 0.07872880892178812i, -0.011933510406598 + -0.04994826665603411i, -0.09022103505361169 + -0.1149630812113461i, 0.04137700732720702 + 0.10748542072262521i } }), Matrix({ { -0.09369079224006513 + 0.1331796308178098i, -0.09697659095895757 + -0.030558775103188444i, 0.006160407624534829 + 0.023576542943506768i, -0.1330745282806171 + -0.10266609674606465i }, { -0.12820439442267964 + 0.016663928250983822i, 0.01957711856779084 + -0.006144673857284497i, -0.026552401951124755 + -0.049939275312574576i, 0.12372337955650907 + 0.03556020517666908i }, { 0.0002732784717508364 + 0.08049289123119627i, -0.07141181220763877 + -0.009034498940341843i, -0.019457687826704134 + 0.0013492775364181454i, -0.05658515125690164 + 0.05002880035151246i }, { 0.04887094412440712 + 0.10851962918951423i, -0.024144818932649952 + 0.08535103084375885i, 0.06687272301805751 + 0.19523276243847437i, 0.02163181551609843 + 0.011276030169801209i } }), Matrix({ { -0.1714257675024529 + -0.019259024707419487i, 0.06982234304975743 + 0.09064567413063827i, 0.11445760974252213 + 0.2504832634486705i, -0.017949072780741263 + -0.08693486390292393i }, { 0.017121692740315796 + -0.0395768204820019i, -0.08561590325691845 + -0.038965798311427546i, 0.14335725553124973 + -0.13687490659548665i, -0.12074712834355933 + -0.045502741088211784i }, { -0.039416393683303276 + 0.08704801725009517i, -0.017210545684479182 + 0.14043269074247056i, 0.03403663651637118 + 0.097142974451205i, -0.052140343573374374 + 0.005593507591294435i }, { 0.03162877251889097 + -0.10060066916219085i, -0.011338387518263967 + -0.061336317211250484i, -0.0882745928035819 + -0.03400214132202752i, -0.18313253099612214 + -0.017744715034075157i } }), Matrix({ { -0.12919571442244482 + 0.0031123149469320203i, -0.04617554532552559 + 0.14106748194940935i, 0.024075704565520755 + -0.007878715534416943i, -0.11037431693235923 + -0.07087060467411482i }, { -0.10254174530642639 + -0.1699432099385059i, 0.21641797608717622 + -0.0803990390056102i, 0.03513244031244181 + -0.043441622679505104i, 0.05002149184307847 + 0.007990698003049765i }, { 0.1330563077146432 + -0.026173091130998957i, -0.03788323276580695 + -0.08810579034652741i, -0.008777727350757646 + 0.0612162496768381i, 0.09573669705142492 + 0.08161398746938596i }, { -0.027875853425616666 + 0.005311047778462382i, 0.17877106467118561 + 0.0936751718642321i, 0.049632330964602366 + 0.16121684467780417i, -0.12040086352527728 + 0.0618749479780056i } }), Matrix({ { -0.10622686819266985 + 0.13473993752924565i, -0.17045967563428466 + -0.005437045553838661i, 0.08802544228044877 + 0.08975633722262805i, 0.036738273446653306 + 0.09478025266265667i }, { 0.020923283339164184 + -0.09049891548591406i, -0.1434964666963902 + -0.17877416587130743i, 0.03491397862135424 + -0.06463777159054597i, 0.06889870083677067 + 0.02180229480605698i }, { 0.010659314943015658 + -0.07822438147665271i, -0.08051027141736924 + -0.04390081763280657i, 0.04246405257121093 + -0.0073641292481953745i, 0.03418109004070045 + 0.12808038859586113i }, { -0.06591254547331002 + 0.13927275950711426i, 0.07209518078372458 + -0.07850788897030266i, 0.03366667995954388 + 0.0659211624673142i, 0.0587711987391623 + -0.1445753241695518i } }), Matrix({ { 0.022204491136399787 + -0.0007737499185452726i, -0.024616957143969553 + -0.16340806344703157i, 0.006645494137548958 + 0.0570289960888186i, 0.012879839476297077 + -0.10042801407137052i }, { 0.0064551148122453175 + 0.03822737780163395i, 0.04523917169310943 + -0.11323517349402326i, -0.041134377960074464 + -0.03996806834867294i, 0.15551412665596187 + -0.021781373647188604i }, { -0.03266814486782334 + 0.11926444767289622i, -0.10707093270076476 + 0.031166583219669558i, -0.04621267692322487 + 0.13023553391957893i, -0.034083570778332 + -0.014489650790737621i }, { -0.06285956078417626 + -0.030140343779851787i, 0.21868161168714864 + -0.023913800544686607i, -0.15685333556897327 + 0.005622274117176896i, -0.08157820418837987 + -0.015511878578406765i } }), Matrix({ { 0.07317726758319482 + 0.004737011115023306i, 0.015511898968172571 + 0.013313169092118098i, 0.04925084999504147 + 0.0811288790581937i, -0.06277659071192869 + 0.01086253849963437i }, { 0.1691712463217498 + 0.08667186530185292i, 0.004952594667760516 + -0.08490927071819031i, -0.09749890884520927 + 0.13220944610239255i, 0.15100469341980066 + 0.07349214168728399i }, { -0.0026948478566298124 + 0.10956934927619225i, 0.06970129633749439 + 0.03242564728815474i, 0.02552002253987176 + -0.20362584959921767i, -0.03594184094654143 + 0.11548571058149787i }, { -0.16210586545126376 + 0.023965275796627192i, 0.10878239566900554 + 0.08868655659924454i, -0.011206064224479964 + -0.06683299804491256i, 0.07139997784153021 + -0.07062737518310397i } }), Matrix({ { 0.021267914383348747 + 0.05965797179398143i, -0.14083582895632213 + 0.09860658710242684i, 0.029924382437409938 + 0.08526392409195407i, 0.05936424791563425 + -0.01751254110890915i }, { -0.05074188758047267 + -0.0867802838216457i, -0.10752511488042775 + -0.07103307275291237i, 0.01484143202951346 + -0.12685637196518276i, 0.05018842034596208 + 0.11441188251984998i }, { 0.042196416850055714 + 0.0012052434668589572i, 0.07839176341132799 + -0.04538905838423583i, -0.15816607939732816 + 0.14917217976924466i, -0.21320281805099042 + 0.003283326896972326i }, { -0.05021690643097389 + -0.18521770907306112i, 0.021165835992405072 + -0.04317281525039485i, -0.18638428249097122 + 0.18226870915783652i, -0.016193660042696973 + 0.17779183120592232i } }), Matrix({ { 0.043343637580947475 + 0.051314034814615855i, -0.03378397812254805 + -0.08829356340893761i, -0.06709962720585523 + 0.07559662701583166i, 0.02581280437097245 + -0.08959376863183559i }, { -0.007385263208445342 + 0.10493909310056551i, -0.11500376085205263 + 0.1091726809608128i, -0.07387090584358585 + 0.07860667965372917i, -0.05204855219869549 + 0.003265271773021499i }, { -0.011953081216901324 + -0.21452906070834024i, -0.12587325190550627 + -0.044290315072548415i, -0.003072454473986434 + 0.014362717785273335i, -0.017536389372605 + 0.036205755230890174i }, { -0.07058780672197809 + -0.008835420916298272i, 0.04457896840282071 + 0.06524431962665593i, -0.1164421673943417 + -0.01242542137971666i, 0.0011206399863114694 + 0.01821987805181285i } }), Matrix({ { -0.0871314436285501 + 0.11700880641964898i, 0.036450402640150786 + -0.16512570574153088i, 0.09097377507826043 + 0.0058851323939853265i, 0.042919743070372565 + -0.05316375225394757i }, { 0.04555307177781007 + 0.06968609528505905i, 0.012144173864558046 + 0.032392277048169646i, 0.07713690333058892 + -0.0506054399872039i, 0.14223703589259762 + 0.08317467323218046i }, { -0.0936760513110977 + 0.1415272347327941i, -0.0036142645907316726 + 0.10244224274199247i, -0.15752058513152287 + -0.07977854608440973i, -0.06724308721180121 + 0.16036538307649273i }, { -0.1099097233447606 + 0.007964665836442602i, 0.12703626392185918 + -0.0027516750063815384i, 0.11442008900455039 + -0.038116601499985935i, 0.07432719544048337 + -0.06887044073261077i } }), Matrix({ { 0.07510978595925645 + -0.1354679522708624i, 0.12378231172392024 + 0.010514131460253776i, 0.17159136229437028 + 0.12158130492656682i, -0.026968244992446405 + -0.11908532972030171i }, { 0.08218005505393496 + -0.07921841024303967i, 0.19171732140374306 + 0.07089445715085957i, 0.1350819218638542 + 0.028990416889458196i, -0.055765746396381204 + 0.0975649172937485i }, { -0.0017980238721867232 + -0.10160983611080497i, -0.009354244910451052 + 0.04388266128005704i, -0.0727436710215838 + 0.004089389683839021i, 0.02918394893301615 + -0.17910785812216956i }, { 0.03559334495380086 + 0.05578321137492744i, 0.09779559207190232 + 0.17837027694012086i, -0.04089191098271194 + -0.006462985930801208i, -0.03840532440612876 + -0.0035470115027693345i } }), Matrix({ { 0.08214692520140411 + 0.031647643257280096i, -0.07579060768238363 + 0.08681450380206512i, 0.0732882367806277 + -0.08954127492816194i, -0.05251801446264185 + -0.009061125087503428i }, { -0.1665314539719315 + -0.13447888896628327i, -0.04308837709844568 + 0.045586771556617806i, 0.09404141579655415 + -0.07278024240830534i, -0.05579512537122745 + -0.05799504711208364i }, { -0.030990713470033134 + -0.0239921053569669i, -0.20794929756552036 + -0.05018354833149252i, -0.040460647335707596 + 0.024202716538946043i, -0.08685032145809644 + -0.041859158894241244i }, { 0.026097849461307613 + 0.044370800759234774i, 0.017306074195442927 + 0.027470389333794594i, 0.2097490097876252 + 0.0256880307355561i, -0.003969601877074497 + -0.10594662091026535i } }), Matrix({ { -0.08107856239705336 + -0.0879337706510718i, -0.02667268755862148 + 0.09142234896839534i, 0.03168521154772602 + -0.050623523457951146i, 0.11783666299462466 + -0.050911288741055i }, { 0.09518921048746484 + 0.02916686440687405i, -0.0721643864127648 + 0.026216287802098177i, 0.0697139053308976 + -0.040758544989172814i, -0.009239068989623764 + 0.001509326421147218i }, { -0.02425275215288748 + -0.027708625000959504i, 0.0033640048369720107 + -0.05112730405861462i, -0.059225113575282914 + 0.09623078545108016i, 0.09162389567984001 + -0.13327826201092666i }, { 0.0259205785132619 + 0.024700110949838285i, 0.008420333149402211 + 0.03295986796722099i, -0.06949589718426986 + 0.020112520567485245i, -0.024309487660397987 + -0.011868723541691899i } }), Matrix({ { -0.00908953900004489 + 0.17095957994531735i, -0.050079788348715674 + 0.006531209297477862i, -0.057392877224752156 + 0.017937945501991487i, -0.145538284088107 + 0.16711437531390488i }, { -0.09006410943470666 + -0.14972292299883064i, 0.008101880563527267 + -0.03351930566638607i, -0.08485663620721201 + 0.16095003936167296i, -0.09055954878491027 + 0.04806637455066587i }, { 0.028220352520680097 + 0.06015821732003887i, -0.03226212147343469 + 0.07208782616590761i, 0.06173233822957359 + -0.036399491821753206i, 0.05793979066784334 + 0.08967974878113916i }, { -0.03950232959044012 + 0.06304841247227898i, 0.15046017502326683 + 0.10529685387474422i, -0.11300116586558694 + -0.055929922814307594i, 0.20278998419739752 + -0.059912958164259504i } }), Matrix({ { -0.04731845734556975 + 0.10453390953223034i, 0.06781828222460613 + -0.07582390579131985i, 0.09532389082124869 + 0.11117365922099268i, -0.11157798490874508 + 0.1694848423122975i }, { -0.08331626337669913 + 0.08019005831070429i, 0.03962795366200633 + 0.04158127659210715i, -0.03487642197560759 + -0.07314446612499083i, 0.07506403577886701 + 0.028669838572290652i }, { -0.18370310865271808 + 0.026089486399671753i, 0.07118277644647755 + 0.055274593679648466i, 0.03358655221187911 + 0.11954544439180124i, 0.11896593015010153 + -0.025918627476351864i }, { 0.07761901278626751 + 0.011042881770777493i, -0.0022595212196288334 + 0.042515005764109784i, 0.11328067332778019 + -0.1113933827612627i, -0.05214201001850259 + 0.13320271946976484i } }) }, { QubitIndex{ 9 }, QubitIndex{ 6 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 6 }, QubitIndex{ 5 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 6 }, QubitIndex{ 7 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { -0.04428585783984951 + 0.07196752158498704i, -0.05704240070184605 + 0.023582149612967795i, 0.0743008048970144 + 0.02065428901271122i, -0.06755681573775554 + -0.10339536955112022i }, { 0.006030283620975258 + -0.03317897100942325i, -0.024594593733565623 + 0.08598845897128848i, 0.08758759346756474 + 0.08542451217027042i, -0.059690230077728126 + -0.05551132616076802i }, { -0.16907964796114203 + 0.1221192910774174i, -0.047396635620364815 + -0.21784664922636032i, 0.031787068899716754 + -0.06362529307540211i, 0.1160178599837519 + 0.026396048669857414i }, { -0.06684313783171536 + -0.13121860720589196i, -0.14417745081138952 + -0.20360993717833037i, -0.08773339133317751 + 0.0795204677437891i, 0.056517070752619115 + 0.04619395601625517i } }), Matrix({ { 0.05429121308119397 + -0.14647844206476596i, -0.15296098532913502 + -0.031630697798000554i, -0.05556317337283058 + 0.09268779362406405i, -0.05180480227112074 + -0.00255013881738091i }, { -0.1979558841054313 + -0.13930672670927227i, -0.04360122623778946 + -0.07121690732284407i, 0.03285973272454904 + -0.09573857802407613i, 0.13386865208058177 + -0.04064255803821583i }, { 0.05988850446362012 + -0.019858559122469973i, 0.12490162292847495 + -0.03491723384208701i, 0.022403790789263193 + -0.1383635848615102i, -0.17158512261730838 + 0.08779107202475459i }, { 0.009871656354560407 + 0.04613337999316377i, 0.0030619480205756307 + -0.0785940186919205i, -0.07204154929716 + -0.11507918338245467i, -0.0059822396643924025 + 0.011649468581052582i } }), Matrix({ { -0.16762682821765826 + -0.07682493785198788i, -0.04805003732005616 + 0.10542374987050765i, 0.05543841303902587 + 0.06659449665435202i, -0.010783316926959498 + 0.05038282838953529i }, { -0.02725379231535461 + 0.008890696324636304i, 0.15492996583772314 + -0.020491828276630424i, -0.05830270308312067 + 0.1318050951180469i, 0.0634420583488373 + -0.12333893378581884i }, { 0.13668778371452245 + -0.03369916957585114i, -0.0046193818482884105 + 0.10980141571631769i, -0.020849377713272586 + -0.05310252778886763i, 0.02904741627918107 + 0.05656467767001534i }, { -0.14867393083413757 + -0.15651176618715334i, -0.06214444184930055 + -0.06418258519655513i, 0.21533956343552435 + 0.048056862923400605i, -0.10246161853013935 + 0.06706822838529775i } }), Matrix({ { -0.01594876882195983 + 0.18044949417818718i, -0.0788879999871697 + 0.06694671354629284i, -0.03488645348671057 + 0.10800361168242056i, -0.16273451379277926 + 0.16183302647272058i }, { -0.0567236322421289 + 0.046583557478011385i, -0.0019537959127695196 + -0.09091651715751718i, -0.10572471757043896 + 0.03555414358032797i, -0.1728027846696144 + 0.14052281161295907i }, { 0.07124666599621261 + 0.0594418405018191i, -0.021007541466799243 + -0.11242528199443957i, -0.09882799278197384 + 0.042503682964841166i, -0.033817009724544225 + 0.09197349914512214i }, { 0.1556420773093452 + -0.05714706961352443i, -0.023107433775032462 + -0.02945815249241391i, 0.04938830903838952 + 0.13729302973804994i, 0.010583323139872947 + -0.1229185362554869i } }), Matrix({ { 0.11831941769594354 + -0.08402997613328936i, 0.09095295794880318 + 0.040624985102741i, 0.06523741010786682 + -0.01159257965341211i, 0.03384303452593533 + -0.06826659555858827i }, { 0.04468171014327833 + 0.05047482998199497i, 0.11376509055354282 + -0.05686782939297386i, 0.04761165525575475 + -0.09987807860966184i, 0.1135645626165557 + -0.0519849305456424i }, { 0.06306826302371407 + 0.034241876669210365i, 0.029408975341515292 + -0.1316593668273144i, 0.09574163079525717 + 0.022649629458537414i, 0.020514695690687673 + 0.012657705848287577i }, { 0.02234515681186113 + -0.16122574229287165i, 0.020166577163754678 + 0.061482050940295525i, -0.1310096311171662 + -0.1510386921841592i, 0.11093997916962654 + -0.06694985515303559i } }), Matrix({ { 0.10295817619288539 + 0.012306207024546247i, -0.07357906362596868 + 0.022639924445665056i, -0.0453910945511079 + -0.05460372136251192i, 0.061172389140112936 + 0.1323337046649451i }, { 0.015840442116778562 + -0.0597797346635943i, 0.00949158841838999 + -0.1520801368763291i, 0.09693740668044587 + 0.07830488334370417i, -0.05699451110113179 + 0.0003713245237612918i }, { 0.05111799290190707 + 0.0681608794983383i, -0.036635034059099146 + -0.09488348950493135i, 0.12889582569466265 + -0.13005084816204207i, 0.08755340390857785 + 0.10037848425157174i }, { 0.23786654024085332 + 0.008711938087207657i, 0.12034454220663458 + 0.08416901335315134i, -0.009264304304559785 + -0.03689334728386239i, 0.038694261291287724 + -0.004302285062257916i } }), Matrix({ { -0.08843013828602281 + -0.04398540779869778i, -0.0848371600565942 + 0.012596484524887507i, -0.0016811889383973864 + 0.0721786010146814i, 0.03804395813587168 + 0.06589679858554291i }, { -0.022729798346051083 + 0.11171073381538546i, 0.1419778251601521 + 0.014672197074044125i, 0.015215863132867673 + 0.028985372057043948i, -0.034177172100341525 + -0.09545589777279609i }, { 0.15393093868317026 + -0.01512594640162388i, 0.1267782173215536 + -0.012533545180621544i, 0.08885957174866226 + -0.058000105859728694i, -0.027453270134680508 + 0.07938223979145995i }, { -0.03788810900357774 + 0.1106436862111647i, -0.033978807911499945 + -0.024258327498623115i, -0.08663880822727262 + -0.09805838201496316i, 0.042370354811224815 + 0.024581343864341017i } }), Matrix({ { 0.057921244876800254 + -0.010898035292950931i, 0.004627119677427528 + 0.04861520869800658i, -0.17011608423895225 + -0.11228285644611384i, -0.1426273741322074 + 0.17228960535549465i }, { -0.11983442239862806 + 0.024381079156005105i, 0.14352683728284257 + -0.03523726946091046i, 0.025404739615198752 + 0.05223079306367574i, -0.1880792725690373 + 0.12421492675345362i }, { 0.15490835614560025 + -0.10484900623068516i, -0.030919630793776767 + 0.06709116078395924i, -0.15507545178736556 + 0.04109483735156487i, -0.0032260487001927757 + 0.085047985203495i }, { -0.033296316013756974 + -0.048457632899828164i, -0.08823312129417651 + 0.0382375015206256i, 0.18422144187873904 + 0.07137665159919807i, 0.028987104847250023 + -0.12445141867010973i } }), Matrix({ { -0.1257954296736339 + 0.028994497807620055i, 0.1116012502140081 + 0.008805372462263298i, 0.11966542201259883 + 0.01579884344157432i, 0.07559257049083679 + 0.1310867227932948i }, { -0.11767933339271594 + -0.04663124194052785i, 0.07116083862766082 + 0.04361053707947315i, -0.0030879022183958175 + -0.07917639202223342i, 0.23847271219784244 + 0.03148500178483532i }, { -0.0061083579712954 + 0.05596408947565701i, -0.08448781149173559 + -0.09969269170981065i, -0.0010197410306298103 + 0.22962310944974534i, 0.024491815405833898 + -0.04106620690674763i }, { 0.014070007578928278 + -0.15363468037039082i, -0.11459054025435253 + 0.10361871607377598i, 0.0010883297973935486 + -0.01069189673868722i, -0.04269125474059836 + 0.14989602342066105i } }), Matrix({ { -0.17266048410907758 + -0.04398394396753963i, 0.06677808356409007 + 0.04528367090941429i, 0.01223766722364608 + -0.07054094403914807i, -0.11783466664973594 + 0.04023697497800374i }, { 0.024426862067290275 + -0.04289079121253171i, -0.003080476622042592 + -0.13936908348315197i, 0.13311132202462558 + -0.010740503818415884i, -0.06711986623658057 + -0.010973675529647418i }, { 0.04291144945932379 + -0.037486789724750454i, -0.23551481120286996 + 0.15155473412899859i, 0.11762835401867823 + 0.1455501830678983i, -0.0689444020454723 + 0.10081010597579686i }, { 0.03730526613021052 + 0.0047690921389120225i, 0.05497009589420209 + -0.10483968547927126i, -0.13459755922911168 + -0.08224362799232823i, -0.06219524626714617 + -0.09080228606579373i } }), Matrix({ { 0.08334112839178205 + 0.06405142202623579i, 0.004889846246024853 + -0.0800586020711521i, -0.03894842553812791 + 0.07673565607144298i, 0.15130723607352306 + -0.02020139738008774i }, { 0.0718784686732546 + 0.09713178297730321i, -0.023409268217259693 + -0.0305593091258999i, 0.058820757675094516 + 0.04646505895244106i, -0.05569622281985187 + -0.054623864138278376i }, { 0.018510020212618564 + 0.014149361853928032i, -0.02359669523287138 + -0.04356455684451852i, -0.1621790746580698 + -0.0403224040962971i, -0.0012461222894980886 + 0.012561198915236105i }, { 0.06542582269067783 + 0.051819539805899685i, -0.010618352363977799 + 0.20005427628626044i, 0.04250308234131154 + -0.05713938615024318i, -0.022002677970896885 + 0.0507477227460547i } }), Matrix({ { 0.026599607528369575 + 0.08023691169039104i, 0.015545878951279455 + -0.03708449704037783i, 0.08938613262244975 + 0.14264167216959034i, -0.06149643128328823 + -0.07862666651659678i }, { 0.1188142271702724 + 0.03775019570769852i, 0.03742950932233103 + 0.08876317914772841i, -0.12147619459234159 + 0.06527627782425978i, -0.053732087430953375 + -0.015543468692959073i }, { -0.1859844047654627 + 0.11172929208995211i, 0.02401967265244784 + 0.03177974900214368i, -0.051522069987125205 + 0.19867385808223798i, 0.11124279961550991 + 0.1096972533004618i }, { -0.14012346719072982 + 0.07740798366474722i, -0.012800183060199932 + 0.023776815312634682i, -0.10363499620126179 + -0.09910618221079233i, -0.23835038923469765 + -0.062453595562032525i } }), Matrix({ { 0.042399338876328845 + 0.09889445988653371i, -0.23396467211767696 + 0.08176296036995677i, 0.056249650033895086 + -0.05274399832805925i, 0.1170852016857338 + -0.011440650187399972i }, { 0.016305141680244786 + -0.07517886812545488i, 0.020263106125854437 + 0.21726373390677514i, -0.002172652077855106 + -0.014294730704829891i, -0.12692529879145867 + 0.03431345629484198i }, { 0.054766970751613825 + -0.03930936557129065i, 0.08197531239824564 + 0.04490717971663138i, 0.06754820630513675 + 0.15547262627066616i, 0.15200003407756732 + 0.014974487416894233i }, { 0.07470460922020203 + 0.05644065200298714i, -0.025873451325452344 + -0.07477444468601775i, 0.1220505785741061 + 0.07167443316852838i, -0.052288383351539826 + 0.10005881102382252i } }), Matrix({ { -0.023773515427426343 + 0.03523642223594894i, -0.12432550637265402 + -0.05242617944419868i, -0.03485517385548049 + 0.005101525997619965i, -0.00312547069387935 + 0.09573342508250005i }, { -0.005368551535204155 + 0.08642051762877478i, 0.07265281659380037 + 0.123958002520606i, 0.0006238980289394554 + 0.04180056280399761i, 0.06345237667049132 + 0.11315862395258552i }, { 0.0662724640441586 + 0.05605485129734193i, -0.029835656314675028 + 0.07509056014388582i, -0.09256702224831005 + 0.12206801418456784i, 0.1427593886335064 + 0.008841040653459939i }, { 0.10971721179980574 + 0.04772452455913075i, 0.08275524214421298 + -0.1543446447811101i, 0.11320843076247535 + 0.014200304260401543i, 0.14145722599806557 + 0.07058831232879757i } }), Matrix({ { 0.07279871726568408 + -0.05749398949199343i, 0.051475528176071386 + -0.1507377946046772i, 0.11904657400746518 + -0.025801700977212128i, -0.022627788729654586 + 0.07155116053908768i }, { 0.1829590730589271 + -0.16799281432017119i, 0.022019183469044152 + 0.0532335884535809i, -0.0884679990213521 + 0.03608424704187732i, -0.06700513944116036 + 0.045216869163206254i }, { 0.01865539443128149 + 0.07303652001219753i, 0.03313843308779401 + -0.07281746609114584i, -0.0725191962244246 + -0.057403619120803745i, 0.041028673069105535 + 0.01751503394626017i }, { 0.011913315369432194 + -0.04850915594605663i, 0.005677453242649025 + -0.08650181252776291i, -0.07173772369144794 + 0.03259832177702601i, -0.03194373567979641 + -0.015356472563530782i } }), Matrix({ { -0.06231840816609047 + 0.09935308843694472i, 0.05483701654728046 + 0.09787113785359278i, -0.08044432469453693 + 0.08612000623883258i, -0.018763576919965826 + -0.1896457657612462i }, { -0.05204633847652424 + 0.03953894037039689i, 0.10098067847647624 + 0.026038798165500487i, 0.032886448127755236 + 0.051885487351150616i, -0.023005622910886488 + 0.0641029551778751i }, { -0.06366728818534038 + 0.10473476914118673i, 0.018805148059418984 + -0.11907773896566065i, 0.10056302854962915 + 0.13818626283694566i, -0.016931355074937062 + -0.023855032454138142i }, { 0.07681358939775695 + 0.0488205891093818i, 0.11442210180309115 + -0.0004468328578955741i, 0.025148184976161787 + 0.04649758627736025i, -0.13167237534577678 + 0.0012756540489179328i } }) }, { QubitIndex{ 7 }, QubitIndex{ 4 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 1 }, QubitIndex{ 0 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 9 }, QubitIndex{ 3 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 2 }, QubitIndex{ 7 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { 0.14128766023603267 + -0.07360263346396274i, 0.025064238091142686 + -0.029024557997791613i, -0.08638671708493556 + 0.07183259767270792i, -0.018764064555686466 + 0.023820669353330593i }, { 0.10856807613508619 + -0.005203246620379661i, -0.011131203222803285 + -0.003946843011630335i, 0.06716972843541358 + 0.04471421187275258i, -0.032586573520520606 + -0.2571710083320586i }, { 0.025476183944625003 + -0.051303245755486636i, 0.08032371364580945 + -0.07677580763126635i, 0.013455420373961125 + -0.0355686993190332i, 0.06301934410334595 + 0.16473836114163004i }, { -0.00018990079074341325 + -0.21410171047591545i, 0.0732710236386069 + -0.03930524289914161i, -0.09273058260117413 + 0.07368265850937826i, -0.08177660660729687 + -0.1181328628180322i } }), Matrix({ { -0.041919948203874006 + -0.06477298847942396i, 0.043318615448538274 + -0.060772888922488354i, 0.1311391960439979 + -0.0005993745268623799i, 0.0006527085946994354 + -0.02296074894367871i }, { 0.039494732506552305 + -0.2136009966887472i, -0.11893121393746277 + 0.020734676567868333i, 0.18357112168984221 + 0.15049103919746645i, 0.0727113697653899 + -0.05880253156487595i }, { -0.0012955329798423696 + 0.026783622106656586i, 0.1075383828940283 + -0.07945608399063249i, 0.08333292978030155 + -0.047033032257754945i, -0.016887796173159605 + 0.015091902250610368i }, { 0.0009038824799669581 + 0.03777414306013952i, -0.05469554510987723 + -0.12481753355112943i, 0.06779792259061661 + -0.026039568923481735i, -0.04885541812387665 + -0.035266833927996254i } }), Matrix({ { -0.09413638989071624 + 0.007377087978323389i, 0.012993746731642428 + -0.12620148866828979i, 0.009192139661822954 + 0.025479444194495132i, 0.1416934479967273 + 0.1130792820971088i }, { -0.014793456583800515 + -0.10605113345742861i, 0.05868542741499751 + -0.10817080640167928i, -0.14193863401525922 + 0.06667492462427863i, -0.10209010361271123 + -0.03398943423633718i }, { 0.12220497095286514 + -0.10898582530055524i, 0.11992317322515564 + 0.011233762336341895i, 0.1560862084491391 + -0.05432922496308389i, -0.026217333762635756 + -0.06989703837049771i }, { -0.04630267965554533 + 0.02576826069872885i, 0.05186320396310613 + -0.14285284138735269i, -0.06469411554648823 + -0.055291111245983175i, 0.009254567961884699 + -0.11447564523528377i } }), Matrix({ { -0.0037683717049148036 + -0.018516095380228973i, 0.014222274327612715 + -0.021940045774571083i, -0.07874172585685336 + 0.13730605593684428i, 0.08934585257251669 + -0.0834646574687081i }, { -0.012036010844683215 + -0.06399390128044259i, 0.18634285278342563 + -0.02077582340099551i, 0.10363744893128807 + 0.11539708257745007i, 0.007226141639485522 + -0.004088143034048763i }, { 0.06884614623505705 + 0.04729925929900687i, 0.04110449259344891 + -0.15313773936782032i, 0.03675726429616002 + -0.09154634186702533i, -0.09271899010110367 + -0.005117568758022259i }, { -0.09654840814572221 + 0.03789947141934065i, 0.07502560708262145 + -0.027279783201635776i, 0.1341257525729598 + 0.05738600377297255i, 0.024224373735571254 + 0.04848062672389801i } }), Matrix({ { -0.02819576653584914 + -0.12610725522859553i, -0.15178365333644794 + -0.08552745845148665i, -0.1263227966939883 + 0.1722796550109948i, 0.09371570357048024 + -0.1317876331444568i }, { -0.1325185884497132 + 0.048743947523710404i, 0.0776837537083547 + 0.05035513525515699i, 0.040927290880420845 + 0.03385627527812977i, 0.14337775616000226 + 0.07513952488261659i }, { -0.07328539483695393 + -0.1151913293384706i, -0.008145431557488397 + 0.0451414693409424i, -0.06298740046631106 + 0.10142944333291033i, 0.0049695803724220935 + 0.08140463938936982i }, { 0.07558777328869294 + 0.028629950736675992i, 0.060723406703556554 + -0.03674009577703875i, 0.10721031847477175 + 0.11161619039692586i, -0.1827306425745933 + 0.07882690059640567i } }), Matrix({ { 0.19308239468008637 + 0.028175627622178318i, 0.08960190609630328 + 0.19448511832737744i, -0.02586033239445234 + -0.040959828177027535i, 0.08251441820261383 + 0.10459852343754808i }, { 0.09285967554734567 + -0.2000583543693145i, -0.11493584862274613 + -0.0828711299704131i, 0.07889657737276526 + -0.003479235067889594i, -0.03836128596753908 + 0.03126721177955173i }, { -0.044499440980168246 + -0.07642045807075942i, -0.12993134724548322 + 0.0677196755141006i, -0.004712658965998955 + -0.10559892762836902i, 0.12571418892138353 + -0.07653738613400848i }, { 0.018665040935365324 + -0.018391952075415535i, -0.16098507761593012 + -0.009218288575071325i, -0.09116734236467156 + 0.062067940217761956i, -0.12433791929912992 + 0.1270957204418911i } }), Matrix({ { -0.020250806735806374 + -0.005276583251584968i, 0.1132064658146424 + 0.013137660644812477i, -0.03269477644769903 + -0.009256251550482288i, -0.01824899401758022 + 0.15385566859621558i }, { -0.017546568901899658 + 0.2634000310814204i, 0.13370707229525228 + -0.005972218411044403i, 0.1920548039796616 + -0.015613086562431626i, 0.0019018383907226494 + -0.09146716486133842i }, { 0.08091257681041539 + 0.030939545904496775i, -0.05344903849803232 + -0.03239293348550499i, -0.05957774790373927 + 0.1081292411205098i, -0.03666314534534081 + 0.05164680213105919i }, { 0.09501331133631588 + 0.005474581050943613i, 0.02399827437431887 + 0.0655286437312647i, -0.13463648803606645 + 0.0034097030265199226i, 0.06322814008886984 + 0.11136077302397726i } }), Matrix({ { 0.010467475115815628 + 0.09050140400508133i, 0.07510843742196242 + 0.03133912984578243i, 0.13674740330331647 + -0.05072307580085425i, 0.01748104263687924 + 0.01835265219258524i }, { -0.05544404283094301 + 0.01681697507389673i, -0.07918718940222605 + -0.06723974956834322i, 0.03416710706751702 + 0.03328882713141602i, 0.04098560269039021 + -0.08594753299535293i }, { -0.060534130149379715 + -0.02050138839681208i, -0.08771405996426232 + 0.02694989789311556i, 0.08300278974722752 + 0.010073095181061118i, -0.010773545258955235 + 0.022278338374701417i }, { 0.02284377669594237 + -0.14585933530264839i, -0.1431150708255965 + -0.07333425615889409i, 0.07432528653993259 + -0.05785222210132633i, -0.033008098919692364 + -0.1441889581364724i } }), Matrix({ { -0.059885956072803365 + -0.1507941441616195i, 0.030363945233833598 + 0.06941179613612543i, 0.029796530438431078 + 0.02123400657069754i, -0.00025828986470696037 + 0.012006067546441615i }, { -0.07544255712837517 + -0.09866037808018542i, -0.06759387548109516 + 0.09926706114891552i, 0.15657877126466685 + -0.13131595299243098i, 0.07823511467024015 + 0.16007304872677303i }, { 0.08836633768914288 + -0.03866270087538466i, 0.027206640667623287 + 0.043783009290365944i, -0.02425734765657677 + 0.2158492753350834i, -0.031348885342888155 + 0.12005772843990868i }, { 0.050200290001530715 + 0.017519024501373832i, 0.011883015894745755 + 0.04214814913948494i, 0.02004796296628607 + -0.1349827034927779i, 0.0468592930646556 + 0.034156001870437235i } }), Matrix({ { -0.12457482965386495 + -0.008097403828254803i, 0.04392148712160738 + -0.15946231779077547i, -0.07891091445793184 + -0.019360514976403377i, -0.04868769959158269 + -0.056545360355046294i }, { -0.024760813786546376 + 0.08343209749146002i, 0.05664990284696051 + -0.0013636706072780297i, -0.0530846202154764 + 0.07552571831993238i, 0.10308395971761407 + 0.09280823866462119i }, { 0.012760671390950022 + 0.0895314453791932i, 0.1673852304555729 + 0.21052675299972484i, -0.002161972585643482 + -0.010212550663353793i, -0.01078731910643203 + 0.13897197931130326i }, { -0.09792999768482698 + -0.038058169408648694i, -0.020435956398049654 + -0.0769139596714407i, -0.11045220370594995 + -0.14178891022749623i, 0.008833037470710119 + -0.06873720961721003i } }), Matrix({ { 0.0039019292501087364 + 0.039777077981089294i, 0.00195271715298517 + -0.057236881543424864i, -0.08476432850221824 + 0.007243710993526197i, 0.014014755358358307 + -0.07240815508030718i }, { 0.03080134617429557 + 0.12656173418858696i, -0.06192321976937716 + -0.026815738829172153i, -0.040505819512643114 + 0.04171922385081865i, 0.032825258906067335 + -0.12579820452566778i }, { -0.032839890022381 + 0.1364672867865016i, 0.09025037555292761 + 0.03383222041498138i, -0.0006127921319280522 + 0.042315713524194845i, 0.1294176806913549 + -0.10760384556226568i }, { -0.05917468415582833 + 0.026418171627941873i, -0.11621255665454425 + -0.23537398240844812i, 0.10102240299433332 + -0.012281593647911765i, -0.014306216488354454 + 0.18468393616415368i } }), Matrix({ { 0.03457653465593116 + 0.08951653458285838i, -0.053943986907877994 + -0.08333417365362807i, 0.06908641198053608 + 0.07327361614296125i, 0.08176497024377134 + 0.10040237356945507i }, { -0.12197424021968392 + -0.10038882493019705i, 0.11689949787617611 + -0.21240782792798213i, -0.02227749925597546 + -0.12075428515949063i, 0.0002681562171967478 + 0.011079746833101417i }, { -0.022359263749785332 + -0.1136578374743825i, 0.06651300384063688 + 0.1605749127647452i, -0.10945612545701992 + 0.005788172029458889i, 0.1656828035798184 + 0.11504319956312645i }, { -0.019087064597422713 + -0.1304616138281412i, 0.14364043760345474 + -0.0030870386544819676i, -0.12708623616367098 + 0.13799492500916555i, -0.02605522722075569 + 0.058500863177402135i } }), Matrix({ { -0.20422629927061667 + 0.02738463794559834i, 0.017316070149310664 + 0.03841806357066015i, -0.10442927186116192 + 0.013003696362936027i, 0.02530346999956178 + 0.0438037486554148i }, { 0.07104669264241555 + 0.10771873469463664i, 0.040741532588884924 + 0.12425458879347258i, -0.13146046229950198 + -0.03172392455953986i, -0.0703325125744815 + 0.05364275524051345i }, { -0.049369061038651255 + -0.06705395482980778i, -0.03473406194881012 + 0.06361488434624278i, -0.06323037598038808 + -0.10339110702838708i, -0.10501863208421819 + -0.06396937938898349i }, { -0.08431071674449525 + -0.0327740573675085i, 0.02316150763100305 + 0.016610575582544463i, 0.0619388938819836 + 0.08165621969289935i, -0.0797964454021696 + 0.08066770428963968i } }), Matrix({ { -0.0567079784422435 + 0.0135861220093159i, -0.11637037239047432 + -0.018849241755927556i, -0.12911233995565496 + -0.0011876309383155072i, 0.10170909367258084 + -0.06594657410715975i }, { -0.03731913697849514 + 0.08921996850524266i, -0.0715613707104054 + -0.08407138487360612i, 0.03722110381371639 + 0.2093351260294551i, -0.109233519931365 + -0.1810618245761647i }, { 0.03728326448922135 + 0.05753285168282813i, -0.022316164170193522 + -0.10972396624687346i, -0.21012740288341167 + 0.010381544701310096i, 0.018676785471041762 + 0.13293800721356813i }, { 0.03950447690835055 + 0.050952090861947075i, -0.02149735615182117 + 0.07421997188725493i, -0.07279168155255059 + -0.12161611036044788i, -0.02316082643640486 + -0.03780972375598872i } }), Matrix({ { 0.10099520619529216 + 0.1093605839111396i, 0.19051697973063533 + -0.022087952415559945i, 0.08428476172840889 + -0.0021945723668608834i, -0.0025515970485950343 + 0.02921735416020798i }, { -0.10794852321597616 + -0.08466369035938989i, 0.0015506625895966826 + 0.08373845181451868i, -0.1432459531110124 + 0.06310288537998308i, -0.01590172528571624 + -0.13799733360973768i }, { -0.2153797928515051 + -0.07659151860476454i, 0.12242212691677769 + -0.1858543561331168i, -0.05440691769189325 + -0.02149607671802919i, -0.1351670973323134 + 0.18052119674916733i }, { 0.060220101014632696 + 0.06969645430310285i, -0.06592031581743796 + -0.059167279183763605i, -0.08468277451475248 + 0.07805319274694733i, -0.12566147332637975 + 0.1915902745286721i } }), Matrix({ { 0.11829368804381415 + -0.10811433742558331i, -0.02733586259071461 + -0.04202426225714639i, -0.05134832144433838 + -0.026930248603253302i, 0.049965887534114885 + 0.062037578013170065i }, { 0.025056944898014535 + -0.07095551545189854i, -6.5720435964641445e-06 + 0.052259253414298254i, 0.05863844424728963 + 0.02666901616369741i, 0.004675460589178888 + -0.10338354022159615i }, { 0.1344276295209225 + 0.014068307459994146i, -0.08628457004659383 + 0.021127063761403206i, 0.007282330804196583 + -0.041818316928652705i, 0.06926156497721359 + -0.032120922561438295i }, { 0.019639847533530798 + -0.23143608276763253i, -0.10781385718082995 + 0.023163630274691573i, 0.1276376940378163 + -0.03785923275666263i, 0.09602568914964422 + 0.011035535053120283i } }) }, { QubitIndex{ 8 }, QubitIndex{ 9 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 2 }, QubitIndex{ 8 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { -0.09506794836222632 + 0.3353026915476007i, -0.27281699550714844 + 0.35488547656820946i }, { -0.4062761374098185 + 0.1257185466226129i, -0.24585787708212875 + -0.17818319552891906i } }), Matrix({ { -0.3512780075360746 + 0.04847103980715775i, 0.04813691593050791 + 0.23290399151155178i }, { 0.24597971378321937 + -0.43339262881686663i, -0.18881046972503487 + 0.13870623352203332i } }), Matrix({ { 0.10582818597390846 + 0.489795940680782i, 0.30939849443755824 + -0.21606578697326967i }, { -0.048304257128044925 + -0.03307174422503412i, 0.07244399933863509 + -0.4161074248134552i } }), Matrix({ { -0.0004956692240690314 + -0.1123141839298298i, 0.2775369646710957 + 0.19460956073787103i }, { -0.20389954567131213 + -0.12194839300281021i, 0.28983833128855385 + -0.2761708042117685i } }) }, { QubitIndex{ 3 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 0 }, QubitIndex{ 4 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 2 }, QubitIndex{ 5 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 0 }, QubitIndex{ 8 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 4 }, QubitIndex{ 0 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { -0.11034601777104536 + 0.00394916280486873i, -0.32533132114963853 + 0.26947006593029965i }, { -0.15475736011758323 + 0.15341584907139866i, 0.3809684470456372 + 0.22678013155983576i } }), Matrix({ { -0.1948073771386677 + 0.6860063575220167i, -0.08431265064422838 + -0.0813953801043889i }, { -0.11366493124778665 + 0.1815636031627791i, -0.46614641007868307 + -0.15708076810110919i } }), Matrix({ { 0.07723978418924414 + -0.29226967611305044i, -0.3777074830701947 + -0.16339956647072743i }, { 0.021745533851384655 + -0.030569615998577306i, -0.014419563290370724 + -0.03912834500893448i } }), Matrix({ { -0.2235349016377632 + 0.04438247187356954i, 0.03618222005796629 + 0.327685511248532i }, { -0.45230063098705403 + -0.19124269274498779i, 0.15954757975717637 + -0.25305111187039736i } }) }, { QubitIndex{ 3 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 3 }, QubitIndex{ 4 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { 0.0986961909227897 + 0.14019760482293175i, -0.09019716361965033 + 0.042525755238920354i, 0.020548808231047152 + 0.16524323015911066i, -0.014689572267799073 + 0.017301040503223498i }, { 0.08631759787222876 + 0.20164842685441683i, -0.12828199245361394 + 0.04821212447261179i, 0.13274331622437746 + -0.005153777434473638i, 0.15283984495058772 + 0.019826563023210356i }, { -0.10174821491958608 + 0.008063188257045759i, -0.12847823500517244 + -0.16256894449175255i, -0.02409188809543778 + -0.07361307225180881i, 0.12559630494782764 + -0.04064483334488573i }, { -0.06739599015921656 + 0.05569609312778974i, 0.08594385844288067 + 0.031278898849994415i, -0.05581644378988226 + 0.06951995535023288i, 0.06719828485352737 + -0.027712907385951092i } }), Matrix({ { 0.09032700225665585 + 0.1058859330343232i, -0.018812784019380132 + -0.05967627673279333i, 0.26596824179878475 + -0.030986742914996143i, -0.09633237782360678 + 0.06081189122207707i }, { 0.056004093263986005 + 0.07969375035106113i, 0.1834879958369057 + -0.05905333027589479i, -0.039012158070473375 + -0.008650215580368532i, 0.05750293613706849 + -0.137010808698897i }, { 0.027513381634800237 + 0.20217388895315494i, 0.011849449266894558 + -0.03287767771494231i, 0.09416350528894457 + -0.013091772376969742i, 0.13221256792995606 + 0.020857858451773487i }, { 0.031935339400410864 + -0.025868221883606695i, 0.006157119337269567 + -0.03196221460223887i, 0.0039947865759030424 + -0.03393930098789286i, -0.023245824235851864 + 0.14836797453103828i } }), Matrix({ { 0.03263948471075011 + -0.019083654741274554i, -0.08481414988186638 + -0.023853683734347i, 0.05965878021662001 + 0.1047253129902408i, 0.02795584579549986 + 0.14296095241485973i }, { -0.16743657781798885 + 0.022194608482991898i, 0.0055570145287844215 + 0.08493537874666517i, -0.06458196628539069 + -0.026673717573976175i, -0.019260514355401492 + 0.003911588277550258i }, { 0.10953106716707145 + -0.011329990121207362i, 0.04678261666937086 + -0.0961469616357313i, 0.17814059998405796 + -0.11223940465921062i, -0.037277634940100265 + 0.03582449550081682i }, { 0.00406298509520117 + -0.004215575482305532i, 0.1045580712686315 + 0.017995453578625933i, -0.01778998495962087 + 0.012932575788760418i, 0.02620878009223075 + 0.035166080851258295i } }), Matrix({ { 0.032693796609482954 + 0.12311050990758501i, 0.02003918514279362 + -0.017619855376645593i, -0.05168926890766474 + 0.1231043268875663i, -0.003916221843142227 + 0.15161189378892403i }, { -0.008736156840606683 + 0.015328726363977611i, -0.04147414554048061 + 0.17048082660598163i, -0.03096033591438398 + -0.005686303438590822i, 0.11400639333425261 + 0.018965488110209903i }, { -0.008157448111867343 + 0.0794297155520613i, 0.09782570558044938 + -0.039220899583522276i, -0.09033920454967093 + -0.11763030228830247i, -0.07000859226320823 + 0.06772216627497779i }, { -0.0429548342859284 + -0.06346784878266971i, 0.04086741958327154 + -0.03593180524369793i, 0.13714232465679632 + -0.0415371113096758i, -0.06951199885951194 + 0.15089200677565817i } }), Matrix({ { 0.12629284030691942 + 0.020813734868416103i, 0.0860163390464989 + -0.0719121949189096i, -0.09494548400989625 + 0.008996667601374932i, -0.04533464660329469 + 0.07074985834215951i }, { -0.011941715807295009 + 0.09040781781023668i, -0.07474508137023518 + -0.07044720091035633i, -0.03587510718339443 + -0.20739827999649074i, 0.0014568199972815313 + -0.014835153744097123i }, { 0.002994441063278494 + -0.10189543985308194i, 0.13711662537073002 + 0.070842825024316i, 0.07953300741483861 + -0.18739074574796627i, 0.2624815001684533 + -0.09493536220031927i }, { 0.16818838963612545 + 0.025943524214331506i, -0.0008821162217032422 + -0.030260780423177865i, 0.04617812311246229 + 0.0002415450890221459i, -0.0005454055261634059 + -0.07845220879675333i } }), Matrix({ { -0.01976467063883215 + -0.015893803409844066i, -0.10736103371865745 + 0.06295727962112224i, -0.04649929588901951 + 0.028904685361685223i, -0.14249497131778882 + 0.09977926444900716i }, { -0.0038168046883281675 + 0.054954364373845405i, -0.1495471809437983 + 0.00724923244886163i, -0.020690238313204337 + -0.12022867095588959i, -0.10700902967311389 + 0.02169840934571352i }, { -0.055483714395149125 + 0.011688783143248985i, -0.0676939031227261 + 0.06688085778417611i, -0.0006901710300550085 + 0.03679876600254034i, -0.017377127556852657 + -0.08655506825889311i }, { 0.018338685017398437 + 0.03983675120136318i, -0.037785524841665294 + 0.05671743293332354i, -0.015906750252025 + 0.0034099680420269242i, -0.08141249702014522 + -0.15761681236459174i } }), Matrix({ { -0.03650781692491448 + -0.00988969019807067i, -0.27664234695540413 + -0.0014193116917055799i, -0.02156310215708155 + 0.1106705177453547i, -0.051542006196255395 + -0.018510908748754433i }, { 0.10869301874411989 + -0.1341366485318985i, 0.1384142846870926 + 0.0718593345319337i, -0.0530644473653592 + 0.0024153252211344513i, 0.08648280810414578 + 0.003860100766668023i }, { 0.01793312029180731 + 0.15001954284647484i, 0.0461839223717779 + -0.018603747510084586i, -0.04460699292604715 + -0.09264073293732192i, 0.13809953148617762 + 0.07591392419751572i }, { -0.033152064183402025 + 0.10055619414426546i, -0.02667944785678436 + -0.0005132390793907029i, -0.022287814532843238 + 0.05272039805932335i, -0.03618170147554102 + -0.16428283420591497i } }), Matrix({ { 0.05953654242869552 + -0.07874719674420079i, -0.05866603082234662 + 0.08572903467526166i, -0.08134461630900584 + -0.07375878750311429i, 0.02713002337312257 + -0.056115084158103505i }, { -0.09090707610708398 + 0.12047070140120128i, 0.08244642153669232 + 0.15996967479557866i, 0.013133097628291342 + 0.013091259850228605i, -0.02920452731506298 + 0.10139225101442463i }, { 0.05149619243299214 + 0.0021889624846256886i, -0.06237747482677888 + 0.000888109621077598i, -0.011012047227177057 + -0.08970481812811476i, 0.003872997227335569 + 0.06084898717378097i }, { -0.14445123267844975 + -0.04131778928805091i, 0.04515708587533802 + 0.02937033236658292i, 0.05454757229936912 + 0.07931514873476725i, -0.04034989001284457 + 0.058517131495001054i } }), Matrix({ { 0.011233626961671404 + 0.10833528704341466i, 0.20462524044410108 + -0.01186213707395548i, -0.05898232130657446 + -0.02316480844769051i, -0.08969634659600799 + 0.030320469975698244i }, { -0.09109962780945459 + 0.04617446972003284i, -0.08453067489161357 + 0.08449799269631267i, 0.17771922351937355 + 0.058472925083613764i, 0.05781713483819334 + -0.09601946429910525i }, { 0.047491221112756235 + 0.009833454322489568i, -0.023271405434572293 + 0.0349824329931722i, -0.027055082001381788 + 0.09779826616020229i, 0.05934272768706663 + -0.03297346325646481i }, { -0.04471925799322205 + 0.06346614372824821i, 0.07925938657809241 + 0.019129722666731176i, -0.07628265487447555 + -0.12271734159797469i, -0.003337617688309096 + -0.049962280926874915i } }), Matrix({ { 0.07273819840871681 + 0.19416615682791488i, -0.041871060095675844 + 0.14011228911818543i, -0.04272459072523684 + -0.13161982705689865i, -0.04594346498848323 + -0.0005156960236771743i }, { -0.06644855946744638 + -0.12035232334585029i, 0.18862383778685826 + -0.015764034690954713i, -0.03405908269499822 + -0.12662983607019576i, 0.08265587044150821 + 0.15598429565808275i }, { -0.04837365219607475 + -0.11105546823051186i, -0.011617292967994096 + 0.0728335243009625i, 0.06683591518787262 + -0.14277516186639758i, -0.0920223903418474 + -0.08549658408193908i }, { 0.12648835613381754 + 0.1620915369713827i, 0.030173483787500045 + -0.09858183782541372i, 0.07185335031296607 + 0.08476504787845739i, 0.13321899468202414 + -0.1612241047921691i } }), Matrix({ { 0.07559867664197349 + -0.02422476998843028i, 0.048655307609237204 + 0.07022843413827984i, -0.06499534533664256 + 0.12576753745225241i, -0.06451411308425221 + -0.12492589375038529i }, { 0.043262892035831405 + -0.06307972988314037i, -0.08610817691437755 + 0.15202584301599756i, 0.03659848158920559 + -0.046471941770939634i, -0.03436440538871396 + 0.13457381666531915i }, { 0.03336626607061832 + 0.021442247661200082i, 0.13646270690526366 + -0.08315083698603232i, 0.22876925262737213 + -0.03616866168718517i, -0.13130763181164 + -0.00859726825636008i }, { -0.16639138092726138 + 0.07899982312592112i, -0.04940619237296071 + -0.05765795674071267i, 0.035180503058612894 + 0.015411533695667352i, -0.10084269967273762 + 0.02162993084848501i } }), Matrix({ { -0.08641040833302302 + 0.06023579433241248i, -0.16838877293812426 + -0.02761883427688897i, -0.00848173487312638 + -0.04788342103373204i, -0.03641564859480703 + -0.04513781787258076i }, { 0.03281321307042182 + 0.008033760504166569i, -0.06085257046570581 + 0.07963196173072161i, -0.08267667975998935 + -0.05198116569490164i, -0.08154370488301492 + -0.019512165626965467i }, { -0.032267325985476936 + 0.1819910833672405i, 0.16882979488235178 + -0.016835149559478006i, -0.09782072519773287 + 0.11038926335320053i, -0.005542462524627747 + -0.05800947624435405i }, { -0.009101582649973149 + -0.08565585145322692i, -0.029724266571532352 + 0.0062002191573159076i, -0.03024755495407957 + -0.0001502053017404633i, -0.05346310558292799 + 0.10784923864319854i } }), Matrix({ { 0.02908573444673052 + -0.011826308044281945i, -0.09764520244534854 + 0.03775595189399845i, -0.031078603331574892 + 0.07106780210678902i, 0.04055963105076287 + -0.17492735121038916i }, { -0.01058756108615205 + -0.02696256577995264i, 0.1290018079476119 + -0.2899057902900592i, 0.056120141872837946 + 0.06267788623613499i, 0.058537314092904656 + 0.04477448373902506i }, { 0.10224369064855694 + -0.13690707987194115i, 0.000845127303651758 + 0.020021896528424614i, 0.12197476761087343 + 0.0014415480687201198i, 0.012179744779344116 + -0.12829438325192183i }, { -0.011144386742536594 + -0.09738722404972114i, 0.00027771998607474275 + 0.11911840148804165i, -0.01264635520559322 + -0.07899744258042088i, 0.06088863809409696 + -0.038703516142363066i } }), Matrix({ { -0.07863204540835592 + 0.0678186736020022i, -0.011504385753885947 + -0.037808410673185404i, -0.17720487951235922 + 0.08329510191551306i, -0.2073770902848955 + 0.094719477153347i }, { 0.02910112035887767 + 0.15485853453613715i, -0.013806477442717844 + -0.05279858494921721i, -0.001944135873011952 + -0.2124638450436483i, 0.1299683174486301 + 0.028982670321991012i }, { 0.2891457272401983 + -0.1371214161727082i, -0.0313557350300698 + -0.04128302110261331i, -0.08669027481023697 + 0.019020197325980984i, 0.035584570361325875 + 0.08622477110709686i }, { -0.02709018181166547 + 0.011237075471120635i, 0.10279418032148674 + 0.11352425270706741i, 0.023791328853078542 + 0.18441566229315964i, 0.12157128906879183 + -0.24561462305479143i } }), Matrix({ { 0.12754216765200393 + 0.16960458554565075i, 0.10351341051939543 + 0.01103445055937936i, -0.0898824952127077 + -0.21683494797814906i, -0.07575751662180667 + 0.019557541035426604i }, { -0.05710843165689845 + -0.0311412972941314i, 0.07493332235050593 + -0.12180311876913358i, -0.05148585941496459 + 0.004018707597711252i, 0.02128778402669594 + 0.015780156796344497i }, { 0.04566878364272751 + 0.07643258264347622i, -0.07350047290942362 + -0.06351875413931712i, -0.18315025957337297 + -0.03919618843145003i, 0.004321208058419672 + 0.06560771253694933i }, { -0.151902930842242 + -0.11073026696488457i, 0.0805631135475699 + -0.060502924436890794i, 0.07505926881916528 + -0.04151766548646258i, 0.03817173503211553 + -0.036717506800137224i } }), Matrix({ { 0.04586351648057528 + -0.05148688502583668i, -0.06601530206913976 + -0.11642805959266951i, 0.0166699977982635 + -0.11271811446293857i, 0.017895345918768207 + -0.10157894508422212i }, { -0.027645115037866187 + -0.0759153167194338i, 0.1119830217138945 + -0.14765088880892394i, -0.10635164815394586 + 0.0018194981310343161i, -0.06765094739302593 + -0.019505742807223985i }, { 0.005284345071582621 + 0.09828889195137629i, 0.041181222753450715 + 0.03379152399293742i, -0.07072085123130824 + 0.05876599600216657i, -0.08850832595611313 + -0.09342040308416799i }, { 0.10845755784746527 + -0.09849019303508141i, 0.027028702682205606 + 0.01651393360903382i, -0.07310848375077729 + 0.018293133049992555i, -0.1640203933553032 + 0.12204572507599866i } }) }, { QubitIndex{ 6 }, QubitIndex{ 1 } }));


    return c;
}

TEST(RandomizedIntegrationTests, 10_20_2_70_0_50) {
    auto c = randomCircuit();
    
    auto s = c.execute();

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, false, false, false, false, false, false}), Matrix({ { 0.5158918009033271 + 5.0025401905369455e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.48410819909667296 + 6.896039330732081e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, false, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.5158918009033271, 1.0e-7), DoubleNear(0.48410819909667296, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, false, false, false, false, false, false}), Matrix({ { 0.5924381669615395 + 7.174276040783057e-20i, -0.060903152221189416 + -0.047917020616908904i }, { -0.060903152221189416 + 0.047917020616908904i, 0.4075618330384606 + 4.7243034804859686e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, false, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.5924381669615395, 1.0e-7), DoubleNear(0.4075618330384606, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, false, false, false, false, false, false}), Matrix({ { 1.0 + 1.1898579521269027e-19i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, false, false, false, false, false, false}), ElementsAreArray({ DoubleNear(1.0, 1.0e-7), DoubleNear(0.0, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, false, false, false, false, false, false}), Matrix({ { 0.6034460560109189 + -1.0057745972742328e-19i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.39655394398908106 + 2.1956325494011354e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, false, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.6034460560109189, 1.0e-7), DoubleNear(0.39655394398908106, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, true, false, false, false, false, false}), Matrix({ { 0.5032753332749034 + 1.0728310203980193e-19i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.4967246667250967 + 1.1702693172888308e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, true, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.5032753332749034, 1.0e-7), DoubleNear(0.4967246667250967, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, true, false, false, false, false}), Matrix({ { 0.5010548485054553 + 2.7704760256238556e-20i, -0.09041380600239925 + -0.0003902876295261105i }, { -0.09041380600239925 + 0.00039028762952610986i, 0.49894515149454477 + 9.12810349564517e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, true, false, false, false, false}), ElementsAreArray({ DoubleNear(0.5010548485054553, 1.0e-7), DoubleNear(0.49894515149454477, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, false, true, false, false, false}), Matrix({ { 0.49786140950498037 + 6.242659544931971e-20i, -0.03819447341850819 + 0.002227346662108737i }, { -0.03819447341850819 + -0.002227346662108737i, 0.5021385904950196 + 5.655919976337054e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, false, true, false, false, false}), ElementsAreArray({ DoubleNear(0.49786140950498037, 1.0e-7), DoubleNear(0.5021385904950196, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, false, false, true, false, false}), Matrix({ { 0.40890687215418375 + 3.4388379605667014e-20i, 0.04302026306577279 + -0.02409383449555346i }, { 0.04302026306577279 + 0.02409383449555346i, 0.5910931278458162 + 8.459741560702325e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, false, false, true, false, false}), ElementsAreArray({ DoubleNear(0.40890687215418375, 1.0e-7), DoubleNear(0.5910931278458162, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, false, false, false, true, false}), Matrix({ { 0.5331762449763735 + 1.1201100828764314e-19i, 0.024613841665895034 + -0.04354989348224235i }, { 0.024613841665895034 + 0.04354989348224235i, 0.4668237550236266 + 6.974786925047125e-21i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, false, false, false, true, false}), ElementsAreArray({ DoubleNear(0.5331762449763735, 1.0e-7), DoubleNear(0.4668237550236266, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, false, false, false, false, true}), Matrix({ { 0.4826337643504165 + 2.2644896449251686e-20i, 0.04276200600870141 + 0.05215443928677736i }, { 0.04276200600870141 + -0.05215443928677735i, 0.5173662356495836 + 9.634089876343858e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, false, false, false, false, true}), ElementsAreArray({ DoubleNear(0.4826337643504165, 1.0e-7), DoubleNear(0.5173662356495836, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, true, false, false, false, false, false, false, false, false}), Matrix({ { 0.307545935154588 + 2.960000979613e-20i, 0.0 + 0.0i, -0.031484685287080254 + -0.025264513279925904i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.28489223180695145 + 4.214275061170056e-20i, 0.0 + 0.0i, -0.029418466934109162 + -0.022652507336983i }, { -0.031484685287080254 + 0.025264513279925904i, 0.0 + 0.0i, 0.20834586574873906 + 2.0425392109239446e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.029418466934109162 + 0.022652507336983i, 0.0 + 0.0i, 0.19921596728972157 + 2.681764269562024e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, true, false, false, false, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.307545935154588, 1.0e-7), DoubleNear(0.28489223180695145, 1.0e-7), DoubleNear(0.20834586574873906, 1.0e-7), DoubleNear(0.19921596728972157, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, true, false, false, false, false, false, false, false}), Matrix({ { 0.5158918009033271 + 5.0025401905369455e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.48410819909667296 + 6.896039330732081e-20i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, true, false, false, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.5158918009033271, 1.0e-7), DoubleNear(0.48410819909667296, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.0, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, true, false, false, false, false, false, false}), Matrix({ { 0.3113065950945747 + -3.112737549747108e-20i, 0.0 + 0.0i, 0.0 + 0.0i, -0.0018131859406916996 + 0.00402156928131722i }, { 0.0 + 0.0i, 0.2921394609163443 + -6.945008422995222e-20i, 0.003292459856052946 + -0.0028635190880047833i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0032924598560529457 + 0.0028635190880047833i, 0.2045852058087524 + 8.115277740284052e-20i, 0.0 + 0.0i }, { -0.0018131859406916994 + -0.00402156928131722i, 0.0 + 0.0i, 0.0 + 0.0i, 0.1919687381803287 + 1.3841047753727301e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, true, false, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.3113065950945747, 1.0e-7), DoubleNear(0.2921394609163443, 1.0e-7), DoubleNear(0.2045852058087524, 1.0e-7), DoubleNear(0.1919687381803287, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, true, false, false, false, false, false}), Matrix({ { 0.3113065950945747 + -3.112737549747108e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.006443963350885108 + 0.02948515395602056i }, { 0.0 + 0.0i, 0.1919687381803287 + 1.3841047753727301e-19i, 0.004210361195736955 + -0.019371640699287998i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.004210361195736955 + 0.019371640699287995i, 0.2045852058087524 + 8.115277740284052e-20i, 0.0 + 0.0i }, { 0.006443963350885108 + -0.02948515395602056i, 0.0 + 0.0i, 0.0 + 0.0i, 0.2921394609163443 + -6.945008422995222e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, true, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.3113065950945747, 1.0e-7), DoubleNear(0.1919687381803287, 1.0e-7), DoubleNear(0.2045852058087524, 1.0e-7), DoubleNear(0.2921394609163443, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, false, true, false, false, false, false}), Matrix({ { 0.2558716700045053 + 1.3298582708015026e-20i, 0.0 + 0.0i, -0.04664374120510179 + 0.0007674528428732884i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.24518317850095003 + 1.4406177548223527e-20i, 0.0 + 0.0i, -0.04377006479729746 + -0.0011577404723993989i }, { -0.04664374120510179 + -0.0007674528428732887i, 0.0 + 0.0i, 0.2600201308988218 + 3.672681919735442e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.04377006479729746 + 0.0011577404723993982i, 0.0 + 0.0i, 0.23892502059572296 + 5.455421575909728e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, false, true, false, false, false, false}), ElementsAreArray({ DoubleNear(0.2558716700045053, 1.0e-7), DoubleNear(0.24518317850095003, 1.0e-7), DoubleNear(0.2600201308988218, 1.0e-7), DoubleNear(0.23892502059572296, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, false, false, true, false, false, false}), Matrix({ { 0.2586790504322992 + 2.7983491197411094e-20i, 0.0 + 0.0i, -0.0206343724388359 + 0.0028136116287735963i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.23918235907268115 + 3.444310425190862e-20i, 0.0 + 0.0i, -0.01756010097967229 + -0.0005862649666648591i }, { -0.0206343724388359 + -0.0028136116287735963i, 0.0 + 0.0i, 0.2572127504710278 + 2.2041910707958358e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.01756010097967229 + 0.0005862649666648591i, 0.0 + 0.0i, 0.24492584002399181 + 3.451728905541218e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, false, false, true, false, false, false}), ElementsAreArray({ DoubleNear(0.2586790504322992, 1.0e-7), DoubleNear(0.23918235907268115, 1.0e-7), DoubleNear(0.2572127504710278, 1.0e-7), DoubleNear(0.24492584002399181, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, false, false, false, true, false, false}), Matrix({ { 0.21609830445870848 + 4.700784703077601e-20i, 0.0 + 0.0i, 0.0328784837807964 + -0.05026153187052561i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.19280856769547525 + -1.2619467425108993e-20i, 0.0 + 0.0i, 0.010141779284976393 + 0.02616769737497215i }, { 0.0328784837807964 + 0.05026153187052561i, 0.0 + 0.0i, 0.2997934964446186 + 3.017554874593442e-21i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.010141779284976393 + -0.02616769737497215i, 0.0 + 0.0i, 0.29129963140119775 + 8.15798607324298e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, false, false, false, true, false, false}), ElementsAreArray({ DoubleNear(0.21609830445870848, 1.0e-7), DoubleNear(0.19280856769547525, 1.0e-7), DoubleNear(0.2997934964446186, 1.0e-7), DoubleNear(0.29129963140119775, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, false, false, false, false, true, false}), Matrix({ { 0.2752497130504077 + 4.315649409872911e-20i, 0.0 + 0.0i, 0.012483625497321165 + -0.022343356508335747i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.2579265319259658 + 6.885451418891402e-20i, 0.0 + 0.0i, 0.01213021616857387 + -0.0212065369739066i }, { 0.012483625497321165 + 0.02234335650833575i, 0.0 + 0.0i, 0.2406420878529194 + 6.868907806640337e-21i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.01213021616857387 + 0.0212065369739066i, 0.0 + 0.0i, 0.22618166717070715 + 1.0587911840678754e-22i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, false, false, false, false, true, false}), ElementsAreArray({ DoubleNear(0.2752497130504077, 1.0e-7), DoubleNear(0.2579265319259658, 1.0e-7), DoubleNear(0.2406420878529194, 1.0e-7), DoubleNear(0.22618166717070715, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, false, false, false, false, false, true}), Matrix({ { 0.24888631246332177 + 2.202285662861181e-20i, 0.0 + 0.0i, 0.022102782457924696 + 0.027029165165432457i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.23374745188709473 + 6.220398206398768e-22i, 0.0 + 0.0i, 0.02065922355077672 + 0.025125274121344895i }, { 0.022102782457924696 + -0.027029165165432457i, 0.0 + 0.0i, 0.2670054884400053 + 2.8002545276757646e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.020659223550776717 + -0.025125274121344895i, 0.0 + 0.0i, 0.25036074720957824 + 6.833835348668093e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, false, false, false, false, false, true}), ElementsAreArray({ DoubleNear(0.24888631246332177, 1.0e-7), DoubleNear(0.23374745188709473, 1.0e-7), DoubleNear(0.2670054884400053, 1.0e-7), DoubleNear(0.25036074720957824, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, true, false, false, false, false, false, false, false}), Matrix({ { 0.5924381669615395 + 7.174276040783057e-20i, -0.060903152221189416 + -0.047917020616908904i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.060903152221189416 + 0.047917020616908904i, 0.4075618330384606 + 4.7243034804859686e-20i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, true, false, false, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.5924381669615395, 1.0e-7), DoubleNear(0.4075618330384606, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.0, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, true, false, false, false, false, false, false}), Matrix({ { 0.35749536362531276 + -5.3274008663858634e-20i, -0.03675141403808395 + -0.028912787697983174i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.03675141403808395 + 0.028912787697983174i, 0.24595069238560616 + -4.730345106356466e-20i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.23494280333622664 + 1.2501676907168918e-19i, -0.024151738183105474 + -0.01900423291892573i }, { 0.0 + 0.0i, 0.0 + 0.0i, -0.024151738183105474 + 0.01900423291892573i, 0.16161114065285448 + 9.454648586842435e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, true, false, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.35749536362531276, 1.0e-7), DoubleNear(0.24595069238560616, 1.0e-7), DoubleNear(0.23494280333622664, 1.0e-7), DoubleNear(0.16161114065285448, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, true, false, false, false, false, false}), Matrix({ { 0.2985597083292407 + 5.662315078385351e-20i, -0.03066449190011322 + -0.024232136998265104i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.03066449190011322 + 0.024232136998265104i, 0.20471562494566262 + 5.065995125594841e-20i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.29387845863229867 + 1.511960962397705e-20i, -0.030238660321076197 + -0.0236848836186438i }, { 0.0 + 0.0i, 0.0 + 0.0i, -0.030238660321076197 + 0.0236848836186438i, 0.20284620809279802 + -3.41691645108873e-21i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, true, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.2985597083292407, 1.0e-7), DoubleNear(0.20471562494566262, 1.0e-7), DoubleNear(0.29387845863229867, 1.0e-7), DoubleNear(0.20284620809279802, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, false, true, false, false, false, false}), Matrix({ { 0.2930434309410409 + 1.79473153196665e-20i, -0.030368592220745116 + -0.0229456654951114i, -0.05356458949607763 + 0.0011749724207026167i, 0.005881232304866098 + 0.0043016566640167i }, { -0.030368592220745116 + 0.0229456654951114i, 0.20801141756441435 + 9.757444936572052e-21i, 0.005131739274856323 + -0.004363063748523632i, -0.036849216506321614 + -0.0015652600502287276i }, { -0.05356458949607763 + -0.001174972420702617i, 0.005131739274856323 + 0.004363063748523632i, 0.2993947360204985 + 5.379544508816407e-20i, -0.030534560000444296 + -0.024971355121797503i }, { 0.005881232304866098 + -0.0043016566640167i, -0.036849216506321614 + 0.0015652600502287272i, -0.030534560000444296 + 0.024971355121797503i, 0.1995504154740463 + 3.7485589868287634e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, false, true, false, false, false, false}), ElementsAreArray({ DoubleNear(0.2930434309410409, 1.0e-7), DoubleNear(0.20801141756441435, 1.0e-7), DoubleNear(0.2993947360204985, 1.0e-7), DoubleNear(0.1995504154740463, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, false, false, true, false, false, false}), Matrix({ { 0.27681606093603944 + 3.435704398978591e-20i, -0.011078490647440167 + -0.01954309828867452i, 0.010324034761806024 + 0.023805393412752982i, 0.0015048277369803507 + 0.009345829162995055i }, { -0.011078490647440167 + 0.01954309828867452i, 0.22104534856894098 + 2.8069551459533805e-20i, 0.010475798575051903 + -0.016962872242875227i, -0.04851850818031422 + -0.021578046750644245i }, { 0.010324034761806024 + -0.023805393412752982i, 0.010475798575051903 + 0.016962872242875227i, 0.3156221060255 + 3.738571641804466e-20i, -0.04982466157374925 + -0.028373922328234383i }, { 0.0015048277369803507 + -0.009345829162995055i, -0.04851850818031422 + 0.021578046750644245i, -0.04982466157374925 + 0.02837392232823438i, 0.18651648446951968 + 1.917348334532588e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, false, false, true, false, false, false}), ElementsAreArray({ DoubleNear(0.27681606093603944, 1.0e-7), DoubleNear(0.22104534856894098, 1.0e-7), DoubleNear(0.3156221060255, 1.0e-7), DoubleNear(0.18651648446951968, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, false, false, false, true, false, false}), Matrix({ { 0.23865084707341705 + 2.314674903184929e-20i, -0.024764588824289814 + -0.01859270750761086i, 0.025434652055975414 + -0.011663238355542253i, -0.003043452996561539 + -0.0006732999218719555i }, { -0.024764588824289814 + 0.01859270750761086i, 0.17025602508076665 + 1.1241630573817725e-20i, -0.0021795451312289207 + 0.0034070928175912655i, 0.01758561100979738 + -0.012430596140011208i }, { 0.025434652055975414 + 0.011663238355542251i, -0.0021795451312289207 + -0.0034070928175912655i, 0.35378731988812234 + 4.859601137598128e-20i, -0.036138563396899595 + -0.029324313109298044i }, { -0.0030434529965615393 + 0.0006732999218719557i, 0.01758561100979738 + 0.012430596140011208i, -0.036138563396899595 + 0.02932431310929804i, 0.237305807957694 + 3.600140423104196e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, false, false, false, true, false, false}), ElementsAreArray({ DoubleNear(0.23865084707341705, 1.0e-7), DoubleNear(0.17025602508076665, 1.0e-7), DoubleNear(0.35378731988812234, 1.0e-7), DoubleNear(0.237305807957694, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, false, false, false, false, true, false}), Matrix({ { 0.31614750316742096 + 6.76670403423528e-20i, -0.03248271066120295 + -0.0256247542879793i, 0.0142709038313606 + -0.02562110497941306i, -0.0035235560731196928 + 0.0015530435345076552i }, { -0.03248271066120295 + 0.0256247542879793i, 0.21702874180895257 + 4.434396794529033e-20i, 0.0005495514247375404 + 0.0037376999758943737i, 0.010342937834534428 + -0.017928788502829286i }, { 0.0142709038313606 + 0.025621104979413063i, 0.0005495514247375413 + -0.0037376999758943737i, 0.2762906637941185 + 4.075720065477768e-21i, -0.028420441559986465 + -0.022292266328929604i }, { -0.0035235560731196928 + -0.0015530435345076554i, 0.010342937834534428 + 0.017928788502829286i, -0.028420441559986465 + 0.022292266328929604i, 0.19053309122950807 + 2.8990668595693577e-21i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, false, false, false, false, true, false}), ElementsAreArray({ DoubleNear(0.31614750316742096, 1.0e-7), DoubleNear(0.21702874180895257, 1.0e-7), DoubleNear(0.2762906637941185, 1.0e-7), DoubleNear(0.19053309122950807, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, false, false, false, false, false, true}), Matrix({ { 0.2857848041712285 + 1.5125601062819123e-20i, -0.0293882673346533 + -0.023085561355388917i, 0.025395117532012176 + 0.03107698324520216i, -5.762881223813721e-05 + -0.005249464275021896i }, { -0.0293882673346533 + 0.023085561355388917i, 0.19684896017918804 + 7.519295386432563e-21i, -0.0051558003168155585 + -0.001117120455603726i, 0.017366888476689237 + 0.021077456041575193i }, { 0.025395117532012176 + -0.03107698324520216i, -0.0051558003168155585 + 0.001117120455603726i, 0.30665336279031097 + 5.661715934501145e-20i, -0.031514884886536115 + -0.024831459261519986i }, { -5.762881223813721e-05 + 0.005249464275021896i, 0.017366888476689237 + -0.021077456041575193i, -0.031514884886536115 + 0.024831459261519986i, 0.2107128728592726 + 3.972373941842712e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, false, false, false, false, false, true}), ElementsAreArray({ DoubleNear(0.2857848041712285, 1.0e-7), DoubleNear(0.19684896017918804, 1.0e-7), DoubleNear(0.30665336279031097, 1.0e-7), DoubleNear(0.2107128728592726, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, true, false, false, false, false, false, false}), Matrix({ { 0.6034460560109189 + -1.0057745972742328e-19i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.39655394398908106 + 2.1956325494011354e-19i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, true, false, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.6034460560109189, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.39655394398908106, 1.0e-7), DoubleNear(0.0, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, true, false, false, false, false, false}), Matrix({ { 0.5032753332749034 + 1.0728310203980193e-19i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.4967246667250967 + 1.1702693172888308e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, true, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.5032753332749034, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.4967246667250967, 1.0e-7), DoubleNear(0.0, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, false, true, false, false, false, false}), Matrix({ { 0.5010548485054553 + 2.7704760256238556e-20i, 0.0 + 0.0i, -0.09041380600239925 + -0.0003902876295261105i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.09041380600239925 + 0.00039028762952610986i, 0.0 + 0.0i, 0.49894515149454477 + 9.12810349564517e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, false, true, false, false, false, false}), ElementsAreArray({ DoubleNear(0.5010548485054553, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.49894515149454477, 1.0e-7), DoubleNear(0.0, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, false, false, true, false, false, false}), Matrix({ { 0.49786140950498037 + 6.242659544931971e-20i, 0.0 + 0.0i, -0.03819447341850819 + 0.002227346662108737i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.03819447341850819 + -0.002227346662108737i, 0.0 + 0.0i, 0.5021385904950196 + 5.655919976337054e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, false, false, true, false, false, false}), ElementsAreArray({ DoubleNear(0.49786140950498037, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.5021385904950196, 1.0e-7), DoubleNear(0.0, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, false, false, false, true, false, false}), Matrix({ { 0.40890687215418375 + 3.4388379605667014e-20i, 0.0 + 0.0i, 0.04302026306577279 + -0.02409383449555346i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.04302026306577279 + 0.02409383449555346i, 0.0 + 0.0i, 0.5910931278458162 + 8.459741560702325e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, false, false, false, true, false, false}), ElementsAreArray({ DoubleNear(0.40890687215418375, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.5910931278458162, 1.0e-7), DoubleNear(0.0, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, false, false, false, false, true, false}), Matrix({ { 0.5331762449763735 + 1.1201100828764314e-19i, 0.0 + 0.0i, 0.024613841665895034 + -0.04354989348224235i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.024613841665895034 + 0.04354989348224235i, 0.0 + 0.0i, 0.4668237550236266 + 6.974786925047125e-21i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, false, false, false, false, true, false}), ElementsAreArray({ DoubleNear(0.5331762449763735, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.4668237550236266, 1.0e-7), DoubleNear(0.0, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, false, false, false, false, false, true}), Matrix({ { 0.4826337643504165 + 2.2644896449251686e-20i, 0.0 + 0.0i, 0.04276200600870141 + 0.05215443928677736i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.04276200600870141 + -0.05215443928677735i, 0.0 + 0.0i, 0.5173662356495836 + 9.634089876343858e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, false, false, false, false, false, true}), ElementsAreArray({ DoubleNear(0.4826337643504165, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.5173662356495836, 1.0e-7), DoubleNear(0.0, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, true, false, false, false, false, false}), Matrix({ { 0.3113065950945747 + -3.112737549747108e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.036378279048991054 + 0.026900467764900522i }, { 0.0 + 0.0i, 0.1919687381803287 + 1.3841047753727301e-19i, 0.03412745338329306 + -0.025262474481396707i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.03412745338329306 + 0.025262474481396707i, 0.2921394609163443 + -6.945008422995222e-20i, 0.0 + 0.0i }, { 0.036378279048991054 + -0.026900467764900522i, 0.0 + 0.0i, 0.0 + 0.0i, 0.2045852058087524 + 8.115277740284052e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, true, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.3113065950945747, 1.0e-7), DoubleNear(0.1919687381803287, 1.0e-7), DoubleNear(0.2921394609163443, 1.0e-7), DoubleNear(0.2045852058087524, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, false, true, false, false, false, false}), Matrix({ { 0.30198364621909163 + -2.9377526455933647e-20i, 0.0 + 0.0i, -0.05339345583211578 + -0.00010889654472084892i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.19907120228636369 + 5.70822867121722e-20i, 0.0 + 0.0i, -0.03702035017028347 + -0.00028139108480526164i }, { -0.05339345583211578 + 0.00010889654472084865i, 0.0 + 0.0i, 0.30146240979182737 + -7.119993327148965e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.03702035017028347 + 0.0002813910848052614i, 0.0 + 0.0i, 0.1974827417027174 + 1.6248096822794135e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, false, true, false, false, false, false}), ElementsAreArray({ DoubleNear(0.30198364621909163, 1.0e-7), DoubleNear(0.19907120228636369, 1.0e-7), DoubleNear(0.30146240979182737, 1.0e-7), DoubleNear(0.1974827417027174, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, false, false, true, false, false, false}), Matrix({ { 0.30042444943634783 + -4.378043971895139e-20i, 0.0 + 0.0i, -0.02304331105321168 + 0.0013373295253671013i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.1974369600686326 + 1.062070351682711e-19i, 0.0 + 0.0i, -0.015151162365296511 + 0.0008900171367416356i }, { -0.02304331105321168 + -0.0013373295253671013i, 0.0 + 0.0i, 0.30302160657457117 + -5.679702000847192e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.015151162365296511 + -0.0008900171367416356i, 0.0 + 0.0i, 0.1991169839204485 + 1.1335621977184244e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, false, false, true, false, false, false}), ElementsAreArray({ DoubleNear(0.30042444943634783, 1.0e-7), DoubleNear(0.1974369600686326, 1.0e-7), DoubleNear(0.30302160657457117, 1.0e-7), DoubleNear(0.1991169839204485, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, false, false, false, true, false, false}), Matrix({ { 0.246764908425675 + -4.5785015951910744e-20i, 0.0 + 0.0i, 0.025960386341690025 + -0.014547821351221908i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.1621419637285087 + 8.017339555757774e-20i, 0.0 + 0.0i, 0.017059876724082764 + -0.009546013144331553i }, { 0.025960386341690025 + 0.014547821351221906i, 0.0 + 0.0i, 0.35668114758524394 + -5.479244377551255e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.017059876724082764 + 0.009546013144331553i, 0.0 + 0.0i, 0.23441198026057236 + 1.393898593825358e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, false, false, false, true, false, false}), ElementsAreArray({ DoubleNear(0.246764908425675, 1.0e-7), DoubleNear(0.1621419637285087, 1.0e-7), DoubleNear(0.35668114758524394, 1.0e-7), DoubleNear(0.23441198026057236, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, false, false, false, false, true, false}), Matrix({ { 0.32160761087824713 + -6.924225819044429e-21i, 0.0 + 0.0i, 0.014995599377487515 + -0.026376027872700474i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.21156863409812637 + 1.1893523410668754e-19i, 0.0 + 0.0i, 0.009618242288407512 + -0.017173865609541875i }, { 0.014995599377487515 + 0.026376027872700474i, 0.0 + 0.0i, 0.28183844513267187 + -9.365323390837887e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.009618242288407514 + 0.017173865609541875i, 0.0 + 0.0i, 0.1849853098909547 + 1.0062802083342599e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, false, false, false, false, true, false}), ElementsAreArray({ DoubleNear(0.32160761087824713, 1.0e-7), DoubleNear(0.21156863409812637, 1.0e-7), DoubleNear(0.28183844513267187, 1.0e-7), DoubleNear(0.1849853098909547, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, false, false, false, false, false, true}), Matrix({ { 0.2912867951899032 + -6.362264877075406e-20i, 0.0 + 0.0i, 0.025850379736109524 + 0.03141298065697541i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.1913469691605133 + 8.626754522000574e-20i, 0.0 + 0.0i, 0.01691162627259189 + 0.020741458629801944i }, { 0.02585037973610952 + -0.03141298065697541i, 0.0 + 0.0i, 0.3121592608210158 + -3.695481095666923e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.01691162627259189 + -0.020741458629801944i, 0.0 + 0.0i, 0.20520697482856776 + 1.332957097201078e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, false, false, false, false, false, true}), ElementsAreArray({ DoubleNear(0.2912867951899032, 1.0e-7), DoubleNear(0.1913469691605133, 1.0e-7), DoubleNear(0.3121592608210158, 1.0e-7), DoubleNear(0.20520697482856776, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, true, true, false, false, false, false}), Matrix({ { 0.2516037527729659 + 1.5085085830016697e-20i, 0.0 + 0.0i, -0.04545100613591784 + 0.0001462403393556664i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.24945109573248936 + 1.2619674426221856e-20i, 0.0 + 0.0i, -0.04496279986648141 + -0.000536527968881777i }, { -0.04545100613591784 + -0.00014624033935566673i, 0.0 + 0.0i, 0.25167158050193744 + 9.219801620978524e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.04496279986648141 + 0.0005365279688817766i, 0.0 + 0.0i, 0.24727357099260733 + -9.169812533335448e-22i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, true, true, false, false, false, false}), ElementsAreArray({ DoubleNear(0.2516037527729659, 1.0e-7), DoubleNear(0.24945109573248936, 1.0e-7), DoubleNear(0.25167158050193744, 1.0e-7), DoubleNear(0.24727357099260733, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, true, false, true, false, false, false}), Matrix({ { 0.25093150294829614 + 4.9483855044260605e-20i, 0.0 + 0.0i, -0.019426468779546874 + 0.0014614021819846497i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.24692990655668426 + 1.2942740405059109e-20i, 0.0 + 0.0i, -0.018768004638961316 + 0.0007659444801240873i }, { -0.019426468779546874 + -0.0014614021819846497i, 0.0 + 0.0i, 0.25234383032660723 + 5.779924699554133e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.018768004638961316 + -0.0007659444801240873i, 0.0 + 0.0i, 0.24979476016841246 + -1.2400472321707934e-21i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, true, false, true, false, false, false}), ElementsAreArray({ DoubleNear(0.25093150294829614, 1.0e-7), DoubleNear(0.24692990655668426, 1.0e-7), DoubleNear(0.25234383032660723, 1.0e-7), DoubleNear(0.24979476016841246, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, true, false, false, true, false, false}), Matrix({ { 0.2068613138979894 + 5.095541104739095e-20i, 0.0 + 0.0i, 0.02386222560237168 + -0.01994501441828306i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.20204555825619433 + -1.656703144172394e-20i, 0.0 + 0.0i, 0.019158037463401112 + -0.004148820077270399i }, { 0.02386222560237168 + 0.01994501441828306i, 0.0 + 0.0i, 0.29641401937691403 + 5.632769099241097e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.019158037463401112 + 0.0041488200772703985i, 0.0 + 0.0i, 0.2946791084689024 + 2.826972461461225e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, true, false, false, true, false, false}), ElementsAreArray({ DoubleNear(0.2068613138979894, 1.0e-7), DoubleNear(0.20204555825619433, 1.0e-7), DoubleNear(0.29641401937691403, 1.0e-7), DoubleNear(0.2946791084689024, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, true, false, false, false, true, false}), Matrix({ { 0.26836335441959047 + 1.4545567790302414e-19i, 0.0 + 0.0i, 0.012352961230091001 + -0.021900585542682798i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.26481289055678303 + -3.3444669615381006e-20i, 0.0 + 0.0i, 0.01226088043580403 + -0.021649307939559555i }, { 0.012352961230091001 + 0.021900585542682798i, 0.0 + 0.0i, 0.2349119788553129 + -3.81725758632222e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.012260880435804034 + 0.021649307939559555i, 0.0 + 0.0i, 0.2319117761683137 + 4.5147362788269314e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, true, false, false, false, true, false}), ElementsAreArray({ DoubleNear(0.26836335441959047, 1.0e-7), DoubleNear(0.26481289055678303, 1.0e-7), DoubleNear(0.2349119788553129, 1.0e-7), DoubleNear(0.2319117761683137, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, true, false, false, false, false, true}), Matrix({ { 0.24287543903437556 + 4.457257535118195e-20i, 0.0 + 0.0i, 0.0215450087878762 + 0.026273225872800555i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.23975832531604097 + -2.1927678901930266e-20i, 0.0 + 0.0i, 0.021216997220825214 + 0.025881213413976804i }, { 0.0215450087878762 + -0.02627322587280056i, 0.0 + 0.0i, 0.26039989424052784 + 6.271052668861998e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.021216997220825214 + -0.025881213413976797i, 0.0 + 0.0i, 0.2569663414090557 + 3.3630372074818574e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, true, false, false, false, false, true}), ElementsAreArray({ DoubleNear(0.24287543903437556, 1.0e-7), DoubleNear(0.23975832531604097, 1.0e-7), DoubleNear(0.26039989424052784, 1.0e-7), DoubleNear(0.2569663414090557, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, true, true, false, false, false}), Matrix({ { 0.24609621272717727 + 1.5002386193545483e-20i, -0.045013544895064345 + 0.0010487450735805772i, -0.01705476208804032 + -0.0017011678282162917i, 0.0024118333391907327 + -0.0009570862664675986i }, { -0.045013544895064345 + -0.0010487450735805774i, 0.2517651967778031 + 4.742420925577423e-20i, 0.004494782080858856 + 0.0005543204884516165i, -0.02113971133046787 + 0.003928514490325028i }, { -0.01705476208804032 + 0.0017011678282162917i, 0.004494782080858856 + -0.0005543204884516165i, 0.25495863577827804 + 1.270237406269307e-20i, -0.0454002611073349 + -0.0014390327031066875i }, { 0.0024118333391907323 + 0.0009570862664675986i, -0.02113971133046787 + -0.003928514490325028i, -0.0454002611073349 + 0.0014390327031066873i, 0.24717995471674165 + 4.3856825700677465e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, true, true, false, false, false}), ElementsAreArray({ DoubleNear(0.24609621272717727, 1.0e-7), DoubleNear(0.2517651967778031, 1.0e-7), DoubleNear(0.25495863577827804, 1.0e-7), DoubleNear(0.24717995471674165, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, true, false, true, false, false}), Matrix({ { 0.20975211680616965 + 2.7387122901018193e-20i, -0.03697082661199624 + -0.001960480135936598i, 0.02154644591385624 + -0.015614430094544444i, -0.005209584106454888 + 0.00216497917446303i }, { -0.03697082661199624 + 0.0019604801359365976i, 0.19915475534801405 + 7.001256704648822e-21i, -0.0025696673315470375 + 0.0021918513814067407i, 0.021473817151916548 + -0.008479404401009017i }, { 0.02154644591385624 + 0.015614430094544447i, -0.0025696673315470375 + -0.0021918513814067407i, 0.2913027316992856 + 3.1763735522036263e-22i, -0.05344297939040301 + 0.001570192506410487i }, { -0.005209584106454888 + -0.00216497917446303i, 0.021473817151916548 + 0.008479404401009015i, -0.05344297939040301 + -0.0015701925064104875i, 0.2997903961465307 + 8.427977825180287e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, true, false, true, false, false}), ElementsAreArray({ DoubleNear(0.20975211680616965, 1.0e-7), DoubleNear(0.19915475534801405, 1.0e-7), DoubleNear(0.2913027316992856, 1.0e-7), DoubleNear(0.2997903961465307, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, true, false, false, true, false}), Matrix({ { 0.2662915377562004 + 5.491569368678295e-20i, -0.048411162173313274 + -0.001335568414376899i, 0.013286315016794534 + -0.02256482999840119i, -0.0008649658178110703 + 0.004962310161721873i }, { -0.048411162173313274 + 0.0013355684143768985i, 0.2668847072201731 + 5.709531460086017e-20i, -0.003238060644199783 + 0.0025393167568603073i, 0.011327526649100497 + -0.02098506348384116i }, { 0.013286315016794534 + 0.02256482999840119i, -0.003238060644199783 + -0.0025393167568603073i, 0.23476331074925488 + -2.72109334305444e-20i, -0.04200264382908597 + 0.0009452807848507885i }, { -0.0008649658178110703 + -0.004962310161721873i, 0.011327526649100497 + 0.02098506348384116i, -0.04200264382908597 + -0.0009452807848507887i, 0.23206044427437167 + 3.418572035559153e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, true, false, false, true, false}), ElementsAreArray({ DoubleNear(0.2662915377562004, 1.0e-7), DoubleNear(0.2668847072201731, 1.0e-7), DoubleNear(0.23476331074925488, 1.0e-7), DoubleNear(0.23206044427437167, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, true, false, false, false, true}), Matrix({ { 0.24175823311776545 + -1.393633896029341e-20i, -0.04371996874275967 + -0.0009398082757765282i, 0.02253116200043958 + 0.026000878509465978i, -0.0037627674558473163 + -0.0015968566522930657i }, { -0.04371996874275967 + 0.0009398082757765276i, 0.240875531232651 + 3.6581235409545096e-20i, -0.003065127937717965 + -0.0077340269770742945i, 0.020230844008261833 + 0.026153560777311374i }, { 0.02253116200043958 + -0.026000878509465978i, -0.003065127937717965 + 0.007734026977074295i, 0.25929661538768983 + 4.1641099216531966e-20i, -0.046693837259639576 + 0.0005495206462504177i }, { -0.0037627674558473163 + 0.0015968566522930655i, 0.020230844008261833 + -0.026153560777311374i, -0.046693837259639576 + -0.0005495206462504177i, 0.25806962026189373 + 5.46997995469066e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, true, false, false, false, true}), ElementsAreArray({ DoubleNear(0.24175823311776545, 1.0e-7), DoubleNear(0.240875531232651, 1.0e-7), DoubleNear(0.25929661538768983, 1.0e-7), DoubleNear(0.25806962026189373, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, false, true, true, false, false}), Matrix({ { 0.20033780448534938 + 2.1222436172544528e-20i, -0.01368510496263486 + -0.00180982532880254i, 0.021579913145409146 + -0.009613968031362663i, -0.0034078940727108728 + -0.00013933042313546054i }, { -0.01368510496263486 + 0.00180982532880254i, 0.20856906766883432 + 1.3165943433122486e-20i, 0.0004907469677430689 + -0.0007777815247532002i, 0.021440349920363647 + -0.014479866464190796i }, { 0.021579913145409146 + 0.009613968031362665i, 0.0004907469677430689 + 0.0007777815247532i, 0.29752360501963104 + 4.1204159276775185e-20i, -0.024509368455873332 + 0.0040371719909112775i }, { -0.0034078940727108728 + 0.00013933042313546054i, 0.021440349920363647 + 0.014479866464190794i, -0.024509368455873332 + -0.004037171990911277i, 0.2935695228261853 + 4.3393256330248055e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, false, true, true, false, false}), ElementsAreArray({ DoubleNear(0.20033780448534938, 1.0e-7), DoubleNear(0.20856906766883432, 1.0e-7), DoubleNear(0.29752360501963104, 1.0e-7), DoubleNear(0.2935695228261853, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, false, true, false, true, false}), Matrix({ { 0.265689687349141 + 5.808125604050771e-20i, -0.020514292206978035 + 0.0013903347512230345i, 0.011979119097246919 + -0.021523123583145072i, -0.0008055946815361088 + 0.0013890795690957212i }, { -0.020514292206978035 + -0.0013903347512230345i, 0.2674865576272325 + 5.392975224713541e-20i, -0.0007334658066144 + 0.0017408993906666901i, 0.012634722568648116 + -0.022026769899097284i }, { 0.011979119097246919 + 0.021523123583145072i, -0.0007334658066144 + -0.0017408993906666904i, 0.23217172215583942 + 4.345339408811997e-21i, -0.017680181211530158 + 0.0008370119108857025i }, { -0.0008055946815361091 + -0.001389079569095721i, 0.012634722568648116 + 0.022026769899097284i, -0.017680181211530158 + -0.0008370119108857024i, 0.23465203286778716 + 2.629447516235128e-21i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, false, true, false, true, false}), ElementsAreArray({ DoubleNear(0.265689687349141, 1.0e-7), DoubleNear(0.2674865576272325, 1.0e-7), DoubleNear(0.23217172215583942, 1.0e-7), DoubleNear(0.23465203286778716, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, false, true, false, false, true}), Matrix({ { 0.24015578946508853 + 1.1699294356550301e-20i, -0.01835401036310392 + 0.0009668748264876221i, 0.021343717068764194 + 0.026123653290912267i, -0.0019154804694671563 + -0.0019492779468456543i }, { -0.01835401036310392 + -0.0009668748264876221i, 0.24247797488532796 + 1.0945602092701383e-20i, -0.001418220825360836 + -0.0022306071313626117i, 0.02141828893993722 + 0.02603078599586509i }, { 0.021343717068764194 + -0.026123653290912263i, -0.001418220825360836 + 0.0022306071313626117i, 0.25770562003989184 + 5.072730109276941e-20i, -0.019840463055404274 + 0.0012604718356211148i }, { -0.0019154804694671563 + 0.0019492779468456543i, 0.02141828893993722 + -0.02603078599586509i, -0.019840463055404274 + -0.0012604718356211148i, 0.25966061560969167 + 4.561359767066916e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, false, true, false, false, true}), ElementsAreArray({ DoubleNear(0.24015578946508853, 1.0e-7), DoubleNear(0.24247797488532796, 1.0e-7), DoubleNear(0.25770562003989184, 1.0e-7), DoubleNear(0.25966061560969167, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, false, false, true, true, false}), Matrix({ { 0.21766910493238711 + 2.701654598659443e-20i, 0.022938034804349933 + -0.012591318838418138i, 0.01046341423235219 + -0.01803775142475871i, -0.0001584373353289356 + -0.0027562462761626908i }, { 0.022938034804349933 + 0.012591318838418138i, 0.3155071400439864 + 8.49944623010487e-20i, 0.002274740261146596 + -0.0009899530874394077i, 0.01415042743354284 + -0.025512142057483644i }, { 0.01046341423235219 + 0.01803775142475871i, 0.002274740261146596 + 0.0009899530874394077i, 0.19123776722179664 + 7.371833619072581e-21i, 0.020082228261422856 + -0.011502515657135323i }, { -0.0001584373353289354 + 0.0027562462761626908i, 0.01415042743354284 + 0.025512142057483644i, 0.020082228261422856 + 0.011502515657135323i, 0.27558598780182997 + -3.970466940254563e-22i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, false, false, true, true, false}), ElementsAreArray({ DoubleNear(0.21766910493238711, 1.0e-7), DoubleNear(0.3155071400439864, 1.0e-7), DoubleNear(0.19123776722179664, 1.0e-7), DoubleNear(0.27558598780182997, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, false, false, true, false, true}), Matrix({ { 0.19753906151877898 + 2.0447904742310844e-20i, 0.020762683592673442 + -0.01176443632359872i, 0.017407206716216185 + 0.02109744689549235i, 0.0029298305335350838 + 0.0012709289971867027i }, { 0.020762683592673442 + 0.01176443632359872i, 0.2850947028316375 + 2.1969917069408415e-21i, 0.0007497272694178245 + 0.003217318913594565i, 0.025354799292485228 + 0.03105699239128501i }, { 0.017407206716216185 + -0.021097446895492346i, 0.0007497272694178246 + -0.003217318913594565i, 0.21136781063540477 + 1.394047486335617e-20i, 0.022257579473099347 + -0.01232939817195474i }, { 0.0029298305335350838 + -0.0012709289971867027i, 0.025354799292485228 + -0.031056992391285006i, 0.022257579473099347 + 0.01232939817195474i, 0.3059984250141788 + 8.24004239000824e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, false, false, true, false, true}), ElementsAreArray({ DoubleNear(0.19753906151877898, 1.0e-7), DoubleNear(0.2850947028316375, 1.0e-7), DoubleNear(0.21136781063540477, 1.0e-7), DoubleNear(0.3059984250141788, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, false, false, false, true, true}), Matrix({ { 0.23821966280815665 + 1.5259827940378255e-20i, -0.013603326656816721 + -0.046013217140218214i, 0.024074273942572277 + 0.012882897284940796i, 0.03424288368330004 + 0.018557992556915443i }, { -0.013603326656816721 + 0.046013217140218214i, 0.24441410154225987 + 7.38506850887343e-21i, 0.048712833719351534 + 0.017484574924689064i, 0.018687732066129135 + 0.039271542001836565i }, { 0.024074273942572277 + -0.012882897284940794i, 0.048712833719351534 + -0.017484574924689064i, 0.29495658216821685 + 9.675118034726488e-20i, 0.038217168322711756 + 0.002463323657975863i }, { 0.03424288368330004 + -0.018557992556915443i, 0.018687732066129135 + -0.03927154200183656i, 0.038217168322711756 + -0.002463323657975863i, 0.2224096534813667 + -4.1028158382630474e-22i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, false, false, false, true, true}), ElementsAreArray({ DoubleNear(0.23821966280815665, 1.0e-7), DoubleNear(0.24441410154225987, 1.0e-7), DoubleNear(0.29495658216821685, 1.0e-7), DoubleNear(0.2224096534813667, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, true, true, false, false, false, false, false, false, false}), Matrix({ { 0.307545935154588 + 2.960000979613e-20i, 0.0 + 0.0i, -0.031484685287080254 + -0.025264513279925904i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.28489223180695145 + 4.214275061170056e-20i, 0.0 + 0.0i, -0.029418466934109162 + -0.022652507336983i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.031484685287080254 + 0.025264513279925904i, 0.0 + 0.0i, 0.20834586574873906 + 2.0425392109239446e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.029418466934109162 + 0.022652507336983i, 0.0 + 0.0i, 0.19921596728972157 + 2.681764269562024e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, true, true, false, false, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.307545935154588, 1.0e-7), DoubleNear(0.28489223180695145, 1.0e-7), DoubleNear(0.20834586574873906, 1.0e-7), DoubleNear(0.19921596728972157, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.0, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, true, false, true, false, false, false, false, false, false}), Matrix({ { 0.18558142007380105 + -1.9396804245852842e-20i, 0.0 + 0.0i, -0.018998719502044 + -0.015246208679632637i, 0.0 + 0.0i, 0.0 + 0.0i, -0.0013405393378438427 + 0.0020945599296335266i, 0.0 + 0.0i, 0.00024264370803249685 + -7.718525768734e-05i }, { 0.0 + 0.0i, 0.17191394355151174 + -3.38772044180058e-20i, 0.0 + 0.0i, -0.01775269453603994 + -0.013666579018350536i, 0.0015938476248183514 + -0.001864523625033955i, 0.0 + 0.0i, -0.00036005421276587155 + 0.00011991243638900261i, 0.0 + 0.0i }, { -0.018998719502044 + 0.015246208679632637i, 0.0 + 0.0i, 0.1257251750207736 + -1.1730571251618242e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 8.617710575018614e-07 + -0.000386510612149379i, 0.0 + 0.0i, -0.000472646602847857 + 0.0019270093516836942i }, { 0.0 + 0.0i, -0.01775269453603994 + 0.013666579018350536i, 0.0 + 0.0i, 0.12022551736483257 + -3.557287981194642e-20i, -1.2085951167674771e-05 + 0.0002462534208372057i, 0.0 + 0.0i, 0.0016986122312345948 + -0.0009989954629708283i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0015938476248183514 + 0.001864523625033955i, 0.0 + 0.0i, -1.2085951167674751e-05 + -0.0002462534208372057i, 0.12196451508078693 + 4.8996814041982845e-20i, 0.0 + 0.0i, -0.012485965785036256 + -0.010018304600293265i, 0.0 + 0.0i }, { -0.0013405393378438427 + -0.0020945599296335266i, 0.0 + 0.0i, 8.617710575018817e-07 + 0.00038651061214937894i, 0.0 + 0.0i, 0.0 + 0.0i, 0.1129782882554397 + 7.601995502970636e-20i, 0.0 + 0.0i, -0.011665772398069218 + -0.008985928318632463i }, { 0.0 + 0.0i, -0.0003600542127658716 + -0.00011991243638900264i, 0.0 + 0.0i, 0.0016986122312345948 + 0.0009989954629708283i, -0.012485965785036256 + 0.010018304600293265i, 0.0 + 0.0i, 0.08262069072796546 + 3.215596336085769e-20i, 0.0 + 0.0i }, { 0.0002426437080324968 + 7.718525768733997e-05i, 0.0 + 0.0i, -0.0004726466028478569 + -0.001927009351683694i, 0.0 + 0.0i, 0.0 + 0.0i, -0.011665772398069218 + 0.008985928318632463i, 0.0 + 0.0i, 0.078990449924889 + 6.239052250756666e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, true, false, true, false, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.18558142007380105, 1.0e-7), DoubleNear(0.17191394355151174, 1.0e-7), DoubleNear(0.1257251750207736, 1.0e-7), DoubleNear(0.12022551736483257, 1.0e-7), DoubleNear(0.12196451508078693, 1.0e-7), DoubleNear(0.1129782882554397, 1.0e-7), DoubleNear(0.08262069072796546, 1.0e-7), DoubleNear(0.078990449924889, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, true, false, false, true, false, false, false, false, false}), Matrix({ { 0.18558142007380105 + -1.9396804245852842e-20i, 0.0 + 0.0i, -0.018998719502044 + -0.015246208679632637i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0012034364959114248 + 0.01694916091932558i, 0.0 + 0.0i, 0.0009872748463816824 + -0.0014686116794331591i }, { 0.0 + 0.0i, 0.1129782882554397 + 7.601995502970636e-20i, 0.0 + 0.0i, -0.011665772398069218 + -0.008985928318632463i, 0.0007820783082310913 + -0.011135939193094462i, 0.0 + 0.0i, -0.0009998611180012508 + 0.001364562042238358i, 0.0 + 0.0i }, { -0.018998719502044 + 0.015246208679632637i, 0.0 + 0.0i, 0.1257251750207736 + -1.1730571251618242e-20i, 0.0 + 0.0i, 0.0 + 0.0i, -0.0015265674380514887 + -0.0020872267115618123i, 0.0 + 0.0i, 0.005240526854973682 + 0.012535993036694981i }, { 0.0 + 0.0i, -0.011665772398069218 + 0.008985928318632463i, 0.0 + 0.0i, 0.078990449924889 + 6.239052250756666e-20i, 0.0006510389175511863 + 0.0009718952659801691i, 0.0 + 0.0i, 0.0034282828875058643 + -0.008235701506193535i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0007820783082310915 + 0.011135939193094462i, 0.0 + 0.0i, 0.0006510389175511863 + -0.0009718952659801691i, 0.12196451508078693 + 4.8996814041982845e-20i, 0.0 + 0.0i, -0.012485965785036256 + -0.010018304600293265i, 0.0 + 0.0i }, { 0.0012034364959114248 + -0.01694916091932558i, 0.0 + 0.0i, -0.0015265674380514887 + 0.0020872267115618123i, 0.0 + 0.0i, 0.0 + 0.0i, 0.17191394355151174 + -3.38772044180058e-20i, 0.0 + 0.0i, -0.01775269453603994 + -0.013666579018350536i }, { 0.0 + 0.0i, -0.0009998611180012506 + -0.001364562042238358i, 0.0 + 0.0i, 0.0034282828875058643 + 0.008235701506193537i, -0.012485965785036256 + 0.010018304600293265i, 0.0 + 0.0i, 0.08262069072796546 + 3.215596336085769e-20i, 0.0 + 0.0i }, { 0.0009872748463816824 + 0.0014686116794331587i, 0.0 + 0.0i, 0.005240526854973682 + -0.012535993036694981i, 0.0 + 0.0i, 0.0 + 0.0i, -0.01775269453603994 + 0.013666579018350536i, 0.0 + 0.0i, 0.12022551736483257 + -3.557287981194642e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, true, false, false, true, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.18558142007380105, 1.0e-7), DoubleNear(0.1129782882554397, 1.0e-7), DoubleNear(0.1257251750207736, 1.0e-7), DoubleNear(0.078990449924889, 1.0e-7), DoubleNear(0.12196451508078693, 1.0e-7), DoubleNear(0.17191394355151174, 1.0e-7), DoubleNear(0.08262069072796546, 1.0e-7), DoubleNear(0.12022551736483257, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, true, false, false, false, true, false, false, false, false}), Matrix({ { 0.15056263369652223 + 8.889285237352843e-21i, 0.0 + 0.0i, -0.015542354052154678 + -0.011962058660419696i, 0.0 + 0.0i, -0.027712018380893738 + 0.0011302337614768005i, 0.0 + 0.0i, 0.0030008935795152246 + 0.0022021430882610497i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.1424807972445187 + 9.058030082313658e-21i, 0.0 + 0.0i, -0.014826238168590442 + -0.010983606834691705i, 0.0 + 0.0i, -0.0258525711151839 + 4.473865922581638e-05i, 0.0 + 0.0i, 0.0028803387253508728 + 0.0020995135757556505i }, { -0.015542354052154678 + 0.011962058660419696i, 0.0 + 0.0i, 0.10530903630798302 + 4.409297470662183e-21i, 0.0 + 0.0i, 0.002637931866252487 + -0.0023647069037590423i, 0.0 + 0.0i, -0.01893172282420805 + -0.0003627809186035122i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.014826238168590442 + 0.010983606834691705i, 0.0 + 0.0i, 0.10270238125643133 + 5.348147465909869e-21i, 0.0 + 0.0i, 0.0024938074086038363 + -0.0019983568447645905i, 0.0 + 0.0i, -0.01791749368211356 + -0.0012024791316252153i }, { -0.027712018380893738 + -0.001130233761476801i, 0.0 + 0.0i, 0.0026379318662524865 + 0.0023647069037590423i, 0.0 + 0.0i, 0.15698330145806577 + 2.0710724558777163e-20i, 0.0 + 0.0i, -0.015942331234925576 + -0.013302454619506208i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.0258525711151839 + -4.4738659225816626e-05i, 0.0 + 0.0i, 0.0024938074086038363 + 0.001998356844764591i, 0.0 + 0.0i, 0.14241143456243274 + 3.3084720529386905e-20i, 0.0 + 0.0i, -0.014592228765518718 + -0.011668900502291295i }, { 0.0030008935795152246 + -0.00220214308826105i, 0.0 + 0.0i, -0.01893172282420805 + 0.00036278091860351215i, 0.0 + 0.0i, -0.015942331234925576 + 0.013302454619506208i, 0.0 + 0.0i, 0.10303682944075605 + 1.6016094638577263e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0028803387253508728 + -0.0020995135757556505i, 0.0 + 0.0i, -0.01791749368211356 + 0.001202479131625215i, 0.0 + 0.0i, -0.014592228765518718 + 0.011668900502291295i, 0.0 + 0.0i, 0.09651358603329024 + 2.146949522971037e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, true, false, false, false, true, false, false, false, false}), ElementsAreArray({ DoubleNear(0.15056263369652223, 1.0e-7), DoubleNear(0.1424807972445187, 1.0e-7), DoubleNear(0.10530903630798302, 1.0e-7), DoubleNear(0.10270238125643133, 1.0e-7), DoubleNear(0.15698330145806577, 1.0e-7), DoubleNear(0.14241143456243274, 1.0e-7), DoubleNear(0.10303682944075605, 1.0e-7), DoubleNear(0.09651358603329024, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, true, false, false, false, false, true, false, false, false}), Matrix({ { 0.144647836847364 + 1.4743335450319415e-20i, 0.0 + 0.0i, -0.006328803944944493 + -0.010263563726555168i, 0.0 + 0.0i, 0.0055282846882914235 + 0.013255998163414502i, 0.0 + 0.0i, 0.0002464053429916288 + 0.00539013888064995i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.1321682240886754 + 1.961370853946649e-20i, 0.0 + 0.0i, -0.004749686702495672 + -0.00927953456211935i, 0.0 + 0.0i, 0.004795750073514601 + 0.01054939524933848i, 0.0 + 0.0i, 0.0012584223939887218 + 0.003955690282345107i }, { -0.006328803944944493 + 0.010263563726555168i, 0.0 + 0.0i, 0.11403121358493523 + 1.3240155747091675e-20i, 0.0 + 0.0i, 0.007548032880174608 + -0.00923681626075233i, 0.0 + 0.0i, -0.02616265712712732 + -0.010442386534640906i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.004749686702495672 + 0.00927953456211935i, 0.0 + 0.0i, 0.10701413498400575 + 1.4829395712442132e-20i, 0.0 + 0.0i, 0.0029277656948772943 + -0.007726055982122898i, 0.0 + 0.0i, -0.022355851053186895 + -0.011135660216003339i }, { 0.0055282846882914235 + -0.013255998163414502i, 0.0 + 0.0i, 0.007548032880174608 + 0.00923681626075233i, 0.0 + 0.0i, 0.162898098307224 + 1.4856674345810588e-20i, 0.0 + 0.0i, -0.025155881342135762 + -0.015000949553370734i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.004795750073514601 + -0.01054939524933848i, 0.0 + 0.0i, 0.0029277656948772943 + 0.007726055982122898i, 0.0 + 0.0i, 0.152724007718276 + 2.2529042072234072e-20i, 0.0 + 0.0i, -0.024668780231613487 + -0.01337297277486365i }, { 0.0002464053429916288 + -0.00539013888064995i, 0.0 + 0.0i, -0.02616265712712732 + 0.010442386534640906i, 0.0 + 0.0i, -0.025155881342135762 + 0.015000949553370734i, 0.0 + 0.0i, 0.09431465216380383 + 7.185236362147771e-21i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0012584223939887218 + -0.003955690282345107i, 0.0 + 0.0i, -0.022355851053186895 + 0.011135660216003339i, 0.0 + 0.0i, -0.024668780231613487 + 0.01337297277486365i, 0.0 + 0.0i, 0.09220183230571583 + 1.1988246983178108e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, true, false, false, false, false, true, false, false, false}), ElementsAreArray({ DoubleNear(0.144647836847364, 1.0e-7), DoubleNear(0.1321682240886754, 1.0e-7), DoubleNear(0.11403121358493523, 1.0e-7), DoubleNear(0.10701413498400575, 1.0e-7), DoubleNear(0.162898098307224, 1.0e-7), DoubleNear(0.152724007718276, 1.0e-7), DoubleNear(0.09431465216380383, 1.0e-7), DoubleNear(0.09220183230571583, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, true, false, false, false, false, false, true, false, false}), Matrix({ { 0.12641333252996145 + 2.901767464489267e-20i, 0.0 + 0.0i, -0.013097322273997701 + -0.009902639330757128i, 0.0 + 0.0i, 0.01945226442328306 + -0.029728147816263963i, 0.0 + 0.0i, -0.004401949696720781 + 0.0014676067048492527i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.11223751454345558 + -5.8709256130433856e-21i, 0.0 + 0.0i, -0.011667266550292118 + -0.008690068176853732i, 0.0 + 0.0i, 0.005982387632692354 + 0.018064909460721715i, 0.0 + 0.0i, 0.001358496700159242 + -0.0021409066267212085i }, { -0.013097322273997701 + 0.009902639330757128i, 0.0 + 0.0i, 0.08968497192874701 + 1.7990172385883332e-20i, 0.0 + 0.0i, 0.00041740917875966195 + 0.004638698254342809i, 0.0 + 0.0i, 0.013426219357513342 + -0.020533384054261642i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.011667266550292118 + 0.008690068176853732i, 0.0 + 0.0i, 0.08057105315201965 + -6.7485418120656076e-21i, 0.0 + 0.0i, -0.002596954309988583 + -0.001231605436751544i, 0.0 + 0.0i, 0.0041593916522840385 + 0.008102787914250436i }, { 0.01945226442328306 + 0.029728147816263963i, 0.0 + 0.0i, 0.000417409178759662 + -0.004638698254342809i, 0.0 + 0.0i, 0.18113260262462652 + 5.8233515123733e-22i, 0.0 + 0.0i, -0.01838736301308256 + -0.015361873949168773i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.005982387632692354 + -0.018064909460721715i, 0.0 + 0.0i, -0.002596954309988583 + 0.001231605436751544i, 0.0 + 0.0i, 0.17265471726349585 + 4.801367622474395e-20i, 0.0 + 0.0i, -0.017751200383817042 + -0.01396243916012927i }, { -0.004401949696720781 + -0.0014676067048492527i, 0.0 + 0.0i, 0.013426219357513342 + 0.020533384054261642i, 0.0 + 0.0i, -0.01838736301308256 + 0.015361873949168773i, 0.0 + 0.0i, 0.11866089381999206 + 2.4352197233561135e-21i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.001358496700159242 + 0.0021409066267212085i, 0.0 + 0.0i, 0.0041593916522840385 + -0.008102787914250434i, 0.0 + 0.0i, -0.017751200383817042 + 0.01396243916012927i, 0.0 + 0.0i, 0.11864491413770192 + 3.356618450768585e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, true, false, false, false, false, false, true, false, false}), ElementsAreArray({ DoubleNear(0.12641333252996145, 1.0e-7), DoubleNear(0.11223751454345558, 1.0e-7), DoubleNear(0.08968497192874701, 1.0e-7), DoubleNear(0.08057105315201965, 1.0e-7), DoubleNear(0.18113260262462652, 1.0e-7), DoubleNear(0.17265471726349585, 1.0e-7), DoubleNear(0.11866089381999206, 1.0e-7), DoubleNear(0.11864491413770192, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, true, false, false, false, false, false, false, true, false}), Matrix({ { 0.16422811164912904 + 2.642426223710993e-20i, 0.0 + 0.0i, -0.016803549145445497 + -0.013518925777843221i, 0.0 + 0.0i, 0.007289619142265313 + -0.013230023145318553i, 0.0 + 0.0i, -0.0018253789268658056 + 0.000786430332336407i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.15191939151829192 + 4.1242778105242865e-20i, 0.0 + 0.0i, -0.015679161515757458 + -0.012105828510136077i, 0.0 + 0.0i, 0.006981284689095287 + -0.012391081834094509i, 0.0 + 0.0i, -0.0016981771462538874 + 0.000766613202171248i }, { -0.016803549145445497 + 0.013518925777843221i, 0.0 + 0.0i, 0.11102160140127867 + 1.673223186161918e-20i, 0.0 + 0.0i, 0.0003147429575012326 + 0.001933864380720757i, 0.0 + 0.0i, 0.0051940063550558494 + -0.009113333363017194i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.015679161515757458 + 0.012105828510136077i, 0.0 + 0.0i, 0.10600714040767392 + 2.7611736083671146e-20i, 0.0 + 0.0i, 0.00023480846723630865 + 0.0018038355951736167i, 0.0 + 0.0i, 0.005148931479478581 + -0.008815455139812092i }, { 0.007289619142265313 + 0.013230023145318556i, 0.0 + 0.0i, 0.00031474295750123283 + -0.001933864380720757i, 0.0 + 0.0i, 0.14331782350545896 + 3.175747559020074e-21i, 0.0 + 0.0i, -0.01468113614163476 + -0.01174558750208268i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.006981284689095287 + 0.012391081834094509i, 0.0 + 0.0i, 0.00023480846723630865 + -0.0018038355951736167i, 0.0 + 0.0i, 0.1329728402886595 + 8.999725064576941e-22i, 0.0 + 0.0i, -0.013739305418351704 + -0.010546678826846923i }, { -0.0018253789268658056 + -0.000786430332336407i, 0.0 + 0.0i, 0.0051940063550558494 + 0.009113333363017196i, 0.0 + 0.0i, -0.01468113614163476 + 0.01174558750208268i, 0.0 + 0.0i, 0.0973242643474604 + 3.693160247620265e-21i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.0016981771462538874 + -0.000766613202171248i, 0.0 + 0.0i, 0.005148931479478581 + 0.008815455139812092i, 0.0 + 0.0i, -0.013739305418351704 + 0.010546678826846923i, 0.0 + 0.0i, 0.09320882688204765 + -7.940933880509066e-22i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, true, false, false, false, false, false, false, true, false}), ElementsAreArray({ DoubleNear(0.16422811164912904, 1.0e-7), DoubleNear(0.15191939151829192, 1.0e-7), DoubleNear(0.11102160140127867, 1.0e-7), DoubleNear(0.10600714040767392, 1.0e-7), DoubleNear(0.14331782350545896, 1.0e-7), DoubleNear(0.1329728402886595, 1.0e-7), DoubleNear(0.0973242643474604, 1.0e-7), DoubleNear(0.09320882688204765, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, true, false, false, false, false, false, false, false, true}), Matrix({ { 0.14829764676255475 + 1.3537414286717308e-20i, 0.0 + 0.0i, -0.015186374207293463 + -0.012168456157570267i, 0.0 + 0.0i, 0.013204893580616325 + 0.01620114083127609i, 0.0 + 0.0i, -6.18676984557654e-06 + -0.0027395176578611374i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.13748715740867373 + 1.5881867761018131e-21i, 0.0 + 0.0i, -0.01420189312735984 + -0.01091710519781865i, 0.0 + 0.0i, 0.012190223951395851 + 0.01487584241392607i, 0.0 + 0.0i, -5.1442042392560667e-05 + -0.002509946617160759i }, { -0.015186374207293463 + 0.012168456157570267i, 0.0 + 0.0i, 0.10058866570076702 + 8.485442341894499e-21i, 0.0 + 0.0i, -0.002696144122498247 + -0.0005676008411791278i, 0.0 + 0.0i, 0.008897888877308371 + 0.010828024334156371i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.01420189312735984 + 0.01091710519781865i, 0.0 + 0.0i, 0.09626029447842102 + -9.661469554619363e-22i, 0.0 + 0.0i, -0.0024596561943173115 + -0.0005495196144245983i, 0.0 + 0.0i, 0.008468999599380866 + 0.010249431707418825i }, { 0.013204893580616323 + -0.01620114083127609i, 0.0 + 0.0i, -0.002696144122498247 + 0.0005676008411791279i, 0.0 + 0.0i, 0.15924828839203325 + 1.6062595509412693e-20i, 0.0 + 0.0i, -0.01629831107978679 + -0.013096057122355636i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.012190223951395851 + -0.01487584241392607i, 0.0 + 0.0i, -0.0024596561943173115 + 0.0005495196144245983i, 0.0 + 0.0i, 0.14740507439827769 + 4.0554563835598746e-20i, 0.0 + 0.0i, -0.015216573806749324 + -0.011735402139164349i }, { -6.186769845576486e-06 + 0.0027395176578611374i, 0.0 + 0.0i, 0.008897888877308371 + -0.010828024334156371i, 0.0 + 0.0i, -0.01629831107978679 + 0.013096057122355636i, 0.0 + 0.0i, 0.10775720004797204 + 1.1939949767344947e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, -5.1442042392560667e-05 + 0.0025099466171607586i, 0.0 + 0.0i, 0.008468999599380866 + -0.010249431707418825i, 0.0 + 0.0i, -0.015216573806749324 + 0.011735402139164349i, 0.0 + 0.0i, 0.10295567281130055 + 2.7783789651082176e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, true, false, false, false, false, false, false, false, true}), ElementsAreArray({ DoubleNear(0.14829764676255475, 1.0e-7), DoubleNear(0.13748715740867373, 1.0e-7), DoubleNear(0.10058866570076702, 1.0e-7), DoubleNear(0.09626029447842102, 1.0e-7), DoubleNear(0.15924828839203325, 1.0e-7), DoubleNear(0.14740507439827769, 1.0e-7), DoubleNear(0.10775720004797204, 1.0e-7), DoubleNear(0.10295567281130055, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, true, true, false, false, false, false, false, false}), Matrix({ { 0.3113065950945747 + -3.112737549747108e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, -0.0018131859406916996 + 0.00402156928131722i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.2921394609163443 + -6.945008422995222e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.003292459856052946 + -0.0028635190880047833i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0032924598560529457 + 0.0028635190880047833i, 0.0 + 0.0i, 0.0 + 0.0i, 0.2045852058087524 + 8.115277740284052e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.0018131859406916994 + -0.00402156928131722i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.1919687381803287 + 1.3841047753727301e-19i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, true, true, false, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.3113065950945747, 1.0e-7), DoubleNear(0.2921394609163443, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.2045852058087524, 1.0e-7), DoubleNear(0.1919687381803287, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.0, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, true, false, true, false, false, false, false, false}), Matrix({ { 0.3113065950945747 + -3.112737549747108e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.006443963350885108 + 0.02948515395602056i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.1919687381803287 + 1.3841047753727301e-19i, 0.0 + 0.0i, 0.0 + 0.0i, 0.004210361195736955 + -0.019371640699287998i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.004210361195736955 + 0.019371640699287995i, 0.0 + 0.0i, 0.0 + 0.0i, 0.2045852058087524 + 8.115277740284052e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.006443963350885108 + -0.02948515395602056i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.2921394609163443 + -6.945008422995222e-20i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, true, false, true, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.3113065950945747, 1.0e-7), DoubleNear(0.1919687381803287, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.2045852058087524, 1.0e-7), DoubleNear(0.2921394609163443, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.0, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, true, false, false, true, false, false, false, false}), Matrix({ { 0.2558716700045053 + 1.3298582708015026e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, -0.04664374120510179 + 0.0007674528428732884i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.24518317850095003 + 1.4406177548223527e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, -0.04377006479729746 + -0.0011577404723993989i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.04664374120510179 + -0.0007674528428732887i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.2600201308988218 + 3.672681919735442e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.04377006479729746 + 0.0011577404723993982i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.23892502059572296 + 5.455421575909728e-20i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, true, false, false, true, false, false, false, false}), ElementsAreArray({ DoubleNear(0.2558716700045053, 1.0e-7), DoubleNear(0.24518317850095003, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.2600201308988218, 1.0e-7), DoubleNear(0.23892502059572296, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.0, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, true, false, false, false, true, false, false, false}), Matrix({ { 0.2586790504322992 + 2.7983491197411094e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, -0.0206343724388359 + 0.0028136116287735963i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.23918235907268115 + 3.444310425190862e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, -0.01756010097967229 + -0.0005862649666648591i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.0206343724388359 + -0.0028136116287735963i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.2572127504710278 + 2.2041910707958358e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.01756010097967229 + 0.0005862649666648591i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.24492584002399181 + 3.451728905541218e-20i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, true, false, false, false, true, false, false, false}), ElementsAreArray({ DoubleNear(0.2586790504322992, 1.0e-7), DoubleNear(0.23918235907268115, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.2572127504710278, 1.0e-7), DoubleNear(0.24492584002399181, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.0, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, true, false, false, false, false, true, false, false}), Matrix({ { 0.21609830445870848 + 4.700784703077601e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0328784837807964 + -0.05026153187052561i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.19280856769547525 + -1.2619467425108993e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.010141779284976393 + 0.02616769737497215i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0328784837807964 + 0.05026153187052561i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.2997934964446186 + 3.017554874593442e-21i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.010141779284976393 + -0.02616769737497215i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.29129963140119775 + 8.15798607324298e-20i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, true, false, false, false, false, true, false, false}), ElementsAreArray({ DoubleNear(0.21609830445870848, 1.0e-7), DoubleNear(0.19280856769547525, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.2997934964446186, 1.0e-7), DoubleNear(0.29129963140119775, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.0, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, true, false, false, false, false, false, true, false}), Matrix({ { 0.2752497130504077 + 4.315649409872911e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.012483625497321165 + -0.022343356508335747i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.2579265319259658 + 6.885451418891402e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.01213021616857387 + -0.0212065369739066i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.012483625497321165 + 0.02234335650833575i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.2406420878529194 + 6.868907806640337e-21i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.01213021616857387 + 0.0212065369739066i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.22618166717070715 + 1.0587911840678754e-22i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, true, false, false, false, false, false, true, false}), ElementsAreArray({ DoubleNear(0.2752497130504077, 1.0e-7), DoubleNear(0.2579265319259658, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.2406420878529194, 1.0e-7), DoubleNear(0.22618166717070715, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.0, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, true, false, false, false, false, false, false, true}), Matrix({ { 0.24888631246332177 + 2.202285662861181e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.022102782457924696 + 0.027029165165432457i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.23374745188709473 + 6.220398206398768e-22i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.02065922355077672 + 0.025125274121344895i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.022102782457924696 + -0.027029165165432457i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.2670054884400053 + 2.8002545276757646e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.020659223550776717 + -0.025125274121344895i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.25036074720957824 + 6.833835348668093e-20i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, true, false, false, false, false, false, false, true}), ElementsAreArray({ DoubleNear(0.24888631246332177, 1.0e-7), DoubleNear(0.23374745188709473, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.2670054884400053, 1.0e-7), DoubleNear(0.25036074720957824, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.0, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, true, true, false, false, false, false, false}), Matrix({ { 0.3113065950945747 + -3.112737549747108e-20i, 0.0 + 0.0i, 0.0 + 0.0i, -0.0018131859406916996 + 0.00402156928131722i, 0.0 + 0.0i, 0.006443963350885108 + 0.02948515395602056i, 0.036378279048991054 + 0.026900467764900522i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.0018131859406916994 + -0.00402156928131722i, 0.0 + 0.0i, 0.0 + 0.0i, 0.1919687381803287 + 1.3841047753727301e-19i, 0.0 + 0.0i, 0.03412745338329306 + -0.025262474481396707i, 0.004210361195736955 + -0.019371640699287998i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.006443963350885108 + -0.02948515395602056i, 0.0 + 0.0i, 0.0 + 0.0i, 0.03412745338329306 + 0.025262474481396707i, 0.0 + 0.0i, 0.2921394609163443 + -6.945008422995222e-20i, 0.003292459856052946 + -0.0028635190880047833i, 0.0 + 0.0i }, { 0.036378279048991054 + -0.026900467764900522i, 0.0 + 0.0i, 0.0 + 0.0i, 0.004210361195736955 + 0.019371640699287995i, 0.0 + 0.0i, 0.0032924598560529457 + 0.0028635190880047833i, 0.2045852058087524 + 8.115277740284052e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, true, true, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.3113065950945747, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.1919687381803287, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.2921394609163443, 1.0e-7), DoubleNear(0.2045852058087524, 1.0e-7), DoubleNear(0.0, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, true, false, true, false, false, false, false}), Matrix({ { 0.15420211024555375 + -1.434930908707024e-20i, 0.0 + 0.0i, 0.0 + 0.0i, -0.0005683480712661817 + 0.002262087038530554i, -0.02753719858536808 + 0.0005975421335171081i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0006176485792542554 + -0.0005535958868027456i }, { 0.0 + 0.0i, 0.14778153597353788 + -1.5028217368863407e-20i, 0.0020623268010758512 + -0.0012988167252155308i, 0.0 + 0.0i, 0.0 + 0.0i, -0.0258562572467477 + -0.0007064386782379571i, 0.00012454922716982766 + -0.00031010626023301926i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0020623268010758512 + 0.001298816725215531i, 0.1016695597589515 + 2.7647891795085266e-20i, 0.0 + 0.0i, 0.0 + 0.0i, -0.0006186532447992187 + -0.0006973962523030732i, -0.01910654261973371 + 0.00016991070935618006i, 0.0 + 0.0i }, { -0.0005683480712661817 + -0.002262087038530554i, 0.0 + 0.0i, 0.0 + 0.0i, 0.09740164252741217 + 2.9434394917086937e-20i, -0.00044294226414840333 + -0.00011867284218759733i, 0.0 + 0.0i, 0.0 + 0.0i, -0.017913807550549762 + -0.00045130179416144167i }, { -0.02753719858536808 + -0.0005975421335171083i, 0.0 + 0.0i, 0.0 + 0.0i, -0.0004429422641484033 + 0.00011867284218759731i, 0.1571044848490209 + -1.6778066410400844e-20i, 0.0 + 0.0i, 0.0 + 0.0i, -0.001244837869425518 + 0.0017594822427866668i }, { 0.0 + 0.0i, -0.0258562572467477 + 0.0007064386782379569i, -0.0006186532447992189 + 0.000697396252303073i, 0.0 + 0.0i, 0.0 + 0.0i, 0.14435792494280644 + -5.442186686108881e-20i, 0.0012301330549770945 + -0.0015647023627892525i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0001245492271698277 + 0.0003101062602330193i, -0.01910654261973371 + -0.00016991070935618016i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0012301330549770945 + 0.0015647023627892527i, 0.10291564604980089 + 5.3504885607755264e-20i, 0.0 + 0.0i }, { 0.0006176485792542555 + 0.0005535958868027456i, 0.0 + 0.0i, 0.0 + 0.0i, -0.017913807550549762 + 0.00045130179416144156i, -0.0012448378694255178 + -0.0017594822427866664i, 0.0 + 0.0i, 0.0 + 0.0i, 0.09456709565291652 + 1.0897608262018608e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, true, false, true, false, false, false, false}), ElementsAreArray({ DoubleNear(0.15420211024555375, 1.0e-7), DoubleNear(0.14778153597353788, 1.0e-7), DoubleNear(0.1016695597589515, 1.0e-7), DoubleNear(0.09740164252741217, 1.0e-7), DoubleNear(0.1571044848490209, 1.0e-7), DoubleNear(0.14435792494280644, 1.0e-7), DoubleNear(0.10291564604980089, 1.0e-7), DoubleNear(0.09456709565291652, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, true, false, false, true, false, false, false}), Matrix({ { 0.15608679665598138 + -1.43698444632997e-20i, 0.0 + 0.0i, 0.0 + 0.0i, -0.0011623655534633457 + 0.0017311666960935293i, -0.012454839426543131 + 0.0016924983370083051i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0003891240750816745 + -0.00020911395618674456i }, { 0.0 + 0.0i, 0.14433765278036642 + -2.941059525565168e-20i, 0.0013015045599406678 + -0.001595274680619282i, 0.0 + 0.0i, 0.0 + 0.0i, -0.010588471626668549 + -0.00035516881164120373i, 0.00017057912367883686 + -7.432028880679684e-05i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0013015045599406678 + 0.0015952746806192821i, 0.10259225377631784 + 4.2353335660710795e-20i, 0.0 + 0.0i, 0.0 + 0.0i, -5.961872827006842e-05 + -0.0004562703201958238i, -0.008179533012292768 + 0.0011211132917652912i, 0.0 + 0.0i }, { -0.0011623655534633453 + -0.0017311666960935293i, 0.0 + 0.0i, 0.0 + 0.0i, 0.09484470629231476 + 6.385369950756031e-20i, 1.1592246693453717e-05 + -0.0002019769869022202i, 0.0 + 0.0i, 0.0 + 0.0i, -0.006971629353003744 + -0.00023109615502365542i }, { -0.012454839426543131 + -0.0016924983370083051i, 0.0 + 0.0i, 0.0 + 0.0i, 1.1592246693453744e-05 + 0.0002019769869022202i, 0.15521979843859326 + -1.6757531034171383e-20i, 0.0 + 0.0i, 0.0 + 0.0i, -0.0006508203872283541 + 0.0022904025852236915i }, { 0.0 + 0.0i, -0.010588471626668549 + 0.00035516881164120373i, -5.9618728270068434e-05 + 0.00045627032019582373i, 0.0 + 0.0i, 0.0 + 0.0i, 0.1478018081359779 + -4.003948897430053e-20i, 0.0019909552961122783 + -0.0012682444073855012i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0001705791236788369 + 7.432028880679682e-05i, -0.008179533012292768 + -0.0011211132917652912i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0019909552961122783 + 0.0012682444073855014i, 0.10199295203243455 + 3.879944174212974e-20i, 0.0 + 0.0i }, { 0.0003891240750816745 + 0.0002091139561867445i, 0.0 + 0.0i, 0.0 + 0.0i, -0.006971629353003744 + 0.00023109615502365542i, -0.0006508203872283541 + -0.002290402585223691i, 0.0 + 0.0i, 0.0 + 0.0i, 0.09712403188801394 + 7.455677802971271e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, true, false, false, true, false, false, false}), ElementsAreArray({ DoubleNear(0.15608679665598138, 1.0e-7), DoubleNear(0.14433765278036642, 1.0e-7), DoubleNear(0.10259225377631784, 1.0e-7), DoubleNear(0.09484470629231476, 1.0e-7), DoubleNear(0.15521979843859326, 1.0e-7), DoubleNear(0.1478018081359779, 1.0e-7), DoubleNear(0.10199295203243455, 1.0e-7), DoubleNear(0.09712403188801394, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, true, false, false, false, true, false, false}), Matrix({ { 0.1304088273140946 + 8.894931260294602e-21i, 0.0 + 0.0i, 0.0 + 0.0i, 0.001946844804476206 + 0.0017137880700819738i, 0.019840416329542657 + -0.030330266572238557i, 0.0 + 0.0i, 0.0 + 0.0i, -0.0007568248343072604 + 0.000554679088154181i }, { 0.0 + 0.0i, 0.11635608111158043 + -5.467994721220534e-20i, 0.0022078567869635727 + 0.001389170958576041i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0061199700121473705 + 0.015782445221016652i, 0.00018863272469212927 + -0.0011482409800802628i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0022078567869635722 + -0.001389170958576041i, 0.0856894771446139 + 3.8112915770481406e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.00029234548005215494 + 0.0008511822874325641i, 0.013038067451253741 + -0.01993126529828705i, 0.0 + 0.0i }, { 0.001946844804476206 + -0.0017137880700819736i, 0.0 + 0.0i, 0.0 + 0.0i, 0.07645248658389481 + 4.206047978709635e-20i, -0.0010300537987733937 + -0.000491056866707237i, 0.0 + 0.0i, 0.0 + 0.0i, 0.004021809272829023 + 0.010385252153955499i }, { 0.019840416329542657 + 0.030330266572238557i, 0.0 + 0.0i, 0.0 + 0.0i, -0.0010300537987733933 + 0.0004910568667072371i, 0.1808977677804801 + -4.0022306757765685e-20i, 0.0 + 0.0i, 0.0 + 0.0i, -0.003760030745167906 + 0.0023077812112352472i }, { 0.0 + 0.0i, 0.0061199700121473705 + -0.015782445221016652i, 0.0002923454800521549 + -0.0008511822874325638i, 0.0 + 0.0i, 0.0 + 0.0i, 0.17578337980476388 + -1.477013701774687e-20i, 0.001084603069089374 + -0.004252690046580824i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.00018863272469212924 + 0.001148240980080263i, 0.013038067451253741 + 0.01993126529828705i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0010846030690893737 + 0.004252690046580824i, 0.1188957286641385 + 4.3039861632359124e-20i, 0.0 + 0.0i }, { -0.0007568248343072604 + -0.0005546790881541811i, 0.0 + 0.0i, 0.0 + 0.0i, 0.004021809272829023 + -0.010385252153955497i, -0.0037600307451679054 + -0.002307781211235247i, 0.0 + 0.0i, 0.0 + 0.0i, 0.11551625159643389 + 9.634999775017666e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, true, false, false, false, true, false, false}), ElementsAreArray({ DoubleNear(0.1304088273140946, 1.0e-7), DoubleNear(0.11635608111158043, 1.0e-7), DoubleNear(0.0856894771446139, 1.0e-7), DoubleNear(0.07645248658389481, 1.0e-7), DoubleNear(0.1808977677804801, 1.0e-7), DoubleNear(0.17578337980476388, 1.0e-7), DoubleNear(0.1188957286641385, 1.0e-7), DoubleNear(0.11551625159643389, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, true, false, false, false, false, true, false}), Matrix({ { 0.1660222166859359 + 3.4838468947532846e-20i, 0.0 + 0.0i, 0.0 + 0.0i, -0.0009700598445293709 + 0.0021306829797820472i, 0.007609172219502324 + -0.013535038220738335i, 0.0 + 0.0i, 0.0 + 0.0i, 0.00014179143051601108 + 0.0001905163067696122i }, { 0.0 + 0.0i, 0.15558539419231127 + -4.176269476657727e-20i, 0.0017263694551787005 + -0.0015373236795914445i, 0.0 + 0.0i, 0.0 + 0.0i, 0.007386427157985194 + -0.012840989651962141i, -5.937649434488711e-06 + -0.00022034018311712131i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0017263694551787 + 0.0015373236795914445i, 0.10922749636447178 + 8.318025151196273e-21i, 0.0 + 0.0i, 0.0 + 0.0i, 0.00024214707943632428 + -9.802164019438403e-05i, 0.00487445327781884 + -0.008808318287597415i, 0.0 + 0.0i }, { -0.0009700598445293706 + -0.0021306829797820472i, 0.0 + 0.0i, 0.0 + 0.0i, 0.1023411377336546 + 1.1061720895549128e-19i, -0.0002124500867445217 + -3.095996826508882e-05i, 0.0 + 0.0i, 0.0 + 0.0i, 0.004743789010588675 + -0.008365547321944462i }, { 0.007609172219502323 + 0.013535038220738335i, 0.0 + 0.0i, 0.0 + 0.0i, -0.0002124500867445217 + 3.0959968265088794e-05i, 0.14528437840863878 + -6.596584444500393e-20i, 0.0 + 0.0i, 0.0 + 0.0i, -0.0008431260961623288 + 0.0018908863015351736i }, { 0.0 + 0.0i, 0.007386427157985194 + 0.012840989651962141i, 0.00024214707943632436 + 9.802164019438397e-05i, 0.0 + 0.0i, 0.0 + 0.0i, 0.13655406672403306 + -2.768738946337494e-20i, 0.001566090400874246 + -0.0013261954084133388i, 0.0 + 0.0i }, { 0.0 + 0.0i, -5.937649434488711e-06 + 0.00022034018311712137i, 0.00487445327781884 + 0.008808318287597415i, 0.0 + 0.0i, 0.0 + 0.0i, 0.001566090400874246 + 0.0013261954084133384i, 0.09535770944428063 + 7.283475225164426e-20i, 0.0 + 0.0i }, { 0.000141791430516011 + -0.00019051630676961218i, 0.0 + 0.0i, 0.0 + 0.0i, 0.004743789010588675 + 0.008365547321944462i, -0.0008431260961623288 + -0.0018908863015351736i, 0.0 + 0.0i, 0.0 + 0.0i, 0.08962760044667412 + 2.779326858178173e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, true, false, false, false, false, true, false}), ElementsAreArray({ DoubleNear(0.1660222166859359, 1.0e-7), DoubleNear(0.15558539419231127, 1.0e-7), DoubleNear(0.10922749636447178, 1.0e-7), DoubleNear(0.1023411377336546, 1.0e-7), DoubleNear(0.14528437840863878, 1.0e-7), DoubleNear(0.13655406672403306, 1.0e-7), DoubleNear(0.09535770944428063, 1.0e-7), DoubleNear(0.08962760044667412, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, true, false, false, false, false, false, true}), Matrix({ { 0.150207391168592 + -9.836056620105997e-21i, 0.0 + 0.0i, 0.0 + 0.0i, -0.0008607210102178522 + 0.0019647998106384363i, 0.013368082486604503 + 0.016280466204215534i, 0.0 + 0.0i, 0.0 + 0.0i, -0.0003013616489604097 + 2.0269360481467056e-05i }, { 0.0 + 0.0i, 0.1410794040213112 + -5.378659215064807e-20i, 0.0016168586233343218 + -0.0013607967741409701i, 0.0 + 0.0i, 0.0 + 0.0i, 0.01248229724950502 + 0.015132514452759876i, 0.00026954285311115556 + -2.0849963348719145e-05i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0016168586233343215 + 0.00136079677414097i, 0.09867892129472977 + 3.1858913248717806e-20i, 0.0 + 0.0i, 0.0 + 0.0i, -6.485315680393572e-05 + 0.0003025822526735505i, 0.008734699971320193 + 0.010748698961216923i, 0.0 + 0.0i }, { -0.0008607210102178523 + -0.0019647998106384363i, 0.0 + 0.0i, 0.0 + 0.0i, 0.09266804786578356 + 5.440863197128795e-20i, 7.788890551262479e-05 + -0.00023959150050735872i, 0.0 + 0.0i, 0.0 + 0.0i, 0.008176926301271696 + 0.00999275966858502i }, { 0.013368082486604503 + -0.016280466204215534i, 0.0 + 0.0i, 0.0 + 0.0i, 7.788890551262479e-05 + 0.0002395915005073588i, 0.16109920392598268 + -2.1291318877365084e-20i, 0.0 + 0.0i, 0.0 + 0.0i, -0.0009524649304738474 + 0.0020567694706787845i }, { 0.0 + 0.0i, 0.01248229724950502 + -0.015132514452759876i, -6.48531568039357e-05 + -0.0003025822526735505i, 0.0 + 0.0i, 0.0 + 0.0i, 0.1510600568950331 + -1.566349207930414e-20i, 0.0016756012327186244 + -0.001502722313863813i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.00026954285311115556 + 2.0849963348719118e-05i, 0.008734699971320193 + -0.010748698961216923i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0016756012327186244 + 0.0015027223138638131i, 0.10590628451402263 + 4.9293864154122724e-20i, 0.0 + 0.0i }, { -0.0003013616489604098 + -2.026936048146703e-05i, 0.0 + 0.0i, 0.0 + 0.0i, 0.008176926301271696 + -0.00999275966858502i, -0.000952464930473847 + -0.0020567694706787845i, 0.0 + 0.0i, 0.0 + 0.0i, 0.09930069031454514 + 8.400184556598507e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, true, false, false, false, false, false, true}), ElementsAreArray({ DoubleNear(0.150207391168592, 1.0e-7), DoubleNear(0.1410794040213112, 1.0e-7), DoubleNear(0.09867892129472977, 1.0e-7), DoubleNear(0.09266804786578356, 1.0e-7), DoubleNear(0.16109920392598268, 1.0e-7), DoubleNear(0.1510600568950331, 1.0e-7), DoubleNear(0.10590628451402263, 1.0e-7), DoubleNear(0.09930069031454514, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, true, true, false, false, false, false}), Matrix({ { 0.15420211024555375 + -1.434930908707024e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.006926032932624913 + 0.015440820068509494i, -0.02753719858536808 + 0.0005975421335171081i, 0.0 + 0.0i, 0.0 + 0.0i, -0.000299716184595855 + -0.00413922013619019i }, { 0.0 + 0.0i, 0.09740164252741217 + 2.9434394917086937e-20i, 0.00452440861959492 + -0.0101711199590563i, 0.0 + 0.0i, 0.0 + 0.0i, -0.017913807550549762 + -0.00045130179416144167i, -0.000525605770643426 + 0.0010667477518570543i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.004524408619594919 + 0.0101711199590563i, 0.1016695597589515 + 2.7647891795085266e-20i, 0.0 + 0.0i, 0.0 + 0.0i, -0.0002256781373242055 + -0.0025436852785236607i, -0.01910654261973371 + 0.00016991070935618006i, 0.0 + 0.0i }, { 0.006926032932624914 + -0.015440820068509494i, 0.0 + 0.0i, 0.0 + 0.0i, 0.14778153597353788 + -1.5028217368863407e-20i, -0.0008755959727262878 + 0.0010850043411573431i, 0.0 + 0.0i, 0.0 + 0.0i, -0.0258562572467477 + -0.0007064386782379571i }, { -0.02753719858536808 + -0.0005975421335171083i, 0.0 + 0.0i, 0.0 + 0.0i, -0.000875595972726288 + -0.0010850043411573431i, 0.1571044848490209 + -1.6778066410400844e-20i, 0.0 + 0.0i, 0.0 + 0.0i, -0.00048206958173980705 + 0.014044333887511067i }, { 0.0 + 0.0i, -0.017913807550549762 + 0.00045130179416144156i, -0.00022567813732420538 + 0.0025436852785236603i, 0.0 + 0.0i, 0.0 + 0.0i, 0.09456709565291652 + 1.0897608262018608e-19i, -0.00031404742385796416 + -0.009200520740231696i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.000525605770643426 + -0.0010667477518570543i, -0.01910654261973371 + -0.00016991070935618016i, 0.0 + 0.0i, 0.0 + 0.0i, -0.0003140474238579644 + 0.009200520740231694i, 0.10291564604980089 + 5.3504885607755264e-20i, 0.0 + 0.0i }, { -0.000299716184595855 + 0.00413922013619019i, 0.0 + 0.0i, 0.0 + 0.0i, -0.0258562572467477 + 0.0007064386782379569i, -0.00048206958173980705 + -0.014044333887511067i, 0.0 + 0.0i, 0.0 + 0.0i, 0.14435792494280644 + -5.442186686108881e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, true, true, false, false, false, false}), ElementsAreArray({ DoubleNear(0.15420211024555375, 1.0e-7), DoubleNear(0.09740164252741217, 1.0e-7), DoubleNear(0.1016695597589515, 1.0e-7), DoubleNear(0.14778153597353788, 1.0e-7), DoubleNear(0.1571044848490209, 1.0e-7), DoubleNear(0.09456709565291652, 1.0e-7), DoubleNear(0.10291564604980089, 1.0e-7), DoubleNear(0.14435792494280644, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, true, false, true, false, false, false}), Matrix({ { 0.15608679665598138 + -1.43698444632997e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0006028654950555584 + 0.014242509017552526i, -0.012454839426543131 + 0.0016924983370083051i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0013592489029513452 + -0.002665091371810137i }, { 0.0 + 0.0i, 0.09484470629231476 + 6.385369950756031e-20i, 0.00037916067810011417 + -0.00935783250406216i, 0.0 + 0.0i, 0.0 + 0.0i, -0.006971629353003744 + -0.00023109615502365542i, 0.00044413877593706195 + -0.0006398810205683599i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.00037916067810011417 + 0.00935783250406216i, 0.10259225377631784 + 4.2353335660710795e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.000888469493398785 + -0.0017324532674406696i, -0.008179533012292768 + 0.0011211132917652912i, 0.0 + 0.0i }, { 0.0006028654950555581 + -0.014242509017552526i, 0.0 + 0.0i, 0.0 + 0.0i, 0.14433765278036642 + -2.941059525565168e-20i, 0.000687313019990162 + -0.001003078594350294i, 0.0 + 0.0i, 0.0 + 0.0i, -0.010588471626668549 + -0.00035516881164120373i }, { -0.012454839426543131 + -0.0016924983370083051i, 0.0 + 0.0i, 0.0 + 0.0i, 0.000687313019990162 + 0.001003078594350294i, 0.15521979843859326 + -1.6757531034171383e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0058410978558295495 + 0.015242644938468034i }, { 0.0 + 0.0i, -0.006971629353003744 + 0.00023109615502365542i, 0.0008884694933987848 + 0.0017324532674406696i, 0.0 + 0.0i, 0.0 + 0.0i, 0.09712403188801394 + 7.455677802971271e-20i, 0.003831200517636842 + -0.010013808195225838i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.000444138775937062 + 0.0006398810205683598i, -0.008179533012292768 + -0.0011211132917652912i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0038312005176368417 + 0.010013808195225838i, 0.10199295203243455 + 3.879944174212974e-20i, 0.0 + 0.0i }, { 0.0013592489029513452 + 0.002665091371810137i, 0.0 + 0.0i, 0.0 + 0.0i, -0.010588471626668549 + 0.00035516881164120373i, 0.0058410978558295495 + -0.015242644938468034i, 0.0 + 0.0i, 0.0 + 0.0i, 0.1478018081359779 + -4.003948897430053e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, true, false, true, false, false, false}), ElementsAreArray({ DoubleNear(0.15608679665598138, 1.0e-7), DoubleNear(0.09484470629231476, 1.0e-7), DoubleNear(0.10259225377631784, 1.0e-7), DoubleNear(0.14433765278036642, 1.0e-7), DoubleNear(0.15521979843859326, 1.0e-7), DoubleNear(0.09712403188801394, 1.0e-7), DoubleNear(0.10199295203243455, 1.0e-7), DoubleNear(0.1478018081359779, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, true, false, false, true, false, false}), Matrix({ { 0.1304088273140946 + 8.894931260294602e-21i, 0.0 + 0.0i, 0.0 + 0.0i, 0.01783168919491385 + 0.0014263734643316347i, 0.019840416329542657 + -0.030330266572238557i, 0.0 + 0.0i, 0.0 + 0.0i, -0.0019035792663406057 + 0.006032423970263114i }, { 0.0 + 0.0i, 0.07645248658389481 + 4.206047978709635e-20i, 0.011706952308864557 + -0.0009293833558189539i, 0.0 + 0.0i, 0.0 + 0.0i, 0.004021809272829023 + 0.010385252153955499i, -0.0023936775378923577 + -0.004614693521809458i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.011706952308864557 + 0.0009293833558189536i, 0.0856894771446139 + 3.8112915770481406e-20i, 0.0 + 0.0i, 0.0 + 0.0i, -0.0012689251786919624 + 0.003960743994862229i, 0.013038067451253741 + -0.01993126529828705i, 0.0 + 0.0i }, { 0.01783168919491385 + -0.0014263734643316349i, 0.0 + 0.0i, 0.0 + 0.0i, 0.11635608111158043 + -5.467994721220534e-20i, -0.003662652839281364 + -0.007025703026642768i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0061199700121473705 + 0.015782445221016652i }, { 0.019840416329542657 + 0.030330266572238557i, 0.0 + 0.0i, 0.0 + 0.0i, -0.003662652839281364 + 0.007025703026642768i, 0.1808977677804801 + -4.0022306757765685e-20i, 0.0 + 0.0i, 0.0 + 0.0i, -0.011387725844028742 + 0.028058780491688924i }, { 0.0 + 0.0i, 0.004021809272829023 + -0.010385252153955497i, -0.001268925178691962 + -0.003960743994862228i, 0.0 + 0.0i, 0.0 + 0.0i, 0.11551625159643389 + 9.634999775017666e-20i, -0.0074965911131276 + -0.018442257343469045i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.0023936775378923577 + 0.004614693521809458i, 0.013038067451253741 + 0.01993126529828705i, 0.0 + 0.0i, 0.0 + 0.0i, -0.0074965911131276005 + 0.01844225734346904i, 0.1188957286641385 + 4.3039861632359124e-20i, 0.0 + 0.0i }, { -0.0019035792663406057 + -0.006032423970263113i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0061199700121473705 + -0.015782445221016652i, -0.011387725844028742 + -0.028058780491688924i, 0.0 + 0.0i, 0.0 + 0.0i, 0.17578337980476388 + -1.477013701774687e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, true, false, false, true, false, false}), ElementsAreArray({ DoubleNear(0.1304088273140946, 1.0e-7), DoubleNear(0.07645248658389481, 1.0e-7), DoubleNear(0.0856894771446139, 1.0e-7), DoubleNear(0.11635608111158043, 1.0e-7), DoubleNear(0.1808977677804801, 1.0e-7), DoubleNear(0.11551625159643389, 1.0e-7), DoubleNear(0.1188957286641385, 1.0e-7), DoubleNear(0.17578337980476388, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, true, false, false, false, true, false}), Matrix({ { 0.1660222166859359 + 3.4838468947532846e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.003175610120492882 + 0.01566624769175158i, 0.007609172219502324 + -0.013535038220738335i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0017759001861870412 + 0.0003381062967250854i }, { 0.0 + 0.0i, 0.1023411377336546 + 1.1061720895549128e-19i, 0.0020651104159414343 + -0.010301558831516327i, 0.0 + 0.0i, 0.0 + 0.0i, 0.004743789010588675 + -0.008365547321944462i, -0.0005545740666337871 + -0.0008110319899139233i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0020651104159414334 + 0.010301558831516327i, 0.10922749636447178 + 8.318025151196273e-21i, 0.0 + 0.0i, 0.0 + 0.0i, 0.00116810840656133 + 0.00020447424405315264i, 0.00487445327781884 + -0.008808318287597415i, 0.0 + 0.0i }, { 0.003175610120492882 + -0.015666247691751584i, 0.0 + 0.0i, 0.0 + 0.0i, 0.15558539419231127 + -4.176269476657727e-20i, -0.0008637704700411945 + -0.001236921360440625i, 0.0 + 0.0i, 0.0 + 0.0i, 0.007386427157985194 + -0.012840989651962141i }, { 0.007609172219502323 + 0.013535038220738335i, 0.0 + 0.0i, 0.0 + 0.0i, -0.0008637704700411944 + 0.001236921360440625i, 0.14528437840863878 + -6.596584444500393e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.003268353230392226 + 0.013818906264268977i }, { 0.0 + 0.0i, 0.004743789010588675 + 0.008365547321944462i, 0.00116810840656133 + -0.00020447424405315264i, 0.0 + 0.0i, 0.0 + 0.0i, 0.08962760044667412 + 2.779326858178173e-20i, 0.002145250779795522 + -0.00907008186777167i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.0005545740666337872 + 0.0008110319899139233i, 0.00487445327781884 + 0.008808318287597415i, 0.0 + 0.0i, 0.0 + 0.0i, 0.002145250779795522 + 0.009070081867771668i, 0.09535770944428063 + 7.283475225164426e-20i, 0.0 + 0.0i }, { 0.0017759001861870412 + -0.0003381062967250854i, 0.0 + 0.0i, 0.0 + 0.0i, 0.007386427157985194 + 0.012840989651962141i, 0.0032683532303922256 + -0.013818906264268977i, 0.0 + 0.0i, 0.0 + 0.0i, 0.13655406672403306 + -2.768738946337494e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, true, false, false, false, true, false}), ElementsAreArray({ DoubleNear(0.1660222166859359, 1.0e-7), DoubleNear(0.1023411377336546, 1.0e-7), DoubleNear(0.10922749636447178, 1.0e-7), DoubleNear(0.15558539419231127, 1.0e-7), DoubleNear(0.14528437840863878, 1.0e-7), DoubleNear(0.08962760044667412, 1.0e-7), DoubleNear(0.09535770944428063, 1.0e-7), DoubleNear(0.13655406672403306, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, true, false, false, false, false, true}), Matrix({ { 0.150207391168592 + -9.836056620105997e-21i, 0.0 + 0.0i, 0.0 + 0.0i, 0.003255372747849229 + 0.014259474027323416i, 0.013368082486604503 + 0.016280466204215534i, 0.0 + 0.0i, 0.0 + 0.0i, -0.0013018865470562095 + 0.0014092553806797966i }, { 0.0 + 0.0i, 0.09266804786578356 + 5.440863197128795e-20i, 0.002121331330841497 + -0.009363908717644483i, 0.0 + 0.0i, 0.0 + 0.0i, 0.008176926301271696 + 0.00999275966858502i, 0.0011489925974877053 + -0.0007137440521143325i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.002121331330841497 + 0.009363908717644483i, 0.09867892129472977 + 3.1858913248717806e-20i, 0.0 + 0.0i, 0.0 + 0.0i, -0.0008359235528822775 + 0.0009299922076216986i, 0.008734699971320193 + 0.010748698961216923i, 0.0 + 0.0i }, { 0.0032553727478492286 + -0.014259474027323416i, 0.0 + 0.0i, 0.0 + 0.0i, 0.1410794040213112 + -5.378659215064807e-20i, 0.0017029413038339195 + -0.001088937019019882i, 0.0 + 0.0i, 0.0 + 0.0i, 0.01248229724950502 + 0.015132514452759876i }, { 0.013368082486604503 + -0.016280466204215534i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0017029413038339195 + 0.001088937019019882i, 0.16109920392598268 + -2.1291318877365084e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.003188590603035879 + 0.015225679928697146i }, { 0.0 + 0.0i, 0.008176926301271696 + -0.00999275966858502i, -0.0008359235528822776 + -0.0009299922076216987i, 0.0 + 0.0i, 0.0 + 0.0i, 0.09930069031454514 + 8.400184556598507e-20i, 0.0020890298648954587 + -0.010007731981643514i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.001148992597487705 + 0.0007137440521143325i, 0.008734699971320193 + -0.010748698961216923i, 0.0 + 0.0i, 0.0 + 0.0i, 0.002089029864895458 + 0.010007731981643512i, 0.10590628451402263 + 4.9293864154122724e-20i, 0.0 + 0.0i }, { -0.0013018865470562095 + -0.0014092553806797966i, 0.0 + 0.0i, 0.0 + 0.0i, 0.01248229724950502 + -0.015132514452759876i, 0.003188590603035879 + -0.015225679928697146i, 0.0 + 0.0i, 0.0 + 0.0i, 0.1510600568950331 + -1.566349207930414e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, true, false, false, false, false, true}), ElementsAreArray({ DoubleNear(0.150207391168592, 1.0e-7), DoubleNear(0.09266804786578356, 1.0e-7), DoubleNear(0.09867892129472977, 1.0e-7), DoubleNear(0.1410794040213112, 1.0e-7), DoubleNear(0.16109920392598268, 1.0e-7), DoubleNear(0.09930069031454514, 1.0e-7), DoubleNear(0.10590628451402263, 1.0e-7), DoubleNear(0.1510600568950331, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, false, true, true, false, false, false}), Matrix({ { 0.12659827157273165 + 6.887425082258397e-21i, 0.0 + 0.0i, -0.023696035952294053 + 0.0010955602325351936i, 0.0 + 0.0i, -0.009128141279647598 + -7.889075058706976e-05i, 0.0 + 0.0i, 0.0010301179591252854 + -0.001180708305349595i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.11949794115444562 + 8.114961111287087e-21i, 0.0 + 0.0i, -0.02131750894277029 + -4.681515895461652e-05i, 0.0 + 0.0i, -0.007926620808392723 + -0.0016222770776292217i, 0.0 + 0.0i, 0.001381715380065447 + 0.00022362203888199634i }, { -0.023696035952294053 + -0.0010955602325351938i, 0.0 + 0.0i, 0.13208077885956757 + 2.1096066115152694e-20i, 0.0 + 0.0i, 0.0019685752455838963 + -0.000511092584158273i, 0.0 + 0.0i, -0.0115062311591883 + 0.002892502379360666i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.02131750894277029 + 4.6815158954616334e-05i, 0.0 + 0.0i, 0.11968441791823556 + 2.6328143140621535e-20i, 0.0 + 0.0i, 0.0025262068352749608 + 0.0010654130726098895i, 0.0 + 0.0i, -0.00963348017127957 + 0.0010360121109643625i }, { -0.009128141279647598 + 7.889075058706976e-05i, 0.0 + 0.0i, 0.001968575245583896 + 0.000511092584158273i, 0.0 + 0.0i, 0.1292733984317736 + 6.411157625756629e-21i, 0.0 + 0.0i, -0.022947705252807735 + -0.0003281073896619053i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.007926620808392723 + 0.0016222770776292217i, 0.0 + 0.0i, 0.0025262068352749603 + -0.0010654130726098895i, 0.0 + 0.0i, 0.1256852373465044 + 6.29121643693644e-21i, 0.0 + 0.0i, -0.02245255585452717 + -0.0011109253134447823i }, { 0.0010301179591252854 + 0.001180708305349595i, 0.0 + 0.0i, -0.0115062311591883 + -0.002892502379360666i, 0.0 + 0.0i, -0.022947705252807735 + 0.0003281073896619052i, 0.0 + 0.0i, 0.12793935203925422 + 1.563075308220173e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0013817153800654472 + -0.00022362203888199634i, 0.0 + 0.0i, -0.00963348017127957 + -0.0010360121109643625i, 0.0 + 0.0i, -0.02245255585452717 + 0.001110925313444782i, 0.0 + 0.0i, 0.11924060267748741 + 2.822607261847574e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, false, true, true, false, false, false}), ElementsAreArray({ DoubleNear(0.12659827157273165, 1.0e-7), DoubleNear(0.11949794115444562, 1.0e-7), DoubleNear(0.13208077885956757, 1.0e-7), DoubleNear(0.11968441791823556, 1.0e-7), DoubleNear(0.1292733984317736, 1.0e-7), DoubleNear(0.1256852373465044, 1.0e-7), DoubleNear(0.12793935203925422, 1.0e-7), DoubleNear(0.11924060267748741, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, false, true, false, true, false, false}), Matrix({ { 0.11042847603170469 + 4.0721274375373e-20i, 0.0 + 0.0i, -0.019538270176777076 + -0.0008803355570889566i, 0.0 + 0.0i, 0.01648433667027082 + -0.025243596438834996i, 0.0 + 0.0i, -0.003014415464789284 + 0.004527651593445075i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.09932364077446496 + -1.3334151474354809e-20i, 0.0 + 0.0i, -0.01743255643521916 + -0.0010801445788476412i, 0.0 + 0.0i, 0.005062109243585421 + 0.00962916634429055i, 0.0 + 0.0i, -0.0021951686416656043 + -0.002362672418982045i }, { -0.019538270176777076 + 0.0008803355570889563i, 0.0 + 0.0i, 0.10566982842700376 + 6.286572655403006e-21i, 0.0 + 0.0i, -0.0029309222436306277 + 0.004561021190405143i, 0.0 + 0.0i, 0.01639414711052558 + -0.025017935431690612i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.01743255643521916 + 0.001080144578847641i, 0.0 + 0.0i, 0.09348492692101029 + 7.146840492458159e-22i, 0.0 + 0.0i, 0.00036125491208359006 + -0.0023691698089984025i, 0.0 + 0.0i, 0.005079670041390971 + 0.0165385310306816i }, { 0.01648433667027082 + 0.025243596438834996i, 0.0 + 0.0i, -0.0029309222436306277 + -0.004561021190405143i, 0.0 + 0.0i, 0.14544319397280056 + -2.7422691667357973e-20i, 0.0 + 0.0i, -0.02710547102832471 + 0.0016477883999622448i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.005062109243585422 + -0.009629166344290549i, 0.0 + 0.0i, 0.00036125491208359 + 0.0023691698089984025i, 0.0 + 0.0i, 0.14585953772648508 + 2.7740329022578336e-20i, 0.0 + 0.0i, -0.0263375083620783 + -7.759589355175751e-05i }, { -0.0030144154647892838 + -0.004527651593445075i, 0.0 + 0.0i, 0.01639414711052558 + 0.025017935431690612i, 0.0 + 0.0i, -0.02710547102832471 + -0.001647788399962245i, 0.0 + 0.0i, 0.15435030247181802 + 3.044024654195142e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.0021951686416656043 + 0.002362672418982045i, 0.0 + 0.0i, 0.005079670041390971 + -0.0165385310306816i, 0.0 + 0.0i, -0.0263375083620783 + 7.759589355175745e-05i, 0.0 + 0.0i, 0.14544009367471267 + 5.3839531709851465e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, false, true, false, true, false, false}), ElementsAreArray({ DoubleNear(0.11042847603170469, 1.0e-7), DoubleNear(0.09932364077446496, 1.0e-7), DoubleNear(0.10566982842700376, 1.0e-7), DoubleNear(0.09348492692101029, 1.0e-7), DoubleNear(0.14544319397280056, 1.0e-7), DoubleNear(0.14585953772648508, 1.0e-7), DoubleNear(0.15435030247181802, 1.0e-7), DoubleNear(0.14544009367471267, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, false, true, false, false, true, false}), Matrix({ { 0.13606934078536484 + 4.106538151019506e-20i, 0.0 + 0.0i, -0.025014675916608553 + -0.00018842935946578818i, 0.0 + 0.0i, 0.006688211040009548 + -0.0114709863276561i, 0.0 + 0.0i, -0.00034528473475709974 + 0.0025631550907183834i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.13022219697083556 + 1.3850312176587892e-20i, 0.0 + 0.0i, -0.02339648625670472 + -0.0011471390549111105i, 0.0 + 0.0i, 0.006598103976784986 + -0.011093843670745087i, 0.0 + 0.0i, -0.0005196810830539706 + 0.0023991550710034896i }, { -0.025014675916608553 + 0.00018842935946578802i, 0.0 + 0.0i, 0.13918037226504282 + 2.0911125885340513e-21i, 0.0 + 0.0i, -0.0016832358344898751 + 0.0012380504572482316i, 0.0 + 0.0i, 0.005795414457311614 + -0.010872370180679648i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.02339648625670472 + 0.0011471390549111105i, 0.0 + 0.0i, 0.12770433495513028 + 5.500420201232613e-20i, 0.0 + 0.0i, -0.0015548248097099074 + 0.0013012662996120755i, 0.0 + 0.0i, 0.00553211219178888 + -0.010112693303161512i }, { 0.006688211040009548 + 0.011470986327656101i, 0.0 + 0.0i, -0.0016832358344898751 + -0.0012380504572482318i, 0.0 + 0.0i, 0.11980232921914043 + -2.776679880218003e-20i, 0.0 + 0.0i, -0.021629065288493232 + 0.0009558822023390765i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.006598103976784986 + 0.011093843670745087i, 0.0 + 0.0i, -0.0015548248097099074 + -0.0013012662996120755i, 0.0 + 0.0i, 0.11496098153011446 + 5.558653716356346e-22i, 0.0 + 0.0i, -0.020373578540592734 + -1.0601417488288192e-05i }, { -0.00034528473475709974 + -0.002563155090718384i, 0.0 + 0.0i, 0.0057954144573116135 + 0.01087237018067965i, 0.0 + 0.0i, -0.021629065288493232 + -0.0009558822023390767i, 0.0 + 0.0i, 0.12083975863377898 + 3.4635706608820375e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.0005196810830539703 + -0.0023991550710034896i, 0.0 + 0.0i, 0.005532112191788882 + 0.010112693303161512i, 0.0 + 0.0i, -0.020373578540592737 + 1.060141748828792e-05i, 0.0 + 0.0i, 0.1112206856405927 + -4.499862532288471e-22i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, false, true, false, false, true, false}), ElementsAreArray({ DoubleNear(0.13606934078536484, 1.0e-7), DoubleNear(0.13022219697083556, 1.0e-7), DoubleNear(0.13918037226504282, 1.0e-7), DoubleNear(0.12770433495513028, 1.0e-7), DoubleNear(0.11980232921914043, 1.0e-7), DoubleNear(0.11496098153011446, 1.0e-7), DoubleNear(0.12083975863377898, 1.0e-7), DoubleNear(0.1112206856405927, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, false, true, false, false, false, true}), Matrix({ { 0.12340464570118939 + -1.4346620544119712e-20i, 0.0 + 0.0i, -0.022557877255623554 + -2.391206159349361e-05i, 0.0 + 0.0i, 0.011546565729108445 + 0.013340024694673663i, 0.0 + 0.0i, -0.0019445855194651393 + -0.0007528724162711432i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.11835358741657609 + 4.1028158382630173e-22i, 0.0 + 0.0i, -0.021162091487136114 + -0.0009158962141830346i, 0.0 + 0.0i, 0.010984596271331134 + 0.012660853814792317i, 0.0 + 0.0i, -0.001818181936382177 + -0.0008439842360219224i }, { -0.022557877255623554 + 2.3912061593493283e-05i, 0.0 + 0.0i, 0.12548166676213238 + 3.636947717273152e-20i, 0.0 + 0.0i, -0.001475718865088569 + -0.004073035462614579i, 0.0 + 0.0i, 0.010556216728816249 + 0.013689140470758795i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.021162091487136117 + 0.0009158962141830342i, 0.0 + 0.0i, 0.11539386447051868 + 2.117582368135751e-22i, 0.0 + 0.0i, -0.001589409072629396 + -0.003660991514459716i, 0.0 + 0.0i, 0.009674627279445585 + 0.01246442030655258i }, { 0.011546565729108445 + -0.013340024694673665i, 0.0 + 0.0i, -0.001475718865088569 + 0.004073035462614579i, 0.0 + 0.0i, 0.13246702430331586 + 2.764520325213474e-20i, 0.0 + 0.0i, -0.024085863949478238 + 0.000791364904466782i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.010984596271331134 + -0.012660853814792317i, 0.0 + 0.0i, -0.001589409072629396 + 0.0036609915144597163i, 0.0 + 0.0i, 0.12682959108437394 + 1.3995895964397225e-20i, 0.0 + 0.0i, -0.022607973310161344 + -0.00024184425821636418i }, { -0.0019445855194651393 + 0.0007528724162711433i, 0.0 + 0.0i, 0.010556216728816249 + -0.013689140470758795i, 0.0 + 0.0i, -0.024085863949478238 + -0.000791364904466782i, 0.0 + 0.0i, 0.13453846413668943 + 3.573420246229023e-22i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.001818181936382177 + 0.0008439842360219223i, 0.0 + 0.0i, 0.009674627279445583 + -0.012464420306552579i, 0.0 + 0.0i, -0.022607973310161344 + 0.00024184425821636415i, 0.0 + 0.0i, 0.1235311561252043 + 5.434245752228371e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, false, true, false, false, false, true}), ElementsAreArray({ DoubleNear(0.12340464570118939, 1.0e-7), DoubleNear(0.11835358741657609, 1.0e-7), DoubleNear(0.12548166676213238, 1.0e-7), DoubleNear(0.11539386447051868, 1.0e-7), DoubleNear(0.13246702430331586, 1.0e-7), DoubleNear(0.12682959108437394, 1.0e-7), DoubleNear(0.13453846413668943, 1.0e-7), DoubleNear(0.1235311561252043, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, false, false, true, true, false, false}), Matrix({ { 0.10620361414267068 + 2.4436540730783708e-20i, 0.0 + 0.0i, -0.007339676260623186 + -0.000661016773684188i, 0.0 + 0.0i, 0.016442376121248985 + -0.02501996855568906i, 0.0 + 0.0i, -0.0009599913474910145 + 0.0021206182660750777i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.09413419034267871 + -3.2141045582391803e-21i, 0.0 + 0.0i, -0.006345428702011673 + -0.0011488085551183518i, 0.0 + 0.0i, 0.005137537024160161 + 0.0154060005243264i, 0.0 + 0.0i, -0.002447902725219858 + -0.0022599486892105384i }, { -0.007339676260623186 + 0.000661016773684188i, 0.0 + 0.0i, 0.1098946903160378 + 2.2571306299992298e-20i, 0.0 + 0.0i, -0.0013551872649564198 + 0.0015878754452943703i, 0.0 + 0.0i, 0.016436107659547415 + -0.025241563314836544i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.006345428702011673 + 0.0011488085551183518i, 0.0 + 0.0i, 0.09867437735279652 + -9.405362866869813e-21i, 0.0 + 0.0i, 0.0018459342326994888 + -0.0023656569700475708i, 0.0 + 0.0i, 0.005004242260816233 + 0.01076169685064575i }, { 0.016442376121248985 + 0.02501996855568906i, 0.0 + 0.0i, -0.0013551872649564198 + -0.0015878754452943703i, 0.0 + 0.0i, 0.15247543628962856 + 3.546950466627383e-21i, 0.0 + 0.0i, -0.013294696178212712 + 0.003474628402457784i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.005137537024160161 + -0.0154060005243264i, 0.0 + 0.0i, 0.0018459342326994888 + 0.0023656569700475703i, 0.0 + 0.0i, 0.14504816873000242 + 3.76572088101478e-20i, 0.0 + 0.0i, -0.011214672277660619 + 0.0005625435884534927i }, { -0.0009599913474910145 + -0.0021206182660750777i, 0.0 + 0.0i, 0.016436107659547415 + 0.025241563314836544i, 0.0 + 0.0i, -0.013294696178212712 + -0.0034746284024577837i, 0.0 + 0.0i, 0.14731806015499002 + -5.293955920339407e-22i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.002447902725219858 + 0.0022599486892105384i, 0.0 + 0.0i, 0.005004242260816233 + -0.01076169685064575i, 0.0 + 0.0i, -0.011214672277660619 + -0.0005625435884534927i, 0.0 + 0.0i, 0.14625146267119532 + 4.392265192228199e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, false, false, true, true, false, false}), ElementsAreArray({ DoubleNear(0.10620361414267068, 1.0e-7), DoubleNear(0.09413419034267871, 1.0e-7), DoubleNear(0.1098946903160378, 1.0e-7), DoubleNear(0.09867437735279652, 1.0e-7), DoubleNear(0.15247543628962856, 1.0e-7), DoubleNear(0.14504816873000242, 1.0e-7), DoubleNear(0.14731806015499002, 1.0e-7), DoubleNear(0.14625146267119532, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, false, false, true, false, true, false}), Matrix({ { 0.13814392352135318 + 2.242054192692104e-20i, 0.0 + 0.0i, -0.011082201742476972 + 0.0016118791974694892i, 0.0 + 0.0i, 0.006104383671994109 + -0.01111634876719946i, 0.0 + 0.0i, -0.00037979548979739984 + 0.000798434363662856i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.12754576382778784 + 3.5660714113586676e-20i, 0.0 + 0.0i, -0.009432090464501063 + -0.0002215444462464549i, 0.0 + 0.0i, 0.005874735425252806 + -0.010406774815945609i, 0.0 + 0.0i, -0.00042579919173870915 + 0.0005906452054328648i }, { -0.011082201742476972 + -0.0016118791974694892i, 0.0 + 0.0i, 0.1371057895290545 + 2.0735952171808074e-20i, 0.0 + 0.0i, -0.0004775910640513276 + 0.0009011277251146804i, 0.0 + 0.0i, 0.006379241825327055 + -0.011227007741136288i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.009432090464501063 + 0.0002215444462464549i, 0.0 + 0.0i, 0.130380768098178 + 3.3193800075327336e-20i, 0.0 + 0.0i, -0.00025587474256307235 + 0.0008397716655520099i, 0.0 + 0.0i, 0.00625548074332106 + -0.01079976215796099i }, { 0.006104383671994109 + 0.011116348767199462i, 0.0 + 0.0i, -0.0004775910640513276 + -0.0009011277251146806i, 0.0 + 0.0i, 0.12053512691094606 + 5.562949270490054e-21i, 0.0 + 0.0i, -0.009552170696358928 + 0.0012017324313041069i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.005874735425252806 + 0.010406774815945609i, 0.0 + 0.0i, -0.00025587474256307235 + -0.00083977166555201i, 0.0 + 0.0i, 0.11163659524489332 + -1.2176098616780567e-21i, 0.0 + 0.0i, -0.00812801051517123 + -0.00036472052041840424i }, { -0.00037979548979739984 + -0.000798434363662856i, 0.0 + 0.0i, 0.006379241825327054 + 0.011227007741136288i, 0.0 + 0.0i, -0.009552170696358928 + -0.0012017324313041066i, 0.0 + 0.0i, 0.12010696094197332 + 1.3059585361502835e-21i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.0004257991917387093 + -0.0005906452054328648i, 0.0 + 0.0i, 0.006255480743321062 + 0.01079976215796099i, 0.0 + 0.0i, -0.00812801051517123 + 0.00036472052041840424i, 0.0 + 0.0i, 0.11454507192581384 + 1.3234889800848443e-21i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, false, false, true, false, true, false}), ElementsAreArray({ DoubleNear(0.13814392352135318, 1.0e-7), DoubleNear(0.12754576382778784, 1.0e-7), DoubleNear(0.1371057895290545, 1.0e-7), DoubleNear(0.130380768098178, 1.0e-7), DoubleNear(0.12053512691094606, 1.0e-7), DoubleNear(0.11163659524489332, 1.0e-7), DoubleNear(0.12010696094197332, 1.0e-7), DoubleNear(0.11454507192581384, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, false, false, true, false, false, true}), Matrix({ { 0.12473020255630711 + 1.2652206422211389e-20i, 0.0 + 0.0i, -0.009914215102136227 + 0.0013042206262232985i, 0.0 + 0.0i, 0.011112187209930555 + 0.013640410788134973i, 0.0 + 0.0i, -0.001110480903286689 + -0.0009956220756965055i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.11542558690878141 + -9.529120656610879e-22i, 0.0 + 0.0i, -0.008439795260967692 + -0.0003373457997356763i, 0.0 + 0.0i, 0.01023152985883364 + 0.012483242502777292i, 0.0 + 0.0i, -0.0008049995661804676 + -0.0009536558711491488i }, { -0.009914215102136227 + -0.0013042206262232985i, 0.0 + 0.0i, 0.12415610990701463 + 9.370650206400418e-21i, 0.0 + 0.0i, -0.0006872082834389185 + -0.0012515458165599197i, 0.0 + 0.0i, 0.010990595247994141 + 0.013388754377297486i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.008439795260967692 + 0.0003373457997356763i, 0.0 + 0.0i, 0.11832186497831333 + 1.5749518863009647e-21i, 0.0 + 0.0i, -0.0007310125419219173 + -0.0009790613148026915i, 0.0 + 0.0i, 0.010427693691943078 + 0.012642031618567603i }, { 0.011112187209930556 + -0.013640410788134973i, 0.0 + 0.0i, -0.0006872082834389185 + 0.0012515458165599197i, 0.0 + 0.0i, 0.13394884787599212 + 1.5331284775199703e-20i, 0.0 + 0.0i, -0.010720157336699673 + 0.0015093910025502978i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.01023152985883364 + -0.012483242502777292i, 0.0 + 0.0i, -0.0007310125419219173 + 0.0009790613148026915i, 0.0 + 0.0i, 0.12375677216389974 + 3.539601631756971e-20i, 0.0 + 0.0i, -0.0091203057187046 + -0.00024891916692918283i }, { -0.001110480903286689 + 0.0009956220756965055i, 0.0 + 0.0i, 0.01099059524799414 + -0.013388754377297488i, 0.0 + 0.0i, -0.010720157336699673 + -0.0015093910025502978i, 0.0 + 0.0i, 0.13305664056401317 + 1.267126050155794e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.0008049995661804675 + 0.0009536558711491488i, 0.0 + 0.0i, 0.010427693691943078 + -0.012642031618567603i, 0.0 + 0.0i, -0.0091203057187046 + 0.00024891916692918283i, 0.0 + 0.0i, 0.1266039750456785 + 3.2942337169111215e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, false, false, true, false, false, true}), ElementsAreArray({ DoubleNear(0.12473020255630711, 1.0e-7), DoubleNear(0.11542558690878141, 1.0e-7), DoubleNear(0.12415610990701463, 1.0e-7), DoubleNear(0.11832186497831333, 1.0e-7), DoubleNear(0.13394884787599212, 1.0e-7), DoubleNear(0.12375677216389974, 1.0e-7), DoubleNear(0.13305664056401317, 1.0e-7), DoubleNear(0.1266039750456785, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, false, false, false, true, true, false}), Matrix({ { 0.11506363812742607 + 4.011246944453397e-20i, 0.0 + 0.0i, 0.017529277053178787 + -0.026793949864882545i, 0.0 + 0.0i, 0.005495211125327523 + -0.009512674529583388i, 0.0 + 0.0i, -0.001381590849534129 + -0.002674374429319308i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.10260546680496105 + -1.3095923457939537e-20i, 0.0 + 0.0i, 0.005408757751171145 + 0.014202631026464409i, 0.0 + 0.0i, 0.004968203107024668 + -0.00852507689517532i, 0.0 + 0.0i, 0.0012231535142051939 + -8.187184684338238e-05i }, { 0.017529277053178787 + 0.026793949864882545i, 0.0 + 0.0i, 0.16018607492298162 + 3.044024654195142e-21i, 0.0 + 0.0i, 0.003001828121485836 + -0.00019031818018834913i, 0.0 + 0.0i, 0.006988414371993641 + -0.01283068197875236i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.005408757751171145 + -0.014202631026464409i, 0.0 + 0.0i, 0.1553210651210048 + 8.195043764685356e-20i, 0.0 + 0.0i, -0.0007270878603392398 + -0.0007996349072510588i, 0.0 + 0.0i, 0.007162013061549199 + -0.01268146007873128i }, { 0.0054952111253275225 + 0.009512674529583388i, 0.0 + 0.0i, 0.003001828121485836 + 0.00019031818018834913i, 0.0 + 0.0i, 0.10103466633128241 + 6.895377586242037e-21i, 0.0 + 0.0i, 0.015349206727617611 + -0.023467582005643063i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.004968203107024669 + 0.008525076895175319i, 0.0 + 0.0i, -0.0007270878603392398 + 0.0007996349072510588i, 0.0 + 0.0i, 0.0902031008905142 + 4.764560328305439e-22i, 0.0 + 0.0i, 0.004733021533805249 + 0.011965066348507742i }, { -0.001381590849534129 + 0.002674374429319308i, 0.0 + 0.0i, 0.00698841437199364 + 0.01283068197875236i, 0.0 + 0.0i, 0.015349206727617611 + 0.023467582005643063i, 0.0 + 0.0i, 0.13960742152163697 + -2.6469779601699895e-23i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0012231535142051937 + 8.187184684338238e-05i, 0.0 + 0.0i, 0.007162013061549199 + 0.01268146007873128i, 0.0 + 0.0i, 0.004733021533805249 + -0.01196506634850774i, 0.0 + 0.0i, 0.13597856628019295 + -3.705769144237564e-22i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, false, false, false, true, true, false}), ElementsAreArray({ DoubleNear(0.11506363812742607, 1.0e-7), DoubleNear(0.10260546680496105, 1.0e-7), DoubleNear(0.16018607492298162, 1.0e-7), DoubleNear(0.1553210651210048, 1.0e-7), DoubleNear(0.10103466633128241, 1.0e-7), DoubleNear(0.0902031008905142, 1.0e-7), DoubleNear(0.13960742152163697, 1.0e-7), DoubleNear(0.13597856628019295, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, false, false, false, true, false, true}), Matrix({ { 0.10437890333388616 + 2.0196441836094724e-20i, 0.0 + 0.0i, 0.015868666020870448 + -0.02426020779572173i, 0.0 + 0.0i, 0.009206112535872304 + 0.011169328731001543i, 0.0 + 0.0i, 0.004024331696403371 + -0.00043405036420254264i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.09316015818489279 + 2.514629062161204e-22i, 0.0 + 0.0i, 0.004894017571802996 + 0.01249577147212301i, 0.0 + 0.0i, 0.008201094180343881 + 0.0099281181644908i, 0.0 + 0.0i, -0.0010945011628682867 + 0.0017049793613892455i }, { 0.015868666020870448 + 0.02426020779572173i, 0.0 + 0.0i, 0.14450740912943558 + 1.826414792517085e-21i, 0.0 + 0.0i, -0.0012127676101586398 + 0.0038625889054741836i, 0.0 + 0.0i, 0.012896669922052392 + 0.015859836434430914i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.004894017571802997 + -0.01249577147212301i, 0.0 + 0.0i, 0.14058729370220197 + 3.705769144237564e-22i, 0.0 + 0.0i, 0.0019624948795764646 + -0.000645269991879619i, 0.0 + 0.0i, 0.012458129370432837 + 0.015197155956854095i }, { 0.009206112535872304 + -0.011169328731001543i, 0.0 + 0.0i, -0.0012127676101586398 + -0.0038625889054741836i, 0.0 + 0.0i, 0.1117194011248223 + 2.6811405194681286e-20i, 0.0 + 0.0i, 0.017009817759925952 + -0.026001324074803878i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.008201094180343881 + -0.009928118164490799i, 0.0 + 0.0i, 0.001962494879576464 + 0.0006452699918796191i, 0.0 + 0.0i, 0.09964840951058246 + -1.2870930331325114e-20i, 0.0 + 0.0i, 0.005247761713173397 + 0.01367192590284914i }, { 0.004024331696403371 + 0.00043405036420254264i, 0.0 + 0.0i, 0.012896669922052392 + -0.015859836434430914i, 0.0 + 0.0i, 0.017009817759925952 + 0.026001324074803878i, 0.0 + 0.0i, 0.155286087315183 + 1.1911400820763568e-21i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.001094501162868287 + -0.0017049793613892455i, 0.0 + 0.0i, 0.012458129370432836 + -0.015197155956854095i, 0.0 + 0.0i, 0.005247761713173397 + -0.01367192590284914i, 0.0 + 0.0i, 0.15071233769899578 + 8.120928381800605e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, false, false, false, true, false, true}), ElementsAreArray({ DoubleNear(0.10437890333388616, 1.0e-7), DoubleNear(0.09316015818489279, 1.0e-7), DoubleNear(0.14450740912943558, 1.0e-7), DoubleNear(0.14058729370220197, 1.0e-7), DoubleNear(0.1117194011248223, 1.0e-7), DoubleNear(0.09964840951058246, 1.0e-7), DoubleNear(0.155286087315183, 1.0e-7), DoubleNear(0.15071233769899578, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, false, false, false, false, true, true}), Matrix({ { 0.12293324435852732 + 1.479660679734856e-20i, 0.0 + 0.0i, -0.007040952129841553 + -0.02370694756985096i, 0.0 + 0.0i, 0.012479991522622521 + 0.006866939868773545i, 0.0 + 0.0i, 0.01774053273102344 + 0.009673990934577435i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.11528641844962935 + 4.632211430296955e-22i, 0.0 + 0.0i, -0.0065623745269751685 + -0.02230626957036725i, 0.0 + 0.0i, 0.011594282419949755 + 0.006015957416167249i, 0.0 + 0.0i, 0.016502350952276607 + 0.00888400162233801i }, { -0.007040952129841554 + 0.023706947569850964i, 0.0 + 0.0i, 0.12595306810479445 + 7.226249831263248e-21i, 0.0 + 0.0i, 0.025284488115698625 + 0.009028882063039843i, 0.0 + 0.0i, 0.009622790935302175 + 0.02016222529665891i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.0065623745269751685 + 0.02230626957036725i, 0.0 + 0.0i, 0.11846103343746539 + 1.5881867761018131e-22i, 0.0 + 0.0i, 0.02342834560365291 + 0.008455692861649225i, 0.0 + 0.0i, 0.009064941130826964 + 0.019109316705177647i }, { 0.012479991522622523 + -0.006866939868773545i, 0.0 + 0.0i, 0.025284488115698625 + -0.009028882063039843i, 0.0 + 0.0i, 0.15231646869188037 + 2.8359887301380554e-20i, 0.0 + 0.0i, 0.01952457762716272 + 0.0013635910615152123i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.011594282419949755 + -0.006015957416167249i, 0.0 + 0.0i, 0.02342834560365291 + -0.008455692861649225i, 0.0 + 0.0i, 0.14264011347633648 + 6.839129304588433e-20i, 0.0 + 0.0i, 0.018692590695549037 + 0.0010997325964606506i }, { 0.01774053273102344 + -0.009673990934577435i, 0.0 + 0.0i, 0.009622790935302173 + -0.02016222529665891i, 0.0 + 0.0i, 0.01952457762716272 + -0.0013635910615152123i, 0.0 + 0.0i, 0.11468901974812494 + -3.5734202462291096e-22i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.016502350952276607 + -0.00888400162233801i, 0.0 + 0.0i, 0.009064941130826962 + -0.019109316705177647i, 0.0 + 0.0i, 0.018692590695549037 + -0.0010997325964606506i, 0.0 + 0.0i, 0.10772063373324177 + -5.293955920339377e-23i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, false, false, false, false, true, true}), ElementsAreArray({ DoubleNear(0.12293324435852732, 1.0e-7), DoubleNear(0.11528641844962935, 1.0e-7), DoubleNear(0.12595306810479445, 1.0e-7), DoubleNear(0.11846103343746539, 1.0e-7), DoubleNear(0.15231646869188037, 1.0e-7), DoubleNear(0.14264011347633648, 1.0e-7), DoubleNear(0.11468901974812494, 1.0e-7), DoubleNear(0.10772063373324177, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, true, true, false, false, false, false, false, false}), Matrix({ { 0.35749536362531276 + -5.3274008663858634e-20i, -0.03675141403808395 + -0.028912787697983174i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.03675141403808395 + 0.028912787697983174i, 0.24595069238560616 + -4.730345106356466e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.23494280333622664 + 1.2501676907168918e-19i, -0.024151738183105474 + -0.01900423291892573i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, -0.024151738183105474 + 0.01900423291892573i, 0.16161114065285448 + 9.454648586842435e-20i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, true, true, false, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.35749536362531276, 1.0e-7), DoubleNear(0.24595069238560616, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.23494280333622664, 1.0e-7), DoubleNear(0.16161114065285448, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.0, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, true, false, true, false, false, false, false, false}), Matrix({ { 0.2985597083292407 + 5.662315078385351e-20i, -0.03066449190011322 + -0.024232136998265104i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.03066449190011322 + 0.024232136998265104i, 0.20471562494566262 + 5.065995125594841e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.29387845863229867 + 1.511960962397705e-20i, -0.030238660321076197 + -0.0236848836186438i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, -0.030238660321076197 + 0.0236848836186438i, 0.20284620809279802 + -3.41691645108873e-21i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, true, false, true, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.2985597083292407, 1.0e-7), DoubleNear(0.20471562494566262, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.29387845863229867, 1.0e-7), DoubleNear(0.20284620809279802, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.0, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, true, false, false, true, false, false, false, false}), Matrix({ { 0.2930434309410409 + 1.79473153196665e-20i, -0.030368592220745116 + -0.0229456654951114i, 0.0 + 0.0i, 0.0 + 0.0i, -0.05356458949607763 + 0.0011749724207026167i, 0.005881232304866098 + 0.0043016566640167i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.030368592220745116 + 0.0229456654951114i, 0.20801141756441435 + 9.757444936572052e-21i, 0.0 + 0.0i, 0.0 + 0.0i, 0.005131739274856323 + -0.004363063748523632i, -0.036849216506321614 + -0.0015652600502287276i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.05356458949607763 + -0.001174972420702617i, 0.005131739274856323 + 0.004363063748523632i, 0.0 + 0.0i, 0.0 + 0.0i, 0.2993947360204985 + 5.379544508816407e-20i, -0.030534560000444296 + -0.024971355121797503i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.005881232304866098 + -0.0043016566640167i, -0.036849216506321614 + 0.0015652600502287272i, 0.0 + 0.0i, 0.0 + 0.0i, -0.030534560000444296 + 0.024971355121797503i, 0.1995504154740463 + 3.7485589868287634e-20i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, true, false, false, true, false, false, false, false}), ElementsAreArray({ DoubleNear(0.2930434309410409, 1.0e-7), DoubleNear(0.20801141756441435, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.2993947360204985, 1.0e-7), DoubleNear(0.1995504154740463, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.0, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, true, false, false, false, true, false, false, false}), Matrix({ { 0.27681606093603944 + 3.435704398978591e-20i, -0.011078490647440167 + -0.01954309828867452i, 0.0 + 0.0i, 0.0 + 0.0i, 0.010324034761806024 + 0.023805393412752982i, 0.0015048277369803507 + 0.009345829162995055i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.011078490647440167 + 0.01954309828867452i, 0.22104534856894098 + 2.8069551459533805e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.010475798575051903 + -0.016962872242875227i, -0.04851850818031422 + -0.021578046750644245i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.010324034761806024 + -0.023805393412752982i, 0.010475798575051903 + 0.016962872242875227i, 0.0 + 0.0i, 0.0 + 0.0i, 0.3156221060255 + 3.738571641804466e-20i, -0.04982466157374925 + -0.028373922328234383i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0015048277369803507 + -0.009345829162995055i, -0.04851850818031422 + 0.021578046750644245i, 0.0 + 0.0i, 0.0 + 0.0i, -0.04982466157374925 + 0.02837392232823438i, 0.18651648446951968 + 1.917348334532588e-20i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, true, false, false, false, true, false, false, false}), ElementsAreArray({ DoubleNear(0.27681606093603944, 1.0e-7), DoubleNear(0.22104534856894098, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.3156221060255, 1.0e-7), DoubleNear(0.18651648446951968, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.0, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, true, false, false, false, false, true, false, false}), Matrix({ { 0.23865084707341705 + 2.314674903184929e-20i, -0.024764588824289814 + -0.01859270750761086i, 0.0 + 0.0i, 0.0 + 0.0i, 0.025434652055975414 + -0.011663238355542253i, -0.003043452996561539 + -0.0006732999218719555i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.024764588824289814 + 0.01859270750761086i, 0.17025602508076665 + 1.1241630573817725e-20i, 0.0 + 0.0i, 0.0 + 0.0i, -0.0021795451312289207 + 0.0034070928175912655i, 0.01758561100979738 + -0.012430596140011208i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.025434652055975414 + 0.011663238355542251i, -0.0021795451312289207 + -0.0034070928175912655i, 0.0 + 0.0i, 0.0 + 0.0i, 0.35378731988812234 + 4.859601137598128e-20i, -0.036138563396899595 + -0.029324313109298044i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.0030434529965615393 + 0.0006732999218719557i, 0.01758561100979738 + 0.012430596140011208i, 0.0 + 0.0i, 0.0 + 0.0i, -0.036138563396899595 + 0.02932431310929804i, 0.237305807957694 + 3.600140423104196e-20i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, true, false, false, false, false, true, false, false}), ElementsAreArray({ DoubleNear(0.23865084707341705, 1.0e-7), DoubleNear(0.17025602508076665, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.35378731988812234, 1.0e-7), DoubleNear(0.237305807957694, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.0, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, true, false, false, false, false, false, true, false}), Matrix({ { 0.31614750316742096 + 6.76670403423528e-20i, -0.03248271066120295 + -0.0256247542879793i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0142709038313606 + -0.02562110497941306i, -0.0035235560731196928 + 0.0015530435345076552i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.03248271066120295 + 0.0256247542879793i, 0.21702874180895257 + 4.434396794529033e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0005495514247375404 + 0.0037376999758943737i, 0.010342937834534428 + -0.017928788502829286i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0142709038313606 + 0.025621104979413063i, 0.0005495514247375413 + -0.0037376999758943737i, 0.0 + 0.0i, 0.0 + 0.0i, 0.2762906637941185 + 4.075720065477768e-21i, -0.028420441559986465 + -0.022292266328929604i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.0035235560731196928 + -0.0015530435345076554i, 0.010342937834534428 + 0.017928788502829286i, 0.0 + 0.0i, 0.0 + 0.0i, -0.028420441559986465 + 0.022292266328929604i, 0.19053309122950807 + 2.8990668595693577e-21i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, true, false, false, false, false, false, true, false}), ElementsAreArray({ DoubleNear(0.31614750316742096, 1.0e-7), DoubleNear(0.21702874180895257, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.2762906637941185, 1.0e-7), DoubleNear(0.19053309122950807, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.0, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, true, false, false, false, false, false, false, true}), Matrix({ { 0.2857848041712285 + 1.5125601062819123e-20i, -0.0293882673346533 + -0.023085561355388917i, 0.0 + 0.0i, 0.0 + 0.0i, 0.025395117532012176 + 0.03107698324520216i, -5.762881223813721e-05 + -0.005249464275021896i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.0293882673346533 + 0.023085561355388917i, 0.19684896017918804 + 7.519295386432563e-21i, 0.0 + 0.0i, 0.0 + 0.0i, -0.0051558003168155585 + -0.001117120455603726i, 0.017366888476689237 + 0.021077456041575193i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.025395117532012176 + -0.03107698324520216i, -0.0051558003168155585 + 0.001117120455603726i, 0.0 + 0.0i, 0.0 + 0.0i, 0.30665336279031097 + 5.661715934501145e-20i, -0.031514884886536115 + -0.024831459261519986i, 0.0 + 0.0i, 0.0 + 0.0i }, { -5.762881223813721e-05 + 0.005249464275021896i, 0.017366888476689237 + -0.021077456041575193i, 0.0 + 0.0i, 0.0 + 0.0i, -0.031514884886536115 + 0.024831459261519986i, 0.2107128728592726 + 3.972373941842712e-20i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, true, false, false, false, false, false, false, true}), ElementsAreArray({ DoubleNear(0.2857848041712285, 1.0e-7), DoubleNear(0.19684896017918804, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.30665336279031097, 1.0e-7), DoubleNear(0.2107128728592726, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.0, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, true, true, false, false, false, false, false}), Matrix({ { 0.18558142007380105 + -1.9396804245852842e-20i, -0.018998719502044 + -0.015246208679632637i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.02169520859629645 + 0.016026843290330852i, -0.0009077426476054929 + -0.0034283500908240117i }, { -0.018998719502044 + 0.015246208679632637i, 0.1257251750207736 + -1.1730571251618242e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, -0.003532761902823035 + 0.0001447805673127059i, 0.014683070452694607 + 0.01087362447456967i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.1129782882554397 + 7.601995502970636e-20i, -0.011665772398069218 + -0.008985928318632463i, 0.02008226278563674 + -0.01486200847986753i, -0.003256982977381742 + -5.932704247997871e-05i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, -0.011665772398069218 + 0.008985928318632463i, 0.078990449924889 + 6.239052250756666e-20i, -0.0008911118096575528 + 0.0031284119626744187i, 0.014045190597656321 + -0.010400466001529178i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.02008226278563674 + 0.01486200847986753i, -0.0008911118096575528 + -0.003128411962674419i, 0.17191394355151174 + -3.38772044180058e-20i, -0.01775269453603994 + -0.013666579018350536i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, -0.003256982977381742 + 5.932704247997872e-05i, 0.014045190597656321 + 0.010400466001529178i, -0.01775269453603994 + 0.013666579018350536i, 0.12022551736483257 + -3.557287981194642e-20i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.02169520859629645 + -0.016026843290330852i, -0.003532761902823035 + -0.0001447805673127059i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.12196451508078693 + 4.8996814041982845e-20i, -0.012485965785036256 + -0.010018304600293265i }, { -0.0009077426476054928 + 0.0034283500908240117i, 0.014683070452694607 + -0.01087362447456967i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, -0.012485965785036256 + 0.010018304600293265i, 0.08262069072796546 + 3.215596336085769e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, true, true, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.18558142007380105, 1.0e-7), DoubleNear(0.1257251750207736, 1.0e-7), DoubleNear(0.1129782882554397, 1.0e-7), DoubleNear(0.078990449924889, 1.0e-7), DoubleNear(0.17191394355151174, 1.0e-7), DoubleNear(0.12022551736483257, 1.0e-7), DoubleNear(0.12196451508078693, 1.0e-7), DoubleNear(0.08262069072796546, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, true, false, true, false, false, false, false}), Matrix({ { 0.17660055788497747 + -1.437632254224901e-20i, -0.018302422791593748 + -0.013824923741568374i, 0.0 + 0.0i, 0.0 + 0.0i, -0.03162064030443953 + 0.0008843493126139221i, 0.0035116479471436453 + 0.0025250620306502547i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.018302422791593748 + 0.013824923741568374i, 0.12538308833411416 + -1.5001203913684635e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0029911066051725816 + -0.002585312127604142i, -0.021772815527676244 + -0.0009932458573347711i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.11644287305606348 + 3.232363786191551e-20i, -0.012066169429151376 + -0.009120741753543027i, 0.0 + 0.0i, 0.0 + 0.0i, -0.021943949191638105 + 0.0002906231080886948i, 0.0023695843577224525 + 0.001776594633366445i }, { 0.0 + 0.0i, 0.0 + 0.0i, -0.012066169429151376 + 0.009120741753543027i, 0.0826283292303002 + 2.4758648850256687e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0021406326696837416 + -0.0017777516209194913i, -0.015076400978645366 + -0.0005720141928939563i }, { -0.03162064030443953 + -0.0008843493126139226i, 0.0029911066051725816 + 0.002585312127604142i, 0.0 + 0.0i, 0.0 + 0.0i, 0.1808948057403353 + -3.889768612160962e-20i, -0.018448991246490198 + -0.015087863956414801i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0035116479471436453 + -0.0025250620306502547i, -0.021772815527676244 + 0.000993245857334771i, 0.0 + 0.0i, 0.0 + 0.0i, -0.018448991246490198 + 0.015087863956414801i, 0.12056760405149203 + -3.230224714988003e-20i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, -0.021943949191638105 + -0.000290623108088695i, 0.0021406326696837416 + 0.0017777516209194913i, 0.0 + 0.0i, 0.0 + 0.0i, 0.11849993028016315 + 9.269313120977369e-20i, -0.012085568753954098 + -0.009883491165382702i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0023695843577224525 + -0.0017765946333664453i, -0.015076400978645366 + 0.0005720141928939563i, 0.0 + 0.0i, 0.0 + 0.0i, -0.012085568753954098 + 0.009883491165382702i, 0.07898281142255427 + 6.978783701816766e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, true, false, true, false, false, false, false}), ElementsAreArray({ DoubleNear(0.17660055788497747, 1.0e-7), DoubleNear(0.12538308833411416, 1.0e-7), DoubleNear(0.11644287305606348, 1.0e-7), DoubleNear(0.0826283292303002, 1.0e-7), DoubleNear(0.1808948057403353, 1.0e-7), DoubleNear(0.12056760405149203, 1.0e-7), DoubleNear(0.11849993028016315, 1.0e-7), DoubleNear(0.07898281142255427, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, true, false, false, true, false, false, false}), Matrix({ { 0.16703514425483895 + -2.1767762868371283e-20i, -0.006682551454155127 + -0.011793036920045867i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0062294207969617425 + 0.014361011448614448i, 0.0009098632394962732 + 0.005636825285442004i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.006682551454155127 + 0.011793036920045867i, 0.13338930518150882 + -2.2012676850580097e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.006311513219839058 + -0.010233821431884954i, -0.02927273185017342 + -0.013023681923247347i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.10978091668120046 + 5.612480685815718e-20i, -0.004395939193285038 + -0.007750061368628653i, 0.0 + 0.0i, 0.0 + 0.0i, 0.004094613964844283 + 0.009444381964138535i, 0.0005949644974840774 + 0.003709003877553052i }, { 0.0 + 0.0i, 0.0 + 0.0i, -0.004395939193285038 + 0.007750061368628653i, 0.08765604338743212 + 5.00822283101139e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.004164285355212844 + -0.0067290508109902735i, -0.019245776330140796 + -0.0085543648273969i }, { 0.0062294207969617425 + -0.014361011448614448i, 0.006311513219839058 + 0.010233821431884954i, 0.0 + 0.0i, 0.0 + 0.0i, 0.19046021937047383 + -3.150624579548735e-20i, -0.030068862583928817 + -0.017119750777937308i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0009098632394962732 + -0.005636825285442004i, -0.02927273185017342 + 0.013023681923247347i, 0.0 + 0.0i, 0.0 + 0.0i, -0.030068862583928817 + 0.017119750777937308i, 0.11256138720409734 + -2.529077421298456e-20i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.004094613964844283 + -0.009444381964138535i, 0.004164285355212844 + 0.0067290508109902735i, 0.0 + 0.0i, 0.0 + 0.0i, 0.12516188665502614 + 6.8891962213532e-20i, -0.01975579898982044 + -0.011254171550297076i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0005949644974840774 + -0.003709003877553052i, -0.019245776330140796 + 0.0085543648273969i, 0.0 + 0.0i, 0.0 + 0.0i, -0.01975579898982044 + 0.011254171550297076i, 0.07395509726542235 + 4.446425755831044e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, true, false, false, true, false, false, false}), ElementsAreArray({ DoubleNear(0.16703514425483895, 1.0e-7), DoubleNear(0.13338930518150882, 1.0e-7), DoubleNear(0.10978091668120046, 1.0e-7), DoubleNear(0.08765604338743212, 1.0e-7), DoubleNear(0.19046021937047383, 1.0e-7), DoubleNear(0.11256138720409734, 1.0e-7), DoubleNear(0.12516188665502614, 1.0e-7), DoubleNear(0.07395509726542235, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, true, false, false, false, true, false, false}), Matrix({ { 0.14401537848050117 + -2.4210190661195454e-20i, -0.01494470301767498 + -0.011218504700002607i, 0.0 + 0.0i, 0.0 + 0.0i, 0.015351091394283454 + -0.007042006282075986i, -0.0018358816829216812 + -0.0004083607299987226i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.01494470301767498 + 0.011218504700002607i, 0.10274952994517386 + -2.1574825290715287e-20i, 0.0 + 0.0i, 0.0 + 0.0i, -0.001315686343617977 + 0.002059180207456871i, 0.010609294947406575 + -0.007505815069145922i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.09463546859291591 + 4.7356939693044736e-20i, -0.009819885806614838 + -0.007374202807608254i, 0.0 + 0.0i, 0.0 + 0.0i, 0.01008356066169196 + -0.004621232073466267i, -0.001207571313639858 + -0.00026493919187323297i }, { 0.0 + 0.0i, 0.0 + 0.0i, -0.00981988580661484 + 0.007374202807608254i, 0.06750649513559281 + 3.281645586453301e-20i, 0.0 + 0.0i, 0.0 + 0.0i, -0.0008638587876109436 + 0.0013479126101343941i, 0.006976316062390804 + -0.0049247810708652855i }, { 0.015351091394283454 + 0.007042006282075985i, -0.001315686343617977 + -0.0020591802074568714i, 0.0 + 0.0i, 0.0 + 0.0i, 0.21347998514481165 + -2.906381800266318e-20i, -0.021806711020408966 + -0.017694282997980565i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.0018358816829216812 + 0.0004083607299987226i, 0.010609294947406575 + 0.0075058150691459215i, 0.0 + 0.0i, 0.0 + 0.0i, -0.021806711020408966 + 0.017694282997980565i, 0.14320116244043232 + -2.5728625772849373e-20i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.01008356066169196 + 0.004621232073466267i, -0.0008638587876109435 + -0.0013479126101343943i, 0.0 + 0.0i, 0.0 + 0.0i, 0.14030733474331072 + 7.765982937864447e-20i, -0.014331852376490636 + -0.011630030111317476i }, { 0.0 + 0.0i, 0.0 + 0.0i, -0.0012075713136398577 + 0.00026493919187323297i, 0.006976316062390804 + 0.004924781070865286i, 0.0 + 0.0i, 0.0 + 0.0i, -0.014331852376490636 + 0.011630030111317476i, 0.09410464551726166 + 6.173003000389133e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, true, false, false, false, true, false, false}), ElementsAreArray({ DoubleNear(0.14401537848050117, 1.0e-7), DoubleNear(0.10274952994517386, 1.0e-7), DoubleNear(0.09463546859291591, 1.0e-7), DoubleNear(0.06750649513559281, 1.0e-7), DoubleNear(0.21347998514481165, 1.0e-7), DoubleNear(0.14320116244043232, 1.0e-7), DoubleNear(0.14030733474331072, 1.0e-7), DoubleNear(0.09410464551726166, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, true, false, false, false, false, true, false}), Matrix({ { 0.1906886390261045 + 7.827210832190228e-23i, -0.01959296102888968 + -0.015454131111848197i, 0.0 + 0.0i, 0.0 + 0.0i, 0.008699722279379735 + -0.015521458209990213i, -0.002140705960063399 + 0.0009353331929919109i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.01959296102888968 + 0.015454131111848197i, 0.13091897185214263 + -7.002497927366331e-21i, 0.0 + 0.0i, 0.0 + 0.0i, 0.00032842187881745714 + 0.0022693209545206943i, 0.006295877098107783 + -0.010854569662710261i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.12545886414131643 + 6.758876823403089e-20i, -0.012889749632313272 + -0.010170623176131103i, 0.0 + 0.0i, 0.0 + 0.0i, 0.005571181551980867 + -0.010099646769422852i, -0.001382850113056294 + 0.000617710341515744i }, { 0.0 + 0.0i, 0.0 + 0.0i, -0.012889749632313272 + 0.010170623176131103i, 0.08610976995680994 + 5.134646587265666e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0002211295459200837 + 0.0014683790213736794i, 0.004047060736426648 + -0.007074218840119025i }, { 0.008699722279379735 + 0.015521458209990213i, 0.0003284218788174569 + -0.0022693209545206943i, 0.0 + 0.0i, 0.0 + 0.0i, 0.16680672459920828 + -5.335228077218054e-20i, -0.01715845300919426 + -0.013458656586134977i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.002140705960063399 + -0.0009353331929919109i, 0.006295877098107783 + 0.010854569662710261i, 0.0 + 0.0i, 0.0 + 0.0i, -0.01715845300919426 + 0.013458656586134977i, 0.11503172053346356 + -4.030095313619833e-20i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.005571181551980867 + 0.010099646769422852i, 0.0002211295459200839 + -0.0014683790213736794i, 0.0 + 0.0i, 0.0 + 0.0i, 0.1094839391949102 + 5.74280008376583e-20i, -0.011261988550792204 + -0.008833609742794627i }, { 0.0 + 0.0i, 0.0 + 0.0i, -0.0013828501130562938 + -0.000617710341515744i, 0.004047060736426648 + 0.007074218840119025i, 0.0 + 0.0i, 0.0 + 0.0i, -0.011261988550792204 + 0.008833609742794627i, 0.07550137069604453 + 4.320001999576769e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, true, false, false, false, false, true, false}), ElementsAreArray({ DoubleNear(0.1906886390261045, 1.0e-7), DoubleNear(0.13091897185214263, 1.0e-7), DoubleNear(0.12545886414131643, 1.0e-7), DoubleNear(0.08610976995680994, 1.0e-7), DoubleNear(0.16680672459920828, 1.0e-7), DoubleNear(0.11503172053346356, 1.0e-7), DoubleNear(0.1094839391949102, 1.0e-7), DoubleNear(0.07550137069604453, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, true, false, false, false, false, false, true}), Matrix({ { 0.1724749552371066 + -3.493585511037732e-20i, -0.017736624834519488 + -0.013931165868403046i, 0.0 + 0.0i, 0.0 + 0.0i, 0.015361320231739382 + 0.018718771644031792i, -4.059281694586067e-05 + -0.003169056435524875i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.017736624834519488 + 0.013931165868403046i, 0.11881183995279657 + -2.868679366037675e-20i, 0.0 + 0.0i, 0.0 + 0.0i, -0.003111754369947232 + -0.0006656505993199563i, 0.010489059504370141 + 0.012694209012943618i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.11330984893412185 + 5.0061456173196437e-20i, -0.011651642500133817 + -0.009154395486985873i, 0.0 + 0.0i, 0.0 + 0.0i, 0.010033797300272793 + 0.012358211601170366i, -1.703599529227648e-05 + -0.0020804078394970216i }, { 0.0 + 0.0i, 0.0 + 0.0i, -0.011651642500133817 + 0.009154395486985873i, 0.07803712022639148 + 3.620608904680931e-20i, 0.0 + 0.0i, 0.0 + 0.0i, -0.0020440459468683268 + -0.00045146985628377004i, 0.006877828972319096 + 0.008383247028631578i }, { 0.01536132023173938 + -0.018718771644031792i, -0.003111754369947232 + 0.0006656505993199563i, 0.0 + 0.0i, 0.0 + 0.0i, 0.1850204083882062 + -1.8338153553481314e-20i, -0.019014789203564458 + -0.014981621829580129i, 0.0 + 0.0i, 0.0 + 0.0i }, { -4.059281694586067e-05 + 0.003169056435524875i, 0.010489059504370141 + -0.012694209012943618i, 0.0 + 0.0i, 0.0 + 0.0i, -0.019014789203564458 + 0.014981621829580129i, 0.1271388524328096 + -1.8616657403187914e-20i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.010033797300272793 + -0.012358211601170366i, -0.0020440459468683268 + 0.00045146985628377004i, 0.0 + 0.0i, 0.0 + 0.0i, 0.12163295440210478 + 7.495531289849276e-20i, -0.012500095682971658 + -0.009849837431939856i }, { 0.0 + 0.0i, 0.0 + 0.0i, -1.7035995292276427e-05 + 0.002080407839497021i, 0.006877828972319096 + -0.008383247028631578i, 0.0 + 0.0i, 0.0 + 0.0i, -0.012500095682971658 + 0.009849837431939856i, 0.08357402042646299 + 5.834039682161504e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, true, false, false, false, false, false, true}), ElementsAreArray({ DoubleNear(0.1724749552371066, 1.0e-7), DoubleNear(0.11881183995279657, 1.0e-7), DoubleNear(0.11330984893412185, 1.0e-7), DoubleNear(0.07803712022639148, 1.0e-7), DoubleNear(0.1850204083882062, 1.0e-7), DoubleNear(0.1271388524328096, 1.0e-7), DoubleNear(0.12163295440210478, 1.0e-7), DoubleNear(0.08357402042646299, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, true, true, false, false, false, false}), Matrix({ { 0.14733800319080617 + 7.958805983049837e-21i, -0.015257003340355171 + -0.011570390785558063i, 0.0 + 0.0i, 0.0 + 0.0i, -0.026938994885740107 + 0.000787089155644672i, 0.0029555585781719925 + 0.002149045831345451i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.015257003340355171 + 0.011570390785558063i, 0.10426574958215974 + 7.126279846966863e-21i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0025713265924142306 + -0.002225570472104962i, -0.018512011250177728 + -0.0006408488162890054i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.14570542775023476 + 9.988509336616664e-21i, -0.015111588880389949 + -0.011375274709553337i, 0.0 + 0.0i, 0.0 + 0.0i, -0.026625594610337526 + 0.0003878832650579449i, 0.0029256737266941052 + 0.0021526108326712498i }, { 0.0 + 0.0i, 0.0 + 0.0i, -0.015111588880389949 + 0.011375274709553337i, 0.1037456679822546 + 2.6311650896051905e-21i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0025604126824420926 + -0.002137493276418671i, -0.01833720525614388 + -0.000924411233939722i }, { -0.026938994885740107 + -0.0007870891556446722i, 0.00257132659241423 + 0.002225570472104962i, 0.0 + 0.0i, 0.0 + 0.0i, 0.15122170513843458 + 4.8664344800803675e-20i, -0.015407488559758048 + -0.012661746212707038i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0029555585781719925 + -0.002149045831345451i, -0.018512011250177728 + 0.0006408488162890053i, 0.0 + 0.0i, 0.0 + 0.0i, -0.015407488559758048 + 0.012661746212707038i, 0.10044987536350286 + 4.353367140898155e-20i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, -0.026625594610337526 + -0.0003878832650579452i, 0.0025604126824420926 + 0.002137493276418671i, 0.0 + 0.0i, 0.0 + 0.0i, 0.1481730308820639 + 5.131100287360389e-21i, -0.015127071440686249 + -0.012309608909090466i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0029256737266941052 + -0.0021526108326712498i, -0.018337205256143883 + 0.000924411233939722i, 0.0 + 0.0i, 0.0 + 0.0i, -0.015127071440686249 + 0.012309608909090466i, 0.09910054011054342 + -6.048081540693919e-21i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, true, true, false, false, false, false}), ElementsAreArray({ DoubleNear(0.14733800319080617, 1.0e-7), DoubleNear(0.10426574958215974, 1.0e-7), DoubleNear(0.14570542775023476, 1.0e-7), DoubleNear(0.1037456679822546, 1.0e-7), DoubleNear(0.15122170513843458, 1.0e-7), DoubleNear(0.10044987536350286, 1.0e-7), DoubleNear(0.1481730308820639, 1.0e-7), DoubleNear(0.09910054011054342, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, true, false, true, false, false, false}), Matrix({ { 0.13969267620397122 + 2.3641276753470022e-20i, -0.005699794705031062 + -0.00987049195318044i, 0.0 + 0.0i, 0.0 + 0.0i, 0.005230652006825173 + 0.012182005519218584i, 0.0006524531088489778 + 0.004821323745690074i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.005699794705031062 + 0.00987049195318044i, 0.11123882674432492 + 2.5842578290790577e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.005716995902844729 + -0.00864086195429241i, -0.02465712078637205 + -0.010720603337233934i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.1371233847320682 + 1.0715767236315881e-20i, -0.005378695942409103 + -0.00967260633549408i, 0.0 + 0.0i, 0.0 + 0.0i, 0.005093382754980852 + 0.011623387893534398i, 0.0008523746281313729 + 0.004524505417304982i }, { 0.0 + 0.0i, 0.0 + 0.0i, -0.005378695942409103 + 0.00967260633549408i, 0.10980652182461605 + 2.226973168743227e-21i, 0.0 + 0.0i, 0.0 + 0.0i, 0.004758802672207173 + -0.008322010288582817i, -0.02386138739394217 + -0.01085744341341031i }, { 0.005230652006825173 + -0.012182005519218584i, 0.005716995902844729 + 0.008640861954292409i, 0.0 + 0.0i, 0.0 + 0.0i, 0.15886703212526954 + 3.2981874030383493e-20i, -0.024964697195082156 + -0.014361645045084664i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0006524531088489778 + -0.004821323745690074i, -0.02465712078637205 + 0.010720603337233934i, 0.0 + 0.0i, 0.0 + 0.0i, -0.024964697195082156 + 0.014361645045084664i, 0.09347679820133768 + 2.4817372965157835e-20i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.005093382754980852 + -0.011623387893534398i, 0.004758802672207173 + 0.008322010288582817i, 0.0 + 0.0i, 0.0 + 0.0i, 0.15675507390023047 + 4.403842387661167e-21i, -0.024859964378667096 + -0.014012277283149719i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0008523746281313728 + -0.004524505417304982i, -0.02386138739394217 + 0.01085744341341031i, 0.0 + 0.0i, 0.0 + 0.0i, -0.024859964378667096 + 0.014012277283149719i, 0.093039686268182 + -5.643889619831959e-21i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, true, false, true, false, false, false}), ElementsAreArray({ DoubleNear(0.13969267620397122, 1.0e-7), DoubleNear(0.11123882674432492, 1.0e-7), DoubleNear(0.1371233847320682, 1.0e-7), DoubleNear(0.10980652182461605, 1.0e-7), DoubleNear(0.15886703212526954, 1.0e-7), DoubleNear(0.09347679820133768, 1.0e-7), DoubleNear(0.15675507390023047, 1.0e-7), DoubleNear(0.093039686268182, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, true, false, false, true, false, false}), Matrix({ { 0.12079279328285833 + 2.919795514376134e-20i, -0.012530056268631047 + -0.009423461847683591i, 0.0 + 0.0i, 0.0 + 0.0i, 0.014111268389412913 + -0.01077289803846798i, -0.0021194232576696513 + 3.5982136510439693e-05i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.012530056268631047 + 0.009423461847683591i, 0.08606852061513105 + 2.175745590362961e-20i, 0.0 + 0.0i, 0.0 + 0.0i, -0.0007764095792545489 + 0.002310428318645925i, 0.009750957212958768 + -0.00917211637981508i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.11785805379055872 + -6.051206111912051e-21i, -0.012234532555658772 + -0.009169245659927269i, 0.0 + 0.0i, 0.0 + 0.0i, 0.011323383666562499 + -0.0008903403170742724i, -0.0009240297388918878 + -0.0007092820583823954i }, { 0.0 + 0.0i, 0.0 + 0.0i, -0.012234532555658772 + 0.009169245659927269i, 0.08418750446563561 + -1.0515825329811888e-20i, 0.0 + 0.0i, 0.0 + 0.0i, -0.0014031355519743714 + 0.0010966644989453406i, 0.007834653796838611 + -0.003258479760196127i }, { 0.014111268389412913 + 0.01077289803846798i, -0.0007764095792545489 + -0.0023104283186459254i, 0.0 + 0.0i, 0.0 + 0.0i, 0.17776691504638242 + 2.7425195640092176e-20i, -0.01813443563148217 + -0.01480867515058151i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.0021194232576696513 + -3.598213651043972e-05i, 0.009750957212958768 + 0.009172116379815081i, 0.0 + 0.0i, 0.0 + 0.0i, -0.01813443563148217 + 0.01480867515058151i, 0.11864710433053155 + 2.89024953523188e-20i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.011323383666562499 + 0.0008903403170742721i, -0.0014031355519743714 + -0.0010966644989453406i, 0.0 + 0.0i, 0.0 + 0.0i, 0.17602040484173992 + 2.1170815735889104e-20i, -0.018004127765417426 + -0.014515637958716533i }, { 0.0 + 0.0i, 0.0 + 0.0i, -0.0009240297388918878 + 0.0007092820583823954i, 0.007834653796838611 + 0.003258479760196127i, 0.0 + 0.0i, 0.0 + 0.0i, -0.018004127765417426 + 0.014515637958716533i, 0.11865870362716244 + 7.098908878723158e-21i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, true, false, false, true, false, false}), ElementsAreArray({ DoubleNear(0.12079279328285833, 1.0e-7), DoubleNear(0.08606852061513105, 1.0e-7), DoubleNear(0.11785805379055872, 1.0e-7), DoubleNear(0.08418750446563561, 1.0e-7), DoubleNear(0.17776691504638242, 1.0e-7), DoubleNear(0.11864710433053155, 1.0e-7), DoubleNear(0.17602040484173992, 1.0e-7), DoubleNear(0.11865870362716244, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, true, false, false, false, true, false}), Matrix({ { 0.1593387708144844 + 8.048809707974371e-20i, -0.01635662916760048 + -0.01295949824897464i, 0.0 + 0.0i, 0.0 + 0.0i, 0.007173843911547778 + -0.012902965085799967i, -0.0017764204578000417 + 0.0007779656645335155i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.01635662916760048 + 0.01295949824897464i, 0.10902458360510611 + 6.496758082328041e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.00028350498639767726 + 0.0018838149312455188i, 0.00517911731854322 + -0.00899762045688283i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.15680873235293658 + -1.2821056737390924e-20i, -0.016126081493602472 + -0.01266525603900466i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0070970599198128224 + -0.012718139893613098i, -0.001747135615319651 + 0.0007750778699741395i }, { 0.0 + 0.0i, 0.0 + 0.0i, -0.016126081493602472 + 0.01266525603900466i, 0.10800415820384646 + -2.0623612877990075e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.00026604643833986336 + 0.0018538850446488547i, 0.005163820515991211 + -0.008931168045946458i }, { 0.00717384391154778 + 0.012902965085799967i, 0.0002835049863976775 + -0.0018838149312455188i, 0.0 + 0.0i, 0.0 + 0.0i, 0.1392209375147564 + -2.3864946295890207e-20i, -0.014307862732512737 + -0.011272638749290463i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.0017764204578000417 + -0.0007779656645335155i, 0.00517911731854322 + 0.00899762045688283i, 0.0 + 0.0i, 0.0 + 0.0i, -0.014307862732512737 + 0.011272638749290463i, 0.09569104134055648 + -1.430762956733199e-20i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0070970599198128224 + 0.012718139893613098i, 0.00026604643833986357 + -0.0018538850446488547i, 0.0 + 0.0i, 0.0 + 0.0i, 0.1370697262793621 + 2.794066636136798e-20i, -0.014112578827473726 + -0.01101962757963914i }, { 0.0 + 0.0i, 0.0 + 0.0i, -0.001747135615319651 + -0.0007750778699741393i, 0.005163820515991211 + 0.008931168045946458i, 0.0 + 0.0i, 0.0 + 0.0i, -0.014112578827473726 + 0.01101962757963914i, 0.09484204988895159 + 1.7206696426901348e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, true, false, false, false, true, false}), ElementsAreArray({ DoubleNear(0.1593387708144844, 1.0e-7), DoubleNear(0.10902458360510611, 1.0e-7), DoubleNear(0.15680873235293658, 1.0e-7), DoubleNear(0.10800415820384646, 1.0e-7), DoubleNear(0.1392209375147564, 1.0e-7), DoubleNear(0.09569104134055648, 1.0e-7), DoubleNear(0.1370697262793621, 1.0e-7), DoubleNear(0.09484204988895159, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, true, false, false, false, false, true}), Matrix({ { 0.1440084119905039 + 2.6100952678401496e-20i, -0.01479550866289073 + -0.011673646095613721i, 0.0 + 0.0i, 0.0 + 0.0i, 0.012812539463890315 + 0.01567522676773027i, -2.4800967038658033e-05 + -0.0026501222205298908i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.01479550866289073 + 0.011673646095613721i, 0.09886702704387162 + 1.847162267278045e-20i, 0.0 + 0.0i, 0.0 + 0.0i, -0.0026033869270976136 + -0.0005586908061865454i, 0.008732469323985883 + 0.010597999105070284i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.14177639218072455 + -1.0975351615582376e-20i, -0.01459275867176257 + -0.011411915259775196i, 0.0 + 0.0i, 0.0 + 0.0i, 0.012582578068121863 + 0.01540175647747189i, -3.282784519947923e-05 + -0.0025993420544920057i }, { 0.0 + 0.0i, 0.0 + 0.0i, -0.01459275867176257 + 0.011411915259775196i, 0.09798193313531643 + -1.0952327286347885e-20i, 0.0 + 0.0i, 0.0 + 0.0i, -0.0025524133897179453 + -0.0005584296494171807i, 0.008634419152703354 + 0.01047945693650491i }, { 0.012812539463890315 + -0.01567522676773027i, -0.0026033869270976136 + 0.0005586908061865454i, 0.0 + 0.0i, 0.0 + 0.0i, 0.15455129633873682 + 3.0522198105452013e-20i, -0.015868983237222488 + -0.012558490902651381i, 0.0 + 0.0i, 0.0 + 0.0i }, { -2.480096703865798e-05 + 0.0026501222205298908i, 0.008732469323985883 + -0.010597999105070284i, 0.0 + 0.0i, 0.0 + 0.0i, -0.015868983237222488 + 0.012558490902651381i, 0.10584859790179099 + 3.218832858316796e-20i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.01258257806812186 + -0.01540175647747189i, -0.0025524133897179453 + 0.0005584296494171809i, 0.0 + 0.0i, 0.0 + 0.0i, 0.15210206645157412 + 2.6094961239559426e-20i, -0.015645901649313627 + -0.012272968358868604i }, { 0.0 + 0.0i, 0.0 + 0.0i, -3.282784519947923e-05 + 0.0025993420544920057i, 0.008634419152703353 + -0.01047945693650491i, 0.0 + 0.0i, 0.0 + 0.0i, -0.015645901649313627 + 0.012272968358868604i, 0.1048642749574816 + 7.535410835259155e-21i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, true, false, false, false, false, true}), ElementsAreArray({ DoubleNear(0.1440084119905039, 1.0e-7), DoubleNear(0.09886702704387162, 1.0e-7), DoubleNear(0.14177639218072455, 1.0e-7), DoubleNear(0.09798193313531643, 1.0e-7), DoubleNear(0.15455129633873682, 1.0e-7), DoubleNear(0.10584859790179099, 1.0e-7), DoubleNear(0.15210206645157412, 1.0e-7), DoubleNear(0.1048642749574816, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, false, true, true, false, false, false}), Matrix({ { 0.13518962968024234 + 8.85718456895722e-21i, -0.004416371851112199 + -0.009721812111418052i, -0.025027993631819394 + 0.0011907890164611602i, 0.001020050908501848 + 0.001351509437387287i, 0.00493212449412369 + 0.010151193613737662i, 0.0014968268716434201 + 0.00348213050320011i, -0.001581480930632598 + -0.002067277230552602i, -0.0005766401804373337 + -0.001120420337748551i }, { -0.004416371851112199 + 0.009721812111418052i, 0.11090658304693496 + 6.1452016245882624e-21i, 0.000983246099892251 + -0.0021824223573287905i, -0.01998555126324495 + -0.0001420439428805831i, 0.0010502492818148372 + -0.007516228237944419i, -0.02198688658216401 + -0.011852361441953953i, -0.0005900356838267302 + 0.0030830832624696154i, 0.00399331426982333 + 0.0011101909640850033i }, { -0.025027993631819394 + -0.0011907890164611604i, 0.000983246099892251 + 0.0021824223573287905i, 0.1416264312557971 + 2.5499859420828683e-20i, -0.006662118796327968 + -0.00982128617725647i, -0.00028538962159931384 + -0.0022373952131102804i, 0.0003045257742805921 + -0.0005695636320006494i, 0.005391910267682334 + 0.01365419979901532i, 8.000865336930602e-06 + 0.005863698659794946i }, { 0.001020050908501848 + -0.001351509437387287i, -0.01998555126324495 + 0.000142043942880583i, -0.006662118796327968 + 0.00982128617725647i, 0.11013876552200602 + 2.1924349834945544e-20i, -0.001304277956343176 + -1.5727582048007502e-05i, 0.00478017170245817 + 0.002791715701561897i, 0.009425549293237065 + -0.00944664400493081i, -0.026531621598150205 + -0.009725685308690292i }, { 0.00493212449412369 + -0.010151193613737662i, 0.0010502492818148372 + 0.007516228237944419i, -0.00028538962159931384 + 0.0022373952131102804i, -0.0013042779563431763 + 1.5727582048007465e-05i, 0.1578538012607986 + 9.09013075070928e-21i, -0.02595222036963292 + -0.01322385338369335i, -0.028536595864258243 + -1.5816595758543286e-05i, 0.00486118139636425 + 0.0029501472266294133i }, { 0.0014968268716434201 + -0.00348213050320011i, -0.021986886582164012 + 0.011852361441953953i, 0.00030452577428059205 + 0.0005695636320006494i, 0.00478017170245817 + -0.002791715701561897i, -0.02595222036963292 + 0.013223853383693349i, 0.09710483451747941 + 3.61224331198379e-21i, 0.004148493174964072 + -0.0021806413911948422i, -0.016863665243076663 + -0.0014232161073481444i }, { -0.001581480930632598 + 0.002067277230552602i, -0.0005900356838267301 + -0.0030830832624696154i, 0.005391910267682334 + -0.01365419979901532i, 0.009425549293237065 + 0.00944664400493081i, -0.02853659586425824 + 1.581659575854307e-05i, 0.004148493174964072 + 0.0021806413911948422i, 0.15776830476470138 + 2.829558566733538e-20i, -0.02387244120411633 + -0.015150068944541031i }, { -0.0005766401804373337 + 0.0011204203377485511i, 0.00399331426982333 + -0.0011101909640850033i, 8.000865336930615e-06 + -0.005863698659794946i, -0.026531621598150205 + 0.009725685308690292i, 0.00486118139636425 + -0.0029501472266294133i, -0.016863665243076663 + 0.0014232161073481442i, -0.02387244120411633 + 0.015150068944541031i, 0.08941164995204026 + 1.556124003334209e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, false, true, true, false, false, false}), ElementsAreArray({ DoubleNear(0.13518962968024234, 1.0e-7), DoubleNear(0.11090658304693496, 1.0e-7), DoubleNear(0.1416264312557971, 1.0e-7), DoubleNear(0.11013876552200602, 1.0e-7), DoubleNear(0.1578538012607986, 1.0e-7), DoubleNear(0.09710483451747941, 1.0e-7), DoubleNear(0.15776830476470138, 1.0e-7), DoubleNear(0.08941164995204026, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, false, true, false, true, false, false}), Matrix({ { 0.1209182733839132 + 1.7259101050022382e-20i, -0.012644271923752844 + -0.009121556122673017i, -0.021626786026297466 + -0.000577126824672763i, 0.002322214711706741 + 0.0018118204983315854i, 0.012555289262974893 + -0.007861602208574566i, -0.0016732030931504121 + -5.562398696036397e-05i, -0.002876979178687237 + 0.0011151259591667053i, 0.0003229955663102193 + 2.183173329709198e-05i }, { -0.012644271923752844 + 0.009121556122673017i, 0.08883384342225645 + 1.0128021850995808e-20i, 0.0021617425515472423 + -0.0016138156065568397i, -0.015344040585698772 + -0.001383353311263835i, -0.0009357840821685821 + 0.0018484424673318705i, 0.008991156650881349 + -0.007752827885969877i, 0.000264940237707646 + -0.0002958275363204539i, -0.002332604927767651 + 0.0010498532152963245i }, { -0.021626786026297466 + 0.0005771268246727628i, 0.0021617425515472427 + 0.0016138156065568397i, 0.11773257368950384 + 5.887647981826906e-21i, -0.012120316900536974 + -0.009471151384937843i, -0.0014070448560125585 + 0.0011183854112446698i, 0.000257514092861779 + -3.188883426808432e-05i, 0.012879362793000518 + -0.003801636146967685i, -0.001370249903411127 + -0.0006176759349115916i }, { 0.002322214711706741 + -0.0018118204983315854i, -0.015344040585698772 + 0.001383353311263835i, -0.012120316900536974 + 0.009471151384937843i, 0.08142218165851021 + 1.1136087228219161e-21i, 4.5252497401214915e-06 + -0.00020501694296287248i, -0.0011626224755344793 + 0.0010734659701620711i, -0.0012437610490603384 + 0.001558650350259395i, 0.008594454358916032 + -0.00467776825404133i }, { 0.012555289262974893 + 0.007861602208574568i, -0.0009357840821685821 + -0.0018484424673318707i, -0.0014070448560125582 + -0.0011183854112446696i, 4.525249740121471e-06 + 0.00020501694296287253i, 0.1721251575571277 + 6.88214269644119e-22i, -0.01772432029699228 + -0.013824109372438382i, -0.031937803469780174 + 0.0017520992453753798i, 0.003559017593159357 + 0.002489836165685115i }, { -0.0016732030931504121 + 5.562398696036392e-05i, 0.008991156650881349 + 0.007752827885969877i, 0.000257514092861779 + 3.188883426808432e-05i, -0.0011626224755344793 + -0.0010734659701620711i, -0.01772432029699228 + 0.013824109372438382i, 0.1191775741421579 + -3.705769144237564e-22i, 0.002969996723309081 + -0.002749248141966793i, -0.02150517592062284 + -0.00018190673896489255i }, { -0.002876979178687237 + -0.0011151259591667053i, 0.00026494023770764596 + 0.0002958275363204539i, 0.012879362793000518 + 0.003801636146967685i, -0.0012437610490603384 + -0.001558650350259395i, -0.031937803469780174 + -0.00175209924537538i, 0.002969996723309081 + 0.002749248141966793i, 0.18166216233099464 + 4.790779710633716e-20i, -0.018414243099907322 + -0.015500203736859659i }, { 0.0003229955663102192 + -2.18317332970919e-05i, -0.0023326049277676507 + -0.0010498532152963245i, -0.0013702499034111268 + 0.0006176759349115918i, 0.008594454358916032 + 0.00467776825404133i, 0.003559017593159357 + -0.002489836165685115i, -0.02150517592062284 + 0.00018190673896489252i, -0.018414243099907322 + 0.015500203736859659i, 0.11812823381553608 + 3.637198114546572e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, false, true, false, true, false, false}), ElementsAreArray({ DoubleNear(0.1209182733839132, 1.0e-7), DoubleNear(0.08883384342225645, 1.0e-7), DoubleNear(0.11773257368950384, 1.0e-7), DoubleNear(0.08142218165851021, 1.0e-7), DoubleNear(0.1721251575571277, 1.0e-7), DoubleNear(0.1191775741421579, 1.0e-7), DoubleNear(0.18166216233099464, 1.0e-7), DoubleNear(0.11812823381553608, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, false, true, false, false, true, false}), Matrix({ { 0.15586232622760282 + 3.378947841128209e-20i, -0.01614443254333929 + -0.012228579334610627i, -0.028738322772581107 + -6.465999775726017e-05i, 0.0030899261538429143 + 0.002389057557045657i, 0.007630243664773906 + -0.013121479196186763i, -0.0018120288387137896 + 0.0007955208929686377i, -0.00036592037575081766 + 0.0029444195363203867i, 0.0002860576176253127 + -0.0003019456162972932i }, { -0.01614443254333929 + 0.012228579334610627i, 0.1104292115285976 + 2.1126215275500864e-20i, 0.0028113291833412207 + -0.002282669710913591i, -0.01967283940073217 + -0.0012709084166196388i, 0.0002123495997874063 + 0.0019338975094418116i, 0.005656071352020628 + -0.009443350802214426i, -0.0001920510192812125 + -0.00030284815165272964i, -0.0004990454420602528 + 0.0020178906254014863i }, { -0.028738322772581107 + 6.465999775726006e-05i, 0.0028113291833412207 + 0.002282669710913591i, 0.1602851769398181 + 3.387756193107071e-20i, -0.01633827811786366 + -0.013396174953368672i, -0.0019368525960687985 + 0.001399936320361925i, 0.00029037607184588993 + 9.728851270966233e-06i, 0.0066406601665866954 + -0.012499625783226298i, -0.0017115272344059031 + 0.0007575226415390175i }, { 0.0030899261538429148 + -0.002389057557045657i, -0.01967283940073217 + 0.0012709084166196386i, -0.01633827811786366 + 0.013396174953368672i, 0.10659953028035499 + 2.3217752669789463e-20i, 0.00010547358485001425 + -0.0003109411067694352i, -0.001301208048130984 + 0.0011393804364983825i, 0.0003372018249501343 + 0.0018038024664525617i, 0.004686866482513803 + -0.008485437700614863i }, { 0.007630243664773906 + 0.013121479196186763i, 0.0002123495997874063 + -0.0019338975094418116i, -0.0019368525960687985 + -0.001399936320361925i, 0.0001054735848500142 + 0.0003109411067694352i, 0.13718110471343808 + -1.5842163091615586e-20i, -0.014224159677405826 + -0.010717086160500773i, -0.024826266723496526 + 0.001239632418459877i, 0.002791306151023183 + 0.0019125991069710432i }, { -0.0018120288387137896 + -0.0007955208929686377i, 0.005656071352020628 + 0.009443350802214426i, 0.00029037607184588993 + -9.72885127096626e-06i, -0.001301208048130984 + -0.0011393804364983825i, -0.014224159677405826 + 0.010717086160500773i, 0.09758220603581676 + -1.1368770338928812e-20i, 0.0023204100915151025 + -0.002080394037610042i, -0.01717637710558944 + -0.0002943516336090888i }, { -0.00036592037575081744 + -0.0029444195363203867i, -0.00019205101928121258 + 0.00030284815165272964i, 0.0066406601665866954 + 0.0124996257832263i, 0.00033720182495013454 + -0.0018038024664525617i, -0.024826266723496526 + -0.001239632418459877i, 0.002320410091515103 + 0.002080394037610042i, 0.13910955908068035 + 1.9917883157093357e-20i, -0.014196281882580637 + -0.01157518016842883i }, { 0.0002860576176253127 + 0.0003019456162972933i, -0.0004990454420602528 + -0.0020178906254014863i, -0.0017115272344059031 + -0.0007575226415390175i, 0.004686866482513803 + 0.008485437700614863i, 0.002791306151023183 + -0.001912599106971043i, -0.01717637710558944 + 0.00029435163360908863i, -0.014196281882580637 + 0.01157518016842883i, 0.09295088519369132 + 1.426783719849817e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, false, true, false, false, true, false}), ElementsAreArray({ DoubleNear(0.15586232622760282, 1.0e-7), DoubleNear(0.1104292115285976, 1.0e-7), DoubleNear(0.1602851769398181, 1.0e-7), DoubleNear(0.10659953028035499, 1.0e-7), DoubleNear(0.13718110471343808, 1.0e-7), DoubleNear(0.09758220603581676, 1.0e-7), DoubleNear(0.13910955908068035, 1.0e-7), DoubleNear(0.09295088519369132, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, false, true, false, false, false, true}), Matrix({ { 0.14131600976434033 + -5.2422683475030816e-21i, -0.01464981789302744 + -0.01104970076176207i, -0.025905883315356024 + 0.00011224911184496182i, 0.0028050170790682905 + 0.0021275116030855766i, 0.013236445922811679 + 0.015297061504989131i, -0.0001518969632381386 + -0.002627720346243894i, -0.002234148826066712 + -0.0008430811379501488i, 0.00018164641179683948 + 0.0002749485129745999i }, { -0.01464981789302744 + 0.01104970076176207i, 0.10044222335342513 + -8.694070612790329e-21i, 0.0025206997876751477 + -0.0020648707469466286i, -0.01781408542740364 + -0.0010520573876214901i, -0.0025838730093881634 + -0.000531072142140308i, 0.009294716077627902 + 0.010703817004476847i, 0.0002770652562951351 + -8.841807845944258e-05i, -0.0015286186297806042 + -0.0007537755143429168i }, { -0.025905883315356024 + -0.00011224911184496214i, 0.0025206997876751477 + 0.0020648707469466286i, 0.14446879440688812 + 2.0367869410322204e-20i, -0.014738449441625862 + -0.012035860593626848i, -0.0016626869293879035 + -0.004702571703448757i, -0.000223605054792863 + 0.0005797036223580909i, 0.012158671609200495 + 0.01577992174021303i, 9.42681510000014e-05 + -0.002621743928778002i }, { 0.0028050170790682905 + -0.0021275116030855766i, -0.01781408542740364 + 0.00105205738762149i, -0.014738449441625862 + 0.012035860593626848i, 0.09640673682576292 + 1.6213365999222892e-20i, 0.000585086686155975 + 0.00037169627151834185i, -0.0014024410083300616 + -0.0030314552736255378i, -0.002571927307427395 + -0.000586048313463418i, 0.008072172399061335 + 0.010373639037098347i }, { 0.013236445922811679 + -0.015297061504989131i, -0.0025838730093881634 + 0.000531072142140308i, -0.0016626869293879035 + 0.004702571703448757i, 0.000585086686155975 + -0.00037169627151834185i, 0.1517274211767006 + 2.3189583667169583e-20i, -0.015718774327717677 + -0.011895964733349331i, -0.02765870618072161 + 0.001062723308857655i, 0.003076215225797807 + 0.002174145060931124i }, { -0.0001518969632381385 + 0.002627720346243894i, 0.0092947160776279 + -0.010703817004476847i, -0.000223605054792863 + -0.0005797036223580908i, -0.0014024410083300616 + 0.0030314552736255378i, -0.015718774327717677 + 0.011895964733349331i, 0.10756919421098922 + 1.845151554936238e-20i, 0.0026110394871811755 + -0.002298193001577004i, -0.01903513107891797 + -0.0005132026626072373i }, { -0.002234148826066712 + 0.0008430811379501489i, 0.0002770652562951351 + 8.841807845944259e-05i, 0.012158671609200497 + -0.015779921740213025i, -0.002571927307427395 + 0.000586048313463418i, -0.02765870618072161 + -0.001062723308857655i, 0.0026110394871811755 + 0.002298193001577004i, 0.15492594161361034 + 3.3427575677841866e-20i, -0.015796110558818435 + -0.012935494528170655i }, { 0.00018164641179683948 + -0.0002749485129745998i, -0.0015286186297806042 + 0.0007537755143429168i, 9.426815100000146e-05 + 0.002621743928778002i, 0.008072172399061337 + -0.010373639037098347i, 0.0030762152257978073 + -0.0021741450609311236i, -0.01903513107891797 + 0.0005132026626072373i, -0.015796110558818435 + 0.012935494528170655i, 0.10314367864828339 + 2.1272223869064742e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, false, true, false, false, false, true}), ElementsAreArray({ DoubleNear(0.14131600976434033, 1.0e-7), DoubleNear(0.10044222335342513, 1.0e-7), DoubleNear(0.14446879440688812, 1.0e-7), DoubleNear(0.09640673682576292, 1.0e-7), DoubleNear(0.1517274211767006, 1.0e-7), DoubleNear(0.10756919421098922, 1.0e-7), DoubleNear(0.15492594161361034, 1.0e-7), DoubleNear(0.10314367864828339, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, false, false, true, true, false, false}), Matrix({ { 0.10983620205239078 + 1.2850613493667787e-20i, -0.0034382034662387598 + -0.00789919621005435i, 0.003962552504712677 + 0.008033616619664202i, 0.0013543968462196934 + 0.0026843896583640635i, 0.0119668194411712 + -0.004220445581608017i, -0.0009100977577358479 + -0.0015192175928565184i, -0.00011569063296307797 + 0.0010424573708533978i, -0.0006944246250084458 + -0.00023143954791610404i }, { -0.0034382034662387598 + 0.00789919621005435i, 0.09050160243295861 + 8.37182267887674e-21i, 0.0002903637456361259 + -0.006011991916854396i, -0.017647657467347536 + -0.00984344194846674i, -0.00013327800459956183 + 0.0004514365090633177i, 0.009613093704237945 + -0.005393522449754648i, 0.0006999785544916946 + 0.001954267266994227i, -0.0032922034397477947 + -0.0011817877939888583i }, { 0.003962552504712677 + -0.008033616619664202i, 0.0002903637456361259 + 0.006011991916854396i, 0.12881464502102627 + 1.0296135538181499e-20i, -0.021326385358051057 + -0.010693511297556512i, 0.0012234235826185688 + -0.0011304863403336423i, 0.00018477101424483575 + 0.0033471418643965835i, 0.01346783261480421 + -0.007442792773934236i, -0.002133355238825691 + 0.0008459176709845629i }, { 0.0013543968462196934 + -0.0026843896583640635i, -0.01764765746734754 + 0.00984344194846674i, -0.021326385358051057 + 0.010693511297556512i, 0.07975442264780805 + 2.869807894940985e-21i, 0.0005021601471309512 + -0.000954121212494016i, -0.0007326766148754998 + 0.0003527048155804422i, -0.0020462671266293585 + 0.002955656308527948i, 0.007972517305559434 + -0.00703707369025656i }, { 0.0119668194411712 + 0.004220445581608017i, -0.0001332780045995618 + -0.0004514365090633177i, 0.0012234235826185688 + 0.0011304863403336423i, 0.0005021601471309512 + 0.000954121212494016i, 0.16697985888364864 + 2.1506430496118118e-20i, -0.007640287181201406 + -0.011643902078620172i, 0.006361482257093347 + 0.01577177679308878i, 0.00015043089076065722 + 0.006661439504630992i }, { -0.0009100977577358479 + 0.0015192175928565184i, 0.009613093704237945 + 0.005393522449754648i, 0.00018477101424483575 + -0.003347141864396584i, -0.0007326766148754999 + -0.0003527048155804422i, -0.007640287181201406 + 0.011643902078620172i, 0.13054374613598238 + 1.9697728780657067e-20i, 0.010185434829415776 + -0.010950880326020832i, -0.03087085071296668 + -0.011734604802177504i }, { -0.00011569063296307803 + -0.0010424573708533978i, 0.0006999785544916945 + -0.001954267266994227i, 0.01346783261480421 + 0.007442792773934236i, -0.0020462671266293585 + -0.002955656308527948i, 0.006361482257093347 + -0.01577177679308878i, 0.010185434829415776 + 0.010950880326020832i, 0.1868074610044737 + 2.708958087986316e-20i, -0.02849827621569819 + -0.01768041103067787i }, { -0.0006944246250084458 + 0.000231439547916104i, -0.0032922034397477947 + 0.0011817877939888583i, -0.002133355238825691 + -0.0008459176709845629i, 0.007972517305559434 + 0.00703707369025656i, 0.0001504308907606572 + -0.006661439504630992i, -0.03087085071296668 + 0.011734604802177504i, -0.02849827621569819 + 0.01768041103067787i, 0.10676206182171163 + 1.6303675450384894e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, false, false, true, true, false, false}), ElementsAreArray({ DoubleNear(0.10983620205239078, 1.0e-7), DoubleNear(0.09050160243295861, 1.0e-7), DoubleNear(0.12881464502102627, 1.0e-7), DoubleNear(0.07975442264780805, 1.0e-7), DoubleNear(0.16697985888364864, 1.0e-7), DoubleNear(0.13054374613598238, 1.0e-7), DoubleNear(0.1868074610044737, 1.0e-7), DoubleNear(0.10676206182171163, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, false, false, true, false, true, false}), Matrix({ { 0.1478444078515447 + 3.202446101995152e-20i, -0.0059884476175641075 + -0.010424979327005625i, 0.005521860381687465 + 0.012820341522271605i, 0.0007488737580977961 + 0.005069389970370411i, 0.006525998032051762 + -0.011889502282065142i, -0.0010275384383901856 + -4.6390636406764846e-05i, 0.0011872005779460133 + 2.1963458719502114e-06i, 0.000448178059745618 + 3.108059424045069e-05i }, { -0.0059884476175641075 + 0.010424979327005625i, 0.11784527949759632 + 2.6056795020556196e-20i, 0.005887647100603956 + -0.009114958925262328i, -0.026036152588665498 + -0.011430006771048572i, 0.0006680153443075616 + 0.0009041468758315032i, 0.005453121065195155 + -0.009633621301079929i, -0.0007783283806583231 + -0.0005949050639588025i, -0.0019927952594821228 + 0.0013868832232237708i }, { 0.005521860381687465 + -0.012820341522271605i, 0.005887647100603956 + 0.009114958925262328i, 0.16830309531587623 + 3.564257932240128e-20i, -0.026494263043638847 + -0.015199774960973677i, -0.0007184134979577382 + -0.0008786716170278898i, 0.0006062640007404026 + 7.910199638447616e-05i, 0.0077449057993088394 + -0.013731602697347921i, -0.0024960176347295073 + 0.0015994341709144196i }, { 0.0007488737580977961 + -0.005069389970370411i, -0.026036152588665498 + 0.011430006771048572i, -0.026494263043638847 + 0.015199774960973677i, 0.09918346231135627 + 1.8287172924734132e-20i, -0.00025242110868950283 + -0.00023232294775226637i, -1.5052308656661418e-05 + 0.0026195710076945804i, -0.00011846391957002133 + 0.0028335531000628703i, 0.004889816769339276 + -0.008295167201749358i }, { 0.006525998032051762 + 0.011889502282065142i, 0.0006680153443075618 + -0.0009041468758315032i, -0.0007184134979577384 + 0.0008786716170278898i, -0.00025242110868950283 + 0.00023232294775226637i, 0.12897165308449474 + 2.3325829698343877e-21i, -0.005090043029876059 + -0.009118118961668897i, 0.004802174380118561 + 0.010985051890481375i, 0.0007559539788825546 + 0.0042764391926246445i }, { -0.0010275384383901856 + 4.6390636406764846e-05i, 0.005453121065195155 + 0.009633621301079929i, 0.0006062640007404024 + -7.910199638447605e-05i, -1.5052308656661418e-05 + -0.00261957100769458i, -0.005090043029876059 + 0.009118118961668897i, 0.10320006907134469 + 2.0127564389776093e-21i, 0.0045881514744479475 + -0.0078479133176129i, -0.02248235559164872 + -0.010148039979595673i }, { 0.0011872005779460133 + -2.1963458719502114e-06i, -0.0007783283806583232 + 0.0005949050639588025i, 0.0077449057993088394 + 0.013731602697347923i, -0.0001184639195700209 + -0.0028335531000628703i, 0.004802174380118561 + -0.010985051890481375i, 0.0045881514744479475 + 0.0078479133176129i, 0.14731901070962375 + 1.7431370956433806e-21i, -0.023330398530110402 + -0.013174147367260705i }, { 0.00044817805974561794 + -3.108059424045069e-05i, -0.0019927952594821228 + -0.0013868832232237706i, -0.0024960176347295073 + -0.0015994341709144196i, 0.004889816769339276 + 0.00829516720174936i, 0.0007559539788825546 + -0.0042764391926246445i, -0.02248235559164872 + 0.010148039979595673i, -0.023330398530110402 + 0.013174147367260705i, 0.08733302215816341 + 8.863104205917484e-22i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, false, false, true, false, true, false}), ElementsAreArray({ DoubleNear(0.1478444078515447, 1.0e-7), DoubleNear(0.11784527949759632, 1.0e-7), DoubleNear(0.16830309531587623, 1.0e-7), DoubleNear(0.09918346231135627, 1.0e-7), DoubleNear(0.12897165308449474, 1.0e-7), DoubleNear(0.10320006907134469, 1.0e-7), DoubleNear(0.14731901070962375, 1.0e-7), DoubleNear(0.08733302215816341, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, false, false, true, false, false, true}), Matrix({ { 0.13346605573038978 + 6.719816223685347e-21i, -0.005303311623247517 + -0.009429459130150405i, 0.0049734870062563144 + 0.011421103903575678i, 0.0007547887675707281 + 0.004464534564974101i, 0.011893804767541174 + 0.014602244819527072i, 0.0005305374068806879 + -0.0014679755620022462i, -0.0008797346831815646 + 0.001596374797217861i, -0.0004915068685302779 + 0.0004625590925158056i }, { -0.005303311623247517 + 0.009429459130150405i, 0.10668973373469876 + 4.979478132864953e-21i, 0.004894836773983887 + -0.008149125521922474i, -0.023327497369360232 + -0.010454229077088057i, -0.001514597140439839 + 0.0002056970437462632i, 0.00944991230122302 + 0.011521408471385193i, 0.0014465719902065342 + 2.5655353857306085e-06i, -0.0010357457862855918 + -0.0035456527440635155i }, { 0.0049734870062563144 + -0.011421103903575678i, 0.004894836773983887 + 0.008149125521922474i, 0.15231874844083867 + 8.405784839133773e-21i, -0.024084955711405787 + -0.013656102225238512i, 0.0017704513746771204 + -0.0004968431440731023i, -0.0004152566737019109 + 0.00148499756117251i, 0.013501312764471 + 0.016474738425675088i, -0.0005881662191188251 + -0.00378148871301965i }, { 0.0007547887675707281 + -0.004464534564974101i, -0.023327497369360232 + 0.010454229077088057i, -0.024084955711405787 + 0.013656102225238512i, 0.09015922644448929 + 2.5398172535676095e-21i, 0.0005962540867817127 + -0.00037544725832852946i, -0.0031886722000379563 + -0.001733763987289509i, -0.0036412031763757196 + -0.0013228174993499895i, 0.007916976175466217 + 0.009556047570190001i }, { 0.011893804767541174 + -0.014602244819527072i, -0.001514597140439839 + -0.0002056970437462632i, 0.0017704513746771202 + 0.0004968431440731021i, 0.0005962540867817127 + 0.00037544725832852936i, 0.14335000520564967 + 2.763722776610056e-20i, -0.00577517902419265 + -0.010113639158524115i, 0.00535054775554971 + 0.012384289509177304i, 0.0007500389694096225 + 0.004881294598020954i }, { 0.0005305374068806879 + 0.0014679755620022462i, 0.00944991230122302 + -0.011521408471385193i, -0.00041525667370191096 + -0.0014849975611725098i, -0.0031886722000379563 + 0.001733763987289509i, -0.00577517902419265 + 0.010113639158524115i, 0.11435561483424223 + 2.3090073326668853e-20i, 0.005580961801068016 + -0.008813746720952753i, -0.025191010810953984 + -0.01112381767355619i }, { -0.0008797346831815646 + -0.001596374797217861i, 0.0014465719902065342 + -2.565535385730622e-06i, 0.013501312764471 + -0.016474738425675088i, -0.0036412031763757196 + 0.0013228174993499895i, 0.00535054775554971 + -0.012384289509177304i, 0.005580961801068016 + 0.008813746720952753i, 0.1633033575846613 + 2.897993157891089e-20i, -0.025739705862343466 + -0.014717820102995872i }, { -0.0004915068685302778 + -0.00046255909251580565i, -0.0010357457862855918 + 0.0035456527440635155i, -0.000588166219118825 + 0.00378148871301965i, 0.007916976175466217 + -0.009556047570190001i, 0.0007500389694096225 + -0.004881294598020954i, -0.025191010810953984 + 0.01112381767355619i, -0.025739705862343466 + 0.01471782010299587i, 0.0963572580250304 + 1.663366609175827e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, false, false, true, false, false, true}), ElementsAreArray({ DoubleNear(0.13346605573038978, 1.0e-7), DoubleNear(0.10668973373469876, 1.0e-7), DoubleNear(0.15231874844083867, 1.0e-7), DoubleNear(0.09015922644448929, 1.0e-7), DoubleNear(0.14335000520564967, 1.0e-7), DoubleNear(0.11435561483424223, 1.0e-7), DoubleNear(0.1633033575846613, 1.0e-7), DoubleNear(0.0963572580250304, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, false, false, false, true, true, false}), Matrix({ { 0.1271472923152377 + 1.9176908084778305e-20i, -0.013186895723101603 + -0.009927924847213014i, 0.013571453538343898 + -0.006074435085772149i, -0.001612921547009585 + -0.0003767540737964377i, 0.005981522554058043 + -0.010455517225957093i, -0.0014286420646509243 + 0.0006505683603848099i, 1.9474911633844813e-05 + -0.0015521815402574643i, -0.00010253800315712671 + 0.00013408202557266144i }, { -0.013186895723101603 + 0.009927924847213014i, 0.0905218126171494 + 7.839637901816126e-21i, -0.0011723474611662057 + 0.0018038579711518587i, 0.009366581266006035 + -0.006516883752645988i, 0.00017044220663886903 + 0.0015288056961889943i, 0.004481891678294148 + -0.007582234198801615i, 0.00011540701067671334 + 0.0001953343884135506i, -0.0001779122469627802 + -0.0012040647359052262i }, { 0.013571453538343898 + 0.006074435085772149i, -0.0011723474611662057 + -0.0018038579711518587i, 0.18900021085218324 + 4.849013225757449e-20i, -0.019295814938101348 + -0.015696829440766287i, 0.001223249244481585 + -0.0006538404705425878i, -0.00020220093306214435 + -1.7932894239653887e-05i, 0.008289381277302556 + -0.015165587753455969i, -0.0020949140084687685 + 0.0009024751741228453i }, { -0.001612921547009585 + 0.00037675407379643774i, 0.009366581266006035 + 0.006516883752645988i, -0.019295814938101348 + 0.015696829440766287i, 0.12650692919180317 + 3.65043300434742e-20i, -6.325660314345074e-05 + 0.0001423026865998556i, 0.0010514910166650113 + -0.00033611261689682004i, 0.00037910921809867137 + 0.002208894279705379i, 0.005861046156240281 + -0.010346554304027672i }, { 0.005981522554058042 + 0.010455517225957093i, 0.00017044220663886924 + -0.0015288056961889943i, 0.001223249244481585 + 0.0006538404705425878i, -6.325660314345073e-05 + -0.0001423026865998556i, 0.11150355475817936 + 3.969840947070982e-21i, -0.011577693101188214 + -0.008664782660397847i, 0.011863198517631516 + -0.005588803269770104i, -0.0014305314495519541 + -0.0002965458480755179i }, { -0.0014286420646509243 + -0.0006505683603848101i, 0.004481891678294148 + 0.007582234198801615i, -0.00020220093306214438 + 1.7932894239653914e-05i, 0.001051491016665011 + 0.00033611261689682004i, -0.011577693101188214 + 0.008664782660397847i, 0.07973421246361725 + 3.401992672001599e-21i, -0.0010071976700627148 + 0.001603234846439407i, 0.008219029743791344 + -0.0059137123873652195i }, { 1.947491163384492e-05 + 0.0015521815402574643i, 0.00011540701067671329 + -0.00019533438841355061i, 0.008289381277302558 + 0.015165587753455972i, 0.0003791092180986718 + -0.002208894279705379i, 0.011863198517631516 + 0.005588803269770103i, -0.0010071976700627148 + -0.001603234846439407i, 0.16478710903593913 + 1.0587911840678604e-22i, -0.016842748458798247 + -0.013627483668531757i }, { -0.00010253800315712671 + -0.00013408202557266144i, -0.0001779122469627802 + 0.001204064735905226i, -0.0020949140084687685 + -0.0009024751741228451i, 0.005861046156240281 + 0.010346554304027672i, -0.001430531449551954 + 0.00029654584807551785i, 0.008219029743791344 + 0.0059137123873652195i, -0.016842748458798247 + 0.013627483668531757i, 0.11079887876589081 + -5.029258124322408e-22i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, false, false, false, true, true, false}), ElementsAreArray({ DoubleNear(0.1271472923152377, 1.0e-7), DoubleNear(0.0905218126171494, 1.0e-7), DoubleNear(0.18900021085218324, 1.0e-7), DoubleNear(0.12650692919180317, 1.0e-7), DoubleNear(0.11150355475817936, 1.0e-7), DoubleNear(0.07973421246361725, 1.0e-7), DoubleNear(0.16478710903593913, 1.0e-7), DoubleNear(0.11079887876589081, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, false, false, false, true, false, true}), Matrix({ { 0.11523222777934657 + 1.3907991201141066e-20i, -0.011961337845360399 + -0.008965683695405714i, 0.012269581238148267 + -0.005706239130091226i, -0.0014738541419628951 + -0.00031580909529531803i, 0.01018381048931638 + 0.012384766306563738i, -7.477134028850658e-05 + -0.002079338283653882i, 0.0016028768665400346 + 0.0008633925305935956i, -8.762416136311336e-05 + -0.00018252389070345877i }, { -0.011961337845360399 + 0.008965683695405714i, 0.0823068337394324 + 6.539913541169778e-21i, -0.0010460758823464752 + 0.0016516207692214581i, 0.008493102354525179 + -0.006058197193507496i, -0.002035144618344478 + -0.0004813239492212934i, 0.007223396226899803 + 0.008712680588928608i, -0.0002603785164916597 + 1.791452221031987e-05i, 0.0013269536669950491 + 0.0004075364665931072i }, { 0.012269581238148267 + 0.005706239130091224i, -0.0010460758823464752 + -0.0016516207692214581i, 0.17055257639188187 + 1.2176098616780567e-21i, -0.017426929489292902 + -0.014119877659983203i, 0.0005730897906057182 + 0.0017965582193559745i, 6.88971557293621e-05 + -0.00025775143352961636i, 0.015211307042695793 + 0.01869221693863842i, 1.7142528050369428e-05 + -0.003170125991368014i }, { -0.0014738541419628951 + 0.0003158090952953181i, 0.008493102354525179 + 0.006058197193507496i, -0.017426929489292902 + 0.014119877659983203i, 0.11454212643975564 + 9.793818452627848e-22i, -0.00017235909404903155 + -0.0001258450568006791i, 0.00017663747881210644 + 0.0014207606942385903i, -0.0031206556984710804 + -0.0006357965063824327i, 0.010143492249789433 + 0.012364775452646587i }, { 0.01018381048931638 + -0.012384766306563738i, -0.0020351446183444776 + 0.0004813239492212934i, 0.0005730897906057182 + -0.0017965582193559745i, -0.00017235909404903155 + 0.0001258450568006791i, 0.12341861929407048 + 9.238757830708223e-21i, -0.012803250978929417 + -0.009627023812205145i, 0.013165070817827147 + -0.005956999225451027i, -0.0015695988545986438 + -0.00035749082657663756i }, { -7.477134028850663e-05 + 0.002079338283653882i, 0.007223396226899803 + -0.008712680588928608i, 6.88971557293621e-05 + 0.0002577514335296163i, 0.00017663747881210636 + -0.0014207606942385903i, -0.012803250978929417 + 0.009627023812205145i, 0.08794919134133426 + 4.701717032647947e-21i, -0.0011334692488824453 + 0.0017554720483698074i, 0.0090925086552722 + -0.006372398946503712i }, { 0.0016028768665400346 + -0.0008633925305935956i, -0.00026037851649165963 + -1.7914522210319866e-05i, 0.015211307042695793 + -0.01869221693863842i, -0.0031206556984710804 + 0.0006357965063824327i, 0.013165070817827147 + 0.005956999225451028i, -0.0011334692488824453 + -0.0017554720483698074i, 0.18323474349624047 + 4.737840151430322e-20i, -0.018711633907606696 + -0.015204435449314841i }, { -8.762416136311336e-05 + 0.0001825238907034588i, 0.0013269536669950491 + -0.0004075364665931072i, 1.7142528050369482e-05 + 0.003170125991368014i, 0.010143492249789433 + -0.012364775452646587i, -0.001569598854598644 + 0.00035749082657663756i, 0.0090925086552722 + 0.006372398946503712i, -0.018711633907606696 + 0.01520443544931484i, 0.12276368151793834 + 3.5022022385779176e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, false, false, false, true, false, true}), ElementsAreArray({ DoubleNear(0.11523222777934657, 1.0e-7), DoubleNear(0.0823068337394324, 1.0e-7), DoubleNear(0.17055257639188187, 1.0e-7), DoubleNear(0.11454212643975564, 1.0e-7), DoubleNear(0.12341861929407048, 1.0e-7), DoubleNear(0.08794919134133426, 1.0e-7), DoubleNear(0.18323474349624047, 1.0e-7), DoubleNear(0.12276368151793834, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, false, false, false, false, true, true}), Matrix({ { 0.14118510275292362 + 1.0666069193116747e-20i, -0.014510446678418923 + -0.011430076428427784i, -0.008092669930694574 + -0.027215144119771814i, -0.0013624849213709693 + 0.003461828138299278i, 0.014350000932119984 + 0.00795274731186004i, -0.0007626236180918633 + -0.001975066488609464i, 0.020395521416453323 + 0.011139719700075278i, -0.0011598255716431492 + -0.0028071064873091706i }, { -0.014510446678418923 + 0.011430076428427784i, 0.09703456005523303 + 4.593758747261508e-21i, 0.0030220544237729453 + 0.0021393976160741764i, -0.005510656726122148 + -0.018798073020446397i, -0.00217655251399881 + 0.00038102288580508565i, 0.009724273010452292 + 0.004930149973080753i, -0.0030195975466809637 + 0.0005353720626909119i, 0.013847362266846727 + 0.007418272856840165i }, { -0.008092669930694574 + 0.027215144119771818i, 0.003022054423772946 + -0.0021393976160741764i, 0.14459970141830486 + 4.4595318697023746e-21i, -0.01487782065623438 + -0.011655484926961134i, 0.02908277801913382 + 0.010371205620098016i, -0.00213406515515816 + -0.0034620472509635024i, 0.011045116599892192 + 0.02312423593334212i, 0.0007049948058537261 + -0.0032743977864124318i }, { -0.0013624849213709693 + -0.0034618281382992784i, -0.005510656726122148 + 0.018798073020446397i, -0.01487782065623438 + 0.011655484926961134i, 0.09981440012395501 + 2.9255366391710546e-21i, -0.003816776084606377 + 0.0013313336981569737i, 0.01963005570021771 + 0.007113369304591049i, -0.0029792478028167484 + -0.0014981433414088118i, 0.007642615466236945 + 0.01614730606849444i }, { 0.014350000932119984 + -0.00795274731186004i, -0.00217655251399881 + -0.00038102288580508565i, 0.02908277801913382 + -0.010371205620098016i, -0.003816776084606377 + -0.0013313336981569737i, 0.17496240041449734 + 5.700097114923605e-20i, -0.01797226398278403 + -0.014194677859551516i, 0.022363573762055174 + 0.001594039140358753i, -0.0021610711517487235 + -0.0019087846037916228i }, { -0.0007626236180918632 + 0.001975066488609464i, 0.009724273010452292 + -0.004930149973080753i, -0.00213406515515816 + 0.0034620472509635024i, 0.01963005570021771 + -0.007113369304591049i, -0.01797226398278403 + 0.014194677859551516i, 0.11999418175371954 + 3.975020919802882e-20i, -0.002472502999035405 + 0.0015983023598201973i, 0.015853594560656575 + 0.0008692845176171097i }, { 0.020395521416453323 + -0.011139719700075278i, -0.0030195975466809637 + -0.0005353720626909118i, 0.011045116599892192 + -0.02312423593334212i, -0.002979247802816748 + 0.0014981433414088118i, 0.022363573762055174 + -0.001594039140358753i, -0.002472502999035405 + -0.0015983023598201973i, 0.13169096237581362 + -3.8381180422460635e-22i, -0.013542620903752085 + -0.01063678140196847i }, { -0.0011598255716431492 + 0.0028071064873091706i, 0.013847362266846727 + -0.007418272856840165i, 0.000704994805853726 + 0.0032743977864124318i, 0.007642615466236944 + -0.01614730606849444i, -0.0021610711517487235 + 0.001908784603791623i, 0.015853594560656575 + -0.0008692845176171099i, -0.013542620903752085 + 0.01063678140196847i, 0.09071869110555307 + -2.6469779601696886e-23i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, false, false, false, false, true, true}), ElementsAreArray({ DoubleNear(0.14118510275292362, 1.0e-7), DoubleNear(0.09703456005523303, 1.0e-7), DoubleNear(0.14459970141830486, 1.0e-7), DoubleNear(0.09981440012395501, 1.0e-7), DoubleNear(0.17496240041449734, 1.0e-7), DoubleNear(0.11999418175371954, 1.0e-7), DoubleNear(0.13169096237581362, 1.0e-7), DoubleNear(0.09071869110555307, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, true, true, false, false, false, false, false}), Matrix({ { 0.3113065950945747 + -3.112737549747108e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.036378279048991054 + 0.026900467764900522i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.1919687381803287 + 1.3841047753727301e-19i, 0.0 + 0.0i, 0.03412745338329306 + -0.025262474481396707i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.03412745338329306 + 0.025262474481396707i, 0.0 + 0.0i, 0.2921394609163443 + -6.945008422995222e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.036378279048991054 + -0.026900467764900522i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.2045852058087524 + 8.115277740284052e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, true, true, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.3113065950945747, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.1919687381803287, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.2921394609163443, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.2045852058087524, 1.0e-7), DoubleNear(0.0, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, true, false, true, false, false, false, false}), Matrix({ { 0.30198364621909163 + -2.9377526455933647e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, -0.05339345583211578 + -0.00010889654472084892i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.19907120228636369 + 5.70822867121722e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, -0.03702035017028347 + -0.00028139108480526164i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.05339345583211578 + 0.00010889654472084865i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.30146240979182737 + -7.119993327148965e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, -0.03702035017028347 + 0.0002813910848052614i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.1974827417027174 + 1.6248096822794135e-19i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, true, false, true, false, false, false, false}), ElementsAreArray({ DoubleNear(0.30198364621909163, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.19907120228636369, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.30146240979182737, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.1974827417027174, 1.0e-7), DoubleNear(0.0, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, true, false, false, true, false, false, false}), Matrix({ { 0.30042444943634783 + -4.378043971895139e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, -0.02304331105321168 + 0.0013373295253671013i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.1974369600686326 + 1.062070351682711e-19i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, -0.015151162365296511 + 0.0008900171367416356i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.02304331105321168 + -0.0013373295253671013i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.30302160657457117 + -5.679702000847192e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, -0.015151162365296511 + -0.0008900171367416356i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.1991169839204485 + 1.1335621977184244e-19i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, true, false, false, true, false, false, false}), ElementsAreArray({ DoubleNear(0.30042444943634783, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.1974369600686326, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.30302160657457117, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.1991169839204485, 1.0e-7), DoubleNear(0.0, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, true, false, false, false, true, false, false}), Matrix({ { 0.246764908425675 + -4.5785015951910744e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.025960386341690025 + -0.014547821351221908i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.1621419637285087 + 8.017339555757774e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.017059876724082764 + -0.009546013144331553i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.025960386341690025 + 0.014547821351221906i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.35668114758524394 + -5.479244377551255e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.017059876724082764 + 0.009546013144331553i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.23441198026057236 + 1.393898593825358e-19i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, true, false, false, false, true, false, false}), ElementsAreArray({ DoubleNear(0.246764908425675, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.1621419637285087, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.35668114758524394, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.23441198026057236, 1.0e-7), DoubleNear(0.0, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, true, false, false, false, false, true, false}), Matrix({ { 0.32160761087824713 + -6.924225819044429e-21i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.014995599377487515 + -0.026376027872700474i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.21156863409812637 + 1.1893523410668754e-19i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.009618242288407512 + -0.017173865609541875i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.014995599377487515 + 0.026376027872700474i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.28183844513267187 + -9.365323390837887e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.009618242288407514 + 0.017173865609541875i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.1849853098909547 + 1.0062802083342599e-19i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, true, false, false, false, false, true, false}), ElementsAreArray({ DoubleNear(0.32160761087824713, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.21156863409812637, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.28183844513267187, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.1849853098909547, 1.0e-7), DoubleNear(0.0, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, true, false, false, false, false, false, true}), Matrix({ { 0.2912867951899032 + -6.362264877075406e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.025850379736109524 + 0.03141298065697541i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.1913469691605133 + 8.626754522000574e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.01691162627259189 + 0.020741458629801944i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.02585037973610952 + -0.03141298065697541i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.3121592608210158 + -3.695481095666923e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.01691162627259189 + -0.020741458629801944i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.20520697482856776 + 1.332957097201078e-19i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, true, false, false, false, false, false, true}), ElementsAreArray({ DoubleNear(0.2912867951899032, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.1913469691605133, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.3121592608210158, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.20520697482856776, 1.0e-7), DoubleNear(0.0, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, true, true, false, false, false, false}), Matrix({ { 0.2516037527729659 + 1.5085085830016697e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, -0.04545100613591784 + 0.0001462403393556664i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.24945109573248936 + 1.2619674426221856e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, -0.04496279986648141 + -0.000536527968881777i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.04545100613591784 + -0.00014624033935566673i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.25167158050193744 + 9.219801620978524e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, -0.04496279986648141 + 0.0005365279688817766i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.24727357099260733 + -9.169812533335448e-22i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, true, true, false, false, false, false}), ElementsAreArray({ DoubleNear(0.2516037527729659, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.24945109573248936, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.25167158050193744, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.24727357099260733, 1.0e-7), DoubleNear(0.0, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, true, false, true, false, false, false}), Matrix({ { 0.25093150294829614 + 4.9483855044260605e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, -0.019426468779546874 + 0.0014614021819846497i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.24692990655668426 + 1.2942740405059109e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, -0.018768004638961316 + 0.0007659444801240873i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.019426468779546874 + -0.0014614021819846497i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.25234383032660723 + 5.779924699554133e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, -0.018768004638961316 + -0.0007659444801240873i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.24979476016841246 + -1.2400472321707934e-21i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, true, false, true, false, false, false}), ElementsAreArray({ DoubleNear(0.25093150294829614, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.24692990655668426, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.25234383032660723, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.24979476016841246, 1.0e-7), DoubleNear(0.0, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, true, false, false, true, false, false}), Matrix({ { 0.2068613138979894 + 5.095541104739095e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.02386222560237168 + -0.01994501441828306i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.20204555825619433 + -1.656703144172394e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.019158037463401112 + -0.004148820077270399i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.02386222560237168 + 0.01994501441828306i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.29641401937691403 + 5.632769099241097e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.019158037463401112 + 0.0041488200772703985i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.2946791084689024 + 2.826972461461225e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, true, false, false, true, false, false}), ElementsAreArray({ DoubleNear(0.2068613138979894, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.20204555825619433, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.29641401937691403, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.2946791084689024, 1.0e-7), DoubleNear(0.0, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, true, false, false, false, true, false}), Matrix({ { 0.26836335441959047 + 1.4545567790302414e-19i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.012352961230091001 + -0.021900585542682798i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.26481289055678303 + -3.3444669615381006e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.01226088043580403 + -0.021649307939559555i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.012352961230091001 + 0.021900585542682798i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.2349119788553129 + -3.81725758632222e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.012260880435804034 + 0.021649307939559555i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.2319117761683137 + 4.5147362788269314e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, true, false, false, false, true, false}), ElementsAreArray({ DoubleNear(0.26836335441959047, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.26481289055678303, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.2349119788553129, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.2319117761683137, 1.0e-7), DoubleNear(0.0, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, true, false, false, false, false, true}), Matrix({ { 0.24287543903437556 + 4.457257535118195e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0215450087878762 + 0.026273225872800555i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.23975832531604097 + -2.1927678901930266e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.021216997220825214 + 0.025881213413976804i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0215450087878762 + -0.02627322587280056i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.26039989424052784 + 6.271052668861998e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.021216997220825214 + -0.025881213413976797i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.2569663414090557 + 3.3630372074818574e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, true, false, false, false, false, true}), ElementsAreArray({ DoubleNear(0.24287543903437556, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.23975832531604097, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.26039989424052784, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.2569663414090557, 1.0e-7), DoubleNear(0.0, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, false, true, true, false, false, false}), Matrix({ { 0.24609621272717727 + 1.5002386193545483e-20i, 0.0 + 0.0i, -0.045013544895064345 + 0.0010487450735805772i, 0.0 + 0.0i, -0.01705476208804032 + -0.0017011678282162917i, 0.0 + 0.0i, 0.0024118333391907327 + -0.0009570862664675986i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.045013544895064345 + -0.0010487450735805774i, 0.0 + 0.0i, 0.2517651967778031 + 4.742420925577423e-20i, 0.0 + 0.0i, 0.004494782080858856 + 0.0005543204884516165i, 0.0 + 0.0i, -0.02113971133046787 + 0.003928514490325028i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.01705476208804032 + 0.0017011678282162917i, 0.0 + 0.0i, 0.004494782080858856 + -0.0005543204884516165i, 0.0 + 0.0i, 0.25495863577827804 + 1.270237406269307e-20i, 0.0 + 0.0i, -0.0454002611073349 + -0.0014390327031066875i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0024118333391907323 + 0.0009570862664675986i, 0.0 + 0.0i, -0.02113971133046787 + -0.003928514490325028i, 0.0 + 0.0i, -0.0454002611073349 + 0.0014390327031066873i, 0.0 + 0.0i, 0.24717995471674165 + 4.3856825700677465e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, false, true, true, false, false, false}), ElementsAreArray({ DoubleNear(0.24609621272717727, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.2517651967778031, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.25495863577827804, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.24717995471674165, 1.0e-7), DoubleNear(0.0, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, false, true, false, true, false, false}), Matrix({ { 0.20975211680616965 + 2.7387122901018193e-20i, 0.0 + 0.0i, -0.03697082661199624 + -0.001960480135936598i, 0.0 + 0.0i, 0.02154644591385624 + -0.015614430094544444i, 0.0 + 0.0i, -0.005209584106454888 + 0.00216497917446303i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.03697082661199624 + 0.0019604801359365976i, 0.0 + 0.0i, 0.19915475534801405 + 7.001256704648822e-21i, 0.0 + 0.0i, -0.0025696673315470375 + 0.0021918513814067407i, 0.0 + 0.0i, 0.021473817151916548 + -0.008479404401009017i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.02154644591385624 + 0.015614430094544447i, 0.0 + 0.0i, -0.0025696673315470375 + -0.0021918513814067407i, 0.0 + 0.0i, 0.2913027316992856 + 3.1763735522036263e-22i, 0.0 + 0.0i, -0.05344297939040301 + 0.001570192506410487i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.005209584106454888 + -0.00216497917446303i, 0.0 + 0.0i, 0.021473817151916548 + 0.008479404401009015i, 0.0 + 0.0i, -0.05344297939040301 + -0.0015701925064104875i, 0.0 + 0.0i, 0.2997903961465307 + 8.427977825180287e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, false, true, false, true, false, false}), ElementsAreArray({ DoubleNear(0.20975211680616965, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.19915475534801405, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.2913027316992856, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.2997903961465307, 1.0e-7), DoubleNear(0.0, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, false, true, false, false, true, false}), Matrix({ { 0.2662915377562004 + 5.491569368678295e-20i, 0.0 + 0.0i, -0.048411162173313274 + -0.001335568414376899i, 0.0 + 0.0i, 0.013286315016794534 + -0.02256482999840119i, 0.0 + 0.0i, -0.0008649658178110703 + 0.004962310161721873i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.048411162173313274 + 0.0013355684143768985i, 0.0 + 0.0i, 0.2668847072201731 + 5.709531460086017e-20i, 0.0 + 0.0i, -0.003238060644199783 + 0.0025393167568603073i, 0.0 + 0.0i, 0.011327526649100497 + -0.02098506348384116i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.013286315016794534 + 0.02256482999840119i, 0.0 + 0.0i, -0.003238060644199783 + -0.0025393167568603073i, 0.0 + 0.0i, 0.23476331074925488 + -2.72109334305444e-20i, 0.0 + 0.0i, -0.04200264382908597 + 0.0009452807848507885i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.0008649658178110703 + -0.004962310161721873i, 0.0 + 0.0i, 0.011327526649100497 + 0.02098506348384116i, 0.0 + 0.0i, -0.04200264382908597 + -0.0009452807848507887i, 0.0 + 0.0i, 0.23206044427437167 + 3.418572035559153e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, false, true, false, false, true, false}), ElementsAreArray({ DoubleNear(0.2662915377562004, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.2668847072201731, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.23476331074925488, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.23206044427437167, 1.0e-7), DoubleNear(0.0, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, false, true, false, false, false, true}), Matrix({ { 0.24175823311776545 + -1.393633896029341e-20i, 0.0 + 0.0i, -0.04371996874275967 + -0.0009398082757765282i, 0.0 + 0.0i, 0.02253116200043958 + 0.026000878509465978i, 0.0 + 0.0i, -0.0037627674558473163 + -0.0015968566522930657i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.04371996874275967 + 0.0009398082757765276i, 0.0 + 0.0i, 0.240875531232651 + 3.6581235409545096e-20i, 0.0 + 0.0i, -0.003065127937717965 + -0.0077340269770742945i, 0.0 + 0.0i, 0.020230844008261833 + 0.026153560777311374i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.02253116200043958 + -0.026000878509465978i, 0.0 + 0.0i, -0.003065127937717965 + 0.007734026977074295i, 0.0 + 0.0i, 0.25929661538768983 + 4.1641099216531966e-20i, 0.0 + 0.0i, -0.046693837259639576 + 0.0005495206462504177i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.0037627674558473163 + 0.0015968566522930655i, 0.0 + 0.0i, 0.020230844008261833 + -0.026153560777311374i, 0.0 + 0.0i, -0.046693837259639576 + -0.0005495206462504177i, 0.0 + 0.0i, 0.25806962026189373 + 5.46997995469066e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, false, true, false, false, false, true}), ElementsAreArray({ DoubleNear(0.24175823311776545, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.240875531232651, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.25929661538768983, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.25806962026189373, 1.0e-7), DoubleNear(0.0, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, false, false, true, true, false, false}), Matrix({ { 0.20033780448534938 + 2.1222436172544528e-20i, 0.0 + 0.0i, -0.01368510496263486 + -0.00180982532880254i, 0.0 + 0.0i, 0.021579913145409146 + -0.009613968031362663i, 0.0 + 0.0i, -0.0034078940727108728 + -0.00013933042313546054i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.01368510496263486 + 0.00180982532880254i, 0.0 + 0.0i, 0.20856906766883432 + 1.3165943433122486e-20i, 0.0 + 0.0i, 0.0004907469677430689 + -0.0007777815247532002i, 0.0 + 0.0i, 0.021440349920363647 + -0.014479866464190796i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.021579913145409146 + 0.009613968031362665i, 0.0 + 0.0i, 0.0004907469677430689 + 0.0007777815247532i, 0.0 + 0.0i, 0.29752360501963104 + 4.1204159276775185e-20i, 0.0 + 0.0i, -0.024509368455873332 + 0.0040371719909112775i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.0034078940727108728 + 0.00013933042313546054i, 0.0 + 0.0i, 0.021440349920363647 + 0.014479866464190794i, 0.0 + 0.0i, -0.024509368455873332 + -0.004037171990911277i, 0.0 + 0.0i, 0.2935695228261853 + 4.3393256330248055e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, false, false, true, true, false, false}), ElementsAreArray({ DoubleNear(0.20033780448534938, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.20856906766883432, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.29752360501963104, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.2935695228261853, 1.0e-7), DoubleNear(0.0, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, false, false, true, false, true, false}), Matrix({ { 0.265689687349141 + 5.808125604050771e-20i, 0.0 + 0.0i, -0.020514292206978035 + 0.0013903347512230345i, 0.0 + 0.0i, 0.011979119097246919 + -0.021523123583145072i, 0.0 + 0.0i, -0.0008055946815361088 + 0.0013890795690957212i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.020514292206978035 + -0.0013903347512230345i, 0.0 + 0.0i, 0.2674865576272325 + 5.392975224713541e-20i, 0.0 + 0.0i, -0.0007334658066144 + 0.0017408993906666901i, 0.0 + 0.0i, 0.012634722568648116 + -0.022026769899097284i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.011979119097246919 + 0.021523123583145072i, 0.0 + 0.0i, -0.0007334658066144 + -0.0017408993906666904i, 0.0 + 0.0i, 0.23217172215583942 + 4.345339408811997e-21i, 0.0 + 0.0i, -0.017680181211530158 + 0.0008370119108857025i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.0008055946815361091 + -0.001389079569095721i, 0.0 + 0.0i, 0.012634722568648116 + 0.022026769899097284i, 0.0 + 0.0i, -0.017680181211530158 + -0.0008370119108857024i, 0.0 + 0.0i, 0.23465203286778716 + 2.629447516235128e-21i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, false, false, true, false, true, false}), ElementsAreArray({ DoubleNear(0.265689687349141, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.2674865576272325, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.23217172215583942, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.23465203286778716, 1.0e-7), DoubleNear(0.0, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, false, false, true, false, false, true}), Matrix({ { 0.24015578946508853 + 1.1699294356550301e-20i, 0.0 + 0.0i, -0.01835401036310392 + 0.0009668748264876221i, 0.0 + 0.0i, 0.021343717068764194 + 0.026123653290912267i, 0.0 + 0.0i, -0.0019154804694671563 + -0.0019492779468456543i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.01835401036310392 + -0.0009668748264876221i, 0.0 + 0.0i, 0.24247797488532796 + 1.0945602092701383e-20i, 0.0 + 0.0i, -0.001418220825360836 + -0.0022306071313626117i, 0.0 + 0.0i, 0.02141828893993722 + 0.02603078599586509i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.021343717068764194 + -0.026123653290912263i, 0.0 + 0.0i, -0.001418220825360836 + 0.0022306071313626117i, 0.0 + 0.0i, 0.25770562003989184 + 5.072730109276941e-20i, 0.0 + 0.0i, -0.019840463055404274 + 0.0012604718356211148i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.0019154804694671563 + 0.0019492779468456543i, 0.0 + 0.0i, 0.02141828893993722 + -0.02603078599586509i, 0.0 + 0.0i, -0.019840463055404274 + -0.0012604718356211148i, 0.0 + 0.0i, 0.25966061560969167 + 4.561359767066916e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, false, false, true, false, false, true}), ElementsAreArray({ DoubleNear(0.24015578946508853, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.24247797488532796, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.25770562003989184, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.25966061560969167, 1.0e-7), DoubleNear(0.0, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, false, false, false, true, true, false}), Matrix({ { 0.21766910493238711 + 2.701654598659443e-20i, 0.0 + 0.0i, 0.022938034804349933 + -0.012591318838418138i, 0.0 + 0.0i, 0.01046341423235219 + -0.01803775142475871i, 0.0 + 0.0i, -0.0001584373353289356 + -0.0027562462761626908i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.022938034804349933 + 0.012591318838418138i, 0.0 + 0.0i, 0.3155071400439864 + 8.49944623010487e-20i, 0.0 + 0.0i, 0.002274740261146596 + -0.0009899530874394077i, 0.0 + 0.0i, 0.01415042743354284 + -0.025512142057483644i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.01046341423235219 + 0.01803775142475871i, 0.0 + 0.0i, 0.002274740261146596 + 0.0009899530874394077i, 0.0 + 0.0i, 0.19123776722179664 + 7.371833619072581e-21i, 0.0 + 0.0i, 0.020082228261422856 + -0.011502515657135323i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.0001584373353289354 + 0.0027562462761626908i, 0.0 + 0.0i, 0.01415042743354284 + 0.025512142057483644i, 0.0 + 0.0i, 0.020082228261422856 + 0.011502515657135323i, 0.0 + 0.0i, 0.27558598780182997 + -3.970466940254563e-22i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, false, false, false, true, true, false}), ElementsAreArray({ DoubleNear(0.21766910493238711, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.3155071400439864, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.19123776722179664, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.27558598780182997, 1.0e-7), DoubleNear(0.0, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, false, false, false, true, false, true}), Matrix({ { 0.19753906151877898 + 2.0447904742310844e-20i, 0.0 + 0.0i, 0.020762683592673442 + -0.01176443632359872i, 0.0 + 0.0i, 0.017407206716216185 + 0.02109744689549235i, 0.0 + 0.0i, 0.0029298305335350838 + 0.0012709289971867027i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.020762683592673442 + 0.01176443632359872i, 0.0 + 0.0i, 0.2850947028316375 + 2.1969917069408415e-21i, 0.0 + 0.0i, 0.0007497272694178245 + 0.003217318913594565i, 0.0 + 0.0i, 0.025354799292485228 + 0.03105699239128501i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.017407206716216185 + -0.021097446895492346i, 0.0 + 0.0i, 0.0007497272694178246 + -0.003217318913594565i, 0.0 + 0.0i, 0.21136781063540477 + 1.394047486335617e-20i, 0.0 + 0.0i, 0.022257579473099347 + -0.01232939817195474i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.0029298305335350838 + -0.0012709289971867027i, 0.0 + 0.0i, 0.025354799292485228 + -0.031056992391285006i, 0.0 + 0.0i, 0.022257579473099347 + 0.01232939817195474i, 0.0 + 0.0i, 0.3059984250141788 + 8.24004239000824e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, false, false, false, true, false, true}), ElementsAreArray({ DoubleNear(0.19753906151877898, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.2850947028316375, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.21136781063540477, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.3059984250141788, 1.0e-7), DoubleNear(0.0, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, false, false, false, false, true, true}), Matrix({ { 0.23821966280815665 + 1.5259827940378255e-20i, 0.0 + 0.0i, -0.013603326656816721 + -0.046013217140218214i, 0.0 + 0.0i, 0.024074273942572277 + 0.012882897284940796i, 0.0 + 0.0i, 0.03424288368330004 + 0.018557992556915443i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { -0.013603326656816721 + 0.046013217140218214i, 0.0 + 0.0i, 0.24441410154225987 + 7.38506850887343e-21i, 0.0 + 0.0i, 0.048712833719351534 + 0.017484574924689064i, 0.0 + 0.0i, 0.018687732066129135 + 0.039271542001836565i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.024074273942572277 + -0.012882897284940794i, 0.0 + 0.0i, 0.048712833719351534 + -0.017484574924689064i, 0.0 + 0.0i, 0.29495658216821685 + 9.675118034726488e-20i, 0.0 + 0.0i, 0.038217168322711756 + 0.002463323657975863i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i }, { 0.03424288368330004 + -0.018557992556915443i, 0.0 + 0.0i, 0.018687732066129135 + -0.03927154200183656i, 0.0 + 0.0i, 0.038217168322711756 + -0.002463323657975863i, 0.0 + 0.0i, 0.2224096534813667 + -4.1028158382630474e-22i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, false, false, false, false, true, true}), ElementsAreArray({ DoubleNear(0.23821966280815665, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.24441410154225987, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.29495658216821685, 1.0e-7), DoubleNear(0.0, 1.0e-7), DoubleNear(0.2224096534813667, 1.0e-7), DoubleNear(0.0, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, true, true, false, false, false, false}), Matrix({ { 0.15420211024555375 + -1.434930908707024e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.01790904648745577 + 0.013405039967349663i, -0.02753719858536808 + 0.0005975421335171081i, 0.0 + 0.0i, 0.0 + 0.0i, -0.0022734603481324002 + -0.0016640605041228901i }, { 0.0 + 0.0i, 0.09740164252741217 + 2.9434394917086937e-20i, 0.01711611217204134 + -0.012747737908083971i, 0.0 + 0.0i, 0.0 + 0.0i, -0.017913807550549762 + -0.00045130179416144167i, -0.0021815647950576386 + 0.0014967976418700023i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.017116112172041335 + 0.012747737908083971i, 0.14778153597353788 + -1.5028217368863407e-20i, 0.0 + 0.0i, 0.0 + 0.0i, -0.0017892841751876655 + -0.0018887208782776914i, -0.0258562572467477 + -0.0007064386782379571i, 0.0 + 0.0i }, { 0.017909046487455775 + -0.013405039967349663i, 0.0 + 0.0i, 0.0 + 0.0i, 0.1016695597589515 + 2.7647891795085266e-20i, -0.001893493819541215 + 0.001989016988920206i, 0.0 + 0.0i, 0.0 + 0.0i, -0.01910654261973371 + 0.00016991070935618006i }, { -0.02753719858536808 + -0.0005975421335171083i, 0.0 + 0.0i, 0.0 + 0.0i, -0.001893493819541215 + -0.001989016988920206i, 0.1571044848490209 + -1.6778066410400844e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.01846923256153528 + 0.01349542779755086i }, { 0.0 + 0.0i, -0.017913807550549762 + 0.00045130179416144156i, -0.0017892841751876653 + 0.0018887208782776917i, 0.0 + 0.0i, 0.0 + 0.0i, 0.09456709565291652 + 1.0897608262018608e-19i, 0.017011341211251724 + -0.012514736573312738i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.0021815647950576386 + -0.0014967976418700023i, -0.0258562572467477 + 0.0007064386782379569i, 0.0 + 0.0i, 0.0 + 0.0i, 0.017011341211251724 + 0.01251473657331274i, 0.14435792494280644 + -5.442186686108881e-20i, 0.0 + 0.0i }, { -0.0022734603481324 + 0.0016640605041228905i, 0.0 + 0.0i, 0.0 + 0.0i, -0.01910654261973371 + -0.00016991070935618016i, 0.018469232561535282 + -0.01349542779755086i, 0.0 + 0.0i, 0.0 + 0.0i, 0.10291564604980089 + 5.3504885607755264e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, true, true, false, false, false, false}), ElementsAreArray({ DoubleNear(0.15420211024555375, 1.0e-7), DoubleNear(0.09740164252741217, 1.0e-7), DoubleNear(0.14778153597353788, 1.0e-7), DoubleNear(0.1016695597589515, 1.0e-7), DoubleNear(0.1571044848490209, 1.0e-7), DoubleNear(0.09456709565291652, 1.0e-7), DoubleNear(0.14435792494280644, 1.0e-7), DoubleNear(0.10291564604980089, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, true, false, true, false, false, false}), Matrix({ { 0.15608679665598138 + -1.43698444632997e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.018234791545487745 + 0.013484833842580844i, -0.012454839426543131 + 0.0016924983370083051i, 0.0 + 0.0i, 0.0 + 0.0i, -0.0016055660059999348 + -0.0008705811797653953i }, { 0.0 + 0.0i, 0.09484470629231476 + 6.385369950756031e-20i, 0.01687364277159019 + -0.012472294276395669i, 0.0 + 0.0i, 0.0 + 0.0i, -0.006971629353003744 + -0.00023109615502365542i, -0.0012596757378038042 + 0.0008813305161567153i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.01687364277159019 + 0.012472294276395669i, 0.14433765278036642 + -2.941059525565168e-20i, 0.0 + 0.0i, 0.0 + 0.0i, -0.0011967624240188704 + -0.0009514611024614149i, -0.010588471626668549 + -0.00035516881164120373i, 0.0 + 0.0i }, { 0.018234791545487742 + -0.013484833842580844i, 0.0 + 0.0i, 0.0 + 0.0i, 0.10259225377631784 + 4.2353335660710795e-20i, -0.001331728854133957 + 0.0012654442285875592i, 0.0 + 0.0i, 0.0 + 0.0i, -0.008179533012292768 + 0.0011211132917652912i }, { -0.012454839426543131 + -0.0016924983370083051i, 0.0 + 0.0i, 0.0 + 0.0i, -0.001331728854133957 + -0.0012654442285875592i, 0.15521979843859326 + -1.6757531034171383e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.018143487503503312 + 0.013415633922319679i }, { 0.0 + 0.0i, -0.006971629353003744 + 0.00023109615502365542i, -0.0011967624240188704 + 0.0009514611024614148i, 0.0 + 0.0i, 0.0 + 0.0i, 0.09712403188801394 + 7.455677802971271e-20i, 0.01725381061170287 + -0.01279018020500104i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.0012596757378038042 + -0.0008813305161567153i, -0.010588471626668549 + 0.00035516881164120373i, 0.0 + 0.0i, 0.0 + 0.0i, 0.01725381061170287 + 0.01279018020500104i, 0.1478018081359779 + -4.003948897430053e-20i, 0.0 + 0.0i }, { -0.0016055660059999348 + 0.0008705811797653954i, 0.0 + 0.0i, 0.0 + 0.0i, -0.008179533012292768 + -0.0011211132917652912i, 0.018143487503503312 + -0.013415633922319679i, 0.0 + 0.0i, 0.0 + 0.0i, 0.10199295203243455 + 3.879944174212974e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, true, false, true, false, false, false}), ElementsAreArray({ DoubleNear(0.15608679665598138, 1.0e-7), DoubleNear(0.09484470629231476, 1.0e-7), DoubleNear(0.14433765278036642, 1.0e-7), DoubleNear(0.10259225377631784, 1.0e-7), DoubleNear(0.15521979843859326, 1.0e-7), DoubleNear(0.09712403188801394, 1.0e-7), DoubleNear(0.1478018081359779, 1.0e-7), DoubleNear(0.10199295203243455, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, true, false, false, true, false, false}), Matrix({ { 0.1304088273140946 + 8.894931260294602e-21i, 0.0 + 0.0i, 0.0 + 0.0i, 0.015232102349657196 + 0.011280512117451354i, 0.019840416329542657 + -0.030330266572238557i, 0.0 + 0.0i, 0.0 + 0.0i, 0.004940118942493635 + -0.0018285349653854332i }, { 0.0 + 0.0i, 0.07645248658389481 + 4.206047978709635e-20i, 0.013588975099457912 + -0.010067799954405952i, 0.0 + 0.0i, 0.0 + 0.0i, 0.004021809272829023 + 0.010385252153955499i, 0.002066819907640843 + 0.0013226045591124616i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.013588975099457912 + 0.010067799954405952i, 0.11635608111158043 + -5.467994721220534e-20i, 0.0 + 0.0i, 0.0 + 0.0i, -0.0006366391115454902 + 0.0023805063722829203i, 0.0061199700121473705 + 0.015782445221016652i, 0.0 + 0.0i }, { 0.015232102349657193 + -0.011280512117451354i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0856894771446139 + 3.8112915770481406e-20i, -0.00030391515066497494 + -0.005258691136024181i, 0.0 + 0.0i, 0.0 + 0.0i, 0.013038067451253741 + -0.01993126529828705i }, { 0.019840416329542657 + 0.030330266572238557i, 0.0 + 0.0i, 0.0 + 0.0i, -0.00030391515066497505 + 0.005258691136024181i, 0.1808977677804801 + -4.0022306757765685e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.02114617669933386 + 0.015619955647449169i }, { 0.0 + 0.0i, 0.004021809272829023 + -0.010385252153955497i, -0.0006366391115454902 + -0.0023805063722829203i, 0.0 + 0.0i, 0.0 + 0.0i, 0.11551625159643389 + 9.634999775017666e-20i, 0.02053847828383515 + -0.015194674526990757i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0020668199076408432 + -0.0013226045591124616i, 0.0061199700121473705 + -0.015782445221016652i, 0.0 + 0.0i, 0.0 + 0.0i, 0.02053847828383515 + 0.015194674526990755i, 0.17578337980476388 + -1.477013701774687e-20i, 0.0 + 0.0i }, { 0.004940118942493635 + 0.0018285349653854332i, 0.0 + 0.0i, 0.0 + 0.0i, 0.013038067451253741 + 0.01993126529828705i, 0.02114617669933386 + -0.01561995564744917i, 0.0 + 0.0i, 0.0 + 0.0i, 0.1188957286641385 + 4.3039861632359124e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, true, false, false, true, false, false}), ElementsAreArray({ DoubleNear(0.1304088273140946, 1.0e-7), DoubleNear(0.07645248658389481, 1.0e-7), DoubleNear(0.11635608111158043, 1.0e-7), DoubleNear(0.0856894771446139, 1.0e-7), DoubleNear(0.1808977677804801, 1.0e-7), DoubleNear(0.11551625159643389, 1.0e-7), DoubleNear(0.17578337980476388, 1.0e-7), DoubleNear(0.1188957286641385, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, true, false, false, false, true, false}), Matrix({ { 0.1660222166859359 + 3.4838468947532846e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.019419863446496897 + 0.014229518557608626i, 0.007609172219502324 + -0.013535038220738335i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0021117098737501666 + -0.0007829262786365413i }, { 0.0 + 0.0i, 0.1023411377336546 + 1.1061720895549128e-19i, 0.018204567089620417 + -0.013355162946415703i, 0.0 + 0.0i, 0.0 + 0.0i, 0.004743789010588675 + -0.008365547321944462i, -0.0003647349452717734 + -0.0022303602128207036i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.018204567089620417 + 0.013355162946415703i, 0.15558539419231127 + -4.176269476657727e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0020016241359143566 + -0.0007336560581786842i, 0.007386427157985194 + -0.012840989651962141i, 0.0 + 0.0i }, { 0.019419863446496897 + -0.014229518557608626i, 0.0 + 0.0i, 0.0 + 0.0i, 0.10922749636447178 + 8.318025151196273e-21i, -0.00040911730681653037 + -0.0023630302227565635i, 0.0 + 0.0i, 0.0 + 0.0i, 0.00487445327781884 + -0.008808318287597415i }, { 0.007609172219502323 + 0.013535038220738335i, 0.0 + 0.0i, 0.0 + 0.0i, -0.0004091173068165297 + 0.0023630302227565635i, 0.14528437840863878 + -6.596584444500393e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.016958415602494156 + 0.012670949207291896i }, { 0.0 + 0.0i, 0.004743789010588675 + 0.008365547321944462i, 0.0020016241359143566 + 0.0007336560581786842i, 0.0 + 0.0i, 0.0 + 0.0i, 0.08962760044667412 + 2.779326858178173e-20i, 0.015922886293672646 + -0.011907311534981004i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.0003647349452717734 + 0.002230360212820703i, 0.007386427157985194 + 0.012840989651962141i, 0.0 + 0.0i, 0.0 + 0.0i, 0.015922886293672646 + 0.011907311534981004i, 0.13655406672403306 + -2.768738946337494e-20i, 0.0 + 0.0i }, { 0.0021117098737501666 + 0.0007829262786365409i, 0.0 + 0.0i, 0.0 + 0.0i, 0.00487445327781884 + 0.008808318287597415i, 0.016958415602494156 + -0.012670949207291896i, 0.0 + 0.0i, 0.0 + 0.0i, 0.09535770944428063 + 7.283475225164426e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, true, false, false, false, true, false}), ElementsAreArray({ DoubleNear(0.1660222166859359, 1.0e-7), DoubleNear(0.1023411377336546, 1.0e-7), DoubleNear(0.15558539419231127, 1.0e-7), DoubleNear(0.10922749636447178, 1.0e-7), DoubleNear(0.14528437840863878, 1.0e-7), DoubleNear(0.08962760044667412, 1.0e-7), DoubleNear(0.13655406672403306, 1.0e-7), DoubleNear(0.09535770944428063, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, true, false, false, false, false, true}), Matrix({ { 0.150207391168592 + -9.836056620105997e-21i, 0.0 + 0.0i, 0.0 + 0.0i, 0.01751952180125707 + 0.013001566502256624i, 0.013368082486604503 + 0.016280466204215534i, 0.0 + 0.0i, 0.0 + 0.0i, 0.00026775940828375626 + 0.0031695403132756318i }, { 0.0 + 0.0i, 0.09266804786578356 + 5.440863197128795e-20i, 0.016453537733681453 + -0.012228118997601336i, 0.0 + 0.0i, 0.0 + 0.0i, 0.008176926301271696 + 0.00999275966858502i, 0.0027632327445522697 + 0.0006838402295235653i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.016453537733681453 + 0.012228118997601336i, 0.1410794040213112 + -5.378659215064807e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.00023361572409200744 + 0.0029201484287480514i, 0.01248229724950502 + 0.015132514452759876i, 0.0 + 0.0i }, { 0.01751952180125707 + -0.013001566502256624i, 0.0 + 0.0i, 0.0 + 0.0i, 0.09867892129472977 + 3.1858913248717806e-20i, 0.002993155240143503 + 0.0007140455013256962i, 0.0 + 0.0i, 0.0 + 0.0i, 0.008734699971320193 + 0.010748698961216923i }, { 0.013368082486604503 + -0.016280466204215534i, 0.0 + 0.0i, 0.0 + 0.0i, 0.0029931552401435027 + -0.0007140455013256961i, 0.16109920392598268 + -2.1291318877365084e-20i, 0.0 + 0.0i, 0.0 + 0.0i, 0.018858757247733983 + 0.013898901262643898i }, { 0.0 + 0.0i, 0.008176926301271696 + -0.00999275966858502i, 0.00023361572409200728 + -0.002920148428748051i, 0.0 + 0.0i, 0.0 + 0.0i, 0.09930069031454514 + 8.400184556598507e-20i, 0.017673915649611606 + -0.013034355483795373i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0027632327445522692 + -0.0006838402295235651i, 0.01248229724950502 + -0.015132514452759876i, 0.0 + 0.0i, 0.0 + 0.0i, 0.017673915649611606 + 0.013034355483795371i, 0.1510600568950331 + -1.566349207930414e-20i, 0.0 + 0.0i }, { 0.0002677594082837559 + -0.003169540313275632i, 0.0 + 0.0i, 0.0 + 0.0i, 0.008734699971320193 + -0.010748698961216923i, 0.018858757247733983 + -0.0138989012626439i, 0.0 + 0.0i, 0.0 + 0.0i, 0.10590628451402263 + 4.9293864154122724e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, true, false, false, false, false, true}), ElementsAreArray({ DoubleNear(0.150207391168592, 1.0e-7), DoubleNear(0.09266804786578356, 1.0e-7), DoubleNear(0.1410794040213112, 1.0e-7), DoubleNear(0.09867892129472977, 1.0e-7), DoubleNear(0.16109920392598268, 1.0e-7), DoubleNear(0.09930069031454514, 1.0e-7), DoubleNear(0.1510600568950331, 1.0e-7), DoubleNear(0.10590628451402263, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, false, true, true, false, false, false}), Matrix({ { 0.14830746355705288 + -1.2273430812438468e-20i, 0.0 + 0.0i, -0.026572215529398032 + 0.0007845660153409399i, 0.0 + 0.0i, -0.010270348214398501 + -0.001036763732078591i, 0.0 + 0.0i, 0.001329829243814619 + -0.0006260962640116833i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0977887491701244 + 2.7275817005983954e-20i, 0.0 + 0.0i, -0.018441329365666313 + 0.0002641790582396371i, 0.0 + 0.0i, -0.006784413873641822 + -0.0006644040961377007i, 0.0 + 0.0i, 0.0010820040953761134 + -0.00033099000245591533i }, { -0.026572215529398032 + -0.0007845660153409401i, 0.0 + 0.0i, 0.15211698587929495 + -3.1507008906512915e-20i, 0.0 + 0.0i, 0.002736038195507562 + 0.0004055616165751485i, 0.0 + 0.0i, -0.012772962838813181 + 0.0023740932574456922i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.018441329365666313 + -0.00026417905823963725i, 0.0 + 0.0i, 0.0996482108985082 + 7.893121816228715e-20i, 0.0 + 0.0i, 0.001758743885351295 + 0.00014875887187646802i, 0.0 + 0.0i, -0.00836674849165469 + 0.0015544212328793363i }, { -0.010270348214398501 + 0.001036763732078591i, 0.0 + 0.0i, 0.002736038195507562 + -0.00040556161657514855i, 0.0 + 0.0i, 0.15367618266203875 + -1.710409564349518e-20i, 0.0 + 0.0i, -0.026821240302717746 + -0.0008934625600617889i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.006784413873641822 + 0.0006644040961377007i, 0.0 + 0.0i, 0.001758743885351295 + -0.00014875887187646802i, 0.0 + 0.0i, 0.10128245311623928 + 2.980646970618825e-20i, 0.0 + 0.0i, -0.01857902080461716 + -0.0005455701430448987i }, { 0.001329829243814619 + 0.0006260962640116833i, 0.0 + 0.0i, -0.012772962838813181 + -0.0023740932574456922i, 0.0 + 0.0i, -0.026821240302717746 + 0.0008934625600617888i, 0.0 + 0.0i, 0.14934542391253242 + -3.9692924364976735e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0010820040953761134 + 0.00033099000245591533i, 0.0 + 0.0i, -0.00836674849165469 + -0.0015544212328793363i, 0.0 + 0.0i, -0.01857902080461716 + 0.0005455701430448985i, 0.0 + 0.0i, 0.09783453080420923 + 8.35497500656542e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, false, true, true, false, false, false}), ElementsAreArray({ DoubleNear(0.14830746355705288, 1.0e-7), DoubleNear(0.0977887491701244, 1.0e-7), DoubleNear(0.15211698587929495, 1.0e-7), DoubleNear(0.0996482108985082, 1.0e-7), DoubleNear(0.15367618266203875, 1.0e-7), DoubleNear(0.10128245311623928, 1.0e-7), DoubleNear(0.14934542391253242, 1.0e-7), DoubleNear(0.09783453080420923, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, false, true, false, true, false, false}), Matrix({ { 0.12643654634693333 + -1.4183872964559634e-20i, 0.0 + 0.0i, -0.021847910419154452 + -0.001259722574053477i, 0.0 + 0.0i, 0.012985915243603527 + -0.009425181505205129i, 0.0 + 0.0i, -0.003183925507700845 + 0.001294917996190929i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.08331557045923632 + 4.157099586557783e-20i, 0.0 + 0.0i, -0.015122916192841786 + -0.0007007575618831207i, 0.0 + 0.0i, 0.008560530670252715 + -0.006189248589339313i, 0.0 + 0.0i, -0.0020256585987540434 + 0.0008700611782721006i }, { -0.021847910419154452 + 0.0012597225740534769i, 0.0 + 0.0i, 0.12032836207874166 + -3.1601142987351103e-20i, 0.0 + 0.0i, -0.0014100198000142226 + 0.0012997608907472447i, 0.0 + 0.0i, 0.012974471098086499 + -0.0051226398460167775i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.015122916192841786 + 0.0007007575618831207i, 0.0 + 0.0i, 0.07882639326927239 + 3.860239969199993e-20i, 0.0 + 0.0i, -0.0011596475315328151 + 0.0008920904906594961i, 0.0 + 0.0i, 0.00849934605383005 + -0.0033567645549922387i }, { 0.012985915243603527 + 0.009425181505205129i, 0.0 + 0.0i, -0.0014100198000142226 + -0.0012997608907472447i, 0.0 + 0.0i, 0.17554709987215827 + -1.5193653491374012e-20i, 0.0 + 0.0i, -0.031545545412961326 + 0.0011508260293326283i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.008560530670252715 + 0.006189248589339315i, 0.0 + 0.0i, -0.0011596475315328151 + -0.0008920904906594961i, 0.0 + 0.0i, 0.11575563182712734 + 1.5511290846594375e-20i, 0.0 + 0.0i, -0.021897433977441687 + 0.00041936647707785905i }, { -0.003183925507700845 + -0.0012949179961909293i, 0.0 + 0.0i, 0.012974471098086499 + 0.005122639846016776i, 0.0 + 0.0i, -0.031545545412961326 + -0.001150826029332628i, 0.0 + 0.0i, 0.18113404771308567 + -3.959879028413854e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.0020256585987540434 + -0.0008700611782721004i, 0.0 + 0.0i, 0.00849934605383005 + 0.0033567645549922387i, 0.0 + 0.0i, -0.021897433977441687 + -0.0004193664770778593i, 0.0 + 0.0i, 0.11865634843344502 + 1.2387856853594142e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, false, true, false, true, false, false}), ElementsAreArray({ DoubleNear(0.12643654634693333, 1.0e-7), DoubleNear(0.08331557045923632, 1.0e-7), DoubleNear(0.12032836207874166, 1.0e-7), DoubleNear(0.07882639326927239, 1.0e-7), DoubleNear(0.17554709987215827, 1.0e-7), DoubleNear(0.11575563182712734, 1.0e-7), DoubleNear(0.18113404771308567, 1.0e-7), DoubleNear(0.11865634843344502, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, false, true, false, false, true, false}), Matrix({ { 0.16045645024203503 + -1.5974927639527665e-21i, 0.0 + 0.0i, -0.028455560599669635 + -0.0007374225200951223i, 0.0 + 0.0i, 0.008080222822579678 + -0.013635965200859617i, 0.0 + 0.0i, -0.0006583229047806066 + 0.0030370150529413467i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.1058350875141654 + 5.651318645073572e-20i, 0.0 + 0.0i, -0.019955601573643643 + -0.0005981458942817766i, 0.0 + 0.0i, 0.005206092194214857 + -0.008928864797541571i, 0.0 + 0.0i, -0.0002066429130304641 + 0.0019252951087805267i }, { -0.028455560599669635 + 0.0007374225200951223i, 0.0 + 0.0i, 0.16115116063621213 + -5.326733055091667e-21i, 0.0 + 0.0i, -0.00209792771050872 + 0.0015826260843095088i, 0.0 + 0.0i, 0.0069153765549078376 + -0.012740062671840855i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.019955601573643643 + 0.0005981458942817765i, 0.0 + 0.0i, 0.10573354658396096 + 6.242204765595183e-20i, 0.0 + 0.0i, -0.0011401329336910633 + 0.0009566906725507986i, 0.0 + 0.0i, 0.004412150094192657 + -0.008245000812000306i }, { 0.008080222822579678 + 0.013635965200859619i, 0.0 + 0.0i, -0.00209792771050872 + -0.001582626084309509i, 0.0 + 0.0i, 0.1415271959770566 + -2.778003369198088e-20i, 0.0 + 0.0i, -0.024937895232446144 + 0.0006285259753742733i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.005206092194214855 + 0.008928864797541571i, 0.0 + 0.0i, -0.0011401329336910633 + -0.0009566906725507986i, 0.0 + 0.0i, 0.09323611477219827 + 5.69100261436483e-22i, 0.0 + 0.0i, -0.017064748596639825 + 0.00031675480947651494i }, { -0.0006583229047806064 + -0.0030370150529413467i, 0.0 + 0.0i, 0.006915376554907839 + 0.012740062671840855i, 0.0 + 0.0i, -0.024937895232446144 + -0.0006285259753742735i, 0.0 + 0.0i, 0.14031124915561521 + -6.587320021639799e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.000206642913030464 + -0.0019252951087805265i, 0.0 + 0.0i, 0.004412150094192657 + 0.008245000812000306i, 0.0 + 0.0i, -0.017064748596639825 + -0.00031675480947651504i, 0.0 + 0.0i, 0.09174919511875645 + 1.000589205719895e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, false, true, false, false, true, false}), ElementsAreArray({ DoubleNear(0.16045645024203503, 1.0e-7), DoubleNear(0.1058350875141654, 1.0e-7), DoubleNear(0.16115116063621213, 1.0e-7), DoubleNear(0.10573354658396096, 1.0e-7), DoubleNear(0.1415271959770566, 1.0e-7), DoubleNear(0.09323611477219827, 1.0e-7), DoubleNear(0.14031124915561521, 1.0e-7), DoubleNear(0.09174919511875645, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, false, true, false, false, false, true}), Matrix({ { 0.14571491956643098 + -2.8216164875909196e-20i, 0.0 + 0.0i, -0.025880639427215763 + -0.0005079904345227305i, 0.0 + 0.0i, 0.0135838486872761 + 0.015639188775079395i, 0.0 + 0.0i, -0.0022235986162334 + -0.0008037938684570309i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0960433135513345 + 1.4279825915615786e-20i, 0.0 + 0.0i, -0.017839329315543904 + -0.0004318178412537979i, 0.0 + 0.0i, 0.008947313313163483 + 0.010361689734386583i, 0.0 + 0.0i, -0.0015391688396139166 + -0.0007930627838360347i }, { -0.025880639427215763 + 0.00050799043452273i, 0.0 + 0.0i, 0.14557187562347218 + -3.540648389484487e-20i, 0.0 + 0.0i, -0.0017796224106863916 + -0.004531054445997022i, 0.0 + 0.0i, 0.012266531048833424 + 0.015773791881896017i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.017839329315543904 + 0.0004318178412537977i, 0.0 + 0.0i, 0.09530365560917883 + 7.198771930438997e-20i, 0.0 + 0.0i, -0.0012855055270315735 + -0.003202972531077273i, 0.0 + 0.0i, 0.00796431295942841 + 0.010379768895415361i }, { 0.0135838486872761 + -0.015639188775079395i, 0.0 + 0.0i, -0.0017796224106863916 + 0.004531054445997022i, 0.0 + 0.0i, 0.15626872665266064 + -1.1613615800244539e-21i, 0.0 + 0.0i, -0.027512816404900015 + 0.00039909388980188153i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.008947313313163483 + -0.010361689734386583i, 0.0 + 0.0i, -0.0012855055270315733 + 0.0032029725310772725i, 0.0 + 0.0i, 0.10302788873502919 + 4.280246079655642e-20i, 0.0 + 0.0i, -0.019181020854739564 + 0.00015042675644853627i }, { -0.0022235986162333996 + 0.000803793868457031i, 0.0 + 0.0i, 0.012266531048833424 + -0.015773791881896017i, 0.0 + 0.0i, -0.027512816404900015 + -0.00039909388980188137i, 0.0 + 0.0i, 0.15589053416835516 + -3.579344937664478e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.0015391688396139166 + 0.0007930627838360346i, 0.0 + 0.0i, 0.00796431295942841 + -0.010379768895415361i, 0.0 + 0.0i, -0.019181020854739564 + -0.0001504267564485363i, 0.0 + 0.0i, 0.10217908609353858 + 9.049324892355138e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, false, true, false, false, false, true}), ElementsAreArray({ DoubleNear(0.14571491956643098, 1.0e-7), DoubleNear(0.0960433135513345, 1.0e-7), DoubleNear(0.14557187562347218, 1.0e-7), DoubleNear(0.09530365560917883, 1.0e-7), DoubleNear(0.15626872665266064, 1.0e-7), DoubleNear(0.10302788873502919, 1.0e-7), DoubleNear(0.15589053416835516, 1.0e-7), DoubleNear(0.10217908609353858, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, false, false, true, true, false, false}), Matrix({ { 0.12089686276735542 + -1.8951786452559704e-20i, 0.0 + 0.0i, -0.00825503271180968 + -0.0010949440370090003i, 0.0 + 0.0i, 0.013016354631455923 + -0.00580720848614236i, 0.0 + 0.0i, -0.0020634761876134147 + -8.729337652440587e-05i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.07944094171799398 + 4.017422262510423e-20i, 0.0 + 0.0i, -0.005430072250825179 + -0.0007148812917935395i, 0.0 + 0.0i, 0.008563558513953224 + -0.0038067595452203045i, 0.0 + 0.0i, -0.0013444178850974585 + -5.203704661105467e-05i }, { -0.00825503271180968 + 0.0010949440370090003i, 0.0 + 0.0i, 0.1258680456583196 + -2.6833229499351034e-20i, 0.0 + 0.0i, 0.00028954995027515105 + -0.0004698720101743853i, 0.0 + 0.0i, 0.012944031710234106 + -0.008740612865079548i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.005430072250825179 + 0.0007148812917935395i, 0.0 + 0.0i, 0.08270102201051473 + 3.999917293247352e-20i, 0.0 + 0.0i, 0.00020119701746791786 + -0.00030790951457881487i, 0.0 + 0.0i, 0.00849631821012954 + -0.005739253599111248i }, { 0.013016354631455923 + 0.005807208486142359i, 0.0 + 0.0i, 0.00028954995027515105 + 0.0004698720101743853i, 0.0 + 0.0i, 0.17952758666899238 + -2.482865326639168e-20i, 0.0 + 0.0i, -0.014788278341401999 + 0.002432273562376102i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.008563558513953224 + 0.003806759545220305i, 0.0 + 0.0i, 0.00020119701746791786 + 0.00030790951457881476i, 0.0 + 0.0i, 0.11799601835063861 + 6.603281254316687e-20i, 0.0 + 0.0i, -0.009721090114471333 + 0.0016048984285351752i }, { -0.0020634761876134147 + 8.72933765244059e-05i, 0.0 + 0.0i, 0.012944031710234106 + 0.008740612865079548i, 0.0 + 0.0i, -0.014788278341401999 + -0.002432273562376102i, 0.0 + 0.0i, 0.17715356091625156 + -2.9963790509120874e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.0013444178850974585 + 5.203704661105466e-05i, 0.0 + 0.0i, 0.00849631821012954 + 0.005739253599111248i, 0.0 + 0.0i, -0.009721090114471333 + -0.0016048984285351752i, 0.0 + 0.0i, 0.11641596190993377 + 7.335704683936893e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, false, false, true, true, false, false}), ElementsAreArray({ DoubleNear(0.12089686276735542, 1.0e-7), DoubleNear(0.07944094171799398, 1.0e-7), DoubleNear(0.1258680456583196, 1.0e-7), DoubleNear(0.08270102201051473, 1.0e-7), DoubleNear(0.17952758666899238, 1.0e-7), DoubleNear(0.11799601835063861, 1.0e-7), DoubleNear(0.17715356091625156, 1.0e-7), DoubleNear(0.11641596190993377, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, false, false, true, false, true, false}), Matrix({ { 0.1602539338796981 + 3.8371660068897266e-22i, 0.0 + 0.0i, -0.01236913165120861 + 0.0008319784572495566i, 0.0 + 0.0i, 0.007302862070516268 + -0.013039046641824889i, 0.0 + 0.0i, -0.0004906476753558417 + 0.0008468674876579418i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.1054357534694429 + 5.769753943981874e-20i, 0.0 + 0.0i, -0.008145160555769422 + 0.0005583562939734779i, 0.0 + 0.0i, 0.004676257026730646 + -0.008484076941320182i, 0.0 + 0.0i, -0.00031494700618026723 + 0.0005422120814377789i }, { -0.01236913165120861 + -0.0008319784572495566i, 0.0 + 0.0i, 0.16135367699854902 + -7.307942419733402e-21i, 0.0 + 0.0i, -0.0004529156923412206 + 0.001053207807695052i, 0.0 + 0.0i, 0.007692737306971248 + -0.013336981230875585i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.008145160555769422 + -0.0005583562939734779i, 0.0 + 0.0i, 0.10613288062868348 + 6.123769466686881e-20i, 0.0 + 0.0i, -0.00028055011427317915 + 0.0006876915829716383i, 0.0 + 0.0i, 0.004941985261676869 + -0.008689788668221695i }, { 0.007302862070516268 + 0.013039046641824889i, 0.0 + 0.0i, -0.0004529156923412206 + -0.001053207807695052i, 0.0 + 0.0i, 0.1401705155566497 + -4.416415631964036e-20i, 0.0 + 0.0i, -0.010674179402003069 + 0.0005053510681175448i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.004676257026730646 + 0.008484076941320182i, 0.0 + 0.0i, -0.00028055011427317915 + -0.0006876915829716383i, 0.0 + 0.0i, 0.0920012065991897 + 4.850949572845235e-20i, 0.0 + 0.0i, -0.007006001809527089 + 0.00033166084276815773i }, { -0.0004906476753558415 + -0.000846867487657942i, 0.0 + 0.0i, 0.007692737306971248 + 0.013336981230875585i, 0.0 + 0.0i, -0.010674179402003069 + -0.0005053510681175448i, 0.0 + 0.0i, 0.14166792957602214 + -4.948907758873851e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.0003149470061802673 + -0.0005422120814377789i, 0.0 + 0.0i, 0.004941985261676867 + 0.008689788668221695i, 0.0 + 0.0i, -0.007006001809527089 + -0.00033166084276815773i, 0.0 + 0.0i, 0.09298410329176501 + 5.211852510497364e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, false, false, true, false, true, false}), ElementsAreArray({ DoubleNear(0.1602539338796981, 1.0e-7), DoubleNear(0.1054357534694429, 1.0e-7), DoubleNear(0.16135367699854902, 1.0e-7), DoubleNear(0.10613288062868348, 1.0e-7), DoubleNear(0.1401705155566497, 1.0e-7), DoubleNear(0.0920012065991897, 1.0e-7), DoubleNear(0.14166792957602214, 1.0e-7), DoubleNear(0.09298410329176501, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, false, false, true, false, false, true}), Matrix({ { 0.14493695340259838 + -3.0209344269247424e-20i, 0.0 + 0.0i, -0.011073780726132871 + 0.0005787781959564197i, 0.0 + 0.0i, 0.012911072478422367 + 0.015735243505667247i, 0.0 + 0.0i, -0.0011632722363849777 + -0.0011671772271492635i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.09521883606249015 + 4.190863862579772e-20i, 0.0 + 0.0i, -0.007280229636971047 + 0.00038809663053120233i, 0.0 + 0.0i, 0.008432644590341829 + 0.01038840978524502i, 0.0 + 0.0i, -0.0007522082330821786 + -0.0007821007196963908i }, { -0.011073780726132871 + -0.0005787781959564197i, 0.0 + 0.0i, 0.1463498417873048 + -3.3413304501506644e-20i, 0.0 + 0.0i, -0.0008624513460173359 + -0.001351370929879054i, 0.0 + 0.0i, 0.012939307257687157 + 0.015677737151308165i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.007280229636971047 + -0.00038809663053120233i, 0.0 + 0.0i, 0.09612813309802316 + 4.4358906594208027e-20i, 0.0 + 0.0i, -0.0005557694793435001 + -0.0008792362014835574i, 0.0 + 0.0i, 0.008478981682250062 + 0.010353048844556925i }, { 0.012911072478422367 + -0.015735243505667247i, 0.0 + 0.0i, -0.000862451346017336 + 0.001351370929879054i, 0.0 + 0.0i, 0.15548749603374945 + -1.357109544970396e-20i, 0.0 + 0.0i, -0.011969530327078808 + 0.0007585513294106818i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.008432644590341829 + -0.01038840978524502i, 0.0 + 0.0i, -0.0005557694793435001 + 0.0008792362014835574i, 0.0 + 0.0i, 0.10221812400614244 + 6.429839654247337e-20i, 0.0 + 0.0i, -0.007870932728325465 + 0.0005019205062104333i }, { -0.001163272236384978 + 0.0011671772271492635i, 0.0 + 0.0i, 0.012939307257687157 + -0.015677737151308165i, 0.0 + 0.0i, -0.011969530327078808 + -0.0007585513294106818i, 0.0 + 0.0i, 0.15667176478726635 + -2.338371550696527e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.0007522082330821786 + 0.0007821007196963908i, 0.0 + 0.0i, 0.008478981682250062 + -0.010353048844556925i, 0.0 + 0.0i, -0.007870932728325465 + -0.0005019205062104333i, 0.0 + 0.0i, 0.10298885082242533 + 6.899731317763442e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, false, false, true, false, false, true}), ElementsAreArray({ DoubleNear(0.14493695340259838, 1.0e-7), DoubleNear(0.09521883606249015, 1.0e-7), DoubleNear(0.1463498417873048, 1.0e-7), DoubleNear(0.09612813309802316, 1.0e-7), DoubleNear(0.15548749603374945, 1.0e-7), DoubleNear(0.10221812400614244, 1.0e-7), DoubleNear(0.15667176478726635, 1.0e-7), DoubleNear(0.10298885082242533, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, false, false, false, true, true, false}), Matrix({ { 0.13130775570265968 + -3.551158778887706e-20i, 0.0 + 0.0i, 0.013836016165532636 + -0.007603356011297237i, 0.0 + 0.0i, 0.006367760740728251 + -0.010919436072182275i, 0.0 + 0.0i, -8.841046830763315e-05 + -0.001667467670111492i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.08636134922972744 + 6.252813377547149e-20i, 0.0 + 0.0i, 0.009102018638817298 + -0.004987962827120902i, 0.0 + 0.0i, 0.004095653491623939 + -0.007118315352576435i, 0.0 + 0.0i, -7.002686702130213e-05 + -0.0010887786060511987i }, { 0.013836016165532636 + 0.007603356011297236i, 0.0 + 0.0i, 0.19029985517558745 + 2.8587361969832624e-20i, 0.0 + 0.0i, 0.0013777607835953622 + -0.000601440131321362i, 0.0 + 0.0i, 0.008627838636759266 + -0.015456591800518199i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.009102018638817298 + 0.004987962827120902i, 0.0 + 0.0i, 0.12520728486839894 + 5.640710033121606e-20i, 0.0 + 0.0i, 0.0008969794775512338 + -0.0003885129561180458i, 0.0 + 0.0i, 0.005522588796783573 + -0.010055550256965442i }, { 0.006367760740728251 + 0.010919436072182275i, 0.0 + 0.0i, 0.0013777607835953622 + 0.000601440131321362i, 0.0 + 0.0i, 0.11545715272301534 + -1.0273428163033683e-20i, 0.0 + 0.0i, 0.012124370176157393 + -0.00694446533992467i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.004095653491623941 + 0.007118315352576435i, 0.0 + 0.0i, 0.0008969794775512339 + 0.000388512956118046i, 0.0 + 0.0i, 0.07578061449878129 + 1.7645261782106262e-20i, 0.0 + 0.0i, 0.007957858085265467 + -0.004558050317210651i }, { -8.841046830763326e-05 + 0.001667467670111492i, 0.0 + 0.0i, 0.008627838636759266 + 0.015456591800518199i, 0.0 + 0.0i, 0.012124370176157393 + 0.00694446533992467i, 0.0 + 0.0i, 0.16638129240965652 + -8.337980574534519e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, -7.002686702130192e-05 + 0.0010887786060511987i, 0.0 + 0.0i, 0.005522588796783573 + 0.010055550256965442i, 0.0 + 0.0i, 0.007957858085265467 + 0.004558050317210652i, 0.0 + 0.0i, 0.10920469539217344 + 8.298275905131972e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, false, false, false, true, true, false}), ElementsAreArray({ DoubleNear(0.13130775570265968, 1.0e-7), DoubleNear(0.08636134922972744, 1.0e-7), DoubleNear(0.19029985517558745, 1.0e-7), DoubleNear(0.12520728486839894, 1.0e-7), DoubleNear(0.11545715272301534, 1.0e-7), DoubleNear(0.07578061449878129, 1.0e-7), DoubleNear(0.16638129240965652, 1.0e-7), DoubleNear(0.10920469539217344, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, false, false, false, true, false, true}), Matrix({ { 0.11923014536775309 + -3.8317539471531846e-20i, 0.0 + 0.0i, 0.012531009243176664 + -0.007106251148041709i, 0.0 + 0.0i, 0.010510758233717592 + 0.01270600011345771i, 0.0 + 0.0i, 0.0017679183338765244 + 0.000772220171150081i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.07830891615102586 + 5.876544421384268e-20i, 0.0 + 0.0i, 0.00823167434949678 + -0.004658185175557012i, 0.0 + 0.0i, 0.006896448482498591 + 0.008391446782034634i, 0.0 + 0.0i, 0.0011619121996585598 + 0.0004987088260366217i }, { 0.012531009243176664 + 0.007106251148041708i, 0.0 + 0.0i, 0.17205664982215008 + -2.5305109299222223e-20i, 0.0 + 0.0i, 0.0004564840983196424 + 0.0019310869283767874i, 0.0 + 0.0i, 0.01533962150239193 + 0.018706980543517698i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.00823167434949678 + 0.004658185175557012i, 0.0 + 0.0i, 0.11303805300948745 + 2.7502101006163064e-20i, 0.0 + 0.0i, 0.00029324317109818217 + 0.0012862319852177772i, 0.0 + 0.0i, 0.0100151777900933 + 0.012350011847767312i }, { 0.010510758233717594 + -0.01270600011345771i, 0.0 + 0.0i, 0.00045648409831964236 + -0.0019310869283767874i, 0.0 + 0.0i, 0.1275347630579219 + -7.467476480378896e-21i, 0.0 + 0.0i, 0.013429377098513363 + -0.007441570203180198i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.006896448482498591 + -0.008391446782034632i, 0.0 + 0.0i, 0.00029324317109818206 + -0.0012862319852177772i, 0.0 + 0.0i, 0.08383304757748285 + 2.1407951343735067e-20i, 0.0 + 0.0i, 0.008828202374585984 + -0.004887827968774541i }, { 0.0017679183338765244 + -0.000772220171150081i, 0.0 + 0.0i, 0.015339621502391928 + -0.018706980543517698i, 0.0 + 0.0i, 0.013429377098513363 + 0.007441570203180198i, 0.0 + 0.0i, 0.1846244977630939 + -2.948733447629033e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0011619121996585598 + -0.0004987088260366217i, 0.0 + 0.0i, 0.0100151777900933 + -0.012350011847767309i, 0.0 + 0.0i, 0.008828202374585984 + 0.0048878279687745415i, 0.0 + 0.0i, 0.12137392725108492 + 1.1188775837637274e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, false, false, false, true, false, true}), ElementsAreArray({ DoubleNear(0.11923014536775309, 1.0e-7), DoubleNear(0.07830891615102586, 1.0e-7), DoubleNear(0.17205664982215008, 1.0e-7), DoubleNear(0.11303805300948745, 1.0e-7), DoubleNear(0.1275347630579219, 1.0e-7), DoubleNear(0.08383304757748285, 1.0e-7), DoubleNear(0.1846244977630939, 1.0e-7), DoubleNear(0.12137392725108492, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, false, false, false, false, true, true}), Matrix({ { 0.1437007917530618 + -1.2982806715132632e-20i, 0.0 + 0.0i, -0.008165776249318139 + -0.027795998241233168i, 0.0 + 0.0i, 0.014534426859260253 + 0.007609388915966992i, 0.0 + 0.0i, 0.020644915179569047 + 0.011136743850090454i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.09451887105509484 + 2.8242634655510887e-20i, 0.0 + 0.0i, -0.0054375504074985846 + -0.018217218898985046i, 0.0 + 0.0i, 0.009539847083312023 + 0.005273508368973803i, 0.0 + 0.0i, 0.013597968503731003 + 0.007421248706824988i }, { -0.008165776249318139 + 0.027795998241233168i, 0.0 + 0.0i, 0.14758600343684136 + -5.063984205562143e-20i, 0.0 + 0.0i, 0.029298845331447824 + 0.010542534965055753i, 0.0 + 0.0i, 0.011315952876849271 + 0.023803591741008417i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.0054375504074985846 + 0.018217218898985046i, 0.0 + 0.0i, 0.09682809810541848 + 5.802491056449486e-20i, 0.0 + 0.0i, 0.01941398838790371 + 0.006942039959633313i, 0.0 + 0.0i, 0.007371779189279867 + 0.015467950260828141i }, { 0.014534426859260255 + -0.007609388915966992i, 0.0 + 0.0i, 0.029298845331447824 + -0.010542534965055753i, 0.0 + 0.0i, 0.17790681912518533 + 6.058580896088203e-21i, 0.0 + 0.0i, 0.023161375626805654 + 0.0014199703685326929i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.009539847083312023 + -0.005273508368973803i, 0.0 + 0.0i, 0.01941398838790371 + -0.006942039959633313i, 0.0 + 0.0i, 0.11704976304303154 + 9.069259945117666e-20i, 0.0 + 0.0i, 0.015055792695906097 + 0.0010433532894431699i }, { 0.020644915179569047 + -0.011136743850090457i, 0.0 + 0.0i, 0.011315952876849267 + -0.023803591741008417i, 0.0 + 0.0i, 0.023161375626805654 + -0.0014199703685326929i, 0.0 + 0.0i, 0.13425244169583048 + -4.3013391852757433e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.013597968503731003 + -0.007421248706824988i, 0.0 + 0.0i, 0.007371779189279867 + -0.01546795026082814i, 0.0 + 0.0i, 0.015055792695906099 + -0.0010433532894431699i, 0.0 + 0.0i, 0.08815721178553623 + 4.2603110268931125e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, false, false, false, false, true, true}), ElementsAreArray({ DoubleNear(0.1437007917530618, 1.0e-7), DoubleNear(0.09451887105509484, 1.0e-7), DoubleNear(0.14758600343684136, 1.0e-7), DoubleNear(0.09682809810541848, 1.0e-7), DoubleNear(0.17790681912518533, 1.0e-7), DoubleNear(0.11704976304303154, 1.0e-7), DoubleNear(0.13425244169583048, 1.0e-7), DoubleNear(0.08815721178553623, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, true, true, true, false, false, false}), Matrix({ { 0.12376505749297084 + 6.76960194761545e-21i, 0.0 + 0.0i, -0.022720705718687027 + 0.0007164439786789997i, 0.0 + 0.0i, -0.008650798782991999 + -0.0007009867667084248i, 0.0 + 0.0i, 0.0011708635928752438 + -0.0006281737850154384i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.12233115523420643 + 8.232784245930033e-21i, 0.0 + 0.0i, -0.022292839176377317 + 0.0003323010949015774i, 0.0 + 0.0i, -0.00840396330504832 + -0.0010001810615078667i, 0.0 + 0.0i, 0.0012409697463154888 + -0.0003289124814521603i }, { -0.022720705718687027 + -0.0007164439786789998i, 0.0 + 0.0i, 0.1271664454553253 + 4.271425309664515e-20i, 0.0 + 0.0i, 0.0021821608383826565 + 0.0001252185916230559i, 0.0 + 0.0i, -0.010775669996554875 + 0.0021623889486930745i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.022292839176377317 + -0.00033230109490157755i, 0.0 + 0.0i, 0.12459875132247783 + 4.7099561591290775e-21i, 0.0 + 0.0i, 0.0023126212424761997 + 0.0004291018968285606i, 0.0 + 0.0i, -0.010364041333912995 + 0.0017661255416319538i }, { -0.008650798782991999 + 0.0007009867667084248i, 0.0 + 0.0i, 0.002182160838382657 + -0.0001252185916230559i, 0.0 + 0.0i, 0.12783869527999508 + 8.31548388240125e-21i, 0.0 + 0.0i, -0.022730300417230814 + -0.0005702036393233332i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.00840396330504832 + 0.0010001810615078667i, 0.0 + 0.0i, 0.0023126212424761997 + -0.0004291018968285606i, 0.0 + 0.0i, 0.12711994049828296 + 4.3868901802918214e-21i, 0.0 + 0.0i, -0.02266996069010409 + -0.0008688290637833545i }, { 0.0011708635928752438 + 0.0006281737850154384i, 0.0 + 0.0i, -0.010775669996554875 + -0.0021623889486930745i, 0.0 + 0.0i, -0.022730300417230814 + 0.000570203639323333i, 0.0 + 0.0i, 0.12450513504661215 + 4.948376311314008e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0012409697463154885 + 0.00032891248145216036i, 0.0 + 0.0i, -0.010364041333912995 + -0.0017661255416319538i, 0.0 + 0.0i, -0.02266996069010409 + 0.0008688290637833542i, 0.0 + 0.0i, 0.1226748196701295 + -5.626937412462613e-21i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, true, true, true, false, false, false}), ElementsAreArray({ DoubleNear(0.12376505749297084, 1.0e-7), DoubleNear(0.12233115523420643, 1.0e-7), DoubleNear(0.1271664454553253, 1.0e-7), DoubleNear(0.12459875132247783, 1.0e-7), DoubleNear(0.12783869527999508, 1.0e-7), DoubleNear(0.12711994049828296, 1.0e-7), DoubleNear(0.12450513504661215, 1.0e-7), DoubleNear(0.1226748196701295, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, true, true, false, true, false, false}), Matrix({ { 0.10601417805435934 + 2.7843519598034596e-20i, 0.0 + 0.0i, -0.018674340712320655 + -0.0009417212041523727i, 0.0 + 0.0i, 0.01194635936669003 + -0.011374557934138416i, 0.0 + 0.0i, -0.002563111232691452 + 0.0016976908457125878i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.10373793875181032 + -4.563966970164054e-22i, 0.0 + 0.0i, -0.018296485899675582 + -0.0010187589317842251i, 0.0 + 0.0i, 0.009600086547166212 + -0.004239872160406028i, 0.0 + 0.0i, -0.002646472873763436 + 0.00046728832875044186i }, { -0.018674340712320655 + 0.0009417212041523724i, 0.0 + 0.0i, 0.10084713584363005 + 2.3111891449356353e-20i, 0.0 + 0.0i, -0.0016989686891118788 + 0.0017110708795200274i, 0.0 + 0.0i, 0.011915866235681652 + -0.008570456484144645i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.018296485899675582 + 0.0010187589317842251i, 0.0 + 0.0i, 0.09830761950438402 + -1.6110634744707533e-20i, 0.0 + 0.0i, -0.0008706986424351587 + 0.0004807805018867135i, 0.0 + 0.0i, 0.009557950916234898 + 9.105208313562913e-05i }, { 0.01194635936669003 + 0.011374557934138416i, 0.0 + 0.0i, -0.0016989686891118788 + -0.0017110708795200274i, 0.0 + 0.0i, 0.1455895747186066 + -1.2758433768017899e-20i, 0.0 + 0.0i, -0.026776665423597183 + 0.0010879615435080393i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.009600086547166212 + 0.004239872160406028i, 0.0 + 0.0i, -0.0008706986424351589 + -0.0004807805018867134i, 0.0 + 0.0i, 0.14571315698067905 + 1.3076071123238261e-20i, 0.0 + 0.0i, -0.026666313966805827 + 0.0004822309629024482i }, { -0.002563111232691452 + -0.0016976908457125878i, 0.0 + 0.0i, 0.011915866235681652 + 0.008570456484144645i, 0.0 + 0.0i, -0.026776665423597183 + -0.001087961543508039i, 0.0 + 0.0i, 0.15082444465830738 + 6.908612476042887e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.0026464728737634357 + -0.00046728832875044196i, 0.0 + 0.0i, 0.009557950916234898 + -9.105208313562956e-05i, 0.0 + 0.0i, -0.026666313966805827 + -0.00048223096290244836i, 0.0 + 0.0i, 0.1489659514882233 + 1.5193653491373988e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, true, true, false, true, false, false}), ElementsAreArray({ DoubleNear(0.10601417805435934, 1.0e-7), DoubleNear(0.10373793875181032, 1.0e-7), DoubleNear(0.10084713584363005, 1.0e-7), DoubleNear(0.09830761950438402, 1.0e-7), DoubleNear(0.1455895747186066, 1.0e-7), DoubleNear(0.14571315698067905, 1.0e-7), DoubleNear(0.15082444465830738, 1.0e-7), DoubleNear(0.1489659514882233, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, true, true, false, false, true, false}), Matrix({ { 0.1337138524608062 + 4.2203375031955156e-20i, 0.0 + 0.0i, -0.024341292619370215 + -0.00048564954784368654i, 0.0 + 0.0i, 0.006676968708214424 + -0.011335823656600744i, 0.0 + 0.0i, -0.0004197722846441599 + 0.0024946221590561165i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.1325776852953942 + 1.2712318654827795e-20i, 0.0 + 0.0i, -0.024069869553943062 + -0.0008499188665332124i, 0.0 + 0.0i, 0.006609346308580109 + -0.011229006341800445i, 0.0 + 0.0i, -0.00044519353316691034 + 0.002467688002665756i }, { -0.024341292619370215 + 0.0004856495478436863i, 0.0 + 0.0i, 0.13464950195878428 + 1.0325230287106896e-19i, 0.0 + 0.0i, -0.0016402887368390608 + 0.0012694565790633682i, 0.0 + 0.0i, 0.005675992521876573 + -0.010564761886082052i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.024069869553943062 + 0.0008499188665332122i, 0.0 + 0.0i, 0.13223520526138877 + -4.61569882702088e-20i, 0.0 + 0.0i, -0.0015977719073607221 + 0.0012698601777969393i, 0.0 + 0.0i, 0.005651534127223924 + -0.01042030159775911i }, { 0.006676968708214424 + 0.011335823656600744i, 0.0 + 0.0i, -0.0016402887368390606 + -0.0012694565790633682i, 0.0 + 0.0i, 0.11788990031215973 + -2.711828920193846e-20i, 0.0 + 0.0i, -0.021109713516547623 + 0.0006318898871993529i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.006609346308580109 + 0.011229006341800445i, 0.0 + 0.0i, -0.0015977719073607221 + -0.0012698601777969393i, 0.0 + 0.0i, 0.11687341043709515 + -9.26442286059391e-23i, 0.0 + 0.0i, -0.020892930312538346 + 0.0003133908976514355i }, { -0.0004197722846441597 + -0.002494622159056117i, 0.0 + 0.0i, 0.005675992521876573 + 0.010564761886082052i, 0.0 + 0.0i, -0.021109713516547623 + -0.0006318898871993531i, 0.0 + 0.0i, 0.11702207854315314 + -1.1054286661283732e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.00044519353316691034 + -0.002467688002665756i, 0.0 + 0.0i, 0.005651534127223924 + 0.010420301597759111i, 0.0 + 0.0i, -0.020892930312538346 + -0.0003133908976514356i, 0.0 + 0.0i, 0.11503836573121853 + 4.5240007016875254e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, true, true, false, false, true, false}), ElementsAreArray({ DoubleNear(0.1337138524608062, 1.0e-7), DoubleNear(0.1325776852953942, 1.0e-7), DoubleNear(0.13464950195878428, 1.0e-7), DoubleNear(0.13223520526138877, 1.0e-7), DoubleNear(0.11788990031215973, 1.0e-7), DoubleNear(0.11687341043709515, 1.0e-7), DoubleNear(0.11702207854315314, 1.0e-7), DoubleNear(0.11503836573121853, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, true, true, false, false, false, true}), Matrix({ { 0.12139452846820672 + -2.8652916239337195e-20i, 0.0 + 0.0i, -0.02197930419305863 + -0.0003124719068633953i, 0.0 + 0.0i, 0.011327451641509573 + 0.013058076554933188i, 0.0 + 0.0i, -0.0019043777636881174 + -0.0007757381549795893i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.12036370464955873 + 1.4716577279043784e-20i, 0.0 + 0.0i, -0.02174066454970104 + -0.000627336368913133i, 0.0 + 0.0i, 0.011203710358930006 + 0.012942801954532793i, 0.0 + 0.0i, -0.0018583896921591987 + -0.0008211184973134764i }, { -0.02197930419305863 + 0.00031247190686339485i, 0.0 + 0.0i, 0.1214809105661688 + 7.322549159051915e-20i, 0.0 + 0.0i, -0.0015067462920423512 + -0.003910481547963472i, 0.0 + 0.0i, 0.010217557146366626 + 0.013215149317867367i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.02174066454970104 + 0.0006273363689131328i, 0.0 + 0.0i, 0.11939462066648222 + -3.664425618097405e-20i, 0.0 + 0.0i, -0.0015583816456756138 + -0.0038235454291108235i, 0.0 + 0.0i, 0.010013286861895208 + 0.01293841145944401i }, { 0.011327451641509573 + -0.013058076554933188i, 0.0 + 0.0i, -0.0015067462920423512 + 0.003910481547963472i, 0.0 + 0.0i, 0.1302092243047592 + 4.373800206935389e-20i, 0.0 + 0.0i, -0.023471701942859212 + 0.0004587122462190617i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.011203710358930006 + -0.012942801954532792i, 0.0 + 0.0i, -0.0015583816456756136 + 0.0038235454291108235i, 0.0 + 0.0i, 0.12908739108293063 + -2.096902852821928e-21i, 0.0 + 0.0i, -0.02322213531678037 + 9.080840003135605e-05i }, { -0.0019043777636881174 + 0.0007757381549795892i, 0.0 + 0.0i, 0.010217557146366624 + -0.013215149317867367i, 0.0 + 0.0i, -0.023471701942859212 + -0.0004587122462190616i, 0.0 + 0.0i, 0.13019066993576864 + 1.8972524619266085e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.0018583896921591989 + 0.0008211184973134762i, 0.0 + 0.0i, 0.010013286861895208 + -0.012938411459444008i, 0.0 + 0.0i, -0.02322213531678037 + -9.080840003135613e-05i, 0.0 + 0.0i, 0.1278789503261251 + 3.5727274927640505e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, true, true, false, false, false, true}), ElementsAreArray({ DoubleNear(0.12139452846820672, 1.0e-7), DoubleNear(0.12036370464955873, 1.0e-7), DoubleNear(0.1214809105661688, 1.0e-7), DoubleNear(0.11939462066648222, 1.0e-7), DoubleNear(0.1302092243047592, 1.0e-7), DoubleNear(0.12908739108293063, 1.0e-7), DoubleNear(0.13019066993576864, 1.0e-7), DoubleNear(0.1278789503261251, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, true, false, true, true, false, false}), Matrix({ { 0.10141307328491327 + 2.6101752092895387e-20i, 0.0 + 0.0i, -0.006949624574247137 + -0.0008549532511234804i, 0.0 + 0.0i, 0.011957263495281962 + -0.008978505189664528i, 0.0 + 0.0i, -0.0015557266216714779 + 0.0003865187341188604i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.09892473120043611 + -4.8793159203508586e-21i, 0.0 + 0.0i, -0.006735480388387722 + -0.0009548720776790593i, 0.0 + 0.0i, 0.009622649650127183 + -0.0006354628416981366i, 0.0 + 0.0i, -0.0018521674510393951 + -0.0005258491572543209i }, { -0.006949624574247137 + 0.0008549532511234804i, 0.0 + 0.0i, 0.10544824061307612 + 2.4853658954495565e-20i, 0.0 + 0.0i, -8.462503747718184e-05 + 2.9720369413659188e-05i, 0.0 + 0.0i, 0.011904962107089717 + -0.010966509228618533i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.006735480388387722 + 0.0009548720776790593i, 0.0 + 0.0i, 0.1031208270557582 + -1.1687715521373078e-20i, 0.0 + 0.0i, 0.0005753720052202508 + -0.0008075018941668593i, 0.0 + 0.0i, 0.009535387813273927 + -0.0035133572355722626i }, { 0.011957263495281964 + 0.008978505189664528i, 0.0 + 0.0i, -8.462503747718185e-05 + -2.9720369413659256e-05i, 0.0 + 0.0i, 0.14951842966338288 + 2.3382102951365216e-20i, 0.0 + 0.0i, -0.012476844205299736 + 0.00231635543310813i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.009622649650127183 + 0.0006354628416981366i, 0.0 + 0.0i, 0.0005753720052202508 + 0.0008075018941668593i, 0.0 + 0.0i, 0.14800517535624813 + 1.782205632540997e-20i, 0.0 + 0.0i, -0.012032524250573596 + 0.0017208165578031468i }, { -0.0015557266216714779 + -0.0003865187341188604i, 0.0 + 0.0i, 0.011904962107089717 + 0.010966509228618533i, 0.0 + 0.0i, -0.012476844205299736 + -0.00231635543310813i, 0.0 + 0.0i, 0.14689558971353112 + 3.294558804104576e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.0018521674510393951 + 0.0005258491572543209i, 0.0 + 0.0i, 0.009535387813273927 + 0.003513357235572262i, 0.0 + 0.0i, -0.012032524250573596 + -0.0017208165578031468i, 0.0 + 0.0i, 0.14667393311265425 + 1.0447668289202286e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, true, false, true, true, false, false}), ElementsAreArray({ DoubleNear(0.10141307328491327, 1.0e-7), DoubleNear(0.09892473120043611, 1.0e-7), DoubleNear(0.10544824061307612, 1.0e-7), DoubleNear(0.1031208270557582, 1.0e-7), DoubleNear(0.14951842966338288, 1.0e-7), DoubleNear(0.14800517535624813, 1.0e-7), DoubleNear(0.14689558971353112, 1.0e-7), DoubleNear(0.14667393311265425, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, true, false, true, false, true, false}), Matrix({ { 0.1339270639952454 + 6.797232515025497e-20i, 0.0 + 0.0i, -0.010432970870205782 + 0.0008815413649202204i, 0.0 + 0.0i, 0.006018645166872112 + -0.01083892379793651i, 0.0 + 0.0i, -0.00039775692492986477 + 0.0007192745731314377i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.1317626233538956 + -9.891069109747263e-21i, 0.0 + 0.0i, -0.010081321336772251 + 0.0005087933863028142i, 0.0 + 0.0i, 0.005960473930374804 + -0.010684199785208556i, 0.0 + 0.0i, -0.0004078377566062442 + 0.0006698049959642829i }, { -0.010432970870205782 + -0.0008815413649202204i, 0.0 + 0.0i, 0.1344362904243451 + 7.748335275276915e-20i, 0.0 + 0.0i, -0.0003914966621917827 + 0.0008759761328633886i, 0.0 + 0.0i, 0.006334316063218888 + -0.011061661744746286i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.010081321336772251 + -0.0005087933863028142i, 0.0 + 0.0i, 0.1330502672028874 + -2.355360050563374e-20i, 0.0 + 0.0i, -0.0003419691444226171 + 0.0008649232578033017i, 0.0 + 0.0i, 0.006300406505429228 + -0.010965108154350997i }, { 0.006018645166872112 + 0.01083892379793651i, 0.0 + 0.0i, -0.0003914966621917827 + -0.0008759761328633886i, 0.0 + 0.0i, 0.11700443895305077 + -1.8488470105994376e-20i, 0.0 + 0.0i, -0.008993497909341092 + 0.0005798608170644294i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.005960473930374804 + 0.010684199785208556i, 0.0 + 0.0i, -0.0003419691444226171 + -0.0008649232578033017i, 0.0 + 0.0i, 0.11516728320278863 + 2.2833809514806372e-20i, 0.0 + 0.0i, -0.008686683302189066 + 0.0002571510938212731i }, { -0.0003977569249298647 + -0.0007192745731314377i, 0.0 + 0.0i, 0.006334316063218888 + 0.011061661744746286i, 0.0 + 0.0i, -0.008993497909341092 + -0.0005798608170644294i, 0.0 + 0.0i, 0.11790753990226212 + -1.9684105757227818e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.0004078377566062443 + -0.0006698049959642829i, 0.0 + 0.0i, 0.006300406505429228 + 0.010965108154350997i, 0.0 + 0.0i, -0.008686683302189066 + -0.0002571510938212731i, 0.0 + 0.0i, 0.11674449296552505 + 2.2313553273462946e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, true, false, true, false, true, false}), ElementsAreArray({ DoubleNear(0.1339270639952454, 1.0e-7), DoubleNear(0.1317626233538956, 1.0e-7), DoubleNear(0.1344362904243451, 1.0e-7), DoubleNear(0.1330502672028874, 1.0e-7), DoubleNear(0.11700443895305077, 1.0e-7), DoubleNear(0.11516728320278863, 1.0e-7), DoubleNear(0.11790753990226212, 1.0e-7), DoubleNear(0.11674449296552505, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, true, false, true, false, false, true}), Matrix({ { 0.12103232737281408 + 2.131802905218955e-20i, 0.0 + 0.0i, -0.009334574386366616 + 0.0006512619465577853i, 0.0 + 0.0i, 0.010769394571616905 + 0.013180002192463071i, 0.0 + 0.0i, -0.0009910080137775117 + -0.0009790180991492716i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.11912346209227445 + -9.618734695639248e-21i, 0.0 + 0.0i, -0.009019435976737301 + 0.00031561287992983684i, 0.0 + 0.0i, 0.010574322497147291 + 0.012943651098449195i, 0.0 + 0.0i, -0.0009244724556896447 + -0.0009702598476963825i }, { -0.009334574386366616 + -0.0006512619465577853i, 0.0 + 0.0i, 0.12184311166156145 + 2.32545462989924e-20i, 0.0 + 0.0i, -0.0007079313599764236 + -0.0011453057657116366i, 0.0 + 0.0i, 0.010775614216259295 + 0.013093223680337482i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.009019435976737301 + -0.00031561287992983684i, 0.0 + 0.0i, 0.12063486322376653 + -1.2308944206291017e-20i, 0.0 + 0.0i, -0.0007102894653844122 + -0.001085301365650975i, 0.0 + 0.0i, 0.010642674723677924 + 0.012937562315527605i }, { 0.010769394571616905 + -0.013180002192463073i, 0.0 + 0.0i, -0.0007079313599764239 + 0.0011453057657116366i, 0.0 + 0.0i, 0.12989917557548206 + 2.8165825992071053e-20i, 0.0 + 0.0i, -0.010091894393180258 + 0.0008101402354268645i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.010574322497147291 + -0.012943651098449194i, 0.0 + 0.0i, -0.0007102894653844122 + 0.001085301365650975i, 0.0 + 0.0i, 0.1278064444644098 + 2.2561475100698357e-20i, 0.0 + 0.0i, -0.009748568662224014 + 0.0004503316001942504i }, { -0.0009910080137775117 + 0.0009790180991492718i, 0.0 + 0.0i, 0.010775614216259295 + -0.013093223680337482i, 0.0 + 0.0i, -0.010091894393180258 + -0.0008101402354268645i, 0.0 + 0.0i, 0.13050071866504576 + 3.454470069654893e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.0009244724556896446 + 0.0009702598476963825i, 0.0 + 0.0i, 0.010642674723677924 + -0.012937562315527605i, 0.0 + 0.0i, -0.009748568662224014 + -0.0004503316001942504i, 0.0 + 0.0i, 0.1291598969446459 + 1.1068896974120223e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, true, false, true, false, false, true}), ElementsAreArray({ DoubleNear(0.12103232737281408, 1.0e-7), DoubleNear(0.11912346209227445, 1.0e-7), DoubleNear(0.12184311166156145, 1.0e-7), DoubleNear(0.12063486322376653, 1.0e-7), DoubleNear(0.12989917557548206, 1.0e-7), DoubleNear(0.1278064444644098, 1.0e-7), DoubleNear(0.13050071866504576, 1.0e-7), DoubleNear(0.1291598969446459, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, true, false, false, true, true, false}), Matrix({ { 0.11011880047316469 + 6.075238317759408e-20i, 0.0 + 0.0i, 0.012719827909233566 + -0.010518084699919572i, 0.0 + 0.0i, 0.005290076220058976 + -0.009123812714181674i, 0.0 + 0.0i, -0.0003560561091973162 + -0.0016625882395386927i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.10755030445922241 + -3.373583719099966e-20i, 0.0 + 0.0i, 0.010218206895116367 + -0.0020732341384985652i, 0.0 + 0.0i, 0.005173338012293216 + -0.008913938710577034i, 0.0 + 0.0i, 0.0001976187738683806 + -0.001093658036623998i }, { 0.012719827909233566 + 0.010518084699919572i, 0.0 + 0.0i, 0.15824455394642578 + 8.470329472543003e-20i, 0.0 + 0.0i, 0.001536920911508542 + -0.0004199734538043433i, 0.0 + 0.0i, 0.007062885010032025 + -0.012776772828501122i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.010218206895116367 + 0.0020732341384985652i, 0.0 + 0.0i, 0.1572625860975606 + 2.911675756186567e-22i, 0.0 + 0.0i, 0.0007378193496380541 + -0.0005699796336350644i, 0.0 + 0.0i, 0.007087542423510816 + -0.012735369228982519i }, { 0.005290076220058975 + 0.009123812714181674i, 0.0 + 0.0i, 0.001536920911508542 + 0.0004199734538043433i, 0.0 + 0.0i, 0.0967425134248247 + -9.796972130203139e-21i, 0.0 + 0.0i, 0.011142397693138115 + -0.009426929718363489i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.005173338012293218 + 0.008913938710577034i, 0.0 + 0.0i, 0.0007378193496380542 + 0.0005699796336350644i, 0.0 + 0.0i, 0.09449525379697192 + 1.7168805749275718e-20i, 0.0 + 0.0i, 0.008939830568284745 + -0.0020755859387718337i }, { -0.000356056109197316 + 0.0016625882395386927i, 0.0 + 0.0i, 0.007062885010032025 + 0.012776772828501124i, 0.0 + 0.0i, 0.011142397693138115 + 0.009426929718363489i, 0.0 + 0.0i, 0.1381694654304882 + -2.8375603733019055e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.00019761877386838083 + 0.001093658036623998i, 0.0 + 0.0i, 0.007087542423510816 + 0.012735369228982519i, 0.0 + 0.0i, 0.008939830568284745 + 0.0020755859387718333i, 0.0 + 0.0i, 0.13741652237134178 + 2.7978557038993596e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, true, false, false, true, true, false}), ElementsAreArray({ DoubleNear(0.11011880047316469, 1.0e-7), DoubleNear(0.10755030445922241, 1.0e-7), DoubleNear(0.15824455394642578, 1.0e-7), DoubleNear(0.1572625860975606, 1.0e-7), DoubleNear(0.0967425134248247, 1.0e-7), DoubleNear(0.09449525379697192, 1.0e-7), DoubleNear(0.1381694654304882, 1.0e-7), DoubleNear(0.13741652237134178, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, true, false, false, true, false, true}), Matrix({ { 0.09993011838878332 + 1.5932273822145918e-20i, 0.0 + 0.0i, 0.01151766227861786 + -0.009681991605329808i, 0.0 + 0.0i, 0.008810060778146538 + 0.010675839968349109i, 0.0 + 0.0i, 0.00199148117290827 + 0.0004006932614624867i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.09760894312999564 + 4.5156309201649245e-21i, 0.0 + 0.0i, 0.009245021314055586 + -0.0020824447182689115i, 0.0 + 0.0i, 0.008597145938069645 + 0.010421606927143239i, 0.0 + 0.0i, 0.0009383493606268142 + 0.0008702357357242162i }, { 0.01151766227861786 + 0.009681991605329808i, 0.0 + 0.0i, 0.14294532064559223 + 2.864030152903603e-20i, 0.0 + 0.0i, 5.12849142700418e-05 + 0.002085764370375461i, 0.0 + 0.0i, 0.012734948009729661 + 0.015597385904451448i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.009245021314055586 + 0.0020824447182689106i, 0.0 + 0.0i, 0.14214938218604534 + -2.644330982209519e-20i, 0.0 + 0.0i, 0.0006984423551477828 + 0.001131554543219104i, 0.0 + 0.0i, 0.01261985128275557 + 0.015459606486833564i }, { 0.008810060778146538 + -0.010675839968349109i, 0.0 + 0.0i, 5.1284914270041746e-05 + -0.002085764370375461i, 0.0 + 0.0i, 0.10693119550920606 + 3.5023137225245034e-20i, 0.0 + 0.0i, 0.012344563323753822 + -0.010263022812953253i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.008597145938069645 + -0.010421606927143237i, 0.0 + 0.0i, 0.0006984423551477828 + -0.001131554543219104i, 0.0 + 0.0i, 0.10443661512619869 + -2.1082662361888864e-20i, 0.0 + 0.0i, 0.009913016149345527 + -0.002066375359001488i }, { 0.00199148117290827 + -0.0004006932614624867i, 0.0 + 0.0i, 0.012734948009729661 + -0.015597385904451448i, 0.0 + 0.0i, 0.012344563323753822 + 0.010263022812953253i, 0.0 + 0.0i, 0.15346869873132177 + 2.768738946337495e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.0009383493606268142 + -0.0008702357357242162i, 0.0 + 0.0i, 0.01261985128275557 + -0.01545960648683356i, 0.0 + 0.0i, 0.009913016149345527 + 0.002066375359001488i, 0.0 + 0.0i, 0.15252972628285705 + 5.471303443670744e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, true, false, false, true, false, true}), ElementsAreArray({ DoubleNear(0.09993011838878332, 1.0e-7), DoubleNear(0.09760894312999564, 1.0e-7), DoubleNear(0.14294532064559223, 1.0e-7), DoubleNear(0.14214938218604534, 1.0e-7), DoubleNear(0.10693119550920606, 1.0e-7), DoubleNear(0.10443661512619869, 1.0e-7), DoubleNear(0.15346869873132177, 1.0e-7), DoubleNear(0.15252972628285705, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, true, false, false, false, true, true}), Matrix({ { 0.11988976911648438 + 4.0631731868104403e-20i, 0.0 + 0.0i, -0.006843085008593465 + -0.02315435987354135i, 0.0 + 0.0i, 0.012136621979715583 + 0.0065160733071092216i, 0.0 + 0.0i, 0.01725274129932335 + 0.009357758308539445i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.11832989369167228 + -2.537190392772615e-20i, 0.0 + 0.0i, -0.0067602416482232565 + -0.022858857266676864i, 0.0 + 0.0i, 0.011937651962856694 + 0.006366823977831572i, 0.0 + 0.0i, 0.016990142383976697 + 0.009200234248375998i }, { -0.006843085008593466 + 0.02315435987354135i, 0.0 + 0.0i, 0.12298566991789117 + 3.940843483077545e-21i, 0.0 + 0.0i, 0.024542364087002774 + 0.008800076214662337i, 0.0 + 0.0i, 0.009408386808160616 + 0.019757152565691334i, 0.0 + 0.0i }, { 0.0 + 0.0i, -0.0067602416482232565 + 0.022858857266676864i, 0.0 + 0.0i, 0.1214284316243687 + 3.444225025795883e-21i, 0.0 + 0.0i, 0.02417046963234876 + 0.008684498710026729i, 0.0 + 0.0i, 0.00927934525796852 + 0.01951438943614523i }, { 0.012136621979715583 + -0.006516073307109222i, 0.0 + 0.0i, 0.024542364087002774 + -0.008800076214662337i, 0.0 + 0.0i, 0.14847358530310611 + 1.0482394603491973e-19i, 0.0 + 0.0i, 0.019196046238684466 + 0.001253774330858552i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.011937651962856694 + -0.006366823977831572i, 0.0 + 0.0i, 0.02417046963234876 + -0.008684498710026729i, 0.0 + 0.0i, 0.14648299686511074 + -8.072765687654854e-21i, 0.0 + 0.0i, 0.019021122084027287 + 0.001209549327117311i }, { 0.01725274129932335 + -0.009357758308539445i, 0.0 + 0.0i, 0.009408386808160616 + -0.019757152565691334i, 0.0 + 0.0i, 0.019196046238684466 + -0.001253774330858552i, 0.0 + 0.0i, 0.11192630893742173 + -4.211341934629974e-20i, 0.0 + 0.0i }, { 0.0 + 0.0i, 0.016990142383976697 + -0.009200234248375998i, 0.0 + 0.0i, 0.00927934525796852 + -0.019514389436145224i, 0.0 + 0.0i, 0.01902112208402729 + -0.001209549327117311i, 0.0 + 0.0i, 0.110483344543945 + 4.170313776247343e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, true, false, false, false, true, true}), ElementsAreArray({ DoubleNear(0.11988976911648438, 1.0e-7), DoubleNear(0.11832989369167228, 1.0e-7), DoubleNear(0.12298566991789117, 1.0e-7), DoubleNear(0.1214284316243687, 1.0e-7), DoubleNear(0.14847358530310611, 1.0e-7), DoubleNear(0.14648299686511074, 1.0e-7), DoubleNear(0.11192630893742173, 1.0e-7), DoubleNear(0.110483344543945, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, true, true, true, false, false}), Matrix({ { 0.10143164412888231 + 1.5584721344782815e-20i, -0.018002563590570442 + -0.0004821213840625058i, -0.006201783091479579 + -0.002033532121426358i, 0.000928690328278491 + 7.162325577614815e-06i, 0.010690334726919354 + -0.006498141080280755i, -0.003013525406972174 + 0.0008471175733193678i, -0.0016274569147088453 + -0.00012873767114790277i, -3.871721435037927e-06 + -0.0006312116463079974i }, { -0.018002563590570442 + 0.00048212138406250555i, 0.09890616035646708 + 5.637714827761713e-21i, 0.0018174248209833293 + 0.0005207434427051036i, -0.007483321871155281 + 0.00022370679262381777i, -0.0017222724707418651 + 0.0006084638146343338i, 0.010889578418489792 + -0.0031158269510819098i, -0.00011718817576576302 + -0.0008581830163821805i, -0.0017804371580020274 + -1.0592751987557777e-05i }, { -0.006201783091479579 + 0.002033532121426358i, 0.0018174248209833293 + -0.0005207434427051036i, 0.10832047267728737 + 1.1802401556235375e-20i, -0.018968263021425794 + -0.001478358751874092i, 0.0004152540526598442 + -0.00013752606743369872i, -0.0007207944273887192 + 0.000491603618833683i, 0.010856111186936888 + -0.00911628901426369i, -0.0021960586994827147 + 0.0013178616011436618i }, { 0.000928690328278491 + -7.162325577614802e-06i, -0.007483321871155281 + -0.00022370679262381777i, -0.018968263021425794 + 0.0014783587518740918i, 0.10024859499154697 + 1.3635418768871095e-21i, -0.0006447345867062579 + 0.00047110335305336004i, 7.54929150832247e-05 + -0.0006402554573195014i, -0.0008473948608051726 + 0.001583387566772407i, 0.01058423873342676 + -0.0053635774499271064i }, { 0.010690334726919354 + 0.006498141080280755i, -0.0017222724707418647 + -0.000608463814634334i, 0.00041525405265984425 + 0.00013752606743369866i, -0.000644734586706258 + -0.00047110335305336015i, 0.14466456859829496 + -5.823351512373315e-22i, -0.0270109813044939 + 0.0015308664576430828i, -0.010852978996560743 + 0.0003323642932100661i, 0.0014831430109122413 + -0.0009642485920452134i }, { -0.003013525406972174 + -0.0008471175733193679i, 0.010889578418489792 + 0.0031158269510819098i, -0.0007207944273887191 + -0.000491603618833683i, 7.549291508322468e-05 + 0.0006402554573195014i, -0.0270109813044939 + -0.001530866457643083i, 0.15285903642133603 + 4.1786494428012517e-20i, 0.0026773572598755273 + 3.35770457465128e-05i, -0.01365638945931259 + 0.0037048076977012107i }, { -0.0016274569147088453 + 0.00012873767114790274i, -0.00011718817576576306 + 0.0008581830163821807i, 0.010856111186936888 + 0.00911628901426369i, -0.0008473948608051726 + -0.001583387566772407i, -0.010852978996560743 + -0.0003323642932100661i, 0.0026773572598755273 + -3.357704574651286e-05i, 0.14663816310099068 + 8.999725064576941e-22i, -0.02643199808590911 + 3.9326048767404404e-05i }, { -3.871721435037988e-06 + 0.0006312116463079974i, -0.0017804371580020274 + 1.0592751987557804e-05i, -0.0021960586994827142 + -0.0013178616011436618i, 0.01058423873342676 + 0.005363577449927106i, 0.0014831430109122415 + 0.0009642485920452134i, -0.01365638945931259 + -0.0037048076977012107i, -0.02643199808590911 + -3.9326048767404566e-05i, 0.14693135972519467 + 4.2493283823790355e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, true, true, true, false, false}), ElementsAreArray({ DoubleNear(0.10143164412888231, 1.0e-7), DoubleNear(0.09890616035646708, 1.0e-7), DoubleNear(0.10832047267728737, 1.0e-7), DoubleNear(0.10024859499154697, 1.0e-7), DoubleNear(0.14466456859829496, 1.0e-7), DoubleNear(0.15285903642133603, 1.0e-7), DoubleNear(0.14663816310099068, 1.0e-7), DoubleNear(0.14693135972519467, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, true, true, false, true, false}), Matrix({ { 0.13089764196426584 + 2.5974109838448843e-20i, -0.024153057666245762 + -2.2640604285966196e-05i, -0.009130221914211567 + -0.0008144723762295825i, 0.0013450552734815386 + -0.0004977643329773254i, 0.006401635542936006 + -0.011016001760389001i, -0.0003011130360816884 + 0.0024745715819931994i, -0.0005080230199776433 + 0.0005775043944001258i, -6.168795005029895e-05 + -8.534999437483277e-05i }, { -0.024153057666245762 + 2.264060428596598e-05i, 0.1347920453848752 + 3.2107146202058875e-20i, 0.002416265780954053 + 0.0001965631436267328i, -0.011384070292766467 + 0.0022048071274526166i, -0.0016284608248970725 + 0.0011718939503154197i, 0.00557748355431091 + -0.01050712182275607i, 0.00020558444798331605 + -6.067390182203337e-05i, -0.0002975716615584656 + 0.000811575174695595i }, { -0.009130221914211567 + 0.0008144723762295825i, 0.002416265780954053 + -0.00019656314362673276i, 0.1353938957919346 + 2.894158384833411e-20i, -0.024258104507067516 + -0.0013129278100909327i, -0.00024267929776451399 + 0.0008757146600355848i, -3.282572099067188e-05 + -0.00029871088666944483i, 0.0068846794738585265 + -0.011548828238012189i, -0.0005638527817293819 + 0.0024877385797286737i }, { 0.0013450552734815386 + 0.0004977643329773254i, -0.011384070292766467 + -0.0022048071274526166i, -0.02425810450706752 + 0.0013129278100909327i, 0.13209266183529791 + 2.4988168398801298e-20i, 6.204608124977742e-05 + -1.8820224223449906e-05i, -0.0004907865088498858 + 0.0008651847306311055i, -0.0016095998193027103 + 0.0013674228065448878i, 0.0057500430947895875 + -0.010477941661085092i }, { 0.006401635542936006 + 0.011016001760389001i, -0.0016284608248970725 + -0.0011718939503154197i, -0.00024267929776451404 + -0.0008757146600355848i, 6.204608124977742e-05 + 1.8820224223449906e-05i, 0.11519857076291146 + -1.0971723644903359e-20i, -0.02086048722881858 + 0.0010713856778665433i, -0.007924540173828754 + -0.0008866954519867091i, 0.0010667780657091942 + -0.00045932193349027315i }, { -0.0003011130360816884 + -0.0024745715819931994i, 0.00557748355431091 + 0.01050712182275607i, -3.282572099067188e-05 + 0.0002987108866694449i, -0.0004907865088498858 + -0.0008651847306311055i, -0.020860487228818583 + -0.0010713856778665435i, 0.11697315139292795 + 1.5317063053715358e-20i, 0.002078516299904803 + 0.0003577573448248837i, -0.009755641037701403 + 0.0017237073628724117i }, { -0.0005080230199776434 + -0.0005775043944001257i, 0.00020558444798331603 + 6.067390182203338e-05i, 0.0068846794738585265 + 0.011548828238012189i, -0.0016095998193027103 + -0.0013674228065448878i, -0.007924540173828754 + 0.0008866954519867091i, 0.002078516299904803 + -0.0003577573448248837i, 0.11956473998634344 + -1.623920978564104e-20i, -0.021142156600267387 + -0.00012610489301575491i }, { -6.168795005029896e-05 + 8.534999437483276e-05i, -0.0002975716615584656 + -0.000811575174695595i, -0.0005638527817293819 + -0.0024877385797286737i, 0.005750043094789589 + 0.010477941661085094i, 0.001066778065709194 + 0.0004593219334902732i, -0.009755641037701403 + -0.0017237073628724115i, -0.021142156600267387 + 0.00012610489301575467i, 0.11508729288144373 + 1.8868657301876167e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, true, true, false, true, false}), ElementsAreArray({ DoubleNear(0.13089764196426584, 1.0e-7), DoubleNear(0.1347920453848752, 1.0e-7), DoubleNear(0.1353938957919346, 1.0e-7), DoubleNear(0.13209266183529791, 1.0e-7), DoubleNear(0.11519857076291146, 1.0e-7), DoubleNear(0.11697315139292795, 1.0e-7), DoubleNear(0.11956473998634344, 1.0e-7), DoubleNear(0.11508729288144373, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, true, true, false, false, true}), Matrix({ { 0.11867298073081994 + -6.185337318529653e-21i, -0.021770467768075934 + 0.00012351595378965114i, -0.008186691089324518 + -0.0008779007062791368i, 0.0011785055538922821 + -0.00043145816885656113i, 0.011118500780532142 + 0.012850379072054344i, -0.001877705161644024 + -0.0007040002443886107i, -0.0007779666718910922 + -0.0009672765223226079i, 7.366424490111491e-05 + -7.4749757320406526e-06i }, { -0.021770467768075938 + -0.00012351595378965125i, 0.12148280873426859 + 1.7884631675079956e-20i, 0.0021661545874555477 + 0.00023002017923755681i, -0.0101673192737794 + 0.0018447755327667588i, -0.0013905719318973008 + -0.003957116590141285i, 0.010225216288232053 + 0.013273274218857923i, 0.00013975929986945884 + 0.00046825006493324376i, -0.0011375137975760644 + -0.0009820014245230466i }, { -0.008186691089324518 + 0.0008779007062791368i, 0.0021661545874555477 + -0.00023002017923755673i, 0.12308525238694552 + -7.751001641763758e-21i, -0.02194950097468373 + -0.0010633242295661793i, -0.0008205481757139813 + -0.0009017917406238973i, 0.00021918589300917024 + 1.66131942658982e-05i, 0.011412661219907437 + 0.013150499437411634i, -0.001885062294203292 + -0.0008928564079044549i }, { 0.0011785055538922821 + 0.0004314581688565612i, -0.0101673192737794 + -0.0018447755327667588i, -0.02194950097468373 + 0.001063324229566179i, 0.11939272249838245 + 1.869660373446514e-20i, -7.354108837944396e-05 + 0.0002547671414839733i, -0.0005976726496468547 + -0.001328815390738714i, -0.001674556005820664 + -0.0037769103869330087i, 0.01000562772002978 + 0.012880286558453453i }, { 0.011118500780532142 + -0.012850379072054344i, -0.0013905719318973008 + 0.003957116590141286i, -0.0008205481757139813 + 0.0009017917406238972i, -7.354108837944397e-05 + -0.00025476714148397334i, 0.12742323199635733 + 2.1187723512075136e-20i, -0.023243077126988407 + 0.0009252291197909259i, -0.008868070998715803 + -0.000823267121937155i, 0.0012333277852984506 + -0.0005256280976110375i }, { -0.001877705161644024 + 0.0007040002443886106i, 0.010225216288232053 + -0.013273274218857923i, 0.00021918589300917027 + -1.6613194265898207e-05i, -0.0005976726496468547 + 0.001328815390738714i, -0.023243077126988407 + -0.0009252291197909262i, 0.13028238804353454 + 2.953957758069428e-20i, 0.0023286274934033084 + 0.0003243003092140597i, -0.01097239205668847 + 0.0020837389575582696i }, { -0.0007779666718910922 + 0.0009672765223226079i, 0.00013975929986945887 + -0.0004682500649332438i, 0.011412661219907437 + -0.013150499437411634i, -0.001674556005820664 + 0.003776910386933009i, -0.008868070998715803 + 0.000823267121937155i, 0.0023286274934033084 + -0.00032430030921405976i, 0.1318733833913325 + 2.0453375704456827e-20i, -0.023450760132651176 + -0.0003757084735405083i }, { 7.366424490111492e-05 + 7.474975732040646e-06i, -0.0011375137975760644 + 0.0009820014245230464i, -0.0018850622942032922 + 0.0008928564079044548i, 0.01000562772002978 + -0.012880286558453453i, 0.0012333277852984504 + 0.0005256280976110375i, -0.01097239205668847 + -0.0020837389575582696i, -0.023450760132651176 + 0.00037570847354050833i, 0.1277872322183592 + 2.5160221966212325e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, true, true, false, false, true}), ElementsAreArray({ DoubleNear(0.11867298073081994, 1.0e-7), DoubleNear(0.12148280873426859, 1.0e-7), DoubleNear(0.12308525238694552, 1.0e-7), DoubleNear(0.11939272249838245, 1.0e-7), DoubleNear(0.12742323199635733, 1.0e-7), DoubleNear(0.13028238804353454, 1.0e-7), DoubleNear(0.1318733833913325, 1.0e-7), DoubleNear(0.1277872322183592, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, true, false, true, true, false}), Matrix({ { 0.11132038606765493 + 2.714889488460292e-20i, -0.01972175815118378 + -0.0014766441814345688i, 0.01145140248280533 + -0.008185776437582028i, -0.002792142550622308 + 0.0010569090367110406i, 0.0057416081061830125 + -0.00954297046977581i, -0.0005413341240115383 + 0.0020232858842653845i, -0.00020267023412494844 + -0.0015149547602812878i, 7.845188475083116e-05 + 0.0003708843988815871i }, { -0.01972175815118378 + 0.0014766441814345686i, 0.10634871886473216 + -1.3234889800848706e-22i, -0.00137345458769517 + 0.0011683558366114878i, 0.011486632321544604 + -0.004405542400836108i, -0.001300370196070877 + 0.0011721138084391993i, 0.004721806126169178 + -0.008494780954982899i, 1.9183330799040527e-05 + 0.00016976670181818748i, 4.4232898796013153e-05 + -0.001241291515881403i }, { 0.01145140248280533 + 0.008185776437582028i, -0.0013734545876951695 + -0.001168355836611488i, 0.15497115168854547 + 2.776679880218003e-20i, -0.028689404022129498 + 0.00014107576705766982i, 0.0013446816963522475 + -0.00042535776854504955i, -0.00015217502252111063 + 5.609712061343272e-05i, 0.007544706910611522 + -0.01302185952862538i, -0.00032363169379953215 + 0.002939024277456489i }, { -0.002792142550622308 + -0.0010569090367110409i, 0.011486632321544604 + 0.004405542400836108i, -0.028689404022129498 + -0.00014107576705766993i, 0.16053598835544092 + 5.722766349886865e-20i, -0.0002978760368091365 + 4.821915308248223e-05i, 0.0009300585647943485 + -0.0005645953188943583i, -0.0019376904481289057 + 0.001367202948421108i, 0.00660572052293132 + -0.012490282528858263i }, { 0.0057416081061830125 + 0.00954297046977581i, -0.001300370196070877 + -0.0011721138084391993i, 0.0013446816963522475 + 0.00042535776854504955i, -0.0002978760368091365 + -4.821915308248226e-05i, 0.09843173073851472 + 2.3822801641527197e-22i, -0.017249068460812457 + -0.0004838359545020291i, 0.010095043431050912 + -0.007428653656962415i, -0.0024174415558325807 + 0.001108070137751989i }, { -0.0005413341240115383 + -0.0020232858842653845i, 0.004721806126169178 + 0.008494780954982899i, -0.00015217502252111063 + -5.609712061343275e-05i, 0.0009300585647943488 + 0.0005645953188943583i, -0.017249068460812457 + 0.0004838359545020289i, 0.0928060364832819 + 7.133605602657309e-21i, -0.0011962127438518676 + 0.001023495544795253i, 0.009987184830371948 + -0.004073862000172907i }, { -0.00020267023412494844 + 0.0015149547602812878i, 1.9183330799040513e-05 + -0.0001697667018181875i, 0.007544706910611522 + 0.01302185952862538i, -0.0019376904481289057 + -0.001367202948421108i, 0.010095043431050912 + 0.007428653656962416i, -0.0011962127438518676 + -0.0010234955447952529i, 0.13633158001074014 + -2.744916144695967e-20i, -0.024753575368273512 + 0.0014291167393528175i }, { 7.845188475083119e-05 + -0.0003708843988815871i, 4.423289879601326e-05 + 0.001241291515881403i, -0.00032363169379953215 + -0.002939024277456489i, 0.00660572052293132 + 0.012490282528858265i, -0.0024174415558325803 + -0.0011080701377519887i, 0.009987184830371948 + 0.004073862000172907i, -0.024753575368273512 + -0.0014291167393528175i, 0.13925440779108977 + 2.7052114752934214e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, true, false, true, true, false}), ElementsAreArray({ DoubleNear(0.11132038606765493, 1.0e-7), DoubleNear(0.10634871886473216, 1.0e-7), DoubleNear(0.15497115168854547, 1.0e-7), DoubleNear(0.16053598835544092, 1.0e-7), DoubleNear(0.09843173073851472, 1.0e-7), DoubleNear(0.0928060364832819, 1.0e-7), DoubleNear(0.13633158001074014, 1.0e-7), DoubleNear(0.13925440779108977, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, true, false, true, false, true}), Matrix({ { 0.10130372585732239 + 1.351282248666626e-20i, -0.017871625968319423 + -0.0012411063065434801i, 0.01039594499672302 + -0.007605719511309956i, -0.002527024019282305 + 0.0010103479476022941i, 0.009356422648864722 + 0.010768780581470922i, -0.0015322926262180203 + -0.0007848218563523987i, 0.0016950745948856236 + 0.00047118214694693075i, -0.00029631670627190855 + 1.7602217294311327e-05i }, { -0.017871625968319423 + 0.00124110630654348i, 0.09623533566145656 + 6.935082255644583e-21i, -0.0012346865860480192 + 0.0010880179038010363i, 0.010366738595950423 + -0.0041587168122887656i, -0.0014495677369550496 + -0.003007996503536248i, 0.008050784067351461 + 0.010328666314021425i, -0.00020540554839962376 + -0.00011636543195932327i, 0.0012347559386494602 + 0.000799746850239772i }, { 0.01039594499672302 + 0.007605719511309956i, -0.001234686586048019 + -0.0010880179038010363i, 0.14045450726044306 + -2.744916144695967e-20i, -0.025848342774440244 + 0.0003012980307669518i, 0.00024298473332625596 + 0.0017654373782508407i, -2.7457360410091475e-05 + -0.00015450543690860455i, 0.013174739351574857 + 0.015232097927995058i, -0.002230474829629296 + -0.000812034795940667i }, { -0.0025270240192823046 + -0.0010103479476022941i, 0.010366738595950423 + 0.004158716812288765i, -0.025848342774440244 + -0.0003012980307669522i, 0.14464019557119445 + 2.964615315390051e-20i, -5.7588764121615745e-05 + -0.0005496498348066792i, 0.0005067425360915686 + 0.0014518815353437241i, -0.0016155602007629152 + -0.0047260304735380464i, 0.012180059940910372 + 0.01582489446328995i }, { 0.009356422648864722 + -0.01076878058147092i, -0.0014495677369550498 + 0.003007996503536248i, 0.00024298473332625586 + -0.0017654373782508407i, -5.7588764121615827e-05 + 0.000549649834806679i, 0.10844839094884726 + 1.387430041435193e-20i, -0.019099200643676813 + -0.0007193738293931178i, 0.01115050091713322 + -0.008008710583234489i, -0.0026825600871725835 + 0.0011546312268607356i }, { -0.0015322926262180203 + 0.0007848218563523987i, 0.008050784067351461 + -0.010328666314021424i, -2.7457360410091486e-05 + 0.00015450543690860458i, 0.0005067425360915687 + -0.0014518815353437241i, -0.019099200643676813 + 0.0007193738293931176i, 0.10291941968655749 + 6.617444900423958e-23i, -0.0013349807454990184 + 0.0011038334776057044i, 0.011107078555966127 + -0.004320687588720251i }, { 0.0016950745948856236 + -0.00047118214694693075i, -0.0002054055483996238 + 0.00011636543195932324i, 0.013174739351574857 + -0.01523209792799506i, -0.0016155602007629152 + 0.0047260304735380464i, 0.01115050091713322 + 0.00800871058323449i, -0.0013349807454990184 + -0.0011038334776057044i, 0.15084822443884255 + 2.776679880218003e-20i, -0.027594636615962766 + 0.0012688944756435354i }, { -0.0002963167062719085 + -1.7602217294311327e-05i, 0.0012347559386494602 + -0.000799746850239772i, -0.002230474829629296 + 0.0008120347959406668i, 0.012180059940910372 + -0.01582489446328995i, -0.0026825600871725835 + -0.0011546312268607356i, 0.011107078555966127 + 0.004320687588720251i, -0.027594636615962766 + -0.0012688944756435354i, 0.15515020057533624 + 5.463362509790236e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, true, false, true, false, true}), ElementsAreArray({ DoubleNear(0.10130372585732239, 1.0e-7), DoubleNear(0.09623533566145656, 1.0e-7), DoubleNear(0.14045450726044306, 1.0e-7), DoubleNear(0.14464019557119445, 1.0e-7), DoubleNear(0.10844839094884726, 1.0e-7), DoubleNear(0.10291941968655749, 1.0e-7), DoubleNear(0.15084822443884255, 1.0e-7), DoubleNear(0.15515020057533624, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, true, false, false, true, true}), Matrix({ { 0.11869746256536905 + 1.377752028268323e-20i, -0.021748624692570925 + -0.0015839050623028682i, -0.006153489259208694 + -0.023339141161259104i, 0.001974092817280515 + 0.005654065881673184i, 0.012620179175569148 + 0.005338532616322816i, -0.00030644549361749077 + 0.0003265997242839577i, 0.01734551859435133 + 0.009073456788720019i, -0.002943364534542278 + -0.000814965984638805i }, { -0.021748624692570925 + 0.0015839050623028678i, 0.11952220024278759 + 1.4823076576950256e-21i, 0.0009036745084970274 + 0.0025000908727604854i, -0.007449837397608027 + -0.02267407597895911i, -0.003525329253659666 + -0.0032160934909478502i, 0.01145409476700313 + 0.007544364668617978i, -0.0029665881098367595 + -0.002615752444987744i, 0.01689736508894872 + 0.009484535768195424i }, { -0.006153489259208694 + 0.023339141161259104i, 0.0009036745084970274 + -0.0025000908727604854i, 0.12306077055239642 + -2.771385924297664e-20i, -0.021971344050188742 + 0.00064409678652634i, 0.023871382108328246 + 0.008627821449223397i, -0.004188924583047674 + -0.0021251117890705596i, 0.009910982824870431 + 0.020662345893143162i, -0.0034563219622298254 + -0.0019234563765770233i }, { 0.001974092817280515 + -0.005654065881673184i, -0.007449837397608027 + 0.02267407597895911i, -0.021971344050188742 + -0.0006440967865263402i, 0.12135333098986342 + 3.509892775185007e-20i, -0.004786097525061973 + -0.001095332119887856i, 0.02484145161102329 + 0.008856753475465669i, 0.00046020131594170133 + -0.004517933486126445i, 0.008776749241258706 + 0.018609196108693396i }, { 0.012620179175569148 + -0.005338532616322817i, -0.0035253292536596664 + 0.0032160934909478507i, 0.023871382108328246 + -0.008627821449223397i, -0.004786097525061973 + 0.0010953321198878562i, 0.14759407519083137 + 4.1138173404099725e-20i, -0.026662537480742352 + 0.00024833664792596927i, 0.01943980427600323 + 0.000774311162857914i, -0.0028390586350915854 + -0.0006917557199513107i }, { -0.0003064454936174909 + -0.0003265997242839578i, 0.01145409476700313 + -0.007544364668617978i, -0.004188924583047673 + 0.0021251117890705596i, 0.02484145161102329 + -0.008856753475465669i, -0.026662537480742352 + -0.0002483366479259692i, 0.14736250697738548 + 5.561300694316514e-20i, -0.004141735152696811 + 3.922588409982191e-05i, 0.018777364046708524 + 0.0016890124951179487i }, { 0.01734551859435133 + -0.009073456788720019i, -0.00296658810983676 + 0.0026157524449877444i, 0.009910982824870431 + -0.020662345893143162i, 0.00046020131594170144 + 0.004517933486126445i, 0.01943980427600323 + -0.0007743111628579141i, -0.004141735152696811 + -3.922588409982196e-05i, 0.11170254019685845 + 5.029258124322408e-22i, -0.020031299778897227 + 0.00030118399832444845i }, { -0.002943364534542278 + 0.000814965984638805i, 0.01689736508894872 + -0.009484535768195426i, -0.0034563219622298254 + 0.0019234563765770233i, 0.008776749241258704 + -0.018609196108693396i, -0.0028390586350915854 + 0.0006917557199513107i, 0.018777364046708524 + -0.0016890124951179485i, -0.020031299778897227 + -0.0003011839983244485i, 0.11070711328450825 + -9.132073962585456e-22i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, true, false, false, true, true}), ElementsAreArray({ DoubleNear(0.11869746256536905, 1.0e-7), DoubleNear(0.11952220024278759, 1.0e-7), DoubleNear(0.12306077055239642, 1.0e-7), DoubleNear(0.12135333098986342, 1.0e-7), DoubleNear(0.14759407519083137, 1.0e-7), DoubleNear(0.14736250697738548, 1.0e-7), DoubleNear(0.11170254019685845, 1.0e-7), DoubleNear(0.11070711328450825, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, false, true, true, true, false}), Matrix({ { 0.10673807725170939 + 1.6135942934885017e-20i, -0.007345734883467684 + -0.0008843106447370757i, 0.011521406020409727 + -0.005002876397272162i, -0.0018151282636099252 + -6.356871359707628e-05i, 0.005020970247708545 + -0.008776190523785617i, -0.00041036875288311884 + 0.00042391208984934506i, 2.932691180790965e-06 + -0.001305284277086323i, -0.00011634450413620692 + 0.00014464351188985103i }, { -0.007345734883467684 + 0.0008843106447370757i, 0.11093102768067771 + 1.0880603051709414e-20i, 0.0002584004187976169 + -0.0004341557448514464i, 0.011416628783940206 + -0.007588442441145976i, -0.00014635646614674457 + 0.000701539311084234i, 0.005442443984643646 + -0.009261560900973093i, -1.678320274401784e-05 + -2.878209773506012e-05i, -0.00016137002650972636 + -0.0014509619990763678i }, { 0.011521406020409727 + 0.005002876397272163i, 0.0002584004187976169 + 0.00043415574485144634i, 0.1589516100974316 + 4.19453131056227e-20i, -0.013168557323510351 + 0.0022746453959601102i, 0.0010038736856374 + -0.0005467820875097052i, 2.862293421340018e-05 + -9.807192336312709e-06i, 0.006958148849538371 + -0.012746933059359453i, -0.0003952259286529899 + 0.0009651674792463758i }, { -0.0018151282636099252 + 6.356871359707631e-05i, 0.011416628783940206 + 0.007588442441145975i, -0.013168557323510351 + -0.0022746453959601102i, 0.15655552994655478 + 4.3049149195425996e-20i, -8.815090026773052e-05 + 0.00016434058295565325i, 0.0012708665755091961 + -0.0004431709999297025i, -0.0005871093404676553 + 0.001039360079582456i, 0.00719227858400447 + -0.012765208998124191i }, { 0.005020970247708545 + 0.008776190523785617i, -0.00014635646614674457 + -0.000701539311084234i, 0.0010038736856374001 + 0.0005467820875097052i, -8.815090026773056e-05 + -0.00016434058295565325i, 0.09359972723364 + 5.08649323765951e-21i, -0.006339370079167176 + -0.0009255146840654642i, 0.010058507124999418 + -0.004611091634090502i, -0.0015927658091009476 + -7.576170953838426e-05i }, { -0.0004103687528831189 + -0.00042391208984934506i, 0.005442443984643646 + 0.009261560900973093i, 2.8622934213400186e-05 + 9.807192336312719e-06i, 0.0012708665755091961 + 0.0004431709999297025i, -0.006339370079167176 + 0.0009255146840654642i, 0.09763803998815662 + 2.2853403814130713e-21i, 0.00023234654894545198 + -0.00034362577990175376i, 0.01002372113642344 + -0.0068914240230448206i }, { 2.932691180790965e-06 + 0.001305284277086323i, -1.678320274401785e-05 + 2.8782097735060137e-05i, 0.006958148849538371 + 0.012746933059359452i, -0.0005871093404676554 + -0.001039360079582456i, 0.010058507124999418 + 0.004611091634090502i, 0.00023234654894545198 + 0.00034362577990175376i, 0.1385719949221994 + -7.411538288475128e-22i, -0.011340811132362981 + 0.0017625265949511668i }, { -0.00011634450413620694 + -0.00014464351188985105i, -0.00016137002650972625 + 0.0014509619990763678i, -0.00039522592865299014 + -0.0009651674792463758i, 0.00719227858400447 + 0.012765208998124191i, -0.0015927658091009476 + 7.576170953838425e-05i, 0.01002372113642344 + 0.0068914240230448206i, -0.011340811132362981 + -0.0017625265949511666i, 0.13701399287963056 + 3.441071348220565e-22i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, false, true, true, true, false}), ElementsAreArray({ DoubleNear(0.10673807725170939, 1.0e-7), DoubleNear(0.11093102768067771, 1.0e-7), DoubleNear(0.1589516100974316, 1.0e-7), DoubleNear(0.15655552994655478, 1.0e-7), DoubleNear(0.09359972723364, 1.0e-7), DoubleNear(0.09763803998815662, 1.0e-7), DoubleNear(0.1385719949221994, 1.0e-7), DoubleNear(0.13701399287963056, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, false, true, true, false, true}), Matrix({ { 0.0967302657926734 + 1.069344273168582e-20i, -0.006579557548923384 + -0.000917636479146116i, 0.010409352673058715 + -0.004704722182361747i, -0.0016444586505328226 + -6.576785266885341e-05i, 0.008550409192969751 + 0.010397570241755097i, -0.0005557853886164303 + -0.0008018367002203299i, 0.0013454644342761443 + 0.0007544424453584932i, -0.00013187581759285566 + -0.00019283696648705572i }, { -0.006579557548923384 + 0.000917636479146116i, 0.10080879572610557 + 9.754462010625023e-21i, 0.0002429529691969642 + -0.0003699881657068521i, 0.010353330919614729 + -0.007059714141236973i, -0.0006347296508667046 + -0.0006911631934716674i, 0.008856797523246432 + 0.010699876653737252i, 5.6928220843045946e-05 + 5.63773732226328e-06i, 0.0015843660992589396 + 0.0005164865518282097i }, { 0.010409352673058715 + 0.004704722182361747i, 0.0002429529691969642 + 0.0003699881657068521i, 0.14342552367241515 + 1.0058516248644817e-21i, -0.011774452814180535 + 0.001884511305633738i, 0.0005046921864933967 + 0.0015236312406820243i, -2.853001153060858e-05 + 4.4791519412888255e-05i, 0.012793307875794444 + 0.015726083049157173i, -0.001359695080850726 + -0.0011474412466253245i }, { -0.0016444586505328226 + 6.57678526688534e-05i, 0.010353330919614729 + 0.007059714141236972i, -0.011774452814180535 + -0.001884511305633738i, 0.1416691791592224 + 1.1911400820763599e-21i, -0.00014992209188441336 + -0.00014511163845152278i, 0.00024503508292442785 + 0.0016936876729125405i, -0.0007834911744941314 + -0.0015394439378909439i, 0.012561491416690787 + 0.015330909342127837i }, { 0.008550409192969751 + -0.010397570241755093i, -0.0006347296508667046 + 0.0006911631934716674i, 0.0005046921864933966 + -0.0015236312406820243i, -0.00014992209188441336 + 0.00014511163845152276i, 0.103607538692676 + 1.0528993440858708e-20i, -0.007105547413711477 + -0.0008921888496564239i, 0.01117056047235043 + -0.004909245849000917i, -0.0017634354221780504 + -7.356257046660714e-05i }, { -0.0005557853886164302 + 0.0008018367002203299i, 0.008856797523246432 + -0.010699876653737252i, -2.853001153060855e-05 + -4.479151941288827e-05i, 0.0002450350829244278 + -0.0016936876729125405i, -0.007105547413711477 + 0.0008921888496564239i, 0.10776027194272875 + 3.411481422497462e-21i, 0.0002477939985461047 + -0.00040779335904634804i, 0.011087019000748918 + -0.007420152322953823i }, { 0.0013454644342761443 + -0.0007544424453584932i, 5.692822084304595e-05 + -5.6377373222632815e-06i, 0.012793307875794444 + -0.01572608304915717i, -0.0007834911744941313 + 0.0015394439378909439i, 0.01117056047235043 + 0.004909245849000918i, 0.0002477939985461047 + 0.000407793359046348i, 0.15409808134721587 + 4.0198307651910703e-20i, -0.012734915641692797 + 0.002152660685277539i }, { -0.0001318758175928557 + 0.00019283696648705572i, 0.0015843660992589396 + -0.0005164865518282097i, -0.001359695080850726 + 0.0011474412466253245i, 0.012561491416690787 + -0.015330909342127837i, -0.0017634354221780504 + 7.356257046660716e-05i, 0.011087019000748918 + 0.007420152322953824i, -0.012734915641692797 + -0.0021526606852775385i, 0.15190034366696292 + 4.2202116248171695e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, false, true, true, false, true}), ElementsAreArray({ DoubleNear(0.0967302657926734, 1.0e-7), DoubleNear(0.10080879572610557, 1.0e-7), DoubleNear(0.14342552367241515, 1.0e-7), DoubleNear(0.1416691791592224, 1.0e-7), DoubleNear(0.103607538692676, 1.0e-7), DoubleNear(0.10776027194272875, 1.0e-7), DoubleNear(0.15409808134721587, 1.0e-7), DoubleNear(0.15190034366696292, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, false, true, false, true, true}), Matrix({ { 0.1186487155082902 + 7.39365961714085e-21i, -0.009128641150041689 + 0.0005711311891621453i, -0.0068022202611186565 + -0.02286856557292137i, 0.0006072004586992891 + 0.0016777157994535413i, 0.012062984921127007 + 0.006697150309185559i, -0.0012336574386650995 + -0.0005491851740029581i, 0.01714432618638983 + 0.00936771300186362i, -0.0015164810987368525 + -0.0006315478170096868i }, { -0.009128641150041689 + -0.0005711311891621453i, 0.11957094729986645 + 7.866168323237405e-21i, 0.00046870396762319923 + 0.0017880376534110192i, -0.006801106395698066 + -0.023144651567296847i, -0.0007012334898786178 + -0.0007861213750706786i, 0.01201128902144527 + 0.006185746975755236i, -0.0012184674779213082 + -0.0009452822483110523i, 0.01709855749691022 + 0.009190279555051825i }, { -0.0068022202611186565 + 0.02286856557292137i, 0.00046870396762319923 + -0.0017880376534110192i, 0.12150707395679834 + 4.305634739409452e-21i, -0.00922536921306223 + 0.00039574363732547684i, 0.024449754232268348 + 0.008716100600984565i, -0.002031346961467154 + -0.00040063799014872974i, 0.009280732147637189 + 0.01942650298172671i, -0.0006818230308020569 + -0.0014000927728426962i }, { 0.000607200458699289 + -0.0016777157994535413i, -0.006801106395698066 + 0.023144651567296847i, -0.00922536921306223 + -0.00039574363732547684i, 0.12290702758546151 + 3.079433769463978e-21i, -0.001934666174932027 + -0.000948883571076708i, 0.02426307948708319 + 0.008768474323704502i, -0.0007169873354822183 + -0.0014444857562919329i, 0.009406999918491948 + 0.019845039020109853i }, { 0.012062984921127007 + -0.006697150309185558i, -0.0007012334898786177 + 0.0007861213750706786i, 0.024449754232268348 + -0.008716100600984565i, -0.001934666174932027 + 0.000948883571076708i, 0.1470409718408508 + 5.0687596423366865e-20i, -0.011385651056936346 + 0.0008192035620608893i, 0.018781339358365574 + 0.0013454419897762989i, -0.0014127951402353978 + -0.00028863623035782027i }, { -0.0012336574386650995 + 0.0005491851740029581i, 0.01201128902144527 + -0.006185746975755237i, -0.0020313469614671536 + 0.0004006379901487297i, 0.02426307948708319 + -0.008768474323704502i, -0.011385651056936346 + -0.0008192035620608893i, 0.14791561032736605 + 4.6063583923898005e-20i, -0.0012021697742375993 + -4.713826274432899e-05i, 0.01943582896434618 + 0.0011178816681995636i }, { 0.01714432618638983 + -0.00936771300186362i, -0.0012184674779213082 + 0.0009452822483110523i, 0.009280732147637189 + -0.019426502981726705i, -0.0007169873354822183 + 0.0014444857562919329i, 0.018781339358365574 + -0.001345441989776299i, -0.0012021697742375993 + 4.7138262744328934e-05i, 0.11066464819904107 + 3.970466940254533e-23i, -0.008454811998467928 + 0.00044126827356022566i }, { -0.0015164810987368523 + 0.0006315478170096868i, 0.017098557496910218 + -0.009190279555051825i, -0.0006818230308020568 + 0.0014000927728426962i, 0.009406999918491948 + -0.019845039020109853i, -0.001412795140235398 + 0.0002886362303578203i, 0.01943582896434618 + -0.0011178816681995636i, -0.008454811998467928 + -0.00044126827356022556i, 0.11174500528232564 + -4.499862532288501e-22i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, false, true, false, true, true}), ElementsAreArray({ DoubleNear(0.1186487155082902, 1.0e-7), DoubleNear(0.11957094729986645, 1.0e-7), DoubleNear(0.12150707395679834, 1.0e-7), DoubleNear(0.12290702758546151, 1.0e-7), DoubleNear(0.1470409718408508, 1.0e-7), DoubleNear(0.14791561032736605, 1.0e-7), DoubleNear(0.11066464819904107, 1.0e-7), DoubleNear(0.11174500528232564, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, false, false, true, true, true}), Matrix({ { 0.09733962638599186 + 1.3354003809056079e-20i, 0.010248402994528664 + -0.005688661834082823i, -0.005519539607622145 + -0.01887254897084096i, -0.001735725618294276 + -0.0016828963226206692i, 0.009732099053456116 + 0.004857539383520699i, 0.0010476544850051158 + 5.6480685705694104e-05i, 0.013862901536999917 + 0.007402462974446094i, 0.0017851530857465455 + 7.500898515743199e-05i }, { 0.010248402994528664 + 0.005688661834082823i, 0.1408800364221648 + 1.9058241313221758e-21i, 0.0005651282305693951 + -0.0022758911676949963i, -0.008083787049194577 + -0.027140668169377255i, 0.001024126051271904 + 0.0010534991955785046i, 0.014342174889116162 + 0.008025357901420097i, 0.0011616413475803798 + 0.0015224234152514003i, 0.02037998214630013 + 0.01115552958246935i }, { -0.005519539607622145 + 0.01887254897084096i, 0.0005651282305693951 + 0.0022758911676949963i, 0.10019943513278712 + 7.093900933254764e-21i, 0.01051428059814478 + -0.006075774489515897i, 0.0196328615774585 + 0.007133328771366621i, 0.0025056283671947557 + -0.00021321806490136693i, 0.0076751076627600695 + 0.01623990751197165i, 0.001882176048529968 + 0.0012144483114810087i }, { -0.0017357256182942758 + 0.0016828963226206692i, -0.008083787049194577 + 0.027140668169377255i, 0.01051428059814478 + 0.0060757744895158965i, 0.14421466640947275 + 2.9116757561866574e-22i, 0.0016867153930294853 + 0.0017176605628428346i, 0.029079972141893035 + 0.010351246153322445i, -0.00027439878185407955 + 0.0021638197180160602i, 0.011012624403369068 + 0.02303163448986491i }, { 0.009732099053456116 + -0.004857539383520699i, 0.001024126051271904 + -0.0010534991955785046i, 0.0196328615774585 + -0.007133328771366621i, 0.0016867153930294853 + -0.0017176605628428346i, 0.12032947854639525 + 1.3662542177538352e-20i, 0.012689631809821269 + -0.006902657004335315i, 0.015982953839974334 + 0.0008347975460822508i, 0.0015772882829653404 + -0.0010733499535420215i }, { 0.0010476544850051158 + -5.6480685705694104e-05i, 0.014342174889116162 + -0.008025357901420095i, 0.0025056283671947557 + 0.00021321806490136685i, 0.029079972141893035 + -0.010351246153322445i, 0.012689631809821269 + 0.006902657004335315i, 0.1746271036218216 + 8.308863816972652e-20i, 0.001709612030577201 + 0.0012859380802555886i, 0.022234214482737418 + 0.001628526111893612i }, { 0.013862901536999917 + -0.007402462974446094i, 0.0011616413475803798 + -0.0015224234152514003i, 0.0076751076627600695 + -0.016239907511971647i, -0.00027439878185407944 + -0.0021638197180160602i, 0.015982953839974334 + -0.0008347975460822508i, 0.001709612030577201 + -0.0012859380802555886i, 0.09103833208900951 + 2.779326858178173e-22i, 0.009567947663278079 + -0.005426741167619426i }, { 0.0017851530857465455 + -7.500898515743193e-05i, 0.02037998214630013 + -0.01115552958246935i, 0.001882176048529968 + -0.0012144483114810087i, 0.011012624403369068 + -0.02303163448986491i, 0.0015772882829653404 + 0.0010733499535420215i, 0.022234214482737418 + -0.001628526111893612i, 0.009567947663278079 + 0.005426741167619426i, 0.1313713213923572 + -6.88214269644122e-22i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, false, false, true, true, true}), ElementsAreArray({ DoubleNear(0.09733962638599186, 1.0e-7), DoubleNear(0.1408800364221648, 1.0e-7), DoubleNear(0.10019943513278712, 1.0e-7), DoubleNear(0.14421466640947275, 1.0e-7), DoubleNear(0.12032947854639525, 1.0e-7), DoubleNear(0.1746271036218216, 1.0e-7), DoubleNear(0.09103833208900951, 1.0e-7), DoubleNear(0.1313713213923572, 1.0e-7) }));


}
}

}

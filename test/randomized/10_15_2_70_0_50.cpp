#include "gtest/gtest.h"
#include "gmock/gmock.h"
#include <chrono>
#include <iostream>

#include "superpositeur/Circuit.hpp"
#include "superpositeur/DefaultOperations.hpp"

namespace superpositeur {

using namespace std::complex_literals;

using testing::ElementsAreArray;
using testing::DoubleNear;

namespace {
Circuit randomCircuit() {

    Circuit c;
    c.addInstruction(CircuitInstruction({ Matrix({ { -0.08989161450127803 + 0.1168141135884046i, 0.11469729619290031 + -0.28450934005196665i }, { -0.17068638720313703 + -0.12339650083529435i, -0.05085039272618526 + 0.41987599089216376i } }), Matrix({ { 0.3618962013600956 + 0.022838375751336376i, -0.12362331394986603 + -0.1992686852954812i }, { -0.19176675277864885 + -0.21159540675248392i, 0.13607682379088282 + -0.06995964140794292i } }), Matrix({ { -0.12760264172603028 + -0.05125022581982385i, -0.09443138881714823 + 0.48309580459978363i }, { -0.1389007067125995 + -0.6393329738820875i, -0.11571141961764411 + -0.19881796330998733i } }), Matrix({ { 0.15371951121788752 + 0.31010288259591834i, -0.07357508554378861 + 0.43259600810826954i }, { 0.20349796076781904 + -0.33574079602867657i, 0.11348087609792779 + 0.38466648144388743i } }) }, { QubitIndex{ 1 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 3 }, QubitIndex{ 7 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { -0.04374715159482889 + 0.16007442766248123i, 0.022849438309404117 + 0.024610868940297966i, 0.09495000662592581 + 0.2293783486134144i, -0.08481181966591875 + -0.10964680152477678i }, { 0.11743017242431089 + -0.12985939988757336i, 0.005943300523015758 + 0.020532240367378017i, -0.21016406365427365 + 0.05646095968678191i, 0.10340809670401112 + -0.15066831500610423i }, { -0.04375468175916856 + 0.11050430703574878i, -0.0042842188630063055 + 0.05786115604120356i, -0.03941601135695732 + 0.016394656045834136i, 0.062198018583605866 + 0.004262680923287432i }, { -0.13489765694316286 + -0.05012971863213181i, -0.09299237729065646 + 0.044010642275876144i, 0.14116596129735637 + -0.13903715558380758i, 0.02869141535931314 + -0.10656680546180278i } }), Matrix({ { 0.01139724985129649 + -0.07525572503903424i, 0.14515136484503718 + -0.24382470805474368i, -0.03164159298072807 + 0.08518086720391026i, 0.014099194508202446 + 0.0372073482322776i }, { 0.09067698239211855 + -0.19418142057515492i, 0.05424482292093768 + 0.16248543620793096i, 0.15362087964479013 + -0.11346637248516012i, -0.13823507403210536 + -0.1592880625432768i }, { 0.022431396608273646 + -0.17034851041542126i, 0.0029445661240850014 + -0.08068481790854846i, 0.04077080496196091 + -0.07850456057478532i, -0.019945528146578746 + 0.02406023022036994i }, { -0.13170680369098267 + 0.0903631571688679i, -0.14933869031591204 + -0.06462009786877917i, -0.09527587745273979 + -0.1357717464935291i, 0.06462288016219293 + -0.11728615351316957i } }), Matrix({ { -0.016653887671351182 + -0.057733074116744894i, 0.00690511649850637 + 0.019906696849937885i, 0.09487452829291015 + -0.023015237451560505i, -0.07998242389339978 + -0.08489601293520672i }, { -0.12663962600055523 + 0.018775570516376i, -0.006378197692830262 + 0.08769420605665795i, 0.06826058648792438 + 0.12981061588931253i, -0.13643575826633558 + -0.07786535445996216i }, { 0.011079113988579255 + 0.1165597506920316i, 0.11022679344450229 + -0.06474114790587743i, 0.0028833418886309897 + 0.05649151723256478i, 0.18395136415195515 + -0.061035834242453034i }, { -0.10843015358263319 + -0.07931781866771678i, -0.02686518153727855 + -0.10375114677158358i, 0.03273166892760236 + -0.0007773930677395857i, -0.003916836486695908 + 0.12496969547504115i } }), Matrix({ { -0.008423448045849609 + 0.13192647446012043i, 0.08692352421121603 + 0.17664452415521126i, 0.0906316961280616 + 0.09167891015052657i, 0.03892455260604276 + -0.12258133539064311i }, { -0.10181081995490672 + 0.1227092414845167i, 0.2188650844869003 + -0.06440171248417034i, 0.10775960707132042 + 0.019072937606588375i, -0.15808825639614665 + 0.07796709692297085i }, { 0.050114617429007385 + -0.1283159674245966i, 0.20504052761106764 + 0.038533980937051585i, -0.023092299823370254 + 0.016660809271224007i, 0.05331025600151592 + -0.009237011609987722i }, { 0.0013981206288368984 + 0.10147752343707694i, -0.11598604025161674 + 0.01697232987007687i, 0.0033517970471499204 + -0.054400205729281705i, -0.02121166309240548 + 0.04106894454169322i } }), Matrix({ { -0.08507541511714792 + 0.09074596549923229i, 0.02740137605848459 + -0.12915928585372674i, 0.1361113501671762 + -0.014905555740326724i, 0.015991443007478266 + -0.0872363784579708i }, { 0.1166251380108668 + -0.09782045722229173i, -0.011854255167577302 + 0.05908066341133447i, 0.0025682656967065784 + -5.526604136926398e-06i, -0.12452595014314902 + 0.02199595119974652i }, { -0.130893385994628 + -0.08880696390726396i, -0.09265569966142302 + -0.005603720117430878i, 0.000270919258686543 + 0.10193244308365668i, 0.08147931152794002 + -0.139028145588787i }, { 0.023771985372573565 + 0.008315881587857302i, -0.06551608587174444 + -0.12955535565874476i, -0.07057991110802936 + 0.10364476188833259i, -0.08946890078295776 + -0.0996423147162432i } }), Matrix({ { 0.01532845472894448 + 0.06912440155383119i, -0.11726745417134701 + 0.054441395450747256i, 0.02620626431550658 + 0.004015350103182745i, 0.04735357688342125 + 0.11738804222545399i }, { 0.026384401639188378 + -0.01895328253141265i, 0.009937936074770214 + 0.06939657545841471i, 0.04024152166566159 + -0.05024246150936858i, 0.05703010824017148 + 0.04937279035767333i }, { -0.11583290344872943 + -0.012110763530329662i, -0.1267475855654747 + 0.06742184750973182i, 0.021311833604365147 + -0.1027420983301485i, 0.05161935761776699 + 0.11980749314852274i }, { 0.09109919345418328 + 0.12354021671034925i, 0.09697876006340901 + -0.032982380910664494i, 0.058035834994875184 + -0.03212797667240039i, 0.09733926652124453 + 0.03784818268197044i } }), Matrix({ { -0.06584519159693229 + 0.00998305775234516i, 0.105673945788273 + -0.11318411567499143i, 0.09377901468143045 + 0.16343706332596392i, 0.04449744216834005 + 0.06280461169070169i }, { -0.008810663221265062 + 0.07995507255590276i, -0.07969201882437457 + -0.07338235980497389i, -0.026973697580481917 + -0.1431645159972283i, -0.06466526716221405 + 0.02290631311870074i }, { 0.01624321190791454 + 0.029811088442017707i, -0.03266764982464976 + -0.0984816725702745i, 0.06605994304148599 + -0.05350827484422413i, -0.05133183544830913 + 0.0012560837469448294i }, { 0.016337591025651795 + 0.005604890759084524i, -0.07630886688774452 + -0.04527216315983118i, -0.07697481413080895 + -0.10272976684995279i, 0.05846874759778718 + -0.056841479574534864i } }), Matrix({ { 0.06182290794166724 + 0.032751834470542175i, 0.2005430596566664 + -0.03343286688265019i, -0.19442811489472586 + 0.09354166136929279i, 0.15746163057250984 + -0.07747694581957389i }, { -0.062455639176993295 + -0.13990955129417787i, -0.061653852365742855 + 0.03129948886549952i, 0.14506604832200273 + 0.05283333426723791i, 0.18701725753863443 + -0.022405620059617867i }, { 0.04505979988763609 + -0.12547942257463773i, -0.030232144695585 + 0.05854284851513621i, -0.0737828827795331 + -0.03670069106080197i, -0.07311394635313051 + -0.11683964994165837i }, { -0.0918365981713861 + 0.007076804920647102i, 0.15451621161952414 + 0.0431595971626534i, 0.04356088025123869 + -0.035584025420189826i, -0.1498451894611263 + 0.06959161863844648i } }), Matrix({ { 0.026543866338145494 + 0.03967899225317979i, 0.13454080262230778 + -0.008797201311677095i, 0.009801463596643563 + -0.07135902921795062i, -0.00885534230815129 + 0.06040524938911219i }, { -0.07270467804680114 + 0.1568639061632462i, 0.1017262885719803 + 0.06668282255139753i, -0.11561528186696537 + 0.11715231710767823i, -0.027967364079817755 + 0.15978078636482412i }, { -0.03616495991512484 + -0.021906930548048143i, 0.09951926171215762 + 0.008113428014790194i, 0.09788516503671733 + -0.07903712102159303i, 0.0043334531307512025 + -0.20232961045071368i }, { -0.1601747531039236 + 0.15523533027061534i, 0.10254985172549029 + -0.0036920624420160113i, 0.04202988371093234 + -0.0016950193482644926i, -0.038520851519039195 + 0.06279486137670957i } }), Matrix({ { 0.002056446058254134 + -0.21787003554093876i, -0.0027098953522042826 + 0.1002570823692142i, -0.06088068094054875 + -0.00940041529610339i, 0.08241638861619298 + 0.05810670818656946i }, { 0.08854239093906428 + 0.08418621545977716i, 0.1853772411471587 + 0.06801516708802735i, -0.05162225235214078 + 0.03358646310978004i, -0.06498360833094302 + 0.03941865916566197i }, { -0.06515394116113203 + 0.018624389441007187i, -0.046543075066157125 + -0.016771579433025607i, 0.15967031107247054 + -0.03151912679876851i, 0.06912452169708005 + -0.014167671558095615i }, { -0.05567063736741463 + -0.08715761641502616i, -0.11723331040315374 + -0.1886915784554454i, 0.05798870529807535 + 0.09072578434879651i, -0.03573977046299201 + -0.08157787873274612i } }), Matrix({ { -0.06304872016497495 + 0.013094924583465728i, 0.0305570528828761 + 0.11078224654239152i, 0.1437412717737921 + 0.07128674033994971i, 0.23444372675684208 + 0.013251730424079624i }, { 0.001983337532590909 + 0.0610943249916534i, -0.03689203319064875 + 0.005643301827506154i, -0.23686007742072507 + -0.09248908965042259i, -0.06949411152158683 + -0.1054954659861178i }, { -0.015838643572816464 + 0.07931348314570351i, 0.039965769923476904 + 0.00913636498796177i, -0.023384584568058045 + 0.06599285628631693i, -0.12174846056261607 + 0.16248823236788176i }, { -0.031038618453492567 + 0.08153949424192994i, -0.061139502847016594 + 0.17089532954438594i, -0.04213541749996945 + 0.09335323251246387i, 0.0018279688662511384 + 0.0545845754601736i } }), Matrix({ { -0.13142520797229001 + -0.10833119133076963i, 0.07499951466150731 + 0.11778791710142424i, -0.10617664134774904 + -0.0668668689670465i, 0.0514805579284524 + 0.025358665554770454i }, { -0.0007773317119371161 + -0.07997233051147051i, 0.11889723091462664 + 0.0798102104767465i, -0.04458646897248783 + -0.08676516130703676i, 0.09400715770941967 + -0.037163577683438996i }, { -0.10812800217132718 + -0.00047997285579310864i, -0.00819990188312033 + 0.09013747072185914i, 0.1285608785773733 + -0.09251347183741143i, 0.0027461101070237713 + -0.06429619211904979i }, { -0.08422499990819443 + 0.10808007947548734i, -0.0044453185166986285 + -0.04285516987654193i, -0.07968811879888761 + -0.01948405547102497i, -0.04093833451327708 + -0.06359464350082161i } }), Matrix({ { -0.0338810282552716 + -0.06733172965984745i, -0.16766587485257825 + 0.10106562161781894i, 0.005721779856132687 + 0.2376775848963984i, 0.010146842735839327 + -0.011144058269830772i }, { -0.05410913088656375 + 0.004422245620349071i, -0.06099763951073524 + 0.04828883016399946i, -0.05226296063324891 + 0.060118469939714266i, -0.06558598498548392 + 0.0868065917468686i }, { -0.06215550130653358 + 0.14436562612415005i, -0.11703307955539277 + -0.10150438833515972i, -0.12991620483512142 + 0.09267177355639944i, 0.08920095280017173 + -0.05009688689592433i }, { 0.019913834070797172 + 0.04484072108691951i, -0.08666028222723268 + -0.03450382955451832i, 0.02315804847836946 + 0.07322095405696434i, -0.17366722361032919 + 0.013235286112612595i } }), Matrix({ { 0.019069065458422987 + -0.035276542631159306i, 0.07360336839500198 + -0.019248952645641478i, 0.005470762969181942 + 0.11543090158972752i, -0.08332206689770552 + 0.07159803063448465i }, { 0.025575621000999645 + -0.11274977261437091i, 0.0747338296509621 + 0.11406973410885259i, 0.09674354663768683 + -0.047742663887572284i, 0.07607648591140748 + -0.06199832070711624i }, { 0.0315381282155095 + 0.13728452780837036i, -0.14007071488855535 + 0.0464133789277858i, 0.022499353346228195 + 0.0012537560023717657i, -0.031896692099277396 + 0.06085809729096894i }, { -0.06027087573732335 + -0.020002588988134735i, -0.008499589238735979 + -0.01159251030703257i, 0.08798035950452035 + -0.07172536255134193i, 0.013620935707275943 + 0.057879289730854745i } }), Matrix({ { 0.07423451484482953 + 0.007397894737160703i, 0.09761658860801539 + -0.045348769447644335i, 0.028458566856947098 + -0.045935427576528194i, 0.093487076642378 + -0.11184936961763664i }, { -0.024299249057674447 + -0.2714180511592394i, 0.07855970767065343 + 0.00018203491394336736i, -0.01331991143474551 + -0.023914374748352896i, -0.011352437094934225 + 0.14098416126266072i }, { -0.10402046249197563 + 0.03672190459655702i, -0.03921642000310614 + 0.023638609333445897i, -0.2187598913286885 + 0.009532167960717656i, 0.18348201147826085 + 0.04709728446211112i }, { -0.06288920143816822 + -0.024894388352740625i, -0.09463984370153937 + 0.06408461030295598i, 0.057516760410076126 + -0.038339647093576804i, 0.06821427107315321 + 0.03429221240473481i } }), Matrix({ { -0.07024146289715477 + 0.10291032217865886i, 0.02935260838197181 + -0.004548059362095629i, 0.053508909839543393 + -0.06127914286394686i, 0.10948927278059592 + -0.13908542749776384i }, { -0.006471919858009876 + -0.12470609183711917i, -0.04501282694906607 + 0.058116467673897776i, -0.10019759755487814 + 0.007908859484427638i, -0.0886654923779087 + -0.05034494077301586i }, { 0.0689950006024332 + -0.06959691873289406i, -0.007155186476780253 + -0.04900579246445503i, -0.06586840990938386 + 0.06104971498502803i, -0.12706547986170347 + 0.03405885306393927i }, { 0.005178451509629655 + 0.201480317500862i, -0.04730727372812506 + -0.050536364548030954i, 0.06033895165562441 + 0.02035146756787574i, -0.0388144545518148 + 0.0449885957519816i } }) }, { QubitIndex{ 6 }, QubitIndex{ 7 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { 0.0005865684950114858 + 0.040293472130693495i, -0.025705218469334906 + 0.005030206418373825i, -0.02401090023554555 + 0.2297974816043712i, 0.08606626299783893 + -0.11698307368109159i }, { 0.04616798839878737 + 0.02463097066045247i, -0.1637537589355505 + 0.18103417721482717i, -0.012258869576749104 + 0.0644823519686583i, -0.029189253953684543 + -0.18075006702181418i }, { 0.08621007757602735 + -0.0069609041362858086i, -0.05871033176325058 + 0.09797584481098522i, -0.14727565489817904 + -0.031569354276340035i, 0.020614435648413827 + 0.04419629652916582i }, { 0.1941557779285471 + -0.1653288965990432i, -0.009354653052264301 + 0.019379543040050438i, -0.14696519127040877 + 0.15518345025225277i, 0.08093316584712619 + 0.004199928729059623i } }), Matrix({ { 0.18403104290800532 + -0.06250311483099115i, 0.02387863825739238 + -0.07654023668412i, 0.08964929803766745 + -0.10342094908483634i, -0.009726349700562128 + -0.03671464241538349i }, { 0.17712952110386887 + -0.1257367723072504i, -0.03073947201102491 + 0.06624690598761823i, 0.15241940259987388 + 0.09574034578289903i, 0.1256371128380758 + -0.11080786748085183i }, { -0.039213527977948914 + -0.00037110300949271934i, -0.09864757051175774 + -0.013840362790443837i, 0.13736205425730483 + -0.041517344914396674i, 0.004878708920895624 + 0.18815730494431057i }, { -0.0051537318084424535 + 0.09149699524559984i, -0.1840133499535292 + 0.09557626192236095i, 0.008335817912259924 + -0.046144730753516446i, -0.016844052082855034 + -0.10649780339177078i } }), Matrix({ { -0.15477019370042 + -0.06588749292496672i, -1.5735808534959973e-05 + 0.15070747161163434i, 0.11463867544442323 + -0.006201089933904118i, 0.11524662260692335 + -0.019121443711788547i }, { 0.0352972960431637 + -0.05620910525771058i, 0.04802917583060105 + 0.14844134131894188i, 0.029780735817315884 + 0.10034982187819709i, -0.1703075968413504 + 0.02307705153212824i }, { -0.052256560021674 + 0.05188328291497874i, 0.007137934391687981 + -0.046463329903623375i, -0.1945899526372345 + -0.07728131270330742i, -0.008413563599651674 + -0.02847564534482516i }, { 0.04168722310987665 + 0.02266050709555434i, -0.11045333214428359 + 0.0814553247005119i, 0.1553287541886618 + 0.040456707374901035i, -0.16221400517523346 + 0.03700046815626477i } }), Matrix({ { -0.08774750659772183 + 0.02593852578808162i, -0.15393054824984145 + 0.003243629573657508i, 0.07891343941229283 + -0.07538888353813998i, -0.16200962341136949 + 0.04837262241437183i }, { -0.034735165322779926 + 0.05783594342914242i, -0.02436688954766046 + 0.19226729331822281i, 0.01039860099639745 + -0.0802393258406595i, 0.010801575644052779 + 0.03790313081694696i }, { -0.05305165123944422 + -0.08462806781713718i, -0.08402973849136589 + 0.02706152600385835i, -0.11300928779083466 + -0.1740742541958619i, -0.01959412409214491 + 0.042511944296692784i }, { 0.007831354895590444 + 0.17109799480755697i, 0.03055500858068248 + 0.026145204503343927i, -0.0476865912470655 + 0.004868436624590421i, -0.00469559285413579 + 0.07104547492917715i } }), Matrix({ { -0.10130628490495731 + -0.028427515428207633i, -0.04648653785954682 + -0.049447841828074594i, 0.11414314729771781 + -0.07622989361901798i, 0.08366464355107402 + 0.10458938609072413i }, { -0.07004295152350987 + 0.17508344108829688i, -0.03929032425985942 + -0.01800316950344697i, -0.014993941331959313 + 0.04408778862415554i, -0.07663103378161329 + -0.022469535408708607i }, { 0.06650878503492322 + 0.179451816001626i, -0.0257425443001613 + -0.206552641506709i, 0.08232501731928023 + -0.03731197739422277i, 0.025007530524185292 + -0.024844619475435644i }, { 0.035287350623941706 + -0.05384015104891135i, -0.09051596839501147 + 0.19294243495972194i, -0.059652572501707114 + 0.0029407761648300476i, 0.0349848468301633 + -0.08282033409138034i } }), Matrix({ { 0.15385119161547806 + 0.05917453167408428i, 0.09967609670567076 + -0.07569375755438738i, 0.04547864615544169 + 0.005968570998843165i, 0.015690600809021425 + 0.07305855588497623i }, { -0.06688538589724179 + -0.1256534955936068i, 0.03750513803542831 + 0.046196253268597824i, -0.009571807418601232 + 0.01704282238645798i, 0.01190875015756541 + 0.05471368950165762i }, { 0.009422137200369388 + -0.08056031016609254i, 0.0009913191181830192 + 0.1008284461390509i, 0.055282466492086485 + -0.15266439311665211i, -0.05400156238363879 + -0.08744723804905472i }, { 0.008213948479587807 + 0.03249095067888161i, -0.00533896990265766 + -0.07810461179767807i, 0.006136488386507834 + 0.038596878150476105i, 0.012111429825135689 + 0.03725038295121138i } }), Matrix({ { -0.0841973301804381 + -0.12264031188598938i, -0.04021606343339757 + 0.018171501999380852i, 0.09479402528096499 + -0.02345158982213791i, -0.023292823841583522 + 0.12497411210658294i }, { -0.001966375527358774 + -0.08956255506956654i, -0.0059490105912882235 + -0.028697296829436267i, -0.11862118752003128 + -0.038181200058056135i, 0.0458886177753766 + 0.007813109183134513i }, { -0.029607581751255746 + 0.1865757459336482i, -0.04661952251670931 + 0.20972150033939577i, 0.013049242961986288 + -0.056369610825133594i, -0.03570294644834318 + 0.027735517099527606i }, { -0.023999127751464094 + -0.00939143102469181i, -0.2122517641837933 + -0.012298503105411154i, 0.1108611652029404 + 0.006992635717101767i, 0.025875013107333686 + -0.056359049812353325i } }), Matrix({ { 0.13482755486913048 + 0.07041313063859908i, -0.09676490686662804 + 0.1131120246027955i, -0.001959463559448938 + -0.049099930418051205i, -0.04810950207895003 + 0.08343931570296578i }, { 0.1284268303051698 + 0.12457478149098852i, -0.06954712022222471 + -0.1379907339061684i, 0.03783476484574919 + -0.12924795620960175i, 0.18830646389449604 + -0.013169850019453722i }, { 0.017298087610248456 + -0.02168198332201492i, -0.08052819633693399 + -0.09260477540005375i, 0.11457075887800987 + -0.21408287738598697i, -0.21740274050217598 + 0.05811433115127694i }, { 0.11135312211030915 + -0.1015232302588243i, 0.022830490391943414 + -0.0649339641734823i, -0.005204887972194615 + 0.09395958176775557i, -0.06029329172582456 + 0.015339782211163566i } }), Matrix({ { -0.18635514540191891 + -0.022863289884759577i, -0.008999944345637162 + 0.02299128957229124i, -0.1744066018654049 + 0.06290895733212999i, -0.05029517465911237 + 0.15981399187228967i }, { 0.06734639748313381 + 0.004322122273456383i, 0.08379275213361329 + -0.041675370362033795i, 0.12395373696055523 + 0.12920746796109145i, -0.032767255472709256 + 0.019550716839757058i }, { 0.09585621071660433 + 0.09679726133132739i, -0.16561749419902103 + -0.11496827897535838i, -0.01724803210002897 + -0.07624629873212244i, 0.024633276811637475 + 0.10188479844800798i }, { 0.02867742147792346 + 0.04804898436444063i, -0.0004297934479096477 + -0.15549981640627072i, 0.07897061143907981 + -0.016887278404326286i, -0.030110387945049145 + -0.006955037102022666i } }), Matrix({ { -0.047320979430045124 + -0.029580208932301656i, 0.03771857143065718 + -0.09705271356846146i, 0.09058117240960734 + 0.06089575663144001i, -0.012779006684609526 + -0.00138428992683798i }, { -0.03605477766194521 + 0.013812147893140175i, -0.1428904785848004 + -0.039643731080894536i, -0.07274835851456168 + 0.030109469556746864i, -0.10645225728523366 + 0.18412753949222882i }, { -0.03913439381920287 + -0.18758878879926724i, -0.11471685891562705 + -0.16666634414006817i, -0.011629617191858519 + 0.13319303524708734i, 0.1485478391121523 + 0.044345323816751395i }, { 0.021309437695160662 + 0.02435239065292497i, -0.026536186709240888 + -0.10093340300306482i, -0.05990196361765747 + 0.08064505919234155i, -0.09074276123792908 + 0.11802573933060881i } }), Matrix({ { 0.026449616645073237 + -0.0014930611754513771i, -0.14619083936065674 + 0.1110529300247095i, 0.05460304326561196 + 0.03299912190920395i, -0.13170532577970537 + -0.06268800331362014i }, { 0.028899814368328614 + 0.03581718209486298i, -0.036441397347028025 + 0.0863466860515245i, 0.10370038497726602 + -0.07211589702053094i, -0.0016180039544576967 + -0.032630510235210956i }, { 0.1508398348490283 + 0.05208731323841885i, -0.03193653711533163 + -0.07946269219479314i, 0.14644337867058346 + 0.013045421846851138i, -0.10140464832197847 + -0.024063399818964232i }, { 0.05358376545448872 + -0.06122574938567282i, 0.014075855907858235 + -0.09952097910244084i, 0.014331792538451401 + -0.058152327412721555i, -0.1265538552291257 + 0.0759561939123611i } }), Matrix({ { 0.08216411492826008 + -0.04568121252053218i, 0.03553780950696485 + -0.010435781411135535i, -0.10686145617364827 + -0.018366163642240484i, 0.019038972405222163 + -0.21898625687728104i }, { -0.009727377881716369 + -0.19452985222455813i, 0.020679791267267475 + -0.06643831459798953i, 0.016662484183752484 + -0.13610478281219807i, 0.13997467853798787 + 0.0401492497052809i }, { 0.03922989971672014 + -0.01687660941168756i, 0.0077683559920771975 + -0.07213731976158382i, -0.03545778283245128 + -0.09896157321065034i, -0.003325147214143125 + -0.10541840569122371i }, { 0.11362187905391868 + -0.023579713735535725i, 0.044359021937254224 + -0.033298151065787464i, -0.07207193087245332 + -0.1161254323428461i, 0.014512498585719168 + -0.04220753625087366i } }), Matrix({ { -0.0924904731286691 + -0.19247198904671614i, 0.1703143837521523 + 0.04682732281143545i, -0.14241523521676894 + -0.09658296477193325i, -0.051771261138289094 + -0.18775281895440948i }, { 0.003099947437821198 + -0.031321989503257736i, 0.05599874117677296 + -0.04769876714716664i, -0.05309424287695556 + -0.11207660798663219i, -0.09498280732945033 + -0.002958834323629314i }, { -0.034606895849155876 + -0.026286785918609407i, -0.034817688297282066 + -0.09273764307700376i, -0.046646874551666606 + -0.05235474625903059i, 0.0515458616880523 + 0.04929470476165045i }, { 0.08855246907685671 + -0.090270817155423i, -0.10806540059527926 + -0.029766949669141483i, -0.13619952676568592 + 0.05889334426864856i, 0.00797275002098944 + 0.10682763706950948i } }), Matrix({ { -0.014666586734590318 + -0.056728315641931905i, -0.05653672777366313 + -0.06820987677227784i, -0.05158090886133779 + 0.023616038409510674i, 0.00835249015766444 + -0.0544933054719234i }, { -0.18874890845976686 + 0.1429785725392075i, -0.05060216328806089 + -0.011116638631213352i, 0.0314692827121082 + -0.04085358534024331i, 0.08997103671901004 + -0.03703954607993643i }, { 0.03785345493691568 + -0.04237441925297632i, -0.08195281133073797 + 0.004888541994008171i, -0.15760888334542908 + -0.10148698735445075i, -0.08080470698126846 + -0.14521298480555636i }, { -0.012764403772112503 + 0.08953695590611678i, 0.07403964484100654 + 0.09026809002879499i, 0.12494473128342612 + -0.032337472296399904i, -0.024792870948725163 + 0.05219300878603678i } }), Matrix({ { 0.1484271700054066 + 0.014262414878177983i, 0.08075964374283494 + 0.06573340880249255i, -0.028737257461042852 + -0.01295715730183458i, 0.04163686920310407 + 0.2010435431918183i }, { 0.05272707642489067 + 0.031444399837347335i, -0.036683547420297016 + -0.0996264738053496i, -0.045536465850158594 + 0.0251114443142043i, 0.09615355568485037 + -0.06007918755393214i }, { -0.06140809519042245 + -0.0785319006885576i, 0.05647680534866001 + -0.12404486562171806i, 0.08811875990458753 + -0.09941680699328345i, -0.05507277766061438 + 0.04968840110091728i }, { -0.082300912027738 + 0.14351042276642956i, 0.02499545168270546 + -0.1347680842665147i, -0.14415810760670783 + -0.005618373790528863i, 0.11369708125857224 + -0.1030125978517676i } }), Matrix({ { -0.008439897049888755 + 0.12706982413667914i, 0.12199335225310347 + 0.1035145542609989i, 0.04726972431204309 + -0.03835573797845817i, 0.1492596817611496 + -0.10688022116133226i }, { -0.009673133286646573 + 0.11430309659678133i, 0.011925137716341612 + -0.07138139639567592i, -0.18956828546759025 + -0.05216903598514715i, -0.19709970601962434 + -0.06287329173719157i }, { -0.07314686524844297 + 0.10087075219205746i, -0.02256882399678089 + 0.08459697854010773i, -0.04984343355490579 + -0.020486416590537695i, -0.050632815136049676 + 0.06627200000747506i }, { 0.030766538481013628 + 0.05076890468866512i, -0.08536566276846068 + -0.05955082272107962i, -0.0450478364305582 + -0.022247551484586583i, -0.16005232881299727 + -0.04277694801106192i } }) }, { QubitIndex{ 1 }, QubitIndex{ 5 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { 0.022904643608463005 + -0.05547498291841805i, -0.0009594627233348593 + 0.013900297068742757i, 0.03157740793581867 + 0.014662585581700987i, 0.038709771052833825 + -0.0010952635938358546i }, { -0.03185416966354023 + -0.048169548214505455i, 0.025019553629513677 + 0.07483514958577715i, 0.07748387776840918 + -0.03724673251649165i, 0.0506081528815498 + -0.07698941467299118i }, { -0.0232782178450551 + 0.056680960849747324i, 0.08352559377712543 + 0.0328598825296964i, -0.07944287810059303 + 0.020868563662997802i, 0.029600538391504325 + 0.0038575645975785547i }, { 0.15454444712805576 + -0.09430996010669425i, -0.0630614845603565 + 0.02976302733400509i, 0.04127083664775125 + -0.09786870938429937i, 0.0617612484916592 + -0.0581697769536578i } }), Matrix({ { -0.07044987954114502 + -0.1417991515018i, -0.07667092373176188 + -0.013930458889694498i, -0.07219263587432101 + 0.06379380412057992i, -0.1044985153490859 + 0.031360394086117294i }, { -0.003692398004144332 + 0.02326781128747027i, 0.19886517009194382 + 0.06377102395244826i, -0.06546715887040462 + -0.01823138218608244i, 0.05901990139748241 + -0.04334705137464869i }, { 0.04628443113226371 + 0.1262662374486506i, 0.04026069522401289 + -0.16958872435613945i, 0.07494706180817542 + 0.2017203676357421i, -0.1391476541371985 + -0.009770625701650746i }, { -0.04568366643624657 + 0.1756290007175278i, 0.03334118963223244 + -0.11099890046904584i, -0.021143314987972606 + 0.049262689065050755i, -0.02348733921898897 + -0.1556993961381272i } }), Matrix({ { 0.004751340319948588 + 0.019789684595664946i, 0.18446945715956806 + -0.03305095168914032i, -0.016947505682515133 + 0.05444656366941785i, 0.10666295365650255 + 0.08056220618011044i }, { -0.023261573949422572 + 0.14244569777745553i, 0.03801365341822315 + -0.08022150201506438i, 0.1143699148529318 + -0.07057605053327126i, -0.10543621366822581 + 0.1474239081218194i }, { -0.12029267730640959 + -0.11328795113100329i, 0.09389483408523176 + 0.06973167590013986i, -0.11246259648143134 + -0.00956974933300669i, -0.019913560417487493 + 0.046270383717093945i }, { -0.16153720928767332 + 0.008451657231615261i, -0.07574098711443954 + 0.17375381817183308i, 0.0075872073324002335 + 0.09797051457521896i, 0.0726808160829599 + -0.04310884855927366i } }), Matrix({ { -0.24584391288781668 + -0.011104964689079714i, -0.023586333703849736 + 0.047719096528694514i, 0.11323793644666184 + 0.0019781372258530837i, -0.097165595112119 + 0.020424256432687565i }, { 0.08607174787625106 + -0.11699350452929114i, -0.05188244832919203 + 0.02101983437736714i, -0.10372323915139003 + -0.03592801616329437i, 0.031623503933285925 + -0.09134574540533917i }, { -0.05847673437602134 + -0.10033379875908482i, -0.03791055261252966 + 0.034480886020811785i, 0.037295087023193146 + 0.0944981939132431i, -0.16805622551924893 + 0.07512931349795374i }, { 0.06888512992202254 + 0.12592214681721792i, -0.09819967298592396 + -0.051265479531618696i, -0.03217958317301703 + -0.07006257367161248i, -0.03690491979129957 + -0.0821543267081042i } }), Matrix({ { 0.049558434878861385 + 0.09295158745712678i, 0.016518891092157886 + 0.09452084944527872i, -0.13413134484242042 + -0.08677337162453554i, 0.01739661378453113 + 0.027826808704949767i }, { 0.03976175233521842 + -0.004140149016114028i, 0.04865606718281782 + -0.06543942299764197i, -0.00018893483167638206 + -0.005250648954037038i, 0.005879260144690676 + 0.09183688023461141i }, { -0.18130467087544408 + -0.061312560579247825i, 0.1015945294823804 + 0.0406682874606259i, 0.005145289521128607 + 0.07653944045424751i, -0.08822567868410243 + 0.05864062842762498i }, { 0.09889481982010268 + -0.15138461837511247i, 0.024944991431917404 + -0.10517580623970423i, 0.07210974364214127 + -0.027402229607646284i, -0.001308382632038356 + -0.028950725965606643i } }), Matrix({ { -0.07806881102945964 + 0.2358197895040494i, -0.05588634732024745 + 0.004289840458336469i, 0.05203219359216115 + -0.05410593777470738i, 0.013370142871722735 + -0.01737083074333064i }, { -0.0901571504788058 + -0.038519423382722566i, 0.06836704495577205 + 0.06745697113012876i, 0.03264958905825413 + 0.04451111381181773i, 0.1124587971563408 + -0.04363950643965419i }, { -0.08488990437618477 + 0.1235667523702727i, -0.19774201635461242 + -0.0017395233988809408i, -0.01110679648838592 + 0.25212264321876443i, -0.07728548346757931 + -0.15527327524941353i }, { -0.07757340355040096 + -0.07469172906067272i, 0.011312663124318499 + 0.09285620002639827i, 0.14931741401977158 + 0.055958737390070304i, -0.07022510377115398 + 0.04130146585512707i } }), Matrix({ { 0.12700157626586375 + 0.14394302495696135i, -0.12836896273787315 + -0.13208955119171192i, 0.05522229358440052 + -0.04335170739450164i, 0.05618473111570275 + 0.16323350868555553i }, { -0.07300971958253788 + -0.09647988159822332i, 0.043925965264740456 + -0.006357211598456194i, -0.008248661262449204 + -0.04590025971088836i, -0.01820025202756539 + -0.18721233306466364i }, { -0.154662301219148 + 0.0765696537220174i, -0.06810949607686766 + 0.02872017384804647i, -0.08014548200328245 + 0.06660089133671672i, 0.027511178288088353 + -0.05334123551529125i }, { 0.0211995445755351 + 0.05411191486405689i, -0.14310951216095885 + 0.06708746728111417i, 0.03184711558888434 + 0.12199781727416428i, -0.17125277918980555 + 0.026405116536300836i } }), Matrix({ { -0.06644523351912499 + 0.04752975747331989i, 0.023175101185915734 + -0.024532238094265153i, 0.11658135058687766 + 0.03685228259281627i, -0.08197467130842864 + -0.2068406544769702i }, { -0.08390354791301129 + -0.07209393178395124i, 0.1773674330012612 + -0.056623052216554316i, -0.004572557140243466 + -0.11563814570782448i, -0.2066899500873378 + 0.0007346005301997647i }, { -0.004071155150386657 + 0.09446758185643782i, -0.07452539175550944 + 0.1201140936898193i, 0.041247899237869486 + 0.02114166489593375i, 0.04329447291375728 + 0.026088039806045533i }, { 0.09709782916535431 + -0.05120182575025475i, 0.04351244866874453 + -0.13670213036394058i, -0.03164054527962639 + 0.009134796405663486i, 0.09647842783819525 + 0.16932362389861763i } }), Matrix({ { 0.03352883575481947 + 0.08380180037732664i, 0.2539391752650389 + 0.07337004789159972i, -0.06578310141965743 + -0.1139559285793307i, -0.01550162545763082 + 0.025212776958868036i }, { -0.06604917993523293 + -0.11324152869820042i, 0.0027234747264823817 + 0.005811960799542244i, 0.03862430830725878 + 0.036297715731737915i, 0.1466368617202821 + 0.03293859424322253i }, { -0.02905489753483158 + 0.03508523491304446i, -0.0389275721206907 + 0.11263105980924588i, 0.01776415366741075 + 0.14197662833279664i, -0.044245530857867685 + 0.04364869548303161i }, { -0.009730038594953895 + -0.06450819817359829i, 0.0383814175393374 + 0.051296307965817974i, 0.0013939185685349885 + -0.05551166441799635i, 0.08791621019738677 + 0.015547173591587147i } }), Matrix({ { -0.1327640613878562 + 0.029770499098164482i, 0.024913720702481098 + 0.2119191937292919i, 0.29871500060428297 + 0.05258356813552335i, 0.05713448708495402 + 0.07618346993594263i }, { 0.01858299851085857 + -0.10713696569295231i, 0.10053758765253391 + -0.09061483972722559i, 0.12647110933548553 + 0.1712224860616727i, -0.16492965375402163 + 0.17005690908715584i }, { 0.04084775341927379 + 0.02814782521411317i, -0.026499288621648003 + 0.011542831220316366i, 0.0798814642333662 + -0.011185062745704412i, -0.033850230886061115 + 0.025315489346300794i }, { -0.027901588980883206 + -0.06039701076146145i, -0.09424314661331644 + -0.055104048404536005i, 0.18660507057208026 + -0.0889677197016983i, 0.09341028270424707 + -0.10169981587269089i } }), Matrix({ { -0.08720506371129498 + -0.10527954610076484i, -0.07564020001434117 + -0.10575264166402608i, 0.03096439469437497 + -0.004484873577415162i, 0.013209726964611528 + -0.04364073668639675i }, { 0.06270871602192585 + 0.008586908922371187i, 0.11663257598709799 + 0.03094734638055451i, -0.014179055066537766 + 0.03975844159823434i, -0.049951214005486085 + -0.1385827672339133i }, { 0.024213920434131994 + -0.15919341588442834i, 0.08248748468539117 + 0.124186518505029i, 0.0621558503924234 + 0.05296369206876594i, -0.01872590624413368 + -0.06843775387836132i }, { -0.14791957966276847 + 0.04193636569842516i, -0.14318278075332164 + -0.09453305445218928i, -1.2569280138747727e-06 + -0.03931027547413522i, 0.11740639807514162 + 0.00405266062103691i } }), Matrix({ { -0.06090760187889086 + -0.06680558486986794i, -0.09295738688991428 + -0.11986882445062133i, -0.02686082699839358 + -0.032021664256415346i, -0.0007797425640416451 + 0.14632024803966678i }, { -0.1266832708222633 + 0.003298762011851482i, -0.014060916697242043 + -0.0711766459889981i, -0.07485810894849075 + -0.098230386360447i, -0.049762763903605296 + -0.1579433983008642i }, { 0.0016890215110985669 + -0.08215509829320937i, -0.05343273056446867 + 0.18051023255696458i, -0.1155990456959045 + -0.0332252911195518i, 0.06269814760086806 + -0.02151644154176668i }, { 0.04955402665882724 + 0.12899131951831722i, 0.03252958238607013 + -0.09222995067440883i, -0.18229171262619748 + -0.06926145133439214i, -0.0010633251504179309 + -0.10050207280094092i } }), Matrix({ { 0.07203853642157916 + -0.055941733931165395i, -0.02879720218627706 + 0.06684675198697038i, -0.11428548134363184 + -0.0842666328450833i, 0.06823361539701721 + -0.03180308382158413i }, { -0.002602477015642846 + 0.1230987489547323i, -0.02367254182811536 + 0.04249165258988636i, -0.10348614737886093 + -0.014815741864572666i, 0.11889008952461196 + -0.027630848257709863i }, { -0.02063209752846542 + 0.019350325455591115i, -0.036602123236722295 + 0.06608586701910274i, -0.03839490887166211 + -0.04427916778547381i, -0.07515662679710662 + -0.007357411092795345i }, { 0.09467194669404132 + -0.0528087505354382i, 0.06027410273797972 + 0.16400932167149912i, -0.16478052474364732 + -0.0029236668981566507i, -0.10003829265393666 + 0.13726893868993476i } }), Matrix({ { -0.0060536920099787655 + -0.14453154681168118i, -0.0830285998725492 + 0.007588711898806318i, -0.038001913088848184 + -0.18553209221448633i, -0.22960660479177564 + -0.03947457550339583i }, { -0.07922290067334795 + -0.06535726210812295i, 0.07802090239405743 + 0.08187567197511571i, -0.11702254454510033 + 0.0766928570572292i, 0.14330776656644845 + 0.09465568754247566i }, { 0.06448266260927828 + 0.08242010256912229i, -0.09796684539765474 + 0.08884833555669909i, -0.021938810907146052 + 0.19810003785993327i, 0.06574990897144951 + -0.054039211982531636i }, { 0.09229587630030398 + -0.08557335188039347i, 0.052944377665463366 + -0.04704747562910325i, 0.03347083336660715 + 0.1850055732999012i, 0.12702484365372899 + 0.01843525023245381i } }), Matrix({ { 0.05483247641914669 + 0.005682626128016603i, -0.03803839301384799 + 0.09443190997929206i, 0.03730784863323758 + 0.05469138780485779i, -0.07199271148379995 + 0.05555167415913442i }, { 0.014559657028567458 + -0.026396839478388306i, 0.11108081456984947 + -0.08825511387975528i, -0.02471019638629902 + 0.01214452182290907i, 0.06614703760484894 + 0.10199531424320409i }, { 0.09666796034043196 + 0.014181294481214076i, 0.03584359700571187 + 0.07299155997423655i, -0.004500421431204426 + -0.007919407616202292i, -0.0006127037254139692 + 0.04601140086047167i }, { -0.04685991427692469 + 0.04695481872828864i, 0.09729323387473862 + -0.053091991789203756i, -0.1354316795208099 + -0.03915425696095399i, -0.10320639799385925 + -0.024374496864730057i } }), Matrix({ { 0.0523362017990458 + 0.029608960921199495i, 0.06960731798825202 + -0.0072187776842890265i, -0.11230771288064575 + 0.16839628333976717i, -0.0018649641188803008 + 0.05342715292483912i }, { 0.06669850807593453 + -0.025919265797980595i, 0.0037298752406141875 + 0.024652987586476948i, 0.15210416972768617 + -0.1010920601219114i, -0.09044338946388947 + -0.1599818410763619i }, { 0.09027380129580137 + -0.013842929704692966i, -0.1584146588407901 + -0.0037109107777604936i, 0.017392621024958005 + -0.013858917954809561i, -0.1019353855520957 + 0.007756064940418531i }, { -0.21726378865074417 + 0.09880032874322567i, -0.19766236540293045 + 0.06911501774815153i, -0.14110388783289027 + -0.04571465564526416i, 0.031048648734395366 + 0.13974379700148432i } }) }, { QubitIndex{ 3 }, QubitIndex{ 4 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 7 }, QubitIndex{ 2 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { 0.15013847485206266 + 0.3229662056207911i, 0.0961422794010701 + 0.30785976637367385i }, { 0.5449030745295765 + -0.23972421975512379i, -0.42886480119175696 + -0.06113969407814149i } }), Matrix({ { 0.0984987726604933 + -0.35164190585917904i, -0.19920570227253914 + -0.4050147475362925i }, { 0.12392419276747228 + -0.27275656996848663i, 0.08434923346420799 + -0.29450770726043396i } }), Matrix({ { -0.09938657152801522 + -0.18311395478694947i, 0.28053746984181693 + 0.015879917655005765i }, { 0.1483235222504296 + -0.3322203459286346i, 0.2998277483741525 + 0.29754995836993475i } }), Matrix({ { -0.11908434940048561 + 0.16484152486466i, -0.290787745683064 + 0.07200866222651847i }, { -0.11420281658087798 + 0.25589467676116223i, 0.0639731365152215 + -0.24397762857153923i } }) }, { QubitIndex{ 4 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { 0.000652924011172562 + 0.000727100919550918i, -0.03004321526254221 + 0.13046853686256912i, -0.04425438207668426 + 0.0739428572475421i, 0.05876826484946216 + 0.0433008245156042i }, { -0.09370602059231445 + -0.07206809475320691i, -0.09455841019016853 + -0.02262767378362165i, -0.06468236057441237 + 0.09433506411618212i, -0.11734176365423397 + 0.05127441261806596i }, { 0.029338841983459932 + 0.030078027730438796i, -0.022167589332763967 + 0.036070547757155916i, 0.023155715173450934 + 0.07474912146136888i, 0.0552024036314089 + 0.21336656612708907i }, { -0.023742258952715138 + 0.2052347958231989i, 0.003410530806022915 + -0.025261688095442592i, -0.010768691766498528 + -0.10927063026983859i, 0.07241013735896044 + 0.015332271460384184i } }), Matrix({ { -0.10960667763844374 + 0.09437713197212731i, 0.025270150174665603 + 0.05533106187100118i, 0.11940593909017544 + -0.008924881839821564i, -0.006775092324317783 + 0.03778828324662563i }, { -0.0711527744735141 + -0.08176691514908666i, 0.0925615169339811 + 0.10790284806215712i, 0.1414077358613199 + 0.007896309480939494i, -0.14339135287385144 + -0.045936696466921424i }, { 0.05134475551575162 + 0.03480279554910524i, -0.09101123222820719 + 0.10715966007988377i, 0.06720325800935512 + 0.1698547856631236i, 0.0020141584814781796 + -0.03967966041308481i }, { -0.048199860990691436 + -0.12030228173764967i, 0.035089896570450266 + -0.13310143092390836i, -0.07638088488098088 + -0.0316795426638038i, -0.05790470939492229 + -0.07204214662282835i } }), Matrix({ { -0.03136738139305781 + -0.12693257028838673i, -0.0195781225963267 + 0.16795815717302331i, 0.04223613929780182 + -0.10676883777157305i, 0.0808134235135048 + 0.028607238430708934i }, { -0.027077377470307116 + 0.05073420505154309i, -0.004989696381775909 + -0.010310787093092194i, 0.1045047417401334 + 0.07901755068760141i, 0.009707265871306702 + 0.06643733661596654i }, { -0.002101480513855103 + 0.05841779042312536i, 0.046262304229754664 + 0.07787586420716024i, -0.020657004427483177 + -0.06794891006882588i, -0.1574370890553206 + 0.06098319652455993i }, { 0.010575674540931302 + 0.22082310254031512i, 0.11297387303763422 + -0.06304186520139612i, 0.008423842892427296 + -0.09301613808682872i, 0.02608606905517961 + 0.015217669956341849i } }), Matrix({ { 0.05293613024262726 + -0.0765085838245193i, 0.058088853157966 + 0.05846150039708822i, 0.1282503590827466 + -0.0033713729079135114i, -0.0711234626356353 + -0.0027698255035781406i }, { -0.11092035971222516 + 0.18803747850904123i, -0.15813375288083834 + 0.03524278628412284i, 0.010913260566701244 + 0.03135988948204293i, -0.01981412596441298 + -0.0795303257343951i }, { -0.11206971903120366 + -0.09777757008097772i, 0.1022025377842762 + -0.0993730356539475i, -0.09825132991826326 + -0.18791281638489554i, 0.038763370639907764 + -0.10068790462937953i }, { -0.021743291951263934 + -0.01740682162156608i, -0.13659208107705903 + -0.038933792360526874i, -0.004901696068447882 + -0.07358816926290354i, -0.12013500831863982 + 0.07944249277231662i } }), Matrix({ { 0.08998072573070533 + 0.049992833910167865i, -0.08345830279090768 + -0.09696559399535526i, 0.24400255644702076 + -0.10612894048562158i, -0.11596561498344786 + -0.02060373675335445i }, { -0.009198151022890778 + 0.04374780722902417i, 0.022723534972874063 + -0.09170801814146552i, -0.09602441749352973 + -0.1270657054906131i, -0.10359814117366146 + -0.019996962320467552i }, { 0.12311894559293941 + 0.1011528547074328i, -0.060266087049199314 + 0.014131231787204976i, -0.0826671622800952 + -0.10037091354722694i, 0.0038604142568871773 + 0.061974601032505884i }, { -0.019677591231579018 + -0.11923459774200972i, -0.05204461912597901 + 0.01203714879589392i, 0.037719622694792905 + -0.0527160128246185i, 0.022741332563351167 + -0.03457470070400546i } }), Matrix({ { 0.033246311603827204 + -0.01810634261822751i, 0.02617835433107275 + -0.11485199298251567i, -0.05328659177540015 + 0.030103459636241257i, -0.10127862213134661 + -0.03369373238725967i }, { -0.020082629476862048 + 0.022643848147655347i, -0.015924367098986696 + 0.09920625717983413i, 0.12659647301432944 + 0.028624714293675663i, 0.11813651978848758 + -0.10488350554035775i }, { 0.019335799385146703 + 0.07902056712239174i, 0.06305120759337987 + 0.08303105700829574i, -0.10351257102529293 + 0.13482341650143245i, -0.026603625068506546 + 0.03953275198849602i }, { 0.032010170382203745 + -0.026757031622575377i, 0.02348497680493217 + 0.10894066373991013i, -0.07135763077691273 + -0.05124420606439102i, 0.012900917714370663 + -0.061929465404703024i } }), Matrix({ { -0.0823198918013961 + 0.011213837458073226i, 0.05489236309107903 + -0.09194500292036628i, 0.058415132427306636 + -0.062338495507617775i, -0.1765837215300401 + -0.0444829765582304i }, { -0.10367004765470017 + 0.15698394167964924i, 0.13601627658262913 + 0.19923162031198519i, 0.038123166150175615 + -0.15812602350394758i, -0.046648630198460814 + -0.06291600695977609i }, { 0.12129807544345919 + 0.07090773849001944i, -0.030337758998160574 + -0.044664429837426564i, 0.23150158941742233 + -0.03311237438441048i, 0.13189395218017758 + 0.09526723908505301i }, { -0.1889459008035862 + -0.053076448691758864i, 0.219973848220042 + 0.013210715586107778i, -0.03077540308886751 + 0.23125188550114412i, -0.014188490841477384 + -0.015513734069503694i } }), Matrix({ { -0.015525894278301327 + 0.10310554117452368i, 0.00754721339819122 + 0.01780662867381401i, -0.09073767678949743 + 0.1177004882411134i, -0.031356439906307564 + -0.01088434115142083i }, { 0.05299640272697136 + 0.06368123412492195i, -0.025147702880591802 + -0.051424346974372384i, -0.07148612610656757 + 0.061827425169928646i, -0.03673664841396517 + -0.09416880452747083i }, { -0.14813026768029966 + -0.04809839665736982i, -0.10323547520716202 + 0.07168395489906747i, -0.0028068391143940825 + 0.15183021844226607i, 0.10910239599109628 + -0.028159338547938943i }, { -0.02791766632333923 + 0.07611347319435252i, -0.14151389410438678 + -0.011011784725900652i, -0.01245495458087982 + 0.010875375459976503i, 0.06048545785178174 + -0.0218917380702426i } }), Matrix({ { 0.06046475905620184 + 0.08267352566786844i, -0.02864626550514037 + 0.061393575396305834i, -0.019470343237702394 + -0.11741265147465935i, 0.009467764885574258 + 0.04110613397675412i }, { 0.053875449978670345 + 0.06395699127459273i, -0.06246140289770765 + 0.09120150324499249i, -0.12439025228993136 + 0.01716173626513027i, -0.038435280478147434 + -0.1278606309694859i }, { 0.12368201176459259 + -0.0654583857788914i, 0.03822308201719246 + -0.0014456401750828063i, 0.2389690910465419 + 0.051372879205713644i, 0.05287064326739782 + -0.02535807557709345i }, { 0.027365010055639623 + 0.21320397588519902i, 0.09085826941676206 + -0.11484021909722322i, -0.002446496740911827 + -0.02888744186261707i, 0.09349165634813575 + -0.09301557717993271i } }), Matrix({ { -0.009061939565419208 + 0.042129045251476455i, 0.07276259488821926 + 0.05546148287501424i, -0.07919005159833152 + 0.017923999936440647i, -0.014999676917117104 + 0.17646829740477168i }, { -0.033824694958088354 + 0.016273748569346415i, -0.25237735705824177 + 0.07725436483955901i, -0.026109091357025237 + 0.02542274504520775i, 0.05689576598905221 + -0.01926231978885254i }, { -0.01047557028914887 + -0.05884172944940666i, -0.0014994992493115608 + -0.07571656258675004i, 0.09061704018279682 + -0.05655511735274118i, -0.08116368639602001 + 0.2035602713670203i }, { 0.02412275718577754 + 0.14991540342956108i, -0.08894203310326118 + 0.07613245936319137i, 0.020793462236751586 + -0.0372150757353391i, 0.13676688276947016 + -0.0020846167722898094i } }), Matrix({ { 0.1084024791074306 + 0.10236803117941536i, 0.0987282760908669 + 0.12499803555597323i, -0.04973288479995385 + 0.06029395339766492i, -0.0260909057600144 + 0.08312975621028179i }, { -0.0022683160121177927 + 0.06534485196265466i, -0.01834238193571557 + -0.038445865192712224i, -0.059619853578046306 + -0.1205001709597115i, 0.05311876693834999 + 0.013389054386466136i }, { 0.06200124714349232 + -0.12585660420148814i, 0.033718927701610245 + 0.11624768914503686i, -0.02540526455929596 + -0.15526053933341974i, -0.11014863806915152 + -0.04226452317070285i }, { -0.0007065606185029606 + -0.11502872605125616i, -0.022270408386305306 + -0.13230980419103663i, 0.08774698741020724 + 0.0022267993539330216i, 0.03926558824410363 + 0.06133594139605678i } }), Matrix({ { 0.0651973124011996 + -0.10019946816093803i, 0.029922543304428284 + 0.08969784716652147i, 0.006219785157106216 + 0.04246799723541588i, -0.3640061815879983 + 0.1629809803313565i }, { -0.009923509126970854 + -0.07032939538422335i, 0.00600397040130967 + -0.06060803832712125i, -0.055172918826882834 + 0.06642683443196522i, -0.0021735145367126783 + -0.014040380172209694i }, { 0.056154058102879816 + 0.009461474837049549i, 0.037455959857348654 + -0.15802426360879024i, 0.07026237601845213 + 0.045646327764233524i, -0.1056628083694163 + 0.15043856769630437i }, { -0.013645556913930127 + 0.19751447928065488i, 0.04189479791722232 + -0.07793063916489772i, -0.015958252885296214 + 0.017207468774520368i, 0.0704630387483227 + 0.019134600351917847i } }), Matrix({ { 0.04742349431446151 + 0.04563884756736701i, -0.03706980245180157 + 0.025825411916650096i, -0.058672291135448876 + 0.07238484809575582i, 0.12227741300350485 + 0.008617122130975366i }, { 0.08332001066918358 + -0.005727012551294555i, 0.06358739780582914 + 0.11113530167031892i, 0.04249904036563106 + -0.028243093327105114i, 0.1262215709355139 + 0.10053953745876512i }, { 0.07493297017742565 + -0.005072485676752919i, 0.09287833789250215 + 0.07620914105960186i, -0.03070427483191824 + -0.004460656879129073i, -0.01650026645817845 + -0.037373708549215394i }, { 0.006974380544883028 + -0.02577815238598755i, -0.056255544177955794 + -0.044326002766558986i, -0.09521217584039252 + -0.12959966770225279i, 0.02373553393890367 + 0.08033531353152001i } }), Matrix({ { 0.04970156898701042 + 0.11651674259535819i, 0.004884913468477007 + -0.02102823748506968i, 0.07521467849153118 + 0.053855654028253236i, -0.014745896351286649 + -0.05154682369704264i }, { -0.0978483705180919 + -0.13814043133964016i, -0.09034971840587774 + -0.011364212428835977i, 0.13007825072461765 + -0.09412204570124413i, 0.06755486179401951 + -0.12906962546016276i }, { -0.06296659538094819 + 0.09819880091629445i, -0.033252049611759045 + 0.10244144717038019i, 0.1767727521237098 + -0.14077739064237707i, -0.08055499169272422 + 0.09289516596967717i }, { -0.314205120177808 + -0.04533553385741408i, 0.07893743507181956 + -0.035481811519850345i, -0.04751111747204129 + 0.11312154659887375i, 0.02818028239159573 + -0.02917731858148861i } }), Matrix({ { -0.02829534383504133 + 0.0619281890449576i, -0.1976191252191657 + 0.18361434179644692i, -0.11281334424759865 + 0.07178977828962108i, 0.030813019244843063 + -0.05533523819724381i }, { 0.004738203555007968 + -0.1572953530223658i, -0.1427595145352797 + 0.054840894097257877i, 0.09450783293521808 + 0.08484778859392807i, -0.00024177919934967085 + -0.01004546299225642i }, { 0.006969475915378667 + -0.062310956581243214i, 0.021280391195819193 + -0.2530111261377867i, 0.03917315005336838 + 0.05489629597574544i, 0.12823828585519192 + -0.25345338877774326i }, { 0.019747411031079746 + -0.0341348636696614i, 0.05959853671684663 + 0.04449292393603521i, -0.009193833460836577 + 0.09904137682217842i, -0.11156205229191758 + 0.06326246118852975i } }), Matrix({ { 0.0873127074884848 + 0.048393502018589045i, -0.16112043512884625 + -0.01666067856095477i, 0.08549156805540045 + -0.022521814445390503i, -0.012654988916392437 + 0.08650554404300112i }, { -0.022294179403947532 + 0.1572569767743486i, 0.03580985947703044 + 0.09009594000707395i, -0.050147470480086775 + -0.10333668723415201i, -0.0495942355424976 + 0.07652195960058089i }, { -0.1587781871569075 + -0.048034174327829415i, -0.040315011055590905 + 0.015262064348075937i, -0.06278880458210014 + -0.01978751208532029i, 0.1348512721328834 + 0.14301278643855858i }, { -0.1115649299554854 + 0.05274150343340293i, 0.12451871231885336 + -0.10721956968140087i, -0.01843874236007981 + -0.07105664192229687i, -0.015596877424241314 + -0.14109164820269016i } }) }, { QubitIndex{ 8 }, QubitIndex{ 3 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { 0.04585969857507899 + -0.09930951367629297i, -0.04164153512218971 + 0.09083031838553525i, -0.08940167289082343 + 0.01029469596664316i, -0.012022508214455226 + -0.1921082126097796i }, { -0.06715082869977407 + -0.02139000080798889i, -0.06307776579089801 + -0.01370149226873565i, -0.021951023075281094 + 0.0002631941153942461i, 0.004366167967917247 + 0.1712448978728767i }, { -0.08359865107114672 + 0.027233151935589166i, -0.033595953655610925 + 0.039970870061742395i, -0.008016845038261795 + -0.06042948115203427i, 0.11230446683732054 + 0.0113194684401963i }, { 0.002932215507992964 + 0.1681839446673808i, 0.07390292368066134 + 0.08065968853833808i, -0.10554482955522637 + -0.07195397251708008i, -0.14546580662585043 + 0.013947672509102577i } }), Matrix({ { -0.04796592530187983 + 0.0014629805969097937i, -0.1548200613697639 + -0.16647887717414683i, 0.15491083142746317 + -0.09365028975836295i, 0.023926434030693375 + 0.06252628305386275i }, { -0.009070928613984224 + -0.015546157942727224i, 0.0950128505543695 + -0.03091382262891761i, 0.041245171684233486 + 0.16075725827030476i, 0.023669705049547223 + -0.09924652259020493i }, { -0.05534143695494889 + 0.0659965792099989i, 0.03729031793389949 + 0.10491422000390735i, -0.039763471234851314 + 0.009378132996565902i, -0.05514965207346138 + 0.1112156048089154i }, { 0.08509606898381902 + -0.14727733285028496i, -0.058007885040318785 + -0.05732683928384084i, -0.13673709768288228 + -0.03373897916835845i, -0.06576875743564449 + -0.09389748603340203i } }), Matrix({ { 0.06838963028249173 + -0.025347914849330695i, -0.002838833436887537 + -0.1094084437523765i, 0.0682586006307129 + -0.037906025161604504i, 0.006970194772830635 + -0.03736851961343566i }, { -0.0022397293872798655 + 0.1478848093843199i, -0.04886472161601174 + 0.022796665848931235i, 0.19059056779458572 + 0.0762361902388909i, -0.021106586789797255 + 0.012572873648428396i }, { -0.024976055551863996 + -0.18969746638787247i, -0.06462908897397154 + 0.006822137548295203i, 0.10085999212044171 + -0.02939132392174156i, -0.01216330045213619 + -0.027589955405172138i }, { -0.031085993865013293 + 0.07730116691603198i, -0.1573755549181018 + 0.06659454814310085i, 0.1437200932971679 + 0.06520219455067408i, -0.08044129126710446 + 0.16812314177332524i } }), Matrix({ { 0.07951825895025864 + 0.04101137639148856i, -0.07016344958349836 + 0.05840418340158427i, 0.08575187960697311 + 0.06199355774047519i, -0.17484816436136014 + 0.059762052581151075i }, { 0.07554607994078942 + -0.08128130168023656i, -0.0010146088947530516 + 0.14103134929960903i, 0.11302206075679759 + 0.013925546254724263i, -0.031879905820155506 + 0.03507910531581185i }, { -0.20660686027135894 + 0.13657500099131611i, -0.07183894065544857 + -0.14214674090942211i, -0.13430200892703098 + 0.07244947340268915i, -0.0012278130802617123 + 0.09550345072182895i }, { -0.11397054806017644 + -0.1791950193440009i, 0.09806357880723268 + 0.049789028379085054i, -0.12195237465166651 + -0.06366683516916938i, 0.04720249096606806 + -0.022096085231807717i } }), Matrix({ { -0.14156543420397852 + -0.021302147628699687i, 0.0670886265309745 + 0.03579069816056292i, -0.147208026521585 + 0.12287807325791092i, -0.03724724816448651 + 0.04007901448894723i }, { -0.06011127528809654 + -0.07002050587523202i, -0.08130432997367845 + 0.026761879800384955i, -0.11641822412186287 + 0.05153217838853401i, -0.012703666941000606 + 0.020183896041145583i }, { 0.04809441689064891 + 0.0598695394337248i, -0.10689314101507799 + 0.16126756901142092i, 0.09062379887938354 + 0.11826108215116059i, -0.010356397030676964 + -0.006833619487673989i }, { -0.014778980256328749 + -0.051513511298234095i, 0.12353207259711779 + -0.027601202709450257i, 0.06257163986702852 + 0.061689044899061i, -0.06261277016317525 + 0.09221471659293731i } }), Matrix({ { -0.013595651815501732 + -0.1414902927029793i, 0.11700029561729619 + 0.07434559430771262i, -0.001223334688396312 + -0.028172469101202215i, 0.06891225989254574 + -0.05238812430825293i }, { -0.03485957669175015 + -0.058897827924684856i, 0.07775375156432499 + -0.02836238776727414i, -0.1077150484900203 + 0.06549164345596238i, 0.06418072580549657 + -0.02445128275176072i }, { -0.023336498628712187 + 0.03526459916319475i, 0.04306361750536701 + 0.17812792151566822i, -0.061097064822208266 + -0.2388545977064751i, -0.07091207179562477 + 0.0014508802379523359i }, { -0.1553550564861295 + -0.09538954706099903i, -0.034327004459498996 + 0.014590087386311007i, 0.04131865834219192 + -0.009120936024103517i, -0.08455280194122415 + 0.10516226999688132i } }), Matrix({ { -0.013983763618956528 + 0.03477455718495765i, -0.030997950218336786 + 0.12545784346773323i, 0.03455102566893254 + -0.06381122240762621i, -0.017389373442189437 + 0.15803431379699973i }, { -0.0553904238262547 + -0.012844972731677258i, -0.17887589283324065 + 0.01574735364302134i, -0.0986477598341034 + -0.07088548000841921i, 0.09658228528060857 + 0.2689654749178506i }, { -0.021197644265069735 + 0.06739234394110542i, 0.018751927436149163 + 0.06437167554259687i, -0.07546080952218615 + -0.027420853775559743i, -0.07447181359820687 + -0.0827028237939124i }, { 0.12029035268457525 + 0.03304288625268538i, 0.06723876979092432 + 0.03235608057851762i, 0.03783692262729584 + 0.0543108942509473i, -0.022933224201945646 + 0.07782407066209616i } }), Matrix({ { 0.01988697437607859 + 0.03711939744628317i, -0.22635321172482686 + 0.032842474454622454i, -0.087733812572329 + -0.16059507805537648i, 0.22736295330799178 + -0.0005314005908290978i }, { 0.09197322094756276 + -0.09115078866472431i, -0.051194532075336106 + -0.04903046149894521i, 0.18638237379864173 + 0.015899855650615947i, -0.12102473516498097 + 0.05455141417560798i }, { -0.16286997840368989 + -0.13917837856494697i, -0.015380912348299976 + -0.17947143872494228i, -0.03233264094430903 + 0.029031273436866966i, 0.232858541374136 + 0.102348208382349i }, { 0.0532720450129552 + 0.1241882351575618i, -0.03086005182294203 + -0.05362591166605389i, -0.2062450746825882 + -0.016736239173880472i, 0.0755849496669591 + 0.037759587196077596i } }), Matrix({ { 0.029015941779865814 + 0.08437166387432009i, -0.02661008903599154 + -0.11304624728512364i, -0.04514739438369555 + -0.05697141796061744i, -0.012533383761966183 + -0.019957025129946567i }, { 0.15737202045845303 + 0.016542287066146952i, 0.05249463189068825 + -0.09895436541745543i, -0.09122168095699278 + 0.12808697695634536i, 0.09550223216545357 + 0.12784571959963856i }, { 0.021201280064228587 + -0.0257792904510334i, -0.13219969852402086 + -0.1172281146189409i, 0.055042110344148514 + -0.03832836569607662i, -0.02920645951504357 + -0.0040934097896855835i }, { 0.17001268250289778 + -0.10043812687764044i, 0.04137543163087883 + 0.07029281450491515i, 0.022251198533715048 + 0.01948846837016694i, 0.15474930423846234 + 0.0869212716218928i } }), Matrix({ { -0.0043199066551970885 + -0.039842725870260165i, -0.1366029725701048 + -0.04889406558240974i, -0.08657968216134068 + 0.17348706494536675i, 0.10503956809804123 + -0.02785650124494153i }, { 0.06617686172245182 + 0.030754934743101328i, 0.04051672581509731 + 0.05985928476196065i, 0.030642543888308796 + -0.01579860585913989i, -0.0373061987954547 + -0.024563639878318843i }, { 0.017762956220745474 + -0.04199366267210716i, -0.14257293708874613 + -0.03518313883473657i, 0.058812720183141896 + -0.0008439497198255967i, 0.0277659409192161 + 0.04900003439837989i }, { 0.16632562958317468 + -0.04905884358256849i, -0.10000573640933916 + 0.07336226194565841i, -0.13127657997740216 + 0.03898963665432206i, -0.06178321780195278 + -0.07267134737313076i } }), Matrix({ { -0.08973729827684827 + -0.01051046212968328i, 0.09902454563277147 + 0.05366902352286701i, 0.020237150772133117 + 0.12380935754174i, 0.1087768455538109 + 0.1927838223230452i }, { -0.09037758759043521 + 0.08759290751325523i, -0.14247564971952933 + 0.06676664046812694i, 0.07951191668069311 + -0.022069234670124203i, -0.03255339896653669 + 0.0806056599632718i }, { -0.013524015819470665 + -0.10342113428254877i, -0.08111808110687874 + 0.021100117771353285i, -0.0032114776575663676 + 0.14044217962781652i, 0.05188978509472332 + -0.04664861778712991i }, { 0.009562212280097645 + 0.03316830424052647i, 0.1144066182830063 + 0.11272690425780311i, 0.14996320098627497 + 0.10157087758792327i, 0.16152584999950745 + -0.02006408330776697i } }), Matrix({ { 0.1552768379049492 + 0.09582744738317973i, 0.012883141632286975 + -0.04627157733055733i, -0.005113483178589337 + 0.02057556206216451i, 0.147314064703703 + 0.06127643401738702i }, { -0.02258754887185152 + 0.06950729707752533i, -0.0606540693397296 + 0.0266634858292716i, -0.13805097587919152 + 0.012882038567668102i, 0.020952234195982217 + -0.09776660258553597i }, { 0.021592075972965724 + 0.06825887110925248i, -0.09102219913554122 + -0.1672702759013902i, 0.1722107568830564 + -0.07678488496301347i, 0.02304833694425848 + -0.14059410071367157i }, { 0.018494029635114467 + 0.003838134843659348i, -0.10747786561713672 + -0.04364574051027165i, -0.043964881523721605 + 0.03782318987249712i, -0.016807402648136148 + -0.10815277877464158i } }), Matrix({ { 0.10093615816658645 + 0.011195838971825205i, 0.17691551106151263 + -0.05392343671824901i, 0.0055739201265923456 + 0.058794931448911424i, -0.1509711150478397 + 0.01164003072380797i }, { 0.22008524727625092 + -0.08230924064091762i, -0.02341585270948475 + -0.07998221674452088i, -0.13396022235839614 + 0.08003026635979334i, -0.1257387057554211 + -0.09814656310383149i }, { -0.05729904750118265 + -0.01646322223491197i, -0.11631604795398319 + 0.08422731030141982i, -0.0932025138895896 + 0.12377524485171754i, 0.02429795120466111 + 0.1696454713525759i }, { 0.03196058123222181 + 0.11360685439834876i, -0.013785626574615665 + 0.0301669986169146i, 0.03027289731769089 + -0.008981844028114049i, -0.10410974523305501 + -0.10164022697932645i } }), Matrix({ { -0.13936957366760172 + 0.06149494139888479i, 0.05764451780763848 + 0.059439139995896104i, 0.03349319911130187 + 0.02376674231067249i, 0.09012509217512579 + -0.06991782193074127i }, { 0.0805635083341887 + -0.11182872234415472i, 0.08517435526633711 + 0.058778200287154615i, 0.04893263842317085 + -0.05180247629441356i, 0.11913068155082968 + -0.02458397826658809i }, { 0.1915653056126762 + 0.04057417547709162i, -0.00801830801869928 + -0.048842209259066446i, -0.02578647121757848 + -0.02644539990298536i, 0.023560662046715208 + 0.11888650502761894i }, { -0.032785738475172244 + 0.024023563007220253i, 0.03532682190470899 + 0.06153869044931981i, -0.018740842269932875 + -0.1251002220351513i, -0.1008189600981974 + 0.028076944422892512i } }), Matrix({ { -0.05474572481903519 + 0.1416918369490502i, -0.06477991066188521 + -0.09988403836896961i, -0.14485889894936782 + -0.05606771786525178i, 0.028601894309998644 + -0.010312580636926442i }, { -0.05754520659004226 + -0.003920557403340528i, 0.14607355392901766 + 0.10131247136142384i, -0.15242506914707032 + -0.06236957291565662i, -0.09871421504362586 + -0.0485885530129671i }, { -0.11428671044946112 + 0.050739359951130436i, 0.21204266983455122 + 0.05566733015904725i, 0.025546048321626717 + -0.08856070595054935i, 0.030138874045076862 + 0.0533764072083908i }, { -0.060866255285536686 + 0.20464911974215888i, 0.06558575229258286 + -0.06488485139722981i, 0.04964669934394998 + 0.0058746134898630285i, -0.081127724584571 + -0.0015247583671789417i } }), Matrix({ { -0.010732098527253264 + 0.022484911335310696i, -0.11271224934758513 + 0.11461066955987367i, -0.007956910050612333 + 0.1451303950758682i, -0.046292895242386486 + -0.018808461913862536i }, { 0.10517192607719973 + 0.014281266750701816i, 0.10928091425793324 + 0.07408636757923501i, -0.01673387396236452 + 0.07291212464731466i, 0.05718429576723824 + 0.07748259377653749i }, { -0.16959467415448942 + -0.12034618045894288i, -0.02620254567910772 + 0.016796461550027002i, -0.04457290069030498 + 0.07581958424937403i, -0.012265417472798695 + -0.07306264959678621i }, { -0.006491572872872617 + 0.06783189129857278i, 0.08880310531883902 + 0.0004042619529163133i, 0.1705606961499286 + -0.0002290262800986043i, 0.03693603059511557 + -0.130435874770109i } }) }, { QubitIndex{ 0 }, QubitIndex{ 9 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 4 }, QubitIndex{ 7 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 2 }, QubitIndex{ 1 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { 0.010867695482523532 + -0.025608990681298564i, 0.08709008536459965 + -0.12941702950938366i, 0.17772197240458237 + 0.012283060886224832i, 0.07052777031633335 + -0.23661765955797653i }, { 0.03443810182872694 + 0.04800815167433124i, 0.049751060473358595 + -0.21242377462062298i, -0.1089784705932837 + -0.10258710175051391i, -0.003055982405791965 + 0.16804707942513647i }, { -0.1330923058635584 + -0.07920460442043349i, -0.10253190839479508 + -0.08387067965854617i, -0.0773264911558605 + 0.04378543132219818i, 0.07193349434051097 + -0.13701196872671687i }, { -0.039259025334855015 + -0.10990818428445452i, -0.03264918573553846 + -0.066920867534299i, -0.029418486476486972 + -0.15360688138224846i, 0.03629695645463356 + 0.06411676126538053i } }), Matrix({ { 0.056684059792975944 + -0.0434907238569384i, -0.0634270446095465 + 0.2167690097684253i, 0.028498122930331937 + -0.1404670925185985i, 0.11445028326340703 + 0.0659294165676743i }, { 0.17708486139184812 + -0.15092413483287542i, 0.05984449757999048 + 0.08289658870324598i, -0.05841729705836867 + 0.01468419747325666i, -0.14792094043663054 + -0.06109964865134511i }, { 0.10262391917568509 + -0.01791497387954331i, -0.05350043232307439 + 0.014686033588263871i, 0.012688992767233875 + -0.07084031309569362i, -0.10963249495668909 + 0.17229694681138494i }, { -0.04895050062878746 + -0.02213068218116883i, -0.002955516815188054 + -0.028158528093211087i, 0.07493951742992792 + 0.060465736055398164i, 0.044461503516627705 + -0.025522962769039932i } }), Matrix({ { -0.052217281106687934 + 0.03069517608286207i, 0.15486968422758957 + 0.09654699005728888i, 0.04559724048469408 + 0.18380019954543267i, -0.16213791044401799 + 0.10930227183957313i }, { -0.11956830426068585 + -0.01749023886350397i, -0.1497628186470455 + -0.06741208707080942i, -0.06731663059413447 + 0.05425490416186496i, -0.02699843025077915 + -0.007320667663336103i }, { 0.05693739292469335 + -0.105807277334221i, -0.017837339638614634 + -0.05561624514278462i, 0.2336376497060183 + -0.012453987864812888i, 0.08864726574859795 + 0.005339571325131975i }, { -0.10378218377930899 + -0.11594610561456864i, -0.06639964756532775 + -0.06943857486517392i, 0.0084242252259655 + -0.051612375077530095i, -0.059103294669296785 + -0.11856999017613275i } }), Matrix({ { -0.0421884819760974 + -0.033149780645805295i, -0.07028812371150431 + -0.07392067551923978i, -0.06113617768733409 + -0.19654838667471902i, 0.03777259995640276 + 0.09137165850341175i }, { 0.06852345720268319 + -0.11272334253819638i, 0.03934839725221604 + 0.09369040254652261i, 0.08172021778518199 + 0.0026837580818407348i, 0.045963021519519524 + -0.021639544545770065i }, { 0.08295879632520409 + -0.02715586913646962i, -0.026411969608935493 + -0.10601007790295279i, 0.03053742747406186 + 0.08652212390357455i, -0.08048624466880956 + 0.05590949351388298i }, { -0.03819488322882695 + 0.08699422216343576i, 0.11335653459960104 + -0.056924600211829504i, 0.09818142443524275 + 0.05537741312463658i, 0.075521442001563 + 0.010729760763351547i } }), Matrix({ { -0.10415080400146841 + -0.009011277061151735i, 0.09483288760778452 + 0.0885304873108578i, -0.06101127353911936 + -0.09695872332930719i, 0.022174104248392768 + 0.08336222624469937i }, { 0.07779264017176733 + -0.08594887058254032i, -0.05099789085508163 + 0.012180598941664966i, 0.07458228830060724 + -0.053121775049755i, -0.019277992361684683 + 0.05744827168560745i }, { -0.046623866540164795 + -0.03142951024569527i, -0.2561941990281722 + -0.1307320481356212i, -0.03223297931847306 + 0.14236675810671703i, 0.0036624609831047584 + -0.06236415895683117i }, { -0.09855359738984369 + 0.0656154664162828i, 0.08793638064547267 + -0.05711967875042674i, -0.18066789717875445 + -0.028027520731106804i, 0.03104401487134508 + -0.11961445967987319i } }), Matrix({ { -0.06126055733769492 + 0.20693189770096054i, -0.11108355037792392 + -0.1294894569105428i, 0.17095127376884578 + 0.22715924923551264i, 0.012988778973677723 + -0.09044500196526978i }, { -0.12403065140501782 + -0.053652989041065344i, -0.016771182260348298 + 0.06036944168875511i, 0.0825683220693514 + -0.050953306153211926i, -0.07093006560134463 + -0.09748893225353826i }, { 0.12680553537466416 + 0.09195287279012763i, 0.142405017628771 + 0.06002428023832761i, -0.0700202324379189 + 0.07184540569709875i, 0.02950108519835282 + -0.18714777313179642i }, { -0.15793758366612662 + -0.08925852592844585i, 0.05918068033663426 + 0.06531484189707393i, 0.017903479756392053 + 0.08090640051569596i, -0.12045375912988755 + 0.05824798120812571i } }), Matrix({ { 0.04403812135531469 + -0.08077658173241735i, -0.013077592447697394 + -0.10699100629854125i, -0.0475861017461997 + 0.13107047577721964i, 0.01777717237523948 + 0.1537954340955424i }, { 0.06790814720955823 + 0.05985418674795752i, -0.01837379184144385 + -0.11689666452345573i, -0.18750753533283843 + 0.08990650107267227i, -0.09564908697207042 + 0.007335568183124257i }, { 0.004856988263456902 + 0.12048844974341058i, -0.11734892893414486 + 0.07940650952693556i, -0.02169614392176699 + -0.09554842713058805i, -0.03072226798125991 + 0.05483822022394758i }, { 0.0807152654326515 + -0.0777076336138485i, -0.2082488146558228 + 0.018122705505473787i, -0.016663855790796746 + -0.1052204833891851i, -0.0921299304934012 + -0.08577786157374467i } }), Matrix({ { -0.11722163331860684 + -0.09623180188786168i, -0.11700466465187549 + 0.04972283554574923i, -0.07055580774988722 + 0.02905295646450453i, -0.011265704198795462 + -0.018150604700107962i }, { -0.011384980519318815 + 0.04996463040110078i, 0.028122918515944274 + 0.09688554194335708i, -0.1539871241077388 + -0.05737659389939426i, -0.10175567980349037 + 0.13102405252328786i }, { -0.08831354951877543 + -0.005100390748307745i, 0.24485657925271848 + 0.10567429398573301i, 0.17636123317996727 + -0.06718224224315354i, -0.026866863964096984 + -0.055622054502124194i }, { -0.11202609474115101 + -0.02717429405621277i, -0.045802457552090184 + 0.018434405473171635i, 0.09865526084192873 + -0.0688369938268762i, 0.16817761386480284 + 0.040654296261707135i } }), Matrix({ { 0.13748642846162498 + -0.14045963976627865i, 0.012040601785584418 + 0.027104558049964003i, -0.1488540008834128 + 0.01615585481372859i, 0.03544354314766809 + 0.02101801115258951i }, { -0.027261834538816858 + 0.1299150170729338i, 0.017919514690906652 + 0.013403496421653486i, 0.09180334069756255 + 0.06927499498714959i, 0.03925642388940098 + 0.023011884256829845i }, { -0.08496052485609527 + 0.059015260437447696i, -0.08643328675637685 + -0.034721104211367065i, 0.048464829116344504 + -0.18263370188286976i, 0.030986250084784416 + 0.044293127872712536i }, { -0.049003746063750755 + -0.01680456212711643i, -0.12284091805326919 + -0.024620903896546698i, -0.034594094961547285 + -0.028166137460223197i, 0.009713572853944646 + 0.009061198415479725i } }), Matrix({ { 0.17031861342728394 + -0.03160873224618674i, -0.07148521090201332 + 0.16196153595414664i, -0.0238762109714913 + -0.02998525670489533i, 0.025416813377234632 + 0.09488782881012396i }, { 0.01939691522307161 + -0.11166916689175402i, 0.06437921473546315 + -0.0070197210636510875i, -0.07036368788829955 + -0.08224013923427374i, -0.027401200157071325 + -0.004965538697374493i }, { 0.009146676980611498 + 0.0529254267802229i, 0.014828578265659836 + 0.16589802982590657i, -0.058125654829941795 + -0.1091471056848439i, -0.09053691427876452 + 0.12024422907354414i }, { -0.2046847931850436 + -0.07856829761733108i, -0.0523880910910083 + -0.07597808464010007i, 0.09505946185015937 + -0.12813176436375656i, -0.10015863498794163 + -0.05296865298978023i } }), Matrix({ { 0.01907832301739066 + 0.023641357245243244i, -0.10994613709408489 + 0.031164279156210287i, 0.02463794017770644 + 0.014267936162355065i, 0.2771775859261098 + 0.20323373151921093i }, { -0.0245868973522879 + 0.058431140811277066i, -0.012063581076594354 + 0.08002683220127135i, 0.02709585586325031 + 0.06288463650963766i, 0.029019659399016216 + 0.05916570444056919i }, { -0.06382625866759001 + -0.08972012365248645i, 0.1152969810794135 + 0.08707438298454058i, -5.041768244437336e-05 + 0.03935377015450189i, -0.12901069060059175 + -0.02352555610279798i }, { 0.002009839982478721 + 0.014998468371632328i, 0.025407279824508945 + -0.02283064104451713i, -0.03975267377217414 + 0.0002144033027113729i, 0.0928950262031303 + 0.06838961244405545i } }), Matrix({ { 0.1385929742028164 + 0.013893517995201093i, 0.08306573655688598 + 0.038174970536503934i, 0.05294586438105841 + 0.06014612595030528i, 0.004694866789514926 + 0.1068057119414283i }, { 0.006228774236238429 + 0.08906446142661466i, -0.060327360072695936 + 0.03759130750899965i, 0.046851498546252535 + 0.11077412913532433i, -0.06363818599428515 + 0.10166523865610068i }, { 0.1713879135250444 + -0.0038109684132794407i, -0.030814605910718138 + 0.007384128391784899i, 0.03950876752792746 + -0.026558955587682533i, -0.15612715967426477 + -0.05461348599008081i }, { 0.22822155148689663 + 0.11219018931764925i, 0.04865243905049684 + -0.1040896142974191i, -0.07861617582783732 + 0.048361099784232496i, -0.13219747516959757 + -0.12717830108634245i } }), Matrix({ { -0.024722273779550427 + 0.10354318259331069i, -0.03932601835802364 + -0.0911388003361082i, 0.058610567818131815 + -0.011843531027392053i, -0.0470430376103986 + 0.12773739219797545i }, { -0.07945035385000439 + 0.1324199261873922i, -0.03622184355551945 + 0.06294008581166916i, -0.02947877142679164 + 0.06178296029693181i, -0.00779235496392168 + -0.010424766632606977i }, { 0.11242838591261478 + 0.02506992039234742i, -0.09082154640620922 + 0.06038410440289279i, -0.041655646812474044 + -0.16826726857729146i, -0.06034857119977678 + -0.01462479421589677i }, { -0.01797868765817216 + 0.06599916972892168i, 0.044529899267571255 + -0.015126141349888338i, -0.003341598173928504 + 0.09235768071901525i, 0.03643839763653527 + 0.12648846445968537i } }), Matrix({ { -0.0028645730306765126 + 0.004155668147029733i, -0.12662288647333123 + 0.005022092783978509i, -0.08639620774125942 + 0.13000448327131545i, 0.00027189275905463943 + 0.11532594732914433i }, { 0.07380436392880813 + -0.048276803587892304i, -0.047426212849451324 + -0.03731838279682289i, -0.04939676686666436 + 0.03418102933238677i, -0.06502352773309429 + -0.16445323435048714i }, { -0.06080464532663828 + 0.059258027800022775i, -0.062301659337917065 + -0.020958535984738194i, 0.08892214161418686 + -0.1139994888613668i, 0.018546311268103677 + -0.0397541062934659i }, { -0.08592112375565032 + 0.10546671502546193i, 0.062407106749465854 + 0.080966737850844i, 0.005224644216180626 + 0.05063460104097336i, -0.05013583820102978 + -0.11914302237792457i } }), Matrix({ { 0.1237222717891402 + 0.046414569548627285i, -0.09168482205188899 + 0.061957302986593125i, -0.08000689583791426 + 0.04343841803659336i, -0.0007248440254794737 + -0.013357106929379737i }, { 0.008552954126724913 + 0.15272840986039538i, -0.06171301010570211 + 0.018214858074520703i, 0.12643954026623616 + 0.035549999401538405i, 0.04777421140543331 + 0.06608805110678712i }, { 0.012340471572119227 + -0.005641370895323832i, -0.13623653283804266 + -0.04013023381172191i, -0.04290514637391945 + 0.02733338022587319i, 0.08478538484008628 + 0.0750521405359107i }, { 0.12834818062371212 + -0.0816122267954129i, 0.12279577943763206 + -0.021291709723155083i, 0.06599106503311082 + -0.022563449877295846i, 0.046205387928500964 + 0.010703439032051546i } }), Matrix({ { 0.11860867881383436 + 0.09029652899199268i, 0.06291937024894385 + -0.21956118309116762i, -0.10005660186704311 + -0.1449256476419723i, 0.10613538912434121 + 0.15189822838466738i }, { 0.11073488421078968 + -0.06470984207834972i, -0.046775751379442905 + 0.026422177664690637i, -0.05380677204918975 + -0.03245471760585064i, -0.012778244362036907 + -0.03901552675187051i }, { 0.028568705610881068 + 0.03303696228914707i, 0.11201586961840712 + 0.01942357615038674i, -0.09538999925034523 + -0.0214563226501663i, 0.05558398743213776 + -0.1195458250737065i }, { 0.14509711889964352 + -0.14948918285536508i, -0.0013175792117322979 + -0.009518927386063258i, 0.07036341866856273 + 0.07467116614066649i, -0.09479008045352029 + -0.012400968282088823i } }) }, { QubitIndex{ 9 }, QubitIndex{ 6 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 6 }, QubitIndex{ 7 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { 0.011431168246045509 + -0.1350168969222648i, 0.04145771289741165 + -0.4909837513498724i }, { -0.006867361951154519 + 0.4933621208429817i, 0.15827639937925642 + 0.03191309126236363i } }), Matrix({ { 0.4358410727318621 + -0.25086252597388103i, 0.15540495563629264 + 0.308772151486013i }, { -0.39001547096675826 + 0.2507851885211626i, 0.050006104514402475 + 0.45692739010378913i } }), Matrix({ { -0.08238116629860322 + 0.23807931698668094i, -0.11061325906992515 + -0.289485124980599i }, { -0.29888484291593265 + -0.15992929541043097i, 0.22406513112496534 + -0.18452637581912i } }), Matrix({ { 0.2520613354885751 + -0.16011467583470249i, -0.20633180149340197 + 0.011512210446264576i }, { -0.047752235783243856 + -0.02149065194290669i, 0.15112440894488996 + 0.3931108375128463i } }) }, { QubitIndex{ 7 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { -0.06365086187963409 + 0.09864817078104485i, -0.10926687671174766 + -0.02019739470171611i, -0.01788732305213644 + -0.004494933706563775i, -0.027819207419075398 + -0.11356595171312334i }, { -0.07150272571216186 + -0.039960704605291664i, 0.033478027108589076 + 0.1419297927916995i, 0.02807429027526699 + 0.05247690420305996i, -0.007558379389095139 + -0.059517747005125105i }, { 0.06838476970150921 + 0.0012746832725209576i, 0.06709993840432373 + 0.11507137051184427i, -0.1638922544353258 + 0.10496382153810385i, 0.006627122181207425 + 0.020949213813889554i }, { 0.007016353943916547 + -0.0416870154698413i, 0.06424252393038828 + -0.07401448325493848i, -0.05049494552592787 + 0.03455585348824282i, -0.04481968878898312 + -0.14570495957008148i } }), Matrix({ { 0.07987196524229734 + 0.04434837345677127i, -0.11550676035054834 + -0.05174082033338938i, 0.10826021822942293 + -0.05052751365605716i, 0.1755883593994232 + -0.051684819355310704i }, { 0.010705114787915193 + -0.06517197812186384i, -0.1162967273176406 + 0.03481153819755945i, -0.03665258211284582 + -0.05009359782079557i, 0.03178636104704955 + 0.040118679163407424i }, { -0.10560730084183784 + -0.10680378184336123i, -0.013444904006314854 + 0.101586438774581i, 0.20036432055906098 + 0.05699994180964494i, 0.10684122428659426 + -0.08199546650015292i }, { 0.11633126422417409 + 0.05105508709679494i, -0.15941320475689466 + -0.03066887901641233i, -0.03617118182888236 + 0.023581573829593847i, -0.2103172713478759 + -0.07191874477092507i } }), Matrix({ { -0.0871030883137992 + 0.035084214970814646i, -0.15557472839856504 + 0.07138946844185531i, 0.016335580692893908 + 0.0075606318358457355i, -0.0691079470765536 + -0.22661953325694162i }, { 0.03020335929570724 + 0.0160874719285289i, 0.034098324099507 + -0.008013965181296247i, -0.06467930732885398 + -0.09622614110193747i, 0.04243545506910469 + 0.036084511266889975i }, { -0.05472816619324727 + -0.037263317518419846i, 0.09113893339203898 + -0.03264832512103452i, -0.05217361511316217 + 0.05368034295905713i, -0.04126391871928125 + 0.0609171332749094i }, { 0.08636953243300553 + -0.19364748577389498i, 0.03314005833052761 + 0.1410332234048525i, -0.030281283078733724 + -0.011505565879009767i, -0.07278163904401036 + -0.05078294583535937i } }), Matrix({ { 0.10244987448269814 + -0.1254017337889003i, 0.042291994067682775 + 0.023146549468009835i, -0.060011152982240475 + -0.15521206570024526i, 0.07186582497904967 + -0.1322582865362453i }, { 0.054742840625413666 + 0.08162090748046488i, -0.03286713437306809 + -0.11431366041805677i, 0.04546739076402663 + 0.04618580973330735i, -0.028434584399899123 + 0.14084645988519517i }, { 0.05514600778645975 + 0.03514852132697507i, 0.049677822494066305 + -0.007456871398565269i, 0.05654046401859499 + 0.0923414423231682i, -0.04086409993035024 + -0.148186688262339i }, { 0.13257903739101132 + -0.0009861208892428981i, 0.030191722723965413 + -0.04086201227864311i, -0.2027650214492325 + 0.05757311881975966i, 0.11448366121033632 + -0.0646492535414287i } }), Matrix({ { 0.024146627331629165 + -0.046020557245442566i, 0.03984245486541724 + -0.09301622350972294i, -0.007323309905715188 + 0.18090160329160246i, -0.043202402102569724 + -0.03116456238641985i }, { -0.22205344547370043 + -0.0235686406929608i, -0.1576500256854746 + -0.11755081639302337i, -0.0015963901603581185 + 0.07032435618048077i, -0.009971356624817768 + -0.05978664611331756i }, { 0.029785472093861204 + 0.12938021355066345i, 0.07813234088042091 + 0.03694805065360745i, 0.021700398480621292 + -0.0221461123469268i, 0.03199050092567136 + 0.046295934756907624i }, { -0.07215130559011838 + 0.024770038031535147i, 0.06570333194820119 + 0.03858621690221295i, -0.12753516211815205 + -0.19044210109990578i, 0.047332051122521195 + -0.07830271712631547i } }), Matrix({ { 0.023907291821671874 + 0.0493662551392346i, 0.04895300158074373 + -0.01304857377461715i, 0.07466687659192357 + 0.084849895387778i, 0.04965670449233941 + -0.15267751935853244i }, { 0.07159234822250797 + 0.06318442702828621i, -0.06786019446504386 + -0.04335791980883468i, -0.17624999230457739 + 0.15779579749848863i, -0.03691315529054483 + 0.010795465022181105i }, { -0.11066621454678768 + -0.01973429318333341i, 0.10661915362391144 + -0.021221999539279692i, -0.07161861361439752 + -0.028562421114725255i, -0.04569986244759366 + 0.19682574300283415i }, { -0.021836831349719886 + 0.051283777759885615i, -0.049842864464507294 + -0.004683267133483877i, -0.053271554864423164 + -0.04142807060015606i, 0.0695924105612002 + -0.0467108172764583i } }), Matrix({ { 0.11515626610900868 + 0.04144863193373758i, -0.0492511427182105 + 0.049341369899231054i, -0.032300507197385205 + 0.10738155389856222i, -0.0674924669784728 + -0.0612675033608051i }, { 0.031752791414690985 + -0.07995921102394392i, -0.01828658451863353 + -0.018234999715642998i, -0.04179050156188488 + -0.15999845343568497i, 0.07397819927293968 + 0.052139290985049803i }, { -0.17433522016936676 + -0.0016480187920246657i, -0.04129993433154471 + -0.14643181925903195i, -0.09505611392501748 + -0.028023060534011098i, -0.018045814107098802 + 0.00806583847188973i }, { -0.13759945984029573 + 0.1160582920226544i, 0.19193766439904456 + -0.07904983523445996i, -0.1245703918582381 + 0.04642195319467312i, -0.17635977771972577 + -0.06170804410735984i } }), Matrix({ { 0.1372881984636517 + -0.09795238957514991i, 0.13690870699869906 + 0.10440087302707322i, 0.04419094317126518 + 0.11622802747407629i, -0.06621582665708116 + -0.12532836017119192i }, { 0.026837588618743365 + -0.1439413747150878i, -0.0006854133516422672 + -0.020501974036336322i, -0.01044992332249656 + -0.11671249926741538i, -0.029138015483670048 + 0.002462628827159117i }, { 0.13168002526635136 + 0.13184794362879765i, 0.20585070283507062 + 0.30016415338543817i, 0.1625692374242695 + 0.008292069428211842i, 0.01475670021876106 + -0.022450187641505758i }, { -0.08446980845325222 + -0.00499200865015814i, -0.01787720933710917 + 0.04272258596706979i, -0.0034952687805359273 + -0.053595507087366816i, -0.0869705637993719 + -0.055593620815247255i } }), Matrix({ { -0.19287047232517185 + 0.12778437137000576i, 0.10380534762761597 + 0.013132034522778753i, -0.024231803001900983 + -0.10232048473994558i, -0.009777423941063314 + 0.03306903026005747i }, { -0.03862913009531921 + -0.06903094080339657i, 0.07989844558267141 + -0.09144614139423901i, 0.13558820133919297 + 0.0562194483363729i, 0.056849489762494404 + 0.17503928456315065i }, { -0.04655763828638397 + 0.06242194058617877i, -0.023609675764670365 + 0.03422704791009662i, -0.02508065651394449 + 0.09584207472381945i, -0.018355934821185742 + -0.011780401600034922i }, { 0.012546753424720983 + 0.013758921515747771i, -0.05693147309964219 + -0.044344450817923174i, 0.005462802005315628 + 0.12750318274259198i, -0.0653252072943384 + -0.10985927433269224i } }), Matrix({ { -0.07947710832613544 + -0.04666532588633496i, -0.15190561908773287 + 0.058574756464577826i, -0.07142922689561354 + -0.19267335799689408i, -0.03419954269603169 + 0.10282591319330818i }, { -0.0073928483092076695 + 0.0061347092892515085i, -0.06977968184337126 + 0.01553850471817219i, 0.1566804324034997 + -0.09211566882393804i, 0.11759945778406823 + -0.0023345098714740065i }, { -0.019883494043833716 + 0.0987019717253931i, 0.08261512746601682 + -0.03207304535573803i, 0.07726312121941487 + -0.23560135281160216i, -0.11856188757604674 + -0.0616607183578693i }, { -0.02583752066433113 + 0.04491332155191796i, -0.06565752871456448 + 0.0002660373940883609i, 0.037571449738862055 + 0.14110375700763342i, -0.017897490278577507 + -0.053347467850386576i } }), Matrix({ { -0.12191999637288657 + -0.0118811565671001i, -0.08483309690755576 + -0.04266167425564873i, 0.022061888087285604 + 0.029437256643991598i, -0.15347525019524202 + 0.011537296301682898i }, { -0.01567640076317196 + -0.018335188870948895i, 0.012360054858744718 + -0.1124641430611507i, 0.007403060385295312 + -0.11208988879783137i, 0.09669626417418657 + -0.01569734695034044i }, { 0.01685270337672952 + -0.009238478613552812i, 0.035163723554637594 + -0.02896414918882197i, 0.0664477649451322 + 0.14269014410865508i, 0.10223990830325834 + -0.021703569294523703i }, { -0.09743058949000079 + -0.08250436173041643i, 0.03522448120247237 + 0.058269948174801224i, -0.08641065178366679 + 0.13171401398443347i, 0.07867389545608207 + 0.021874711972270332i } }), Matrix({ { 0.056757264687826166 + 0.18962148916433616i, 0.014619358682080114 + -0.15443537218288755i, 0.07935392292073921 + 0.04899116370029145i, -0.05870156632598265 + -0.04174614563894544i }, { -0.11625366215468523 + -0.0009472646287250527i, -0.024186896571634826 + -0.057745194605400875i, -0.07782920856719956 + 0.006112206096439249i, 0.013979706797920632 + 0.160608372653158i }, { 0.03445414573667013 + -0.07014557855021775i, -0.09834100454068281 + 0.09567394997695441i, 0.022381734140570056 + 0.07677667551977223i, -0.024212566318952317 + 0.14079279669743827i }, { -0.10411047950729423 + 0.08094102578402003i, 0.07116020607596378 + -0.27242531590494723i, 0.00892939218789812 + 0.0826537157511376i, 0.09358691251699063 + -0.11726790280968873i } }), Matrix({ { 0.0688404497927092 + 0.13411709110644707i, 0.04915778852101339 + -0.0020726124763507372i, 0.17811154661417003 + 0.12726502833274486i, 0.09335219964215928 + 0.027682487193424973i }, { 0.06410184557508657 + -0.0694869681726712i, 0.21919878940279172 + 0.004150923670630575i, 0.0647435349894586 + 0.08161984686622362i, -0.16068851945037618 + 0.12742724772544842i }, { -0.015290722015329798 + 0.009001881401781412i, 0.11404452744800503 + 0.03138281949269757i, 0.004126519353251195 + -0.002531736300320561i, 0.021104311385988214 + -0.05275937232251925i }, { 0.2128611589657066 + -0.007309006511704812i, -0.0678644521240593 + 0.03705643809300655i, -0.00573596589843721 + -0.008024683783842166i, 0.032648424756780633 + 0.11816792088710767i } }), Matrix({ { -0.1337486230382461 + 0.0957493977766011i, -0.10102594346423283 + 0.11545187978977481i, 0.030255735184229835 + -0.08774197488173162i, -0.17587748325155325 + 0.004921539083829455i }, { 0.07161774156749105 + -0.11165364153892407i, -0.07862818756194943 + 0.03706053241652833i, -0.060504383640623174 + 0.006227479287060866i, 0.031342316522063575 + -0.16201041753813025i }, { 0.08184078141180791 + -0.028413378486372175i, 0.05677263178488329 + 0.11801231236225863i, -0.0694521588165048 + -0.04888755839536021i, 0.036705322725744005 + 0.1574550300732103i }, { 0.12519016459560428 + 0.008812757514829284i, 0.14638737692239173 + -0.09865611784049287i, 0.004365348696910507 + 0.017276164812902804i, -0.14537096890627285 + 0.004038659850894774i } }), Matrix({ { 0.02618397682909314 + -0.0032366619521992696i, 0.038137265421064395 + -0.05432642853948529i, 0.05499620782875403 + -0.03860436362753859i, -0.0027703365940589296 + -0.1505989847786218i }, { 0.023031621995557222 + -0.12853420296532014i, -0.0627168117024502 + -0.10274791472250573i, 0.1068049547589528 + 0.039677712794388746i, -0.11063857919712451 + 0.006171574336666936i }, { 0.14565658007260682 + 0.15816539988727418i, 0.14368646105955385 + -0.02147833136305173i, -0.053144812920322526 + 0.0048272744785473i, 0.0668573641441861 + -0.08533438940441979i }, { 0.035928762878610826 + -0.044716317641966305i, 0.007011343223387887 + -0.0488628133039358i, -0.05960186956395527 + -0.12510032969745313i, -0.20186787496157801 + -0.03195569995402857i } }), Matrix({ { 0.1094598930039804 + 0.03228735865495992i, 0.08788381063125177 + -0.016759774885501986i, -0.06915450066152415 + -0.0410975576892972i, 0.0015201150322643137 + -0.13541026337417142i }, { -0.013528563720947516 + -0.0926772784031549i, -0.027625880405311363 + 0.05912346409886411i, -0.11391443740913222 + 0.018920248175439264i, -0.011077249722225698 + -0.015163559940259618i }, { 0.20920218602877516 + -0.12294705795460271i, -0.09483573446458926 + 0.012031684966154853i, -0.10685704847037673 + 0.08586611194784566i, 0.0473087963020087 + 0.08823834598014357i }, { -0.18570294562059636 + 0.002706007201372238i, 0.040405980602287964 + 0.14350146186245036i, 0.05876594412758898 + 0.13205089125116046i, -0.06695904466577617 + -0.0300418109259062i } }) }, { QubitIndex{ 0 }, QubitIndex{ 9 } }));


    return c;
}

TEST(RandomizedIntegrationTests, 10_15_2_70_0_50) {
    auto c = randomCircuit();
    
    auto s = c.execute();

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, false, false, false, false, false, false}), Matrix({ { 0.4855616824922966 + -1.5405411728187587e-20i, -0.012507904854671868 + 0.014758400269677074i }, { -0.012507904854671868 + -0.014758400269677074i, 0.5144383175077045 + 8.883961137850145e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, false, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.4855616824922966, 1.0e-7), DoubleNear(0.5144383175077045, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, false, false, false, false, false, false}), Matrix({ { 0.503794984814852 + -1.3427374729389532e-19i, 0.0592197554739522 + -0.0052472037597005635i }, { 0.0592197554739522 + 0.005247203759700562i, 0.49620501518514915 + 2.0770794694420918e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, false, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.503794984814852, 1.0e-7), DoubleNear(0.49620501518514915, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, false, false, false, false, false, false}), Matrix({ { 0.4202945251263825 + 1.5003774181762465e-19i, -3.5236570605778894e-19 + 2.1006417091906648e-19i }, { -2.710505431213761e-19 + -3.3203691532368573e-19i, 0.5797054748736187 + -7.660354216731079e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, false, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.4202945251263825, 1.0e-7), DoubleNear(0.5797054748736187, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, false, false, false, false, false, false}), Matrix({ { 0.41102071660586675 + 3.3367431934623445e-20i, -0.006946300864696867 + -0.08220357460718142i }, { -0.006946300864696867 + 0.08220357460718142i, 0.5889792833941345 + 4.0066767715690416e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, false, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.41102071660586675, 1.0e-7), DoubleNear(0.5889792833941345, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, true, false, false, false, false, false}), Matrix({ { 0.3543511436768749 + -1.232044163367107e-20i, 4.9873299934333204e-18 + -4.119968255444917e-18i }, { 3.903127820947816e-18 + 4.336808689942018e-18i, 0.6456488563231263 + 8.575464128398493e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, true, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.3543511436768749, 1.0e-7), DoubleNear(0.6456488563231263, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, true, false, false, false, false}), Matrix({ { 0.5388057818294495 + 7.258820067882525e-20i, 0.004793831101792045 + 0.03912199680097593i }, { 0.004793831101792048 + -0.03912199680097593i, 0.46119421817055173 + 8.459989714886091e-22i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, true, false, false, false, false}), ElementsAreArray({ DoubleNear(0.5388057818294495, 1.0e-7), DoubleNear(0.46119421817055173, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, false, true, false, false, false}), Matrix({ { 0.5842434525879117 + 1.0513796457794003e-19i, 7.589415207398531e-19 + -3.2526065174565133e-19i }, { 6.776263578034403e-19 + 5.421010862427522e-19i, 0.41575654741208956 + -3.170376492762617e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, false, true, false, false, false}), ElementsAreArray({ DoubleNear(0.5842434525879117, 1.0e-7), DoubleNear(0.41575654741208956, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, false, false, true, false, false}), Matrix({ { 0.46231124998823614 + 1.216865399126759e-20i, -0.09080854102727853 + -0.1121443409750631i }, { -0.09080854102727853 + 0.1121443409750631i, 0.5376887500117651 + 6.126554565904627e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, false, false, true, false, false}), ElementsAreArray({ DoubleNear(0.46231124998823614, 1.0e-7), DoubleNear(0.5376887500117651, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, false, false, false, true, false}), Matrix({ { 0.46925026341051784 + -9.159784513105952e-20i, 0.0215611105668862 + 0.03615673828613952i }, { 0.0215611105668862 + -0.03615673828613952i, 0.5307497365894833 + 1.6503204478137338e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, false, false, false, true, false}), ElementsAreArray({ DoubleNear(0.46925026341051784, 1.0e-7), DoubleNear(0.5307497365894833, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, false, false, false, false, true}), Matrix({ { 0.5194992254453792 + 5.0551075184646904e-20i, -0.038098440859136454 + -0.03544551687165241i }, { -0.038098440859136454 + 0.03544551687165241i, 0.4805007745546221 + 2.2883124465666958e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, false, false, false, false, true}), ElementsAreArray({ DoubleNear(0.5194992254453792, 1.0e-7), DoubleNear(0.4805007745546221, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, true, false, false, false, false, false, false, false, false}), Matrix({ { 0.24461604522677874 + -5.807469644612297e-20i, -0.006303324932286044 + 0.007426986239770593i, 0.028754844104714586 + -0.0025374776703443783i, -0.0006746427526824021 + 0.0009422546338726748i }, { -0.006303324932286045 + -0.007426986239770593i, 0.25917893958807325 + -7.619905084777236e-20i, -0.0008067873812878517 + -0.000805723076441296i, 0.03046491136923761 + -0.0027097260893561856i }, { 0.028754844104714586 + 0.002537477670344377i, -0.0008067873812878517 + 0.0008057230764412962i, 0.24094563726551785 + 4.266928471793538e-20i, -0.006204579922385826 + 0.007331414029906481i }, { -0.0006746427526824021 + -0.0009422546338726748i, 0.03046491136923761 + 0.0027097260893561843i, -0.006204579922385826 + -0.007331414029906481i, 0.25525937791963127 + 1.650386622262738e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, true, false, false, false, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.24461604522677874, 1.0e-7), DoubleNear(0.25917893958807325, 1.0e-7), DoubleNear(0.24094563726551785, 1.0e-7), DoubleNear(0.25525937791963127, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, true, false, false, false, false, false, false, false}), Matrix({ { 0.20423633793386556 + 5.946435987521205e-20i, -0.005216989397247343 + 0.0063755560171955515i, -1.9651164376299768e-19 + 1.1519648082658485e-19i, 9.529120656610879e-22 + -6.776263578034403e-21i }, { -0.005216989397247343 + -0.0063755560171955515i, 0.21605818719251696 + 9.05733819424126e-20i, 6.776263578034403e-21 + 1.0693790959085542e-20i, -1.6263032587282567e-19 + 1.1180834903756764e-19i }, { -1.6263032587282567e-19 + -9.825582188149884e-20i, 1.2705494208814505e-21 + -6.246867986000465e-21i, 0.28132534455843106 + -7.486977160339964e-20i, -0.007290915457424528 + 0.008382844252481522i }, { 7.411538288475128e-22 + 5.505714157152952e-21i, -1.8973538018496328e-19 + -1.5246593050577406e-19i, -0.007290915457424529 + -0.008382844252481522i, 0.2983801303151876 + -1.733770563911146e-21i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, true, false, false, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.20423633793386556, 1.0e-7), DoubleNear(0.21605818719251696, 1.0e-7), DoubleNear(0.28132534455843106, 1.0e-7), DoubleNear(0.2983801303151876, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, true, false, false, false, false, false, false}), Matrix({ { 0.19957591069433384 + 7.742410533496339e-21i, -0.005141008016605226 + 0.00606600825479888i, -0.003372857534959901 + -0.039914905993143984i, 0.0013000769279585974 + 0.0009256782013457441i }, { -0.005141008016605226 + -0.00606600825479888i, 0.2114448059115329 + 2.5625021401127106e-20i, -0.001126309587343491 + 0.0011307107784553445i, -0.0035734433297369655 + -0.04228866861403742i }, { -0.003372857534959902 + 0.039914905993143984i, -0.001126309587343491 + -0.0011307107784553447i, 0.28598577179796275 + -2.3147822261683926e-20i, -0.007366896838066645 + 0.008692392014878193i }, { 0.0013000769279585974 + -0.0009256782013457442i, -0.0035734433297369655 + 0.04228866861403742i, -0.007366896838066645 + -0.008692392014878193i, 0.3029935115961717 + 6.321458997737434e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, true, false, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.19957591069433384, 1.0e-7), DoubleNear(0.2114448059115329, 1.0e-7), DoubleNear(0.28598577179796275, 1.0e-7), DoubleNear(0.3029935115961717, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, true, false, false, false, false, false}), Matrix({ { 0.17205933751681268 + 1.7893571010747095e-20i, -0.004432190390254508 + 0.0052296560144011635i, 2.0599841277224584e-18 + -1.6263032587282567e-18i, 6.776263578034403e-21 + 1.2705494208814505e-19i }, { -0.004432190390254508 + -0.0052296560144011635i, 0.1822918061600622 + -3.0214012644418165e-20i, -7.369186641112413e-20 + -3.049318610115481e-20i, 1.951563910473908e-18 + -2.2768245622195593e-18i }, { 1.6263032587282567e-18 + 2.0599841277224584e-18i, -7.115076756936123e-20 + -2.202285662861181e-20i, 0.3135023449754839 + -3.329898273893468e-20i, -0.008075714464417363 + 0.00952874425527591i }, { 6.776263578034403e-21 + -1.4399560103323106e-19i, 1.951563910473908e-18 + 2.0599841277224584e-18i, -0.008075714464417363 + -0.00952874425527591i, 0.3321465113476424 + 1.1905362402291961e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, true, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.17205933751681268, 1.0e-7), DoubleNear(0.1822918061600622, 1.0e-7), DoubleNear(0.3135023449754839, 1.0e-7), DoubleNear(0.3321465113476424, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, false, true, false, false, false, false}), Matrix({ { 0.2616234419616845 + 2.609920268727313e-20i, -0.006739331454269836 + 0.007951911395855304i, 0.002327700695370043 + 0.0189961425891401i, -0.00063733887144841 + -0.0004185849354859097i }, { -0.006739331454269836 + -0.007951911395855304i, 0.277182339867765 + 4.6488997991552123e-20i, 0.0005174173048272466 + -0.0005600834919368579i, 0.0024661304064220024 + 0.02012585421183584i }, { 0.0023277006953700444 + -0.0189961425891401i, 0.0005174173048272465 + 0.0005600834919368579i, 0.22393824053061212 + -4.1504614415460717e-20i, -0.0057685734004020335 + 0.006806488873821768i }, { -0.00063733887144841 + 0.0004185849354859097i, 0.002466130406422004 + -0.02012585421183584i, -0.0057685734004020335 + -0.006806488873821768i, 0.23725597763993955 + 4.2350613386949326e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, false, true, false, false, false, false}), ElementsAreArray({ DoubleNear(0.2616234419616845, 1.0e-7), DoubleNear(0.277182339867765, 1.0e-7), DoubleNear(0.22393824053061212, 1.0e-7), DoubleNear(0.23725597763993955, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, false, false, true, false, false, false}), Matrix({ { 0.2819832927138866 + 7.411538288475128e-22i, -0.007383576840017044 + 0.007629463552274992i, 3.1170812458958252e-19 + -1.6263032587282567e-19i, 4.489274620447792e-20 + -6.776263578034403e-21i }, { -0.007383576840017044 + -0.007629463552274992i, 0.30226015987402505 + 1.0439681074909252e-19i, -8.470329472543003e-20 + -4.404571325722362e-20i, 5.55653613398821e-19 + -1.8973538018496328e-19i }, { 2.913793338554793e-19 + 1.6263032587282567e-19i, -6.437450399132683e-20 + 2.0328790734103208e-20i, 0.20357838977841 + -1.61465655570351e-20i, -0.005124328014654827 + 0.00712893671740208i }, { 3.6845933205562065e-20 + -1.0164395367051604e-20i, 4.0657581468206416e-19 + 2.439454888092385e-19i, -0.005124328014654826 + -0.007128936717402081i, 0.21217815763367953 + -1.5557199370591068e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, false, false, true, false, false, false}), ElementsAreArray({ DoubleNear(0.2819832927138866, 1.0e-7), DoubleNear(0.30226015987402505, 1.0e-7), DoubleNear(0.20357838977841, 1.0e-7), DoubleNear(0.21217815763367953, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, false, false, false, true, false, false}), Matrix({ { 0.224482396744855 + -2.967262293350221e-20i, -0.005779549808825567 + 0.006827839611449375i, -0.04408252399759665 + -0.05445413166503802i, 0.002812018424450108 + 8.980514325878221e-05i }, { -0.005779549808825567 + -0.006827839611449375i, 0.23782885324338116 + 4.18412769247698e-20i, -0.0005043787437632025 + 0.0027117253177993926i, -0.04672601702968188 + -0.057690209310025074i }, { -0.04408252399759665 + 0.05445413166503803i, -0.0005043787437632024 + -0.002711725317799393i, 0.26107928574744155 + 1.426721120531462e-20i, -0.0067283550458463025 + 0.007930560658227698i }, { 0.002812018424450108 + -8.980514325878221e-05i, -0.04672601702968188 + 0.057690209310025074i, -0.0067283550458463025 + -0.007930560658227698i, 0.2766094642643234 + 4.699833445373165e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, false, false, false, true, false, false}), ElementsAreArray({ DoubleNear(0.224482396744855, 1.0e-7), DoubleNear(0.23782885324338116, 1.0e-7), DoubleNear(0.26107928574744155, 1.0e-7), DoubleNear(0.2766094642643234, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, false, false, false, false, true, false}), Matrix({ { 0.2278499474115641 + -8.228130989187477e-20i, -0.005869337647768462 + 0.0069253832140638155i, 0.010469249123259684 + 0.017556326675651525i, -0.0008032999356044769 + -0.00013403754233343423i }, { -0.005869337647768463 + -0.0069253832140638155i, 0.24140031599895367 + -9.31653523918475e-21i, 0.00026393129654113184 + -0.0007704525423431743i, 0.011091861443626512 + 0.018600411610488i }, { 0.010469249123259684 + -0.01755632667565152i, 0.00026393129654113184 + 0.0007704525423431741i, 0.2577117350807325 + 6.687589816368718e-20i, -0.006638567206903407 + 0.007833017055613258i }, { -0.0008032999356044769 + 0.0001340375423334344i, 0.011091861443626512 + -0.018600411610488005i, -0.006638567206903407 + -0.007833017055613258i, 0.2730380015087509 + 9.81561466176862e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, false, false, false, false, true, false}), ElementsAreArray({ DoubleNear(0.2278499474115641, 1.0e-7), DoubleNear(0.24140031599895367, 1.0e-7), DoubleNear(0.2577117350807325, 1.0e-7), DoubleNear(0.2730380015087509, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, false, false, false, false, false, true}), Matrix({ { 0.26962469043639714 + 1.8078859467958973e-20i, 0.0013118577728595605 + 0.0037994579835976513i, -0.01677833391990151 + -0.021346072124626178i, -0.006196579954908284 + 0.008248764277517771i }, { 0.00131185777285956 + -0.0037994579835976513i, 0.24987453500898196 + 3.247221571668793e-20i, -0.010834312702866083 + 0.02626545483785647i, -0.021320106939234945 + -0.014099444747026235i }, { -0.01677833391990151 + 0.021346072124626178i, -0.010834312702866082 + -0.02626545483785647i, 0.21593699205589947 + -3.348427119614656e-20i, -0.013819762627531429 + 0.010958942286079423i }, { -0.006196579954908285 + -0.008248764277517771i, -0.021320106939234945 + 0.014099444747026233i, -0.013819762627531429 + -0.010958942286079423i, 0.2645637824987226 + 5.636739566181352e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, false, false, false, false, false, true}), ElementsAreArray({ DoubleNear(0.26962469043639714, 1.0e-7), DoubleNear(0.24987453500898196, 1.0e-7), DoubleNear(0.21593699205589947, 1.0e-7), DoubleNear(0.2645637824987226, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, true, false, false, false, false, false, false, false}), Matrix({ { 0.20014160521563207 + 2.336785230462303e-21i, 0.0248897390050252 + 0.013834501431185114i, -2.574980159653073e-19 + 2.0328790734103208e-20i, -1.6263032587282567e-18 + 4.336808689942018e-19i }, { 0.0248897390050252 + -0.013834501431185116i, 0.22015291991075042 + 1.4770095658716235e-19i, -1.3010426069826053e-18 + 8.673617379884035e-19i, -8.131516293641283e-20 + 2.0328790734103208e-19i }, { -2.303929616531697e-19 + -3.7269449679189215e-20i, -1.6263032587282567e-18 + -5.692061405548898e-19i, 0.30365337959921995 + -1.3661053252435763e-19i, 0.034330016468927 + -0.01908170519088568i }, { -1.6263032587282567e-18 + -1.0028870095490916e-18i, -1.0164395367051604e-19 + -2.439454888092385e-19i, 0.034330016468927 + 0.019081705190885676i, 0.2760520952743988 + 6.000699035704684e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, true, false, false, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.20014160521563207, 1.0e-7), DoubleNear(0.22015291991075042, 1.0e-7), DoubleNear(0.30365337959921995, 1.0e-7), DoubleNear(0.2760520952743988, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, true, false, false, false, false, false, false}), Matrix({ { 0.207070175681042 + 2.3810187137185763e-20i, 0.024340546332128003 + -0.0021567094494891214i, -0.003499511538649347 + -0.04141374862095147i, -0.0008426971443954783 + -0.004831626931308815i }, { 0.024340546332128003 + 0.0021567094494891205i, 0.20395054092482473 + 9.557244797437682e-21i, 1.998066708377652e-05 + -0.004904524243335312i, -0.0034467893260475193 + -0.04078982598622995i }, { -0.0034995115386493476 + 0.041413748620951464i, 1.9980667083776898e-05 + 0.004904524243335312i, 0.29672480913381005 + -1.5808393443108109e-19i, 0.0348792091418242 + -0.0030904943102114425i }, { -0.0008426971443954781 + 0.004831626931308815i, -0.0034467893260475193 + 0.04078982598622995i, 0.0348792091418242 + 0.003090494310211441i, 0.2922544742603244 + 1.981507021467715e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, true, false, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.207070175681042, 1.0e-7), DoubleNear(0.20395054092482473, 1.0e-7), DoubleNear(0.29672480913381005, 1.0e-7), DoubleNear(0.2922544742603244, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, true, false, false, false, false, false}), Matrix({ { 0.17852032904781645 + -4.200629945697413e-20i, 0.02098458808045981 + -0.0018593526533554907i, 2.0599841277224584e-18 + -1.734723475976807e-18i, 2.710505431213761e-20 + -1.3552527156068805e-19i }, { 0.02098458808045981 + 0.0018593526533554896i, 0.17583081462905847 + 2.968585782330306e-20i, 4.607859233063394e-19 + -2.981555974335137e-19i, 2.0599841277224584e-18 + -1.8431436932253575e-18i }, { 1.8431436932253575e-18 + 2.2768245622195593e-18i, 4.607859233063394e-19 + 4.0657581468206416e-19i, 0.3252746557670356 + -9.22674478369212e-20i, 0.03823516739349239 + -0.0033878511063450733i }, { 5.421010862427522e-20 + 6.776263578034403e-20i, 2.0599841277224584e-18 + 2.168404344971009e-18i, 0.03823516739349239 + 0.003387851106345072i, 0.32037420055609067 + 1.7802208912090613e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, true, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.17852032904781645, 1.0e-7), DoubleNear(0.17583081462905847, 1.0e-7), DoubleNear(0.3252746557670356, 1.0e-7), DoubleNear(0.32037420055609067, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, false, true, false, false, false, false}), Matrix({ { 0.2746197825697952 + -8.111725997485952e-20i, 0.023597715907757336 + 0.002003788271718191i, -0.001914282358979919 + 0.022019798306928785i, 0.049488541538539335 + -0.011007874858633613i }, { 0.023597715907757336 + -0.0020037882717181925i, 0.26418599925965436 + 1.5370546065368477e-19i, 0.05039568862109137 + -0.012589631899969325i, 0.006708113460771964 + 0.017102198494047156i }, { -0.001914282358979919 + -0.022019798306928785i, 0.05039568862109136 + 0.012589631899969327i, 0.2291752022450568 + -5.31564873190358e-20i, 0.03562203956619486 + -0.007250992031418755i }, { 0.04948854153853933 + 0.011007874858633613i, 0.006708113460771967 + -0.017102198494047153i, 0.03562203956619486 + 0.007250992031418754i, 0.23201901592549484 + 5.400248629052441e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, false, true, false, false, false, false}), ElementsAreArray({ DoubleNear(0.2746197825697952, 1.0e-7), DoubleNear(0.26418599925965436, 1.0e-7), DoubleNear(0.2291752022450568, 1.0e-7), DoubleNear(0.23201901592549484, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, false, false, true, false, false, false}), Matrix({ { 0.29416980411551663 + -9.3875073357418e-20i, 0.034598754399513675 + -0.002831811501167716i, 4.0657581468206416e-19 + -1.6263032587282567e-19i, 8.978549240895584e-20 + -1.3552527156068805e-19i }, { 0.034598754399513675 + 0.0028318115011677155i, 0.29007364847239503 + 1.9901303793535803e-19i, 5.082197683525802e-21 + 7.792703114739563e-20i, 3.1170812458958252e-19 + -2.710505431213761e-19i }, { 3.9302328752599536e-19 + 1.8973538018496328e-19i, 3.3881317890172014e-21 + -9.317362419797304e-20i, 0.20962518069933542 + -4.039867393647732e-20i, 0.024621001074438528 + -0.0024153922585328476i }, { 7.623296525288703e-20 + 1.2874900798265365e-19i, 3.2526065174565133e-19 + 2.710505431213761e-19i, 0.024621001074438528 + 0.002415392258532846i, 0.20613136671275412 + 8.69490900885115e-21i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, false, false, true, false, false, false}), ElementsAreArray({ DoubleNear(0.29416980411551663, 1.0e-7), DoubleNear(0.29007364847239503, 1.0e-7), DoubleNear(0.20962518069933542, 1.0e-7), DoubleNear(0.20613136671275412, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, false, false, false, true, false, false}), Matrix({ { 0.23286557036172453 + -6.880260860547632e-20i, 0.0273779591771605 + -0.002364286604434936i, -0.046016347184625044 + -0.05646913801014952i, -0.005926533853316223 + -0.005794861672888258i }, { 0.027377959177160502 + 0.0023642866044349346i, 0.22944567962651158 + 8.097126259674391e-20i, -0.004828785335847345 + -0.007487459227773234i, -0.04479219384265349 + -0.05567520296491358i }, { -0.046016347184625044 + 0.05646913801014952i, -0.004828785335847347 + 0.007487459227773235i, 0.27092941445312746 + -6.5471138688419e-20i, 0.0318417962967917 + -0.002882917155265628i }, { -0.005926533853316223 + 0.005794861672888258i, -0.04479219384265349 + 0.05567520296491357i, 0.0318417962967917 + 0.002882917155265627i, 0.26675933555863757 + 1.2673668434746527e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, false, false, false, true, false, false}), ElementsAreArray({ DoubleNear(0.23286557036172453, 1.0e-7), DoubleNear(0.22944567962651158, 1.0e-7), DoubleNear(0.27092941445312746, 1.0e-7), DoubleNear(0.26675933555863757, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, false, false, false, false, true, false}), Matrix({ { 0.23640592932926682 + -5.475563423825394e-20i, 0.02778888585525849 + -0.0024622517464081466i, 0.010862379370635765 + 0.01821558341582022i, 0.0014665654685913861 + 0.002028057659610981i }, { 0.02778888585525849 + 0.0024622517464081453i, 0.23284433408125094 + -3.6842210892805576e-20i, 0.0010871219224443058 + 0.00225432874047075i, 0.010698731196250434 + 0.017941154870319304i }, { 0.010862379370635765 + -0.01821558341582022i, 0.0010871219224443058 + -0.00225432874047075i, 0.26738905548558517 + -7.951811305564138e-20i, 0.031430869618693714 + -0.002784952013292417i }, { 0.0014665654685913861 + -0.002028057659610981i, 0.010698731196250432 + -0.017941154870319307i, 0.031430869618693714 + 0.002784952013292416i, 0.2633606811038982 + 2.4455015783701476e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, false, false, false, false, true, false}), ElementsAreArray({ DoubleNear(0.23640592932926682, 1.0e-7), DoubleNear(0.23284433408125094, 1.0e-7), DoubleNear(0.26738905548558517, 1.0e-7), DoubleNear(0.2633606811038982, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, false, false, false, false, false, true}), Matrix({ { 0.2617112203032218 + -1.229049769549665e-19i, 0.03076461709978288 + -0.002712251872878425i, -0.01919485024814618 + -0.017846945142856785i, -0.0024278893274961967 + -0.0018977171634701046i }, { 0.03076461709978288 + 0.0027122518728784238i, 0.2577880051421573 + 1.7345605213961341e-19i, -0.0020844713757375783 + -0.0023004325201040963i, -0.018903590610990274 + -0.01759857172879563i }, { -0.019194850248146177 + 0.01784694514285678i, -0.0020844713757375783 + 0.0023004325201040968i, 0.24208376451163022 + -1.1368770338928812e-20i, 0.028455138374169322 + -0.002534951886822139i }, { -0.0024278893274961967 + 0.0018977171634701046i, -0.018903590610990274 + 0.01759857172879563i, 0.028455138374169322 + 0.0025349518868221376i, 0.23841701004299187 + 3.425189480459577e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, false, false, false, false, false, true}), ElementsAreArray({ DoubleNear(0.2617112203032218, 1.0e-7), DoubleNear(0.2577880051421573, 1.0e-7), DoubleNear(0.24208376451163022, 1.0e-7), DoubleNear(0.23841701004299187, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, true, false, false, false, false, false, false}), Matrix({ { 0.172749756902968 + 3.492914893112356e-20i, -1.6940658945086007e-19 + 8.809142651444724e-20i, -0.002919492223312746 + -0.034549712353216425i, 2.541098841762901e-20 + 2.879912020664621e-20i }, { -1.1519648082658485e-19 + -1.0164395367051604e-19i, 0.23827095970289874 + -1.5617169965001163e-21i, -2.1175823681357508e-20 + 1.9481757786848908e-20i, -0.004026808641384121 + -0.047653862253964986i }, { -0.002919492223312746 + 0.034549712353216425i, -2.0328790734103208e-20 + -2.541098841762901e-20i, 0.2475447682234145 + 1.1510859288650109e-19i, -1.8973538018496328e-19 + 1.4907779871675686e-19i }, { 2.371692252312041e-20 + -3.5575383784680614e-20i, -0.004026808641384121 + 0.04765386225396498i, -2.168404344971009e-19 + -1.8295911660692887e-19i, 0.3414345151707199 + -7.504182517081067e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, true, false, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.172749756902968, 1.0e-7), DoubleNear(0.23827095970289874, 1.0e-7), DoubleNear(0.2475447682234145, 1.0e-7), DoubleNear(0.3414345151707199, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, true, false, false, false, false, false}), Matrix({ { 0.1489318456596625 + 1.1846467142678186e-20i, -1.3552527156068805e-19 + -2.574980159653073e-19i, 4.119968255444917e-18 + 1.3010426069826053e-18i, -0.00121053147402694 + 0.0009504361237532826i }, { -1.1519648082658485e-19 + 1.7618285302889447e-19i, 0.2054192980172124 + -2.4166908776349257e-20i, -0.0013028289678271442 + 0.0008193606992866202i, 4.336808689942018e-19 + -5.421010862427522e-18i }, { 3.0357660829594124e-18 + -8.673617379884035e-19i, -0.0013028289678271442 + -0.0008193606992866204i, 0.27136267946672 + 1.3819127467494646e-19i, -2.168404344971009e-19 + 4.87890977618477e-19i }, { -0.00121053147402694 + -0.0009504361237532824i, 2.168404344971009e-19 + 6.288372600415926e-18i, -2.0328790734103208e-19 + -5.285485590866834e-19i, 0.3742861768564063 + -5.243663339096153e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, true, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.1489318456596625, 1.0e-7), DoubleNear(0.2054192980172124, 1.0e-7), DoubleNear(0.27136267946672, 1.0e-7), DoubleNear(0.3742861768564063, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, false, true, false, false, false, false}), Matrix({ { 0.22645712020935746 + 1.309275949209652e-19i, -1.6940658945086007e-19 + 9.147955830346444e-20i, 0.002014820966463768 + 0.016442761067462015i, -2.303929616531697e-19 + 2.168404344971009e-19i }, { -1.4907779871675686e-19 + -1.4230153513872246e-19i, 0.31234866162009206 + -5.833939424213994e-20i, -3.2526065174565133e-19 + -2.1006417091906648e-19i, 0.0027790101353282774 + 0.02267923573351392i }, { 0.002014820966463768 + -0.016442761067462015i, -3.2526065174565133e-19 + 7.453889935837843e-20i, 0.19383740491702506 + 1.911014689665946e-20i, -2.0328790734103208e-19 + 1.2874900798265365e-19i }, { -2.439454888092385e-19 + -2.1006417091906648e-19i, 0.0027790101353282796 + -0.02267923573351392i, -1.7618285302889447e-19 + -1.7618285302889447e-19i, 0.2673568132535266 + -1.826414792517085e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, false, true, false, false, false, false}), ElementsAreArray({ DoubleNear(0.22645712020935746, 1.0e-7), DoubleNear(0.31234866162009206, 1.0e-7), DoubleNear(0.19383740491702506, 1.0e-7), DoubleNear(0.2673568132535266, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, false, false, true, false, false, false}), Matrix({ { 0.2491062668626593 + 8.598707903611233e-20i, -2.0328790734103208e-19 + 5.421010862427522e-19i, -1.111307226797642e-18 + -5.963111948670274e-19i, 0.00047169371286077835 + 0.0005348299153794398i }, { -1.7618285302889447e-19 + -6.505213034913027e-19i, 0.3351371857252523 + 1.9150885541827697e-20i, 9.630889365804725e-05 + 0.000749879843719028i, 1.8973538018496328e-18 + 2.439454888092385e-19i }, { -1.0842021724855044e-18 + 5.692061405548898e-19i, 9.630889365804725e-05 + -0.0007498798437190278i, 0.1711882582637232 + 6.405066278151232e-20i, -1.2874900798265365e-19 + -3.3203691532368573e-19i }, { 0.00047169371286077846 + -0.0005348299153794398i, 1.7889335846010823e-18 + -2.168404344971009e-19i, -1.2874900798265365e-19 + 3.1848438816761693e-19i, 0.2445682891483663 + -9.575442770913848e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, false, false, true, false, false, false}), ElementsAreArray({ DoubleNear(0.2491062668626593, 1.0e-7), DoubleNear(0.3351371857252523, 1.0e-7), DoubleNear(0.1711882582637232, 1.0e-7), DoubleNear(0.2445682891483663, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, false, false, false, true, false, false}), Matrix({ { 0.19524190881806197 + 7.36711868958103e-20i, 0.000556105635332166 + -0.00015320210562230231i, -0.03254891954383715 + -0.04773472345063011i, 0.0016567081225877791 + 0.001958966129126826i }, { 0.000556105635332166 + 0.0001532021056223022i, 0.26706934117017417 + -6.150253290454271e-20i, 0.0014664081738487939 + 0.0022539598523648374i, -0.05825962148344138 + -0.064409617524433i }, { -0.03254891954383715 + 0.04773472345063011i, 0.0014664081738487939 + -0.0022539598523648374i, 0.22505261630832052 + 7.636655492181434e-20i, -0.0005561056353321663 + 0.00015320210562230253i }, { 0.0016567081225877791 + -0.001958966129126826i, -0.05825962148344138 + 0.064409617524433i, -0.0005561056353321663 + -0.00015320210562230256i, 0.3126361337034445 + -1.5101009262768073e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, false, false, false, true, false, false}), ElementsAreArray({ DoubleNear(0.19524190881806197, 1.0e-7), DoubleNear(0.26706934117017417, 1.0e-7), DoubleNear(0.22505261630832052, 1.0e-7), DoubleNear(0.3126361337034445, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, false, false, false, false, true, false}), Matrix({ { 0.19722331662555326 + 1.6022488465152146e-21i, -1.8973538018496328e-19 + 1.2197274440461925e-19i, 0.009062016726906852 + 0.015196479148091888i, -1.3552527156068805e-20 + -3.3881317890172014e-21i }, { -1.6263032587282567e-19 + -2.236166980751353e-19i, 0.27202694678496453 + -9.320009397757473e-20i, -1.6940658945086007e-21 + -1.8634724839594607e-20i, 0.012499093839979346 + 0.020960259138047638i }, { 0.009062016726906852 + -0.015196479148091888i, 5.082197683525802e-21 + 1.1858461261560205e-20i, 0.22307120850082923 + 1.4843549297110943e-19i, -1.6263032587282567e-19 + 8.809142651444724e-20i }, { -2.371692252312041e-20 + 5.082197683525802e-21i, 0.012499093839979346 + -0.020960259138047638i, -1.0842021724855044e-19 + -1.0842021724855044e-19i, 0.30767852808865415 + 1.6596551810263947e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, false, false, false, false, true, false}), ElementsAreArray({ DoubleNear(0.19722331662555326, 1.0e-7), DoubleNear(0.27202694678496453, 1.0e-7), DoubleNear(0.22307120850082923, 1.0e-7), DoubleNear(0.30767852808865415, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, false, false, false, false, false, true}), Matrix({ { 0.218550274293154 + 8.748965261881491e-20i, -1.6263032587282567e-19 + 1.0842021724855044e-19i, -0.015990580036571316 + -0.015114484374194576i, 2.202285662861181e-20 + -5.929230630780102e-21i }, { -1.6263032587282567e-19 + -1.6940658945086007e-19i, 0.3009489511522251 + -3.6938577434168004e-20i, 4.235164736271502e-21 + 3.049318610115481e-20i, -0.022107860822565138 + -0.020331032497457838i }, { -0.015990580036571316 + 0.015114484374194576i, 7.623296525288703e-21 + -2.879912020664621e-20i, 0.2017442508332285 + 6.254808919880974e-20i, -1.8973538018496328e-19 + 1.0164395367051604e-19i }, { 2.541098841762901e-20 + 9.317362419797304e-21i, -0.022107860822565138 + 0.020331032497457838i, -1.0842021724855044e-19 + -1.6263032587282567e-19i, 0.2787565237213936 + -3.9664964733142783e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, false, false, false, false, false, true}), ElementsAreArray({ DoubleNear(0.218550274293154, 1.0e-7), DoubleNear(0.3009489511522251, 1.0e-7), DoubleNear(0.2017442508332285, 1.0e-7), DoubleNear(0.2787565237213936, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, true, false, false, false, false, false}), Matrix({ { 0.1457707778960575 + 1.6417674002799355e-20i, -0.0043641765181670865 + -0.02759188792373522i, 2.2768245622195593e-18 + -1.8431436932253575e-18i, -2.981555974335137e-19 + -1.3213713977167085e-19i }, { -0.004364176518167088 + 0.027591887923735216i, 0.2085803657808174 + -2.8738115636470426e-20i, 1.8973538018496328e-19 + 4.87890977618477e-19i, 2.2768245622195593e-18 + -2.168404344971009e-18i }, { 1.734723475976807e-18 + 1.6263032587282567e-18i, 1.8973538018496328e-19 + -5.692061405548898e-19i, 0.26524993870980923 + 1.694975793182409e-20i, -0.0025821243465297787 + -0.054611686683446195i }, { -2.710505431213761e-19 + 1.3552527156068805e-19i, 2.2768245622195593e-18 + 2.2768245622195593e-18i, -0.0025821243465297787 + 0.054611686683446195i, 0.380398917613317 + 6.880488335216084e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, true, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.1457707778960575, 1.0e-7), DoubleNear(0.2085803657808174, 1.0e-7), DoubleNear(0.26524993870980923, 1.0e-7), DoubleNear(0.380398917613317, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, false, true, false, false, false, false}), Matrix({ { 0.22146033855892439 + 6.03159423158354e-20i, -0.0037427070682255724 + -0.044291761285397815i, 0.0019703638947460565 + 0.016079951160189537i, 0.003182668589683345 + -0.0006658232128376755i }, { -0.0037427070682255724 + 0.04429176128539781i, 0.31734544327052516 + 1.2272258362989857e-20i, -0.003249267375938523 + 0.0001223168924231017i, 0.0028234672070459894 + 0.0230420456407864i }, { 0.001970363894746057 + -0.016079951160189537i, -0.0032492673759385235 + -0.00012231689242310191i, 0.18956037804694237 + -2.694851038121195e-20i, -0.003203593796471294 + -0.0379118133217836i }, { 0.003182668589683345 + 0.0006658232128376759i, 0.002823467207045991 + -0.0230420456407864i, -0.0032035937964712945 + 0.0379118133217836i, 0.2716338401236093 + 2.779450935270056e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, false, true, false, false, false, false}), ElementsAreArray({ DoubleNear(0.22146033855892439, 1.0e-7), DoubleNear(0.31734544327052516, 1.0e-7), DoubleNear(0.18956037804694237, 1.0e-7), DoubleNear(0.2716338401236093, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, false, false, true, false, false, false}), Matrix({ { 0.2401361625549689 + 5.328366633821583e-20i, -0.004058330799904889 + -0.048026900243567594i, 3.7947076036992655e-19 + -2.0328790734103208e-19i, -1.3552527156068805e-20 + -6.268043809681823e-20i }, { -0.004058330799904889 + 0.048026900243567594i, 0.3441072900329427 + 5.18542982397242e-20i, 2.371692252312041e-20 + 7.792703114739563e-20i, 4.0657581468206416e-19 + -1.8973538018496328e-19i }, { 1.4907779871675686e-19 + 2.168404344971009e-19i, 2.541098841762901e-20 + -7.115076756936123e-20i, 0.17088455405089786 + -1.9916234403592386e-20i, -0.0028879700647919783 + -0.034176674363613824i }, { -3.7269449679189215e-20 + 4.319868030996932e-20i, 6.098637220230962e-19 + 2.981555974335137e-19i, -0.0028879700647919783 + 0.03417667436361382i, 0.24487199336119167 + -1.1787530524033783e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, false, false, true, false, false, false}), ElementsAreArray({ DoubleNear(0.2401361625549689, 1.0e-7), DoubleNear(0.3441072900329427, 1.0e-7), DoubleNear(0.17088455405089786, 1.0e-7), DoubleNear(0.24487199336119167, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, false, false, false, true, false, false}), Matrix({ { 0.19001962334523959 + -5.146304180998662e-21i, -0.0032132095999513515 + -0.03800213759368169i, -0.03732345817523453 + -0.04609372586906551i, -0.008598072008835857 + 0.008253978588904823i }, { -0.0032132095999513515 + 0.038002137593681685i, 0.27229162664299655 + 1.7314958172266252e-20i, 0.009837331204875038 + -0.0066936149692014i, -0.053485082852043994 + -0.06605061510599758i }, { -0.03732345817523453 + 0.04609372586906551i, 0.009837331204875038 + 0.0066936149692014i, 0.22100109326062717 + 3.8513736115622107e-20i, -0.003733091264745515 + -0.044201437013499725i }, { -0.008598072008835857 + -0.008253978588904823i, -0.053485082852043994 + 0.06605061510599758i, -0.0037330912647455155 + 0.044201437013499725i, 0.31668765675113786 + 2.2751809543424164e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, false, false, false, true, false, false}), ElementsAreArray({ DoubleNear(0.19001962334523959, 1.0e-7), DoubleNear(0.27229162664299655, 1.0e-7), DoubleNear(0.22100109326062717, 1.0e-7), DoubleNear(0.31668765675113786, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, false, false, false, false, true, false}), Matrix({ { 0.20217864286937984 + 1.4782751522088296e-20i, 0.000484704418555766 + -0.05339537484851748i, -0.03017382782785117 + -0.012579828682276214i, -0.07550222905322215 + -0.00737221154400974i }, { 0.000484704418555766 + 0.05339537484851748i, 0.267071620541138 + -1.0638059665314782e-19i, -0.022986716279808674 + -0.0254526552971001i, 0.05173493839473736 + 0.048736566968415745i }, { -0.03017382782785117 + 0.012579828682276214i, -0.022986716279808677 + 0.0254526552971001i, 0.20884207373648692 + 1.858468041253515e-20i, -0.007431005283252632 + -0.028808199758663926i }, { -0.07550222905322214 + 0.00737221154400974i, 0.05173493839473736 + -0.04873656696841573i, -0.007431005283252632 + 0.02880819975866393i, 0.3219076628529965 + 1.4644736436883823e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, false, false, false, false, true, false}), ElementsAreArray({ DoubleNear(0.20217864286937984, 1.0e-7), DoubleNear(0.267071620541138, 1.0e-7), DoubleNear(0.20884207373648692, 1.0e-7), DoubleNear(0.3219076628529965, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, false, false, false, false, false, true}), Matrix({ { 0.2135249439187522 + -1.4900211169070826e-20i, -0.003608597918920585 + -0.04270469333727213i, -0.01565924846348848 + -0.014568841745051898i, -0.0026491049579655613 + 0.0033780432500764945i }, { -0.0036085979189205853 + 0.04270469333727213i, 0.3059742815266269 + 6.545128635371773e-20i, 0.0031783914233324047 + -0.002885612801086122i, -0.022439192395647973 + -0.020876675126600516i }, { -0.01565924846348848 + 0.014568841745051898i, 0.0031783914233324047 + 0.0028856128010861224i, 0.19749577268711455 + 4.826764310369427e-20i, -0.0033377029457762816 + -0.03949888126990928i }, { -0.0026491049579655613 + -0.003378043250076495i, -0.022439192395647973 + 0.020876675126600512i, -0.0033377029457762816 + 0.03949888126990928i, 0.28300500186750754 + -2.5384518638027313e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, false, false, false, false, false, true}), ElementsAreArray({ DoubleNear(0.2135249439187522, 1.0e-7), DoubleNear(0.3059742815266269, 1.0e-7), DoubleNear(0.19749577268711455, 1.0e-7), DoubleNear(0.28300500186750754, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, true, true, false, false, false, false}), Matrix({ { 0.19092644501097794 + -5.772686699854442e-21i, 2.3852447794681098e-18 + -2.168404344971009e-18i, 0.0016986995335137828 + 0.013862924309348847i, 1.5585406229479126e-19 + 1.0842021724855044e-19i }, { 1.951563910473908e-18 + 2.4936649967166602e-18i, 0.3478793368184716 + 7.83608873786797e-20i, -8.809142651444724e-20 + 1.4907779871675686e-19i, 0.003095131568278263 + 0.025259072491627087i }, { 0.0016986995335137836 + -0.013862924309348847i, -8.131516293641283e-20 + -1.3552527156068805e-19i, 0.16342469866589696 + -6.547754933816629e-21i, 2.2768245622195593e-18 + -1.951563910473908e-18i }, { 1.4907779871675686e-19 + -1.2874900798265365e-19i, 0.003095131568278265 + -0.025259072491627087i, 2.0599841277224584e-18 + 1.0842021724855044e-18i, 0.2977695195046547 + 7.393753905305238e-21i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, true, true, false, false, false, false}), ElementsAreArray({ DoubleNear(0.19092644501097794, 1.0e-7), DoubleNear(0.3478793368184716, 1.0e-7), DoubleNear(0.16342469866589696, 1.0e-7), DoubleNear(0.2977695195046547, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, true, false, true, false, false, false}), Matrix({ { 0.20702733561025227 + -6.299807545203859e-21i, 3.2526065174565133e-19 + -5.854691731421724e-18i, -4.0657581468206416e-19 + -1.1384122811097797e-18i, -0.0014091888729076576 + -0.004987365731111332i }, { -3.2526065174565133e-19 + 5.421010862427522e-18i, 0.37721611697765933 + 1.114377721231439e-19i, 0.0042205851490960886 + -0.0030077053071436346i, 1.1384122811097797e-18 + 8.063753657860939e-19i }, { -3.049318610115481e-19 + 1.3010426069826053e-18i, 0.004220585149096088 + 0.0030077053071436346i, 0.14732380806662262 + -6.020634088467212e-21i, 4.553649124439119e-18 + 1.6534083130403943e-18i }, { -0.0014091888729076576 + 0.004987365731111333i, 1.0299920638612292e-18 + -7.928228386300251e-19i, 4.336808689942018e-18 + -1.328147661294743e-18i, 0.26843273934546696 + -2.5683130839158956e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, true, false, true, false, false, false}), ElementsAreArray({ DoubleNear(0.20702733561025227, 1.0e-7), DoubleNear(0.37721611697765933, 1.0e-7), DoubleNear(0.14732380806662262, 1.0e-7), DoubleNear(0.26843273934546696, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, true, false, false, true, false, false}), Matrix({ { 0.16404375359615797 + -7.55836284720329e-21i, -0.007059995695466698 + 0.005442473795893788i, -0.03083697081025063 + -0.03988197925604666i, -0.0399004306730463 + -0.013128280313943766i }, { -0.007059995695466699 + -0.005442473795893788i, 0.29826749639207817 + 1.972701683847088e-20i, -0.0009268075183080009 + -0.042378183810056855i, -0.059971570217027904 + -0.07226236171901643i }, { -0.03083697081025063 + 0.03988197925604667i, -0.0009268075183080004 + 0.042378183810056855i, 0.19030739008071693 + -4.76207878646778e-21i, 0.007059995695466703 + -0.005442473795893792i }, { -0.0399004306730463 + 0.013128280313943764i, -0.059971570217027904 + 0.07226236171901643i, 0.007059995695466703 + 0.005442473795893792i, 0.34738135993104813 + 6.602762444551405e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, true, false, false, true, false, false}), ElementsAreArray({ DoubleNear(0.16404375359615797, 1.0e-7), DoubleNear(0.29826749639207817, 1.0e-7), DoubleNear(0.19030739008071693, 1.0e-7), DoubleNear(0.34738135993104813, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, true, false, false, false, true, false}), Matrix({ { 0.1648728416253214 + -6.299228518775072e-20i, 2.6020852139652106e-18 + -1.951563910473908e-18i, 0.009114534822847086 + 0.01386455361488513i, 3.2526065174565133e-19 + 1.6263032587282567e-19i }, { 1.734723475976807e-18 + 2.168404344971009e-18i, 0.30437742178519644 + -2.8605559943308803e-20i, -4.0657581468206416e-20 + 2.439454888092385e-19i, 0.01244657574403911 + 0.022292184671254395i }, { 0.009114534822847086 + -0.01386455361488513i, -5.421010862427522e-20 + -1.8973538018496328e-19i, 0.18947830205155353 + 5.0671843554079646e-20i, 2.3852447794681098e-18 + -2.168404344971009e-18i }, { 2.439454888092385e-19 + -6.776263578034403e-20i, 0.012446575744039111 + -0.022292184671254395i, 2.168404344971009e-18 + 2.168404344971009e-18i, 0.34127143453792985 + 1.1436020122729374e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, true, false, false, false, true, false}), ElementsAreArray({ DoubleNear(0.1648728416253214, 1.0e-7), DoubleNear(0.30437742178519644, 1.0e-7), DoubleNear(0.18947830205155353, 1.0e-7), DoubleNear(0.34127143453792985, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, true, false, false, false, false, true}), Matrix({ { 0.18408514467582054 + 1.774716004232521e-21i, 2.8189256484623115e-18 + -2.3852447794681098e-18i, -0.013500226090740766 + -0.012560159441687983i, -2.981555974335137e-19 + -2.710505431213761e-20i }, { 1.951563910473908e-18 + 2.168404344971009e-18i, 0.3354140807695586 + 4.877635918041438e-20i, -7.453889935837843e-20 + -2.710505431213761e-19i, -0.024598214768395684 + -0.02288535742996443i }, { -0.013500226090740766 + 0.012560159441687983i, -6.776263578034403e-21 + 2.439454888092385e-19i, 0.17026599900105438 + -1.4095157637903592e-20i, 2.168404344971009e-18 + -1.734723475976807e-18i }, { -2.710505431213761e-19 + 5.421010862427522e-20i, -0.024598214768395684 + 0.022885357429964427i, 1.951563910473908e-18 + 2.168404344971009e-18i, 0.3102347755535677 + 3.697828210357055e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, true, false, false, false, false, true}), ElementsAreArray({ DoubleNear(0.18408514467582054, 1.0e-7), DoubleNear(0.3354140807695586, 1.0e-7), DoubleNear(0.17026599900105438, 1.0e-7), DoubleNear(0.3102347755535677, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, true, true, false, false, false}), Matrix({ { 0.31479375025036627 + 2.302870825347629e-21i, 0.0028007644340342936 + 0.022856770483135388i, 3.7947076036992655e-19 + -8.131516293641283e-20i, 3.3881317890172014e-21 + 1.6093625997831706e-20i }, { 0.0028007644340342953 + -0.022856770483135388i, 0.2694497023375454 + 1.028350937525924e-19i, -5.082197683525802e-21 + -2.202285662861181e-20i, 3.5236570605778894e-19 + -2.439454888092385e-19i }, { 2.981555974335137e-19 + 2.439454888092385e-19i, -2.371692252312041e-20 + 2.879912020664621e-20i, 0.22401203157908323 + 7.028532985347762e-20i, 0.001993066667757752 + 0.016265226317840546i }, { 2.879912020664621e-20 + -2.1175823681357508e-20i, 4.2012834183813297e-19 + 2.168404344971009e-19i, 0.0019930666677577527 + -0.016265226317840546i, 0.19174451583300628 + -1.0198909478110379e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, true, true, false, false, false}), ElementsAreArray({ DoubleNear(0.31479375025036627, 1.0e-7), DoubleNear(0.2694497023375454, 1.0e-7), DoubleNear(0.22401203157908323, 1.0e-7), DoubleNear(0.19174451583300628, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, true, false, true, false, false}), Matrix({ { 0.24909597449846135 + 2.203464395234069e-20i, 0.0022162420489019617 + 0.01808653924309494i, -0.04892816694499439 + -0.06042401931681717i, 0.003951989740589041 + -0.004090212481226707i }, { 0.0022162420489019626 + -0.01808653924309494i, 0.21321527548977479 + -9.8659899610731e-21i, -0.0048226313571588944 + 0.0030150104219142495i, -0.041880374082284136 + -0.05172032165824593i }, { -0.04892816694499439 + 0.06042401931681717i, -0.0048226313571588944 + -0.00301501042191425i, 0.28970980733098817 + 5.055355672648456e-20i, 0.002577589052890084 + 0.021035457557881i }, { 0.003951989740589041 + 0.004090212481226708i, -0.041880374082284136 + 0.05172032165824593i, 0.0025775890528900855 + -0.021035457557881i, 0.2479789426807769 + 1.0711988932561708e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, true, false, true, false, false}), ElementsAreArray({ DoubleNear(0.24909597449846135, 1.0e-7), DoubleNear(0.21321527548977479, 1.0e-7), DoubleNear(0.28970980733098817, 1.0e-7), DoubleNear(0.2479789426807769, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, true, false, false, true, false}), Matrix({ { 0.2528347550505789 + -4.9169890356836486e-20i, 0.002249506507261448 + 0.018358007304003374i, 0.011617251036102307 + 0.019481459640666176i, -0.0013111634771393568 + 0.00101684299515866i }, { 0.002249506507261448 + -0.018358007304003374i, 0.21641550835993895 + -4.2427954774223034e-20i, 0.001517884121988789 + -0.0006701844020877588i, 0.009943859530783888 + 0.01667527864547335i }, { 0.011617251036102309 + -0.019481459640666176i, 0.0015178841219887892 + 0.0006701844020877588i, 0.2859710267788706 + 1.2175809103566174e-19i, 0.0025443245945305976 + 0.020763989496972564i }, { -0.0013111634771393568 + -0.0010168429951586601i, 0.009943859530783888 + -0.01667527864547335i, 0.0025443245945306 + -0.020763989496972564i, 0.24477870981061278 + 4.327395374571164e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, true, false, false, true, false}), ElementsAreArray({ DoubleNear(0.2528347550505789, 1.0e-7), DoubleNear(0.21641550835993895, 1.0e-7), DoubleNear(0.2859710267788706, 1.0e-7), DoubleNear(0.24477870981061278, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, true, false, false, false, true}), Matrix({ { 0.27990918632589057 + 3.582167681206828e-20i, 0.0024903915442969333 + 0.02032384703598357i, -0.020527660213590038 + -0.019098249430379598i, 0.0012040619069414095 + -0.0016604069026117272i }, { 0.002490391544296934 + -0.02032384703598357i, 0.2395900391194885 + 1.4729398372578626e-20i, -0.0015693368883820356 + 0.0013205672602148834i, -0.017570780645546416 + -0.016347267441272812i }, { -0.020527660213590038 + 0.019098249430379598i, -0.0015693368883820354 + -0.0013205672602148836i, 0.2588965955035589 + 3.6766523866756974e-20i, 0.0023034395574951126 + 0.018798149764992365i }, { 0.0012040619069414095 + 0.0016604069026117272i, -0.017570780645546416 + 0.016347267441272812i, 0.002303439557495114 + -0.018798149764992365i, 0.22160417905106322 + -1.3883399401090016e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, true, false, false, false, true}), ElementsAreArray({ DoubleNear(0.27990918632589057, 1.0e-7), DoubleNear(0.2395900391194885, 1.0e-7), DoubleNear(0.2588965955035589, 1.0e-7), DoubleNear(0.22160417905106322, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, false, true, true, false, false}), Matrix({ { 0.26921892159932737 + 3.7375328797596e-20i, -0.0008852285359469162 + 0.0013318106545908647i, -0.05836157280323053 + -0.06495171100277214i, -0.008639187658081929 + 0.0024097478321202103i }, { -0.0008852285359469165 + -0.0013318106545908647i, 0.19309232838890883 + -2.5206674806328412e-20i, 0.004865772034323374 + -0.007059924994116673i, -0.032446968224048 + -0.04719262997229095i }, { -0.05836157280323053 + 0.06495171100277214i, 0.004865772034323375 + 0.007059924994116674i, 0.3150245309885843 + 6.776263578034403e-20i, 0.0008852285359469171 + -0.0013318106545908651i }, { -0.008639187658081929 + -0.0024097478321202107i, -0.032446968224048 + 0.04719262997229095i, 0.0008852285359469171 + 0.0013318106545908656i, 0.2226642190231807 + -6.497090121297756e-21i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, false, true, true, false, false}), ElementsAreArray({ DoubleNear(0.26921892159932737, 1.0e-7), DoubleNear(0.19309232838890883, 1.0e-7), DoubleNear(0.3150245309885843, 1.0e-7), DoubleNear(0.2226642190231807, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, false, true, false, true, false}), Matrix({ { 0.2741563940227476 + -4.955142741437657e-20i, 4.0657581468206416e-19 + -1.6263032587282567e-19i, 0.012596937679227281 + 0.021124337610611662i, 3.7269449679189215e-20 + 1.4399560103323106e-20i }, { 3.2526065174565133e-19 + 2.168404344971009e-19i, 0.19509386938777024 + -4.204641771668295e-20i, -6.776263578034403e-21 + 4.0657581468206416e-20i, 0.008964172887658915 + 0.015032400675527862i }, { 0.012596937679227281 + -0.021124337610611662i, 0.0 + -4.743384504624082e-20i, 0.31008705856516405 + 1.546893919923166e-19i, 3.5236570605778894e-19 + -1.6263032587282567e-19i }, { 2.710505431213761e-20 + -3.6422416731934915e-20i, 0.008964172887658918 + -0.015032400675527862i, 3.5236570605778894e-19 + 3.2526065174565133e-19i, 0.22066267802431933 + 1.0342652789056782e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, false, true, false, true, false}), ElementsAreArray({ DoubleNear(0.2741563940227476, 1.0e-7), DoubleNear(0.19509386938777024, 1.0e-7), DoubleNear(0.31008705856516405, 1.0e-7), DoubleNear(0.22066267802431933, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, false, true, false, false, true}), Matrix({ { 0.3041015381390835 + 7.623296525288703e-20i, 4.607859233063394e-19 + -1.0842021724855044e-19i, -0.02191459220375589 + -0.022540822407863034i, -4.743384504624082e-20 + -1.3552527156068805e-20i }, { 3.5236570605778894e-19 + 2.710505431213761e-19i, 0.21539768730629555 + -2.5681890068240127e-20i, -8.470329472543003e-22 + -4.743384504624082e-20i, -0.016183848655380563 + -0.012904694463789378i }, { -0.02191459220375589 + 0.02254082240786303i, 1.1011428314305904e-20 + 2.710505431213761e-20i, 0.2801419144488281 + 2.8904999325053e-20i, 2.981555974335137e-19 + -2.168404344971009e-19i }, { -4.0657581468206416e-20 + 0.0i, -0.016183848655380563 + 0.012904694463789378i, 3.2526065174565133e-19 + 2.710505431213761e-19i, 0.200358860105794 + -6.0218748593860415e-21i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, false, true, false, false, true}), ElementsAreArray({ DoubleNear(0.3041015381390835, 1.0e-7), DoubleNear(0.21539768730629555, 1.0e-7), DoubleNear(0.2801419144488281, 1.0e-7), DoubleNear(0.200358860105794, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, false, false, true, true, false}), Matrix({ { 0.21693830344719128 + -6.610641339885973e-20i, -0.04262017681248435 + -0.0526228793145642i, 0.009969382523774422 + 0.016716693701997506i, 0.0021061431673239607 + -0.00569605296943864i }, { -0.04262017681248435 + 0.05262287931456419i, 0.25231195996332656 + -2.5491431732199792e-20i, -0.006004724184216386 + -0.000858290383468994i, 0.011591728043111775 + 0.019440044584142016i }, { 0.009969382523774422 + -0.016716693701997506i, -0.006004724184216386 + 0.0008582903834689938i, 0.24537294654104486 + 7.827506739012732e-20i, -0.04818836421479418 + -0.0595214616604989i }, { 0.0021061431673239607 + 0.00569605296943864i, 0.011591728043111775 + -0.019440044584142016i, -0.04818836421479418 + 0.0595214616604989i, 0.2853767900484385 + 8.675697739124606e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, false, false, true, true, false}), ElementsAreArray({ DoubleNear(0.21693830344719128, 1.0e-7), DoubleNear(0.25231195996332656, 1.0e-7), DoubleNear(0.24537294654104486, 1.0e-7), DoubleNear(0.2853767900484385, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, false, false, true, false, true}), Matrix({ { 0.2401799152807893 + 2.433151771824731e-20i, -0.04711741812376339 + -0.058265056054263256i, -0.01762045853567922 + -0.016377192235823776i, -0.0005519144661416279 + 0.007553946886302869i }, { -0.04711741812376339 + 0.058265056054263256i, 0.2793193101645898 + 2.6219557466399595e-20i, 0.007385682551055871 + -0.0010002571903518337i, -0.020477982323457232 + -0.019068324635828637i }, { -0.01762045853567922 + 0.016377192235823776i, 0.007385682551055871 + 0.0010002571903518333i, 0.22213133470744684 + -1.2162863726979719e-20i, -0.04369112290351515 + -0.053879284920799846i }, { -0.000551914466141628 + -0.00755394688630287i, -0.020477982323457232 + 0.019068324635828637i, -0.043691122903515144 + 0.05387928492079984i, 0.25836943984717525 + 3.5045988192646677e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, false, false, true, false, true}), ElementsAreArray({ DoubleNear(0.2401799152807893, 1.0e-7), DoubleNear(0.2793193101645898, 1.0e-7), DoubleNear(0.22213133470744684, 1.0e-7), DoubleNear(0.25836943984717525, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, false, false, false, true, true}), Matrix({ { 0.24377514838180386 + -6.662360807685851e-20i, 0.011200980239239544 + 0.018783397534280745i, -0.017877703408679793 + -0.016632818128744828i, 0.0004601495811554628 + -0.002141760063623887i }, { 0.011200980239239546 + -0.018783397534280745i, 0.27572407706357527 + 1.171746832615054e-19i, -0.0021030389727350923 + 0.0006132706468836328i, -0.02022073745045666 + -0.018812698742907585i }, { -0.017877703408679793 + 0.016632818128744828i, -0.0021030389727350923 + -0.0006132706468836329i, 0.22547511502871398 + -2.4974237054201012e-20i, 0.010360130327646653 + 0.017373340751858778i }, { 0.000460149581155463 + 0.002141760063623887i, -0.02022073745045666 + 0.018812698742907585i, 0.010360130327646652 + -0.017373340751858778i, 0.2550256595259081 + 4.785736151986797e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, false, false, false, true, true}), ElementsAreArray({ DoubleNear(0.24377514838180386, 1.0e-7), DoubleNear(0.27572407706357527, 1.0e-7), DoubleNear(0.22547511502871398, 1.0e-7), DoubleNear(0.2550256595259081, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, true, true, false, false, false, false, false, false, false}), Matrix({ { 0.09725605753525977 + 2.0924360775141388e-20i, -0.0024842974864924643 + 0.0030359996125098277i, 0.012094825991338971 + 0.006722685499166187i, -0.0005188079556077838 + 0.00020583536740385877i, -1.2874900798265365e-19 + 1.0164395367051604e-20i, 2.2234614865425384e-21 + -1.164670302474663e-21i, -7.047314121155779e-19 + 3.9302328752599536e-19i, 1.1858461261560205e-20 + -2.625802136488331e-20i }, { -0.0024842974864924643 + -0.0030359996125098277i, 0.10288554768037231 + -1.8587575544679085e-20i, -9.90897172225933e-05 + -0.0005492823692937505i, 0.012794913013686227 + 0.0071118159320189295i, -1.0587911840678754e-21 + 6.03510974918689e-21i, -1.1519648082658485e-19 + 3.3881317890172014e-21i, 8.470329472543003e-21 + 2.0752307207730358e-20i, -6.505213034913027e-19 + 3.2526065174565133e-19i }, { 0.012094825991338971 + -0.006722685499166186i, -9.908971722259325e-05 + 0.0005492823692937505i, 0.10698028039860578 + 3.8539999100070665e-20i, -0.002732691910754879 + 0.003339556404685723i, -6.505213034913027e-19 + 4.607859233063394e-19i, 1.0164395367051604e-20 + -3.134021904840911e-20i, -7.115076756936123e-20 + 8.809142651444724e-20i, -6.88214269644119e-22 + -4.341043854678289e-21i }, { -0.0005188079556077838 + -0.00020583536740385877i, 0.012794913013686227 + -0.0071118159320189295i, -0.002732691910754879 + -0.0033395564046857233i, 0.11317263951214465 + 1.0916095748709168e-19i, 2.202285662861181e-20 + 2.752857078576476e-20i, -7.589415207398531e-19 + 5.827586677109586e-19i, 6.776263578034403e-21 + 4.129285617864714e-21i, -4.743384504624082e-20 + 1.1858461261560205e-19i }, { -9.486769009248164e-20 + 0.0i, -3.3881317890172014e-21 + -2.6469779601696886e-21i, -7.047314121155779e-19 + -3.9302328752599536e-19i, 1.3552527156068805e-20 + -5.082197683525802e-20i, 0.14735998769151898 + -7.899905722126436e-20i, -0.00381902744579358 + 0.004390986627260764i, 0.016660018113375613 + -0.009260163169510564i, -0.00015583479707461834 + 0.0007364192664688162i }, { 2.80579663777987e-21 + 1.7999450129153882e-21i, -1.5585406229479126e-19 + -2.710505431213761e-20i, 1.9905274260476058e-20 + 2.202285662861181e-20i, -8.131516293641283e-19 + -5.149960319306146e-19i, -0.00381902744579358 + -0.004390986627260765i, 0.15629339190770097 + -5.761147530309327e-20i, -0.0007076976640652584 + -0.0002564407071475455i, 0.017669998355551386 + -0.009821542021375114i }, { -7.318364664277155e-19 + -4.336808689942018e-19i, 1.6940658945086007e-20 + -3.091670257478196e-20i, -4.404571325722362e-20 + -1.2197274440461925e-19i, 4.235164736271502e-21 + -2.752857078576476e-21i, 0.016660018113375613 + 0.009260163169510564i, -0.0007076976640652585 + 0.0002564407071475455i, 0.13396535686691208 + 4.129285617864714e-21i, -0.0034718880116309473 + 0.003991857625220757i }, { 7.199780051661553e-21 + 2.202285662861181e-20i, -7.047314121155779e-19 + -4.336808689942018e-19i, -1.9058241313221758e-21 + 4.446922973085077e-21i, -5.421010862427522e-20 + -1.1519648082658485e-19i, -0.00015583479707461837 + -0.0007364192664688161i, 0.017669998355551386 + 0.009821542021375114i, -0.003471888011630947 + -0.003991857625220757i, 0.14208673840748667 + 5.587770473918213e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, true, true, false, false, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.09725605753525977, 1.0e-7), DoubleNear(0.10288554768037231, 1.0e-7), DoubleNear(0.10698028039860578, 1.0e-7), DoubleNear(0.11317263951214465, 1.0e-7), DoubleNear(0.14735998769151898, 1.0e-7), DoubleNear(0.15629339190770097, 1.0e-7), DoubleNear(0.13396535686691208, 1.0e-7), DoubleNear(0.14208673840748667, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, true, false, true, false, false, false, false, false, false}), Matrix({ { 0.10054226220240359 + 2.448454613156962e-20i, -0.002590797130667834 + 0.003052645206492417i, 0.011818836629809759 + -0.0010429558904363305i, -0.00027729214766047516 + 0.00038728617483954495i, -0.0016991766464774989 + -0.02010831332391315i, 0.0006543096088950948 + 0.00046656576040507187i, -0.0004083295334570131 + -0.002346124889344111i, 8.214297063083397e-05 + 4.8912861675287636e-05i }, { -0.002590797130667834 + -0.003052645206492417i, 0.10652791347863841 + -6.743589943838558e-22i, -0.0003316063276055031 + -0.00033116887626478465i, 0.012521709702318244 + -0.0011137535590527911i, -0.0005667400260398872 + 0.0005697459222838922i, -0.0018003348921718483 + -0.021305435297038322i, -6.0629129142703426e-05 + 7.191760159241874e-05i, -0.00043436761093846525 + -0.002485502041964704i }, { 0.011818836629809759 + 0.00104295589043633i, -0.00033160632760550297 + 0.0003311688762647847i, 0.09903364849193025 + -1.674213559807328e-20i, -0.002550210885937392 + 0.003013363048306463i, 8.84993651940827e-06 + -0.0023813770560154354i, 7.183750491123605e-05 + 6.0724011787237964e-05i, -0.001673680888482402 + -0.019806592669230842i, 0.0006457673190635026 + 0.0004591124409406724i }, { -0.00027729214766047516 + -0.0003872861748395449i, 0.012521709702318244 + 0.0011137535590527905i, -0.002550210885937392 + -0.003013363048306463i, 0.1049168924328945 + 2.6299380395510962e-20i, -7.27704275581955e-05 + 6.200323003135641e-05i, 1.1130730564368289e-05 + -0.002523147187319877i, -0.0005595695613036039 + 0.0005609648561714525i, -0.0017731084375651172 + -0.020983233316999104i }, { -0.0016991766464774989 + 0.02010831332391315i, -0.0005667400260398871 + -0.0005697459222838922i, 8.849936519408433e-06 + 0.0023813770560154354i, -7.27704275581955e-05 + -6.20032300313564e-05i, 0.14407378302437515 + -8.255924257769259e-20i, -0.0037125278016182104 + 0.004374341033278176i, 0.01693600747490483 + -0.001494521779908048i, -0.00039735060502192696 + 0.0005549684590331298i }, { 0.0006543096088950948 + -0.00046656576040507187i, -0.0018003348921718483 + 0.021305435297038322i, 7.183750491123605e-05 + -6.0724011787237985e-05i, 1.1130730564368451e-05 + 0.002523147187319877i, -0.0037125278016182117 + -0.004374341033278176i, 0.15265102610943487 + -7.55246918533885e-20i, -0.0004751810536823487 + -0.0004745542001765114i, 0.017943201666919366 + -0.0015959725303033945i }, { -0.00040832953345701297 + 0.002346124889344111i, -6.0629129142703426e-05 + -7.191760159241874e-05i, -0.0016736808884824023 + 0.019806592669230842i, -0.0005595695613036037 + -0.0005609648561714525i, 0.01693600747490483 + 0.0014945217799080474i, -0.0004751810536823487 + 0.0004745542001765114i, 0.1419119887735876 + 5.941142031600866e-20i, -0.0036543690364484343 + 0.004318050981600018i }, { 8.214297063083398e-05 + -4.8912861675287636e-05i, -0.00043436761093846503 + 0.002485502041964704i, 0.0006457673190635026 + -0.0004591124409406724i, -0.0017731084375651172 + 0.0209832333169991i, -0.00039735060502192696 + -0.0005549684590331298i, 0.017943201666919366 + 0.0015959725303033938i, -0.0036543690364484343 + -0.004318050981600017i, 0.15034248548673682 + 1.3873928183076284e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, true, false, true, false, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.10054226220240359, 1.0e-7), DoubleNear(0.10652791347863841, 1.0e-7), DoubleNear(0.09903364849193025, 1.0e-7), DoubleNear(0.1049168924328945, 1.0e-7), DoubleNear(0.14407378302437515, 1.0e-7), DoubleNear(0.15265102610943487, 1.0e-7), DoubleNear(0.1419119887735876, 1.0e-7), DoubleNear(0.15034248548673682, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, true, false, false, true, false, false, false, false, false}), Matrix({ { 0.0866799753878231 + -6.0218748593860415e-21i, -0.0022335903987225174 + 0.0026317610681351193i, 0.010189311894755845 + -0.0008991581145410617i, -0.00023906043098632392 + 0.000333889007147617i, 1.1384122811097797e-18 + -1.0842021724855044e-18i, -1.1011428314305904e-20 + 6.098637220230962e-20i, 2.710505431213761e-20 + -5.421010862427522e-20i, 2.964615315390051e-21 + 2.117582368135751e-21i }, { -0.0022335903987225174 + -0.0026317610681351193i, 0.09184035365999332 + -3.5984424597588086e-20i, -0.0002858860312634209 + -0.000285508893623823i, 0.010795276185703964 + -0.0009601945388144291i, -3.2610768469290563e-20 + 2.541098841762901e-21i, 9.75781955236954e-19 + -1.0842021724855044e-18i, -4.9763185651190145e-21 + -1.0587911840678754e-22i, 4.743384504624082e-20 + -6.098637220230962e-20i }, { 0.010189311894755845 + 0.0008991581145410614i, -0.00028588603126342084 + 0.00028550889362382307i, 0.08537936212898961 + 2.3915445870133136e-20i, -0.0021985999915319905 + 0.0025978949462660446i, 2.0328790734103208e-19 + -1.4907779871675686e-19i, -1.7999450129153882e-21 + 9.582060215814273e-21i, 1.1384122811097797e-18 + -7.047314121155779e-19i, 5.082197683525802e-21 + 5.590417451878382e-20i }, { -0.00023906043098632397 + -0.000333889007147617i, 0.010795276185703966 + 0.0009601945388144284i, -0.002198599991531991 + -0.0025978949462660446i, 0.09045145250006888 + 5.770411953169921e-21i, -9.317362419797304e-21 + -1.164670302474663e-21i, 2.710505431213761e-19 + -1.6263032587282567e-19i, -4.828087799349512e-20 + -1.9481757786848908e-20i, 1.0299920638612292e-18 + -1.0842021724855044e-18i }, { 9.75781955236954e-19 + 1.0842021724855044e-18i, -3.2610768469290563e-20 + -2.371692252312041e-20i, 2.574980159653073e-19 + 1.8973538018496328e-19i, -7.517417406881916e-21 + -3.1763735522036263e-22i, 0.15793606983895564 + -5.2052821586736926e-20i, -0.004069734533563527 + 0.004795225171635473i, 0.01856553220995874 + -0.0016383195558033166i, -0.00043558232169607826 + 0.0006083656267250578i }, { 1.2705494208814505e-20 + -6.183340514956392e-20i, 9.215718466126788e-19 + 1.1926223897340549e-18i, -5.293955920339377e-21 + -1.5617169965001163e-20i, 2.439454888092385e-19 + 1.8973538018496328e-19i, -0.004069734533563529 + -0.004795225171635473i, 0.16733858592807993 + -4.021462625018427e-20i, -0.0005209013500244308 + -0.0005202141828174729i, 0.01966963518353365 + -0.0017495315505417566i }, { 3.3881317890172014e-20 + 2.0328790734103208e-20i, -2.5940384009662948e-21 + -1.2705494208814505e-21i, 1.0842021724855044e-18 + 8.673617379884035e-19i, -4.658681209898652e-20 + 9.317362419797304e-21i, 0.01856553220995874 + 0.0016383195558033162i, -0.0005209013500244308 + 0.000520214182817473i, 0.15556627513652826 + 1.8753838847802243e-20i, -0.004005979930853836 + 0.004733519083640436i }, { -1.0587911840678754e-21 + -3.3881317890172014e-21i, 0.0 + 2.0328790734103208e-20i, -1.1858461261560205e-20 + -8.216219588366713e-20i, 1.1384122811097797e-18 + 1.0299920638612292e-18i, -0.0004355823216960781 + -0.0006083656267250577i, 0.01966963518353365 + 0.0017495315505417558i, -0.004005979930853835 + -0.004733519083640436i, 0.1648079254195624 + 1.5926825027310388e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, true, false, false, true, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.0866799753878231, 1.0e-7), DoubleNear(0.09184035365999332, 1.0e-7), DoubleNear(0.08537936212898961, 1.0e-7), DoubleNear(0.09045145250006888, 1.0e-7), DoubleNear(0.15793606983895564, 1.0e-7), DoubleNear(0.16733858592807993, 1.0e-7), DoubleNear(0.15556627513652826, 1.0e-7), DoubleNear(0.1648079254195624, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, true, false, false, false, true, false, false, false, false}), Matrix({ { 0.1333345401221562 + -3.049318610115481e-20i, -0.003437537147346183 + 0.004041646324955399i, 0.01145814663914587 + 0.000969005250879188i, -0.0003203895057197327 + 0.00032219538207942626i, -0.0009209873925154531 + 0.010687114096062945i, -0.00029354201770741544 + -0.00029556750762584554i, 0.024030635317552687 + -0.005346564250462848i, -0.0004545982070846147 + 0.0008686427744234403i }, { -0.003437537147346183 + -0.004041646324955399i, 0.14128524244763901 + -5.062407387370471e-20i, -0.0002699264650038779 + -0.00037433369155419067i, 0.012139569268611466 + 0.001034783020839003i, 0.00034575804169959743 + -0.0002577443589483365i, -0.0009932949664644658 + 0.011332684210865838i, -0.0007829423158500664 + -0.0005940659610323619i, 0.02545790622098664 + -0.005661310608170765i }, { 0.01145814663914587 + -0.0009690052508791888i, -0.0002699264650038779 + 0.0003743336915541906i, 0.1282889018395283 + 5.659238878842794e-20i, -0.003301794306923653 + 0.003910265070899907i, 0.02446931953320533 + -0.006111480833867721i, -0.00044648279012431905 + 0.0009006440442450199i, 0.003248688087885496 + 0.008309028493077153i, -0.0003437968537409945 + -0.0001230174278600642i }, { -0.0003203895057197327 + -0.0003221953820794262i, 0.012139569268611466 + -0.0010347830208390038i, -0.0033017943069236534 + -0.003910265070899907i, 0.135897097420126 + 9.711307186525683e-20i, -0.0008146615815786111 + -0.000584910118947935i, 0.025926369087886033 + -0.006478151066101605i, 0.00017165926312764918 + -0.0003023391329885212i, 0.0034594253728864686 + 0.008793170000970001i }, { -0.0009209873925154529 + -0.010687114096062945i, 0.0003457580416995974 + 0.00025774435894833657i, 0.02446931953320533 + 0.006111480833867721i, -0.0008146615815786111 + 0.0005849101189479351i, 0.11128150510462254 + -2.7581510344968155e-20i, -0.0028657877849398617 + 0.0033853399148151947i, 0.017296697465568715 + -0.003506482921223566i, -0.0003542532469626694 + 0.0006200592517932485i }, { -0.00029354201770741544 + 0.0002955675076258455i, -0.0009932949664644658 + -0.011332684210865838i, -0.00044648279012431916 + -0.0009006440442450199i, 0.02592636908788603 + 0.006478151066101605i, -0.002865787784939862 + -0.0033853399148151943i, 0.11789369714043428 + -2.5574976974067648e-20i, -0.0005368609162839738 + -0.0004313893848871054i, 0.018325342100626144 + -0.0037445091101951885i }, { 0.024030635317552687 + 0.005346564250462848i, -0.0007829423158500663 + 0.0005940659610323619i, 0.003248688087885497 + -0.008309028493077153i, 0.0001716592631276491 + 0.0003023391329885212i, 0.017296697465568715 + 0.003506482921223566i, -0.0005368609162839738 + 0.00043138938488710544i, 0.11265673542598957 + -1.3923104070492562e-20i, -0.002902785615462172 + 0.0034211489590065744i }, { -0.0004545982070846147 + -0.0008686427744234403i, 0.02545790622098664 + 0.005661310608170765i, -0.00034379685374099446 + 0.00012301742786006417i, 0.00345942537288647 + -0.00879317000097i, -0.0003542532469626694 + -0.0006200592517932485i, 0.018325342100626144 + 0.003744509110195188i, -0.0029027856154621723 + -0.0034211489590065744i, 0.11936228049950529 + 6.792559036101697e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, true, false, false, false, true, false, false, false, false}), ElementsAreArray({ DoubleNear(0.1333345401221562, 1.0e-7), DoubleNear(0.14128524244763901, 1.0e-7), DoubleNear(0.1282889018395283, 1.0e-7), DoubleNear(0.135897097420126, 1.0e-7), DoubleNear(0.11128150510462254, 1.0e-7), DoubleNear(0.11789369714043428, 1.0e-7), DoubleNear(0.11265673542598957, 1.0e-7), DoubleNear(0.11936228049950529, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, true, false, false, false, false, true, false, false, false}), Matrix({ { 0.14198049307323796 + -2.6959470524328278e-20i, -0.0037215320564467653 + 0.003835692073556428i, 0.016698981642256232 + -0.0013672466322403741i, -0.0004082724841578944 + 0.0004929405378851145i, 1.4907779871675686e-19 + -9.486769009248164e-20i, 8.470329472543003e-21 + 8.470329472543003e-22i, 2.668153783851046e-20 + -5.759824041329242e-20i, 8.893845946170154e-21 + 2.0117032497289633e-21i }, { -0.0037215320564467657 + -0.003835692073556428i, 0.15218931104227865 + -6.691560283308973e-20i, -0.0004662347458199967 + -0.00041068939404119605i, 0.01789977275725744 + -0.0014645648689273422i, -3.218725199566341e-20 + -1.7787691892340307e-20i, 2.574980159653073e-19 + -4.0657581468206416e-20i, -1.0164395367051604e-20 + -2.964615315390051e-21i, 5.082197683525802e-20 + -7.115076756936123e-20i }, { 0.016698981642256232 + 0.0013672466322403737i, -0.00046623474581999663 + 0.00041068939404119605i, 0.1400027996406486 + 2.770062435317579e-20i, -0.0036620447835702787 + 0.0037937714787185644i, 1.2705494208814505e-20 + 3.6422416731934915e-20i, -8.999725064576941e-22 + 3.705769144237564e-22i, 1.2197274440461925e-19 + -9.486769009248164e-20i, 2.371692252312041e-20 + -4.235164736271502e-21i }, { -0.00040827248415789444 + -0.0004929405378851144i, 0.01789977275725744 + 0.0014645648689273418i, -0.0036620447835702787 + -0.003793771478718565i, 0.15007084883174643 + 1.7131241358218224e-19i, 2.752857078576476e-21 + 5.293955920339377e-22i, -4.235164736271502e-21 + 3.7269449679189215e-20i, -3.7269449679189215e-20 + -1.3552527156068805e-20i, 2.1006417091906648e-19 + -1.3552527156068805e-19i }, { 1.0164395367051604e-19 + 1.0842021724855044e-19i, -3.218725199566341e-20 + 2.371692252312041e-20i, 7.623296525288703e-21 + -3.134021904840911e-20i, 3.8116482626443515e-21 + -3.1763735522036263e-22i, 0.10263555215354077 + -3.111522592179469e-20i, -0.00258179287583928 + 0.003591294166214165i, 0.012055862462458357 + -0.0011702310381040044i, -0.00026637026852450774 + 0.0004493140959875604i }, { 1.3976043629695956e-20 + -8.470329472543003e-21i, 2.168404344971009e-19 + 9.486769009248164e-20i, -4.235164736271502e-22 + 2.752857078576476e-21i, 4.235164736271502e-21 + -5.082197683525802e-20i, -0.00258179287583928 + -0.0035912941662141653i, 0.10698962854579463 + -9.28344801468263e-21i, -0.00034055263546785503 + -0.0003950336824001i, 0.012565138611980171 + -0.0012451612204288434i }, { 1.9905274260476058e-20 + 5.082197683525802e-20i, -1.3552527156068805e-20 + 2.964615315390051e-21i, 1.3891340334970526e-19 + 9.486769009248164e-20i, -3.3881317890172014e-20 + 1.1858461261560205e-20i, 0.012055862462458357 + 0.0011702310381040033i, -0.0003405526354678551 + 0.0003950336824001i, 0.10094283762486925 + 1.496866036475959e-20i, -0.0025425351388155466 + 0.003537642551187916i }, { 5.082197683525802e-21 + -2.4881592825595072e-21i, 5.421010862427522e-20 + 6.776263578034403e-20i, 2.329340604949326e-20 + -2.117582368135751e-21i, 1.8295911660692887e-19 + 1.4907779871675686e-19i, -0.00026637026852450774 + -0.0004493140959875604i, 0.012565138611980171 + 0.0012451612204288426i, -0.0025425351388155466 + -0.003537642551187916i, 0.1051885290878849 + -6.2737513559084384e-21i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, true, false, false, false, false, true, false, false, false}), ElementsAreArray({ DoubleNear(0.14198049307323796, 1.0e-7), DoubleNear(0.15218931104227865, 1.0e-7), DoubleNear(0.1400027996406486, 1.0e-7), DoubleNear(0.15007084883174643, 1.0e-7), DoubleNear(0.10263555215354077, 1.0e-7), DoubleNear(0.10698962854579463, 1.0e-7), DoubleNear(0.10094283762486925, 1.0e-7), DoubleNear(0.1051885290878849, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, true, false, false, false, false, false, true, false, false}), Matrix({ { 0.11306892695571494 + -4.2708989387337925e-20i, -0.002912003198883851 + 0.0034358847957722998i, 0.013293792643437021 + -0.001144473758429911i, -0.0003118932393301698 + 0.0004350773418828625i, -0.022332316679222662 + -0.027419562336792845i, 0.0014193575886587268 + 4.4952773395913785e-05i, -0.0028767150329493 + -0.0028223283922136433i, 0.0001665964558562728 + -1.3138133252437064e-05i }, { -0.002912003198883852 + -0.0034358847957722998i, 0.11979664340600961 + -2.6093619218138396e-20i, -0.00037263381352618395 + -0.00037360864252793016i, 0.014084166533723477 + -0.0012198128460050247i, -0.0002493955140280707 + 0.0013661183795300538i, -0.02368403050540238 + -0.02904957567335667i, -1.568892996168059e-05 + 0.00015672473260599045i, -0.0030498188203669225 + -0.002972533280674616i }, { 0.013293792643437021 + 0.0011444737584299105i, -0.00037263381352618395 + 0.00037360864252793016i, 0.11141346978914006 + 1.3036366453835716e-20i, -0.0028675466099417155 + 0.0033919548156770758i, -0.0023443975506753003 + -0.003627192331286248i, 0.00016645763111209426 + 2.3774610500613682e-05i, -0.02175020731837399 + -0.027034569328245175i, 0.0013926608357913814 + 4.485236986286848e-05i }, { -0.0003118932393301698 + -0.0004350773418828624i, 0.014084166533723477 + 0.001219812846005024i, -0.0028675466099417155 + -0.0033919548156770753i, 0.11803220983737153 + 6.79348961429082e-20i, -4.404944178215143e-05 + 0.00016445068785921993i, -0.0024843877851720457 + -0.0038602668964869873i, -0.0002549832297351317 + 0.0013456069382693388i, -0.023041986524279495 + -0.028640633636668404i }, { -0.022332316679222662 + 0.027419562336792845i, -0.00024939551402807067 + -0.0013661183795300542i, -0.0023443975506753003 + 0.003627192331286247i, -4.404944178215143e-05 + -0.00016445068785921993i, 0.1315471182710638 + -1.5365707058785042e-20i, -0.0033913217334021937 + 0.003991101443998293i, 0.015461051461277566 + -0.0013930039119144674i, -0.0003627495133522323 + 0.0005071772919898124i }, { 0.0014193575886587268 + -4.4952773395913785e-05i, -0.02368403050540238 + 0.02904957567335667i, 0.00016645763111209426 + -2.377461050061368e-05i, -0.0024843877851720457 + 0.0038602668964869877i, -0.0033913217334021937 + -0.003991101443998293i, 0.13938229618206366 + -5.010543162963396e-20i, -0.00043415356776166776 + -0.0004321144339133659i, 0.016380744835514133 + -0.0014899132433511609i }, { -0.0028767150329493 + 0.0028223283922136433i, -1.568892996168057e-05 + -0.00015672473260599042i, -0.02175020731837399 + 0.027034569328245175i, -0.00025498322973513176 + -0.0013456069382693388i, 0.015461051461277566 + 0.0013930039119144668i, -0.00043415356776166776 + 0.0004321144339133659i, 0.1295321674763778 + 2.9632918264099663e-20i, -0.0033370333124441097 + 0.003939459214229405i }, { 0.0001665964558562728 + 1.3138133252437058e-05i, -0.003049818820366922 + 0.002972533280674616i, 0.0013926608357913814 + -4.485236986286848e-05i, -0.0230419865242795 + 0.028640633636668404i, -0.00036274951335223235 + -0.0005071772919898124i, 0.016380744835514133 + 0.0014899132433511602i, -0.0033370333124441097 + -0.003939459214229405i, 0.13722716808225977 + 9.710376608336561e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, true, false, false, false, false, false, true, false, false}), ElementsAreArray({ DoubleNear(0.11306892695571494, 1.0e-7), DoubleNear(0.11979664340600961, 1.0e-7), DoubleNear(0.11141346978914006, 1.0e-7), DoubleNear(0.11803220983737153, 1.0e-7), DoubleNear(0.1315471182710638, 1.0e-7), DoubleNear(0.13938229618206366, 1.0e-7), DoubleNear(0.1295321674763778, 1.0e-7), DoubleNear(0.13722716808225977, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, true, false, false, false, false, false, false, true, false}), Matrix({ { 0.11478614365710492 + -4.266928471793538e-20i, -0.0029578368848373073 + 0.0034851152493586375i, 0.013493218170465678 + -0.0011907120652074055i, -0.0003165762894042136 + 0.00044215323514453316i, 0.005274193597569005 + 0.008844518327855098i, -0.00040444228353017425 + -6.777359841472846e-05i, 0.0007117332891088907 + 0.000984970536141606i, -4.8614901179570196e-05 + -4.076825102288742e-06i }, { -0.0029578368848373077 + -0.0034851152493586375i, 0.12161978567216193 + -1.2086349520318564e-20i, -0.00037858519118560583 + -0.00037808576585601046i, 0.01429566768479281 + -0.0012715396812007411i, 0.00013262891192211484 + -0.0003880417414036003i, 0.00558818577306676 + 0.009371065087965121i, 1.1737086474075177e-05 + -4.654308453522715e-05i, 0.0007548321794824955 + 0.0010430871234693747i }, { 0.013493218170465678 + 0.001190712065207405i, -0.00037858519118560583 + 0.00037808576585601056i, 0.1130638037544592 + -3.961202517393939e-20i, -0.002911500762931155 + 0.003440267964705178i, 0.0005282394570417617 + 0.001094392209364206i, -4.652755033790702e-05 + -1.1798515860342201e-05i, 0.00519505552569068 + 0.008711808347796427i, -0.0003988576520743026 + -6.626394391870576e-05i }, { -0.0003165762894042136 + -0.0004421532351445331i, 0.01429566768479281 + 0.0012715396812007403i, -0.002911500762931155 + -0.003440267964705178i, 0.11978053032679176 + 2.769814281133813e-21i, 1.9522807212102757e-05 + -4.4708937788467927e-05i, 0.0005588824654025441 + 0.0011599365311065445i, 0.00013130238461901703 + -0.0003824108009395741i, 0.005503675670559753 + 0.00922934652252288i }, { 0.0052741935975690055 + -0.008844518327855098i, 0.00013262891192211484 + 0.00038804174140360024i, 0.0005282394570417615 + -0.001094392209364206i, 1.9522807212102764e-05 + 4.470893778846793e-05i, 0.12982990156967383 + -1.5405411728187587e-20i, -0.0033454880474487374 + 0.003941870990411956i, 0.015261625934248908 + -0.0013467656051369729i, -0.00035806646327818847 + 0.0005001013987281416i }, { -0.00040444228353017414 + 6.777359841472855e-05i, 0.005588185773066761 + -0.009371065087965123i, -4.6527550337907025e-05 + 1.179851586034221e-05i, 0.000558882465402544 + -0.0011599365311065445i, -0.003345488047448738 + -0.003941870990411956i, 0.13755915391591134 + -6.411270132745379e-20i, -0.0004282021901022459 + -0.00042763731058528554i, 0.0161692436844448 + -0.0014381864081554445i }, { 0.0007117332891088907 + -0.0009849705361416063i, 1.1737086474075177e-05 + 4.6543084535227144e-05i, 0.00519505552569068 + -0.008711808347796425i, 0.00013130238461901703 + 0.00038241080093957396i, 0.015261625934248908 + 0.0013467656051369724i, -0.0004282021901022459 + 0.0004276373105852856i, 0.12788183351105864 + 8.228130989187477e-20i, -0.0032930791594546704 + 0.0038911460652013025i }, { -4.8614901179570196e-05 + 4.07682510228874e-06i, 0.0007548321794824955 + -0.0010430871234693747i, -0.0003988576520743026 + 6.626394391870584e-05i, 0.005503675670559753 + -0.009229346522522882i, -0.0003580664632781885 + -0.0005001013987281416i, 0.0161692436844448 + 0.001438186408155444i, -0.0032930791594546704 + -0.0038911460652013025i, 0.13547884759283954 + 1.6226884794514e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, true, false, false, false, false, false, false, true, false}), ElementsAreArray({ DoubleNear(0.11478614365710492, 1.0e-7), DoubleNear(0.12161978567216193, 1.0e-7), DoubleNear(0.1130638037544592, 1.0e-7), DoubleNear(0.11978053032679176, 1.0e-7), DoubleNear(0.12982990156967383, 1.0e-7), DoubleNear(0.13755915391591134, 1.0e-7), DoubleNear(0.12788183351105864, 1.0e-7), DoubleNear(0.13547884759283954, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, true, false, false, false, false, false, false, false, true}), Matrix({ { 0.1358279472607365 + -3.1393158607612506e-20i, 0.000657442262717106 + 0.0019169938318817634i, 0.015967108237383478 + -0.0014042403635212528i, 0.0001015594370488539 + 0.00022291047587910583i, -0.008454509293383435 + -0.010746120211309645i, -0.0031226380459714763 + 0.004150374902245453i, -0.0010946599402617933 + -0.001173762423306137i, -0.0003310205894841063 + 0.0005221550967253797i }, { 0.0006574422627171058 + -0.0019169938318817636i, 0.1258832730424853 + -9.1511818347354e-20i, 5.381635600183923e-05 + -0.00022709546956531043i, 0.014797508862399403 + -0.0013080115093571723i, -0.005461963514866436 + 0.013235584606951652i, -0.010740340954762746 + -0.007100824931547138i, -0.0004993880147891481 + 0.0016173872403674975i, -0.001333229387234403 + -0.0007239547401639676i }, { 0.015967108237383478 + 0.0014042403635212521i, 5.3816356001839235e-05 + 0.00022709546956531048i, 0.13379674317566062 + 4.947201807557148e-20i, 0.0006544155101424542 + 0.0018824641517158878i, -0.000892557723731975 + -0.0013544559197932792i, -0.00040289930992481744 + 0.00045482451022836796i, -0.008323824626518078 + -0.010599951913316533i, -0.0030739419089368084 + 0.004098389375272318i }, { 0.00010155943704885392 + -0.0002229104758791058i, 0.014797508862399403 + 0.0013080115093571719i, 0.0006544155101424541 + -0.0018824641517158878i, 0.12399126196649665 + 1.2398403406404194e-19i, -0.0007838226831949774 + 0.0014934803854524884i, -0.0011919136520056033 + -0.0009459766003108172i, -0.005372349187999646 + 0.013029870230904815i, -0.010579765984472198 + -0.006998619815479097i }, { -0.008454509293383435 + 0.010746120211309643i, -0.005461963514866436 + -0.013235584606951654i, -0.0008925577237319752 + 0.0013544559197932792i, -0.0007838226831949774 + -0.0014934803854524884i, 0.10878809796604225 + -2.668153783851046e-20i, -0.00696076719500315 + 0.0055099924078888295i, 0.01278773586733111 + -0.0011332373068231255i, -0.000776202189731256 + 0.000719344157993569i }, { -0.0031226380459714763 + -0.004150374902245453i, -0.010740340954762746 + 0.007100824931547138i, -0.00040289930992481744 + -0.0004548245102283679i, -0.0011919136520056033 + 0.0009459766003108172i, -0.006960767195003151 + -0.0055099924078888295i, 0.13329566654558797 + 1.5312767499581648e-20i, -0.0008606037372896909 + -0.0005786276068759856i, 0.015667402506838207 + -0.001401714579999013i }, { -0.0010946599402617933 + 0.0011737624233061367i, -0.0004993880147891482 + -0.0016173872403674975i, -0.008323824626518076 + 0.010599951913316533i, -0.005372349187999646 + -0.013029870230904815i, 0.01278773586733111 + 0.0011332373068231251i, -0.0008606037372896909 + 0.0005786276068759856i, 0.10714889408985723 + -6.8027333576361e-21i, -0.00685899543252828 + 0.005448949878190593i }, { -0.00033102058948410623 + -0.0005221550967253795i, -0.001333229387234403 + 0.0007239547401639678i, -0.003073941908936809 + -0.004098389375272318i, -0.010579765984472196 + 0.006998619815479097i, -0.000776202189731256 + -0.000719344157993569i, 0.015667402506838207 + 0.0014017145799990124i, -0.006858995432528279 + -0.005448949878190593i, 0.13126811595313465 + 4.105462816223187e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, true, false, false, false, false, false, false, false, true}), ElementsAreArray({ DoubleNear(0.1358279472607365, 1.0e-7), DoubleNear(0.1258832730424853, 1.0e-7), DoubleNear(0.13379674317566062, 1.0e-7), DoubleNear(0.12399126196649665, 1.0e-7), DoubleNear(0.10878809796604225, 1.0e-7), DoubleNear(0.13329566654558797, 1.0e-7), DoubleNear(0.10714889408985723, 1.0e-7), DoubleNear(0.13126811595313465, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, true, true, false, false, false, false, false, false}), Matrix({ { 0.0839453659745353 + 8.470329472543003e-22i, -0.002144290720581809 + 0.002620485602948559i, -7.115076756936123e-20 + 4.0657581468206416e-20i, -5.823351512373315e-22 + -3.3351922298138076e-21i, -0.00141868705079253 + -0.016788957042844013i, 0.0005603322726830118 + 0.00038456864686632706i, 1.3129010682441655e-20 + 1.3976043629695956e-20i, -1.1911400820763599e-22 + -5.227781471335135e-22i }, { -0.002144290720581809 + -0.002620485602948558i, 0.0888043909284327 + 3.408211598386926e-20i, 3.3881317890172014e-21 + 3.65282958503417e-21i, -7.453889935837843e-20 + 4.912791094074942e-20i, -0.00048785471676058477 + 0.0004731417074166645i, -0.001500805172520216 + -0.01776075531037241i, 2.5808035111654463e-22 + 0.0i, 1.0587911840678754e-20 + 1.6940658945086007e-20i }, { -4.743384504624082e-20 + -4.404571325722362e-20i, 1.6940658945086007e-21 + -2.329340604949326e-21i, 0.11563054471979856 + 6.895377586242039e-21i, -0.0029967172960234166 + 0.0034455226518503223i, -1.2705494208814505e-20 + 9.317362419797304e-21i, -6.617444900424221e-22 + -7.146840492458159e-22i, -0.001954170484167371 + -0.023125948950299974i, 0.0007397446552755856 + 0.0005411095544794171i }, { -8.735027268559972e-22 + 3.282252670610414e-21i, -7.453889935837843e-20 + -4.0657581468206416e-20i, -0.0029967172960234166 + -0.0034455226518503223i, 0.12264041498310019 + -8.457094582742155e-21i, 1.7205356741102976e-22 + -7.940933880509066e-23i, -1.2281977735187355e-20 + 1.3129010682441655e-20i, -0.0006384548705829062 + 0.0006575690710386802i, -0.00207263815721675 + -0.024527913303665008i }, { -0.00141868705079253 + 0.016788957042844013i, -0.00048785471676058477 + -0.0004731417074166646i, -1.3552527156068805e-20 + -1.1434944787933055e-20i, 4.367513634279986e-22 + 1.5881867761018131e-22i, 0.12029097195933026 + 5.861732692795775e-20i, -0.003072698676665534 + 0.003755070414246993i, -1.0842021724855044e-19 + 7.623296525288703e-20i, 2.117582368135751e-21 + -3.1763735522036263e-21i }, { 0.0005603322726830118 + -0.00038456864686632706i, -0.001500805172520216 + 0.01776075531037241i, -5.426304818347862e-22 + 1.5881867761018131e-22i, -9.740878893424454e-21 + -1.3552527156068805e-20i, -0.003072698676665534 + -0.003755070414246993i, 0.12725379626408423 + 5.649126595854333e-20i, 1.6940658945086007e-21 + 5.823351512373315e-21i, -1.0164395367051604e-19 + 5.082197683525802e-20i }, { 1.5246593050577406e-20 + -1.6093625997831706e-20i, 2.713152409173931e-22 + 2.117582368135751e-22i, -0.0019541704841673714 + 0.02312594895029997i, -0.0006384548705829062 + -0.0006575690710386801i, -1.0164395367051604e-19 + -6.945670167485263e-20i, 0.0 + -4.129285617864714e-21i, 0.16569479983863244 + -8.176514918964168e-20i, -0.004294198161401111 + 0.004937321600631199i }, { -3.1763735522036263e-22 + 1.852884572118782e-22i, 1.2705494208814505e-20 + -1.3552527156068805e-20i, 0.0007397446552755856 + -0.0005411095544794171i, -0.0020726381572167495 + 0.024527913303665008i, 2.8587361969832636e-21 + 3.1763735522036263e-21i, -1.2874900798265365e-19 + -1.0842021724855044e-19i, -0.00429419816140111 + -0.004937321600631199i, 0.1757397153320875 + 6.723324018831009e-21i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, true, true, false, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.0839453659745353, 1.0e-7), DoubleNear(0.0888043909284327, 1.0e-7), DoubleNear(0.11563054471979856, 1.0e-7), DoubleNear(0.12264041498310019, 1.0e-7), DoubleNear(0.12029097195933026, 1.0e-7), DoubleNear(0.12725379626408423, 1.0e-7), DoubleNear(0.16569479983863244, 1.0e-7), DoubleNear(0.1757397153320875, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, true, false, true, false, false, false, false, false}), Matrix({ { 0.07237137992724188 + 2.4974237054201012e-20i, -0.0018486461594647242 + 0.0022591855662692224i, -7.115076756936123e-20 + -9.486769009248164e-20i, -1.6940658945086007e-21 + -3.1234339930002325e-21i, 2.168404344971009e-18 + 9.75781955236954e-19i, -4.573977915173222e-20 + 1.8634724839594607e-20i, -0.0005911415839879519 + 0.0004639162964388789i, -8.45624170624068e-06 + -2.7882339645851654e-05i }, { -0.0018486461594647242 + -0.0022591855662692224i, 0.07656046573242062 + -1.3127769911522826e-20i, 2.964615315390051e-21 + -2.541098841762901e-21i, -6.776263578034403e-20 + -1.2536087619363645e-19i, -6.098637220230962e-20 + -6.860966872759833e-20i, 2.168404344971009e-18 + 6.505213034913027e-19i, 2.825534456699617e-05 + 1.1953072161649281e-05i, -0.0006193898900389882 + 0.00048651982731440365i }, { -5.421010862427522e-20 + 1.0164395367051604e-19i, -4.235164736271502e-22 + 3.494010907423989e-21i, 0.0996879575895708 + -7.080666043453917e-21i, -0.002583544230789784 + 0.002970470448131941i, -0.0006360135183729308 + 0.00040019183758322244i, -1.730332776768046e-06 + -3.0630807680877715e-05i, 2.168404344971009e-19 + -2.3852447794681098e-18i, 5.675120746603812e-20 + 1.1180834903756764e-19i }, { -8.470329472543003e-22 + 3.65282958503417e-21i, -5.759824041329242e-20 + 1.3213713977167085e-19i, -0.002583544230789784 + -0.0029704704481319415i, 0.10573134042764158 + -1.708624273289534e-20i, 2.3400755017134753e-05 + 1.735907694979885e-05i, -0.0006668154494542135 + 0.00041916886170339785i, -2.710505431213761e-20 + 2.371692252312041e-20i, -5.421010862427522e-20 + -3.144186300207963e-18i }, { 1.7889335846010823e-18 + -8.131516293641283e-19i, -3.7269449679189215e-20 + 3.3034284942917713e-20i, -0.0006360135183729307 + -0.0004001918375832225i, 2.340075501713476e-05 + -1.735907694979885e-05i, 0.13186495800662368 + 3.449012282101104e-20i, -0.0033683432377826185 + 0.004116370450926329i, -1.1519648082658485e-19 + 2.1006417091906648e-19i, 2.117582368135751e-21 + -3.8116482626443515e-21i }, { -4.743384504624082e-20 + -2.541098841762901e-20i, 2.168404344971009e-18 + -5.421010862427522e-19i, -1.7303327767680476e-06 + 3.0630807680877715e-05i, -0.0006668154494542135 + -0.00041916886170339785i, -0.0033683432377826193 + -0.004116370450926329i, 0.13949772146009634 + 1.0370115185393542e-19i, 3.3881317890172014e-21 + 1.2705494208814505e-20i, -1.1519648082658485e-19 + 2.371692252312041e-19i }, { -0.000591141583987952 + -0.0004639162964388789i, 2.8255344566996168e-05 + -1.195307216164928e-05i, 5.421010862427522e-20 + 2.6020852139652106e-18i, -3.7269449679189215e-20 + -5.590417451878382e-20i, -9.486769009248164e-20 + -2.0328790734103208e-19i, 0.0 + -9.317362419797304e-21i, 0.18163738696886023 + -6.778910555994572e-20i, -0.004707371226634743 + 0.005412373804349581i }, { -8.456241706240677e-06 + 2.788233964585165e-05i, -0.0006193898900389882 + -0.00048651982731440354i, 2.879912020664621e-20 + -1.4568966692773966e-19i, -1.0842021724855044e-19 + 2.710505431213761e-18i, 8.470329472543003e-22 + 2.329340604949326e-21i, -1.2197274440461925e-19 + -2.778268066994105e-19i, -0.004707371226634744 + -0.005412373804349581i, 0.19264878988754605 + 1.5352472168984194e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, true, false, true, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.07237137992724188, 1.0e-7), DoubleNear(0.07656046573242062, 1.0e-7), DoubleNear(0.0996879575895708, 1.0e-7), DoubleNear(0.10573134042764158, 1.0e-7), DoubleNear(0.13186495800662368, 1.0e-7), DoubleNear(0.13949772146009634, 1.0e-7), DoubleNear(0.18163738696886023, 1.0e-7), DoubleNear(0.19264878988754605, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, true, false, false, true, false, false, false, false}), Matrix({ { 0.11004371973843996 + 5.331013611781753e-20i, -0.0028109440509798 + 0.0034351864444424965i, -8.131516293641283e-20 + 3.7269449679189215e-20i, -8.470329472543003e-22 + -3.017554874593445e-21i, 0.0009790745089034742 + 0.00799013335929172i, -0.0002744338481394106 + -0.00017353570378338628i, -1.1519648082658485e-19 + 1.0842021724855044e-19i, 1.5881867761018131e-21 + -1.9058241313221758e-21i }, { -0.0028109440509798 + -0.0034351864444424965i, 0.1164134004709175 + 7.761745880314766e-20i, 2.964615315390051e-21 + 4.2881042954748955e-21i, -7.453889935837843e-20 + 4.743384504624082e-20i, 0.00022441511607892335 + -0.00023466238123628512i, 0.0010357464575602945 + 0.008452627708170297i, 2.964615315390051e-21 + 2.964615315390051e-21i, -1.2874900798265365e-19 + 9.825582188149884e-20i }, { -6.437450399132683e-20 + -5.082197683525802e-20i, 1.4823076576950256e-21 + -2.276401045745932e-21i, 0.15157972222324453 + -2.72109334305444e-20i, -0.003928387403290037 + 0.0045167249514128085i, -1.2874900798265365e-19 + -8.131516293641283e-20i, -2.117582368135751e-21 + -7.72917564369549e-21i, 0.0013486261864665689 + 0.011006009229848379i, -0.0003629050233089993 + -0.0002450492317025235i }, { 1.3234889800848443e-21 + 2.4352197233561135e-21i, -7.115076756936123e-20 + -4.912791094074942e-20i, -0.003928387403290037 + -0.0045167249514128085i, 0.1607689393968475 + -3.112846081159554e-20i, 3.917527381051139e-21 + 4.9763185651190145e-21i, -1.8295911660692887e-19 + -8.131516293641283e-20i, 0.00029300218874832323 + -0.0003254211107005726i, 0.0014303839488617083 + 0.01167322650366554i }, { 0.0009790745089034742 + -0.00799013335929172i, 0.00022441511607892333 + 0.0002346623812362851i, -1.7618285302889447e-19 + 3.7269449679189215e-20i, 4.9763185651190145e-21 + -7.411538288475128e-22i, 0.0941926181954256 + 6.154223757394526e-21i, -0.002406045346267543 + 0.002940369572753055i, -1.2197274440461925e-19 + 7.115076756936123e-20i, 2.276401045745932e-21 + -3.494010907423989e-21i }, { -0.00027443384813941057 + 0.00017353570378338625i, 0.001035746457560294 + -0.008452627708170297i, -1.2705494208814505e-21 + 7.623296525288703e-21i, -1.5585406229479126e-19 + 1.0164395367051604e-19i, -0.002406045346267543 + -0.0029403695727530555i, 0.09964478672159943 + 1.2955923139264934e-20i, 3.1763735522036263e-21 + 5.6645328347631335e-21i, -1.0842021724855044e-19 + 7.115076756936123e-20i }, { -1.2874900798265365e-19 + -1.0842021724855044e-19i, 6.776263578034403e-21 + -7.199780051661553e-21i, 0.0013486261864665702 + -0.011006009229848379i, 0.0002930021887483232 + 0.0003254211107005726i, -8.809142651444724e-20 + -5.759824041329242e-20i, 0.0 + -3.546950466627383e-21i, 0.1297456223351865 + -4.765883817285524e-20i, -0.003362528054134491 + 0.0038661193010687137i }, { 2.0117032497289633e-21 + 2.8587361969832636e-21i, -1.0842021724855044e-19 + -9.825582188149884e-20i, -0.0003629050233089993 + 0.0002450492317025234i, 0.0014303839488617096 + -0.01167322650366554i, -1.0058516248644817e-21 + 3.494010907423989e-21i, -1.0842021724855044e-19 + -9.825582188149884e-20i, -0.003362528054134491 + -0.0038661193010687137i, 0.13761119091834012 + 2.939469024768439e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, true, false, false, true, false, false, false, false}), ElementsAreArray({ DoubleNear(0.11004371973843996, 1.0e-7), DoubleNear(0.1164134004709175, 1.0e-7), DoubleNear(0.15157972222324453, 1.0e-7), DoubleNear(0.1607689393968475, 1.0e-7), DoubleNear(0.0941926181954256, 1.0e-7), DoubleNear(0.09964478672159943, 1.0e-7), DoubleNear(0.1297456223351865, 1.0e-7), DoubleNear(0.13761119091834012, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, true, false, false, false, true, false, false, false}), Matrix({ { 0.12022305281974607 + 2.584773978105701e-20i, -0.0030670874574379456 + 0.0033745059146978776i, -1.1519648082658485e-19 + 2.778268066994105e-19i, -7.040961374051372e-21 + -5.293955920339377e-21i, -5.692061405548898e-19 + -2.439454888092385e-19i, 2.795208725939191e-20 + -5.251604272976662e-20i, 0.00021986646423712204 + 0.0002480457059202056i, -7.624148597757635e-05 + -5.873004245530888e-05i }, { -0.0030670874574379456 + -0.0033745059146978776i, 0.12888321404291322 + 6.013933925505532e-20i, 1.1011428314305904e-20 + 0.0i, -1.0164395367051604e-19 + 2.778268066994105e-19i, -7.453889935837843e-20 + 9.994988777600744e-20i, -5.89534931288993e-19 + -3.7947076036992655e-19i, 5.117580971381279e-05 + -8.610960930507806e-05i, 0.0002518272486236563 + 0.0002867842094592342i }, { -8.809142651444724e-20 + -2.778268066994105e-19i, 8.470329472543003e-21 + 2.964615315390051e-21i, 0.1617602398941405 + -2.5106585952209496e-20i, -0.004316489382579098 + 0.0042549576375771146i, 3.4442893046841785e-05 + 0.00033164707094822095i, -1.1771904286806937e-05 + -8.059629635450712e-05i, 7.860465750519907e-19 + 2.0328790734103208e-20i, 5.082197683525802e-21 + 4.1504614415460717e-20i }, { -7.623296525288703e-21 + 4.446922973085077e-21i, -1.1519648082658485e-19 + -2.981555974335137e-19i, -0.004316489382579099 + -0.0042549576375771146i, 0.17337694583111182 + 4.425747149403719e-20i, 0.00012133197122902436 + -4.004137025603269e-05i, 6.186600061120547e-05 + 0.0004182327727708069i, -6.776263578034403e-21 + -1.2705494208814505e-19i, 1.1926223897340549e-18 + 2.303929616531697e-19i }, { -5.014435047745458e-19 + 2.168404344971009e-19i, -6.268043809681823e-20 + -8.470329472543003e-20i, 3.444289304684178e-05 + -0.00033164707094822095i, 0.00012133197122902434 + 4.0041370256032693e-05i, 0.08401328511411948 + 3.3616620094155045e-20i, -0.002149901939809397 + 0.003001050102497674i, -8.131516293641283e-20 + -1.6263032587282567e-19i, 8.046812998915853e-21 + -1.376428539288238e-21i }, { 2.710505431213761e-20 + 5.251604272976662e-20i, -6.166399856011306e-19 + 4.336808689942018e-19i, -1.1771904286806934e-05 + 8.059629635450712e-05i, 6.186600061120547e-05 + -0.00041823277277080686i, -0.002149901939809397 + -0.0030010501024976743i, 0.08717497314960371 + 3.043404268735727e-20i, -5.082197683525802e-21 + 1.0058516248644817e-20i, -7.115076756936123e-20 + -1.6601845766184287e-19i }, { 0.00021986646423712206 + -0.0002480457059202056i, 5.117580971381279e-05 + 8.610960930507806e-05i, 8.944667923005412e-19 + -5.421010862427522e-20i, -1.1858461261560205e-20 + 1.1519648082658485e-19i, -8.470329472543003e-20 + 1.7957098481791167e-19i, -7.199780051661553e-21 + -9.211483301390516e-21i, 0.11956510466429052 + -4.9763185651190145e-20i, -0.002974426074845429 + 0.004127886614904408i }, { -7.624148597757635e-05 + 5.873004245530888e-05i, 0.00025182724862365637 + -0.0002867842094592342i, 1.3552527156068805e-20 + -6.013933925505532e-20i, 1.0842021724855044e-18 + -1.6263032587282567e-19i, 8.364450354136216e-21 + 9.529120656610879e-22i, -6.437450399132683e-20 + 1.4568966692773966e-19i, -0.002974426074845429 + -0.004127886614904408i, 0.12500318448407582 + -4.599124205794834e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, true, false, false, false, true, false, false, false}), ElementsAreArray({ DoubleNear(0.12022305281974607, 1.0e-7), DoubleNear(0.12888321404291322, 1.0e-7), DoubleNear(0.1617602398941405, 1.0e-7), DoubleNear(0.17337694583111182, 1.0e-7), DoubleNear(0.08401328511411948, 1.0e-7), DoubleNear(0.08717497314960371, 1.0e-7), DoubleNear(0.11956510466429052, 1.0e-7), DoubleNear(0.12500318448407582, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, true, false, false, false, false, true, false, false}), Matrix({ { 0.0948565438833752 + 2.9884381170315784e-20i, -0.002422917498419069 + 0.0029525925415185596i, 0.00027188600148539735 + -7.143537039300467e-05i, -3.98028120125681e-06 + 9.536417542333965e-06i, -0.01592828588710892 + -0.023184091740866886i, 0.0011256553414337866 + 4.3848191747677934e-05i, 0.0008092490452941688 + 0.0009583552545214668i, -4.76165706781195e-05 + 1.54113503388952e-05i }, { -0.002422917498419069 + -0.00295259254151856i, 0.10038536493468676 + 4.378680572549452e-20i, -5.791923180644202e-06 + -1.1197451841673402e-05i, 0.00028421963384676863 + -8.17667352292976e-05i, -0.00031086833314478265 + 0.0011404633561634056i, -0.01662063365672823 + -0.024550631709763224i, 1.9040500299689213e-05 + -4.9641649822693384e-05i, 0.0008474590772936106 + 0.0010006108746053594i }, { 0.00027188600148539735 + 7.143537039300469e-05i, -5.791923180644205e-06 + 1.1197451841673406e-05i, 0.1296258528614798 + -5.955700410381799e-20i, -0.003356632310406498 + 0.0038752470699308155i, 0.0007160102525841359 + 0.0010985307204065022i, -5.1918729686103796e-05 + 5.161863327968551e-06i, -0.02815423811048773 + -0.031270039924171135i, 0.0016863630830163216 + 4.595695151110433e-05i }, { -3.980281201256811e-06 + -9.536417542333963e-06i, 0.00028421963384676863 + 8.176673522929757e-05i, -0.003356632310406498 + -0.0038752470699308155i, 0.13744348830869438 + -1.945528800724721e-21i, 2.832982191482351e-05 + -4.030200803577367e-05i, 0.000750397921264658 + 0.001155429131958335i, -0.00019351041061841984 + 0.0015712619616359872i, -0.03010538337295365 + -0.03313957760026186i }, { -0.01592828588710892 + 0.02318409174086689i, -0.00031086833314478255 + -0.0011404633561634056i, 0.0007160102525841359 + -0.0010985307204065022i, 2.8329821914823513e-05 + 4.0302008035773674e-05i, 0.10937979405049036 + 2.957997870489627e-20i, -0.0027940718988282735 + 0.003422963475676992i, -0.0002718860014853975 + 7.143537039300478e-05i, 3.980281201256811e-06 + -9.536417542333972e-06i }, { 0.0011256553414337866 + -4.3848191747677934e-05i, -0.01662063365672823 + 0.024550631709763224i, -5.19187296861038e-05 + -5.1618633279685484e-06i, 0.000750397921264658 + -0.0011554291319583352i, -0.0027940718988282735 + -0.003422963475676992i, 0.11567282225783018 + 4.6786576216918075e-20i, 5.791923180644209e-06 + 1.1197451841673414e-05i, -0.0002842196338467688 + 8.176673522929771e-05i }, { 0.0008092490452941688 + -0.0009583552545214668i, 1.9040500299689217e-05 + 4.9641649822693384e-05i, -0.02815423811048773 + 0.031270039924171135i, -0.00019351041061841978 + -0.0015712619616359872i, -0.00027188600148539746 + -7.143537039300478e-05i, 5.791923180644206e-06 + -1.1197451841673412e-05i, 0.15169949169695124 + -1.5312767499581648e-20i, -0.00393428314701803 + 0.004507597182550707i }, { -4.76165706781195e-05 + -1.54113503388952e-05i, 0.0008474590772936106 + -0.0010006108746053594i, 0.0016863630830163219 + -4.5956951511104275e-05i, -0.03010538337295365 + 0.03313957760026186i, 3.980281201256812e-06 + 9.53641754233397e-06i, -0.00028421963384676885 + -8.176673522929772e-05i, -0.00393428314701803 + -0.004507597182550707i, 0.16093664200649324 + 2.117582368135751e-22i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, true, false, false, false, false, true, false, false}), ElementsAreArray({ DoubleNear(0.0948565438833752, 1.0e-7), DoubleNear(0.10038536493468676, 1.0e-7), DoubleNear(0.1296258528614798, 1.0e-7), DoubleNear(0.13744348830869438, 1.0e-7), DoubleNear(0.10937979405049036, 1.0e-7), DoubleNear(0.11567282225783018, 1.0e-7), DoubleNear(0.15169949169695124, 1.0e-7), DoubleNear(0.16093664200649324, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, true, false, false, false, false, false, true, false}), Matrix({ { 0.09583795537346583 + -1.639802846325122e-20i, -0.002448073648868191 + 0.0029917313404575208i, -8.809142651444724e-20 + 5.082197683525802e-20i, 1.0587911840678754e-21 + -3.8116482626443515e-21i, 0.0044035622639680035 + 0.007384519819194318i, -0.0003430033955626842 + -5.1165252065706993e-05i, -1.0587911840678754e-20 + 0.0i, 3.044024654195142e-22 + -7.940933880509066e-23i }, { -0.002448073648868191 + -0.0029917313404575208i, 0.10138536125208741 + 1.8000277309766435e-20i, 5.929230630780102e-21 + 4.446922973085077e-21i, -6.776263578034403e-20 + 7.453889935837843e-20i, 0.00011803522512203858 + -0.00032609338848996644i, 0.004658454462938848 + 0.007811959328897568i, -1.3234889800848443e-22 + 4.235164736271502e-22i, -5.929230630780102e-21 + -1.6940658945086007e-21i }, { -8.131516293641283e-20 + -4.404571325722362e-20i, 2.541098841762901e-21 + -2.964615315390051e-21i, 0.13201199203809827 + -6.588328142862355e-20i, -0.0034212639989002714 + 0.003933651873606295i, 0.0 + -1.1011428314305904e-20i, -6.617444900424221e-23 + -4.235164736271502e-22i, 0.00606568685929168 + 0.010171806856457206i, -0.00046029654004179266 + -8.287229026772723e-05i }, { 8.470329472543003e-22 + 3.3881317890172014e-21i, -9.486769009248164e-20 + -8.131516293641283e-20i, -0.0034212639989002714 + -0.003933651873606295i, 0.14001495474686626 + -2.7316812548951186e-20i, 4.1028158382630173e-22 + 7.279189390466644e-23i, -8.470329472543003e-22 + -1.1011428314305904e-20i, 0.00014589607141909326 + -0.00044435915385320797i, 0.006433406980687666 + 0.010788452281590432i }, { 0.0044035622639680035 + -0.007384519819194317i, 0.00011803522512203855 + 0.0003260933884899664i, 3.5998900258307764e-21 + 7.623296525288703e-21i, -1.1249656330721176e-22 + -3.044024654195142e-22i, 0.10839838256039973 + 7.586238833846327e-20i, -0.0027689157483791514 + 0.0033838246767380308i, -1.0842021724855044e-19 + 6.437450399132683e-20i, -1.0587911840678754e-22 + -2.964615315390051e-21i }, { -0.0003430033955626841 + 5.1165252065707054e-05i, 0.004658454462938848 + -0.007811959328897568i, 2.514629062161204e-22 + 3.970466940254533e-22i, 2.117582368135751e-21 + 2.541098841762901e-21i, -0.002768915748379152 + -0.0033838246767380308i, 0.11467282594042953 + 7.257310463264616e-20i, 8.470329472543003e-22 + 6.246867986000465e-21i, -9.486769009248164e-20 + 3.7269449679189215e-20i }, { -8.893845946170154e-21 + 2.541098841762901e-21i, -1.5881867761018131e-22 + -7.940933880509066e-23i, 0.006065686859291681 + -0.010171806856457204i, 0.0001458960714190933 + 0.00044435915385320775i, -8.131516293641283e-20 + -5.421010862427522e-20i, -1.2705494208814505e-21 + -3.282252670610414e-21i, 0.14931335252033273 + -8.986490174776093e-21i, -0.0038696514585242568 + 0.0044491923788752274i }, { -2.2499312661442353e-22 + 3.441071348220595e-22i, -8.470329472543003e-21 + 2.541098841762901e-21i, -0.0004602965400417926 + 8.287229026772731e-05i, 0.006433406980687666 + -0.010788452281590432i, -1.0587911840678754e-22 + 2.117582368135751e-21i, -9.486769009248164e-20 + -7.115076756936123e-20i, -0.0038696514585242568 + -0.0044491923788752274i, 0.15836517556832136 + 2.558304198504004e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, true, false, false, false, false, false, true, false}), ElementsAreArray({ DoubleNear(0.09583795537346583, 1.0e-7), DoubleNear(0.10138536125208741, 1.0e-7), DoubleNear(0.13201199203809827, 1.0e-7), DoubleNear(0.14001495474686626, 1.0e-7), DoubleNear(0.10839838256039973, 1.0e-7), DoubleNear(0.11467282594042953, 1.0e-7), DoubleNear(0.14931335252033273, 1.0e-7), DoubleNear(0.15836517556832136, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, true, false, false, false, false, false, false, true}), Matrix({ { 0.11348181373192925 + 3.6065074707312007e-20i, 0.0006241436800248103 + 0.0015371182450990358i, -1.0842021724855044e-19 + 6.776263578034403e-20i, 3.282252670610414e-21 + -2.541098841762901e-21i, -0.007016792110064612 + -0.009138061066179223i, -0.0025869112873906754 + 0.0035784601764715027i, 1.3552527156068805e-20 + -3.3881317890172014e-21i, 1.2705494208814505e-21 + -1.6093625997831706e-20i }, { 0.0006241436800248103 + -0.0015371182450990355i, 0.10506846056122474 + 5.14245779115029e-20i, -5.929230630780102e-21 + 1.376428539288238e-21i, -8.131516293641283e-20 + 5.759824041329242e-20i, -0.004476078478019098 + 0.01097243392223539i, -0.008973787926506703 + -0.005976423308015351i, -4.235164736271502e-21 + -1.0164395367051604e-20i, 7.623296525288703e-21 + -1.6940658945086007e-21i }, { -9.486769009248164e-20 + -7.115076756936123e-20i, -8.893845946170154e-21 + -3.1763735522036263e-22i, 0.15614287670446786 + -1.7986215239353034e-20i, 0.0006877140928347501 + 0.002262339738498616i, -4.235164736271502e-22 + 1.5246593050577406e-20i, 0.0 + 5.717472393966527e-21i, -0.009761541809836898 + -0.012208011058446953i, -0.003609668667517609 + 0.004670304101046269i }, { 4.341043854678289e-21 + 1.2705494208814505e-21i, -9.486769009248164e-20 + -9.486769009248164e-20i, 0.0006877140928347497 + -0.002262339738498616i, 0.14480607444775723 + -1.895236219481497e-20i, 1.1011428314305904e-20 + -7.623296525288703e-21i, 6.776263578034403e-21 + 1.0164395367051604e-20i, -0.006358234224846984 + 0.015293020915621075i, -0.01234631901272824 + -0.008123021439010883i }, { -0.007016792110064613 + 0.009138061066179223i, -0.004476078478019098 + -0.01097243392223539i, -3.8116482626443515e-21 + -1.5246593050577406e-20i, 1.1011428314305904e-20 + 8.470329472543003e-21i, 0.0907545242019363 + 2.3399285167900047e-20i, -0.005841133077272153 + 0.004838437772096516i, -8.809142651444724e-20 + 4.743384504624082e-20i, -2.329340604949326e-21 + -4.235164736271502e-21i }, { -0.002586911287390676 + -0.003578460176471503i, -0.008973787926506703 + 0.005976423308015352i, -3.3881317890172014e-21 + -3.1763735522036263e-21i, 1.0164395367051604e-20 + -1.3552527156068805e-20i, -0.005841133077272153 + -0.004838437772096516i, 0.11098972663129221 + 3.9148804030909694e-20i, 1.2705494208814505e-20 + 9.317362419797304e-21i, -8.131516293641283e-20 + 5.421010862427522e-20i }, { 1.5246593050577406e-20 + 3.3881317890172014e-21i, -6.3527471044072525e-21 + 9.317362419797304e-21i, -0.009761541809836898 + 0.012208011058446953i, -0.006358234224846984 + -0.015293020915621076i, -6.776263578034403e-20 + -2.710505431213761e-20i, 1.0164395367051604e-20 + -5.929230630780102e-21i, 0.12518246785396317 + -5.688355636404661e-20i, -0.007978629550259278 + 0.006120504513982906i }, { 0.0 + 1.3552527156068805e-20i, 1.1011428314305904e-20 + 4.658681209898652e-21i, -0.0036096686675176092 + -0.004670304101046268i, -0.012346319012728238 + 0.008123021439010883i, -3.5998900258307764e-21 + 4.235164736271502e-21i, -9.486769009248164e-20 + -5.759824041329242e-20i, -0.007978629550259278 + -0.006120504513982906i, 0.1535740558674304 + 1.7218591630903824e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, true, false, false, false, false, false, false, true}), ElementsAreArray({ DoubleNear(0.11348181373192925, 1.0e-7), DoubleNear(0.10506846056122474, 1.0e-7), DoubleNear(0.15614287670446786, 1.0e-7), DoubleNear(0.14480607444775723, 1.0e-7), DoubleNear(0.0907545242019363, 1.0e-7), DoubleNear(0.11098972663129221, 1.0e-7), DoubleNear(0.12518246785396317, 1.0e-7), DoubleNear(0.1535740558674304, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, true, true, false, false, false, false, false}), Matrix({ { 0.07078070417342047 + 3.662094007894764e-20i, -0.0018232870205153904 + 0.002151343487812209i, -0.002119076892854581 + -0.013397563523387737i, 0.00046179883083278004 + 0.000280708445008214i, 9.75781955236954e-19 + -4.87890977618477e-19i, -6.776263578034403e-21 + 4.743384504624082e-20i, -1.1858461261560205e-19 + -1.1519648082658485e-19i, 7.358598729271734e-21 + -9.529120656610879e-22i }, { -0.0018232870205153904 + -0.002151343487812209i, 0.07499007372263702 + -2.0203266076148286e-20i, -0.00035262542151632593 + 0.0004095249728134849i, -0.002245099625312506 + -0.014194324400347482i, -2.498747194400186e-20 + 4.235164736271502e-21i, 9.215718466126788e-19 + -1.0299920638612292e-18i, 2.4352197233561135e-21 + 2.4352197233561135e-21i, -1.6263032587282567e-19 + -1.0164395367051604e-19i }, { -0.0021190768928545816 + 0.013397563523387737i, -0.00035262542151632593 + -0.00040952497281348496i, 0.10127863334339222 + -1.8727369068200547e-20i, -0.0026089033697391175 + 0.003078312526588955i, 1.1180834903756764e-19 + 2.439454888092385e-19i, -7.199780051661553e-21 + -6.564505341220828e-21i, 1.3552527156068805e-18 + -9.215718466126788e-19i, 1.6940658945086007e-20 + 8.639736061993863e-20i }, { 0.00046179883083277993 + -0.000280708445008214i, -0.002245099625312506 + 0.014194324400347482i, -0.0026089033697391175 + -0.003078312526588955i, 0.10730173243742519 + -1.0010746568269879e-20i, 5.717472393966527e-21 + -5.293955920339377e-21i, 1.0842021724855044e-19 + 2.0328790734103208e-19i, -4.1504614415460717e-20 + -3.3881317890172014e-20i, 1.4094628242311558e-18 + -1.1384122811097797e-18i }, { 9.215718466126788e-19 + 8.131516293641283e-19i, -2.795208725939191e-20 + -2.456395547037471e-20i, 7.453889935837843e-20 + -2.574980159653073e-19i, -1.2705494208814505e-21 + 1.0058516248644817e-20i, 0.1287952065209134 + -2.88785295454513e-20i, -0.0033177209960898353 + 0.003914664766986671i, -0.0012537806421053198 + -0.02651734246975625i, 0.0008382780971258175 + 0.0006449697563375303i }, { 0.0 + -5.675120746603812e-20i, 8.673617379884035e-19 + 7.589415207398531e-19i, -1.079967007749233e-20 + 4.7645603283054394e-21i, 1.4230153513872246e-19 + -2.981555974335137e-19i, -0.0033177209960898353 + -0.003914664766986672i, 0.13645473218889587 + 4.582828747727539e-20i, -0.0007736841658271651 + 0.0007211858056418597i, -0.001328343704424459 + -0.02809434421368994i }, { -1.2197274440461925e-19 + 9.317362419797304e-20i, 2.3822801641527197e-22 + -3.3881317890172014e-21i, 1.0299920638612292e-18 + 9.75781955236954e-19i, -5.039846036163087e-20 + 1.6940658945086007e-21i, -0.0012537806421053198 + 0.02651734246975625i, -0.000773684165827165 + -0.0007211858056418597i, 0.1847071384545705 + -4.42045319348338e-21i, -0.004757993468327527 + 0.005614079488289238i }, { 9.529120656610879e-21 + 1.0587911840678754e-21i, -1.6263032587282567e-19 + 6.437450399132683e-20i, 5.082197683525802e-21 + -9.402065714522734e-20i, 1.0842021724855044e-18 + 1.463672932855431e-18i, 0.0008382780971258173 + -0.0006449697563375302i, -0.001328343704424459 + 0.02809434421368994i, -0.004757993468327527 + -0.005614079488289238i, 0.19569177915874653 + 7.322533654564422e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, true, true, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.07078070417342047, 1.0e-7), DoubleNear(0.07499007372263702, 1.0e-7), DoubleNear(0.10127863334339222, 1.0e-7), DoubleNear(0.10730173243742519, 1.0e-7), DoubleNear(0.1287952065209134, 1.0e-7), DoubleNear(0.13645473218889587, 1.0e-7), DoubleNear(0.1847071384545705, 1.0e-7), DoubleNear(0.19569177915874653, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, true, false, true, false, false, false, false}), Matrix({ { 0.10753265459598482 + 2.2472842881840656e-20i, -0.002770004843778443 + 0.0032684003203108016i, -0.0018173151411234175 + -0.021506382130284902i, 0.0007004889656071602 + 0.0004987607669985718i, 0.0009567332078549685 + 0.007807808139735578i, -0.00026195947966349954 + -0.00017204708014383893i, 0.0015453819152220281 + -0.0003232982394678878i, -2.9982030419811152e-05 + 5.529915036848096e-05i }, { -0.002770004843778443 + -0.0032684003203108016i, 0.11392768396293955 + 3.784309943399474e-20i, -0.0006068621177906135 + 0.0006092335050086168i, -0.001925391927102155 + -0.02278537915511291i, 0.00021266923141437084 + -0.0002302059182150032i, 0.001013630686891088 + 0.008272143020453957i, -4.963500138761274e-05 + -3.864304357606981e-05i, 0.0016372866744613175 + -0.0003425249733697877i }, { -0.0018173151411234175 + 0.021506382130284902i, -0.0006068621177906135 + -0.0006092335050086168i, 0.15409078736569967 + 3.626359805432473e-21i, -0.003969326610491394 + 0.0046835110755445025i, -0.001577719733928037 + 5.939239608219044e-05i, 3.8836325527505165e-05 + -4.9483916569851254e-05i, 0.0013709674875150744 + 0.01118833444940452i, -0.0003753793917849104 + -0.00024653785534207084i }, { 0.0007004889656071602 + -0.0004987607669985716i, -0.0019253919271021549 + 0.02278537915511291i, -0.003969326610491394 + -0.0046835110755445025i, 0.16325465590482546 + 8.645898557557384e-21i, 4.24467288437515e-05 + 4.642406046475667e-05i, -0.0016715476420104862 + 6.292449634091125e-05i, 0.0003047480734128758 + -0.00032987757372185454i, 0.0014524997195309148 + 0.011853711191381882i }, { 0.0009567332078549688 + -0.007807808139735578i, 0.0002126692314143708 + 0.0002302059182150032i, -0.001577719733928037 + -5.939239608219055e-05i, 4.244672884375151e-05 + -4.6424060464756664e-05i, 0.09204325609834904 + -1.4730432348344317e-20i, -0.0023710031728267824 + 0.0027976079344880786i, -0.0015555423938364839 + -0.018408523862859086i, 0.0005995879623514372 + 0.0004269174343471725i }, { -0.0002619594796634995 + 0.00017204708014383893i, 0.001013630686891088 + -0.008272143020453957i, 3.8836325527505165e-05 + 4.948391656985126e-05i, -0.0016715476420104862 + -6.292449634091133e-05i, -0.0023710031728267824 + -0.0027976079344880786i, 0.09751712194859333 + -1.2218078032867634e-20i, -0.0005194474695528774 + 0.0005214772734467279i, -0.0016480514026348102 + -0.019503289458924513i }, { 0.0015453819152220281 + 0.000323298239467888i, -4.9635001387612744e-05 + 3.86430435760698e-05i, 0.0013709674875150755 + -0.01118833444940452i, 0.00030474807341287564 + 0.00032987757372185454i, -0.0015555423938364839 + 0.018408523862859086i, -0.0005194474695528774 + -0.0005214772734467279i, 0.13189498443226305 + -2.67741820671164e-20i, -0.003397570227575251 + 0.00400888093933369i }, { -2.9982030419811142e-05 + -5.529915036848096e-05i, 0.0016372866744613175 + 0.00034252497336978785i, -0.0003753793917849103 + 0.0002465378553420708i, 0.0014524997195309156 + -0.01185371119138188i, 0.0005995879623514372 + -0.0004269174343471725i, -0.0016480514026348107 + 0.019503289458924516i, -0.003397570227575251 + -0.00400888093933369i, 0.1397388556913462 + 5.456869141981696e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, true, false, true, false, false, false, false}), ElementsAreArray({ DoubleNear(0.10753265459598482, 1.0e-7), DoubleNear(0.11392768396293955, 1.0e-7), DoubleNear(0.15409078736569967, 1.0e-7), DoubleNear(0.16325465590482546, 1.0e-7), DoubleNear(0.09204325609834904, 1.0e-7), DoubleNear(0.09751712194859333, 1.0e-7), DoubleNear(0.13189498443226305, 1.0e-7), DoubleNear(0.1397388556913462, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, true, false, false, true, false, false, false}), Matrix({ { 0.1159009750421434 + 6.3792168840089494e-21i, -0.0030348030438982834 + 0.0031358675765744055i, -0.0019587407900085374 + -0.023180034640584622i, 0.000678457722520574 + 0.0005539598603658562i, 1.0842021724855044e-19 + -9.486769009248164e-20i, 1.7999450129153882e-20 + -8.046812998915853e-21i, -1.0164395367051604e-20 + -3.134021904840911e-20i, 3.1763735522036263e-22 + -3.255782891008717e-21i }, { -0.0030348030438982834 + -0.0031358675765744055i, 0.12423518751282549 + 4.690444945420688e-20i, -0.0005758806301438419 + 0.000659952958906538i, -0.002099590009896351 + -0.024846865602982972i, -2.456395547037471e-20 + -1.8634724839594607e-20i, 1.7618285302889447e-19 + -7.453889935837843e-20i, -8.470329472543003e-22 + 4.870439446712227e-21i, -1.6940658945086007e-21 + -3.3034284942917713e-20i }, { -0.001958740790008538 + 0.023180034640584622i, -0.0005758806301438418 + -0.000659952958906538i, 0.16608231767174317 + -5.638063055161437e-21i, -0.004348773796118761 + 0.004493595975700587i, 1.3552527156068805e-20 + 4.319868030996932e-20i, -8.999725064576941e-22 + 4.0234064994579266e-21i, 1.8295911660692887e-19 + -1.0842021724855044e-19i, 1.6517142471458857e-20 + 8.470329472543003e-22i }, { 0.000678457722520574 + -0.0005539598603658562i, -0.0020995900098963504 + 0.02484686560298297i, -0.0043487737961187605 + -0.004493595975700587i, 0.17802497236119957 + 5.749236129488564e-20i, 4.0234064994579266e-21 + -3.705769144237564e-21i, 1.4399560103323106e-20 + 2.879912020664621e-20i, -5.421010862427522e-20 + -2.202285662861181e-20i, 3.5236570605778894e-19 + -9.486769009248164e-20i }, { 8.809142651444724e-20 + 8.131516293641283e-20i, -2.879912020664621e-20 + 1.1011428314305904e-20i, 1.8634724839594607e-20 + -3.049318610115481e-20i, 4.7645603283054394e-21 + 7.093900933254765e-21i, 0.08367493565219045 + 1.3631936494873896e-21i, -0.0021062049727069427 + 0.0029301406782244748i, -0.0014141167449513636 + -0.016734871352559366i, 0.0006216192054380235 + 0.00037171834097988804i }, { 1.6305384234645282e-20 + -1.1434944787933055e-20i, 1.2874900798265365e-19 + 1.0164395367051604e-19i, -5.293955920339377e-22 + -3.970466940254533e-21i, 5.082197683525802e-21 + -4.573977915173222e-20i, -0.0021062049727069423 + -0.002930140678224475i, 0.08720961839870742 + -2.1279428053079775e-20i, -0.0005504289571996491 + 0.00047075781954880656i, -0.0014738533198406145 + -0.017441803011054455i }, { -1.1858461261560205e-20 + 3.6845933205562065e-20i, -2.117582368135751e-22 + -5.505714157152952e-21i, 2.371692252312041e-19 + 1.2197274440461925e-19i, -4.0657581468206416e-20 + 1.8634724839594607e-20i, -0.0014141167449513636 + 0.016734871352559366i, -0.0005504289571996491 + -0.0004707578195488066i, 0.11990345412621957 + -1.750975920652249e-20i, -0.003018123041947884 + 0.004198796039177606i }, { -1.0587911840678754e-21 + 2.8322664173815668e-21i, -1.6940658945086007e-20 + 2.371692252312041e-20i, 2.583450489125616e-20 + 1.6940658945086007e-21i, 3.2526065174565133e-19 + 1.3552527156068805e-19i, 0.0006216192054380234 + -0.00037171834097988804i, -0.0014738533198406147 + 0.017441803011054455i, -0.0030181230419478837 + -0.004198796039177606i, 0.12496853923497211 + 5.722228682488707e-21i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, true, false, false, true, false, false, false}), ElementsAreArray({ DoubleNear(0.1159009750421434, 1.0e-7), DoubleNear(0.12423518751282549, 1.0e-7), DoubleNear(0.16608231767174317, 1.0e-7), DoubleNear(0.17802497236119957, 1.0e-7), DoubleNear(0.08367493565219045, 1.0e-7), DoubleNear(0.08720961839870742, 1.0e-7), DoubleNear(0.11990345412621957, 1.0e-7), DoubleNear(0.12496853923497211, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, true, false, false, false, true, false, false}), Matrix({ { 0.09226697333382076 + -8.801201717564214e-21i, -0.0023755188041216183 + 0.0028063811523730857i, -0.0015602006413439307 + -0.018452545895939594i, 0.00060151087552511 + 0.00042765721520529826i, -0.018118483603261085 + -0.022381813348593505i, 0.0011557716673367933 + 3.690012592337557e-05i, -0.004174934761098601 + 0.004006823332824485i, -1.160987935649561e-05 + -0.00023192601271363226i }, { -0.0023755188041216183 + -0.0028063811523730857i, 0.0977526500114188 + 3.654897536565553e-21i, -0.0005210931870951932 + 0.000522441355848941i, -0.0016530089586074207 + -0.0195495916977421i, -0.00020733321645740953 + 0.0011145922031264581i, -0.019204974571973447 + -0.023711912520472i, 0.00022656058033554394 + 2.20841378781569e-05i, -0.004423137247737257 + 0.0042471552560803365i }, { -0.0015602006413439307 + 0.01845254589593959i, -0.0005210931870951932 + -0.0005224413558489411i, 0.13221542341103423 + -2.0871421215937994e-20i, -0.003404031004703949 + 0.0040214584590762895i, 0.004776801528425379 + -0.0032491844571348166i, -2.666068506930443e-05 + 0.00023103267803702317i, -0.025964040394335565 + -0.03207231831644451i, 0.0016562467571133149 + 5.2905017335406665e-05i }, { 0.00060151087552511 + -0.0004276572152052983i, -0.0016530089586074207 + 0.0195495916977421i, -0.003404031004703949 + -0.0040214584590762895i, 0.14007620323196235 + 3.8186379388204246e-20i, -0.00021885073489850946 + -6.027168099087387e-05i, 0.0050605296764496596 + -0.0034444305120665854i, -0.0002970455273057929 + 0.0015971331146729347i, -0.027521042457708433 + -0.033978296789553074i }, { -0.018118483603261085 + 0.02238181334859351i, -0.00020733321645740964 + -0.001114592203126458i, 0.00477680152842538 + 0.003249184457134816i, -0.00021885073489850943 + 6.02716809908739e-05i, 0.10730893736051307 + 1.6543612251060553e-20i, -0.0027654892124836074 + 0.003259627102425795i, -0.0018126568936159707 + -0.021462360097204397i, 0.0006985660524334875 + 0.0004980209861404458i }, { 0.0011557716673367933 + -3.6900125923375516e-05i, -0.019204974571973447 + 0.023711912520472i, -2.6660685069304445e-05 + -0.00023103267803702317i, 0.0050605296764496596 + 0.003444430512066585i, -0.0027654892124836074 + -0.003259627102425795i, 0.11369215590011407 + 2.1970123864561553e-20i, -0.0006052164002482977 + 0.0006082694226064037i, -0.0019204343711295446 + -0.022739076916295325i }, { -0.004174934761098601 + -0.004006823332824485i, 0.00022656058033554394 + -2.2084137878156904e-05i, -0.025964040394335565 + 0.03207231831644451i, -0.0002970455273057928 + -0.0015971331146729347i, -0.0018126568936159709 + 0.021462360097204397i, -0.0006052164002482978 + -0.0006082694226064035i, 0.15377034838692852 + -2.276401045745932e-21i, -0.003962865833362696 + 0.004670933555801903i }, { -1.1609879356495593e-05 + 0.0002319260127136322i, -0.004423137247737257 + -0.0042471552560803365i, 0.0016562467571133146 + -5.290501733540672e-05i, -0.027521042457708433 + 0.03397829678955307i, 0.0006985660524334875 + -0.0004980209861404458i, -0.0019204343711295446 + 0.022739076916295325i, -0.003962865833362695 + -0.004670933555801903i, 0.16291730836420937 + 2.5028210589170097e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, true, false, false, false, true, false, false}), ElementsAreArray({ DoubleNear(0.09226697333382076, 1.0e-7), DoubleNear(0.0977526500114188, 1.0e-7), DoubleNear(0.13221542341103423, 1.0e-7), DoubleNear(0.14007620323196235, 1.0e-7), DoubleNear(0.10730893736051307, 1.0e-7), DoubleNear(0.11369215590011407, 1.0e-7), DoubleNear(0.15377034838692852, 1.0e-7), DoubleNear(0.16291730836420937, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, true, false, false, false, false, true, false}), Matrix({ { 0.09817020199566512 + 9.237953080992213e-21i, -0.002528831228656883 + 0.0029838333374463968i, 0.00023535389298538783 + -0.025926748048752973i, 0.0007819676778139334 + 0.0006750177301063223i, -0.014651254607324275 + -0.006108282780430882i, 0.0005630695145890088 + -0.00028797012850576486i, -0.03666098937100126 + -0.003579663440998497i, 0.0010531767461525732 + -0.001022081197059305i }, { -0.002528831228656883 + -0.0029838333374463968i, 0.10400844087371472 + 5.544798441096083e-21i, -0.0007940929513138026 + 0.0006607108064632681i, 0.0002493505255703782 + -0.027468626799764508i, 0.00019175322055501597 + 0.0006026647289977307i, -0.015522573220526893 + -0.006471545901845333i, 0.0008355726484741141 + 0.00120650303818128i, -0.03884123968222089 + -0.003792548103011244i }, { 0.0002353538929853878 + 0.025926748048752973i, -0.0007940929513138026 + -0.0006607108064632682i, 0.129679745415899 + -9.151926297286698e-20i, -0.0033405064191115792 + 0.003941549876617419i, -0.011161468631796952 + -0.012358834129956375i, 0.0006631561349499027 + -2.0887768988030674e-05i, 0.02512050373058396 + 0.023664609456082408i, -0.0013663694501934854 + 0.0001539325861723306i }, { 0.0007819676778139334 + -0.0006750177301063224i, 0.0002493505255703782 + 0.027468626799764508i, -0.0033405064191115792 + -0.003941549876617419i, 0.13739187512523898 + -1.4861333680280833e-20i, -8.812481465153576e-05 + 0.000657606550497806i, -0.011825247648011723 + -0.013093821167143724i, 7.217807598611589e-05 + -0.0013731172713409051i, 0.026614434664153405 + 0.025071957512333334i }, { -0.014651254607324275 + 0.006108282780430882i, 0.00019175322055501595 + -0.0006026647289977307i, -0.011161468631796952 + 0.012358834129956373i, -8.812481465153576e-05 + -0.000657606550497806i, 0.10140570869866872 + -1.495542547495874e-21i, -0.0026121767879483423 + 0.003082174917352484i, -0.003608211427945289 + -0.013988157944391014i, 0.0005181092501446641 + 0.0002506604712394218i }, { 0.0005630695145890088 + 0.00028797012850576486i, -0.015522573220526893 + 0.006471545901845332i, 0.0006631561349499027 + 2.0887768988030674e-05i, -0.011825247648011723 + 0.013093821167143724i, -0.0026121767879483423 + -0.003082174917352484i, 0.10743636503781819 + 2.0080222960031023e-20i, -0.0003322166360296885 + 0.0004699999719920765i, -0.0038227938553073437 + -0.014820041814272916i }, { -0.03666098937100126 + 0.0035796634409984967i, 0.000835572648474114 + -0.00120650303818128i, 0.02512050373058396 + -0.023664609456082404i, 7.217807598611594e-05 + 0.0013731172713409047i, -0.0036082114279452895 + 0.013988157944391013i, -0.0003322166360296884 + -0.0004699999719920764i, 0.15630602638206376 + 6.837144071118306e-20i, -0.004026390418955066 + 0.004750842138260774i }, { 0.0010531767461525734 + 0.0010220811970593053i, -0.03884123968222089 + 0.0037925481030112434i, -0.0013663694501934854 + -0.0001539325861723305i, 0.026614434664153405 + -0.025071957512333334i, 0.0005181092501446641 + -0.0002506604712394218i, -0.0038227938553073437 + 0.014820041814272916i, -0.004026390418955066 + -0.004750842138260774i, 0.16560163647093273 + 7.807592365765518e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, true, false, false, false, false, true, false}), ElementsAreArray({ DoubleNear(0.09817020199566512, 1.0e-7), DoubleNear(0.10400844087371472, 1.0e-7), DoubleNear(0.129679745415899, 1.0e-7), DoubleNear(0.13739187512523898, 1.0e-7), DoubleNear(0.10140570869866872, 1.0e-7), DoubleNear(0.10743636503781819, 1.0e-7), DoubleNear(0.15630602638206376, 1.0e-7), DoubleNear(0.16560163647093273, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, true, false, false, false, false, false, true}), Matrix({ { 0.11082133347780279 + 6.2336330961996166e-21i, 0.0005392007218857121 + 0.0015616559431321862i, -0.0018728942203219683 + -0.022164113356226537i, 0.0003032164690395466 + -0.00013423157658211534i, -0.0068962428312104316 + -0.008773677861384357i, -0.002546922733571949 + 0.0033904130044582247i, -0.001638176077050997 + 0.0015275152634259969i, 0.0007211212184029267 + 0.0004520826241990651i }, { 0.0005392007218857121 + -0.0015616559431321864i, 0.10270361044094939 + -2.1133844265270442e-20i, -0.00032144158660349386 + -8.144722002842779e-05i, -0.0017357036985986168 + -0.02054057998104559i, -0.004453126971064056 + 0.010795646069434782i, -0.008763005632278047 + -0.005795163883667539i, 0.0022343726720516002 + 0.0007081714809357255i, -0.0010109288809145645 + 0.0018505279866504977i }, { -0.0018728942203219683 + 0.022164113356226537i, -0.00032144158660349386 + 8.144722002842776e-05i, 0.15880335695859432 + 1.1845226371759356e-20i, 0.0007726570509738481 + 0.0022378020404654653i, 0.0018712707878829659 + -0.0012309627849116523i, -0.0006350346010050414 + -0.0005666794210662696i, -0.009882091088691078 + -0.012572394263241821i, -0.0036496572213363353 + 0.004858351273059546i }, { 0.00030321646903954655 + 0.0001342315765821153i, -0.0017357036985986168 + 0.02054057998104559i, 0.0007726570509738479 + -0.002237802040465465i, 0.1471709245680326 + 5.3606059981958373e-20i, -0.0020838558806589706 + -0.0010730669842394431i, 0.0013071206354494389 + -0.0016546500161744697i, -0.006381185731802025 + 0.015469808768421685i, -0.012557101306956895 + -0.008304280863358694i }, { -0.006896242831210432 + 0.008773677861384357i, -0.004453126971064056 + -0.010795646069434782i, 0.0018712707878829659 + 0.0012309627849116523i, -0.0020838558806589706 + 0.001073066984239443i, 0.08875457721653104 + 1.5087774372967225e-21i, -0.005680208738490938 + 0.004504352311666694i, -0.0014999633146379329 + -0.01775079263691745i, 0.0009968604589190508 + 0.0010599097779278594i }, { -0.0025469227335719494 + -0.0033904130044582247i, -0.008763005632278047 + 0.005795163883667539i, -0.0006350346010050416 + 0.0005666794210662697i, 0.0013071206354494389 + 0.0016546500161744697i, -0.005680208738490938 + -0.004504352311666694i, 0.1087411954705835 + 4.675886566639755e-20i, -0.0008048680007399972 + 0.0012121579984837724i, -0.0018377396311383487 + -0.021748088632991835i }, { -0.0016381760770509965 + -0.001527515263425997i, 0.0022343726720516002 + -0.0007081714809357255i, -0.009882091088691078 + 0.012572394263241818i, -0.006381185731802025 + -0.015469808768421685i, -0.0014999633146379333 + 0.01775079263691745i, -0.0008048680007399971 + -0.0012121579984837724i, 0.12718241483936843 + -3.499304863344328e-20i, -0.008139553889040493 + 0.006454589974412728i }, { 0.0007211212184029267 + -0.0004520826241990651i, -0.0010109288809145647 + -0.0018505279866504977i, -0.0036496572213363353 + -0.004858351273059546i, -0.012557101306956895 + 0.008304280863358696i, 0.0009968604589190508 + -0.0010599097779278594i, -0.0018377396311383487 + 0.021748088632991835i, -0.008139553889040493 + -0.006454589974412728i, 0.15582258702813911 + 9.60852999541597e-21i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, true, false, false, false, false, false, true}), ElementsAreArray({ DoubleNear(0.11082133347780279, 1.0e-7), DoubleNear(0.10270361044094939, 1.0e-7), DoubleNear(0.15880335695859432, 1.0e-7), DoubleNear(0.1471709245680326, 1.0e-7), DoubleNear(0.08875457721653104, 1.0e-7), DoubleNear(0.1087411954705835, 1.0e-7), DoubleNear(0.12718241483936843, 1.0e-7), DoubleNear(0.15582258702813911, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, true, true, false, false, false, false}), Matrix({ { 0.09270656587180329 + 1.6278914455043585e-20i, -0.0023880898084380504 + 0.0028177688975384984i, 1.1926223897340549e-18 + -9.75781955236954e-19i, 1.3552527156068805e-20 + 5.251604272976662e-20i, 0.0008248234035418305 + 0.0067313048519107785i, -0.00022584175800747255 + -0.00014832605061534284i, 6.437450399132683e-20 + 4.404571325722362e-20i, -5.1880768019325896e-21 + 8.470329472543003e-22i }, { -0.0023880898084380504 + -0.0028177688975384984i, 0.09821987913917465 + -2.2051601154898027e-20i, -3.9810548520952116e-20 + -1.8634724839594607e-20i, 1.0842021724855044e-18 + -1.3010426069826053e-18i, 0.00018334741372374083 + -0.00019846622592236307i, 0.0008738761299719519 + 0.0071316194574380706i, -6.352747104407253e-22 + -2.541098841762901e-21i, 1.1519648082658485e-19 + 4.743384504624082e-20i }, { 8.673617379884035e-19 + 1.0842021724855044e-18i, -3.3457801416544863e-20 + 0.0i, 0.16891687608988118 + 9.820288232229545e-21i, -0.004351241645831785 + 0.005134142498316806i, -4.404571325722362e-20 + 6.776263578034403e-20i, -1.7999450129153882e-21 + -4.791030107907136e-21i, 0.001502877291828212 + 0.01226483773722932i, -0.0004114971134409374 + -0.00027025888487056696i }, { -1.1858461261560205e-20 + -6.437450399132683e-20i, 1.2468324983583301e-18 + 1.4094628242311558e-18i, -0.004351241645831786 + -0.005134142498316806i, 0.17896246072859034 + 6.854059914645015e-20i, 6.3527471044072525e-21 + -1.9058241313221758e-21i, -5.759824041329242e-20 + 4.743384504624082e-20i, 0.00033406989110350575 + -0.00036161726601449467i, 0.0015922542764500508 + 0.012994234754397769i }, { 0.0008248234035418312 + -0.006731304851910778i, 0.00018334741372374075 + 0.00019846622592236307i, -5.421010862427522e-20 + -8.131516293641283e-20i, 6.45862622281404e-21 + 8.470329472543003e-22i, 0.0793527716450094 + 1.61465655570351e-21i, -0.0020441005818164575 + 0.002411887116862665i, 8.673617379884035e-19 + -5.963111948670274e-19i, -3.3881317890172014e-21 + 7.538593230563273e-20i }, { -0.00022584175800747255 + 0.00014832605061534278i, 0.0008738761299719524 + -0.0071316194574380706i, 3.0704944337968387e-21 + 2.091112588534054e-21i, -4.743384504624082e-20 + -4.0657581468206416e-20i, -0.0020441005818164575 + -0.002411887116862665i, 0.08407192702088753 + -8.162411489520139e-21i, -3.3881317890172014e-20 + -1.1858461261560205e-20i, 9.215718466126788e-19 + -9.215718466126788e-19i }, { 6.776263578034403e-20 + -6.098637220230962e-20i, 1.164670302474663e-21 + 2.329340604949326e-21i, 0.0015028772918282132 + -0.01226483773722932i, 0.0003340698911035057 + 0.0003616172660144947i, 1.0299920638612292e-18 + 7.589415207398531e-19i, -3.8539999100070665e-20 + -2.1175823681357508e-20i, 0.1445854688856027 + -4.3119270971164227e-20i, -0.0037244728185855764 + 0.004394601756959103i }, { -1.1117307432712692e-21 + -1.5881867761018131e-21i, 8.809142651444724e-20 + -8.131516293641283e-20i, -0.00041149711344093734 + 0.00027025888487056685i, 0.0015922542764500516 + -0.012994234754397767i, 1.8634724839594607e-20 + -8.724439356719293e-20i, 1.0299920638612292e-18 + 8.673617379884035e-19i, -0.0037244728185855764 + -0.004394601756959104i, 0.15318405061905202 + 5.0513024876469465e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, true, true, false, false, false, false}), ElementsAreArray({ DoubleNear(0.09270656587180329, 1.0e-7), DoubleNear(0.09821987913917465, 1.0e-7), DoubleNear(0.16891687608988118, 1.0e-7), DoubleNear(0.17896246072859034, 1.0e-7), DoubleNear(0.0793527716450094, 1.0e-7), DoubleNear(0.08407192702088753, 1.0e-7), DoubleNear(0.1445854688856027, 1.0e-7), DoubleNear(0.15318405061905202, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, true, false, true, false, false, false}), Matrix({ { 0.09992110227093659 + -1.6887719385882613e-20i, -0.002616378897686123 + 0.0027035091353896728i, 3.2526065174565133e-19 + -2.4936649967166602e-18i, 8.555032767268433e-20 + 7.453889935837843e-20i, -2.168404344971009e-19 + -5.014435047745458e-19i, 1.6940658945086007e-20 + 0.0i, -0.0008243052512854792 + -0.0021431691024131607i, 0.0001835845478873546 + -8.657887878231142e-05i }, { -0.0026163788976861224 + -0.0027035091353896728i, 0.10710623333931571 + 1.0587911840678754e-20i, -7.623296525288703e-20 + 6.268043809681823e-20i, 5.421010862427522e-20 + -3.144186300207963e-18i, -6.606856988583543e-20 + 8.470329472543003e-21i, -1.4230153513872246e-19 + -6.776263578034403e-19i, -0.00038769063833032935 + 0.00013970096454391792i, -0.0005848836216221786 + -0.002844196628698172i }, { -1.0842021724855044e-19 + 2.710505431213761e-18i, -6.691560283308973e-20 + -1.0249098661777034e-19i, 0.18206219044295002 + 1.7628873214730126e-20i, -0.0047671979423309216 + 0.004925954416885319i, 0.00173993995684958 + -0.0014984197994532546i, 0.0001433893934854312 + 0.00014366165219043936i, 5.149960319306146e-19 + 3.083199928005653e-19i, 1.9481757786848908e-20 + -6.776263578034403e-21i }, { 7.707999820014133e-20 + -9.910285482875314e-20i, 0.0 + 2.4936649967166602e-18i, -0.0047671979423309216 + -0.004925954416885319i, 0.19515392653470934 + 9.380889890841376e-20i, -0.00026219630814555575 + -0.0003179205663972056i, 0.002480645192246508 + -0.0015092855076903804i, -1.8634724839594607e-20 + -4.404571325722362e-20i, 5.963111948670274e-19 + 5.251604272976662e-19i }, { -2.0328790734103208e-19 + 5.014435047745458e-19i, -6.098637220230962e-20 + -3.3881317890172014e-21i, 0.00173993995684958 + 0.0014984197994532544i, -0.0002621963081455557 + 0.0003179205663972057i, 0.07213823524587612 + 3.478129039662971e-20i, -0.0018158114925683855 + 0.002526146879011491i, 1.8973538018496328e-18 + 9.351243737687476e-19i, -7.453889935837843e-20 + 4.2351647362715017e-20i }, { 1.1858461261560205e-20 + -8.470329472543003e-21i, -1.5246593050577406e-19 + 7.589415207398531e-19i, 0.0001433893934854312 + -0.00014366165219043933i, 0.002480645192246508 + 0.0015092855076903802i, -0.0018158114925683855 + -0.002526146879011491i, 0.0751855728207465 + -4.080192448509692e-20i, -4.235164736271502e-21 + -9.147955830346444e-20i, 1.951563910473908e-18 + 8.673617379884035e-19i }, { -0.0008243052512854792 + 0.0021431691024131607i, -0.00038769063833032935 + -0.00013970096454391792i, 5.55653613398821e-19 + -3.049318610115481e-19i, -5.082197683525802e-21 + 3.218725199566341e-20i, 1.951563910473908e-18 + -7.047314121155779e-19i, -1.7787691892340307e-20 + 8.300922883092143e-20i, 0.13144015453253388 + -5.092785595366481e-20i, -0.003308516522086441 + 0.00460278983839059i }, { 0.00018358454788735458 + 8.65788787823114e-05i, -0.0005848836216221786 + 0.002844196628698172i, 3.3881317890172014e-20 + 4.235164736271502e-22i, 5.421010862427522e-19 + -4.573977915173222e-19i, -7.115076756936123e-20 + -4.743384504624082e-20i, 2.0599841277224584e-18 + -5.014435047745458e-19i, -0.003308516522086441 + -0.00460278983839059i, 0.13699258481293303 + 2.5244725114505852e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, true, false, true, false, false, false}), ElementsAreArray({ DoubleNear(0.09992110227093659, 1.0e-7), DoubleNear(0.10710623333931571, 1.0e-7), DoubleNear(0.18206219044295002, 1.0e-7), DoubleNear(0.19515392653470934, 1.0e-7), DoubleNear(0.07213823524587612, 1.0e-7), DoubleNear(0.0751855728207465, 1.0e-7), DoubleNear(0.13144015453253388, 1.0e-7), DoubleNear(0.13699258481293303, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, true, false, false, true, false, false}), Matrix({ { 0.07965120985795877 + -1.641126335305207e-21i, -0.0020554873391003007 + 0.0024151051498144827i, -0.0034308231353009206 + 0.002638737504276453i, 1.4091591951538213e-05 + -0.0001864993423249947i, -0.014986175030246933 + -0.019363778105669666i, 0.0009486051794390298 + 1.0522483507544907e-05i, -0.019376052126827747 + -0.006376347674765224i, 0.0006943869850889834 + -0.000432951653105041i }, { -0.002055487339100301 + -0.0024151051498144827i, 0.08439254373819921 + -5.9172365118980835e-21i, 0.0001531708047883193 + 3.707439916136641e-05i, -0.003629172560165778 + 0.0028037362916173347i, -0.00022097427955984663 + 0.0009918421361712795i, -0.015850795780003694 + -0.020518201150377i, 0.00029721003404840945 + 0.0007554113781254697i, -0.020524378546218545 + -0.006751932639178541i }, { -0.003430823135300921 + -0.0026387375042764526i, 0.0001531708047883193 + -3.707439916136643e-05i, 0.14483118688689622 + -2.8031496598197e-20i, -0.003724062469725266 + 0.004412734461634892i, -0.0004510260324687966 + -0.02057481093406225i, 0.0006286923503728924 + 0.0005177067360824782i, -0.02909634896734972 + -0.035090353559368355i, 0.0018634132450110784 + 7.928265975123728e-05i }, { 1.4091591951538186e-05 + 0.00018649934232499468i, -0.003629172560165778 + -0.0028037362916173347i, -0.003724062469725266 + -0.004412734461634892i, 0.15343630950518194 + 4.775851343666788e-20i, -0.0006089081022113865 + 0.0005505865268155133i, -0.00047578148583920414 + -0.021803372875994605i, -0.0002834044642033559 + 0.0017198831816281133i, -0.030875221249678182 + -0.03717200815964808i }, { -0.014986175030246933 + 0.019363778105669666i, -0.00022097427955984666 + -0.0009918421361712795i, -0.0004510260324687963 + 0.020574810934062247i, -0.0006089081022113865 + -0.0005505865268155133i, 0.09240812765885392 + 1.9534697346052302e-20i, -0.0023767030511542076 + 0.0028145508645866808i, 0.0034308231353009228 + -0.0026387375042764543i, -1.4091591951538213e-05 + 0.00018649934232499484i }, { 0.0009486051794390297 + -1.0522483507544907e-05i, -0.015850795780003694 + 0.020518201150376995i, 0.0006286923503728925 + -0.0005177067360824782i, -0.00047578148583920393 + 0.021803372875994605i, -0.0023767030511542067 + -0.0028145508645866808i, 0.097899262421863 + -2.4296776132520082e-20i, -0.00015317080478831935 + -3.707439916136644e-05i, 0.00362917256016578 + -0.0028037362916173373i }, { -0.019376052126827747 + 0.006376347674765223i, 0.0002972100340484095 + -0.0007554113781254697i, -0.029096348967349722 + 0.03509035355936836i, -0.0002834044642033557 + -0.0017198831816281133i, 0.0034308231353009228 + 0.002638737504276455i, -0.00015317080478831932 + 3.707439916136641e-05i, 0.16867115808858768 + -5.26748614073768e-21i, -0.004351651994692097 + 0.005116009793641017i }, { 0.0006943869850889834 + 0.00043295165310504107i, -0.020524378546218545 + 0.006751932639178541i, 0.0018634132450110784 + -7.928265975123733e-05i, -0.030875221249678186 + 0.03717200815964808i, -1.4091591951538173e-05 + -0.00018649934232499484i, 0.00362917256016578 + 0.0028037362916173373i, -0.004351651994692097 + -0.005116009793641017i, 0.17871020184246042 + 7.129511058625173e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, true, false, false, true, false, false}), ElementsAreArray({ DoubleNear(0.07965120985795877, 1.0e-7), DoubleNear(0.08439254373819921, 1.0e-7), DoubleNear(0.14483118688689622, 1.0e-7), DoubleNear(0.15343630950518194, 1.0e-7), DoubleNear(0.09240812765885392, 1.0e-7), DoubleNear(0.097899262421863, 1.0e-7), DoubleNear(0.16867115808858768, 1.0e-7), DoubleNear(0.17871020184246042, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, true, false, false, false, true, false}), Matrix({ { 0.08005593437687691 + -1.197757526976784e-20i, -0.002062213816168902 + 0.0024332593903055658i, 9.75781955236954e-19 + -7.589415207398531e-19i, 2.371692252312041e-20 + 4.743384504624082e-20i, 0.004425668863716253 + 0.006732095980248269i, -0.0003186223661676375 + -3.890056427999255e-05i, 1.7618285302889447e-19 + 6.437450399132683e-20i, -9.952637130238029e-21 + 6.776263578034403e-21i }, { -0.002062213816168902 + -0.0024332593903055658i, 0.08481690724844448 + -5.1014709917982876e-20i, -2.1175823681357508e-20 + 0.0i, 9.75781955236954e-19 + -1.1926223897340549e-18i, 9.061489745010793e-05 + -0.00030793247065496733i, 0.004688865959130834 + 0.007132457634636862i, -3.1763735522036263e-21 + -2.752857078576476e-21i, 1.6263032587282567e-19 + 4.743384504624082e-20i }, { 7.589415207398531e-19 + 9.75781955236954e-19i, -2.879912020664621e-20 + -1.3552527156068805e-20i, 0.1477940130346872 + -7.030373462210693e-20i, -0.0038071238315995604 + 0.00449212382375825i, -4.0657581468206416e-20 + 1.4907779871675686e-19i, -6.988021814847978e-21 + -2.964615315390051e-21i, 0.006043580259543432 + 0.010824230695403256i, -0.0004846775694368394 + -9.51369780534417e-05i }, { 3.3881317890172014e-21 + -6.098637220230962e-20i, 9.75781955236954e-19 + 1.1926223897340549e-18i, -0.003807123831599561 + -0.00449212382375825i, 0.15658340875050922 + 4.1698174678798125e-20i, 1.1011428314305904e-20 + -6.1409888675936775e-21i, -7.453889935837843e-20 + 9.486769009248164e-20i, 0.00017331639909102392 + -0.0004625200716882071i, 0.006402995484495679 + 0.011467953975851139i }, { 0.004425668863716253 + -0.006732095980248269i, 9.061489745010797e-05 + 0.0003079324706549672i, -8.131516293641283e-20 + -9.486769009248164e-20i, 9.740878893424454e-21 + 4.235164736271502e-21i, 0.0920034031399358 + 2.9871146280514935e-20i, -0.002369976574085606 + 0.002796396624095598i, 1.0842021724855044e-18 + -8.673617379884035e-19i, -1.6940658945086007e-20 + 7.962109704190423e-20i }, { -0.00031862236616763746 + 3.890056427999262e-05i, 0.004688865959130833 + -0.007132457634636862i, -2.329340604949326e-21 + 4.9763185651190145e-21i, -5.421010862427522e-20 + -1.0842021724855044e-19i, -0.002369976574085606 + -0.002796396624095598i, 0.09747489891161773 + 2.080069727356471e-20i, -5.251604272976662e-20 + -3.049318610115481e-20i, 9.75781955236954e-19 + -1.0842021724855044e-18i }, { 1.7618285302889447e-19 + -7.792703114739563e-20i, -1.4823076576950256e-21 + -4.235164736271502e-21i, 0.006043580259543432 + -0.010824230695403253i, 0.0001733163990910239 + 0.0004625200716882069i, 8.673617379884035e-19 + 1.0842021724855044e-18i, -4.2351647362715017e-20 + -8.470329472543003e-21i, 0.1657083319407967 + 3.7004751883172246e-20i, -0.0042685906328178026 + 0.0050366204315176605i }, { -4.235164736271502e-22 + -9.317362419797304e-21i, 2.168404344971009e-19 + -4.743384504624082e-20i, -0.00048467756943683924 + 9.513697805344174e-05i, 0.006402995484495679 + -0.01146795397585114i, 3.3881317890172014e-21 + -8.300922883092143e-20i, 9.75781955236954e-19 + 8.673617379884035e-19i, -0.0042685906328178026 + -0.0050366204315176605i, 0.17556310259713317 + 7.735544934412149e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, true, false, false, false, true, false}), ElementsAreArray({ DoubleNear(0.08005593437687691, 1.0e-7), DoubleNear(0.08481690724844448, 1.0e-7), DoubleNear(0.1477940130346872, 1.0e-7), DoubleNear(0.15658340875050922, 1.0e-7), DoubleNear(0.0920034031399358, 1.0e-7), DoubleNear(0.09747489891161773, 1.0e-7), DoubleNear(0.1657083319407967, 1.0e-7), DoubleNear(0.17556310259713317, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, true, false, false, false, false, true}), Matrix({ { 0.09554181741966056 + 5.2145465815342865e-21i, 0.0004648583021541826 + 0.0013463422818400595i, 1.0842021724855044e-18 + -8.673617379884035e-19i, 2.371692252312041e-20 + 3.218725199566341e-20i, -0.005945421813509598 + -0.007564005070370336i, -0.0021957651939069458 + 0.0029229590556593696i, -1.8973538018496328e-19 + 6.776263578034403e-21i, -1.7787691892340307e-20 + 1.5585406229479126e-19i }, { 0.0004648583021541826 + -0.0013463422818400593i, 0.08854332725615997 + -3.4398305773017656e-21i, 7.623296525288703e-21 + -2.371692252312041e-20i, 9.75781955236954e-19 + -1.1926223897340549e-18i, -0.0038391510972134854 + 0.009307193960987736i, -0.00755480427723117 + -0.004996154371317647i, 1.0842021724855044e-19 + 1.3552527156068805e-19i, -1.7618285302889447e-19 + 3.049318610115481e-20i }, { 8.673617379884035e-19 + 1.0842021724855044e-18i, 1.0164395367051604e-20 + -1.1858461261560205e-20i, 0.17408287301673653 + 1.2864312886424686e-20i, 0.0008469994707053776 + 0.002453115701757592i, -1.6940658945086007e-20 + -1.3552527156068805e-19i, -4.743384504624082e-20 + 3.3881317890172014e-20i, -0.010832912106391913 + -0.013782067054255841i, -0.0040008147610013384 + 0.005325805221858401i }, { 3.3881317890172014e-20 + -4.912791094074942e-20i, 1.0842021724855044e-18 + 9.75781955236954e-19i, 0.0008469994707053774 + -0.002453115701757592i, 0.161331207752822 + 3.5912046293989697e-20i, -1.0842021724855044e-19 + 6.098637220230962e-20i, -2.0328790734103208e-20 + -9.486769009248164e-20i, -0.006995161605652597 + 0.016958260876868733i, -0.013765302662003771 + -0.009103290375708587i }, { -0.005945421813509597 + 0.007564005070370336i, -0.003839151097213486 + -0.009307193960987736i, 6.776263578034403e-21 + 1.2197274440461925e-19i, -1.3552527156068805e-19 + -7.453889935837843e-20i, 0.07651752009715214 + 1.2679024429212808e-20i, -0.0048970486924086905 + 0.0038833137325611044i, 9.75781955236954e-19 + -7.589415207398531e-19i, -1.6940658945086007e-20 + 9.486769009248164e-20i }, { -0.0021957651939069458 + -0.0029229590556593696i, -0.00755480427723117 + 0.004996154371317647i, -3.3881317890172014e-21 + -7.792703114739563e-20i, -4.0657581468206416e-20 + 1.0842021724855044e-19i, -0.0048970486924086905 + -0.0038833137325611044i, 0.09374847890390223 + -2.67741820671164e-20i, -8.131516293641283e-20 + -6.776263578034403e-21i, 9.75781955236954e-19 + -1.0842021724855044e-18i }, { -1.6263032587282567e-19 + 4.743384504624082e-20i, 8.809142651444724e-20 + -1.3552527156068805e-19i, -0.010832912106391913 + 0.013782067054255841i, -0.006995161605652597 + -0.016958260876868733i, 7.589415207398531e-19 + 9.75781955236954e-19i, -8.131516293641283e-20 + -1.0164395367051604e-20i, 0.13941947195874735 + -4.616329562535937e-20i, -0.00892271393512274 + 0.007075628553518318i }, { -5.082197683525802e-21 + -6.098637220230962e-20i, -1.6263032587282567e-19 + -4.0657581468206416e-20i, -0.004000814761001339 + -0.005325805221858401i, -0.013765302662003771 + 0.009103290375708587i, -2.710505431213761e-20 + -9.486769009248164e-20i, 8.673617379884035e-19 + 1.0842021724855044e-18i, -0.00892271393512274 + -0.007075628553518318i, 0.1708153035948204 + 8.314157772892992e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, true, false, false, false, false, true}), ElementsAreArray({ DoubleNear(0.09554181741966056, 1.0e-7), DoubleNear(0.08854332725615997, 1.0e-7), DoubleNear(0.17408287301673653, 1.0e-7), DoubleNear(0.161331207752822, 1.0e-7), DoubleNear(0.07651752009715214, 1.0e-7), DoubleNear(0.09374847890390223, 1.0e-7), DoubleNear(0.13941947195874735, 1.0e-7), DoubleNear(0.1708153035948204, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, false, true, true, false, false, false}), Matrix({ { 0.15193422849354798 + -8.92031572577185e-21i, -0.003978313891983195 + 0.004110799074222811i, 0.0013517802787975583 + 0.01103174947548132i, -0.0003338754689834096 + -0.00025228590984802184i, 1.9989977555201488e-19 + -1.2197274440461925e-19i, 1.6940658945086007e-20 + 4.235164736271502e-22i, 4.235164736271502e-21 + 5.293955920339377e-21i, 4.764560328305439e-22 + 2.541098841762901e-21i }, { -0.003978313891983195 + -0.004110799074222811i, 0.16285952175681828 + 1.122318655111948e-20i, 0.00026308422838711935 + -0.0003254346291817912i, 0.0014489841552367355 + 0.01182502100765407i, -4.573977915173222e-20 + -1.9481757786848908e-20i, 2.710505431213761e-19 + -8.131516293641283e-20i, 9.529120656610879e-22 + -2.329340604949326e-21i, 8.470329472543003e-22 + 1.3129010682441655e-20i }, { 0.001351780278797559 + -0.011031749475481318i, 0.0002630842283871193 + 0.00032543462918179113i, 0.13004906422033857 + 9.661469554619363e-21i, -0.0034052629480338494 + 0.0035186644780521806i, -5.082197683525802e-21 + -1.1858461261560205e-20i, 3.1763735522036263e-22 + -1.852884572118782e-21i, 9.825582188149884e-20 + -8.131516293641283e-20i, 2.414043899674756e-20 + -7.623296525288703e-21i }, { -0.00033387546898340953 + 0.0002522859098480218i, 0.0014489841552367362 + -0.011825021007654068i, -0.0034052629480338494 + -0.003518664478052181i, 0.13940063811720677 + 9.317362419797304e-20i, -1.376428539288238e-21 + 3.705769144237564e-21i, 8.470329472543003e-22 + -2.0328790734103208e-20i, -3.7269449679189215e-20 + -1.7787691892340307e-20i, 2.507217523872729e-19 + -8.809142651444724e-20i }, { 1.1519648082658485e-19 + 1.2197274440461925e-19i, -2.710505431213761e-20 + 7.623296525288703e-21i, -1.1011428314305904e-20 + 1.5670109524204556e-20i, -8.470329472543003e-22 + -2.117582368135751e-21i, 0.10968921346813648 + 3.501951841304498e-20i, -0.002761017562286641 + 0.003841112321632493i, 0.0009759204165724848 + 0.007964393113658779i, -0.00030346340246500036 + -0.00016629902563788793i }, { 2.795208725939191e-20 + -2.541098841762901e-21i, 2.0328790734103208e-19 + 1.3552527156068805e-19i, -1.2176098616780567e-21 + 2.117582368135751e-21i, -9.317362419797304e-21 + 2.0328790734103208e-20i, -0.002761017562286641 + -0.003841112321632493i, 0.11432281811094674 + 3.5265811440432644e-20i, 0.00025433307644012726 + -0.00023464886275506661i, 0.0010171462511852673 + 0.00830083320418177i }, { 1.0164395367051604e-20 + -5.293955920339377e-21i, 3.1763735522036263e-22 + 1.6940658945086007e-21i, 1.9651164376299768e-19 + 8.131516293641283e-20i, -3.5575383784680614e-20 + 2.1175823681357508e-20i, 0.0009759204165724853 + -0.007964393113658779i, 0.00025433307644012716 + 0.00023464886275506667i, 0.09388917631027352 + -5.116608397008008e-20i, -0.002363310452368185 + 0.0032878243957695876i }, { 1.5352472168984194e-21 + -3.0969642133985356e-21i, 1.8634724839594607e-20 + -1.3552527156068805e-20i, 1.1858461261560205e-20 + -8.046812998915853e-21i, 1.8973538018496328e-19 + 1.3552527156068805e-19i, -0.00030346340246500036 + 0.00016629902563788782i, 0.0010171462511852675 + -0.00830083320418177i, -0.0023633104523681846 + -0.0032878243957695876i, 0.09785533952273279 + -5.082301081102371e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, false, true, true, false, false, false}), ElementsAreArray({ DoubleNear(0.15193422849354798, 1.0e-7), DoubleNear(0.16285952175681828, 1.0e-7), DoubleNear(0.13004906422033857, 1.0e-7), DoubleNear(0.13940063811720677, 1.0e-7), DoubleNear(0.10968921346813648, 1.0e-7), DoubleNear(0.11432281811094674, 1.0e-7), DoubleNear(0.09388917631027352, 1.0e-7), DoubleNear(0.09785533952273279, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, false, true, false, true, false, false}), Matrix({ { 0.12095241328506014 + 3.2954875604112623e-21i, -0.0031140548533665014 + 0.0036788794600530607i, 0.0010761306953203063 + 0.008782199607327618i, -0.0002948249050646032 + -0.000193376019244541i, -0.023751918807540504 + -0.029340200985624558i, 0.0015151317857046557 + 4.838753042585395e-05i, 0.0019190301902143646 + -0.0019856402728098575i, 9.966984854659934e-06 + 0.00011044228649447725i }, { -0.0031140548533665014 + -0.0036788794600530607i, 0.12814356121340126 + 1.8739156391929427e-20i, 0.00023941253380879468 + -0.0002588390390193684i, 0.0011401113535816553 + 0.009304339635767322i, -0.00027176218337148764 + 0.0014610932799636123i, -0.025176248137453887 + -0.03108381833119261i, -0.00010850601571700803 + -6.732750432000609e-06i, 0.0020329595503746772 + -0.00210457220841685i }, { 0.0010761306953203068 + -0.008782199607327618i, 0.00023941253380879463 + 0.00025883903901936843i, 0.10352998345979487 + -3.296811049391347e-20i, -0.002665494955459066 + 0.003148960151396314i, -0.0023416785393847103 + 0.0014635524528159808i, 1.6993697909222436e-05 + -0.00010958126511676756i, -0.020330605190056146 + -0.025113930679413463i, 0.0012968866387454525 + 4.141761283292826e-05i }, { -0.0002948249050646032 + 0.00019337601924454092i, 0.0011401113535816558 + -0.009304339635767322i, -0.002665494955459066 + -0.003148960151396314i, 0.10968529202997991 + 2.3102120532840372e-20i, 0.00010367020269913833 + 3.2731856767967874e-05i, -0.002480952817774184 + 0.0015514579690982684i, -0.00023261656039171488 + 0.0012506320378357803i, -0.021549768892227993 + -0.026606390978832464i }, { -0.023751918807540504 + 0.02934020098562456i, -0.0002717621833714876 + -0.0014610932799636125i, -0.0023416785393847103 + -0.0014635524528159812i, 0.00010367020269913836 + -3.2731856767967874e-05i, 0.14067102867662434 + 2.2803715126861867e-20i, -0.0036252766009033342 + 0.004273031935802243i, 0.0012515700000497367 + 0.01021394298181248i, -0.0003425139663838067 + -0.0002252089162413688i }, { 0.0015151317857046555 + -4.838753042585395e-05i, -0.025176248137453887 + 0.03108381833119261i, 1.699369790922245e-05 + 0.00010958126511676758i, -0.002480952817774184 + -0.0015514579690982687i, -0.0036252766009033342 + -0.004273031935802243i, 0.14903877865436377 + 2.7749841599622696e-20i, 0.00027800477101845193 + -0.00030124445291748937i, 0.0013260190528403474 + 0.010821514576068517i }, { 0.0019190301902143642 + 0.001985640272809857i, -0.00010850601571700798 + 6.732750432000587e-06i, -0.020330605190056146 + 0.025113930679413463i, -0.00023261656039171483 + -0.0012506320378357803i, 0.0012515700000497376 + -0.010213942981812479i, 0.0002780047710184519 + 0.00030124445291748937i, 0.12040825707081723 + -8.536503921547246e-21i, -0.0031030784449429683 + 0.0036575287224254547i }, { 9.96698485465994e-06 + -0.00011044228649447723i, 0.002032959550374677 + 0.0021045722084168505i, 0.0012968866387454525 + -4.141761283292826e-05i, -0.021549768892227993 + 0.026606390978832464i, -0.0003425139663838067 + 0.00022520891624136876i, 0.001326019052840348 + -0.010821514576068517i, -0.0031030784449429683 + -0.0036575287224254547i, 0.12757068560995966 + 1.9248492854108954e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, false, true, false, true, false, false}), ElementsAreArray({ DoubleNear(0.12095241328506014, 1.0e-7), DoubleNear(0.12814356121340126, 1.0e-7), DoubleNear(0.10352998345979487, 1.0e-7), DoubleNear(0.10968529202997991, 1.0e-7), DoubleNear(0.14067102867662434, 1.0e-7), DoubleNear(0.14903877865436377, 1.0e-7), DoubleNear(0.12040825707081723, 1.0e-7), DoubleNear(0.12757068560995966, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, false, true, false, false, true, false}), Matrix({ { 0.12276686905488662 + -1.962734157465824e-20i, -0.003162433060126905 + 0.0037314365171221956i, 0.001092274164443237 + 0.008913944913737737i, -0.00029907143330892816 + -0.00019642109123643752i, 0.005640891959025207 + 0.00945945032052763i, -0.0004328226498469161 + -7.222020279146393e-05i, -0.0006366507439822352 + 0.0004937399955597445i, 1.3929320870110003e-06 + -3.206925085018828e-05i }, { -0.003162433060126905 + -0.0037314365171221956i, 0.13006788599569225 + -2.9542548782178245e-20i, 0.0002427982065833454 + -0.0002628193261232528i, 0.001157232342818211 + 0.009444062390265635i, 0.0001422077085821047 + -0.00041512428443970064i, 0.005976359077077102 + 0.010022009320138546i, 3.140688395494859e-05 + 6.632099979020131e-06i, -0.0006745127331571215 + 0.0005231029995989155i }, { 0.0010922741644432373 + -0.008913944913737737i, 0.00024279820658334534 + 0.0002628193261232528i, 0.10508307835667749 + -6.265396831721653e-20i, -0.0027069045876415574 + 0.0031939466969416195i, 0.0007370263681012179 + -0.00032541586585782556i, -9.094700517747574e-06 + 3.078414417169671e-05i, 0.004828357164234479 + 0.008096876355123895i, -0.00037047728575756076 + -6.181733954197029e-05i }, { -0.00029907143330892816 + 0.00019642109123643752i, 0.0011572323428182111 + -0.009444062390265635i, -0.0027069045876415574 + -0.0031939466969416195i, 0.11133243000326143 + 2.0226013542993494e-20i, -2.887639983875824e-05 + -1.4018938698899034e-05i, 0.0007808577538875712 + -0.00034476853622993325i, 0.00012172358795902715 + -0.00035532825790347367i, 0.005115502366549411 + 0.008578402290349455i }, { 0.005640891959025207 + -0.009459450320527628i, 0.0001422077085821047 + 0.00041512428443970053i, 0.0007370263681012179 + 0.0003254158658578256i, -2.8876399838758246e-05 + 1.4018938698899038e-05i, 0.13885657290679787 + 4.572654426193137e-20i, -0.0035768983941429308 + 0.004220474878733109i, 0.001235426530926806 + 0.010082197675402362i, -0.0003382674381394818 + -0.00022216384424947222i }, { -0.000432822649846916 + 7.222020279146396e-05i, 0.005976359077077102 + -0.010022009320138546i, -9.094700517747567e-06 + -3.0784144171696705e-05i, 0.0007808577538875712 + 0.00034476853622993314i, -0.0035768983941429308 + -0.004220474878733109i, 0.14711445387207278 + 7.603154677373037e-20i, 0.0002746190982439012 + -0.00029726416581360497i, 0.0013088980636037917 + 0.010681791821570204i }, { -0.0006366507439822352 + -0.0004937399955597445i, 3.140688395494858e-05 + -6.632099979020126e-06i, 0.004828357164234479 + -0.008096876355123895i, 0.00012172358795902715 + 0.0003553282579034736i, 0.001235426530926807 + -0.010082197675402362i, 0.0002746190982439011 + 0.00029726416581360497i, 0.1188551621739346 + 2.1149353901755812e-20i, -0.0030616688127604766 + 0.003612542176880149i }, { 1.3929320870110062e-06 + 3.2069250850188265e-05i, -0.0006745127331571218 + -0.0005231029995989155i, -0.0003704772857575607 + 6.18173395419704e-05i, 0.00511550236654941 + -0.008578402290349455i, -0.0003382674381394818 + 0.0002221638442494722i, 0.0013088980636037926 + -0.010681791821570204i, -0.0030616688127604766 + -0.0036125421768801493i, 0.12592354763667812 + 2.212459984395583e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, false, true, false, false, true, false}), ElementsAreArray({ DoubleNear(0.12276686905488662, 1.0e-7), DoubleNear(0.13006788599569225, 1.0e-7), DoubleNear(0.10508307835667749, 1.0e-7), DoubleNear(0.11133243000326143, 1.0e-7), DoubleNear(0.13885657290679787, 1.0e-7), DoubleNear(0.14711445387207278, 1.0e-7), DoubleNear(0.1188551621739346, 1.0e-7), DoubleNear(0.12592354763667812, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, false, true, false, false, false, true}), Matrix({ { 0.14527534213110607 + 2.329340604949326e-20i, 0.000706836552954635 + 0.0020471699293804738i, 0.0012925352268250514 + 0.010548256276716843i, -0.00014235355848708789 + 6.953645544486954e-05i, -0.009040263325508094 + -0.011501387080097012i, -0.0033387531072730492 + 0.0044444818856747914i, 0.0007546684663915497 + -0.0007587313903922213i, -0.00035241348738963493 + -0.00020287939842799738i }, { 0.0007068365529546347 + -0.0020471699293804738i, 0.13463384419478452 + 1.2528270762575019e-20i, 0.0001549312076724115 + 3.310853574142455e-05i, 0.0011978563174718816 + 0.00977559075926673i, -0.005837590326452489 + 0.014151978929017336i, -0.011487396888081942 + -0.007596862350282586i, -0.0010794949053443375 + -0.00029794779259786886i, 0.0004493934405498599 + -0.0009016755122195061i }, { 0.001292535226825052 + -0.010548256276716843i, 0.00015493120767241144 + -3.3108535741424546e-05i, 0.12434934830529104 + -5.2145465815342865e-21i, 0.0006050212199049254 + 0.0017522880542171775i, -0.0009155334643545022 + 0.0005540724614879629i, 0.000293002771964474 + 0.0002819657639178291i, -0.007738070594393416 + -0.009844685044529166i, -0.002857826847635235 + 0.003804282391842979i }, { -0.00014235355848708786 + -6.95364554448696e-05i, 0.0011978563174718823 + -0.00977559075926673i, 0.0006050212199049253 + -0.0017522880542171775i, 0.11524069081419744 + 1.9943944954112912e-20i, 0.0009756191749412574 + 0.00054977210120673i, -0.0006538034240275336 + 0.0007664947987269205i, -0.004996722376413593 + 0.012113475908839133i, -0.009832710051153 + -0.006502582396743648i }, { -0.009040263325508094 + 0.011501387080097014i, -0.0058375903264524884 + -0.014151978929017334i, -0.0009155334643545022 + -0.0005540724614879631i, 0.0009756191749412574 + -0.0005497721012067299i, 0.11634809983057842 + 2.80579663777987e-21i, -0.0074461680072244706 + 0.005904741466474831i, 0.0010351654685449917 + 0.008447886312423256i, -0.0004949853129613221 + -0.0004881213909307793i }, { -0.0033387531072730497 + -0.0044444818856747914i, -0.011487396888081942 + 0.007596862350282586i, 0.000293002771964474 + -0.00028196576391782897i, -0.0006538034240275335 + -0.0007664947987269205i, -0.0074461680072244706 + -0.005904741466474831i, 0.1425484956729805 + 3.3960727228977104e-20i, 0.00036248609715483515 + -0.0005931920276782824i, 0.001268274088950121 + 0.010350263452569109i }, { 0.0007546684663915496 + 0.0007587313903922213i, -0.0010794949053443375 + 0.00029794779259786875i, -0.007738070594393416 + 0.009844685044529164i, -0.004996722376413593 + -0.012113475908839134i, 0.0010351654685449923 + -0.008447886312423256i, 0.00036248609715483504 + 0.0005931920276782824i, 0.09958889222532107 + -3.629006783392643e-20i, -0.006373594620306959 + 0.005054200819604591i }, { -0.0003524134873896349 + 0.00020287939842799738i, 0.0004493934405498599 + 0.0009016755122195061i, -0.0028578268476352354 + -0.003804282391842979i, -0.009832710051153 + 0.006502582396743648i, -0.0004949853129613221 + 0.0004881213909307793i, 0.0012682740889501216 + -0.010350263452569109i, -0.006373594620306959 + -0.005054200819604591i, 0.12201528682574211 + 2.2406668432836414e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, false, true, false, false, false, true}), ElementsAreArray({ DoubleNear(0.14527534213110607, 1.0e-7), DoubleNear(0.13463384419478452, 1.0e-7), DoubleNear(0.12434934830529104, 1.0e-7), DoubleNear(0.11524069081419744, 1.0e-7), DoubleNear(0.11634809983057842, 1.0e-7), DoubleNear(0.1425484956729805, 1.0e-7), DoubleNear(0.09958889222532107, 1.0e-7), DoubleNear(0.12201528682574211, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, false, false, true, true, false, false}), Matrix({ { 0.12993751425944353 + -1.7893571010747095e-20i, -0.003400524790074653 + 0.003518380529188458i, -0.00033960353800286086 + 0.0006233741643451463i, -7.11540144383147e-05 + -9.433733130398092e-06i, -0.028169019735040504 + -0.03134863647677966i, 0.0015984481924730756 + 7.395164339486883e-05i, -0.003715388970011106 + 0.0014143577621733776i, -0.0001542958947228717 + -0.00030794564910327103i }, { -0.003400524790074653 + -0.003518380529188458i, 0.1392814073398838 + 5.52688998083431e-20i, 0.00013017947273671315 + 4.319865288595623e-05i, -0.0005456249979440555 + 0.0007084364902457186i, -0.0001014320134016879 + 0.001565405382523946i, -0.030192553068190027 + -0.03360307452599249i, 0.00024761438453858094 + 0.0006590175178749873i, -0.004923798688070822 + 0.0009953900699468327i }, { -0.00033960353800286086 + -0.0006233741643451463i, 0.00013017947273671313 + -4.319865288595626e-05i, 0.0945448824854115 + -1.1779051922755114e-20i, -0.0023790250187509143 + 0.0033094590822609167i, 0.0024318706351875298 + -0.0029167123473634446i, 0.0005454565586942138 + 0.0004335549000303222i, -0.01591350426255615 + -0.023105495188258364i, 0.0012135702319770326 + 1.5853499863913417e-05i }, { -7.115401443831467e-05 + 9.433733130398098e-06i, -0.0005456249979440556 + -0.0007084364902457185i, -0.0023790250187509143 + -0.0033094590822609167i, 0.09854744590349734 + -1.3427622883573298e-20i, -0.00025073564459178433 + -0.00024041443531656542i, 0.002433901399135844 + -0.004143212646753229i, -0.0004029467303615146 + 0.0011463199352754465i, -0.016533463961491853 + -0.024087134784032585i }, { -0.028169019735040504 + 0.03134863647677966i, -0.0001014320134016879 + -0.001565405382523946i, 0.0024318706351875298 + 0.0029167123473634446i, -0.00025073564459178444 + 0.0002404144353165655i, 0.1520457784544431 + 1.8634724839594607e-20i, -0.003983052049942391 + 0.004111083023086534i, 0.00033960353800286113 + -0.0006233741643451464i, 7.115401443831472e-05 + 9.433733130398086e-06i }, { 0.0015984481924730754 + -7.395164339486879e-05i, -0.030192553068190027 + 0.03360307452599248i, 0.0005454565586942138 + -0.0004335549000303222i, 0.0024339013991358446 + 0.004143212646753229i, -0.003983052049942391 + -0.004111083023086534i, 0.16297875253414124 + 4.912791094074942e-20i, -0.00013017947273671323 + -4.319865288595628e-05i, 0.0005456249979440559 + -0.0007084364902457187i }, { -0.003715388970011106 + -0.001414357762173378i, 0.00024761438453858094 + -0.0006590175178749873i, -0.015913504262556145 + 0.023105495188258364i, -0.00040294673036151454 + -0.0011463199352754465i, 0.00033960353800286113 + 0.0006233741643451465i, -0.0001301794727367132 + 4.319865288595627e-05i, 0.10903350729299852 + -4.367513634279986e-21i, -0.002745302995903912 + 0.0038194776351411644i }, { -0.0001542958947228717 + 0.00030794564910327103i, -0.004923798688070822 + -0.000995390069946833i, 0.0012135702319770326 + -1.5853499863913417e-05i, -0.016533463961491853 + 0.024087134784032585i, 7.11540144383147e-05 + -9.433733130398108e-06i, 0.0005456249979440559 + 0.0007084364902457188i, -0.0027453029959039117 + -0.0038194776351411644i, 0.1136307117301822 + -2.1295764870177697e-21i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, false, false, true, true, false, false}), ElementsAreArray({ DoubleNear(0.12993751425944353, 1.0e-7), DoubleNear(0.1392814073398838, 1.0e-7), DoubleNear(0.0945448824854115, 1.0e-7), DoubleNear(0.09854744590349734, 1.0e-7), DoubleNear(0.1520457784544431, 1.0e-7), DoubleNear(0.16297875253414124, 1.0e-7), DoubleNear(0.10903350729299852, 1.0e-7), DoubleNear(0.1136307117301822, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, false, false, true, false, true, false}), Matrix({ { 0.1323207343833563 + -5.960994366302139e-20i, -0.003464745377089792 + 0.0035801277815859806i, 1.2874900798265365e-19 + -5.421010862427522e-20i, 1.6093625997831706e-20 + 3.3881317890172014e-21i, 0.006079872952218737 + 0.01019559611571986i, -0.0004350546335499545 + -0.00010246634820346779i, 1.3552527156068805e-20 + -8.470329472543003e-21i, 3.5998900258307764e-21 + 1.5881867761018131e-21i }, { -0.0034647453770897925 + -0.0035801277815859806i, 0.14183565963939132 + 1.0058516248644817e-20i, -3.3881317890172014e-20 + -1.1858461261560205e-20i, 2.846030702774449e-19 + -1.0842021724855044e-19i, 0.00011665840029653944 + -0.00043146576263672625i, 0.006517064727008545 + 0.010928741494891803i, -4.446922973085077e-21 + -4.235164736271502e-22i, 1.6940658945086007e-20 + 2.0328790734103208e-20i }, { 1.6940658945086007e-19 + 8.131516293641283e-20i, -2.710505431213761e-20 + 1.0164395367051604e-20i, 0.09552921302820785 + -2.2671366228853383e-20i, -0.00240459227067867 + 0.0033452554324778345i, -3.3881317890172014e-21 + 2.371692252312041e-20i, -1.4823076576950256e-21 + 4.764560328305439e-22i, 0.004389376171040948 + 0.007360730559931665i, -0.00036824530205452235 + -3.157119412996644e-05i }, { 1.4823076576950256e-20 + -1.4399560103323106e-20i, 1.6263032587282567e-19 + 8.131516293641283e-20i, -0.00240459227067867 + -0.0033452554324778345i, 0.09956465635956238 + -1.9375051487829567e-20i, -1.0587911840678754e-22 + 3.0704944337968387e-21i, 1.8634724839594607e-20 + 2.371692252312041e-20i, 0.0001472728962445924 + -0.00033898677970644806i, 0.004574796716617968 + 0.0076716701155961995i }, { 0.006079872952218736 + -0.010195596115719859i, 0.0001166584002965395 + 0.0004314657626367261i, -1.1858461261560205e-20 + -2.879912020664621e-20i, 2.6469779601696886e-22 + -3.494010907423989e-21i, 0.14966255833053033 + 6.03510974918689e-20i, -0.0039188314629272514 + 0.004049335770689011i, 1.8295911660692887e-19 + -1.0842021724855044e-19i, 2.879912020664621e-20 + -1.0164395367051604e-20i }, { -0.0004350546335499543 + 0.00010246634820346785i, 0.006517064727008545 + -0.010928741494891803i, -6.352747104407253e-22 + -6.352747104407253e-22i, -2.541098841762901e-21 + -2.0328790734103208e-20i, -0.0039188314629272514 + -0.004049335770689011i, 0.16042450023463375 + 9.43382945004477e-20i, -5.082197683525802e-20 + -3.218725199566341e-20i, 2.710505431213761e-19 + -8.131516293641283e-20i }, { 8.470329472543003e-21 + -8.470329472543003e-22i, -1.4823076576950256e-21 + 4.235164736271502e-22i, 0.004389376171040948 + -0.007360730559931663i, 0.00014727289624459237 + 0.000338986779706448i, 1.2197274440461925e-19 + 8.131516293641283e-20i, -3.7269449679189215e-20 + 1.0164395367051604e-20i, 0.10804917675020215 + 6.524800671818282e-21i, -0.002719735743976156 + 0.003783681284924246i }, { 1.5881867761018131e-21 + -1.7734752333136913e-21i, 3.049318610115481e-20 + -3.049318610115481e-20i, -0.0003682453020545224 + 3.1571194129966496e-05i, 0.004574796716617967 + -0.0076716701155961995i, 2.202285662861181e-20 + 4.235164736271502e-21i, 2.439454888092385e-19 + 1.6263032587282567e-19i, -0.002719735743976156 + -0.003783681284924246i, 0.11261350127411716 + 3.817852117238499e-21i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, false, false, true, false, true, false}), ElementsAreArray({ DoubleNear(0.1323207343833563, 1.0e-7), DoubleNear(0.14183565963939132, 1.0e-7), DoubleNear(0.09552921302820785, 1.0e-7), DoubleNear(0.09956465635956238, 1.0e-7), DoubleNear(0.14966255833053033, 1.0e-7), DoubleNear(0.16042450023463375, 1.0e-7), DoubleNear(0.10804917675020215, 1.0e-7), DoubleNear(0.11261350127411716, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, false, false, true, false, false, true}), Matrix({ { 0.1576098067117168 + 3.5469504666273827e-20i, 9.062528901749046e-05 + 0.000838015455189282i, 1.8973538018496328e-19 + -5.421010862427522e-20i, 1.1011428314305904e-20 + -1.6940658945086007e-21i, -0.009905552136159382 + -0.013791691634963028i, -0.006287815661756313 + 0.002606594938454029i, -1.0164395367051604e-20 + -2.0328790734103208e-20i, 1.6940658945086007e-20 + -2.371692252312041e-20i }, { 9.062528901749025e-05 + -0.0008380154551892819i, 0.14649173142736677 + 4.0763460586613204e-20i, -6.776263578034403e-20 + -3.3881317890172014e-21i, 2.574980159653073e-19 + -1.3552527156068805e-19i, -0.006084066795883956 + 0.016647332086603843i, -0.012009040067596507 + -0.008749130772900005i, -2.625802136488331e-20 + 5.421010862427522e-20i, -3.3881317890172014e-20 + -3.3881317890172014e-21i }, { 1.8973538018496328e-19 + 2.710505431213761e-20i, -6.098637220230962e-20 + 0.0i, 0.11201488372468034 + -1.7390645198314854e-20i, 0.0012212324838420698 + 0.002961442528408369i, 1.6940658945086007e-20 + -1.9905274260476058e-20i, -9.486769009248164e-20 + 0.0i, -0.006872781783742128 + -0.007554380489663148i, 9.12357068480289e-05 + 0.005642169339063741i }, { 9.740878893424454e-21 + -1.1858461261560205e-20i, 1.8973538018496328e-19 + 1.8973538018496328e-19i, 0.0012212324838420698 + -0.002961442528408369i, 0.1033828035816152 + -8.291244869925273e-21i, 1.1011428314305904e-20 + 5.421010862427522e-20i, -2.371692252312041e-20 + -2.0328790734103208e-20i, -0.004750245906982127 + 0.009618122751252626i, -0.009311066871638437 + -0.005350313974126229i }, { -0.009905552136159382 + 0.013791691634963028i, -0.006084066795883956 + -0.016647332086603843i, 3.3881317890172014e-20 + 8.893845946170154e-21i, 1.9481757786848908e-20 + -5.421010862427522e-20i, 0.12437348600216983 + -3.4728350837426314e-20i, -0.007474202129034534 + 0.0067914480970857095i, 1.2197274440461925e-19 + -1.0842021724855044e-19i, 3.3881317890172014e-20 + -5.082197683525802e-21i }, { -0.006287815661756313 + -0.002606594938454029i, -0.012009040067596507 + 0.008749130772900005i, -1.0164395367051604e-19 + 3.3881317890172014e-21i, -2.710505431213761e-20 + 1.3552527156068805e-20i, -0.007474202129034534 + -0.0067914480970857095i, 0.15576842844665828 + 6.363335016247931e-20i, -1.6940658945086007e-20 + -4.0657581468206416e-20i, 2.981555974335137e-19 + -5.421010862427522e-20i }, { -2.371692252312041e-20 + 3.049318610115481e-20i, -2.202285662861181e-20 + -5.421010862427522e-20i, -0.006872781783742128 + 0.007554380489663148i, -0.004750245906982127 + -0.009618122751252626i, 1.0164395367051604e-19 + 1.3552527156068805e-19i, -3.3881317890172014e-21 + 2.0328790734103208e-20i, 0.09156350605372966 + 1.2440796412797536e-21i, -0.006345560498496897 + 0.004167494188993711i }, { 1.6940658945086007e-20 + -5.082197683525802e-21i, -2.371692252312041e-20 + -2.0328790734103208e-20i, 9.123570684802872e-05 + -0.005642169339063741i, -0.009311066871638435 + 0.00535031397412623i, 2.710505431213761e-20 + 1.6940658945086007e-21i, 2.168404344971009e-19 + 5.421010862427522e-20i, -0.006345560498496896 + -0.004167494188993712i, 0.10879535405206434 + -7.265954500665795e-21i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, false, false, true, false, false, true}), ElementsAreArray({ DoubleNear(0.1576098067117168, 1.0e-7), DoubleNear(0.14649173142736677, 1.0e-7), DoubleNear(0.11201488372468034, 1.0e-7), DoubleNear(0.1033828035816152, 1.0e-7), DoubleNear(0.12437348600216983, 1.0e-7), DoubleNear(0.15576842844665828, 1.0e-7), DoubleNear(0.09156350605372966, 1.0e-7), DoubleNear(0.10879535405206434, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, false, false, false, true, true, false}), Matrix({ { 0.10533777450183895 + -5.684385169464406e-20i, -0.0027120091788012547 + 0.003203992264391456i, -0.020689636865987307 + -0.025552198229343036i, 0.00131983447574654 + 4.227203503938534e-05i, 0.004840770379295881 + 0.00811703708081957i, -0.0003715142374560751 + -6.181636762218063e-05i, 0.001022816831862208 + -0.0027654907010182138i, 5.717288860549344e-05 + 0.0001032524126833603i }, { -0.0027120091788012547 + -0.003203992264391456i, 0.11160052894535236 + -9.262561704215666e-21i, -0.0002364201330112402 + 0.0012722876128294968i, -0.021930539946497046 + -0.027070681085221163i, 0.00012219058589946883 + -0.0003561919438392379i, 0.005128612144478541 + 0.00859965662117794i, -0.00010933666851628035 + 4.0236167117146875e-05i, 0.0010833263354617525 + -0.0029305622684204255i }, { -0.020689636865987307 + 0.025552198229343036i, -0.00023642013301124014 + -0.001272287612829497i, 0.12251217290972516 + -2.5437458197230707e-20i, -0.003157328468967207 + 0.003721390949672359i, -0.0029155753428979784 + -0.00041643255392879834i, 8.70422447836402e-05 + -7.709820407983184e-05i, 0.005628478743963804 + 0.009439289594831955i, -0.0004317856981484018 + -7.222117471125363e-05i }, { 0.00131983447574654 + -4.227203503938531e-05i, -0.021930539946497046 + 0.02707068108522116i, -0.0031573284689672076 + -0.003721390949672359i, 0.12979978705360132 + -5.397353496908506e-23i, 6.347105852930872e-05 + 9.965433653407226e-05i, -0.003089148841318408 + -0.00044185782954019547i, 0.000141740710641663 + -0.00041426059850393636i, 0.0059632492991479715 + 0.010000754989310062i }, { 0.004840770379295881 + -0.008117037080819569i, 0.00012219058589946883 + 0.00035619194383923784i, -0.002915575342897979 + 0.00041643255392879834i, 6.34710585293087e-05 + -9.965433653407225e-05i, 0.11914462224301606 + 2.7171228761141853e-20i, -0.0030675406300243123 + 0.0036238473470579183i, -0.023392887131609343 + -0.028901933435694985i, 0.0014921839487035682 + 4.753310821939687e-05i }, { -0.00037151423745607497 + 6.181636762218071e-05i, 0.0051286121444785405 + -0.008599656621177941i, 8.70422447836402e-05 + 7.70982040798318e-05i, -0.003089148841318408 + 0.00044185782954019536i, -0.0030675406300243128 + -0.0036238473470579183i, 0.1262283242980288 + 5.1103838628985465e-20i, -0.00026795861075196224 + 0.001439437704969896i, -0.02479547708318483 + -0.03061952822480391i }, { 0.0010228168318622078 + 0.0027654907010182138i, -0.00010933666851628031 + -4.023616711714687e-05i, 0.005628478743963804 + -0.009439289594831955i, 0.00014174071064166304 + 0.0004142605985039363i, -0.023392887131609343 + 0.028901933435694985i, -0.00026795861075196224 + -0.001439437704969896i, 0.13856711283771642 + 3.970466940254533e-20i, -0.003571026576879095 + 0.00420916970855534i }, { 5.7172888605493394e-05 + -0.0001032524126833603i, 0.0010833263354617525 + 0.002930562268420426i, -0.0004317856981484018 + 7.222117471125367e-05i, 0.0059632492991479715 + -0.010000754989310062i, 0.0014921839487035682 + -4.7533108219396925e-05i, -0.024795477083184834 + 0.030619528224803915i, -0.003571026576879095 + -0.00420916970855534i, 0.1468096772107221 + 4.7052307988700735e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, false, false, false, true, true, false}), ElementsAreArray({ DoubleNear(0.10533777450183895, 1.0e-7), DoubleNear(0.11160052894535236, 1.0e-7), DoubleNear(0.12251217290972516, 1.0e-7), DoubleNear(0.12979978705360132, 1.0e-7), DoubleNear(0.11914462224301606, 1.0e-7), DoubleNear(0.1262283242980288, 1.0e-7), DoubleNear(0.13856711283771642, 1.0e-7), DoubleNear(0.1468096772107221, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, false, false, false, true, false, true}), Matrix({ { 0.12465270767698819 + -1.5087774372967225e-21i, 0.0006090927228077803 + 0.0017576435047262562i, -0.024471127699265197 + -0.030238284623451305i, 0.00032333123168765414 + -0.00048713931423268375i, -0.007759881480110524 + -0.009862398861424987i, -0.0028590768759182645 + 0.0038227259601719688i, -0.0008847218978992102 + 0.0038588040226854095i, 0.0015277623610937426 + -2.3443966059150914e-06i }, { 0.0006090927228077801 + -0.0017576435047262562i, 0.11552720760380111 + 2.5840295155544032e-20i, -0.0005302730167870457 + 0.00018955382290839905i, -0.022646290424498193 + -0.028026771430811948i, -0.005008333013430131 + 0.012137603672158099i, -0.009860577055568696 + -0.006514793374398789i, 0.003928973667723825 + -0.001201746929701702i, 0.0003328074317575823 + 0.00369514286361746i }, { -0.024471127699265197 + 0.03023828462345131i, -0.0005302730167870457 + -0.00018955382290839913i, 0.14497198275940892 + 1.9587636905255695e-20i, 0.00070276505005178 + 0.002041814478871395i, 0.0038950786972813106 + 9.166792019689302e-05i, -0.0003342082408138019 + -0.0013848750732296093i, -0.009018452439790988 + -0.011483673263201192i, -0.0033375030789900197 + 0.004426038317345803i }, { 0.0003233312316876541 + 0.00048713931423268375i, -0.022646290424498193 + 0.028026771430811948i, 0.0007027650500517799 + -0.002041814478871395i, 0.13434732740518085 + 6.6319205611438994e-21i, -0.0019553701289407237 + -0.003631128558630548i, 0.0034906038537745607 + -0.0010919251105487265i, -0.005825979689435951 + 0.01412785116569837i, -0.011459529883666247 + -0.007584651372627445i }, { -0.007759881480110523 + 0.009862398861424987i, -0.0050083330134301305 + -0.012137603672158099i, 0.0038950786972813106 + -9.166792019689316e-05i, -0.001955370128940724 + 0.003631128558630549i, 0.09982968906786682 + -2.8163845496205486e-20i, -0.0063886425316333475 + 0.005070196106723119i, -0.019611396298331453 + -0.024215847041586715i, 0.0024886871927624543 + 0.000576944457491466i }, { -0.0028590768759182645 + -0.0038227259601719688i, -0.009860577055568696 + 0.006514793374398789i, -0.0003342082408138019 + 0.001384875073229609i, 0.0034906038537745607 + 0.0010919251105487265i, -0.0063886425316333475 + -0.005070196106723119i, 0.12230164563958004 + 1.6000981769225767e-20i, 2.5894273023843205e-05 + 0.0025221714948909938i, -0.024079726605183687 + -0.029663437879213127i }, { -0.0008847218978992103 + -0.0038588040226854104i, 0.003928973667723825 + 0.0012017469297017022i, -0.009018452439790988 + 0.01148367326320119i, -0.005825979689435951 + -0.01412785116569837i, -0.019611396298331453 + 0.024215847041586715i, 2.589427302384325e-05 + -0.0025221714948909938i, 0.11610730298803265 + -5.320425699941074e-21i, -0.007431120095898082 + 0.0058887461793563035i }, { 0.0015277623610937426 + 2.3443966059150372e-06i, 0.00033280743175758234 + -0.0036951428636174594i, -0.00333750307899002 + -0.004426038317345803i, -0.011459529883666247 + 0.007584651372627444i, 0.0024886871927624543 + -0.000576944457491466i, -0.024079726605183687 + 0.029663437879213127i, -0.007431120095898082 + -0.0058887461793563035i, 0.14226213685914257 + 4.036641389258775e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, false, false, false, true, false, true}), ElementsAreArray({ DoubleNear(0.12465270767698819, 1.0e-7), DoubleNear(0.11552720760380111, 1.0e-7), DoubleNear(0.14497198275940892, 1.0e-7), DoubleNear(0.13434732740518085, 1.0e-7), DoubleNear(0.09982968906786682, 1.0e-7), DoubleNear(0.12230164563958004, 1.0e-7), DoubleNear(0.11610730298803265, 1.0e-7), DoubleNear(0.14226213685914257, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, false, false, false, false, true, true}), Matrix({ { 0.12652145700925851 + -1.962734157465824e-20i, 0.0006155896054714832 + 0.0017828966596203904i, 0.005813407762061615 + 0.009748749367590187i, -0.00010909089745346956 + 0.00012935303184050828i, -0.0078732376115034 + -0.010016649967260732i, -0.0029077467760850436 + 0.0038707348100364787i, 0.00041004483047203286 + -0.0010668948496671275i, -0.00043185355671059445 + -4.619560107101521e-05i }, { 0.000615589605471483 + -0.0017828966596203904i, 0.1172536913725453 + -4.699626650220027e-20i, 0.00016566111843077755 + -3.448803551666647e-05i, 0.005387572477177929 + 0.00903464816669056i, -0.005084004089691823 + 0.012325071601261192i, -0.010004465797176393 + -0.006616168161484094i, -0.0011832729906415074 + 0.00017457896694085315i, 5.010475068342991e-05 + -0.0010748652139567591i }, { 0.005813407762061615 + -0.009748749367590185i, 0.0001656611184307776 + 3.448803551666631e-05i, 0.1431032334271386 + 3.7706201042617214e-20i, 0.0006962681673880772 + 0.002016561323977261i, -0.001133563856022299 + 0.0001464048071715438i, 0.0001646432656219382 + 0.0004019006383264984i, -0.00890509630839811 + -0.011329422157365446i, -0.0032888331788232406 + 0.004378029467481292i }, { -0.00010909089745346941 + -0.00012935303184050822i, 0.005387572477177929 + -0.00903464816669056i, 0.000696268167388077 + -0.002016561323977261i, 0.13262084363643667 + 7.94684822188882e-20i, 0.0007160733624360776 + 0.000958045784756304i, -0.0009694751167127933 + 0.00046686583971208894i, -0.0057503086131742605 + 0.013940383236595277i, -0.01131564114205855 + -0.0074832765855421405i }, { -0.0078732376115034 + 0.010016649967260732i, -0.005084004089691821 + -0.012325071601261192i, -0.0011335638560222992 + -0.00014640480717154387i, 0.0007160733624360775 + -0.000958045784756304i, 0.1013284904023056 + -6.265396831721653e-20i, -0.006484927253239945 + 0.005142486554443425i, 0.00465584136119807 + 0.007807577308061338i, -0.0006942090381510073 + -0.0002633905741739425i }, { -0.0029077467760850436 + -0.0038707348100364787i, -0.010004465797176393 + 0.006616168161484094i, 0.00016464326562193844 + -0.0004019006383264984i, -0.0009694751167127934 + -0.00046686583971208904i, -0.006484927253239945 + -0.005142486554443425i, 0.12414662462640838 + 3.7679731263015517e-20i, 9.827017811035428e-05 + -0.0007359645068265078i, 0.0057042889664485836 + 0.009565763443797441i }, { 0.00041004483047203297 + 0.0010668948496671275i, -0.0011832729906415074 + -0.00017457896694085317i, -0.00890509630839811 + 0.011329422157365444i, -0.0057503086131742605 + -0.013940383236595277i, 0.00465584136119807 + -0.007807577308061336i, 9.827017811035423e-05 + 0.0007359645068265078i, 0.11460850165359387 + 2.916969712106997e-20i, -0.007334835374291485 + 0.005816455731635997i }, { -0.0004318535567105947 + 4.6195601071015254e-05i, 5.0104750683430016e-05 + 0.0010748652139567594i, -0.0032888331788232415 + -0.004378029467481292i, -0.01131564114205855 + 0.00748327658554214i, -0.0006942090381510074 + 0.0002633905741739426i, 0.005704288966448583 + -0.009565763443797443i, -0.007334835374291485 + -0.005816455731635997i, 0.14041715787231424 + 1.8687664398798e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, false, false, false, false, true, true}), ElementsAreArray({ DoubleNear(0.12652145700925851, 1.0e-7), DoubleNear(0.1172536913725453, 1.0e-7), DoubleNear(0.1431032334271386, 1.0e-7), DoubleNear(0.13262084363643667, 1.0e-7), DoubleNear(0.1013284904023056, 1.0e-7), DoubleNear(0.12414662462640838, 1.0e-7), DoubleNear(0.11460850165359387, 1.0e-7), DoubleNear(0.14041715787231424, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, true, true, false, false, false, false, false, false}), Matrix({ { 0.08226234599837748 + -4.141900122206148e-21i, 0.010230198361978438 + 0.005686266692130588i, -1.0842021724855044e-19 + -2.0328790734103208e-20i, -5.421010862427522e-19 + 1.4907779871675686e-19i, -0.0013902438053711621 + -0.016452355376344242i, 0.0009643538549788965 + -0.002142124126506951i, 4.658681209898652e-21 + 1.6093625997831706e-20i, 6.437450399132683e-20 + 1.1519648082658485e-19i }, { 0.010230198361978438 + -0.005686266692130589i, 0.09048741090459053 + 3.907104905332971e-20i, -5.692061405548898e-19 + 2.303929616531697e-19i, -4.0657581468206416e-20 + 1.0164395367051604e-19i, -0.0013101370861242682 + -0.0019499269079987689i, -0.0015292484179415837 + -0.018097356976872186i, 8.809142651444724e-20 + 1.3552527156068805e-19i, 2.202285662861181e-20 + 9.740878893424454e-21i }, { -5.421010862427522e-20 + 3.3881317890172014e-21i, -5.963111948670274e-19 + -4.0657581468206416e-19i, 0.12480782968266452 + 2.795208725939191e-20i, 0.014110347970149567 + -0.00784297614161971i, -3.5998900258307764e-21 + 1.3976043629695956e-20i, -9.147955830346444e-20 + 1.1519648082658485e-19i, -0.0021092677332781853 + -0.024961393244607225i, -0.0018070509993743749 + -0.0026895028048018643i }, { -4.87890977618477e-19 + -3.9302328752599536e-19i, -4.743384504624082e-20 + -1.0503208545953324e-19i, 0.014110347970149567 + 0.007842976141619709i, 0.11346313002023423 + -2.951380425589203e-20i, -8.131516293641283e-20 + 1.0503208545953324e-19i, -2.0328790734103208e-20 + 6.776263578034403e-21i, 0.0013301177532080446 + -0.002954597335336544i, -0.0019175409081059352 + -0.022692469009357757i }, { -0.0013902438053711621 + 0.016452355376344242i, -0.001310137086124268 + 0.0019499269079987689i, -2.752857078576476e-21 + -1.8211208365967457e-20i, -8.470329472543003e-20 + -1.0842021724855044e-19i, 0.11787925921725462 + 6.478685352668451e-21i, 0.01465954064304676 + 0.008148234739054527i, -1.2874900798265365e-19 + 2.541098841762901e-20i, -9.215718466126788e-19 + 2.303929616531697e-19i }, { 0.0009643538549788968 + 0.002142124126506951i, -0.001529248417941584 + 0.018097356976872186i, -9.486769009248164e-20 + -1.2197274440461925e-19i, -2.329340604949326e-20 + -9.740878893424454e-21i, 0.01465954064304676 + -0.008148234739054527i, 0.12966550900615992 + 1.0862990753383264e-19i, -7.589415207398531e-19 + 7.589415207398531e-19i, -6.776263578034403e-20 + 1.2874900798265365e-19i }, { 5.505714157152952e-21 + -2.795208725939191e-20i, 1.0164395367051604e-19 + -1.2874900798265365e-19i, -0.0021092677332781853 + 0.024961393244607225i, 0.0013301177532080448 + 0.002954597335336544i, -1.5585406229479126e-19 + -1.8634724839594607e-20i, -1.0299920638612292e-18 + -3.2526065174565133e-19i, 0.17884554991655544 + -1.6456261978374954e-19i, 0.020219668498777432 + -0.01123872904926597i }, { 9.147955830346444e-20 + -1.0842021724855044e-19i, 1.8634724839594607e-20 + -1.0587911840678754e-20i, -0.0018070509993743746 + 0.0026895028048018643i, -0.0019175409081059356 + 0.022692469009357757i, -7.589415207398531e-19 + -5.55653613398821e-19i, -6.098637220230962e-20 + -1.6263032587282567e-19i, 0.020219668498777436 + 0.011238729049265967i, 0.1625889652541645 + 8.952079461293887e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, true, true, false, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.08226234599837748, 1.0e-7), DoubleNear(0.09048741090459053, 1.0e-7), DoubleNear(0.12480782968266452, 1.0e-7), DoubleNear(0.11346313002023423, 1.0e-7), DoubleNear(0.11787925921725462, 1.0e-7), DoubleNear(0.12966550900615992, 1.0e-7), DoubleNear(0.17884554991655544, 1.0e-7), DoubleNear(0.1625889652541645, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, true, false, true, false, false, false, false, false}), Matrix({ { 0.07092040670548473 + -8.325572865346224e-22i, 0.00881970748224959 + 0.004902271404339802i, -3.3881317890172014e-21 + -1.4568966692773966e-19i, -4.87890977618477e-19 + -1.0299920638612292e-18i, 2.168404344971009e-18 + 7.589415207398531e-19i, 1.8973538018496328e-19 + 2.168404344971009e-19i, -0.0008694069140595632 + 0.00013879228805596926i, -0.004867019945988214 + 0.0038212897978660934i }, { 0.00881970748224959 + -0.004902271404339803i, 0.07801143895417777 + 1.2679024429212808e-20i, -5.149960319306146e-19 + -9.75781955236954e-19i, -1.1519648082658485e-19 + -6.776263578034403e-20i, 2.303929616531697e-19 + -4.0657581468206416e-20i, 1.951563910473908e-18 + 7.589415207398531e-19i, -0.005353652736115257 + 0.004203364442485617i, -0.0003411245599673769 + 0.0008116438356973133i }, { 0.0 + 1.3891340334970526e-19i, -5.149960319306146e-19 + 1.0842021724855044e-18i, 0.1075999223423317 + -4.1173742170439506e-20i, 0.012164880598210219 + -0.006761624057695293i, -0.00042370123299019004 + 0.0007717570515395221i, -0.005761844295626123 + 0.0036236750086379855i, 3.2526065174565133e-19 + -3.144186300207963e-18i, -2.303929616531697e-19 + -2.981555974335137e-19i }, { -4.607859233063394e-19 + 8.944667923005412e-19i, -1.2536087619363645e-19 + 6.776263578034403e-20i, 0.01216488059821022 + 0.006761624057695292i, 0.09781937567488071 + 1.700683339409025e-20i, -0.005238107978747882 + 0.003294292591270604i, -0.000879127734836954 + 4.760364774709818e-05i, 2.168404344971009e-19 + -2.846030702774449e-19i, 0.0 + -2.3852447794681098e-18i }, { 1.8431436932253575e-18 + -4.336808689942018e-19i, 2.439454888092385e-19 + 2.710505431213761e-20i, -0.00042370123299019004 + -0.0007717570515395221i, -0.005238107978747882 + -0.0032942925912706044i, 0.12922119851014735 + 3.1693425169969255e-21i, 0.016070031522775606 + 0.008932230026845312i, -2.710505431213761e-19 + 1.3552527156068805e-19i, -1.0842021724855044e-18 + 1.5178830414797062e-18i }, { 1.6263032587282567e-19 + -2.168404344971009e-19i, 2.0599841277224584e-18 + -5.421010862427522e-19i, -0.005761844295626123 + -0.0036236750086379855i, -0.000879127734836954 + -4.76036477470982e-05i, 0.016070031522775606 + -0.008932230026845314i, 0.14214148095657267 + 1.3502193215794954e-19i, -8.673617379884035e-19 + 1.8973538018496328e-18i, 2.371692252312041e-20 + 2.778268066994105e-19i }, { -0.0008694069140595632 + -0.00013879228805596926i, -0.005353652736115257 + -0.004203364442485616i, 3.7947076036992655e-19 + 2.6020852139652106e-18i, 2.0328790734103208e-19 + 3.1170812458958252e-19i, -2.236166980751353e-19 + -1.4907779871675686e-19i, -9.75781955236954e-19 + -1.734723475976807e-18i, 0.19605345725688825 + -9.543679035391812e-20i, 0.02216513587071678 + -0.012320081133190386i }, { -0.004867019945988214 + -0.003821289797866093i, -0.00034112455996737693 + -0.0008116438356973132i, -1.6263032587282567e-19 + 3.2526065174565133e-19i, 1.0842021724855044e-19 + 2.2768245622195593e-18i, -8.673617379884035e-19 + -1.8973538018496328e-18i, 1.6940658945086007e-20 + -2.981555974335137e-19i, 0.02216513587071678 + 0.012320081133190386i, 0.17823271959951803 + 4.300015696295659e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, true, false, true, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.07092040670548473, 1.0e-7), DoubleNear(0.07801143895417777, 1.0e-7), DoubleNear(0.1075999223423317, 1.0e-7), DoubleNear(0.09781937567488071, 1.0e-7), DoubleNear(0.12922119851014735, 1.0e-7), DoubleNear(0.14214148095657267, 1.0e-7), DoubleNear(0.19605345725688825, 1.0e-7), DoubleNear(0.17823271959951803, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, true, false, false, true, false, false, false, false}), Matrix({ { 0.09947397797415204 + 2.2617806284190574e-20i, 0.009917990801518142 + -0.005283082758436508i, -5.082197683525802e-20 + 8.131516293641283e-20i, -7.047314121155779e-19 + 2.981555974335137e-19i, 0.012374088124449418 + 0.0017386380326861372i, 0.022186265682348518 + -0.007044140156211871i, -1.2874900798265365e-19 + 1.2197274440461925e-19i, -8.809142651444724e-20 + 3.218725199566341e-20i }, { 0.009917990801518142 + 0.005283082758436508i, 0.12698314223520543 + 1.0830978863677461e-19i, -7.047314121155779e-19 + 4.0657581468206416e-19i, -1.0164395367051604e-19 + 1.3552527156068805e-20i, 0.019794529400207702 + -0.0028737627410617412i, -0.01035926715798565 + 0.01470412303477588i, 3.3881317890172014e-21 + -1.4230153513872246e-19i, -1.2197274440461925e-19 + 1.2197274440461925e-19i }, { -4.404571325722362e-20 + -9.147955830346444e-20i, -7.047314121155779e-19 + -1.3552527156068805e-19i, 0.1751458045956432 + -1.037350662590501e-19i, 0.013679725106239198 + 0.0072868710301546985i, -1.4907779871675686e-19 + -9.825582188149884e-20i, 1.2874900798265365e-19 + -5.421010862427522e-20i, -0.014288370483429336 + 0.02028116027424265i, 0.027302275856190803 + -0.0039637347024217414i }, { -7.047314121155779e-19 + -6.640738306473715e-19i, -8.131516293641283e-20 + -3.049318610115481e-20i, 0.013679725106239198 + -0.007286871030154701i, 0.1372028570244489 + 4.539567201691016e-20i, -6.776263578034403e-20 + -6.776263578034403e-20i, -1.8295911660692887e-19 + -8.470329472543003e-20i, 0.03060115922088366 + -0.009715869158907585i, 0.017067380618757615 + 0.0023980754592712737i }, { 0.012374088124449418 + -0.001738638032686137i, 0.0197945294002077 + 0.0028737627410617412i, -1.3552527156068805e-19 + 4.0657581468206416e-20i, -7.792703114739563e-20 + 8.131516293641283e-20i, 0.10066762724148003 + -2.028102105372827e-20i, 0.014971748203507058 + 0.019117584189621624i, -2.1006417091906648e-19 + -6.098637220230962e-20i, -7.589415207398531e-19 + 1.0842021724855044e-19i }, { 0.022186265682348518 + 0.007044140156211871i, -0.01035926715798565 + -0.01470412303477588i, 1.3552527156068805e-19 + 4.743384504624082e-20i, -1.9651164376299768e-19 + 3.049318610115481e-20i, 0.014971748203507058 + -0.019117584189621624i, 0.09316977767554499 + 3.939116795038773e-20i, -7.318364664277155e-19 + 5.149960319306146e-19i, 6.776263578034403e-21 + 1.8295911660692887e-19i }, { -1.1519648082658485e-19 + -1.6263032587282567e-19i, 6.098637220230962e-20 + 1.4230153513872246e-19i, -0.014288370483429336 + -0.02028116027424265i, 0.03060115922088366 + 0.009715869158907585i, -1.6940658945086007e-19 + 5.421010862427522e-20i, -6.2341624917916505e-19 + -5.014435047745458e-19i, 0.1285075750035768 + -3.287546626530753e-20i, 0.020650291362687805 + -0.026368576221040378i }, { -9.486769009248164e-20 + -5.082197683525802e-20i, -1.2197274440461925e-19 + -1.2197274440461925e-19i, 0.027302275856190803 + 0.003963734702421742i, 0.017067380618757615 + -0.0023980754592712724i, -7.589415207398531e-19 + -3.1170812458958252e-19i, -1.3552527156068805e-20 + -2.236166980751353e-19i, 0.020650291362687805 + 0.026368576221040378i, 0.13884923824994985 + 1.461131834013668e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, true, false, false, true, false, false, false, false}), ElementsAreArray({ DoubleNear(0.09947397797415204, 1.0e-7), DoubleNear(0.12698314223520543, 1.0e-7), DoubleNear(0.1751458045956432, 1.0e-7), DoubleNear(0.1372028570244489, 1.0e-7), DoubleNear(0.10066762724148003, 1.0e-7), DoubleNear(0.09316977767554499, 1.0e-7), DoubleNear(0.1285075750035768, 1.0e-7), DoubleNear(0.13884923824994985, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, true, false, false, false, true, false, false, false}), Matrix({ { 0.11862283503258672 + -9.410006648403243e-21i, 0.014752012210635747 + 0.00819963335090399i, -2.846030702774449e-19 + 2.168404344971009e-19i, -8.131516293641283e-19 + 1.734723475976807e-18i, -5.55653613398821e-19 + -2.846030702774449e-19i, -3.8963515573697816e-20 + -6.437450399132683e-20i, 8.7209194374881e-05 + 0.0003985060740798102i, 0.001896475026174788 + 0.0021503182046177785i }, { 0.014752012210635747 + -0.008199633350903991i, 0.13048343183007258 + 9.539708568451558e-20i, -7.047314121155779e-19 + 2.3852447794681098e-18i, 6.098637220230962e-20 + 3.1848438816761693e-19i, -9.656175598699024e-20 + 2.541098841762901e-21i, -6.369687763352339e-19 + -3.3881317890172014e-19i, 0.002086095562691062 + 0.0023653194495657595i, 0.0003844845184858974 + 0.00013632384129962956i }, { -2.303929616531697e-19 + -2.202285662861181e-19i, -8.673617379884035e-19 + -2.1141942363467336e-18i, 0.17554696908292988 + -8.446506670901476e-20i, 0.019846742188877928 + -0.011031444852071706i, 0.000256557873017085 + 0.0003481741625464271i, 0.00042593223150938346 + 0.00331639148854936i, 1.0299920638612292e-18 + 1.1519648082658485e-19i, 1.3213713977167085e-19 + -6.437450399132683e-20i }, { -8.673617379884035e-19 + -2.3852447794681098e-18i, 5.082197683525802e-20 + -3.5914196963582334e-19i, 0.019846742188877928 + 0.011031444852071706i, 0.15959021664232248 + 1.0361595225084246e-19i, 0.0003872161248732157 + 0.0030149403256191677i, -0.0001602489793590377 + 0.0004017056811726008i, 1.0164395367051604e-19 + 6.945670167485263e-20i, 9.486769009248164e-19 + 1.0164395367051604e-19i }, { -5.421010862427522e-19 + 3.3881317890172014e-19i, -9.147955830346444e-20 + -3.3881317890172014e-21i, 0.00025655787301708503 + -0.00034817416254642703i, 0.00038721612487321573 + -0.0030149403256191673i, 0.08151877018304535 + 1.1746791878865546e-20i, 0.010137726794389453 + 0.005634868080281123i, 2.710505431213761e-20 + -1.9651164376299768e-19i, -6.505213034913027e-19 + -1.3010426069826053e-18i }, { -4.573977915173222e-20 + 6.945670167485263e-20i, -5.55653613398821e-19 + 3.1170812458958252e-19i, 0.00042593223150938346 + -0.00331639148854936i, -0.00016024897935903776 + -0.0004017056811726008i, 0.010137726794389451 + -0.005634868080281125i, 0.08966948808067784 + 5.230387090264677e-20i, -6.505213034913027e-19 + -1.5178830414797062e-18i, -1.5585406229479126e-19 + -1.1180834903756764e-19i }, { 8.720919437488103e-05 + -0.0003985060740798102i, 0.0020860955626910626 + -0.00236531944956576i, 8.673617379884035e-19 + -9.486769009248164e-20i, 9.486769009248164e-20 + -7.199780051661553e-20i, 1.3552527156068805e-20 + 1.8295911660692887e-19i, -7.589415207398531e-19 + 1.5449880957918438e-18i, 0.12810641051629007 + -5.2145465815342865e-20i, 0.014483274280049075 + -0.008050260338813972i }, { 0.001896475026174788 + -0.0021503182046177785i, 0.00038448451848589743 + -0.00013632384129962956i, 1.2874900798265365e-19 + 6.098637220230962e-20i, 8.944667923005412e-19 + -8.809142651444724e-20i, -6.505213034913027e-19 + 1.3823577699190182e-18i, -1.5585406229479126e-19 + 1.1180834903756764e-19i, 0.014483274280049077 + 0.00805026033881397i, 0.11646187863207627 + -4.360896189379562e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, true, false, false, false, true, false, false, false}), ElementsAreArray({ DoubleNear(0.11862283503258672, 1.0e-7), DoubleNear(0.13048343183007258, 1.0e-7), DoubleNear(0.17554696908292988, 1.0e-7), DoubleNear(0.15959021664232248, 1.0e-7), DoubleNear(0.08151877018304535, 1.0e-7), DoubleNear(0.08966948808067784, 1.0e-7), DoubleNear(0.12810641051629007, 1.0e-7), DoubleNear(0.11646187863207627, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, true, false, false, false, false, true, false, false}), Matrix({ { 0.09297296705080998 + 6.7156725981648934e-21i, 0.011562178098473286 + 0.006426623011942826i, 0.00032063009718404816 + 7.794946711072637e-05i, 0.0022358586102965428 + -0.0006159589567305582i, -0.015499590444532078 + -0.02273097460182378i, -0.0003562930361790305 + -0.003898225611393144i, 0.00028392650197764824 + 0.0014399083604728878i, 0.006660901967705438 + 0.007876149797459462i }, { 0.011562178098473288 + -0.006426623011942826i, 0.10226894176725197 + 6.695551429764541e-20i, 0.0024594126795078335 + -0.0006775460940433213i, 0.0002354755381481179 + -0.00023115157273302864i, -0.003498785076475724 + -0.0017554516893329426i, -0.017049329099305073 + -0.02500374884880633i, 0.007326897452679573 + 0.008663652785721412i, 0.001372781620610131 + 0.0005190577686539385i }, { 0.0003206300971840481 + -7.79494671107264e-05i, 0.002459412679507833 + 0.0006775460940433215i, 0.13989260331091458 + -7.551828120364121e-20i, 0.015815781078687214 + -0.00879090961637776i, 0.0013596150508376676 + 0.000719441985030911i, 0.006485283778761673 + 0.009968281362041156i, -0.03051675674009296 + -0.033738163408325736i, -0.005570240817137192 + -0.0018966360614951151i }, { 0.0022358586102965428 + 0.0006159589567305577i, 0.00023547553814811788 + 0.00023115157273302864i, 0.015815781078687214 + 0.00879090961637776i, 0.12717673785925965 + 1.40157482990985e-20i, 0.005895788737603199 + 0.009062191107203032i, 0.00010679312301112615 + 0.0015345178673339265i, -0.0013300002593716214 + -0.005732007538440292i, -0.027742864743348417 + -0.030671454116107243i }, { -0.015499590444532078 + 0.022730974601823776i, -0.0034987850764757245 + 0.001755451689332943i, 0.0013596150508376676 + -0.000719441985030911i, 0.005895788737603199 + -0.009062191107203032i, 0.10716863816482208 + -4.37888736770259e-21i, 0.013327560906551912 + 0.007407878419242288i, -0.0003206300971840484 + -7.794946711072636e-05i, -0.0022358586102965445 + 0.0006159589567305586i }, { -0.00035629303617903013 + 0.0038982256113931444i, -0.01704932909930507 + 0.025003748848806337i, 0.006485283778761674 + -0.009968281362041156i, 0.0001067931230111261 + -0.0015345178673339265i, 0.013327560906551912 + -0.00740787841924229i, 0.11788397814349845 + 8.074544228951693e-20i, -0.0024594126795078348 + 0.0006775460940433222i, -0.00023547553814811796 + 0.00023115157273302883i }, { 0.00028392650197764824 + -0.0014399083604728878i, 0.007326897452679573 + -0.008663652785721412i, -0.030516756740092965 + 0.033738163408325736i, -0.0013300002593716214 + 0.005732007538440292i, -0.0003206300971840483 + 7.794946711072636e-05i, -0.0024594126795078348 + -0.0006775460940433221i, 0.16376077628830538 + -6.109225132071641e-20i, 0.01851423539023979 + -0.010290795574507919i }, { 0.006660901967705439 + -0.007876149797459462i, 0.001372781620610131 + -0.0005190577686539385i, -0.005570240817137192 + 0.001896636061495115i, -0.027742864743348417 + 0.030671454116107243i, -0.0022358586102965445 + -0.0006159589567305587i, -0.00023547553814811796 + -0.0002311515727330289i, 0.01851423539023979 + 0.010290795574507915i, 0.14887535741513913 + 4.599124205794834e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, true, false, false, false, false, true, false, false}), ElementsAreArray({ DoubleNear(0.09297296705080998, 1.0e-7), DoubleNear(0.10226894176725197, 1.0e-7), DoubleNear(0.13989260331091458, 1.0e-7), DoubleNear(0.12717673785925965, 1.0e-7), DoubleNear(0.10716863816482208, 1.0e-7), DoubleNear(0.11788397814349845, 1.0e-7), DoubleNear(0.16376077628830538, 1.0e-7), DoubleNear(0.14887535741513913, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, true, false, false, false, false, false, true, false}), Matrix({ { 0.09391650096683911 + 1.9796500009925335e-20i, 0.0116795165843271 + 0.006491843440736793i, -1.0842021724855044e-19 + 0.0i, -8.673617379884035e-19 + 1.0842021724855044e-19i, 0.004315275279088325 + 0.007236467639949457i, 3.64399671017054e-05 + 0.001198218994210541i, -5.717472393966527e-21 + -5.929230630780102e-21i, -5.421010862427522e-20 + -6.776263578034403e-21i }, { 0.011679516584327101 + -0.006491843440736793i, 0.10330681565871414 + -1.819425116341012e-20i, -6.505213034913027e-19 + 4.607859233063394e-19i, -3.3881317890172014e-20 + 1.0842021724855044e-19i, 0.00103686086223487 + 0.0006016445642194866i, 0.004746741447818527 + 0.00796001150814243i, -5.421010862427522e-20 + -3.3881317890172014e-20i, -8.470329472543003e-21 + 3.3881317890172014e-21i }, { -1.0842021724855044e-19 + -2.0328790734103208e-20i, -7.589415207398531e-19 + -2.710505431213761e-19i, 0.14248942836242776 + -7.455213424817928e-20i, 0.01610936927093139 + -0.008954095187144939i, -4.235164736271502e-21 + -1.1011428314305904e-20i, 0.0 + -4.0657581468206416e-20i, 0.00654710409154744 + 0.010979115775870761i, 0.001430125501489681 + 0.0008298386654004399i }, { -8.673617379884035e-19 + -5.421010862427522e-19i, -7.453889935837843e-20 + -1.2197274440461925e-19i, 0.01610936927093139 + 0.008954095187144939i, 0.1295375184225368 + -1.8647959729395456e-20i, -2.710505431213761e-20 + -6.776263578034403e-20i, 5.082197683525802e-21 + -8.470329472543003e-21i, 5.0261060209435594e-05 + 0.0016526841762512638i, 0.005951989748431906 + 0.009981143362176877i }, { 0.004315275279088325 + -0.007236467639949457i, 0.0010368608622348702 + -0.0006016445642194866i, -2.541098841762901e-21 + 2.541098841762901e-21i, -3.3881317890172014e-21 + 6.776263578034403e-20i, 0.10622510424879297 + -1.7459714779463032e-20i, 0.013210222420698099 + 0.007342657990448321i, -1.4907779871675686e-19 + 2.0328790734103208e-20i, -7.589415207398531e-19 + 3.2526065174565133e-19i }, { 3.64399671017054e-05 + -0.0011982189942105412i, 0.004746741447818526 + -0.00796001150814243i, -3.049318610115481e-20 + 2.0328790734103208e-20i, 6.3527471044072525e-21 + 7.623296525288703e-21i, 0.013210222420698099 + -0.007342657990448321i, 0.11684610425203629 + 1.6589520775057247e-19i, -6.505213034913027e-19 + 4.0657581468206416e-19i, -4.743384504624082e-20 + 9.486769009248164e-20i }, { -1.207021949837378e-20 + 1.2705494208814505e-20i, -5.421010862427522e-20 + 6.776263578034403e-20i, 0.0065471040915474395 + -0.010979115775870761i, 5.026106020943558e-05 + -0.0016526841762512638i, -1.2197274440461925e-19 + -1.6940658945086007e-20i, -8.673617379884035e-19 + -2.981555974335137e-19i, 0.1611639512367922 + -6.205839827617835e-20i, 0.018220647197995612 + -0.010127610003740739i }, { -6.098637220230962e-20 + 3.3881317890172014e-20i, -7.623296525288703e-21 + -7.199780051661553e-21i, 0.001430125501489681 + -0.0008298386654004399i, 0.005951989748431906 + -0.009981143362176877i, -7.589415207398531e-19 + -4.607859233063394e-19i, -2.710505431213761e-20 + -1.2197274440461925e-19i, 0.01822064719799561 + 0.010127610003740737i, 0.14651457685186192 + 7.86549500864423e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, true, false, false, false, false, false, true, false}), ElementsAreArray({ DoubleNear(0.09391650096683911, 1.0e-7), DoubleNear(0.10330681565871414, 1.0e-7), DoubleNear(0.14248942836242776, 1.0e-7), DoubleNear(0.1295375184225368, 1.0e-7), DoubleNear(0.10622510424879297, 1.0e-7), DoubleNear(0.11684610425203629, 1.0e-7), DoubleNear(0.1611639512367922, 1.0e-7), DoubleNear(0.14651457685186192, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, true, false, false, false, false, false, false, true}), Matrix({ { 0.10407226385876812 + -1.0951044129589533e-20i, 0.012942493802405745 + 0.007193845985943695i, -1.3552527156068805e-19 + 1.6940658945086007e-20i, -7.589415207398531e-19 + 2.981555974335137e-19i, -0.0076146134805968975 + -0.007197422245146453i, -0.0004494467490053654 + -0.0014214253052452141i, 1.0164395367051604e-20 + 8.470329472543003e-22i, 9.486769009248164e-20 + 3.3881317890172014e-21i }, { 0.012942493802405745 + -0.0071938459859436955i, 0.11447801043438587 + 9.844069674840444e-20i, -7.589415207398531e-19 + 4.607859233063394e-19i, -4.0657581468206416e-20 + 8.809142651444724e-20i, -0.0014444697302994623 + -0.00036872683226413184i, -0.00837596655597442 + -0.007917062129048122i, 1.2874900798265365e-19 + 1.0164395367051604e-20i, 1.0164395367051604e-20 + -1.2705494208814505e-20i }, { -1.3552527156068805e-19 + -2.371692252312041e-20i, -8.673617379884035e-19 + -2.981555974335137e-19i, 0.1576389564444537 + -1.1195393282537698e-19i, 0.01782212329737714 + -0.00990609785882212i, 8.470329472543003e-21 + 1.1011428314305904e-20i, 3.3881317890172014e-20 + 9.486769009248164e-20i, -0.011580236767549282 + -0.010649522897710328i, -0.001978442578490831 + -0.0004762918582248903i }, { -8.673617379884035e-19 + -7.047314121155779e-19i, -6.776263578034403e-20 + -1.6263032587282567e-19i, 0.017822123297377136 + 0.009906097858822118i, 0.14330999470777145 + 7.501535539120897e-20i, 0.0 + 1.0842021724855044e-19i, -6.776263578034403e-21 + 1.5246593050577406e-20i, -0.0006400016454381164 + -0.0019317056878399646i, -0.010527624055015856 + -0.00968150959974751i }, { -0.0076146134805968975 + 0.007197422245146453i, -0.0014444697302994623 + 0.00036872683226413195i, 1.2705494208814505e-20 + -8.470329472543003e-21i, 2.0328790734103208e-20 + -9.486769009248164e-20i, 0.09606934135686396 + 1.3287829360051837e-20i, 0.011947245202619455 + 0.00664065544524142i, -1.2197274440461925e-19 + 3.3881317890172014e-21i, -8.673617379884035e-19 + 1.3552527156068805e-19i }, { -0.00044944674900536537 + 0.0014214253052452141i, -0.00837596655597442 + 0.007917062129048122i, -6.776263578034403e-21 + -1.0842021724855044e-19i, -9.317362419797304e-21 + -1.6940658945086007e-20i, 0.011947245202619455 + -0.006640655445241421i, 0.10567490947636457 + 4.9260259838757904e-20i, -5.421010862427522e-19 + 4.0657581468206416e-19i, -4.0657581468206416e-20 + 1.1519648082658485e-19i }, { 1.6940658945086007e-20 + -6.776263578034403e-21i, 7.453889935837843e-20 + 3.3881317890172014e-21i, -0.011580236767549282 + 0.010649522897710328i, -0.0006400016454381163 + 0.0019317056878399646i, -9.486769009248164e-20 + -1.3552527156068805e-20i, -7.589415207398531e-19 + -2.710505431213761e-19i, 0.14601442315476626 + -2.465659969898065e-20i, 0.016507893171549864 + -0.009175607332063558i }, { 9.486769009248164e-20 + 6.776263578034403e-21i, 1.3552527156068805e-20 + 1.6940658945086007e-20i, -0.001978442578490831 + 0.00047629185822489035i, -0.010527624055015856 + 0.009681509599747508i, -7.589415207398531e-19 + -2.981555974335137e-19i, -3.3881317890172014e-20 + -8.131516293641283e-20i, 0.016507893171549864 + 0.009175607332063558i, 0.1327421005666273 + -1.5008365034162134e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, true, false, false, false, false, false, false, true}), ElementsAreArray({ DoubleNear(0.10407226385876812, 1.0e-7), DoubleNear(0.11447801043438587, 1.0e-7), DoubleNear(0.1576389564444537, 1.0e-7), DoubleNear(0.14330999470777145, 1.0e-7), DoubleNear(0.09606934135686396, 1.0e-7), DoubleNear(0.10567490947636457, 1.0e-7), DoubleNear(0.14601442315476626, 1.0e-7), DoubleNear(0.1327421005666273, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, true, true, false, false, false, false, false}), Matrix({ { 0.07343858683659338 + 1.7275046707710568e-20i, 0.008632509822252311 + -0.0007648889738306676i, -0.0021986502426993193 + -0.013900654757551267i, -0.00040322572430167864 + -0.0016110851324741692i, 9.215718466126788e-19 + -1.0842021724855044e-18i, -6.776263578034403e-21 + -2.371692252312041e-20i, -1.4907779871675686e-19 + -6.437450399132683e-20i, -3.3881317890172014e-21 + 5.082197683525802e-21i }, { 0.008632509822252311 + 0.0007648889738306675i, 0.07233219105946412 + -8.573727049112132e-22i, -0.00011366520820035914 + -0.0016568845793424156i, -0.0021655262754677685 + -0.01369123316618395i, 1.4230153513872246e-19 + -1.6940658945086007e-19i, 9.215718466126788e-19 + -8.131516293641283e-19i, -2.371692252312041e-20 + -2.2658131339052534e-20i, -1.2197274440461925e-19 + -8.131516293641283e-20i }, { -0.0021986502426993193 + 0.013900654757551267i, -0.00011366520820035896 + 0.0016568845793424156i, 0.10508174221122306 + -5.92813461646847e-20i, 0.0123520782582075 + -0.001094463679524823i, 1.4907779871675686e-19 + 2.574980159653073e-19i, 1.1011428314305904e-20 + 8.470329472543003e-21i, 1.0842021724855044e-18 + -1.1926223897340549e-18i, 1.3552527156068805e-20 + -9.486769009248164e-20i }, { -0.00040322572430167853 + 0.0016110851324741692i, -0.0021655262754677685 + 0.013691233166183953i, 0.0123520782582075 + 0.001094463679524822i, 0.10349862356959436 + 3.054323052821427e-20i, 2.498747194400186e-20 + 7.453889935837843e-20i, 1.2197274440461925e-19 + 2.710505431213761e-19i, 3.2526065174565133e-19 + -1.6940658945086007e-19i, 1.4094628242311558e-18 + -9.215718466126788e-19i }, { 6.505213034913027e-19 + 8.673617379884035e-19i, 2.1006417091906648e-19 + 1.9651164376299768e-19i, 1.5585406229479126e-19 + -2.168404344971009e-19i, 2.1175823681357508e-20 + -4.743384504624082e-20i, 0.13363158884444865 + 6.535140429475195e-21i, 0.015708036509875692 + -0.0013918204756584538i, -0.0013008612959500283 + -0.027513093863400197i, -0.00043947142009379973 + -0.003220541798834646i }, { 2.0328790734103208e-20 + -1.3552527156068805e-20i, 8.673617379884035e-19 + 8.131516293641283e-19i, 1.0164395367051604e-20 + 5.082197683525802e-21i, 1.1519648082658485e-19 + -2.574980159653073e-19i, 0.015708036509875692 + 0.001391820475658453i, 0.13161834986536064 + 1.0414617502348895e-20i, 0.00013364587528413564 + -0.0032476396639928968i, -0.0012812630505797506 + -0.027098592820045994i }, { -1.0842021724855044e-19 + 4.743384504624082e-20i, -3.3034284942917713e-20 + 3.494010907423989e-20i, 1.0842021724855044e-18 + 1.2468324983583301e-18i, 2.710505431213761e-19 + 1.9651164376299768e-19i, -0.0013008612959500283 + 0.027513093863400197i, 0.00013364587528413586 + 0.0032476396639928963i, 0.19164306692258698 + -9.880258826639639e-20i, 0.022527130883616697 + -0.0019960306306866194i }, { -6.3527471044072525e-21 + -1.6940658945086007e-21i, -1.4907779871675686e-19 + 1.1858461261560205e-19i, 6.776263578034403e-21 + 7.453889935837843e-20i, 1.1926223897340549e-18 + 1.3552527156068805e-18i, -0.00043947142009379946 + 0.0032205417988346464i, -0.0012812630505797504 + 0.027098592820045994i, 0.022527130883616697 + 0.0019960306306866186i, 0.18875585069073006 + 1.6760747161855723e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, true, true, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.07343858683659338, 1.0e-7), DoubleNear(0.07233219105946412, 1.0e-7), DoubleNear(0.10508174221122306, 1.0e-7), DoubleNear(0.10349862356959436, 1.0e-7), DoubleNear(0.13363158884444865, 1.0e-7), DoubleNear(0.13161834986536064, 1.0e-7), DoubleNear(0.19164306692258698, 1.0e-7), DoubleNear(0.18875585069073006, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, true, false, true, false, false, false, false}), Matrix({ { 0.11287441982598441 + 1.0881974548441356e-20i, 0.00969915010266807 + 0.0008235984913680413i, -0.0019075916331274321 + -0.02257472778508407i, 8.017242762556098e-07 + -0.0019537355163869053i, -0.0007868097069738941 + 0.009050593279630509i, 0.020340815806949613 + -0.004524464612703286i, 0.0018234033141641612 + 4.404708695746938e-06i, -0.0012486489610899457 + -0.003991671005914908i }, { 0.00969915010266807 + -0.0008235984913680417i, 0.10858591873293996 + 4.943396776739404e-20i, -0.00032863539310610694 + -0.0019258976839778943i, -0.0018351154350981403 + -0.021717033500313742i, 0.02071367205088707 + -0.005174599525329466i, 0.0027571736017199507 + 0.007029357880559028i, -0.0013849763606117588 + -0.004055254378491191i, 0.0013592652755191842 + -0.0006702279215334225i }, { -0.0019075916331274317 + 0.02257472778508407i, -0.0003286353931061068 + 0.0019258976839778943i, 0.16174536274381082 + -9.199923452330088e-20i, 0.013898565805089268 + 0.0011801897803501498i, -0.0017968089517532491 + -0.00031031699673548667i, 0.0005611243633264616 + 0.00414459902721291i, -0.0011274726520060247 + 0.012969205027298272i, 0.029147725731589715 + -0.006483410245930327i }, { 8.017242762557115e-07 + 0.0019537355163869053i, -0.0018351154350981405 + 0.02171703350031374i, 0.013898565805089268 + -0.001180189780350151i, 0.15560008052671434 + 1.0427149288629073e-19i, 0.0006848491297203978 + 0.004230157120397134i, -0.0014524584241852744 + 0.0004326338891585884i, 0.029682016570204292 + -0.007415032374639859i, 0.003950939859052014 + 0.010072840613488124i }, { -0.0007868097069738941 + -0.009050593279630509i, 0.020713672050887068 + 0.005174599525329466i, -0.0017968089517532491 + 0.0003103169967354866i, 0.0006848491297203978 + -0.004230157120397134i, 0.09419575585505757 + 1.2928212588744408e-20i, 0.014641396229459933 + -0.0029803079408571628i, -0.0015919199055219155 + -0.018839020835867394i, -0.000843498868671734 + -0.00287789141492191i }, { 0.020340815806949613 + 0.004524464612703286i, 0.002757173601719951 + -0.007029357880559028i, 0.0005611243633264617 + -0.00414459902721291i, -0.0014524584241852741 + -0.00043263388915858853i, 0.014641396229459933 + 0.002980307940857162i, 0.0953646221918848 + -3.987672296995636e-20i, 0.00034861606018988346 + -0.002978626559357418i, -0.0016116738909493786 + -0.019072792485916205i }, { 0.0018234033141641612 + -4.40470869574689e-06i, -0.001384976360611759 + 0.00405525437849119i, -0.0011274726520060247 + -0.012969205027298274i, 0.029682016570204292 + 0.00741503237463986i, -0.0015919199055219155 + 0.018839020835867394i, 0.0003486160601898837 + 0.0029786265593574183i, 0.1349794463899992 + -6.608469990778021e-20i, 0.02098064333673493 + -0.004270684090561592i }, { -0.0012486489610899457 + 0.003991671005914908i, 0.0013592652755191842 + 0.0006702279215334227i, 0.029147725731589715 + 0.006483410245930327i, 0.003950939859052016 + -0.010072840613488124i, -0.0008434988686717338 + 0.0028778914149219102i, -0.001611673890949379 + 0.019072792485916205i, 0.02098064333673493 + 0.004270684090561592i, 0.13665439373361005 + 9.387920926048077e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, true, false, true, false, false, false, false}), ElementsAreArray({ DoubleNear(0.11287441982598441, 1.0e-7), DoubleNear(0.10858591873293996, 1.0e-7), DoubleNear(0.16174536274381082, 1.0e-7), DoubleNear(0.15560008052671434, 1.0e-7), DoubleNear(0.09419575585505757, 1.0e-7), DoubleNear(0.0953646221918848, 1.0e-7), DoubleNear(0.1349794463899992, 1.0e-7), DoubleNear(0.13665439373361005, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, true, false, false, true, false, false, false}), Matrix({ { 0.12090988369136695 + 1.6596551810263947e-20i, 0.014220804826958477 + -0.0011639331925026885i, -0.0020433919646953187 + -0.024181809439789783i, -0.00047311838561249063 + -0.0028244706739167453i, 1.7618285302889447e-19 + -4.0657581468206416e-20i, 2.879912020664621e-20 + -5.082197683525802e-20i, -8.470329472543003e-21 + -4.362219678359647e-20i, -1.0164395367051604e-20 + -9.740878893424454e-21i }, { 0.014220804826958477 + 0.0011639331925026883i, 0.11922627886360194 + 3.6687114527951883e-20i, -7.548329593061776e-06 + -0.0028638119032751846i, -0.00201493883520957 + -0.02384509080377781i, 6.776263578034403e-21 + 2.202285662861181e-20i, 1.1519648082658485e-19 + -1.0842021724855044e-19i, 1.0482032722271967e-20 + 5.823351512373315e-22i, -1.1858461261560205e-20 + -2.244637310223896e-20i }, { -0.0020433919646953187 + 0.02418180943978978i, -7.5483295930616135e-06 + 0.0028638119032751846i, 0.17325992042414967 + -1.1047162516768195e-19i, 0.020377949572555194 + -0.0016678783086650274i, 1.5246593050577406e-20 + 4.573977915173222e-20i, 8.470329472543003e-21 + 8.258571235729428e-21i, 2.303929616531697e-19 + -9.486769009248164e-20i, 6.437450399132683e-20 + -6.776263578034403e-20i }, { -0.0004731183856124904 + 0.0028244706739167453i, -0.00201493883520957 + 0.02384509080377781i, 0.020377949572555194 + 0.001667878308665027i, 0.1708473696087931 + 1.6232592340740615e-19i, -6.45862622281404e-21 + 3.917527381051139e-21i, 1.1858461261560205e-20 + 3.7269449679189215e-20i, -1.6940658945086007e-21 + 5.421010862427522e-20i, 2.439454888092385e-19 + -1.4907779871675686e-19i }, { 1.1519648082658485e-19 + 6.098637220230962e-20i, 1.0164395367051604e-20 + -2.625802136488331e-20i, 5.082197683525802e-21 + -5.590417451878382e-20i, -1.0587911840678754e-20 + -2.0117032497289633e-21i, 0.08616029198967505 + 7.213635326921816e-21i, 0.010119741505169526 + -0.000992776256986433i, -0.001456119573954029 + -0.01723193918116168i, -0.0003695787587829877 + -0.0020071562573920703i }, { 2.879912020664621e-20 + 5.759824041329242e-20i, 6.098637220230962e-20 + 6.776263578034403e-20i, 1.1858461261560205e-20 + -8.470329472543003e-21i, 1.5246593050577406e-20 + -2.0328790734103208e-20i, 0.010119741505169526 + 0.0009927762569864325i, 0.08472426206122281 + -2.71298697305142e-20i, 2.7528996676838295e-05 + -0.0020407123400601277i, -0.001431850490837949 + -0.016944735182452132i }, { -1.1858461261560205e-20 + 2.625802136488331e-20i, 7.72917564369549e-21 + 1.641126335305207e-21i, 2.303929616531697e-19 + 1.2197274440461925e-19i, -7.623296525288703e-21 + -5.675120746603812e-20i, -0.001456119573954029 + 0.01723193918116168i, 2.752899667683849e-05 + 0.0020407123400601277i, 0.12346488870966038 + -4.7612309263399135e-20i, 0.014501259569269002 + -0.0014226160015464152i }, { -1.3129010682441655e-20 + 7.623296525288703e-21i, -1.8634724839594607e-20 + 1.5246593050577406e-20i, 4.743384504624082e-20 + 8.131516293641283e-20i, 2.710505431213761e-19 + 1.0842021724855044e-19i, -0.00036957875878298763 + 0.0020071562573920703i, -0.0014318504908379492 + 0.016944735182452132i, 0.014501259569269 + 0.0014226160015464136i, 0.12140710465153133 + 3.582477873936535e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, true, false, false, true, false, false, false}), ElementsAreArray({ DoubleNear(0.12090988369136695, 1.0e-7), DoubleNear(0.11922627886360194, 1.0e-7), DoubleNear(0.17325992042414967, 1.0e-7), DoubleNear(0.1708473696087931, 1.0e-7), DoubleNear(0.08616029198967505, 1.0e-7), DoubleNear(0.08472426206122281, 1.0e-7), DoubleNear(0.12346488870966038, 1.0e-7), DoubleNear(0.12140710465153133, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, true, false, false, false, true, false, false}), Matrix({ { 0.09571267334929959 + 2.9784705906503144e-21i, 0.011252915629757575 + -0.0009718242924163239i, -0.0016190712312799769 + -0.01914115691683576i, -0.0003839808362605921 + -0.002233240361146212i, -0.018913072740045233 + -0.023210049692194135i, -0.002435919161337564 + -0.0023821343697868124i, -0.00433064721616427 + 0.00418329675439842i, -0.0004313212033967733 + 0.0005325064021104949i }, { 0.011252915629757575 + 0.0009718242924163237i, 0.09430694999594 + -8.124774771648976e-21i, 3.4098626692427158e-06 + -0.002267714230424415i, -0.0015941383686713744 + -0.01886098067684593i, -0.0019846529718217736 + -0.0030771839799120697i, -0.018410385435189303 + -0.02288367617687137i, -0.0005870302404246104 + 0.0004450907853338651i, -0.004267424792671589 + 0.004070681834506401i }, { -0.001619071231279977 + 0.01914115691683576i, 3.4098626692429055e-06 + 0.0022677142304244153i, 0.13715289701242495 + -7.178107919612664e-20i, 0.016125043547402927 + -0.0013924623120186118i, 0.004951707344817307 + -0.0033968432328158843i, 0.000513381524567634 + -0.0004420799989163946i, -0.027103274444579814 + -0.03325908831795538i, -0.0034906146919786592 + -0.0034127273031014462i }, { -0.00038398083626059194 + 0.002233240361146212i, -0.0015941383686713746 + 0.018860980676845933i, 0.016125043547402927 + 0.0013924623120186107i, 0.1351387296305716 + 8.909603736839289e-20i, 0.0006517471723703234 + -0.00035070848450939065i, 0.004885623860057732 + -0.003296771736385517i, -0.002844132364025572 + -0.004410275247861166i, -0.026381808407464184 + -0.0327915267880422i }, { -0.018913072740045236 + 0.023210049692194135i, -0.001984652971821774 + 0.0030771839799120697i, 0.004951707344817308 + 0.0033968432328158847i, 0.0006517471723703234 + 0.00035070848450939065i, 0.1113575023317424 + 2.083171654653545e-20i, 0.013087630702370429 + -0.0011848851570727974i, -0.0018804403073693706 + -0.022272591704115708i, -0.00045871630813488617 + -0.002598386570162603i }, { -0.002435919161337564 + 0.0023821343697868124i, -0.018410385435189303 + 0.02288367617687137i, 0.0005133815245676342 + 0.00044207999891639465i, 0.004885623860057732 + 0.0032967717363855164i, 0.013087630702370429 + 0.0011848851570727971i, 0.10964359092888476 + 1.7682019569086658e-20i, 1.6570804414533803e-05 + -0.0026368100129108975i, -0.0018526509573761445 + -0.021928845309384014i }, { -0.00433064721616427 + -0.00418329675439842i, -0.0005870302404246104 + -0.00044509078533386503i, -0.027103274444579814 + 0.03325908831795538i, -0.002844132364025572 + 0.004410275247861166i, -0.0018804403073693706 + 0.022272591704115705i, 1.6570804414533965e-05 + 0.0026368100129108975i, 0.15957191212138508 + -8.630285523495445e-20i, 0.018754165594421272 + -0.0016980319981928305i }, { -0.00043132120339677335 + -0.0005325064021104949i, -0.004267424792671589 + -0.004070681834506401i, -0.003490614691978659 + 0.0034127273031014462i, -0.026381808407464187 + 0.0327915267880422i, -0.0004587163081348861 + 0.002598386570162604i, -0.0018526509573761447 + 0.021928845309384014i, 0.018754165594421272 + 0.0016980319981928298i, 0.1571157446297528 + 1.0905466477837862e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, true, false, false, false, true, false, false}), ElementsAreArray({ DoubleNear(0.09571267334929959, 1.0e-7), DoubleNear(0.09430694999594, 1.0e-7), DoubleNear(0.13715289701242495, 1.0e-7), DoubleNear(0.1351387296305716, 1.0e-7), DoubleNear(0.1113575023317424, 1.0e-7), DoubleNear(0.10964359092888476, 1.0e-7), DoubleNear(0.15957191212138508, 1.0e-7), DoubleNear(0.1571157446297528, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, true, false, false, false, false, true, false}), Matrix({ { 0.10185658631426647 + 2.016480217766457e-20i, 0.011972969792780168 + -0.0010608725349953664i, 0.00024419165518599356 + -0.026900322060992167i, -0.000251472334511745 + -0.003164604384816609i, -0.015201423132338222 + -0.006337654599960778i, -0.001852895630036507 + -0.0005866461556457489i, -0.038037644339355484 + -0.0037140832028662598i, -0.004509907038401175 + -4.040498478466405e-05i }, { 0.011972969792780168 + 0.0010608725349953657i, 0.10032205655511335 + -5.3820506555762746e-21i, 0.000308880488799778 + -0.0031595176991218296i, 0.00024051276336977247 + -0.026495052787525317i, -0.0017208777813204497 + -0.0009033026012914649i, -0.014972404695512948 + -0.006242174082315435i, -0.004432540046139104 + -0.0008327561450923438i, -0.03746458471386666 + -0.003658128341143481i }, { 0.0002441916551859935 + 0.026900322060992167i, 0.0003088804887997781 + 0.00315951769912183i, 0.13454934301500038 + -7.492043641591851e-20i, 0.01581591606247832 + -0.00140137921141278i, -0.01158059237912951 + -0.012822920088900193i, -0.0014948229858086901 + -0.0013866840387704782i, 0.026063802502973986 + 0.024553238015780996i, 0.0033194610986278933 + 0.0026147038152567297i }, { -0.0002514723345117448 + 0.003164604384816609i, 0.00024051276336977247 + 0.026495052787525317i, 0.01581591606247832 + 0.0014013792114127793i, 0.1325222775261376 + -3.14601602372293e-20i, -0.0012277124486700782 + -0.0016279160069436424i, -0.011406123900679166 + -0.012629735208199907i, 0.002807999703764755 + 0.003157631341762215i, 0.025671135891763383 + 0.024183328952634742i }, { -0.015201423132338222 + 0.006337654599960778i, -0.0017208777813204495 + 0.0009033026012914649i, -0.01158059237912951 + 0.012822920088900193i, -0.0012277124486700782 + 0.0016279160069436424i, 0.10521358936677551 + 3.645384959521193e-21i, 0.012367576539347835 + -0.001095836914493755i, -0.003743703193835341 + -0.0145134265599593i, -0.0005912248098837333 + -0.0016670225464922067i }, { -0.001852895630036507 + 0.0005866461556457489i, -0.014972404695512948 + 0.006242174082315436i, -0.0014948229858086901 + 0.0013866840387704782i, -0.011406123900679166 + 0.012629735208199907i, 0.012367576539347835 + 0.0010958369144937548i, 0.1036284843697114 + 1.4939295453013956e-20i, -0.00028889982171600146 + -0.0017450065442134823i, -0.0036873020894172912 + -0.014294773198704628i }, { -0.03803764433935549 + 0.0037140832028662598i, -0.004432540046139104 + 0.0008327561450923439i, 0.026063802502973986 + -0.024553238015780996i, 0.002807999703764755 + -0.003157631341762215i, -0.003743703193835341 + 0.0145134265599593i, -0.00028889982171600114 + 0.0017450065442134823i, 0.16217546611880967 + -8.316349801516257e-20i, 0.019063293079345876 + -0.0016891150987986625i }, { -0.004509907038401176 + 4.0404984784664244e-05i, -0.03746458471386666 + 0.0036581283411434807i, 0.0033194610986278933 + -0.0026147038152567297i, 0.025671135891763383 + -0.024183328952634742i, -0.0005912248098837333 + 0.0016670225464922067i, -0.0036873020894172917 + 0.01429477319870463i, 0.019063293079345876 + 0.0016891150987986612i, 0.15973219673418682 + 2.296108623840008e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, true, false, false, false, false, true, false}), ElementsAreArray({ DoubleNear(0.10185658631426647, 1.0e-7), DoubleNear(0.10032205655511335, 1.0e-7), DoubleNear(0.13454934301500038, 1.0e-7), DoubleNear(0.1325222775261376, 1.0e-7), DoubleNear(0.10521358936677551, 1.0e-7), DoubleNear(0.1036284843697114, 1.0e-7), DoubleNear(0.16217546611880967, 1.0e-7), DoubleNear(0.15973219673418682, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, true, false, false, false, false, false, true}), Matrix({ { 0.10756873331282596 + -1.5643019359143445e-20i, 0.012644894966457845 + -0.0011147917084060933i, -0.0018179248758931395 + -0.02151359782373236i, -0.0004366570855479185 + -0.002510121379493517i, -0.007889481104135333 + -0.007335464181842578i, -0.0009979128112272214 + -0.0007800010684447343i, -0.0013337494816846752 + 0.0017018555549251808i, -0.00013913428469566815 + 0.0002127632958443753i }, { 0.012644894966457845 + 0.0011147917084060926i, 0.10595621060592622 + 7.4280819007261885e-22i, 9.2565128233391e-06 + -0.002547801614553219i, -0.0017906730430274451 + -0.021191095513539766i, -0.0008567609186000754 + -0.0009455254229166245i, -0.007769767359353147 + -0.007233377563209319i, -0.0001746244109754414 + 0.00018733049465555378i, -0.0013153554762808863 + 0.001676187695151314i }, { -0.0018179248758931398 + 0.021513597823732356i, 9.256512823339316e-06 + 0.002547801614553219i, 0.15414248699039584 + -1.0726195759582307e-19i, 0.018119722133325036 + -0.0015974601644723318i, 0.001600415891437524 + -0.0014539150539691335i, 0.00017286398416561832 + -0.0001863990670972504i, -0.011305369144010846 + -0.010511480961014202i, -0.0014299765162689752 + -0.0011177160950253703i }, { -0.0004366570855479184 + 0.002510121379493517i, -0.0017906730430274453 + 0.021191095513539766i, 0.018119722133325033 + 0.001597460164472331i, 0.15183179453623108 + 1.727132439495408e-19i, 0.000203583141614885 + -0.00015537150184840207i, 0.0015779755318948807 + -0.0014316977471169887i, -0.0012277104571375031 + -0.0013549070971874719i, -0.011133823251637127 + -0.010365194165586313i }, { -0.007889481104135333 + 0.007335464181842578i, -0.0008567609186000754 + 0.0009455254229166245i, 0.001600415891437524 + 0.0014539150539691337i, 0.00020358314161488504 + 0.00015537150184840207i, 0.09950144236821604 + 3.945320649632921e-20i, 0.011695651365670157 + -0.0010419177410830281i, -0.0016815866627562077 + -0.01990015079721911i, -0.00040604005884755984 + -0.002321505551815298i }, { -0.0009979128112272214 + 0.0007800010684447343i, -0.007769767359353148 + 0.007233377563209319i, 0.00017286398416561835 + 0.00018639906709725038i, 0.0015779755318948807 + 0.0014316977471169885i, 0.011695651365670157 + 0.001041917741083028i, 0.09799433031889852 + 8.814436607365063e-21i, 1.0724154260437419e-05 + -0.002356722628782093i, -0.001656116283020074 + -0.01959873047269018i }, { -0.0013337494816846752 + -0.0017018555549251804i, -0.0001746244109754414 + -0.00018733049465555375i, -0.011305369144010848 + 0.010511480961014202i, -0.0012277104571375031 + 0.0013549070971874719i, -0.0016815866627562077 + 0.01990015079721911i, 1.0724154260437582e-05 + 0.0023567226287820936i, 0.1425823221434142 + -5.082197683525802e-20i, 0.016759487008499163 + -0.0014930341457391107i }, { -0.00013913428469566815 + -0.0002127632958443753i, -0.0013153554762808863 + -0.001676187695151314i, -0.001429976516268975 + 0.0011177160950253703i, -0.011133823251637127 + 0.010365194165586311i, -0.00040604005884755973 + 0.0023215055518152985i, -0.001656116283020074 + 0.01959873047269018i, 0.016759487008499163 + 0.0014930341457391099i, 0.14042267972409334 + 2.5437458197230707e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, true, false, false, false, false, false, true}), ElementsAreArray({ DoubleNear(0.10756873331282596, 1.0e-7), DoubleNear(0.10595621060592622, 1.0e-7), DoubleNear(0.15414248699039584, 1.0e-7), DoubleNear(0.15183179453623108, 1.0e-7), DoubleNear(0.09950144236821604, 1.0e-7), DoubleNear(0.09799433031889852, 1.0e-7), DoubleNear(0.1425823221434142, 1.0e-7), DoubleNear(0.14042267972409334, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, true, true, false, false, false, false}), Matrix({ { 0.09731183402990154 + -2.176043357927936e-20i, 0.008361877620075786 + 0.0007100446657696486i, 1.0299920638612292e-18 + -1.463672932855431e-18i, 1.6940658945086007e-19 + -1.2197274440461925e-19i, -0.0006783281432249991 + 0.007802740713594318i, 0.017536321293081917 + -0.0039006530456087334i, 2.981555974335137e-19 + 1.7618285302889447e-19i, 2.439454888092385e-19 + -2.0328790734103208e-19i }, { 0.008361877620075786 + -0.0007100446657696492i, 0.0936146109810764 + 1.598774687942492e-20i, 3.3881317890172014e-20 + -3.3881317890172014e-20i, 1.2468324983583301e-18 + -7.589415207398531e-19i, 0.01785776989926737 + -0.004461150462224993i, 0.0023770276767387816 + 0.006060183595754529i, 1.2197274440461925e-19 + -1.7618285302889447e-19i, -1.3552527156068805e-19 + -6.776263578034403e-20i }, { 7.047314121155779e-19 + 1.3552527156068805e-18i, -1.6940658945086007e-20 + 3.3881317890172014e-20i, 0.17730794853989368 + -5.935682639558016e-20i, 0.01523583828768155 + 0.0012937436059485426i, -6.098637220230962e-20 + -2.168404344971009e-19i, 2.710505431213761e-19 + 4.0657581468206416e-20i, -0.0012359542157549198 + 0.014217057593334465i, 0.03195222024545741 + -0.007107221813024879i }, { 1.6940658945086007e-19 + 1.2874900798265365e-19i, 8.131516293641283e-19 + 1.2468324983583301e-18i, 0.01523583828768155 + -0.0012937436059485433i, 0.17057138827857787 + 1.3771771377425985e-19i, 2.981555974335137e-19 + 2.574980159653073e-19i, -4.912791094074942e-20 + 3.1170812458958252e-19i, 0.03253791872182399 + -0.008128481437744332i, 0.004331085784033182 + 0.011042014898292624i }, { -0.0006783281432249991 + -0.007802740713594318i, 0.017857769899267375 + 0.004461150462224993i, -6.437450399132683e-20 + 2.0328790734103208e-19i, 2.574980159653073e-19 + -1.7618285302889447e-19i, 0.08120849501791488 + -2.0245865877694767e-20i, 0.012622710460384023 + -0.0025693973191251397i, 9.75781955236954e-19 + -7.047314121155779e-19i, -1.6263032587282567e-19 + -6.776263578034403e-21i }, { 0.017536321293081917 + 0.0039006530456087334i, 0.0023770276767387825 + -0.006060183595754529i, 1.4907779871675686e-19 + -6.776263578034403e-21i, -3.8963515573697816e-20 + -2.710505431213761e-19i, 0.012622710460384023 + 0.002569397319125139i, 0.08221620364798204 + 1.3698110943878138e-20i, 4.87890977618477e-19 + -2.981555974335137e-19i, 8.131516293641283e-19 + -1.0842021724855044e-18i }, { 2.439454888092385e-19 + -2.371692252312041e-19i, 8.131516293641283e-20 + 2.710505431213761e-19i, -0.0012359542157549198 + -0.014217057593334465i, 0.03253791872182399 + 0.008128481437744334i, 9.75781955236954e-19 + 8.131516293641283e-19i, 4.87890977618477e-19 + 3.3881317890172014e-19i, 0.14796670722714192 + -3.2910621441341036e-20i, 0.022999329105810838 + -0.0046815947122936154i }, { 2.439454888092385e-19 + 2.574980159653073e-19i, -1.7618285302889447e-19 + 6.776263578034403e-20i, 0.03195222024545741 + 0.007107221813024879i, 0.004331085784033184 + -0.011042014898292624i, -1.0842021724855044e-19 + -5.421010862427522e-20i, 9.75781955236954e-19 + 8.131516293641283e-19i, 0.022999329105810838 + 0.0046815947122936154i, 0.1498028122775128 + 4.0304375346646273e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, true, true, false, false, false, false}), ElementsAreArray({ DoubleNear(0.09731183402990154, 1.0e-7), DoubleNear(0.0936146109810764, 1.0e-7), DoubleNear(0.17730794853989368, 1.0e-7), DoubleNear(0.17057138827857787, 1.0e-7), DoubleNear(0.08120849501791488, 1.0e-7), DoubleNear(0.08221620364798204, 1.0e-7), DoubleNear(0.14796670722714192, 1.0e-7), DoubleNear(0.1498028122775128, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, true, false, true, false, false, false}), Matrix({ { 0.10423940652353544 + -3.382837833096862e-20i, 0.012260108191262963 + -0.001003455644116107i, -1.0842021724855044e-19 + -3.144186300207963e-18i, -7.589415207398531e-19 + 2.236166980751353e-19i, -2.642742795433417e-19 + -6.2341624917916505e-19i, -5.844527336054672e-20 + 3.3881317890172014e-20i, -0.0006915265408169178 + -0.0025245122401656305i, -0.00012607860773152833 + -0.0003134191391322989i }, { 0.012260108191262963 + 0.0010034556441161065i, 0.10278792908671684 + 2.752857078576476e-20i, 7.860465750519907e-19 + -7.860465750519907e-19i, 4.336808689942018e-19 + -2.2768245622195593e-18i, 1.5246593050577406e-20 + -1.7279472123987727e-19i, -1.2536087619363645e-19 + -6.098637220230962e-19i, -4.08250332088831e-05 + -0.0002772820189788644i, -0.0007176623320907399 + -0.0024628534909457017i }, { -4.336808689942018e-19 + 3.469446951953614e-18i, 7.860465750519907e-19 + 8.944667923005412e-19i, 0.18993039759198116 + -6.004669502644938e-20i, 0.02233864620825071 + -0.001828355857051609i, 0.0021437225478390227 + -0.0015019402935159817i, 0.0002525861793868143 + -0.0002243381244566425i, 7.047314121155779e-19 + 4.726443845678996e-19i, 1.4907779871675686e-19 + -1.4907779871675686e-19i }, { -7.318364664277155e-19 + -2.0328790734103208e-19i, 3.7947076036992655e-19 + 2.2768245622195593e-18i, 0.022338646208250712 + 0.0018283558570516092i, 0.18728571938567817 + 1.7148446714959327e-19i, 0.00024729786158611403 + -0.00013189302119686577i, 0.0020768626012570655 + -0.0015057650136276533i, -1.0164395367051604e-20 + 2.574980159653073e-19i, 4.743384504624082e-19 + 3.2526065174565133e-19i }, { -2.574980159653073e-19 + 6.369687763352339e-19i, 2.0328790734103208e-20 + 1.8973538018496328e-19i, 0.0021437225478390227 + 0.0015019402935159815i, 0.00024729786158611403 + 0.00013189302119686575i, 0.07428092252428098 + -8.177921126005508e-21i, 0.008724479889196848 + -0.0008558970092393838i, 2.168404344971009e-18 + 1.179069862577986e-18i, 7.860465750519907e-19 + -3.5236570605778894e-19i }, { -7.115076756936123e-20 + -4.404571325722362e-20i, -9.147955830346444e-20 + 5.963111948670274e-19i, 0.0002525861793868143 + 0.00022433812445664248i, 0.0020768626012570655 + 0.0015057650136276533i, 0.008724479889196848 + 0.0008558970092393831i, 0.07304288554234165 + 2.157287037538296e-21i, -2.913793338554793e-19 + 4.87890977618477e-19i, 1.734723475976807e-18 + 5.149960319306146e-19i }, { -0.000691526540816918 + 0.0025245122401656305i, -4.082503320888311e-05 + 0.0002772820189788644i, 5.963111948670274e-19 + -4.489274620447792e-19i, -1.5246593050577406e-20 + -2.778268066994105e-19i, 2.3852447794681098e-18 + -1.1384122811097797e-18i, -2.913793338554793e-19 + -5.014435047745458e-19i, 0.13534425817505444 + -3.222075281047181e-20i, 0.01589652118524168 + -0.001559495249293464i }, { -0.0001260786077315283 + 0.0003134191391322989i, -0.0007176623320907397 + 0.0024628534909457017i, 1.4568966692773966e-19 + 1.8295911660692887e-19i, 3.9302328752599536e-19 + -3.4220131069073734e-19i, 7.860465750519907e-19 + 2.846030702774449e-19i, 1.6805133673525319e-18 + -2.168404344971009e-19i, 0.01589652118524168 + 0.001559495249293463i, 0.1330884811704125 + 6.537621971312854e-21i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, true, false, true, false, false, false}), ElementsAreArray({ DoubleNear(0.10423940652353544, 1.0e-7), DoubleNear(0.10278792908671684, 1.0e-7), DoubleNear(0.18993039759198116, 1.0e-7), DoubleNear(0.18728571938567817, 1.0e-7), DoubleNear(0.07428092252428098, 1.0e-7), DoubleNear(0.07304288554234165, 1.0e-7), DoubleNear(0.13534425817505444, 1.0e-7), DoubleNear(0.1330884811704125, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, true, false, false, true, false, false}), Matrix({ { 0.08269857556524833 + -2.0051892024051082e-20i, 0.00971463097499373 + -0.0009356496767470412i, -0.003487313472030529 + 0.002840558048583484i, -0.00025310969159142427 + 0.0002632836504043727i, -0.015210158091893404 + -0.020127154367483698i, -0.002083561883994013 + -0.002649848552188447i, -0.02005300163551653 + -0.006569709030089909i, -0.0023705936499730258 + -0.0006353342317700354i }, { 0.00971463097499373 + 0.0009356496767470406i, 0.08134517803090965 + 1.2493529176847792e-20i, -0.0005830727458739607 + 0.0003813202843280717i, -0.003572682223436169 + 0.0026019157473103037i, -0.0015687538578868705 + -0.0020737535665321825i, -0.015626812718357225 + -0.019754824888562963i, -0.002355193845553336 + -0.0009195728682004629i, -0.019847429037529764 + -0.006558571283853856i }, { -0.00348731347203053 + -0.002840558048583484i, -0.0005830727458739608 + -0.0003813202843280717i, 0.15016699479647622 + -4.875071658142524e-20i, 0.01766332820216677 + -0.0014286369276878947i, -0.00044164983203486506 + -0.02141062116945937i, -0.0003611867218356916 + -0.0025397041398195035i, -0.03080618909273164 + -0.03634198364266582i, -0.00384297196932221 + -0.003145013120699811i }, { -0.00025310969159142427 + -0.0002632836504043726i, -0.0035726822234361695 + -0.0026019157473103037i, 0.01766332820216677 + 0.001428636927687894i, 0.14810050159560195 + 6.847773341989612e-20i, 0.0002514160926244511 + -0.0024795472255040247i, -0.00048515768627313565 + -0.020967562640597483i, -0.003260031477960475 + -0.005413705661241053i, -0.029165381124296265 + -0.035920378076350616i }, { -0.015210158091893406 + 0.020127154367483698i, -0.0015687538578868707 + 0.0020737535665321825i, -0.00044164983203486517 + 0.021410621169459368i, 0.00025141609262445126 + 0.0024795472255040247i, 0.09582175348256809 + -2.1954407432923046e-20i, 0.01126995710546608 + -0.0009237029766084496i, 0.003487313472030531 + -0.002840558048583486i, 0.00025310969159142427 + -0.00026328365040437284i }, { -0.002083561883994013 + 0.002649848552188447i, -0.015626812718357225 + 0.019754824888562963i, -0.0003611867218356916 + 0.002539704139819503i, -0.00048515768627313517 + 0.020967562640597483i, 0.011269957105466077 + 0.000923702976608449i, 0.09448563659814882 + 1.7192328646455265e-20i, 0.0005830727458739611 + -0.000381320284328072i, 0.0035726822234361712 + -0.0026019157473103054i }, { -0.02005300163551653 + 0.006569709030089909i, -0.002355193845553336 + 0.0009195728682004629i, -0.03080618909273164 + 0.03634198364266582i, -0.0032600314779604755 + 0.005413705661241053i, 0.0034873134720305315 + 0.002840558048583486i, 0.0005830727458739612 + 0.0003813202843280721i, 0.17510766097055938 + -4.3516731255495956e-20i, 0.020571839191325623 + -0.0019592141786571784i }, { -0.0023705936499730258 + 0.0006353342317700358i, -0.019847429037529764 + 0.006558571283853856i, -0.00384297196932221 + 0.0031450131206998116i, -0.029165381124296265 + 0.035920378076350616i, 0.00025310969159142427 + 0.00026328365040437273i, 0.0035726822234361712 + 0.002601915747310306i, 0.020571839191325623 + 0.001959214178657178i, 0.17227369896048872 + 1.0954435570101e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, true, false, false, true, false, false}), ElementsAreArray({ DoubleNear(0.08269857556524833, 1.0e-7), DoubleNear(0.08134517803090965, 1.0e-7), DoubleNear(0.15016699479647622, 1.0e-7), DoubleNear(0.14810050159560195, 1.0e-7), DoubleNear(0.09582175348256809, 1.0e-7), DoubleNear(0.09448563659814882, 1.0e-7), DoubleNear(0.17510766097055938, 1.0e-7), DoubleNear(0.17227369896048872, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, true, false, false, false, true, false}), Matrix({ { 0.0830621107430102 + -4.210473394986794e-20i, 0.009763729365347168 + -0.0008651213944489014i, 9.75781955236954e-19 + -7.589415207398531e-19i, 0.0 + -5.421010862427522e-20i, 0.004591856932670682 + 0.006984892577875748i, 0.0006125106613224212 + 0.0007732296534386316i, 1.6263032587282567e-19 + -2.0328790734103208e-20i, 8.470329472543003e-21 + 6.776263578034403e-21i }, { 0.009763729365347168 + 0.0008651213944489012i, 0.08181073088231121 + -2.0887551237882778e-20i, 2.168404344971009e-19 + -1.6263032587282567e-19i, 1.0842021724855044e-18 + -1.0842021724855044e-18i, 0.000467010385613231 + 0.0008688812962193615i, 0.004522677890176404 + 0.006879661037009382i, 3.3881317890172014e-20 + 9.317362419797304e-21i, 1.7618285302889447e-19 + 6.776263578034403e-20i }, { 7.589415207398531e-19 + 1.1926223897340549e-18i, 1.8973538018496328e-19 + 1.6263032587282567e-19i, 0.15334381858625667 + -1.2650900288386005e-20i, 0.01802515648991132 + -0.0015971303519592452i, -5.421010862427522e-20 + 1.0842021724855044e-19i, -1.2705494208814505e-20 + 4.743384504624082e-20i, 0.0062705224379650815 + 0.01123069083794447i, 0.0008540548072689651 + 0.0012548280061723495i }, { 8.131516293641283e-20 + 0.0i, 1.1926223897340549e-18 + 1.0842021724855044e-18i, 0.01802515648991132 + 0.001597130351959244i, 0.15103360319893977 + -1.5954659654922798e-20i, -1.1858461261560205e-20 + 0.0i, -1.3552527156068805e-20 + 1.0842021724855044e-19i, 0.0006201115368310746 + 0.0013854474442513889i, 0.00617605330607403 + 0.011061493833309923i }, { 0.004591856932670682 + -0.006984892577875747i, 0.000467010385613231 + -0.0008688812962193614i, 3.3881317890172014e-20 + -9.486769009248164e-20i, -1.5246593050577406e-20 + -3.3881317890172014e-21i, 0.09545821830480623 + 9.843449289381029e-23i, 0.011220858715112641 + -0.0009942312589065892i, 1.0842021724855044e-18 + -9.75781955236954e-19i, 2.710505431213761e-20 + -8.131516293641283e-20i }, { 0.0006125106613224212 + -0.0007732296534386316i, 0.004522677890176404 + -0.006879661037009383i, -1.1858461261560205e-20 + -2.371692252312041e-20i, -3.3881317890172014e-20 + -1.2197274440461925e-19i, 0.011220858715112641 + 0.0009942312589065884i, 0.09402008374674728 + 5.0573409061185836e-20i, 2.439454888092385e-19 + -1.3552527156068805e-19i, 9.75781955236954e-19 + -7.589415207398531e-19i }, { 1.3552527156068805e-19 + -3.049318610115481e-20i, 3.3881317890172014e-20 + -4.235164736271502e-21i, 0.006270522437965082 + -0.011230690837944472i, 0.0006201115368310748 + -0.0013854474442513889i, 1.0842021724855044e-18 + 1.0842021724855044e-18i, 2.710505431213761e-19 + 2.439454888092385e-19i, 0.17193083718077895 + -7.961654754853519e-20i, 0.020210010903581068 + -0.001790720754385828i }, { 1.6940658945086007e-21 + -4.235164736271502e-21i, 1.4907779871675686e-19 + -4.0657581468206416e-20i, 0.000854054807268965 + -0.0012548280061723492i, 0.006176053306074029 + -0.011061493833309923i, -2.710505431213761e-20 + 6.776263578034403e-20i, 8.673617379884035e-19 + 1.0842021724855044e-18i, 0.020210010903581068 + 0.0017907207543858279i, 0.16934059735715093 + 1.9397674877582893e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, true, false, false, false, true, false}), ElementsAreArray({ DoubleNear(0.0830621107430102, 1.0e-7), DoubleNear(0.08181073088231121, 1.0e-7), DoubleNear(0.15334381858625667, 1.0e-7), DoubleNear(0.15103360319893977, 1.0e-7), DoubleNear(0.09545821830480623, 1.0e-7), DoubleNear(0.09402008374674728, 1.0e-7), DoubleNear(0.17193083718077895, 1.0e-7), DoubleNear(0.16934059735715093, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, true, false, false, false, false, true}), Matrix({ { 0.0927376702275171 + -3.815494652492723e-20i, 0.010901477254089194 + -0.0009610895530942147i, 1.0842021724855044e-18 + -9.75781955236954e-19i, -1.3552527156068805e-20 + -5.421010862427522e-20i, -0.0068017171381369364 + -0.006324085422509741i, -0.0008603253599191549 + -0.0006724582472508656i, -1.6263032587282567e-19 + 1.3552527156068805e-20i, -6.776263578034403e-21 + 4.235164736271502e-21i }, { 0.010901477254089192 + 0.0009610895530942142i, 0.09134747444830343 + 3.992966252915975e-20i, 2.168404344971009e-19 + -1.4907779871675686e-19i, 9.75781955236954e-19 + -9.75781955236954e-19i, -0.0007386348159543189 + -0.0008151608944503611i, -0.006698508952603831 + -0.006236074019178243i, -4.0657581468206416e-20 + -1.1858461261560205e-20i, -1.4907779871675686e-19 + -2.0328790734103208e-20i }, { 9.75781955236954e-19 + 1.0842021724855044e-18i, 2.439454888092385e-19 + 2.303929616531697e-19i, 0.16897355007570472 + -8.475003043003928e-20i, 0.019863139845693687 + -0.0017511623197842105i, -2.0328790734103208e-20 + -1.3552527156068805e-19i, -3.8116482626443515e-21 + -2.371692252312041e-20i, -0.012393133110009242 + -0.011522859720347042i, -0.0015675639675770416 + -0.0012252589162192388i }, { 1.3552527156068805e-20 + 2.710505431213761e-20i, 1.0842021724855044e-18 + 1.0842021724855044e-18i, 0.019863139845693687 + 0.0017511623197842096i, 0.16644053069385384 + 1.3352638961045366e-19i, -2.541098841762901e-21 + 8.470329472543003e-21i, -2.710505431213761e-20 + -1.3552527156068805e-19i, -0.0013458365597832597 + -0.0014852716256537352i, -0.012205081658386446 + -0.011362497709617388i }, { -0.0068017171381369364 + 0.00632408542250974i, -0.0007386348159543189 + 0.0008151608944503611i, -2.0328790734103208e-20 + 1.2197274440461925e-19i, -7.623296525288703e-21 + 0.0i, 0.08578265882029934 + -3.851352932046897e-21i, 0.010083110826370617 + -0.0008982631002612761i, 9.75781955236954e-19 + -7.589415207398531e-19i, 4.0657581468206416e-20 + -8.131516293641283e-20i }, { -0.0008603253599191548 + 0.0006724582472508656i, -0.00669850895260383 + 0.006236074019178243i, -1.2705494208814505e-21 + 3.049318610115481e-20i, 6.776263578034403e-21 + 1.0842021724855044e-19i, 0.010083110826370617 + 0.0008982631002612754i, 0.08448334018075504 + -1.0243804705856695e-20i, 2.439454888092385e-19 + -1.4907779871675686e-19i, 1.0842021724855044e-18 + -8.673617379884035e-19i }, { -1.8973538018496328e-19 + -2.0328790734103208e-20i, -4.743384504624082e-20 + 5.929230630780102e-21i, -0.012393133110009242 + 0.011522859720347042i, -0.0013458365597832597 + 0.0014852716256537352i, 8.673617379884035e-19 + 1.1926223897340549e-18i, 2.168404344971009e-19 + 1.7618285302889447e-19i, 0.15630110569133088 + -7.517417406881916e-21i, 0.0183720275477987 + -0.0016366887865608627i }, { 0.0 + -6.776263578034403e-21i, -1.6263032587282567e-19 + 6.098637220230962e-20i, -0.0015675639675770416 + 0.0012252589162192388i, -0.012205081658386446 + 0.011362497709617388i, 4.0657581468206416e-20 + 4.0657581468206416e-20i, 9.75781955236954e-19 + 1.0842021724855044e-18i, 0.0183720275477987 + 0.0016366887865608623i, 0.15393366986223683 + 4.4495699510452465e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, true, false, false, false, false, true}), ElementsAreArray({ DoubleNear(0.0927376702275171, 1.0e-7), DoubleNear(0.09134747444830343, 1.0e-7), DoubleNear(0.16897355007570472, 1.0e-7), DoubleNear(0.16644053069385384, 1.0e-7), DoubleNear(0.08578265882029934, 1.0e-7), DoubleNear(0.08448334018075504, 1.0e-7), DoubleNear(0.15630110569133088, 1.0e-7), DoubleNear(0.15393366986223683, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, false, true, true, false, false, false}), Matrix({ { 0.16021232778639585 + -8.263865191649768e-20i, 0.013786811015136817 + 0.0010814046744928325i, -0.0009262855443456406 + 0.012755350645047004i, 0.028933569125216777 + -0.006466523003685458i, 3.1170812458958252e-19 + -6.776263578034403e-20i, 8.893845946170154e-21 + 2.710505431213761e-20i, -1.0164395367051604e-19 + 3.3881317890172014e-20i, 2.286988957586611e-20 + -1.6940658945086007e-20i }, { 0.013786811015136817 + -0.0010814046744928333i, 0.1545814224639704 + 8.49415227418453e-20i, 0.029423138362331402 + -0.0073201658174272865i, 0.003727049978379934 + 0.010101419838088386i, 2.0328790734103208e-20 + -5.082197683525802e-20i, 1.0164395367051604e-19 + -1.3552527156068805e-19i, 5.590417451878382e-20 + -4.0657581468206416e-20i, 9.486769009248164e-20 + -1.4399560103323106e-20i }, { -0.0009262855443456408 + -0.012755350645047002i, 0.029423138362331402 + 0.0073201658174272865i, 0.13395747632912075 + -1.1236421440920328e-20i, 0.020811943384376856 + -0.003913216175660548i, -7.453889935837843e-20 + -8.300922883092143e-20i, 5.759824041329242e-20 + 1.6940658945086007e-21i, 9.486769009248164e-20 + -6.776263578034403e-20i, 8.300922883092143e-20 + -1.6263032587282567e-19i }, { 0.028933569125216777 + 0.006466523003685458i, 0.003727049978379936 + -0.010101419838088384i, 0.020811943384376856 + 0.003913216175660549i, 0.13549222600842462 + 1.1407151519351273e-19i, 4.2351647362715017e-20 + -3.3881317890172014e-20i, 7.284483346386983e-20 + 4.912791094074942e-20i, -1.6093625997831706e-20 + 1.2874900798265365e-19i, 2.303929616531697e-19 + -1.2197274440461925e-19i }, { 2.574980159653073e-19 + 5.421010862427522e-20i, 3.049318610115481e-20 + 4.573977915173222e-20i, -7.115076756936123e-20 + 8.809142651444724e-20i, 3.5575383784680614e-20 + 2.879912020664621e-20i, 0.11440745478339935 + 1.5213919416381562e-21i, 0.009810904892620521 + 0.0009223835972253586i, -0.000987996814634278 + 0.00926444766188178i, 0.02055497241332255 + -0.004541351854948155i }, { 7.623296525288703e-21 + -3.3881317890172014e-20i, 8.809142651444724e-20 + 1.4907779871675686e-19i, 6.098637220230962e-20 + -1.1858461261560205e-20i, 5.421010862427522e-20 + -4.912791094074942e-20i, 0.009810904892620521 + -0.0009223835972253594i, 0.10960457679568389 + 6.876393791183947e-20i, 0.02097255025875996 + -0.0052694660825420405i, 0.00298106348239203 + 0.007000778655958769i }, { -8.131516293641283e-20 + -3.3881317890172014e-20i, 4.743384504624082e-20 + 4.0657581468206416e-20i, 1.0164395367051604e-19 + 1.4907779871675686e-19i, -2.541098841762901e-20 + -1.3891340334970526e-19i, -0.000987996814634278 + -0.00926444766188178i, 0.02097255025875996 + 0.00526946608254204i, 0.09521772591593608 + -4.1920065878115475e-20i, 0.014810096181818007 + -0.0033377758557582063i }, { 1.1011428314305904e-20 + 1.0164395367051604e-20i, 1.0842021724855044e-19 + 1.2281977735187355e-20i, 6.776263578034403e-20 + 1.6263032587282567e-19i, 2.371692252312041e-19 + 9.486769009248164e-20i, 0.02055497241332255 + 0.004541351854948155i, 0.0029810634823920308 + -0.007000778655958767i, 0.014810096181818007 + 0.003337775855758205i, 0.09652678991707024 + -6.006902890298832e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, false, true, true, false, false, false}), ElementsAreArray({ DoubleNear(0.16021232778639585, 1.0e-7), DoubleNear(0.1545814224639704, 1.0e-7), DoubleNear(0.13395747632912075, 1.0e-7), DoubleNear(0.13549222600842462, 1.0e-7), DoubleNear(0.11440745478339935, 1.0e-7), DoubleNear(0.10960457679568389, 1.0e-7), DoubleNear(0.09521772591593608, 1.0e-7), DoubleNear(0.09652678991707024, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, false, true, false, true, false, false}), Matrix({ { 0.1268986158166975 + -3.265874494481864e-20i, 0.010909489538182568 + 0.0009028675054192105i, -0.0008344197904628371 + 0.010151156402394654i, 0.02288443035074347 + -0.0050983421479763i, -0.025305493341815477 + -0.0307577131742633i, -0.0019332715052222877 + -0.0029695326342452735i, 0.0029285276335257035 + -0.001990710372773005i, -0.005702450698265043 + -0.00460941013491089i }, { 0.010909489538182568 + -0.0009028675054192112i, 0.12219735868176386 + 5.469338889715933e-20i, 0.023293172948468013 + -0.005811050698199262i, 0.0030506618393647987 + 0.007935382840700288i, -0.002352476801096998 + -0.002323167963739139i, -0.023622673603178913 + -0.029666306142553875i, -0.006014217358262021 + -0.004449185869512326i, 0.0010234621070633382 + -0.0020995021084537022i }, { -0.0008344197904628372 + -0.010151156402394654i, 0.023293172948468017 + 0.005811050698199262i, 0.10596695454502703 + -3.614386366065768e-20i, 0.016468469638977933 + -0.003267154109854146i, -0.00197317954937607 + 0.0023550394626270024i, -0.0032024336797583197 + -0.006847155775366218i, -0.020710853842809566 + -0.025711424835886218i, -0.003993262348093935 + -0.002825329038642985i }, { 0.02288443035074347 + 0.0050983421479763i, 0.0030506618393647995 + -0.007935382840700288i, 0.016468469638977933 + 0.0032671541098541453i, 0.10724832094474775 + 2.6277873699584583e-20i, -0.003221580688572504 + -0.006497150550317149i, -0.0028494518077828244 + 0.000659970959287247i, -0.0024763085347503473 + -0.005164291264034096i, -0.02116952023947457 + -0.026008896822359705i }, { -0.025305493341815477 + 0.0307577131742633i, -0.0023524768010969987 + 0.00232316796373914i, -0.00197317954937607 + -0.0023550394626270024i, -0.003221580688572504 + 0.006497150550317149i, 0.1477211667530977 + -4.845851503004088e-20i, 0.01268822636957477 + 0.0011009207662989807i, -0.001079862568517082 + 0.01186864190453413i, 0.02660411118779586 + -0.005909532710657313i }, { -0.0019332715052222875 + 0.002969532634245273i, -0.023622673603178917 + 0.029666306142553875i, -0.0032024336797583197 + 0.006847155775366218i, -0.0028494518077828244 + -0.0006599709592872474i, 0.01268822636957477 + -0.0011009207662989813i, 0.14198864057789046 + 9.901207175652544e-20i, 0.027102515672623347 + -0.006778581201770063i, 0.0036574516214071657 + 0.009166815653346866i }, { 0.0029285276335257035 + 0.001990710372773005i, -0.006014217358262021 + 0.004449185869512326i, -0.020710853842809566 + 0.025711424835886218i, -0.002476308534750348 + 0.005164291264034096i, -0.001079862568517082 + -0.01186864190453413i, 0.027102515672623347 + 0.006778581201770064i, 0.12320824770002978 + -1.701262365837812e-20i, 0.01915356992721693 + -0.003983837921564609i }, { -0.005702450698265043 + 0.004609410134910889i, 0.0010234621070633375 + 0.0020995021084537027i, -0.003993262348093935 + 0.002825329038642985i, -0.021169520239474576 + 0.026008896822359705i, 0.02660411118779586 + 0.005909532710657313i, 0.003657451621407167 + -0.009166815653346864i, 0.01915356992721693 + 0.003983837921564608i, 0.12477069498074711 + 2.772461259093983e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, false, true, false, true, false, false}), ElementsAreArray({ DoubleNear(0.1268986158166975, 1.0e-7), DoubleNear(0.12219735868176386, 1.0e-7), DoubleNear(0.10596695454502703, 1.0e-7), DoubleNear(0.10724832094474775, 1.0e-7), DoubleNear(0.1477211667530977, 1.0e-7), DoubleNear(0.14198864057789046, 1.0e-7), DoubleNear(0.12320824770002978, 1.0e-7), DoubleNear(0.12477069498074711, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, false, true, false, false, true, false}), Matrix({ { 0.12886540530861537 + -3.8709777920797174e-20i, 0.011073234405601682 + 0.0009402781743226663i, -0.0008982775011934331 + 0.010332796155772792i, 0.023222511152761905 + -0.005165448177003833i, 0.005921107495841594 + 0.009929355606572616i, 0.0004363425136917743 + 0.0008964203387065981i, -0.0008374381380954071 + 0.0004055570996968139i, 0.0014650367662565758 + 0.001552002237638263i }, { 0.011073234405601684 + -0.0009402781743226671i, 0.1239693497419635 + -1.0460112436039311e-20i, 0.023648190160201525 + -0.0059076880853020566i, 0.003147784008454881 + 0.008025211148230578i, 0.000581243409934475 + 0.0008100125377483067i, 0.0056961435402607145 + 0.00955210403409356i, 0.001541787040179742 + 0.0015506972788309418i, -0.0004737253390439498 + 0.0006112858954618461i }, { -0.0008982775011934332 + -0.010332796155772792i, 0.023648190160201525 + 0.0059076880853020566i, 0.10754052402065147 + -1.604585631745677e-20i, 0.016715651449656806 + -0.003402529920730813i, 0.0007548900308989956 + -0.0005439855122156352i, 0.0006313869887276941 + 0.0020935901696142135i, 0.00494127187479417 + 0.008286227809247603i, 0.0010302229548996122 + 0.001131637320904383i }, { 0.023222511152761905 + 0.005165448177003833i, 0.0031477840084548816 + -0.008025211148230578i, 0.016715651449656806 + 0.0034025299207308124i, 0.10887498433928745 + -2.6382098456766265e-20i, 0.0006690190655561955 + 0.0020266862515051546i, 0.0007629940910897936 + -0.0001261988898721236i, 0.0005058785125098307 + 0.0014443162027224434i, 0.0050025876559897185 + 0.008389050836225743i }, { 0.005921107495841595 + -0.009929355606572616i, 0.0005812434099344751 + -0.0008100125377483067i, 0.0007548900308989956 + 0.0005439855122156351i, 0.0006690190655561953 + -0.0020266862515051546i, 0.14575437726117985 + -4.2407482054062346e-20i, 0.012524481502155654 + 0.001063510097395525i, -0.001016004857786486 + 0.011687002151155989i, 0.026266030385777427 + -0.00584242668162978i }, { 0.00043634251369177417 + -0.0008964203387065981i, 0.0056961435402607145 + -0.00955210403409356i, 0.0006313869887276941 + -0.0020935901696142135i, 0.0007629940910897935 + 0.00012619888987212358i, 0.012524481502155654 + -0.0010635100973955254i, 0.1402166495176908 + 1.6416557308972408e-19i, 0.026747498460889835 + -0.006681943814667269i, 0.003560329452317083 + 0.009076987345816575i }, { -0.0008374381380954071 + -0.0004055570996968138i, 0.001541787040179742 + -0.001550697278830942i, 0.00494127187479417 + -0.008286227809247603i, 0.0005058785125098306 + -0.0014443162027224434i, -0.0010160048577864858 + -0.011687002151155989i, 0.026747498460889835 + 0.0066819438146672695i, 0.12163467822440534 + -3.7110631001579034e-20i, 0.018906388116538053 + -0.003848462110687942i }, { 0.0014650367662565758 + -0.001552002237638263i, -0.00047372533904394974 + -0.0006112858954618462i, 0.001030222954899612 + -0.001131637320904383i, 0.0050025876559897185 + -0.008389050836225747i, 0.026266030385777423 + 0.00584242668162978i, 0.003560329452317085 + -0.009076987345816575i, 0.018906388116538057 + 0.003848462110687942i, 0.1231440315862074 + 8.038458474729068e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, false, true, false, false, true, false}), ElementsAreArray({ DoubleNear(0.12886540530861537, 1.0e-7), DoubleNear(0.1239693497419635, 1.0e-7), DoubleNear(0.10754052402065147, 1.0e-7), DoubleNear(0.10887498433928745, 1.0e-7), DoubleNear(0.14575437726117985, 1.0e-7), DoubleNear(0.1402166495176908, 1.0e-7), DoubleNear(0.12163467822440534, 1.0e-7), DoubleNear(0.1231440315862074, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, false, true, false, false, false, true}), Matrix({ { 0.14265117686924988 + -7.1905776673469e-20i, 0.012258995136360022 + 0.0010357475603595821i, -0.0009832396271427263 + 0.011432864185952043i, 0.025710440336364365 + -0.0057206423170975415i, -0.010464024579852082 + -0.009719841760760864i, -0.0008334644150770141 + -0.0009133271741326514i, 0.0008479316035720895 + -0.0007834789198146687i, -0.002277643440265018 + -0.0013362166748258756i }, { 0.012258995136360022 + -0.0010357475603595828i, 0.13725800945664074 + 1.0772745348553728e-19i, 0.026179339865771693 + -0.006538244166438769i, 0.0034736311714396594 + 0.008890982850031532i, -0.0009646079527677767 + -0.000759539300549093i, -0.010063635633737956 + -0.009378407669618734i, -0.002364215819173032 + -0.0013052032748436166i, 0.00035613030336932014 + -0.0008769279827970587i }, { -0.0009832396271427263 + -0.011432864185952043i, 0.026179339865771693 + 0.006538244166438769i, 0.11906004343397192 + -5.0999200281497507e-20i, 0.018505621963422855 + -0.0037479994332380072i, -0.0006996908430741788 + 0.0008957175250159335i, -0.001476028734550001 + -0.0022649302817304767i, -0.008730825668294096 + -0.008127103382095918i, -0.0015944249124191824 + -0.0009843899893374531i }, { 0.025710440336364365 + 0.0057206423170975415i, 0.0034736311714396607 + -0.008890982850031532i, 0.018505621963422855 + 0.0037479994332380064i, 0.12052999568551656 + 6.572859865407613e-20i, -0.0014929788770060666 + -0.0021745460992704272i, -0.0008696460453078568 + 0.0004248497351989501i, -0.0011198634229698018 + -0.0015408932195550033i, -0.00883995497725232 + -0.008220164059176895i }, { -0.010464024579852082 + 0.009719841760760864i, -0.0009646079527677767 + 0.000759539300549093i, -0.0006996908430741788 + -0.0008957175250159335i, -0.0014929788770060666 + 0.0021745460992704272i, 0.1319686057005453 + -9.211483301390516e-21i, 0.011338720771397314 + 0.000968040711358609i, -0.0009310427318371926 + 0.010586934120976742i, 0.023778101202174967 + -0.0052872325415360705i }, { -0.0008334644150770139 + 0.0009133271741326515i, -0.010063635633737956 + 0.009378407669618736i, -0.001476028734550001 + 0.0022649302817304767i, -0.0008696460453078568 + -0.00042484973519895015i, 0.011338720771397314 + -0.0009680407113586098i, 0.1269279898030136 + 4.597800716814749e-20i, 0.02421634875531967 + -0.006051387733530557i, 0.003234482289332305 + 0.008211215644015623i }, { 0.0008479316035720896 + 0.0007834789198146687i, -0.002364215819173032 + 0.0013052032748436166i, -0.008730825668294096 + 0.008127103382095918i, -0.0011198634229698018 + 0.0015408932195550033i, -0.0009310427318371926 + -0.010586934120976742i, 0.024216348755319667 + 0.0060513877335305576i, 0.11011515881108488 + -2.157287037538296e-21i, 0.017116417602772008 + -0.003502992598180748i }, { -0.002277643440265018 + 0.0013362166748258756i, 0.00035613030336932003 + 0.0008769279827970587i, -0.0015944249124191822 + 0.0009843899893374531i, -0.00883995497725232 + 0.008220164059176895i, 0.023778101202174964 + 0.005287232541536071i, 0.0032344822893323063 + -0.008211215644015621i, 0.017116417602772008 + 0.0035029925981807475i, 0.11148902023997828 + -1.172611236355172e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, false, true, false, false, false, true}), ElementsAreArray({ DoubleNear(0.14265117686924988, 1.0e-7), DoubleNear(0.13725800945664074, 1.0e-7), DoubleNear(0.11906004343397192, 1.0e-7), DoubleNear(0.12052999568551656, 1.0e-7), DoubleNear(0.1319686057005453, 1.0e-7), DoubleNear(0.1269279898030136, 1.0e-7), DoubleNear(0.11011515881108488, 1.0e-7), DoubleNear(0.11148902023997828, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, false, false, true, true, false, false}), Matrix({ { 0.13540035818728655 + -4.4760397306469434e-20i, 0.015943078706073255 + -0.0010935484457359138i, -0.000494581530927759 + 0.0006575967906085476i, -6.391096457494734e-05 + 0.00015072296867025696i, -0.030303696408430624 + -0.03260528335806447i, -0.003635113815842898 + -0.002293812799930092i, -0.004396628054171342 + 0.0011809825827900013i, -0.000544644360679507 + 0.00024921742918803964i }, { 0.015943078706073255 + 0.0010935484457359136i, 0.13381856341204076 + 8.213572610406544e-20i, -4.09350702997347e-05 + 7.016033934693311e-06i, -0.0003906470050191573 + 0.0006742138639823172i, -0.0032772023251222355 + -0.005399036086467853i, -0.028057876394799904 + -0.03234642764470767i, -0.0004785768005308869 + 3.61919255560507e-05i, -0.004242559603910586 + 0.001228765249330209i }, { -0.0004945815309277591 + -0.0006575967906085477i, -4.09350702997347e-05 + -7.0160339346932904e-06i, 0.09746521217443799 + -2.4042211299006888e-20i, 0.011434880471087247 + -0.0012707381586990218i, 0.0024078053588369066 + -0.003574141961372897i, 0.00022706430204203287 + -0.0003834088101423826i, -0.015712650776194416 + -0.023863854652085046i, -0.0022914200374733245 + -0.0035010488729581664i }, { -6.391096457494734e-05 + -0.000150722968670257i, -0.0003906470050191573 + -0.0006742138639823172i, 0.011434880471087247 + 0.0012707381586990207i, 0.09562711621447083 + -1.1644635073215247e-21i, 0.0003492353580872168 + -0.0004527652534896821i, 0.0024579666754864673 + -0.0034857830327437766i, -0.0015515830107251105 + -0.0020884231413053817i, -0.016734317447853586 + -0.023328775320205906i }, { -0.030303696408430624 + 0.03260528335806447i, -0.003277202325122236 + 0.005399036086467853i, 0.002407805358836907 + 0.003574141961372897i, 0.0003492353580872168 + 0.00045276525348968204i, 0.15876944592823006 + -4.911467605094857e-20i, 0.01865567569344042 + -0.0017382630554318023i, 0.0004945815309277595 + -0.0006575967906085477i, 6.391096457494742e-05 + -0.0001507229686702571i }, { -0.003635113815842898 + 0.0022938127999300915i, -0.028057876394799907 + 0.03234642764470767i, 0.0002270643020420329 + 0.00038340881014238255i, 0.0024579666754864673 + 0.003485783032743776i, 0.01865567569344042 + 0.0017382630554318018i, 0.15625508506035427 + 1.168773118312926e-19i, 4.093507029973471e-05 + -7.016033934693233e-06i, 0.00039064700501915755 + -0.0006742138639823174i }, { -0.004396628054171342 + -0.0011809825827900013i, -0.0004785768005308869 + -3.619192555605066e-05i, -0.01571265077619442 + 0.023863854652085046i, -0.0015515830107251105 + 0.002088423141305382i, 0.0004945815309277596 + 0.0006575967906085478i, 4.09350702997347e-05 + 7.016033934693197e-06i, 0.11215996852489742 + -1.635646263747043e-20i, 0.013186120603351281 + -0.0011446540998338258i }, { -0.000544644360679507 + -0.0002492174291880396i, -0.004242559603910586 + -0.0012287652493302094i, -0.0022914200374733245 + 0.0035010488729581672i, -0.016734317447853586 + 0.0233287753202059i, 6.391096457494742e-05 + 0.00015072296867025712i, 0.0003906470050191576 + 0.0006742138639823176i, 0.013186120603351281 + 0.0011446540998338252i, 0.1105042504982833 + 9.859372516172675e-21i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, false, false, true, true, false, false}), ElementsAreArray({ DoubleNear(0.13540035818728655, 1.0e-7), DoubleNear(0.13381856341204076, 1.0e-7), DoubleNear(0.09746521217443799, 1.0e-7), DoubleNear(0.09562711621447083, 1.0e-7), DoubleNear(0.15876944592823006, 1.0e-7), DoubleNear(0.15625508506035427, 1.0e-7), DoubleNear(0.11215996852489742, 1.0e-7), DoubleNear(0.1105042504982833, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, false, false, true, false, true, false}), Matrix({ { 0.13803925806862644 + -5.2476338060364076e-20i, 0.01623547461564758 + -0.0013288282928518834i, 2.0328790734103208e-19 + -8.131516293641283e-20i, 3.8963515573697816e-20 + -6.776263578034403e-20i, 0.006342627671973901 + 0.01063622061908965i, 0.0008483766364078544 + 0.0011899211069683758i, 1.6940658945086007e-20 + 5.082197683525802e-21i, 8.046812998915853e-21 + -8.470329472543003e-22i }, { 0.01623547461564758 + 0.0013288282928518827i, 0.13611713595412114 + 2.924910645987506e-21i, -3.3881317890172014e-21 + 3.8963515573697816e-20i, 1.3552527156068805e-19 + -1.6263032587282567e-19i, 0.0006435985017610528 + 0.0013120351087308898i, 0.006254310007253382 + 0.01048811699152201i, -2.752857078576476e-21 + 1.4293680984916318e-21i, 1.6940658945086007e-20 + 6.776263578034403e-21i }, { 1.4907779871675686e-19 + 5.421010862427522e-20i, 1.6940658945086007e-21 + -2.0328790734103208e-20i, 0.09836667126064041 + -2.2792961778898678e-21i, 0.011553411239610907 + -0.001133423453556263i, -2.1175823681357508e-20 + 2.202285662861181e-20i, 4.0234064994579266e-21 + 2.117582368135751e-21i, 0.004519751698661863 + 0.007579362796730568i, 0.0006181888321835318 + 0.0008381365526426052i }, { 3.049318610115481e-20 + 5.421010862427522e-20i, 1.4907779871675686e-19 + 1.0842021724855044e-19i, 0.011553411239610907 + 0.0011334234535562626i, 0.0967271981271298 + -3.976712153879308e-20i, -3.3881317890172014e-21 + 4.235164736271502e-21i, 1.5246593050577406e-20 + 1.1858461261560205e-20i, 0.0004435234206832528 + 0.0009422936317398604i, 0.004444421188997052 + 0.0074530378787972945i }, { 0.0063426276719739 + -0.01063622061908965i, 0.0006435985017610527 + -0.0013120351087308898i, -1.6940658945086007e-21 + -2.541098841762901e-20i, -2.964615315390051e-21 + -4.235164736271502e-21i, 0.15613054604689017 + -4.139873529705393e-20i, 0.01836327978386609 + -0.0015029832083158323i, 2.0328790734103208e-19 + -8.131516293641283e-20i, 5.082197683525802e-20 + -6.776263578034403e-20i }, { 0.0008483766364078544 + -0.001189921106968376i, 0.006254310007253381 + -0.010488116991522013i, 2.329340604949326e-21 + 2.117582368135751e-22i, -8.470329472543003e-21 + -2.541098841762901e-20i, 0.01836327978386609 + 0.0015029832083158327i, 0.15395651251827386 + 1.9608812728937053e-19i, 8.470329472543003e-21 + 3.8963515573697816e-20i, 1.7618285302889447e-19 + -1.0842021724855044e-19i }, { 1.3552527156068805e-20 + -1.5670109524204556e-20i, -1.4823076576950256e-21 + -1.5881867761018131e-21i, 0.004519751698661865 + -0.007579362796730568i, 0.0004435234206832529 + -0.0009422936317398603i, 2.439454888092385e-19 + 1.3552527156068805e-19i, 1.6940658945086007e-21 + -7.284483346386983e-20i, 0.111258509438695 + -3.811937775858745e-20i, 0.013067589834827621 + -0.0012819688049765846i }, { 6.776263578034403e-21 + -1.6940658945086007e-21i, 1.8634724839594607e-20 + -2.159934015498466e-20i, 0.0006181888321835318 + -0.0008381365526426051i, 0.004444421188997051 + -0.0074530378787972945i, 4.573977915173222e-20 + 7.453889935837843e-20i, 1.7618285302889447e-19 + 1.6263032587282567e-19i, 0.013067589834827621 + 0.0012819688049765833i, 0.10940416858562432 + 4.846203054764423e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, false, false, true, false, true, false}), ElementsAreArray({ DoubleNear(0.13803925806862644, 1.0e-7), DoubleNear(0.13611713595412114, 1.0e-7), DoubleNear(0.09836667126064041, 1.0e-7), DoubleNear(0.0967271981271298, 1.0e-7), DoubleNear(0.15613054604689017, 1.0e-7), DoubleNear(0.15395651251827386, 1.0e-7), DoubleNear(0.111258509438695, 1.0e-7), DoubleNear(0.10940416858562432, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, false, false, true, false, false, true}), Matrix({ { 0.1530996518464189 + -1.091216664079954e-19i, 0.018008818727849256 + -0.0014502565672401386i, 2.439454888092385e-19 + -8.131516293641283e-20i, 4.743384504624082e-20 + -7.453889935837843e-20i, -0.011028302881587588 + -0.011348087496834098i, -0.0014051773099447704 + -0.0012366831947811519i, -2.371692252312041e-20 + -1.0164395367051604e-20i, -8.470329472543003e-21 + 3.3881317890172014e-21i }, { 0.018008818727849256 + 0.0014502565672401384i, 0.15100188629266464 + 1.8535463166088244e-19i, -6.776263578034403e-21 + 4.743384504624082e-20i, 1.7618285302889447e-19 + -1.6263032587282567e-19i, -0.0011903762732908324 + -0.0014330407875697076i, -0.0108862893221683 + -0.011192734911028936i, 3.5998900258307764e-21 + -1.0164395367051604e-20i, -1.3552527156068805e-20 + 3.3881317890172014e-21i }, { 1.6263032587282567e-19 + 1.0842021724855044e-19i, 1.6940658945086007e-21 + -5.421010862427522e-20i, 0.10861156845680289 + -1.37833105469711e-20i, 0.012755798371933625 + -0.0012619953056382865i, 3.8116482626443515e-21 + -3.049318610115481e-20i, 1.138200522872966e-21 + 2.964615315390051e-21i, -0.008166547366558589 + -0.006498857646022684i, -0.0010227120175514259 + -0.0006610339686889527i }, { 4.743384504624082e-20 + 7.453889935837843e-20i, 2.0328790734103208e-19 + 1.3552527156068805e-19i, 0.012755798371933623 + 0.0012619953056382854i, 0.10678611884949266 + -1.1898579521269027e-20i, 4.235164736271502e-22 + -6.776263578034403e-21i, -5.929230630780102e-21 + -2.371692252312041e-20i, -0.0008940951024467461 + -0.0008673917325343887i, -0.008017301288821974 + -0.006405836817766694i }, { -0.011028302881587588 + 0.011348087496834096i, -0.0011903762732908324 + 0.0014330407875697078i, -1.0164395367051604e-20 + 2.0328790734103208e-20i, 7.146840492458159e-22 + 8.046812998915853e-21i, 0.1410701522690977 + 1.5246593050577406e-20i, 0.01658993567166442 + -0.0013815549339275773i, 1.6263032587282567e-19 + -8.131516293641283e-20i, 4.2351647362715017e-20 + -6.098637220230962e-20i }, { -0.0014051773099447704 + 0.0012366831947811519i, -0.0108862893221683 + 0.011192734911028937i, 2.5940384009662948e-21 + -4.658681209898652e-21i, 1.6093625997831706e-20 + 1.0164395367051604e-20i, 0.01658993567166442 + 0.001381554933927577i, 0.13907176217973038 + 1.3658406274475593e-20i, 1.1858461261560205e-20 + 3.049318610115481e-20i, 1.3552527156068805e-19 + -1.0842021724855044e-19i }, { -2.371692252312041e-20 + -6.776263578034403e-21i, 3.1763735522036263e-21 + 7.199780051661553e-21i, -0.008166547366558589 + 0.006498857646022685i, -0.0008940951024467461 + 0.0008673917325343889i, 2.303929616531697e-19 + 8.131516293641283e-20i, 1.6940658945086007e-21 + -3.8963515573697816e-20i, 0.10101361224253252 + -2.6615363389506218e-20i, 0.011865202702504903 + -0.0011533969528945613i }, { -9.317362419797304e-21 + -7.623296525288703e-21i, -1.6940658945086007e-20 + 6.776263578034403e-21i, -0.0010227120175514259 + 0.0006610339686889527i, -0.008017301288821974 + 0.006405836817766694i, 2.879912020664621e-20 + 5.421010862427522e-20i, 1.2197274440461925e-19 + 1.3552527156068805e-19i, 0.011865202702504903 + 0.0011533969528945605i, 0.09934524786326147 + 2.0593488530120177e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, false, false, true, false, false, true}), ElementsAreArray({ DoubleNear(0.1530996518464189, 1.0e-7), DoubleNear(0.15100188629266464, 1.0e-7), DoubleNear(0.10861156845680289, 1.0e-7), DoubleNear(0.10678611884949266, 1.0e-7), DoubleNear(0.1410701522690977, 1.0e-7), DoubleNear(0.13907176217973038, 1.0e-7), DoubleNear(0.10101361224253252, 1.0e-7), DoubleNear(0.09934524786326147, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, false, false, false, true, true, false}), Matrix({ { 0.10927110891303032 + -3.9866590007452584e-20i, 0.012847033283076695 + -0.0011088404789006594i, -0.02159991968334703 + -0.026497437055477937i, -0.002781129084747373 + -0.002715573636330335i, 0.0050220156839219515 + 0.008420498461366766i, 0.0006763194331052371 + 0.0009383512323919755i, 0.0010571770257832467 + -0.002877053526578819i, 8.459052377564723e-05 + -0.0003429953271345894i }, { 0.012847033283076695 + 0.001108840478900659i, 0.10766719453416096 + -2.6239823391407144e-20i, -0.0022667838134364827 + -0.003517054454357235i, -0.021020257129137326 + -0.026125442259086258i, 0.0005044493574631887 + 0.0010415657943385207i, 0.004947366839852471 + 0.008296195240630744i, 0.00016486004294847265 + -0.000331642400899081i, 0.0010489661415407137 + -0.002818999442859821i }, { -0.021599919683347027 + 0.026497437055477937i, -0.0022667838134364827 + 0.0035170544543572354i, 0.1271348204162365 + -1.488904423080136e-20i, 0.014941852572181794 + -0.0013534112675074872i, -0.0030273813229245235 + -0.0004404677108699401i, -0.0003712535818579512 + -1.6234458806356802e-05i, 0.005840363686713813 + 0.009795084954453453i, 0.0007902460354861492 + 0.0010897064272190056i }, { -0.0027811290847473726 + 0.0027155736363303354i, -0.021020257129137326 + 0.026125442259086258i, 0.014941852572181794 + 0.0013534112675074863i, 0.12517713954709 + -1.0602387501398432e-20i, -0.0003399430138976909 + -8.542103446300007e-05i, -0.002977342861291863 + -0.0004178226725990537i, 0.0005826725649811169 + 0.0012127629461322295i, 0.0057513643563979625 + 0.009644959629688563i }, { 0.0050220156839219515 + -0.008420498461366766i, 0.0005044493574631887 + -0.0010415657943385207i, -0.0030273813229245235 + 0.0004404677108699404i, -0.0003399430138976908 + 8.54210344630001e-05i, 0.12359446144869421 + -2.893601859802374e-20i, 0.014530925894083804 + -0.001255446125534276i, -0.024416427501278013 + -0.029971700954671582i, -0.00314540476856885 + -0.0030792880365579233i }, { 0.0006763194331052371 + -0.0009383512323919755i, 0.0049473668398524705 + -0.008296195240630744i, -0.0003712535818579513 + 1.6234458806356786e-05i, -0.002977342861291863 + 0.00041782267259905326i, 0.014530925894083804 + 0.0012554461255342756i, 0.12177848509235065 + 1.0721108598815106e-19i, -0.0025620015224108623 + -0.003970404773416i, -0.023771936713516163 + -0.02954976070582732i }, { 0.0010571770257832467 + 0.0028770535265788193i, 0.0001648600429484727 + 0.00033164240089908096i, 0.005840363686713813 + -0.009795084954453453i, 0.0005826725649811168 + -0.0012127629461322295i, -0.024416427501278013 + 0.029971700954671582i, -0.002562001522410863 + 0.003970404773416i, 0.14379459403689096 + -5.058209445761764e-20i, 0.016899943724609907 + -0.0015295058877581409i }, { 8.459052377564727e-05 + 0.0003429953271345893i, 0.0010489661415407135 + 0.002818999442859821i, 0.000790246035486149 + -0.0010897064272190056i, 0.005751364356397962 + -0.009644959629688563i, -0.00314540476856885 + 0.003079288036557923i, -0.023771936713516163 + 0.02954976070582732i, 0.016899943724609907 + 0.0015295058877581409i, 0.14158219601154756 + 1.373390718488637e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, false, false, false, true, true, false}), ElementsAreArray({ DoubleNear(0.10927110891303032, 1.0e-7), DoubleNear(0.10766719453416096, 1.0e-7), DoubleNear(0.1271348204162365, 1.0e-7), DoubleNear(0.12517713954709, 1.0e-7), DoubleNear(0.12359446144869421, 1.0e-7), DoubleNear(0.12177848509235065, 1.0e-7), DoubleNear(0.14379459403689096, 1.0e-7), DoubleNear(0.14158219601154756, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, false, false, false, true, false, true}), Matrix({ { 0.12097338776604037 + -4.9122327471614687e-20i, 0.01422339585268288 + -0.0012214904941332243i, -0.023877681167795636 + -0.02933744099504325i, -0.0030736085669398135 + -0.00300940987404483i, -0.008876043705700193 + -0.00824344970735571i, -0.0011193235442328066 + -0.000878853807664549i, -0.00026593142776547735 + 0.0038189861975121116i, 2.5405447950357354e-05 + 0.0004334805281040242i }, { 0.014223395852682882 + 0.0012214904941332235i, 0.11920652751474893 + 7.3453845189862e-20i, -0.002506955392766643 + -0.0038914748703743375i, -0.023239736955967753 + -0.028927615059220004i, -0.0009676349474108655 + -0.0010608528314462336i, -0.008744414829979025 + -0.008133742528468067i, -9.077392740524542e-05 + 0.0004612052468361318i, -0.0002859830383761505 + 0.003734960688790758i }, { -0.023877681167795636 + 0.02933744099504325i, -0.0025069553927666434 + 0.003891474870374338i, 0.14073783253718142 + -7.378264948335182e-20i, 0.0165412212471 + -0.001490761378745201i, 0.0037274302750353863 + -0.0004888351801229959i, 0.0004529933573806541 + -0.0001070600862213329i, -0.010318806542445984 + -0.009603495435501073i, -0.0013085657832633902 + -0.0010188633558055554i }, { -0.0030736085669398135 + 0.00300940987404483i, -0.023239736955967753 + 0.02892761505922i, 0.0165412212471 + 0.0014907613787452003i, 0.13858147762740836 + 1.0000220694975142e-19i, 0.0004217632719828732 + -1.1409886226063098e-05i, 0.003658252276020485 + -0.0005114220102288377i, -0.001116836428326713 + -0.0012395796886578627i, -0.01015917578101125 + -0.009464829200327563i }, { -0.008876043705700193 + 0.00824344970735571i, -0.0009676349474108655 + 0.0010608528314462336i, 0.0037274302750353867 + 0.0004888351801229958i, 0.0004217632719828732 + 1.140988622606306e-05i, 0.11189218259568416 + -1.9680281133861634e-20i, 0.013154563324477618 + -0.0011427961103017115i, -0.022138666016829407 + -0.02713169701510627i, -0.0028529252863764096 + -0.0027854517988434285i }, { -0.0011193235442328066 + 0.000878853807664549i, -0.008744414829979025 + 0.008133742528468067i, 0.0004529933573806541 + 0.0001070600862213329i, 0.003658252276020485 + 0.0005114220102288376i, 0.013154563324477618 + 0.0011427961103017109i, 0.11023915211176266 + 7.517417406881916e-21i, -0.0023218299430807026 + -0.0035959843573988974i, -0.021552456886685736 + -0.026747587905693575i }, { -0.0002659314277654774 + -0.0038189861975121116i, -9.07739274052454e-05 + -0.0004612052468361318i, -0.010318806542445984 + 0.009603495435501071i, -0.001116836428326713 + 0.0012395796886578627i, -0.022138666016829407 + 0.02713169701510627i, -0.002321829943080703 + 0.0035959843573988974i, 0.13019158191594604 + 8.311510794932822e-21i, 0.015300575049691704 + -0.0013921557765204271i }, { 2.540544795035734e-05 + -0.00043348052810402425i, -0.0002859830383761505 + -0.003734960688790758i, -0.00130856578326339 + 0.0010188633558055554i, -0.01015917578101125 + 0.009464829200327565i, -0.0028529252863764088 + 0.0027854517988434285i, -0.021552456886685736 + 0.026747587905693575i, 0.015300575049691704 + 0.0013921557765204267i, 0.1281778579312292 + 2.6734477397713854e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, false, false, false, true, false, true}), ElementsAreArray({ DoubleNear(0.12097338776604037, 1.0e-7), DoubleNear(0.11920652751474893, 1.0e-7), DoubleNear(0.14073783253718142, 1.0e-7), DoubleNear(0.13858147762740836, 1.0e-7), DoubleNear(0.11189218259568416, 1.0e-7), DoubleNear(0.11023915211176266, 1.0e-7), DoubleNear(0.13019158191594604, 1.0e-7), DoubleNear(0.1281778579312292, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, false, false, false, false, true, true}), Matrix({ { 0.12280805906477472 + -5.2717461208923283e-20i, 0.01443630467779682 + -0.00127272490578387i, 0.005642784557552471 + 0.009462624099049785i, 0.0007613854919700924 + 0.0010538690464337653i, -0.009007188535068027 + -0.008374683709358597i, -0.0011392877064591738 + -0.0008905042788370061i, 0.00023142503622225854 + -0.001078823134370148i, 1.6267272586395135e-05 + -0.00012870144858824768i }, { 0.01443630467779682 + 0.0012727249057838692i, 0.12096708931702908 + -1.3906146867935225e-20i, 0.0005652531297025789 + 0.0011708273714665166i, 0.005558195681687075 + 0.00932077343523096i, -0.000978138742136542 + -0.0010794785660169673i, -0.008870514873611766 + -0.008258134419386231i, 3.823261876854085e-05 + -0.00012496756591511774i, 0.00022872454493320422 + -0.0010629369292537386i }, { 0.005642784557552471 + -0.009462624099049783i, 0.0005652531297025789 + -0.0011708273714665166i, 0.13890316123844706 + -7.018751574604323e-20i, 0.016328312421986062 + -0.001439526967094555i, -0.0010591496132524628 + 0.0003092232193575735i, -0.00012096325305501195 + 4.686766941573463e-05i, -0.010187661713078153 + -0.009472261433498186i, -0.0012886016210370227 + -0.0010072128846330985i }, { 0.0007613854919700924 + -0.001053869046433765i, 0.005558195681687074 + -0.009320773435230962i, 0.016328312421986062 + 0.0014395269670945546i, 0.1368209158251282 + 1.8736219900754864e-19i, -0.00012811965438011539 + 2.576780607986773e-05i, -0.0010438893594826295 + 0.00030404742752605915i, -0.0011063326336010365 + -0.001220953954087129i, -0.010033075737378508 + -0.0093404373094094i }, { -0.009007188535068027 + 0.008374683709358597i, -0.000978138742136542 + 0.0010794785660169673i, -0.0010591496132524628 + -0.00030922321935757374i, -0.00012811965438011539 + -2.5767806079867727e-05i, 0.1135978702644921 + -2.0381730293306602e-21i, 0.013352581177461671 + -0.0011895268406242766i, 0.005219594813083294 + 0.008752959316770434i, 0.0007051799766212938 + 0.0009741886131772158i }, { -0.0011392877064591738 + 0.0008905042788370061i, -0.008870514873611766 + 0.008258134419386231i, -0.00012096325305501194 + -4.686766941573461e-05i, -0.0010438893594826295 + -0.00030404742752605915i, 0.013352581177461671 + 0.0011895268406242761i, 0.11187724476422187 + -2.293606402487035e-20i, 0.0005218687927417268 + 0.0010835013690042336i, 0.005140535514563359 + 0.008620381435088345i }, { 0.00023142503622225865 + 0.0010788231343701483i, 3.823261876854084e-05 + 0.00012496756591511777i, -0.010187661713078151 + 0.009472261433498184i, -0.0011063326336010365 + 0.0012209539540871293i, 0.005219594813083294 + -0.008752959316770434i, 0.0005218687927417267 + -0.0010835013690042336i, 0.1284858942471381 + -9.330597309598152e-21i, 0.015102557196707651 + -0.001345425046197862i }, { 1.626727258639516e-05 + 0.00012870144858824766i, 0.00022872454493320436 + 0.0010629369292537386i, -0.0012886016210370227 + 0.0010072128846330985i, -0.010033075737378508 + 0.0093404373094094i, 0.0007051799766212938 + -0.0009741886131772158i, 0.005140535514563359 + -0.008620381435088345i, 0.015102557196707651 + 0.0013454250461978614i, 0.12653976527877 + 5.718795882946612e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, false, false, false, false, true, true}), ElementsAreArray({ DoubleNear(0.12280805906477472, 1.0e-7), DoubleNear(0.12096708931702908, 1.0e-7), DoubleNear(0.13890316123844706, 1.0e-7), DoubleNear(0.1368209158251282, 1.0e-7), DoubleNear(0.1135978702644921, 1.0e-7), DoubleNear(0.11187724476422187, 1.0e-7), DoubleNear(0.1284858942471381, 1.0e-7), DoubleNear(0.12653976527877, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, true, true, false, false, false, false, false}), Matrix({ { 0.06126665987312679 + 1.578239929235863e-20i, -5.421010862427522e-20 + -9.825582188149884e-20i, -0.0018342394972707433 + -0.011596719432246647i, -1.4399560103323106e-20 + 7.623296525288703e-21i, 1.951563910473908e-18 + 3.7947076036992655e-19i, -0.0005003690438339856 + 0.000429744901007244i, 5.421010862427522e-20 + -2.303929616531697e-19i, 8.016056927617204e-05 + 5.924959582493401e-05i }, { -4.0657581468206416e-20 + 7.453889935837843e-20i, 0.0845041180229307 + 6.352747104407253e-22i, 1.6093625997831706e-20 + 5.082197683525802e-21i, -0.0025299370208963444 + -0.01599516849148857i, -0.0005423567150076535 + 0.0003753652270191925i, 1.6263032587282567e-19 + -2.2768245622195593e-18i, 7.356257067982349e-05 + 6.726648249369062e-05i, -3.5914196963582334e-19 + 1.2874900798265365e-19i }, { -0.0018342394972707433 + 0.011596719432246647i, 1.8634724839594607e-20 + -7.411538288475128e-21i, 0.0876651857865357 + -3.935932149680444e-21i, -6.776263578034403e-20 + -1.2874900798265365e-19i, -2.846030702774449e-19 + 3.3881317890172014e-19i, -5.7999309201512706e-05 + -0.00014000034074922442i, 2.2768245622195593e-18 + 1.4094628242311558e-18i, -0.0007101624301929546 + 0.0005206912227460385i }, { -1.7787691892340307e-20 + -1.3129010682441655e-20i, -0.0025299370208963444 + 0.01599516849148857i, -7.792703114739563e-20 + 1.4230153513872246e-19i, 0.12091517999428171 + -2.4802183486789982e-20i, -4.3121837201349055e-05 + -0.00014527395648956481i, 4.87890977618477e-19 + 1.8973538018496328e-19i, -0.0007604722528194907 + 0.00044399547226742784i, 0.0 + -3.469446951953614e-18i }, { 1.5178830414797062e-18 + -4.336808689942018e-19i, -0.0005423567150076535 + -0.0003753652270191925i, -3.1170812458958252e-19 + -3.5236570605778894e-19i, -4.3121837201349055e-05 + 0.00014527395648956481i, 0.1114830970298412 + 1.9146749638764932e-20i, -1.1519648082658485e-19 + 1.8973538018496328e-19i, -0.0010852527260420027 + -0.022952992920969778i, 3.9810548520952116e-20 + 2.1175823681357508e-20i }, { -0.0005003690438339856 + -0.00042974490100724404i, 2.168404344971009e-19 + 2.6020852139652106e-18i, -5.799930920151271e-05 + 0.00014000034074922442i, 5.692061405548898e-19 + -1.6263032587282567e-19i, -6.098637220230962e-20 + -1.8973538018496328e-19i, 0.15376684167996804 + -2.1969917069408415e-21i, -3.6422416731934915e-20 + 1.6940658945086007e-20i, -0.0014968716204877763 + -0.03165869376247642i }, { 8.131516293641283e-20 + 2.439454888092385e-19i, 7.356257067982349e-05 + -6.726648249369063e-05i, 1.951563910473908e-18 + -7.589415207398531e-19i, -0.0007604722528194907 + -0.00044399547226742784i, -0.0010852527260420027 + 0.022952992920969778i, -3.8963515573697816e-20 + -2.1175823681357508e-20i, 0.15987958243687878 + 1.1904452503618153e-19i, -1.1519648082658485e-19 + 2.846030702774449e-19i }, { 8.016056927617204e-05 + -5.924959582493401e-05i, -2.710505431213761e-19 + -8.131516293641283e-20i, -0.0007101624301929546 + -0.0005206912227460385i, 5.421010862427522e-20 + 3.0357660829594124e-18i, 3.7269449679189215e-20 + -2.286988957586611e-20i, -0.001496871620487776 + 0.03165869376247642i, -1.2874900798265365e-19 + -3.1848438816761693e-19i, 0.22051933517643824 + -5.023964168402069e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, true, true, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.06126665987312679, 1.0e-7), DoubleNear(0.0845041180229307, 1.0e-7), DoubleNear(0.0876651857865357, 1.0e-7), DoubleNear(0.12091517999428171, 1.0e-7), DoubleNear(0.1114830970298412, 1.0e-7), DoubleNear(0.15376684167996804, 1.0e-7), DoubleNear(0.15987958243687878, 1.0e-7), DoubleNear(0.22051933517643824, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, true, false, true, false, false, false, false}), Matrix({ { 0.0930785678289509 + 5.997183518101334e-20i, -6.776263578034403e-20 + 3.218725199566341e-20i, -0.00157303928992702 + -0.018615584776457347i, 8.046812998915853e-21 + 1.1434944787933055e-20i, 0.000828133157468462 + 0.0067583154369272765i, -9.486769009248164e-20 + 1.2874900798265365e-19i, 0.0013376581835356136 + -0.0002798418510577328i, 2.202285662861181e-20 + 1.7787691892340307e-20i }, { -5.082197683525802e-20 + -3.7269449679189215e-20i, 0.12838177072997348 + 3.441071348220595e-22i, -6.776263578034403e-21 + 1.0164395367051604e-20i, -0.0021696677782985525 + -0.025676176508940468i, -1.4230153513872246e-19 + -9.825582188149884e-20i, 0.0011422307372775944 + 0.00932163572326226i, -7.623296525288703e-21 + 2.541098841762901e-20i, 0.001845010406147732 + -0.0003859813617799427i }, { -0.0015730392899270201 + 0.018615584776457347i, -7.199780051661553e-21 + -1.2281977735187355e-20i, 0.13337855238040658 + 7.095575973995185e-20i, -9.486769009248164e-20 + 5.421010862427522e-20i, -0.0013656492887787269 + 5.140912021590226e-05i, -1.3976043629695956e-20 + -1.7787691892340307e-20i, 0.0011866878089953064 + 0.00968444563053474i, -1.3552527156068805e-19 + 1.1180834903756764e-19i }, { 1.3129010682441655e-20 + -1.0164395367051604e-20i, -0.0021696677782985525 + 0.025676176508940468i, -7.792703114739563e-20 + -7.453889935837843e-20i, 0.18396689089011858 + -5.8683501376962e-20i, 9.740878893424454e-21 + -2.964615315390051e-20i, -0.0018836180871597962 + 7.090777220719945e-05i, -1.8973538018496328e-19 + -9.147955830346444e-20i, 0.0016367793980506828 + 0.013357600010251658i }, { 0.0008281331574684622 + -0.0067583154369272765i, -1.2874900798265365e-19 + 4.743384504624082e-20i, -0.001365649288778727 + -5.1409120215902264e-05i, 8.046812998915853e-21 + 2.879912020664621e-20i, 0.0796711890740171 + -2.5042686249889775e-20i, -9.486769009248164e-20 + 5.759824041329242e-20i, -0.0013464529333857258 + -0.01593412757675908i, 1.6093625997831706e-20 + 1.4399560103323106e-20i }, { -1.0164395367051604e-19 + -1.0842021724855044e-19i, 0.0011422307372775948 + -0.009321635723262259i, -1.6940658945086007e-20 + 2.0328790734103208e-20i, -0.0018836180871597962 + -7.090777220719961e-05i, -4.743384504624082e-20 + -7.115076756936123e-20i, 0.10988918897292527 + -1.9058241313221758e-21i, -1.6517142471458857e-20 + 1.0164395367051604e-20i, -0.0018571408630855685 + -0.021977685745024518i }, { 0.0013376581835356136 + 0.0002798418510577328i, -6.776263578034403e-21 + -2.795208725939191e-20i, 0.001186687808995306 + -0.00968444563053474i, -2.168404344971009e-19 + 5.421010862427522e-20i, -0.0013464529333857263 + 0.01593412757675908i, -1.2281977735187355e-20 + -1.6940658945086007e-20i, 0.11416621584300794 + 4.4152833146549235e-20i, -1.0164395367051604e-19 + 9.486769009248164e-20i }, { 3.3034284942917713e-20 + -2.0328790734103208e-20i, 0.0018450104061477316 + 0.00038598136177994306i, -1.2874900798265365e-19 + -1.3213713977167085e-19i, 0.001636779398050685 + -0.01335760001025166i, 1.2705494208814505e-20 + -2.795208725939191e-20i, -0.0018571408630855685 + 0.021977685745024518i, -1.3552527156068805e-19 + -1.1858461261560205e-19i, 0.15746762428060135 + -1.6358323793848675e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, true, false, true, false, false, false, false}), ElementsAreArray({ DoubleNear(0.0930785678289509, 1.0e-7), DoubleNear(0.12838177072997348, 1.0e-7), DoubleNear(0.13337855238040658, 1.0e-7), DoubleNear(0.18396689089011858, 1.0e-7), DoubleNear(0.0796711890740171, 1.0e-7), DoubleNear(0.10988918897292527, 1.0e-7), DoubleNear(0.11416621584300794, 1.0e-7), DoubleNear(0.15746762428060135, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, true, false, false, true, false, false, false}), Matrix({ { 0.10238783631690238 + 2.80579663777987e-20i, -8.809142651444724e-20 + 2.168404344971009e-19i, -0.0017303670769094964 + -0.02047742559316103i, 5.505714157152952e-20 + 2.0328790734103208e-20i, -4.946672411965114e-19 + -2.168404344971009e-19i, 0.00019387588787851885 + 0.00021982617508151212i, -5.759824041329242e-20 + 9.825582188149884e-20i, 4.0688404405529355e-05 + -4.248999882055531e-05i }, { -5.421010862427522e-20 + -2.439454888092385e-19i, 0.13774832623806652 + 2.5225699960417132e-20i, -5.336307567702092e-20 + 7.199780051661553e-21i, -0.0023279637229953925 + -0.027549474650406563i, 3.958495048684874e-05 + 0.0003082161507336898i, 8.673617379884035e-19 + 1.0842021724855044e-19i, 6.0973813128283686e-05 + -1.3125826331998611e-05i, 4.0657581468206416e-20 + -1.4907779871675686e-19i }, { -0.0017303670769094966 + 0.02047742559316103i, -5.251604272976662e-20 + -1.0587911840678754e-20i, 0.14671843054575692 + 5.792911265831363e-20i, -1.2874900798265365e-19 + 3.3881317890172014e-19i, 4.2351647362715017e-20 + -1.0672615135404184e-19i, -4.724145729656315e-05 + 3.505981981322341e-05i, -6.776263578034403e-19 + -3.6591823321385775e-19i, 0.00027781782498225956 + 0.0003150037402979277i }, { 5.166900978251232e-20 + -2.202285662861181e-20i, -0.0023279637229953925 + 0.02754947465040656i, -1.2874900798265365e-19 + -3.5236570605778894e-19i, 0.19738885948718582 + -6.074814418589435e-21i, -6.231179423087346e-05 + 2.7080443183101506e-06i, -2.202285662861181e-20 + 1.8295911660692887e-19i, 5.672394317119851e-05 + 0.0004416636929853381i, 1.1384122811097797e-18 + 1.4907779871675686e-19i }, { -4.87890977618477e-19 + 2.710505431213761e-19i, 3.958495048684874e-05 + -0.0003082161507336898i, 4.743384504624082e-20 + 1.0503208545953324e-19i, -6.231179423087346e-05 + -2.7080443183101506e-06i, 0.07036192058606562 + 6.871182553324863e-21i, -7.792703114739563e-20 + -1.2874900798265365e-19i, -0.0011891251464032494 + -0.014072286760055393i, -2.964615315390051e-20 + 8.046812998915853e-21i }, { 0.00019387588787851885 + -0.00021982617508151212i, 6.505213034913027e-19 + -7.453889935837843e-20i, -4.724145729656315e-05 + -3.5059819813223415e-05i, -2.0328790734103208e-20 + -1.6601845766184287e-19i, -5.421010862427522e-20 + 1.4230153513872246e-19i, 0.10052263346483223 + -2.6787416956917248e-20i, 3.218725199566341e-20 + 1.1858461261560205e-20i, -0.0016988449183887285 + -0.020104387603558423i }, { -5.421010862427522e-20 + -1.1350241493207625e-19i, 6.097381312828367e-05 + 1.3125826331998607e-05i, -6.098637220230962e-19 + 3.6591823321385775e-19i, 5.672394317119851e-05 + -0.000441663692985338i, -0.0011891251464032498 + 0.014072286760055393i, 3.218725199566341e-20 + -1.5246593050577406e-20i, 0.10082633767765758 + 5.717948022818745e-20i, -7.453889935837843e-20 + -1.8973538018496328e-19i }, { 4.0688404405529355e-05 + 4.248999882055531e-05i, 2.752857078576476e-20 + 1.5246593050577406e-19i, 0.00027781782498225956 + -0.0003150037402979277i, 1.1655173354219173e-18 + -1.2874900798265365e-19i, -2.837560373301906e-20 + -1.2281977735187355e-20i, -0.001698844918388729 + 0.020104387603558423i, -8.131516293641283e-20 + 1.6940658945086007e-19i, 0.1440456556835341 + -6.896701075222124e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, true, false, false, true, false, false, false}), ElementsAreArray({ DoubleNear(0.10238783631690238, 1.0e-7), DoubleNear(0.13774832623806652, 1.0e-7), DoubleNear(0.14671843054575692, 1.0e-7), DoubleNear(0.19738885948718582, 1.0e-7), DoubleNear(0.07036192058606562, 1.0e-7), DoubleNear(0.10052263346483223, 1.0e-7), DoubleNear(0.10082633767765758, 1.0e-7), DoubleNear(0.1440456556835341, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, true, false, false, false, true, false, false}), Matrix({ { 0.08024771737095286 + 1.2906085507358614e-20i, 0.00022856852323587104 + -6.286242138338565e-05i, -0.0013447742853448664 + -0.01605881983588308i, -1.773217551263863e-05 + -4.630379236372823e-05i, -0.013382797510647389 + -0.01961947688503267i, 0.0006809527231496375 + 0.0008052327619097982i, -0.0036351106485871592 + 0.0029443724849304398i, 0.00014865175194919995 + -0.00015052365851466718i }, { 0.00022856852323587104 + 6.28624213833856e-05i, 0.10977190597428672 + -1.8052389688357276e-20i, 1.0079829438470402e-05 + -4.518324896358004e-05i, -0.0018684353146064853 + -0.02194331775779861i, 0.0006027102076778468 + 0.000926367665522104i, -0.023940660664587145 + -0.026474248984032837i, 0.00017600374095816366 + -0.00013551214761979612i, -0.004962961360248698 + 0.005309606103974381i }, { -0.0013447742853448666 + 0.01605881983588308i, 1.0079829438470406e-05 + 4.518324896358003e-05i, 0.1149941914471091 + 6.076510138845169e-20i, 0.0003275371120962949 + -9.033968423891661e-05i, 0.0042246950345642895 + -0.00229591445953753i, -0.00017201336155676063 + 0.00012157180565725707i, -0.019166122033189764 + -0.02811524656559744i, 0.0009757553994381417 + 0.001153733367217028i }, { -1.773217551263862e-05 + 4.6303792363728226e-05i, -0.001868435314606485 + 0.02194331775779861i, 0.0003275371120962949 + 9.033968423891663e-05i, 0.15729743519588746 + -4.345014321618544e-20i, -0.00019595225412777774 + 0.00010591811488190278i, 0.00561263617031075 + -0.004397700509663871i, 0.000863697966170947 + 0.0013275921868427332i, -0.03431896081885424 + -0.03793536854040015i }, { -0.013382797510647389 + 0.019619476885032672i, 0.0006027102076778468 + -0.0009263676655221041i, 0.0042246950345642895 + 0.00229591445953753i, -0.00019595225412777776 + -0.0001059181148819028i, 0.09250203953201513 + 2.2023063423764947e-20i, -0.0002285685232358712 + 6.286242138338574e-05i, -0.0015747179379678794 + -0.018490892517333345i, 1.7732175512638656e-05 + 4.630379236372827e-05i }, { 0.0006809527231496375 + -0.0008052327619097982i, -0.023940660664587145 + 0.026474248984032837i, -0.00017201336155676065 + -0.00012157180565725707i, 0.00561263617031075 + 0.004397700509663871i, -0.00022856852323587117 + -6.286242138338571e-05i, 0.128499053728612 + 1.649067269185716e-20i, -1.0079829438470424e-05 + 4.518324896358006e-05i, -0.002158373326777636 + -0.02571054449616638i }, { -0.0036351106485871592 + -0.00294437248493044i, 0.00017600374095816366 + 0.0001355121476197961i, -0.019166122033189757 + 0.02811524656559744i, 0.000863697966170947 + -0.0013275921868427332i, -0.0015747179379678798 + 0.018490892517333345i, -1.0079829438470426e-05 + -4.518324896358005e-05i, 0.13255057677630538 + 5.43434914980494e-20i, -0.0003275371120962951 + 9.033968423891676e-05i }, { 0.00014865175194919995 + 0.00015052365851466715i, -0.004962961360248698 + -0.005309606103974382i, 0.0009757553994381417 + -0.001153733367217028i, -0.03431896081885424 + 0.03793536854040015i, 1.7732175512638645e-05 + -4.630379236372827e-05i, -0.002158373326777636 + 0.025710544496166377i, -0.0003275371120962951 + -9.03396842389168e-05i, 0.18413707997483247 + -3.159168195462523e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, true, false, false, false, true, false, false}), ElementsAreArray({ DoubleNear(0.08024771737095286, 1.0e-7), DoubleNear(0.10977190597428672, 1.0e-7), DoubleNear(0.1149941914471091, 1.0e-7), DoubleNear(0.15729743519588746, 1.0e-7), DoubleNear(0.09250203953201513, 1.0e-7), DoubleNear(0.128499053728612, 1.0e-7), DoubleNear(0.13255057677630538, 1.0e-7), DoubleNear(0.18413707997483247, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, true, false, false, false, false, true, false}), Matrix({ { 0.08497457669548238 + 2.3967765043877115e-20i, -9.486769009248164e-20 + 5.082197683525802e-20i, 0.00020371861342355482 + -0.022441783715902816i, 1.1858461261560205e-20 + 1.5246593050577406e-20i, -0.012681894638151916 + -0.005287233122188521i, 1.3552527156068805e-20 + -8.470329472543003e-22i, -0.031733173505907326 + -0.0030985001500208054i, 2.710505431213761e-20 + -1.1011428314305904e-20i }, { -4.743384504624082e-20 + -5.421010862427522e-20i, 0.11720406617389745 + -9.18501352178882e-21i, -1.4399560103323106e-20 + 1.1858461261560205e-20i, 0.0002809858051322112 + -0.030953591132614665i, 5.929230630780102e-21 + 1.3552527156068805e-20i, -0.01749193318969925 + -0.007292595560087693i, 1.6940658945086007e-20 + 1.6940658945086007e-20i, -0.04376905554731483 + -0.004273711393988936i }, { 0.0002037186134235548 + 0.022441783715902816i, -1.3552527156068805e-20 + -1.6940658945086007e-20i, 0.11224873993007087 + -2.23655161973619e-20i, -6.776263578034403e-20 + 7.792703114739563e-20i, -0.00966119100303706 + -0.010697611671300178i, 1.3552527156068805e-20 + -1.6940658945086007e-21i, 0.021743911365058766 + 0.02048371227028041i, -3.049318610115481e-20 + -6.776263578034403e-21i }, { 1.5246593050577406e-20 + -2.541098841762901e-20i, 0.0002809858051322112 + 0.030953591132614665i, -1.2197274440461925e-19 + -1.0503208545953324e-19i, 0.15482288061106708 + -8.401508045578591e-20i, -8.470329472543003e-22 + 1.1858461261560205e-20i, -0.013325525276771614 + -0.014755043625799921i, -6.776263578034403e-21 + -2.710505431213761e-20i, 0.029991027029678596 + 0.02825285469813533i }, { -0.012681894638151916 + 0.005287233122188521i, 5.082197683525802e-21 + -8.470329472543003e-21i, -0.00966119100303706 + 0.010697611671300178i, 2.541098841762901e-21 + -1.5246593050577406e-20i, 0.08777518020748562 + 1.0961383887246446e-20i, -7.453889935837843e-20 + 3.7269449679189215e-20i, -0.0031232108367363004 + -0.012107928637313609i, 1.3552527156068805e-20 + 1.3552527156068805e-20i }, { 1.3552527156068805e-20 + 2.541098841762901e-21i, -0.01749193318969925 + 0.007292595560087693i, 1.0164395367051604e-20 + -7.623296525288703e-21i, -0.013325525276771614 + 0.014755043625799921i, -6.776263578034403e-20 + -4.743384504624082e-20i, 0.1210668935290013 + 7.623296525288703e-21i, -6.776263578034403e-21 + 7.623296525288703e-21i, -0.004307794446516333 + -0.01670027112135032i }, { -0.03173317350590732 + 0.0030985001500208054i, 2.710505431213761e-20 + -1.8634724839594607e-20i, 0.02174391136505877 + -0.02048371227028041i, -3.3881317890172014e-21 + 1.6940658945086007e-20i, -0.0031232108367363013 + 0.012107928637313609i, -6.776263578034403e-21 + -8.470329472543003e-21i, 0.13529602829334364 + 1.3747410908386299e-19i, -1.2197274440461925e-19 + 7.115076756936123e-20i }, { 1.3552527156068805e-20 + 9.317362419797304e-21i, -0.04376905554731483 + 0.004273711393988935i, -3.3881317890172014e-20 + 3.3881317890172014e-21i, 0.029991027029678596 + -0.028252854698135328i, 8.470329472543003e-21 + -1.0164395367051604e-20i, -0.004307794446516333 + 0.01670027112135032i, -9.486769009248164e-20 + -7.792703114739563e-20i, 0.18661163455965282 + 8.973255284975244e-21i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, true, false, false, false, false, true, false}), ElementsAreArray({ DoubleNear(0.08497457669548238, 1.0e-7), DoubleNear(0.11720406617389745, 1.0e-7), DoubleNear(0.11224873993007087, 1.0e-7), DoubleNear(0.15482288061106708, 1.0e-7), DoubleNear(0.08777518020748562, 1.0e-7), DoubleNear(0.1210668935290013, 1.0e-7), DoubleNear(0.13529602829334364, 1.0e-7), DoubleNear(0.18661163455965282, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, true, false, false, false, false, false, true}), Matrix({ { 0.08982869035438079 + 2.3917720616817657e-20i, -8.131516293641283e-20 + 5.421010862427522e-20i, -0.0015181159593022709 + -0.017965613778277226i, 1.3552527156068805e-20 + 1.1858461261560205e-20i, -0.0065724596655750015 + -0.006212366198609622i, 8.470329472543003e-21 + -4.658681209898652e-21i, -0.0011313892639681403 + 0.0014194725949263091i, -3.705769144237564e-22 + -1.9058241313221758e-21i }, { -6.776263578034403e-20 + -6.098637220230962e-20i, 0.12369625356437139 + -3.881793178588848e-20i, -1.2705494208814505e-20 + 1.0164395367051604e-20i, -0.0020904819596183144 + -0.0247390795589949i, 5.929230630780102e-21 + 1.3552527156068805e-20i, -0.00908678879791348 + -0.008356475546442275i, 2.6469779601696886e-21 + -1.0587911840678754e-22i, -0.001517715693997421 + 0.0019585706551501856i }, { -0.001518115959302271 + 0.017965613778277226i, -1.1011428314305904e-20 + -1.1858461261560205e-20i, 0.1287215839387732 + 6.357193200199725e-20i, -9.486769009248164e-20 + 7.115076756936123e-20i, 0.0013535400238382195 + -0.0012094930831704793i, 1.5881867761018131e-22 + 1.7999450129153882e-21i, -0.009418120370996316 + -0.008902118175584953i, 1.3552527156068805e-20 + -1.6940658945086007e-21i }, { 1.5246593050577406e-20 + -1.8634724839594607e-20i, -0.0020904819596183144 + 0.0247390795589949i, -1.0842021724855044e-19 + -9.486769009248164e-20i, 0.1772526975878537 + 1.879354351720479e-21i, -2.329340604949326e-21 + -2.117582368135751e-22i, 0.0018248513994941853 + -0.0016761197179156427i, -2.541098841762901e-21 + 1.3552527156068805e-20i, -0.013021072024651657 + -0.011974556951015562i }, { -0.0065724596655750015 + 0.006212366198609622i, 5.505714157152952e-21 + -1.1011428314305904e-20i, 0.0013535400238382195 + 0.0012094930831704795i, -1.9058241313221758e-21 + -1.0587911840678754e-22i, 0.08292106654858722 + 1.1011428314305904e-20i, -8.809142651444724e-20 + 3.3881317890172014e-20i, -0.001401376264010475 + -0.016584098574939202i, 1.1858461261560205e-20 + 1.6940658945086007e-20i }, { 1.1011428314305904e-20 + 6.776263578034403e-21i, -0.009086788797913479 + 0.008356475546442275i, 5.293955920339377e-22 + -1.2705494208814505e-21i, 0.001824851399494185 + 0.0016761197179156427i, -4.743384504624082e-20 + -4.0657581468206416e-20i, 0.11457470613852734 + 3.7256214789388366e-20i, -8.470329472543003e-21 + 9.317362419797304e-21i, -0.0019363266817658067 + -0.022914782694970087i }, { -0.00113138926396814 + -0.0014194725949263094i, 2.117582368135751e-21 + 1.0587911840678754e-22i, -0.009418120370996316 + 0.008902118175584953i, 0.0 + -1.3552527156068805e-20i, -0.0014013762640104751 + 0.016584098574939202i, -9.317362419797304e-21 + -1.3552527156068805e-20i, 0.11882318428464131 + 5.1536660884503836e-20i, -9.486769009248164e-20 + 7.792703114739563e-20i }, { 0.0 + 2.329340604949326e-21i, -0.001517715693997421 + -0.0019585706551501856i, 1.5246593050577406e-20 + 3.3881317890172014e-21i, -0.013021072024651657 + 0.011974556951015562i, 8.470329472543003e-21 + -1.6940658945086007e-20i, -0.0019363266817658067 + 0.022914782694970083i, -1.0842021724855044e-19 + -8.809142651444724e-20i, 0.1641818175828662 + -7.692117952253115e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, true, false, false, false, false, false, true}), ElementsAreArray({ DoubleNear(0.08982869035438079, 1.0e-7), DoubleNear(0.12369625356437139, 1.0e-7), DoubleNear(0.1287215839387732, 1.0e-7), DoubleNear(0.1772526975878537, 1.0e-7), DoubleNear(0.08292106654858722, 1.0e-7), DoubleNear(0.11457470613852734, 1.0e-7), DoubleNear(0.11882318428464131, 1.0e-7), DoubleNear(0.1641818175828662, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, true, true, false, false, false, false}), Matrix({ { 0.08024533953995727 + 3.994661973171709e-21i, -5.759824041329242e-20 + -1.0503208545953324e-19i, 2.0599841277224584e-18 + 5.421010862427522e-19i, -0.00048236906067690736 + 0.0003787270220435993i, 0.0007139541137705822 + 0.005826511189460752i, -1.2197274440461925e-19 + -1.5585406229479126e-19i, -6.098637220230962e-20 + 1.3552527156068805e-19i, -0.000831522189893321 + 0.0010427188037881504i }, { -5.082197683525802e-20 + 7.453889935837843e-20i, 0.1106811054710207 + -9.767348673026151e-21i, -0.0005191474975391331 + 0.00032649646816342514i, 0.0 + -2.2768245622195593e-18i, -5.082197683525802e-20 + 1.9651164376299768e-19i, 0.0009847454197432005 + 0.008036413119888097i, -0.000935474977523886 + 0.0009505673161249867i, 2.168404344971009e-19 + -4.0657581468206416e-20i }, { 1.8431436932253575e-18 + -5.421010862427522e-19i, -0.0005191474975391331 + -0.00032649646816342514i, 0.14621178066940022 + 1.2693293294779348e-19i, -9.486769009248164e-20 + 1.9651164376299768e-19i, 7.453889935837843e-20 + 1.2874900798265365e-19i, -0.0012619685519131636 + -0.00043142441984728657i, 0.0013008668526931862 + 0.010616249878001267i, -1.0164395367051604e-19 + 3.7947076036992655e-19i }, { -0.00048236906067690736 + -0.0003787270220435993i, -5.421010862427522e-20 + 3.469446951953614e-18i, -9.486769009248164e-20 + -2.168404344971009e-19i, 0.20166755614907136 + -4.8572045569113785e-20i, -0.001210245855237623 + -0.0005603540184013409i, -1.6940658945086007e-19 + -1.3552527156068805e-20i, -2.710505431213761e-19 + -4.0657581468206416e-19i, 0.001794264715585077 + 0.014642822613625824i }, { 0.0007139541137705821 + -0.005826511189460752i, -4.0657581468206416e-20 + -2.236166980751353e-19i, 8.809142651444724e-20 + -1.0842021724855044e-19i, -0.001210245855237623 + 0.0005603540184013408i, 0.06868650611970523 + 7.851805169506477e-21i, -7.453889935837843e-20 + -1.2874900798265365e-19i, 1.8431436932253575e-18 + 7.589415207398531e-19i, -0.0007281624133500327 + 0.0005717091017096832i }, { -1.4230153513872246e-19 + 1.9651164376299768e-19i, 0.0009847454197432015 + -0.008036413119888095i, -0.0012619685519131636 + 0.0004314244198472865i, -1.6263032587282567e-19 + -2.371692252312041e-20i, -6.776263578034403e-20 + 1.2197274440461925e-19i, 0.09473819254619172 + -1.4399560103323106e-20i, -0.0007836814702880111 + 0.0004928642311231952i, 2.710505431213761e-19 + -3.0357660829594124e-18i }, { -4.0657581468206416e-20 + -1.6263032587282567e-19i, -0.0009354749775238861 + -0.0009505673161249867i, 0.0013008668526931862 + -0.010616249878001265i, -2.710505431213761e-19 + 2.981555974335137e-19i, 1.6263032587282567e-18 + -3.2526065174565133e-19i, -0.0007836814702880111 + -0.0004928642311231952i, 0.1251508987973198 + 1.1258341727152983e-20i, -1.3552527156068805e-19 + 2.574980159653073e-19i }, { -0.000831522189893321 + -0.0010427188037881504i, 2.0328790734103208e-19 + 4.0657581468206416e-20i, -9.486769009248164e-20 + -4.0657581468206416e-19i, 0.0017942647155850784 + -0.014642822613625822i, -0.0007281624133500328 + -0.0005717091017096832i, 2.168404344971009e-19 + 2.2768245622195593e-18i, -1.2197274440461925e-19 + -2.981555974335137e-19i, 0.1726186207073349 + -3.864587821847745e-21i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, true, true, false, false, false, false}), ElementsAreArray({ DoubleNear(0.08024533953995727, 1.0e-7), DoubleNear(0.1106811054710207, 1.0e-7), DoubleNear(0.14621178066940022, 1.0e-7), DoubleNear(0.20166755614907136, 1.0e-7), DoubleNear(0.06868650611970523, 1.0e-7), DoubleNear(0.09473819254619172, 1.0e-7), DoubleNear(0.1251508987973198, 1.0e-7), DoubleNear(0.1726186207073349, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, true, false, true, false, false, false}), Matrix({ { 0.08827109055986003 + 3.466217638842207e-20i, -1.1180834903756764e-19 + -6.640738306473715e-19i, 8.023096076392733e-18 + 9.107298248878237e-18i, -0.0007493061433417212 + 0.0005718529129402001i, 1.463672932855431e-18 + 2.0328790734103208e-20i, 0.00016714520661740805 + 0.0001895175921873105i, -0.0009790574127647455 + -0.0018461783133035732i, -4.7645603283054394e-21 + 3.4728350837426314e-20i }, { -1.1519648082658485e-19 + 5.827586677109586e-19i, 0.11875624505039226 + -4.096198393362593e-20i, -0.0007909432716301046 + 0.0005127223337742395i, -7.806255641895632e-18 + -1.431146867680866e-17i, 3.412716661398351e-05 + 0.0002657207802420734i, -1.7618285302889447e-18 + -1.1926223897340549e-18i, 2.795208725939191e-20 + -2.244637310223896e-20i, -0.0004301314601429121 + -0.003141187417807759i }, { 7.15573433840433e-18 + -8.890457814381136e-18i, -0.0007909432716301046 + -0.0005127223337742395i, 0.16083517630279925 + 5.132490264769026e-20i, -8.809142651444724e-20 + 1.2468324983583301e-18i, 0.0014081680533267024 + -0.0015440176539120627i, 3.3881317890172014e-20 + 1.1117307432712692e-21i, -2.5478751053409354e-18 + -6.505213034913027e-19i, 0.00030454850624337033 + 0.00034531232319212927i }, { -0.0007493061433417212 + -0.0005718529129402i, -7.806255641895632e-18 + 1.474514954580286e-17i, -8.131516293641283e-20 + -1.2739375526704677e-18i, 0.21638094067486008 + 6.011286947545363e-20i, -3.3881317890172014e-20 + -1.376428539288238e-20i, 0.0028124170957693857 + -0.0014636876532315723i, 6.218172704406373e-05 + 0.00048415906347695444i, 3.577867169202165e-18 + 1.4365678785432934e-18i }, { 1.463672932855431e-18 + -1.6940658945086007e-20i, 3.4127166613983515e-05 + -0.0002657207802420734i, 0.001408168053326702 + 0.0015440176539120625i, -3.218725199566341e-20 + 1.4293680984916318e-20i, 0.060660755099802476 + -2.2815709245743886e-20i, -1.8634724839594607e-20 + 4.0657581468206416e-19i, -4.0115480381963664e-18 + -7.806255641895632e-18i, -0.00046122533068521874 + 0.00037858321081308253i }, { 0.00016714520661740808 + -0.0001895175921873105i, -1.734723475976807e-18 + 1.2739375526704677e-18i, 3.3881317890172014e-20 + 1.376428539288238e-21i, 0.0028124170957693857 + 0.0014636876532315725i, -5.082197683525802e-21 + -4.0657581468206416e-19i, 0.08666305296682016 + 1.6795075157276674e-20i, -0.0005118856961970396 + 0.0003066383655123808i, 8.239936510889834e-18 + 8.890457814381136e-18i }, { -0.0009790574127647453 + 0.0018461783133035734i, 3.049318610115481e-20 + 2.1175823681357508e-20i, -2.4936649967166602e-18 + 6.2341624917916505e-19i, 6.218172704406373e-05 + -0.00048415906347695444i, -4.065758146820642e-18 + 8.023096076392733e-18i, -0.0005118856961970396 + -0.00030663836551238075i, 0.11052750316392074 + 8.68663720272562e-20i, -1.2197274440461925e-19 + -7.589415207398531e-19i }, { -3.705769144237564e-21 + -3.3881317890172014e-20i, -0.0004301314601429122 + 0.003141187417807759i, 0.00030454850624337033 + -0.00034531232319212927i, 3.469446951953614e-18 + -1.395910297075087e-18i, -0.0004612253306852188 + -0.00037858321081308253i, 8.023096076392733e-18 + -8.456776945386935e-18i, -1.2197274440461925e-19 + 7.453889935837843e-19i, 0.15790523618154617 + -1.1254950286641516e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, true, false, true, false, false, false}), ElementsAreArray({ DoubleNear(0.08827109055986003, 1.0e-7), DoubleNear(0.11875624505039226, 1.0e-7), DoubleNear(0.16083517630279925, 1.0e-7), DoubleNear(0.21638094067486008, 1.0e-7), DoubleNear(0.060660755099802476, 1.0e-7), DoubleNear(0.08666305296682016, 1.0e-7), DoubleNear(0.11052750316392074, 1.0e-7), DoubleNear(0.15790523618154617, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, true, false, false, true, false, false}), Matrix({ { 0.06780927800913356 + 1.1513113355819316e-20i, 0.0001926433742348611 + 0.00014103779243169524i, -0.004426491141135466 + 0.0002151533592889812i, -0.0005487049078798755 + 0.0004320791996040806i, -0.019793951511158824 + -0.016031000606369507i, 0.000607835313128278 + 0.0007985733500953925i, -0.017791410711084914 + -0.006447177982407664i, 0.00027751790974352023 + -1.550173093488443e-06i }, { 0.00019264337423486108 + -0.0001410377924316953i, 0.09623447558702443 + -1.9071476203022606e-20i, -0.0006132591138739516 + 0.00038686345905526633i, -0.002633504554331233 + 0.005227320436604807i, 0.0004941498601272545 + 0.0006953268453362353i, -0.011043019299091808 + -0.023850978649677158i, 0.00014961337884541312 + 0.00012718245121812392i, -0.02210901996196138 + -0.0066811023315361i }, { -0.004426491141135466 + -0.000215153359288981i, -0.0006132591138739516 + -0.00038686345905526633i, 0.12743263080892842 + 6.215807353999099e-20i, 0.00036346226109730485 + -0.0002942398980539975i, -0.0009202981015532736 + -0.016536347274596252i, -4.4527434668530264e-05 + 0.00017910123692037268i, -0.01275496803267833 + -0.0317037228442606i, 0.0010488728094595011 + 0.0011603927790314337i }, { -0.0005487049078798756 + -0.0004320791996040805i, -0.0026335045543312337 + -0.005227320436604807i, 0.00036346226109730485 + 0.0002942398980539975i, 0.17083486558314975 + -4.243105670152011e-20i, 7.375462161163845e-05 + 0.0002589966322814499i, -6.509416754727328e-06 + -0.025841836535460603i, 0.0009722583137215393 + 0.001558633007028602i, -0.047216602184349574 + -0.04055863887475583i }, { -0.01979395151115882 + 0.016031000606369507i, 0.0004941498601272545 + -0.0006953268453362353i, -0.0009202981015532736 + 0.016536347274596252i, 7.375462161163842e-05 + -0.0002589966322814499i, 0.08112256765052894 + 3.3335378685887015e-22i, -0.00019264337423486125 + -0.0001410377924316955i, 0.004426491141135469 + -0.0002151533592889799i, -0.0006618265661470645 + 0.000518356924149202i }, { 0.000607835313128278 + -0.0007985733500953924i, -0.011043019299091808 + 0.023850978649677158i, -4.4527434668530264e-05 + -0.00017910123692037268i, -6.509416754726732e-06 + 0.025841836535460603i, -0.0001926433742348612 + 0.00014103779243169546i, 0.10918482243018798 + -5.0954325733266505e-21i, -0.0006895698539531926 + 0.00043249724023135396i, 0.0026335045543312337 + -0.005227320436604812i }, { -0.017791410711084914 + 0.006447177982407665i, 0.00014961337884541312 + -0.00012718245121812392i, -0.01275496803267833 + 0.0317037228442606i, 0.0009722583137215393 + -0.0015586330070286021i, 0.004426491141135469 + 0.00021515335928898012i, -0.0006895698539531927 + -0.000432497240231354i, 0.1439300486577916 + 7.603320113495547e-20i, -0.00036346226109730507 + 0.000294239898053998i }, { 0.00027751790974352034 + 1.5501730934884294e-06i, -0.02210901996196138 + 0.0066811023315361i, 0.0010488728094595011 + -0.0011603927790314337i, -0.047216602184349574 + 0.04055863887475583i, -0.0006618265661470647 + -0.000518356924149202i, 0.0026335045543312337 + 0.005227320436604814i, -0.00036346226109730507 + -0.00029423989805399804i, 0.2034513112732565 + -1.0005576689441423e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, true, false, false, true, false, false}), ElementsAreArray({ DoubleNear(0.06780927800913356, 1.0e-7), DoubleNear(0.09623447558702443, 1.0e-7), DoubleNear(0.12743263080892842, 1.0e-7), DoubleNear(0.17083486558314975, 1.0e-7), DoubleNear(0.08112256765052894, 1.0e-7), DoubleNear(0.10918482243018798, 1.0e-7), DoubleNear(0.1439300486577916, 1.0e-7), DoubleNear(0.2034513112732565, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, true, false, false, false, true, false}), Matrix({ { 0.06929515267715164 + -9.126283698297554e-21i, -6.098637220230962e-20 + -1.0842021724855044e-19i, 1.734723475976807e-18 + 4.336808689942018e-19i, -0.0005713760787968464 + 0.0004799873780072145i, 0.003830789085116389 + 0.005827195977657409i, 7.623296525288703e-21 + -1.5246593050577406e-20i, 5.421010862427522e-20 + 3.2526065174565133e-19i, -8.679681972318693e-05 + -2.0998590653874048e-05i }, { -6.098637220230962e-20 + 5.421010862427522e-20i, 0.09557768894816976 + -5.386600148945316e-20i, -0.0006182047745156678 + 0.00041794899597143783i, -1.0842021724855044e-19 + -1.951563910473908e-18i, -1.1858461261560205e-20 + -2.964615315390051e-21i, 0.005283745737730699 + 0.00803735763722772i, -8.414169096331579e-05 + -2.99132840949007e-05i, 2.710505431213761e-19 + -1.3552527156068805e-19i }, { 1.3010426069826053e-18 + -6.505213034913027e-19i, -0.0006182047745156678 + -0.00041794899597143783i, 0.1279281639484016 + 1.0728532544812769e-20i, -9.486769009248164e-20 + 2.574980159653073e-19i, 1.0842021724855044e-19 + 1.8973538018496328e-19i, 2.670249762904163e-05 + -7.55852697618337e-05i, 0.0052312276417904625 + 0.009369283170434478i, -2.371692252312041e-20 + 1.3129010682441655e-20i }, { -0.0005713760787968465 + -0.0004799873780072145i, -2.168404344971009e-19 + 3.0357660829594124e-18i, -1.0842021724855044e-19 + -2.846030702774449e-19i, 0.1764492578367948 + -3.933409248812157e-20i, 3.4420022940387876e-05 + -7.23976408827064e-05i, -1.6263032587282567e-19 + 2.710505431213761e-20i, 8.470329472543003e-21 + -1.6940658945086007e-20i, 0.007215348102248648 + 0.012922901500819916i }, { 0.003830789085116388 + -0.005827195977657409i, -1.1011428314305904e-20 + 0.0i, 1.3552527156068805e-19 + -2.0328790734103208e-19i, 3.442002294038787e-05 + 7.239764088270639e-05i, 0.07963669298251086 + 2.097275084097574e-20i, -7.453889935837843e-20 + -1.4907779871675686e-19i, 2.3852447794681098e-18 + 8.673617379884035e-19i, -0.0006391553952300936 + 0.0004704487457460681i }, { 3.3881317890172014e-21 + 9.317362419797304e-21i, 0.005283745737730697 + -0.00803735763722772i, 2.670249762904164e-05 + 7.55852697618337e-05i, -2.439454888092385e-19 + 0.0i, -5.421010862427522e-20 + 1.2197274440461925e-19i, 0.10984160906904265 + 2.9699092713103906e-20i, -0.0006846241933114764 + 0.0004014117033151825i, 5.421010862427522e-19 + -3.469446951953614e-18i }, { 4.0657581468206416e-20 + -2.981555974335137e-19i, -8.414169096331579e-05 + 2.9913284094900684e-05i, 0.0052312276417904625 + -0.009369283170434478i, 1.3552527156068805e-20 + 1.0164395367051604e-20i, 1.734723475976807e-18 + -2.168404344971009e-19i, -0.0006846241933114764 + -0.0004014117033151825i, 0.1434345155183184 + 1.274627421301337e-19i, -1.2197274440461925e-19 + 2.303929616531697e-19i }, { -8.679681972318693e-05 + 2.0998590653874058e-05i, 2.168404344971009e-19 + 1.6263032587282567e-19i, -2.710505431213761e-20 + -2.964615315390051e-21i, 0.007215348102248649 + -0.012922901500819916i, -0.0006391553952300936 + -0.000470448745746068i, 4.336808689942018e-19 + 3.2526065174565133e-18i, -9.486769009248164e-20 + -2.439454888092385e-19i, 0.19783691901961148 + -1.3102540902839958e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, true, false, false, false, true, false}), ElementsAreArray({ DoubleNear(0.06929515267715164, 1.0e-7), DoubleNear(0.09557768894816976, 1.0e-7), DoubleNear(0.1279281639484016, 1.0e-7), DoubleNear(0.1764492578367948, 1.0e-7), DoubleNear(0.07963669298251086, 1.0e-7), DoubleNear(0.10984160906904265, 1.0e-7), DoubleNear(0.1434345155183184, 1.0e-7), DoubleNear(0.19783691901961148, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, true, false, false, false, false, true}), Matrix({ { 0.07744353964667373 + 1.0205340807372979e-20i, -7.453889935837843e-20 + -1.3552527156068805e-19i, 2.168404344971009e-18 + 8.673617379884035e-19i, -0.000637245536213338 + 0.0005026337801432359i, -0.005666280324015643 + -0.005355834824082096i, -4.235164736271502e-21 + 1.8634724839594607e-20i, -4.0657581468206416e-20 + -2.168404344971009e-19i, 8.582394368012808e-05 + 3.768584486033838e-06i }, { -6.098637220230962e-20 + 9.486769009248164e-20i, 0.1066416050291468 + -8.430624803140458e-21i, -0.0006880047169234477 + 0.00043054860336086333i, 0.0 + -3.0357660829594124e-18i, 1.6940658945086007e-20 + -1.1011428314305904e-20i, -0.007833945766725123 + -0.007204324617605886i, 8.546963315156853e-05 + 1.7514546266833185e-05i, -3.2526065174565133e-19 + 1.6263032587282567e-19i }, { 1.734723475976807e-18 + -4.336808689942018e-19i, -0.0006880047169234478 + -0.0004305486033608634i, 0.14110673464648024 + 7.728431181144193e-20i, -1.0842021724855044e-19 + 2.574980159653073e-19i, -2.574980159653073e-19 + -1.3552527156068805e-19i, 2.5378519124519166e-05 + 8.207242109798265e-05i, -0.010324299712555673 + -0.009758649550112478i, 2.371692252312041e-20 + -2.541098841762901e-20i }, { -0.000637245536213338 + -0.0005026337801432358i, -2.168404344971009e-19 + 3.469446951953614e-18i, -1.0842021724855044e-19 + -2.574980159653073e-19i, 0.19430734612307832 + -2.8507952631027546e-20i, 1.2317438582727142e-05 + 8.637186016728763e-05i, 2.710505431213761e-19 + -1.3552527156068805e-19i, -1.0164395367051604e-20 + 4.0657581468206416e-20i, -0.014273915055840013 + -0.013126707879851951i }, { -0.005666280324015643 + 0.005355834824082096i, 1.6940658945086007e-20 + 7.623296525288703e-21i, -2.168404344971009e-19 + 1.3552527156068805e-19i, 1.2317438582727137e-05 + -8.637186016728763e-05i, 0.07148830601298876 + 1.641126335305207e-21i, -6.098637220230962e-20 + -1.2197274440461925e-19i, 1.951563910473908e-18 + 4.336808689942018e-19i, -0.000573285937813602 + 0.0004478023436100467i }, { -4.235164736271502e-21 + -1.4399560103323106e-20i, -0.007833945766725123 + 0.007204324617605886i, 2.537851912451917e-05 + -8.207242109798265e-05i, 2.981555974335137e-19 + 1.4907779871675686e-19i, -5.421010862427522e-20 + 8.131516293641283e-20i, 0.0987776929880656 + -1.5736283973208798e-20i, -0.0006148242509036965 + 0.0003888120959257569i, 4.336808689942018e-19 + -2.3852447794681098e-18i }, { -2.710505431213761e-20 + 2.439454888092385e-19i, 8.546963315156855e-05 + -1.7514546266833185e-05i, -0.010324299712555673 + 0.009758649550112478i, -1.5246593050577406e-20 + -3.3881317890172014e-20i, 1.3010426069826053e-18 + -4.336808689942018e-19i, -0.0006148242509036965 + -0.00038881209592575697i, 0.13025594482023975 + 6.090696286350453e-20i, -1.0842021724855044e-19 + 2.303929616531697e-19i }, { 8.582394368012808e-05 + -3.7685844860338454e-06i, -2.439454888092385e-19 + -1.0842021724855044e-19i, 3.218725199566341e-20 + 2.710505431213761e-20i, -0.014273915055840013 + 0.013126707879851951i, -0.0005732859378136021 + -0.0004478023436100467i, 4.336808689942018e-19 + 2.8189256484623115e-18i, -9.486769009248164e-20 + -2.710505431213761e-19i, 0.17997883073332796 + -2.3928680759933985e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, true, false, false, false, false, true}), ElementsAreArray({ DoubleNear(0.07744353964667373, 1.0e-7), DoubleNear(0.1066416050291468, 1.0e-7), DoubleNear(0.14110673464648024, 1.0e-7), DoubleNear(0.19430734612307832, 1.0e-7), DoubleNear(0.07148830601298876, 1.0e-7), DoubleNear(0.0987776929880656, 1.0e-7), DoubleNear(0.13025594482023975, 1.0e-7), DoubleNear(0.17997883073332796, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, false, true, true, false, false, false}), Matrix({ { 0.13421989687555047 + 6.310395457044538e-20i, -9.147955830346444e-20 + 2.236166980751353e-19i, 0.0011941733697375238 + 0.009745534575304002i, -4.0657581468206416e-20 + 4.607859233063394e-19i, -5.692061405548898e-19 + -3.3881317890172014e-19i, 0.00018795913867729214 + 0.00021311746901158955i, 1.1858461261560205e-20 + -4.743384504624082e-20i, 0.0005043537873892499 + 0.0003570622543805877i }, { -7.453889935837843e-20 + -2.574980159653073e-19i, 0.1805738533748158 + -6.080108374509775e-20i, -2.574980159653073e-19 + -4.87890977618477e-19i, 0.0016065910642967698 + 0.013111235907831385i, 3.837688780955276e-05 + 0.0002988099389369893i, 1.0842021724855044e-18 + 1.6263032587282567e-19i, 0.00023062434285864433 + 0.0006132119303079153i, -9.317362419797304e-21 + 6.606856988583543e-20i }, { 0.0011941733697375238 + -0.009745534575304002i, -2.574980159653073e-19 + 4.0657581468206416e-19i, 0.11488636998710883 + 2.2883124465666958e-20i, -1.2874900798265365e-19 + 3.1848438816761693e-19i, -2.964615315390051e-20 + 3.7269449679189215e-20i, 0.0002912382072612542 + 0.0005450197271553378i, -5.285485590866834e-19 + -2.981555974335137e-19i, 0.0002837345741834863 + 0.0003217124463678503i }, { -5.421010862427522e-20 + -4.336808689942018e-19i, 0.0016065910642967716 + -0.013111235907831384i, -1.0842021724855044e-19 + -3.7947076036992655e-19i, 0.15456333235043654 + 7.995196928692544e-20i, -6.81829476929546e-05 + 0.0006515884779788858i, 2.456395547037471e-20 + -6.098637220230962e-20i, 5.7932005848494486e-05 + 0.0004510699047820387i, 8.131516293641283e-19 + 9.486769009248164e-20i }, { -6.098637220230962e-19 + 3.1170812458958252e-19i, 3.8376887809552776e-05 + -0.0002988099389369892i, -3.3881317890172014e-20 + -4.0657581468206416e-20i, -6.81829476929546e-05 + -0.0006515884779788858i, 0.09223722333380699 + 6.782364035051981e-20i, -6.776263578034403e-20 + -1.3213713977167085e-19i, 0.0008206475967262447 + 0.006697226492158014i, -1.7618285302889447e-19 + -2.371692252312041e-19i }, { 0.00018795913867729216 + -0.00021311746901158957i, 9.486769009248164e-19 + -1.1519648082658485e-19i, 0.0002912382072612542 + -0.0005450197271553378i, 1.3552527156068805e-20 + 6.606856988583543e-20i, -5.759824041329242e-20 + 1.1519648082658485e-19i, 0.13177480824527626 + 2.4616895029578104e-21i, -4.743384504624082e-20 + 2.778268066994105e-19i, 0.0011724190710315076 + 0.009567999825682533i }, { 1.9481757786848908e-20 + 5.421010862427522e-20i, 0.0002306243428586443 + -0.0006132119303079153i, -4.472333961502706e-19 + 3.1170812458958252e-19i, 5.7932005848494486e-05 + -0.00045106990478203864i, 0.0008206475967262442 + -0.006697226492158014i, -6.776263578034403e-20 + -3.3203691532368573e-19i, 0.0789510349299162 + -3.7729775690074975e-21i, -6.776263578034403e-20 + -1.8973538018496328e-19i }, { 0.0005043537873892499 + -0.0003570622543805877i, 8.470329472543003e-21 + -8.131516293641283e-20i, 0.0002837345741834863 + -0.0003217124463678503i, 8.402566836762659e-19 + -9.486769009248164e-20i, -1.8295911660692887e-19 + 2.236166980751353e-19i, 0.0011724190710315084 + -0.009567999825682533i, -7.453889935837843e-20 + 2.0328790734103208e-19i, 0.1127934809030901 + -9.82161172120963e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, false, true, true, false, false, false}), ElementsAreArray({ DoubleNear(0.13421989687555047, 1.0e-7), DoubleNear(0.1805738533748158, 1.0e-7), DoubleNear(0.11488636998710883, 1.0e-7), DoubleNear(0.15456333235043654, 1.0e-7), DoubleNear(0.09223722333380699, 1.0e-7), DoubleNear(0.13177480824527626, 1.0e-7), DoubleNear(0.0789510349299162, 1.0e-7), DoubleNear(0.1127934809030901, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, false, true, false, true, false, false}), Matrix({ { 0.10519746932658984 + 5.899969116611039e-20i, 0.0002215953560133058 + -6.104752942682237e-05i, 0.0009359567348652711 + 0.007638253332196647i, 0.0004384600639948022 + -0.00023999745219877575i, -0.017537546042521005 + -0.025719744989229285i, 0.0006601602337938756 + 0.0007806031250565855i, 0.0017114436752920467 + -0.001502210928182291i, 0.0017874586799750524 + 0.0013219882566527733i }, { 0.0002215953560133058 + 6.104752942682232e-05i, 0.14389850517187153 + -3.69650472137697e-20i, 0.0004995070523506495 + 1.8404060209509764e-05i, 0.0012802853140366907 + 0.010448285910898292i, 0.0005843300637490402 + 0.000898151365839242i, -0.03139062090247339 + -0.03470427432758789i, 0.0016857455995600615 + 0.0016086816497808268i, 0.0022405460652969948 + -0.002588001553044416i }, { 0.0009359567348652708 + -0.007638253332196647i, 0.0004995070523506495 + -1.840406020950986e-05i, 0.09004443949147212 + 1.4671495729699914e-20i, 0.00033451027931886014 + -9.215457619547995e-05i, -0.0020235117209699933 + 0.0010445465243561463i, 0.001006862473489915 + 0.001982142639373808i, -0.015011373501316146 + -0.02201497846140083i, 0.0009965478887939037 + 0.0011783630040702407i }, { 0.00043846006399480224 + 0.00023999745219877575i, 0.0012802853140366915 + -0.010448285910898292i, 0.00033451027931886014 + 9.215457619547992e-05i, 0.12317083599830266 + -2.4537485690773013e-20i, 0.0007876021941352689 + 0.002193006534548172i, -0.002799119636188901 + 0.001970463897558103i, 0.0008820781100997534 + 0.0013558084865255952i, -0.02686900058096799 + -0.029705343196845098i }, { -0.017537546042521005 + 0.025719744989229285i, 0.0005843300637490404 + -0.0008981513658392421i, -0.0020235117209699937 + -0.001044546524356146i, 0.0007876021941352689 + -0.0021930065345481726i, 0.12125965088276763 + 7.19279037548548e-20i, -0.00022159535601330596 + 6.104752942682245e-05i, 0.001078864231598497 + 0.00880450773526537i, -0.00043846006399480246 + 0.00023999745219877594i }, { 0.0006601602337938757 + -0.0007806031250565855i, -0.03139062090247339 + 0.03470427432758789i, 0.001006862473489915 + -0.001982142639373808i, -0.002799119636188901 + -0.001970463897558104i, -0.00022159535601330596 + -6.104752942682245e-05i, 0.16845015644822053 + -2.1374347028370235e-20i, -0.0004995070523506498 + -1.8404060209509974e-05i, 0.0014987248212915867 + 0.012230949822615626i }, { 0.0017114436752920467 + 0.0015022109281822911i, 0.0016857455995600617 + -0.0016086816497808266i, -0.015011373501316146 + 0.02201497846140083i, 0.0008820781100997535 + -0.0013558084865255952i, 0.0010788642315984974 + -0.00880450773526537i, -0.0004995070523506498 + 1.8404060209509933e-05i, 0.10379296542555291 + 4.4386511669595465e-21i, -0.00033451027931886035 + 9.215457619548007e-05i }, { 0.0017874586799750524 + -0.0013219882566527735i, 0.0022405460652969943 + 0.0025880015530444166i, 0.0009965478887939035 + -0.0011783630040702407i, -0.02686900058096799 + 0.0297053431968451i, -0.00043846006399480246 + -0.00023999745219877594i, 0.001498724821291588 + -0.012230949822615626i, -0.00033451027931886035 + -9.21545761954801e-05i, 0.14418597725522397 + 6.273337765602162e-21i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, false, true, false, true, false, false}), ElementsAreArray({ DoubleNear(0.10519746932658984, 1.0e-7), DoubleNear(0.14389850517187153, 1.0e-7), DoubleNear(0.09004443949147212, 1.0e-7), DoubleNear(0.12317083599830266, 1.0e-7), DoubleNear(0.12125965088276763, 1.0e-7), DoubleNear(0.16845015644822053, 1.0e-7), DoubleNear(0.10379296542555291, 1.0e-7), DoubleNear(0.14418597725522397, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, false, true, false, false, true, false}), Matrix({ { 0.10626506330942816 + 2.7235128463461574e-20i, -7.453889935837843e-20 + 4.743384504624082e-20i, 0.0009454552692381563 + 0.007715769962102749i, -1.3552527156068805e-19 + 1.1519648082658485e-19i, 0.004882667007492589 + 0.008187950828442567i, -4.658681209898652e-21 + -2.964615315390051e-21i, -0.0005510748309873418 + 0.0004273735437782969i, -1.6940658945086007e-20 + 8.470329472543003e-22i }, { -6.776263578034403e-20 + -7.792703114739563e-20i, 0.14656969174115073 + -7.640501882029806e-20i, -1.3552527156068805e-19 + -9.486769009248164e-20i, 0.0013040512380232917 + 0.010642237341900621i, -3.3881317890172014e-21 + -5.082197683525802e-21i, 0.006734584028609719 + 0.011293508812223609i, -5.082197683525802e-21 + -6.776263578034403e-21i, -0.000760088646152015 + 0.000589469451380363i }, { 0.0009454552692381561 + -0.007715769962102749i, -1.6263032587282567e-19 + 5.421010862427522e-20i, 0.09095825331612509 + -2.563287961694636e-20i, -9.486769009248164e-20 + 8.131516293641283e-20i, 0.0006379583862481534 + -0.00028167483502258297i, -9.317362419797304e-21 + -6.776263578034403e-21i, 0.004179349719414263 + 0.00700852831964932i, -1.0164395367051604e-20 + -8.470329472543003e-22i }, { -1.2197274440461925e-19 + -7.453889935837843e-20i, 0.0013040512380232921 + -0.010642237341900621i, -1.0842021724855044e-19 + -1.2874900798265365e-19i, 0.12545725504381383 + -1.6795075157276674e-20i, 0.0 + -8.470329472543003e-21i, 0.0008799257357406357 + -0.00038850956706517584i, 1.6940658945086007e-21 + -1.1858461261560205e-20i, 0.005764509811369627 + 0.00966675032582403i }, { 0.004882667007492589 + -0.008187950828442567i, 2.964615315390051e-21 + 5.082197683525802e-21i, 0.0006379583862481535 + 0.00028167483502258286i, 0.0 + 1.3552527156068805e-20i, 0.1201920568999293 + 1.0369246645750361e-19i, -9.486769009248164e-20 + 4.404571325722362e-20i, 0.001069365697225612 + 0.008726991105359268i, -9.486769009248164e-20 + 1.0164395367051604e-19i }, { -8.893845946170154e-21 + 3.3881317890172014e-21i, 0.006734584028609719 + -0.011293508812223609i, -7.623296525288703e-21 + 1.3552527156068805e-20i, 0.0008799257357406357 + 0.0003885095670651759i, -8.131516293641283e-20 + -6.437450399132683e-20i, 0.16577896987894133 + 1.8065624578158124e-20i, -1.8973538018496328e-19 + -1.1519648082658485e-19i, 0.0014749588973049857 + 0.012036998391613297i }, { -0.0005510748309873419 + -0.00042737354377829685i, -3.3881317890172014e-21 + 1.0164395367051604e-20i, 0.004179349719414261 + -0.00700852831964932i, 2.117582368135751e-21 + 5.082197683525802e-21i, 0.001069365697225612 + -0.008726991105359268i, -1.6263032587282567e-19 + 2.0328790734103208e-20i, 0.10287915160089996 + 4.474302651360582e-20i, -1.0842021724855044e-19 + 4.743384504624082e-20i }, { -1.8634724839594607e-20 + 0.0i, -0.0007600886461520148 + -0.0005894694513803632i, -1.4399560103323106e-20 + 1.6940658945086007e-21i, 0.005764509811369627 + -0.00966675032582403i, -1.2197274440461925e-19 + -1.3552527156068805e-19i, 0.0014749588973049874 + -0.012036998391613297i, -6.776263578034403e-20 + -4.743384504624082e-20i, 0.14189955820971278 + -1.4690727678941772e-21i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, false, true, false, false, true, false}), ElementsAreArray({ DoubleNear(0.10626506330942816, 1.0e-7), DoubleNear(0.14656969174115073, 1.0e-7), DoubleNear(0.09095825331612509, 1.0e-7), DoubleNear(0.12545725504381383, 1.0e-7), DoubleNear(0.1201920568999293, 1.0e-7), DoubleNear(0.16577896987894133, 1.0e-7), DoubleNear(0.10287915160089996, 1.0e-7), DoubleNear(0.14189955820971278, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, false, true, false, false, false, true}), Matrix({ { 0.11775615140956333 + 5.750042630585803e-20i, -9.486769009248164e-20 + 5.759824041329242e-20i, 0.0010476931022117028 + 0.008550123131749174i, -1.2197274440461925e-19 + 1.2197274440461925e-19i, -0.008615816978511184 + -0.008143771570186895i, 7.623296525288703e-21 + -2.541098841762901e-21i, 0.0005146526694206298 + -0.0006980397063170557i, 1.8634724839594607e-20 + 0.0i }, { -8.809142651444724e-20 + -5.421010862427522e-20i, 0.16215303491632727 + -2.167874949378975e-20i, -1.8973538018496328e-19 + -1.1519648082658485e-19i, 0.00144269844208523 + 0.011773723904234399i, 2.117582368135751e-21 + 9.317362419797304e-21i, -0.01191184323507885 + -0.010954477860192702i, 0.0 + 2.0328790734103208e-20i, 0.0006894092375207799 + -0.0009623671962946716i }, { 0.0010476931022117026 + -0.008550123131749174i, -1.8973538018496328e-19 + 4.743384504624082e-20i, 0.10079412288359066 + 2.998922631295688e-20i, -9.486769009248164e-20 + 7.453889935837843e-20i, -0.0006679649492506507 + 0.0005531271357559282i, 2.371692252312041e-20 + 6.776263578034403e-21i, -0.007374763058060131 + -0.006970712804007679i, 1.3552527156068805e-20 + -3.3881317890172014e-21i }, { -1.2197274440461925e-19 + -1.3552527156068805e-19i, 0.0014426984420852313 + -0.011773723904234399i, -1.0842021724855044e-19 + -1.0164395367051604e-19i, 0.13879591623589782 + -1.5259827940378255e-20i, -3.3881317890172014e-21 + 2.541098841762901e-20i, -0.0009013719391313851 + 0.0007674401244589552i, 3.3881317890172014e-21 + 1.6940658945086007e-20i, -0.010196017587486285 + -0.009376554637265135i }, { -0.008615816978511185 + 0.008143771570186895i, 5.505714157152952e-21 + -1.3552527156068805e-20i, -0.0006679649492506507 + -0.0005531271357559282i, -7.623296525288703e-21 + -2.0328790734103208e-20i, 0.10870096879979413 + 7.342716861510716e-20i, -7.453889935837843e-20 + 3.3881317890172014e-20i, 0.0009671278642520652 + 0.007892637935712843i, -1.0842021724855044e-19 + 9.486769009248164e-20i }, { 1.0164395367051604e-20 + 1.6940658945086007e-21i, -0.01191184323507885 + 0.010954477860192702i, 2.541098841762901e-20 + -5.082197683525802e-21i, -0.0009013719391313848 + -0.0007674401244589554i, -6.098637220230962e-20 + -8.809142651444724e-20i, 0.1501956267037648 + -3.6660644748350187e-20i, -1.3552527156068805e-19 + -9.486769009248164e-20i, 0.0013363116932430471 + 0.01090551182927952i }, { 0.0005146526694206298 + 0.0006980397063170557i, 1.1858461261560205e-20 + -2.371692252312041e-20i, -0.007374763058060131 + 0.006970712804007679i, 0.0 + -1.3552527156068805e-20i, 0.0009671278642520654 + -0.007892637935712843i, -1.3552527156068805e-19 + 2.710505431213761e-20i, 0.09304328203343439 + -1.087907941629742e-20i, -1.0842021724855044e-19 + 5.421010862427522e-20i }, { 2.0328790734103208e-20 + 0.0i, 0.0006894092375207797 + 0.0009623671962946717i, 1.6940658945086007e-20 + 7.623296525288703e-21i, -0.010196017587486287 + 0.009376554637265134i, -1.2197274440461925e-19 + -7.453889935837843e-20i, 0.0013363116932430482 + -0.01090551182927952i, -6.776263578034403e-20 + -7.453889935837843e-20i, 0.1285608970176288 + -3.0043199847925965e-21i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, false, true, false, false, false, true}), ElementsAreArray({ DoubleNear(0.11775615140956333, 1.0e-7), DoubleNear(0.16215303491632727, 1.0e-7), DoubleNear(0.10079412288359066, 1.0e-7), DoubleNear(0.13879591623589782, 1.0e-7), DoubleNear(0.10870096879979413, 1.0e-7), DoubleNear(0.1501956267037648, 1.0e-7), DoubleNear(0.09304328203343439, 1.0e-7), DoubleNear(0.1285608970176288, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, false, false, true, true, false, false}), Matrix({ { 0.11799836617549339 + 5.135137242729196e-20i, 0.0003261089396491116 + -0.00035072173335154726i, 0.0006488460602589443 + 0.0008404082290043968i, 0.0002234351152775731 + 0.0002533419050085377i, -0.00559648245834384 + -0.02975750239018128i, 0.0009587318870794427 + 0.0010763113008754827i, -0.002701655999221652 + 0.001706659866877422i, 5.329202296956614e-05 + -6.836276438157874e-05i }, { 0.00032610893964911164 + 0.00035072173335154715i, 0.15122055542383395 + -1.3976043629695956e-20i, 4.345648591548546e-05 + 0.00033836068123246996i, -0.0015340745962058606 + 0.000491402425586468i, 0.0009395683370484822 + 0.0015089515789876366i, -0.05276509034488669 + -0.035194208612590865i, 6.35849469620222e-05 + -0.0001281773399849147i, -0.005937531658860276 + 0.0007030879652427883i }, { 0.0006488460602589442 + -0.0008404082290043968i, 4.3456485915485446e-05 + -0.0003383606812324699i, 0.07724354264256858 + 2.2319814468518346e-20i, 0.0002299966956830544 + 0.00019751962772924492i, 0.0029596511768261898 + -0.002602068090452666i, -9.391131891556005e-05 + 0.00010794971118679085i, -0.026952437085493313 + -0.017977221060448828i, 0.0006979762355083367 + 0.0008826548282513432i }, { 0.00022343511527757312 + -0.00025334190500853775i, -0.0015340745962058606 + -0.000491402425586468i, 0.00022999669568305437 + -0.00019751962772924494i, 0.11584878574634026 + -4.752648927484676e-20i, -7.44863961419749e-05 + -4.4331524402628004e-05i, 0.0019061208574971847 + -0.004457856903664007i, 0.0005268398368003115 + 0.0007450082733772006i, -0.005494531138554689 + -0.02921540891184212i }, { -0.005596482458343838 + 0.02975750239018128i, 0.0009395683370484823 + -0.0015089515789876368i, 0.0029596511768261898 + 0.0026020680904526665i, -7.44863961419749e-05 + 4.4331524402628004e-05i, 0.13110790068716588 + 3.4635706608820375e-20i, -0.00032610893964911175 + 0.00035072173335154775i, -0.0006488460602589454 + -0.0008404082290043974i, 0.0002482585975832053 + 0.00028148801037090204i }, { 0.0009587318870794426 + -0.0010763113008754829i, -0.05276509034488669 + 0.035194208612590865i, -9.391131891556005e-05 + -0.00010794971118679086i, 0.0019061208574971844 + 0.004457856903664007i, -0.00032610893964911175 + -0.0003507217333515478i, 0.18391663030141842 + 3.312692917152365e-20i, 5.285240774256178e-05 + 0.00041151916248655796i, 0.0015340745962058625 + -0.0004914024255864678i }, { -0.002701655999221652 + -0.001706659866877422i, 6.35849469620222e-05 + 0.00012817733998491467i, -0.02695243708549331 + 0.017977221060448828i, 0.0005268398368003115 + -0.0007450082733772007i, -0.0006488460602589453 + 0.0008404082290043974i, 5.28524077425618e-05 + -0.0004115191624865579i, 0.09394471562115464 + 4.173084831299397e-20i, -0.00022999669568305454 + -0.00019751962772924527i }, { 5.3292022969566134e-05 + 6.836276438157874e-05i, -0.0059375316588602765 + -0.0007030879652427885i, 0.0006979762355083367 + -0.0008826548282513432i, -0.005494531138554689 + 0.02921540891184212i, 0.00024825859758320537 + -0.00028148801037090204i, 0.0015340745962058625 + 0.0004914024255864678i, -0.0002299966956830545 + 0.00019751962772924527i, 0.1287195034020261 + -4.8227938434291726e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, false, false, true, true, false, false}), ElementsAreArray({ DoubleNear(0.11799836617549339, 1.0e-7), DoubleNear(0.15122055542383395, 1.0e-7), DoubleNear(0.07724354264256858, 1.0e-7), DoubleNear(0.11584878574634026, 1.0e-7), DoubleNear(0.13110790068716588, 1.0e-7), DoubleNear(0.18391663030141842, 1.0e-7), DoubleNear(0.09394471562115464, 1.0e-7), DoubleNear(0.1287195034020261, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, false, false, true, false, true, false}), Matrix({ { 0.11689318134251347 + -5.624828165360588e-21i, -9.486769009248164e-20 + 2.710505431213761e-19i, -5.692061405548898e-19 + -3.5236570605778894e-19i, 0.0002213423990090051 + 0.00025096907867162675i, 0.00537100776273005 + 0.009006870096390392i, -2.202285662861181e-20 + 5.929230630780102e-21i, 1.5246593050577406e-20 + -3.3881317890172014e-20i, -9.167464981276227e-06 + 2.8586433067099075e-05i }, { -9.486769009248164e-20 + -3.6591823321385775e-19i, 0.1572632126802341 + -4.392659924901598e-20i, 4.519297371781418e-05 + 0.0003518813141913913i, 9.75781955236954e-19 + 1.0842021724855044e-19i, 1.0164395367051604e-20 + -1.9481757786848908e-20i, 0.007225929916497233 + 0.01211746751422127i, -2.5036682550664424e-05 + 1.965045768492694e-05i, 2.0328790734103208e-20 + 5.421010862427522e-20i }, { -5.421010862427522e-19 + 2.710505431213761e-19i, 4.519297371781418e-05 + -0.0003518813141913913i, 0.08033013528303978 + 7.227077011875803e-21i, -6.776263578034403e-20 + -1.4907779871675686e-19i, -3.3881317890172014e-20 + -2.0328790734103208e-20i, 2.9189735960135707e-05 + -1.2686026759683628e-05i, 0.0036910089641768017 + 0.006189609051701494i, 7.623296525288703e-21 + -8.470329472543003e-21i }, { 0.0002213423990090052 + -0.00025096907867162675i, 8.131516293641283e-19 + -1.3552527156068805e-19i, -6.776263578034403e-20 + 1.4230153513872246e-19i, 0.11476373410473045 + -4.927349472855875e-20i, 2.950794557466883e-05 + 5.523379187150107e-06i, 2.371692252312041e-20 + 5.421010862427522e-20i, -1.1858461261560205e-20 + 4.235164736271502e-22i, 0.0052731639234821145 + 0.008842791623826368i }, { 0.00537100776273005 + -0.009006870096390392i, 1.6940658945086007e-20 + 1.0164395367051604e-20i, -4.0657581468206416e-20 + 1.5246593050577406e-20i, 2.950794557466883e-05 + -5.523379187150115e-06i, 0.13221308552014582 + 9.161190720147292e-20i, -1.0842021724855044e-19 + 2.710505431213761e-19i, -5.421010862427522e-19 + -2.439454888092385e-19i, 0.00025035131385177324 + 0.000283860836707813i }, { -2.710505431213761e-20 + -8.470329472543003e-22i, 0.007225929916497231 + -0.01211746751422127i, 2.9189735960135703e-05 + 1.2686026759683631e-05i, 3.218725199566341e-20 + -5.759824041329242e-20i, -8.131516293641283e-20 + -2.846030702774449e-19i, 0.17787397304501823 + 6.307748479084368e-20i, 5.111591994023307e-05 + 0.0003979985295276366i, 9.215718466126788e-19 + 1.3552527156068805e-19i }, { 1.3552527156068805e-20 + 4.573977915173222e-20i, -2.503668255066443e-05 + -1.965045768492694e-05i, 0.0036910089641768017 + -0.006189609051701494i, -1.1858461261560205e-20 + 8.470329472543003e-22i, -5.421010862427522e-19 + 2.981555974335137e-19i, 5.111591994023307e-05 + -0.0003979985295276365i, 0.09085812298068344 + 5.682358576963651e-20i, -6.098637220230962e-20 + -1.8295911660692887e-19i }, { -9.16746498127623e-06 + -2.858643306709907e-05i, 2.0328790734103208e-20 + -7.962109704190423e-20i, 3.3881317890172014e-21 + 5.082197683525802e-21i, 0.0052731639234821145 + -0.008842791623826368i, 0.00025035131385177324 + -0.00028386083670781304i, 9.75781955236954e-19 + -8.131516293641283e-20i, -6.098637220230962e-20 + 1.7618285302889447e-19i, 0.1298045550436359 + -4.648093298057973e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, false, false, true, false, true, false}), ElementsAreArray({ DoubleNear(0.11689318134251347, 1.0e-7), DoubleNear(0.1572632126802341, 1.0e-7), DoubleNear(0.08033013528303978, 1.0e-7), DoubleNear(0.11476373410473045, 1.0e-7), DoubleNear(0.13221308552014582, 1.0e-7), DoubleNear(0.17787397304501823, 1.0e-7), DoubleNear(0.09085812298068344, 1.0e-7), DoubleNear(0.1298045550436359, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, false, false, true, false, false, true}), Matrix({ { 0.13002124750450636 + 5.2211640264347107e-20i, -1.0842021724855044e-19 + 2.846030702774449e-19i, -5.692061405548898e-19 + -2.981555974335137e-19i, 0.0002685500805007526 + 0.0002330872672719497i, -0.009465951769259011 + -0.009638988124715645i, 2.541098841762901e-20 + -2.202285662861181e-20i, 8.470329472543003e-20 + 8.131516293641283e-20i, -2.7705016478784137e-05 + -4.566631878513101e-05i }, { -1.0842021724855044e-19 + -3.3881317890172014e-19i, 0.1740802906345772 + 2.4021324988539924e-20i, 0.00012309211118139245 + 0.0003882421490203249i, 1.1384122811097797e-18 + 1.7618285302889447e-19i, -9.317362419797304e-21 + 2.879912020664621e-20i, -0.012448640434496876 + -0.01290183428314739i, -1.9985332419588017e-05 + -5.775305646838879e-05i, -1.2197274440461925e-19 + -1.0164395367051604e-19i }, { -6.2341624917916505e-19 + 3.2526065174565133e-19i, 0.00012309211118139245 + -0.0003882421490203249i, 0.08852902678864763 + 3.52780123544678e-20i, -5.421010862427522e-20 + -1.7618285302889447e-19i, 7.115076756936123e-20 + -2.371692252312041e-20i, -4.728508281457034e-05 + 6.85750828548025e-05i, -0.0065246282673123044 + -0.0054754962494789295i, -3.8116482626443515e-21 + 1.6093625997831706e-20i }, { 0.00026855008050075265 + -0.00023308726727194968i, 1.0299920638612292e-18 + -1.3552527156068805e-19i, -7.453889935837843e-20 + 1.6940658945086007e-19i, 0.1268686605176479 + -6.095990242270793e-20i, -6.0384542723194365e-05 + 2.3879350586375834e-05i, -7.453889935837843e-20 + -1.6940658945086007e-20i, 1.3552527156068805e-20 + -2.117582368135751e-21i, -0.00965922038806826 + -0.007429198214310449i }, { -0.009465951769259011 + 0.009638988124715645i, -1.0164395367051604e-20 + -3.3881317890172014e-20i, 8.809142651444724e-20 + 1.3552527156068805e-20i, -6.038454272319437e-05 + -2.3879350586375834e-05i, 0.11908501935815294 + 3.3775438771765226e-20i, -9.486769009248164e-20 + 2.574980159653073e-19i, -5.421010862427522e-19 + -2.981555974335137e-19i, 0.00020314363236002578 + 0.00030174264810749006i }, { 3.218725199566341e-20 + 2.286988957586611e-20i, -0.012448640434496876 + 0.012901834283147388i, -4.728508281457034e-05 + -6.857508285480253e-05i, -6.776263578034403e-20 + 1.3552527156068805e-20i, -6.776263578034403e-20 + -3.1170812458958252e-19i, 0.16105689509067514 + -4.870439446712227e-21i, -2.6783217523345206e-05 + 0.000361637694698703i, 7.589415207398531e-19 + 6.776263578034403e-20i }, { 9.825582188149884e-20 + -7.453889935837843e-20i, -1.9985332419588017e-05 + 5.775305646838879e-05i, -0.006524628267312305 + 0.005475496249478929i, 1.6940658945086007e-20 + 3.8116482626443515e-21i, -4.607859233063394e-19 + 2.439454888092385e-19i, -2.6783217523345203e-05 + -0.0003616376946987029i, 0.08265923147507556 + 2.8772650427044515e-20i, -7.453889935837843e-20 + -1.5585406229479126e-19i }, { -2.7705016478784134e-05 + 4.566631878513101e-05i, -1.4907779871675686e-19 + 7.453889935837843e-20i, -6.3527471044072525e-21 + -1.3552527156068805e-20i, -0.00965922038806826 + 0.007429198214310449i, 0.0002031436323600258 + -0.0003017426481074901i, 7.589415207398531e-19 + -8.131516293641283e-20i, -5.421010862427522e-20 + 1.4907779871675686e-19i, 0.11769962863071844 + -3.4794525286430556e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, false, false, true, false, false, true}), ElementsAreArray({ DoubleNear(0.13002124750450636, 1.0e-7), DoubleNear(0.1740802906345772, 1.0e-7), DoubleNear(0.08852902678864763, 1.0e-7), DoubleNear(0.1268686605176479, 1.0e-7), DoubleNear(0.11908501935815294, 1.0e-7), DoubleNear(0.16105689509067514, 1.0e-7), DoubleNear(0.08265923147507556, 1.0e-7), DoubleNear(0.11769962863071844, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, false, false, false, true, true, false}), Matrix({ { 0.09162576980489717 + -5.636201898783192e-21i, 0.00026097984777130357 + -7.309094211976464e-05i, -0.015222807243886912 + -0.02240496527813831i, 0.0007772829790819295 + 0.0009186034746107763i, 0.004200772240388097 + 0.007052986260580604i, 1.660264684238318e-05 + 1.8042159735218008e-05i, 0.0009668456223455858 + -0.002238376046453116i, -3.545572860587503e-05 + 0.00010290706771217018i }, { 0.0002609798477713035 + 7.309094211976457e-05i, 0.1253125336422941 + -6.047021150007654e-20i, 0.0006882690273544738 + 0.0010583067271729238i, -0.027397369568597438 + -0.03021791403642588i, 7.320983613436622e-06 + 2.213117154848225e-05i, 0.005768610283386324 + 0.009663707441416905i, -4.9567137807377294e-05 + 0.00010083513373717873i, 0.0011392975449783745 + -0.0034576769229855233i }, { -0.01522280724388691 + 0.022404965278138313i, 0.0006882690273544739 + -0.0010583067271729238i, 0.10559754682065607 + 7.238450745298407e-21i, -0.00026097984777130373 + 7.309094211976476e-05i, -0.0024768870848343233 + -0.00019134008618455943i, 0.00011247360529241936 + 4.971592814996913e-06i, 0.004861244486518755 + 0.008143492887511284i, -1.6602646842383192e-05 + -1.8042159735218008e-05i }, { 0.0007772829790819295 + -0.0009186034746107763i, -0.027397369568597445 + 0.03021791403642588i, -0.00026097984777130373 + -7.309094211976479e-05i, 0.14671441314267042 + -3.27298824774982e-20i, 0.00010716446665468 + 1.70864138796113e-05i, -0.003527837099382063 + -0.0006669502972844346i, -7.320983613436624e-06 + -2.2131171548482266e-05i, 0.006730483556593022 + 0.011296551696630732i }, { 0.004200772240388098 + -0.007052986260580605i, 7.3209836134366315e-06 + -2.2131171548482253e-05i, -0.0024768870848343233 + 0.0001913400861845595i, 0.00010716446665468 + -1.7086413879611307e-05i, 0.10361613901316478 + 7.93073887945935e-20i, 0.0002951257875608624 + -8.011116350253766e-05i, -0.017326112299950243 + -0.0253297581724918i, 0.0008794251435058499 + 0.0010403626545160498i }, { 1.660264684238317e-05 + -1.8042159735218004e-05i, 0.005768610283386325 + -0.009663707441416905i, 0.00011247360529241938 + -4.971592814996914e-06i, -0.003527837099382063 + 0.0006669502972844342i, 0.0002951257875608625 + 8.011116350253766e-05i, 0.14175680752788006 + -1.0323214044661785e-21i, 0.00077813914649432 + 0.0011956531251919133i, -0.030862251914843937 + -0.034191703488007104i }, { 0.0009668456223455857 + 0.0022383760464531163i, -4.9567137807377294e-05 + -0.00010083513373717873i, 0.004861244486518755 + -0.008143492887511282i, -7.3209836134366265e-06 + 2.2131171548482263e-05i, -0.01732611229995024 + 0.025329758172491796i, 0.00077813914649432 + -0.0011956531251919138i, 0.11945506948766446 + 6.912810417651594e-20i, -0.0002951257875608626 + 8.011116350253774e-05i }, { -3.5455728605875034e-05 + -0.00010290706771217018i, 0.0011392975449783745 + 0.0034576769229855233i, -1.6602646842383192e-05 + 1.8042159735218008e-05i, 0.006730483556593021 + -0.011296551696630732i, 0.0008794251435058499 + -0.0010403626545160498i, -0.030862251914843937 + 0.034191703488007104i, -0.0002951257875608626 + -8.011116350253777e-05i, 0.1659217205607741 + 1.7628873214730126e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, false, false, false, true, true, false}), ElementsAreArray({ DoubleNear(0.09162576980489717, 1.0e-7), DoubleNear(0.1253125336422941, 1.0e-7), DoubleNear(0.10559754682065607, 1.0e-7), DoubleNear(0.14671441314267042, 1.0e-7), DoubleNear(0.10361613901316478, 1.0e-7), DoubleNear(0.14175680752788006, 1.0e-7), DoubleNear(0.11945506948766446, 1.0e-7), DoubleNear(0.1659217205607741, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, false, false, false, true, false, true}), Matrix({ { 0.10153541233452398 + 4.5348522721994636e-20i, 0.00029260774628454394 + -8.684555395961254e-05i, -0.016859387611684033 + -0.024828772883964387i, 0.0008750747852878493 + 0.0010282788225504417i, -0.00742793888219982 + -0.007036514724059599i, -2.8973392331238916e-05 + -1.1292409753693605e-05i, -0.0004865276600525023 + 0.0028945861081714147i, 1.4415836599500504e-06 + -0.0001419196324163033i }, { 0.0002926077462845439 + 8.684555395961252e-05i, 0.13864450294626532 + -2.1017005003747327e-20i, 0.0007710326929919902 + 0.001193268179116564i, -0.030258030512079356 + -0.03343628317029887i, -1.5195797892760363e-05 + -3.0953341713231834e-05i, -0.010192519653479398 + -0.009340677511764177i, 2.8794694776034728e-05 + -0.00015150113648935927i, -6.538680608912586e-05 + 0.004659360778131455i }, { -0.016859387611684033 + 0.024828772883964387i, 0.0007710326929919902 + -0.0011932681791165642i, 0.11701486195863 + 4.214112989682027e-20i, -0.0002926077462845441 + 8.684555395961265e-05i, 0.0029663739072381835 + -0.000737322432214544i, -0.0001442696929840809 + 4.3444806964312496e-05i, -0.008562641154371496 + -0.008077969650134974i, 2.8973392331238937e-05 + 1.1292409753693598e-05i }, { 0.0008750747852878493 + -0.001028278822550442i, -0.030258030512079356 + 0.03343628317029887i, -0.0002926077462845441 + -8.684555395961269e-05i, 0.1623044482059598 + -1.5921572430420677e-20i, -0.00014345431825710735 + 1.3935871792995437e-05i, 0.004419308643817689 + -0.00026293475813728975i, 1.5195797892760368e-05 + 3.095334171323187e-05i, -0.011915341169085738 + -0.010990354985693661i }, { -0.00742793888219982 + 0.007036514724059599i, -1.5195797892760366e-05 + 3.0953341713231834e-05i, 0.0029663739072381835 + 0.0007373224322145439i, -0.00014345431825710735 + -1.393587179299543e-05i, 0.09370649648353797 + 2.832266417381567e-20i, 0.00026349788904762205 + -6.635655166268976e-05i, -0.01568953193215312 + -0.022905950566665723i, 0.00078163333729993 + 0.0009306873065763843i }, { -2.8973392331238916e-05 + 1.1292409753693605e-05i, -0.010192519653479398 + 0.009340677511764177i, -0.0001442696929840809 + -4.344480696431249e-05i, 0.004419308643817689 + 0.0002629347581372894i, 0.0002634978890476221 + 6.63565516626897e-05i, 0.12842483822390885 + -4.0485527900795387e-20i, 0.0006953754808568036 + 0.0010606916732482732i, -0.028001590971362022 + -0.030973334354134123i }, { -0.0004865276600525022 + -0.0028945861081714147i, 2.879469477603473e-05 + 0.00015150113648935927i, -0.008562641154371494 + 0.008077969650134974i, 1.5195797892760375e-05 + -3.095334171323186e-05i, -0.015689531932153118 + 0.022905950566665723i, 0.0006953754808568036 + -0.0010606916732482734i, 0.10803775434969053 + 3.4225425024994073e-20i, -0.0002634978890476222 + 6.635655166268987e-05i }, { 1.4415836599500525e-06 + 0.00014191963241630333i, -6.538680608912596e-05 + -0.004659360778131455i, 2.8973392331238943e-05 + -1.1292409753693596e-05i, -0.011915341169085738 + 0.01099035498569366i, 0.00078163333729993 + -0.0009306873065763842i, -0.028001590971362025 + 0.030973334354134123i, -0.0002634978890476222 + -6.635655166268987e-05i, 0.1503316854974847 + 8.205631676526035e-22i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, false, false, false, true, false, true}), ElementsAreArray({ DoubleNear(0.10153541233452398, 1.0e-7), DoubleNear(0.13864450294626532, 1.0e-7), DoubleNear(0.11701486195863, 1.0e-7), DoubleNear(0.1623044482059598, 1.0e-7), DoubleNear(0.09370649648353797, 1.0e-7), DoubleNear(0.12842483822390885, 1.0e-7), DoubleNear(0.10803775434969053, 1.0e-7), DoubleNear(0.1503316854974847, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, false, false, false, false, true, true}), Matrix({ { 0.1025547737805033 + 1.8794370697817342e-20i, -8.131516293641283e-20 + 6.776263578034403e-20i, 0.004712186628457993 + 0.007902065069981567i, -6.776263578034403e-21 + -1.6940658945086007e-21i, -0.007503583894248049 + -0.007092475773904951i, 8.470329472543003e-21 + -4.235164736271502e-21i, 0.000201715791650541 + -0.0009040522861793582i, 1.1117307432712692e-21 + -2.117582368135751e-22i }, { -8.131516293641283e-20 + -1.0842021724855044e-19i, 0.1412203746013005 + -8.541797877467585e-20i, -1.6940658945086007e-21 + -1.0164395367051604e-20i, 0.00648879361078155 + 0.010881332464299178i, 2.541098841762901e-21 + 1.3552527156068805e-20i, -0.010374119514431745 + -0.009540342354839876i, -2.117582368135751e-22 + -2.117582368135751e-22i, 0.0002584337895049218 + -0.0012377077774445282i }, { 0.004712186628457994 + -0.007902065069981567i, 3.3881317890172014e-21 + 5.082197683525802e-21i, 0.11599550051265067 + 6.869528192099757e-20i, -8.131516293641283e-20 + 4.0657581468206416e-20i, -0.0008912651200448547 + 0.0002522821486723932i, 4.235164736271502e-22 + -7.411538288475128e-22i, -0.008486996142323268 + -0.008022008600289624i, 1.3552527156068805e-20 + -1.6940658945086007e-21i }, { -1.1858461261560205e-20 + 3.3881317890172014e-21i, 0.006488793610781552 + -0.01088133246429918i, -8.131516293641283e-20 + -6.098637220230962e-20i, 0.1597285765509246 + 4.8479401340507846e-20i, 1.4823076576950256e-21 + 7.411538288475128e-22i, -0.0012117738526902376 + 0.00036098849821123954i, 1.6940658945086007e-21 + 1.6940658945086007e-20i, -0.011733741308133393 + -0.010790690142617961i }, { -0.007503583894248048 + 0.007092475773904951i, 5.929230630780102e-21 + -1.1858461261560205e-20i, -0.0008912651200448547 + -0.00025228214867239324i, 4.235164736271502e-22 + 5.293955920339377e-23i, 0.09466854284504994 + -1.7192121851302127e-20i, -1.0842021724855044e-19 + 5.421010862427522e-20i, 0.004349830098448858 + 0.007294414078110321i, -6.776263578034403e-21 + -1.6940658945086007e-21i }, { 1.1858461261560205e-20 + 5.082197683525802e-21i, -0.010374119514431745 + 0.009540342354839876i, 2.117582368135751e-22 + 6.352747104407253e-22i, -0.0012117738526902376 + -0.00036098849821123965i, -8.131516293641283e-20 + -1.1519648082658485e-19i, 0.13080657218366404 + -7.782115202898884e-21i, 0.0 + -8.470329472543003e-21i, 0.006010300229197796 + 0.01007892667374846i }, { 0.00020171579165054112 + 0.0009040522861793583i, 2.117582368135751e-22 + -2.117582368135751e-22i, -0.008486996142323268 + 0.008022008600289624i, 1.6940658945086007e-21 + -1.6940658945086007e-20i, 0.004349830098448857 + -0.00729441407811032i, 1.6940658945086007e-21 + 6.776263578034403e-21i, 0.10707570798817856 + 7.974021105011187e-20i, -8.131516293641283e-20 + 4.743384504624082e-20i }, { 1.2705494208814505e-21 + -4.235164736271502e-22i, 0.0002584337895049218 + 0.0012377077774445285i, 1.3552527156068805e-20 + 4.235164736271502e-21i, -0.011733741308133393 + 0.010790690142617961i, -1.1858461261560205e-20 + 1.6940658945086007e-21i, 0.006010300229197794 + -0.010078926673748458i, -2.710505431213761e-20 + -4.743384504624082e-20i, 0.14794995153772955 + -3.18828495302439e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, false, false, false, false, true, true}), ElementsAreArray({ DoubleNear(0.1025547737805033, 1.0e-7), DoubleNear(0.1412203746013005, 1.0e-7), DoubleNear(0.11599550051265067, 1.0e-7), DoubleNear(0.1597285765509246, 1.0e-7), DoubleNear(0.09466854284504994, 1.0e-7), DoubleNear(0.13080657218366404, 1.0e-7), DoubleNear(0.10707570798817856, 1.0e-7), DoubleNear(0.14794995153772955, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, true, true, false, false, false, false}), Matrix({ { 0.0785421379521722 + 1.1215741925606502e-20i, -0.00235144354091274 + -0.014866668744898684i, 9.215718466126788e-19 + -9.75781955236954e-19i, -1.3552527156068805e-19 + -6.437450399132683e-20i, 0.0006988004888105401 + 0.005702843906525328i, 0.0010585286259587544 + -0.00030300615026858905i, 7.453889935837843e-20 + 5.082197683525802e-20i, 8.046812998915853e-21 + -1.0587911840678754e-20i }, { -0.00235144354091274 + 0.014866668744898684i, 0.11238430705880575 + -1.6988428625460944e-20i, 1.4907779871675686e-19 + 2.574980159653073e-19i, 1.1926223897340549e-18 + -1.2468324983583301e-18i, -0.0011003708762117544 + -3.846444929666491e-05i, 0.0009998990447032425 + 0.00816008040282352i, -1.9481757786848908e-20 + 1.3552527156068805e-20i, 9.486769009248164e-20 + 5.421010862427522e-20i }, { 7.589415207398531e-19 + 1.2468324983583301e-18i, 1.4907779871675686e-19 + -3.1170812458958252e-19i, 0.14291820060675214 + 4.9100200390228893e-20i, -0.001391263527312833 + -0.02942509254049913i, -4.404571325722362e-20 + 6.098637220230962e-20i, 2.0328790734103208e-20 + 1.0164395367051604e-20i, 0.0012715634059355164 + 0.01037710725366421i, 0.002124139963724591 + -0.0003628170625690865i }, { -1.2197274440461925e-19 + 1.1180834903756764e-19i, 1.1926223897340549e-18 + 1.5178830414797062e-18i, -0.0013912635273128327 + 0.029425092540499128i, 0.2049611362117194 + 2.92606869884508e-20i, -1.5670109524204556e-20 + -1.0587911840678754e-20i, -4.404571325722362e-20 + 8.131516293641283e-20i, -0.0021488964997267686 + 0.0001607813417197666i, 0.0018235681623427467 + 0.01488196523796288i }, { 0.0006988004888105403 + -0.005702843906525328i, -0.0011003708762117544 + 3.846444929666478e-05i, -4.0657581468206416e-20 + -4.743384504624082e-20i, -1.249373597200093e-20 + 9.317362419797304e-21i, 0.06722863994388528 + 5.201932077192853e-21i, -0.0020127329772543483 + -0.012725219178836535i, 1.0842021724855044e-18 + -1.0842021724855044e-18i, -1.8973538018496328e-19 + -8.131516293641283e-20i }, { 0.0010585286259587547 + 0.0003030061502685891i, 0.0009998990447032431 + -0.00816008040282352i, 1.6940658945086007e-20 + -5.929230630780102e-21i, -3.7269449679189215e-20 + -8.809142651444724e-20i, -0.0020127329772543483 + 0.012725219178836534i, 0.09619605872201166 + -1.1749687011009482e-20i, 1.0842021724855044e-19 + 2.439454888092385e-19i, 9.75781955236954e-19 + -8.131516293641283e-19i }, { 8.131516293641283e-20 + -5.421010862427522e-20i, -1.6940658945086007e-20 + -1.0164395367051604e-20i, 0.0012715634059355168 + -0.010377107253664208i, -0.0021488964997267686 + -0.00016078134171976666i, 8.131516293641283e-19 + 5.421010862427522e-19i, 9.486769009248164e-20 + -2.710505431213761e-19i, 0.12233173810305707 + -3.2150442458404803e-20i, -0.0011908608192169462 + -0.025186594142947064i }, { 4.446922973085077e-21 + 1.2705494208814505e-20i, 8.131516293641283e-20 + -6.098637220230962e-20i, 0.002124139963724591 + 0.00036281706256908677i, 0.0018235681623427478 + -0.014881965237962879i, -1.2197274440461925e-19 + 8.131516293641283e-20i, 1.0842021724855044e-18 + 9.215718466126788e-19i, -0.0011908608192169462 + 0.025186594142947064i, 0.17543778140159763 + 3.954419636371004e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, true, true, false, false, false, false}), ElementsAreArray({ DoubleNear(0.0785421379521722, 1.0e-7), DoubleNear(0.11238430705880575, 1.0e-7), DoubleNear(0.14291820060675214, 1.0e-7), DoubleNear(0.2049611362117194, 1.0e-7), DoubleNear(0.06722863994388528, 1.0e-7), DoubleNear(0.09619605872201166, 1.0e-7), DoubleNear(0.12233173810305707, 1.0e-7), DoubleNear(0.17543778140159763, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, true, false, true, false, false, false}), Matrix({ { 0.08516562256441815 + 7.093900933254765e-21i, -0.0025497415566770273 + -0.01612037986398175i, 2.439454888092385e-19 + -2.2768245622195593e-18i, -3.7947076036992655e-19 + 8.809142651444724e-20i, -1.5585406229479126e-19 + -4.472333961502706e-19i, -8.639736061993863e-20 + 4.404571325722362e-20i, -0.0006973526942898152 + -0.0021087604377573272i, -0.0002872014838846831 + 0.00017373962328789462i }, { -0.0025497415566770277 + 0.016120379863981748i, 0.12186171304583412 + -1.3393708478458624e-20i, 4.472333961502706e-19 + 1.1519648082658485e-19i, 1.0842021724855044e-19 + -3.469446951953614e-18i, 1.0333801956502464e-19 + -1.6940658945086007e-20i, -2.507217523872729e-19 + -7.047314121155779e-19i, 0.000510288903162862 + -1.2834713047560334e-06i, -0.0007118361786178424 + -0.0028786052933540054i }, { -1.6263032587282567e-19 + 2.2768245622195593e-18i, 4.87890977618477e-19 + -1.6263032587282567e-19i, 0.15497053999055072 + 4.6189765404961065e-20i, -0.0015085892432278613 + -0.03190652037958584i, 0.001863725517970682 + -0.0012081798532290844i, -0.00039717674873140636 + -0.00032038577099630403i, 5.285485590866834e-19 + 3.4220131069073734e-19i, 6.606856988583543e-20 + -1.0503208545953324e-19i }, { -2.981555974335137e-19 + -1.1519648082658485e-19i, 0.0 + 3.144186300207963e-18i, -0.0015085892432278613 + 0.03190652037958584i, 0.22224557698710862 + 6.524800671818282e-20i, 0.00011524975899898959 + 0.00031525805635456534i, 0.002356859631125406 + -0.0017995254539145506i, -7.369186641112413e-20 + 9.486769009248164e-20i, 7.047314121155779e-19 + 4.573977915173222e-19i }, { -1.7618285302889447e-19 + 5.55653613398821e-19i, 1.0164395367051604e-19 + 1.0164395367051604e-20i, 0.001863725517970682 + 0.0012081798532290844i, 0.00011524975899898957 + -0.00031525805635456523i, 0.06060515533163933 + 9.32377306954459e-21i, -0.0018144349614900605 + -0.011471508059753468i, 1.8973538018496328e-18 + 2.439454888092385e-19i, 6.098637220230962e-20 + -2.202285662861181e-19i }, { -9.147955830346444e-20 + -4.0657581468206416e-20i, -1.2874900798265365e-19 + 6.776263578034403e-19i, -0.00039717674873140636 + 0.00032038577099630403i, 0.0023568596311254056 + 0.0017995254539145504i, -0.001814434961490061 + 0.011471508059753468i, 0.0867186527349833 + -1.5344407158011802e-20i, -2.236166980751353e-19 + 3.7947076036992655e-19i, 2.3852447794681098e-18 + 1.4094628242311558e-18i }, { -0.0006973526942898151 + 0.002108760437757327i, 0.000510288903162862 + 1.2834713047559995e-06i, 3.2526065174565133e-19 + -3.2526065174565133e-19i, -7.199780051661553e-20 + -7.962109704190423e-20i, 1.7889335846010823e-18 + -4.607859233063394e-19i, -2.642742795433417e-19 + -4.2012834183813297e-19i, 0.11027939871925853 + -2.9240007473136975e-20i, -0.0010735351033019174 + -0.022705166303860352i }, { -0.00028720148388468314 + -0.00017373962328789462i, -0.0007118361786178425 + 0.0028786052933540054i, 6.268043809681823e-20 + 8.300922883092143e-20i, 7.047314121155779e-19 + -4.641740550953566e-19i, 4.743384504624082e-20 + 2.507217523872729e-19i, 2.3852447794681098e-18 + -8.673617379884035e-19i, -0.0010735351033019176 + 0.02270516630386035i, 0.1581533406262084 + 3.556876633978019e-21i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, true, false, true, false, false, false}), ElementsAreArray({ DoubleNear(0.08516562256441815, 1.0e-7), DoubleNear(0.12186171304583412, 1.0e-7), DoubleNear(0.15497053999055072, 1.0e-7), DoubleNear(0.22224557698710862, 1.0e-7), DoubleNear(0.06060515533163933, 1.0e-7), DoubleNear(0.0867186527349833, 1.0e-7), DoubleNear(0.11027939871925853, 1.0e-7), DoubleNear(0.1581533406262084, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, true, false, false, true, false, false}), Matrix({ { 0.06748330292537924 + 6.486750363640843e-21i, -0.0020203572365189502 + -0.012773422478188586i, -0.00292012155713513 + 0.0024632598250679833i, 0.0004612257844712667 + 0.00034728195798340935i, -0.01268552198343478 + -0.016406401514227002i, -0.002725661071349052 + 0.0028923350697741264i, -0.017330708054568038 + -0.004868695733961702i, -0.0001337917263248223 + 0.002717231559044999i }, { -0.0020203572365189502 + 0.012773422478188586i, 0.09656045067077876 + -1.4045113210844133e-20i, -0.00032872085287580433 + -0.0008138328303609634i, -0.004139874138331568 + 0.002979213970825805i, 0.0034852352186486493 + -0.0019099648955946975i, -0.018151448826815852 + -0.023475577741819662i, 0.0023035281192140093 + -0.0034349778028198983i, -0.022569722618478255 + -0.008259584579982063i }, { -0.002920121557135131 + -0.0024632598250679833i, -0.0003287208528758044 + 0.0008138328303609633i, 0.12253632041986036 + -1.1633054544639505e-20i, -0.0011928523634324012 + -0.0252287151154931i, 0.00040203050368005583 + -0.01816154879317583i, -0.003993669500830723 + 0.0012123400122867312i, -0.024637936191799756 + -0.029687324354838507i, -0.005872410937486806 + 0.005361643519130694i }, { 0.0004612257844712666 + -0.00034728195798340935i, -0.004139874138331568 + -0.0029792139708258044i, -0.0011928523634324012 + 0.025228715115493103i, 0.17573117597221782 + 3.1360071383110385e-20i, 0.0026621784887845643 + 0.0006707101649463714i, -0.0013288380219880565 + -0.024216635016881025i, 0.00635209598622639 + -0.0047836500736067045i, -0.03533363402522815 + -0.04257503736417792i }, { -0.012685521983434778 + 0.016406401514227002i, 0.0034852352186486493 + 0.0019099648955946973i, 0.0004020305036800562 + 0.01816154879317583i, 0.0026621784887845643 + -0.0006707101649463714i, 0.07828747497067826 + 9.930923639158512e-21i, -0.0023438192816481376 + -0.014818465445546632i, 0.0029201215571351326 + -0.002463259825067985i, -0.000461225784471267 + -0.0003472819579834095i }, { -0.002725661071349052 + -0.002892335069774126i, -0.01815144882681585 + 0.02347557774181966i, -0.003993669500830724 + -0.0012123400122867312i, -0.0013288380219880565 + 0.024216635016881028i, -0.002343819281648138 + 0.014818465445546632i, 0.11201991511003866 + -1.4693002425626292e-20i, 0.0003287208528758045 + 0.0008138328303609638i, 0.00413987413833157 + -0.0029792139708258066i }, { -0.017330708054568038 + 0.004868695733961703i, 0.0023035281192140093 + 0.0034349778028198987i, -0.024637936191799756 + 0.029687324354838507i, 0.006352095986226389 + 0.004783650073606704i, 0.0029201215571351326 + 0.002463259825067985i, 0.00032872085287580455 + -0.0008138328303609638i, 0.14271361828994888 + 2.8582812476463595e-20i, -0.0013892719830973775 + -0.029382971567953088i }, { -0.0001337917263248224 + -0.002717231559044999i, -0.022569722618478255 + 0.008259584579982063i, -0.005872410937486806 + -0.005361643519130694i, -0.03533363402522815 + 0.04257503736417792i, -0.0004612257844712669 + 0.00034728195798340946i, 0.00413987413833157 + 0.0029792139708258066i, -0.0013892719830973777 + 0.029382971567953088i, 0.20466774164109922 + 3.7444811969050457e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, true, false, false, true, false, false}), ElementsAreArray({ DoubleNear(0.06748330292537924, 1.0e-7), DoubleNear(0.09656045067077876, 1.0e-7), DoubleNear(0.12253632041986036, 1.0e-7), DoubleNear(0.17573117597221782, 1.0e-7), DoubleNear(0.07828747497067826, 1.0e-7), DoubleNear(0.11201991511003866, 1.0e-7), DoubleNear(0.14271361828994888, 1.0e-7), DoubleNear(0.20466774164109922, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, true, false, false, false, true, false}), Matrix({ { 0.07309760046829519 + 1.5962517870742052e-21i, 0.000812821668813269 + -0.018347480327424823i, 1.1926223897340549e-18 + -1.0842021724855044e-18i, -2.168404344971009e-19 + -1.6263032587282567e-19i, -0.010807141543529446 + -0.0030283715407461386i, -0.02795252508409001 + -0.004617026489238167i, -1.8973538018496328e-19 + 1.0842021724855044e-19i, -3.7947076036992655e-19 + 3.7947076036992655e-19i }, { 0.000812821668813269 + 0.01834748032742482i, 0.0917752411570262 + -6.458853697482492e-20i, 2.168404344971009e-19 + 2.168404344971009e-19i, 1.1926223897340549e-18 + -1.0842021724855044e-18i, -0.009767699859892644 + -0.009232229094667204i, 0.019921676366376533 + 0.016892925155631268i, -2.439454888092385e-19 + 2.0328790734103208e-20i, 4.87890977618477e-19 + 6.776263578034403e-20i }, { 6.505213034913027e-19 + 7.589415207398531e-19i, 1.6263032587282567e-19 + -2.710505431213761e-19i, 0.12908104240108464 + 1.318649973501409e-20i, -0.00032811725025750304 + -0.035047894521092665i, -1.4907779871675686e-19 + -2.168404344971009e-19i, -3.2526065174565133e-19 + -3.7947076036992655e-19i, -0.01936668628432172 + -0.009551457141530075i, -0.047549703969132134 + -0.002755185054771574i }, { -1.8973538018496328e-19 + 1.6263032587282567e-19i, 9.75781955236954e-19 + 1.0842021724855044e-18i, -0.00032811725025750304 + 0.035047894521092665i, 0.17529637938411174 + -4.1792059678322894e-20i, 2.710505431213761e-20 + -2.168404344971009e-19i, 9.486769009248164e-20 + 4.87890977618477e-19i, -0.013219016419916029 + -0.016220426202432893i, 0.03181326202836083 + 0.03184364181278447i }, { -0.010807141543529446 + 0.003028371540746138i, -0.009767699859892644 + 0.009232229094667204i, -8.131516293641283e-20 + 1.8973538018496328e-19i, 8.131516293641283e-20 + 2.168404344971009e-19i, 0.0726731774277623 + 1.482142221572515e-20i, -0.005176998186980356 + -0.009244407596310397i, 1.0842021724855044e-18 + -7.589415207398531e-19i, -8.131516293641283e-20 + 3.049318610115481e-20i }, { -0.02795252508409001 + 0.004617026489238167i, 0.019921676366376533 + -0.016892925155631268i, -2.168404344971009e-19 + 3.2526065174565133e-19i, 6.776263578034403e-20 + -3.7947076036992655e-19i, -0.005176998186980357 + 0.009244407596310397i, 0.11680512462379121 + 3.5850421338354496e-20i, -2.710505431213761e-20 + 2.710505431213761e-19i, 1.0842021724855044e-18 + -1.0842021724855044e-18i }, { -1.8973538018496328e-19 + -7.453889935837843e-20i, -2.439454888092385e-19 + 4.743384504624082e-20i, -0.01936668628432172 + 0.009551457141530075i, -0.013219016419916029 + 0.016220426202432893i, 1.0842021724855044e-18 + 8.673617379884035e-19i, 2.710505431213761e-20 + -2.981555974335137e-19i, 0.1361688963087246 + 3.7632581968099994e-21i, -0.002254007096272276 + -0.01956379216235353i }, { -3.2526065174565133e-19 + -2.981555974335137e-19i, 3.7947076036992655e-19 + 0.0i, -0.047549703969132134 + 0.002755185054771574i, 0.03181326202836083 + -0.03184364181278447i, -8.131516293641283e-20 + -2.710505431213761e-20i, 1.3010426069826053e-18 + 1.1926223897340549e-18i, -0.0022540070962722755 + 0.019563792162353533i, 0.20510253822920527 + 1.1059694303048374e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, true, false, false, false, true, false}), ElementsAreArray({ DoubleNear(0.07309760046829519, 1.0e-7), DoubleNear(0.0917752411570262, 1.0e-7), DoubleNear(0.12908104240108464, 1.0e-7), DoubleNear(0.17529637938411174, 1.0e-7), DoubleNear(0.0726731774277623, 1.0e-7), DoubleNear(0.11680512462379121, 1.0e-7), DoubleNear(0.1361688963087246, 1.0e-7), DoubleNear(0.20510253822920527, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, true, false, false, false, false, true}), Matrix({ { 0.07572780620957217 + 5.604769035506177e-21i, -0.00226718632089471 + -0.01433396440495614i, 1.4094628242311558e-18 + -9.75781955236954e-19i, -1.2197274440461925e-19 + -4.0657581468206416e-20i, -0.005553639360663255 + -0.005166920567308596i, -0.0008117404079452772 + 0.0012058984026599069i, -1.4907779871675686e-19 + -1.3552527156068805e-20i, 3.3881317890172014e-21 + 2.329340604949326e-20i }, { -0.002267186320894711 + 0.014333964404956137i, 0.10835733846624837 + -3.8300530312736564e-21i, 9.486769009248164e-20 + 2.710505431213761e-19i, 1.1926223897340549e-18 + -1.0842021724855044e-18i, 0.0011442770498977187 + -0.0008965174178487856i, -0.007946586730077511 + -0.0073932388743793865i, 8.470329472543003e-21 + -2.710505431213761e-20i, -1.8973538018496328e-19 + -1.3552527156068805e-20i }, { 8.673617379884035e-19 + 6.505213034913027e-19i, 1.0842021724855044e-19 + -3.2526065174565133e-19i, 0.13779713770918 + -2.0504980204577003e-20i, -0.0013414115980258743 + -0.028370728932315986i, -2.0328790734103208e-20 + -1.0842021724855044e-19i, -2.371692252312041e-20 + 5.082197683525802e-21i, -0.010105609102825226 + -0.009401921177743302i, -0.0018373645500202838 + 0.0021721448474165874i }, { -1.4907779871675686e-19 + 3.7269449679189215e-20i, 1.1926223897340549e-18 + 1.3010426069826053e-18i, -0.001341411598025874 + 0.02837072893231599i, 0.19761694306037852 + 6.928133938499139e-20i, 1.8211208365967457e-20 + -7.623296525288703e-21i, -5.421010862427522e-20 + -1.3552527156068805e-19i, 0.002034114373434686 + -0.0019890953832373366i, -0.014492605665570462 + -0.013483436252221127i }, { -0.005553639360663255 + 0.005166920567308596i, 0.0011442770498977187 + 0.0008965174178487856i, 0.0 + 1.0842021724855044e-19i, 1.6940658945086007e-20 + -1.6940658945086007e-21i, 0.07004297168648532 + 1.0812904967293178e-20i, -0.002096990197272377 + -0.01325792351877908i, 8.673617379884035e-19 + -8.673617379884035e-19i, -1.7618285302889447e-19 + -9.147955830346444e-20i }, { -0.0008117404079452772 + -0.0012058984026599069i, -0.007946586730077511 + 0.007393238874379386i, -2.541098841762901e-20 + -5.082197683525802e-21i, -6.776263578034403e-21 + 1.3552527156068805e-19i, -0.0020969901972723772 + 0.013257923518779078i, 0.10022302731456904 + -2.490806260519677e-20i, 9.486769009248164e-20 + 2.168404344971009e-19i, 1.0842021724855044e-18 + -1.0842021724855044e-18i }, { -1.3552527156068805e-19 + 1.6940658945086007e-20i, 2.625802136488331e-20 + 3.049318610115481e-20i, -0.010105609102825226 + 0.009401921177743302i, 0.002034114373434686 + 0.0019890953832373366i, 8.673617379884035e-19 + 9.75781955236954e-19i, 8.131516293641283e-20 + -2.439454888092385e-19i, 0.12745280100062922 + 3.7454738136401093e-20i, -0.0012407127485039046 + -0.02624095775113021i }, { 3.3881317890172014e-21 + -2.414043899674756e-20i, -1.8973538018496328e-19 + 3.3881317890172014e-20i, -0.001837364550020284 + -0.0021721448474165874i, -0.014492605665570462 + 0.013483436252221127i, -1.2197274440461925e-19 + 9.825582188149884e-20i, 1.0842021724855044e-18 + 9.75781955236954e-19i, -0.0012407127485039046 + 0.026240957751130205i, 0.1827819745529385 + -4.764560328305439e-22i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, true, false, false, false, false, true}), ElementsAreArray({ DoubleNear(0.07572780620957217, 1.0e-7), DoubleNear(0.10835733846624837, 1.0e-7), DoubleNear(0.13779713770918, 1.0e-7), DoubleNear(0.19761694306037852, 1.0e-7), DoubleNear(0.07004297168648532, 1.0e-7), DoubleNear(0.10022302731456904, 1.0e-7), DoubleNear(0.12745280100062922, 1.0e-7), DoubleNear(0.1827819745529385, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, false, true, true, false, false, false}), Matrix({ { 0.12938675281095363 + 5.714825416006358e-20i, -0.0021866520995652864 + -0.025877171534580384i, 0.001151172204720999 + 0.009394606183274118i, 0.001859453285279695 + -0.000389002852681459i, 2.236166980751353e-19 + -6.776263578034403e-20i, -1.3552527156068805e-20 + -4.2351647362715017e-20i, 5.082197683525802e-21 + 4.658681209898652e-21i, 1.7470054537119944e-21 + -3.705769144237564e-21i }, { -0.0021866520995652864 + 0.025877171534580384i, 0.18540699743941264 + -5.484538333471595e-20i, -0.0018983631900995844 + 7.146284353909708e-05i, 0.0016495922293132946 + 0.01346216429986127i, 1.6940658945086007e-20 + 4.404571325722362e-20i, 2.168404344971009e-19 + -9.486769009248164e-20i, -3.8116482626443515e-21 + 5.293955920339377e-22i, -3.3881317890172014e-21 + 1.2705494208814505e-20i }, { 0.0011511722047209995 + -0.009394606183274118i, -0.0018983631900995844 + -7.146284353909714e-05i, 0.11074940974401526 + -3.864587821847745e-21i, -0.0018716787003396022 + -0.022149728708987206i, -5.082197683525802e-21 + -1.0587911840678754e-20i, -3.5998900258307764e-21 + 2.2234614865425384e-21i, 1.4907779871675686e-19 + -6.776263578034403e-20i, -5.082197683525802e-21 + -2.0328790734103208e-20i }, { 0.001859453285279695 + 0.00038900285268145924i, 0.0016495922293132959 + -0.01346216429986127i, -0.0018716787003396026 + 0.022149728708987206i, 0.15870029259353013 + 1.0669968157444015e-19i, 4.235164736271502e-21 + 0.0i, -8.470329472543003e-22 + -1.1858461261560205e-20i, 8.470329472543003e-21 + 3.3881317890172014e-20i, 2.236166980751353e-19 + -1.4907779871675686e-19i }, { 7.453889935837843e-20 + 1.0842021724855044e-19i, 1.3552527156068805e-20 + -3.5575383784680614e-20i, -1.0164395367051604e-20 + 1.7787691892340307e-20i, 2.6469779601696886e-21 + -1.164670302474663e-21i, 0.09207358574797073 + 3.1676881557718195e-21i, -0.0015560549686602862 + -0.018414589750817428i, 0.0008191916900250574 + 0.006685344976915418i, 0.0013232153044036505 + -0.0002768203601562165i }, { -1.3552527156068805e-20 + 2.286988957586611e-20i, 2.439454888092385e-19 + 9.486769009248164e-20i, -3.1763735522036263e-21 + -6.352747104407253e-22i, -1.4399560103323106e-20 + 1.2705494208814505e-20i, -0.0015560549686602864 + 0.018414589750817424i, 0.13193844583111253 + 6.71176416977058e-20i, -0.0013509041858389388 + 5.0854048884004623e-05i, 0.0011738749777326946 + 0.00957988134092513i }, { 8.470329472543003e-21 + -1.1858461261560205e-20i, -2.8587361969832636e-21 + 6.352747104407253e-22i, 7.453889935837843e-20 + 1.0842021724855044e-19i, 9.317362419797304e-21 + -3.5575383784680614e-20i, 0.0008191916900250576 + -0.006685344976915418i, -0.0013509041858389388 + -5.085404888400474e-05i, 0.07881096830292711 + -2.3083922559364205e-20i, -0.001331915096131692 + -0.015762084612796393i }, { 1.9587636905255695e-21 + 5.293955920339377e-22i, 1.7787691892340307e-20 + -9.317362419797304e-21i, -2.202285662861181e-20 + 2.0328790734103208e-20i, 3.3203691532368573e-19 + 1.4907779871675686e-19i, 0.0013232153044036503 + 0.0002768203601562167i, 0.001173874977732695 + -0.00957988134092513i, -0.001331915096131692 + 0.015762084612796393i, 0.11293354753007918 + -7.890517222173959e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, false, true, true, false, false, false}), ElementsAreArray({ DoubleNear(0.12938675281095363, 1.0e-7), DoubleNear(0.18540699743941264, 1.0e-7), DoubleNear(0.11074940974401526, 1.0e-7), DoubleNear(0.15870029259353013, 1.0e-7), DoubleNear(0.09207358574797073, 1.0e-7), DoubleNear(0.13193844583111253, 1.0e-7), DoubleNear(0.07881096830292711, 1.0e-7), DoubleNear(0.11293354753007918, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, false, true, false, true, false, false}), Matrix({ { 0.10238367171946922 + 1.6221838992777426e-20i, -0.0017312959106836787 + -0.020475771457353954i, 0.0009109219803432185 + 0.007433947096635107i, 0.0014713159212534372 + -0.00030788300482133366i, -0.020110095062685983 + -0.024835566004314136i, -0.004632690910946704 + 0.004447291386798393i, 0.0016243562413677667 + -0.0016811337480014856i, -0.00036412982896186284 + -0.0002968055663512193i }, { -0.001731295910683679 + 0.02047577145735395i, 0.14671230277899217 + 5.812804959563264e-21i, -0.0015021230894870844 + 5.646865344100998e-05i, 0.0013053200685587433 + 0.010652592146459833i, 0.005300410930957931 + -0.0036065584467458636i, -0.028818071882308414 + -0.03558845331250304i, 0.0003090260877006209 + 0.00035276798030448313i, 0.002327633499221275 + -0.002409078733225222i }, { 0.0009109219803432188 + -0.007433947096635107i, -0.0015021230894870846 + -5.646865344101011e-05i, 0.08763595162577037 + -2.1368143173776087e-20i, -0.0014819136892676727 + -0.017526366136327735i, -0.001982200950621514 + 0.0012392026746642802i, 0.000281694418939053 + 0.00037594192489725435i, -0.017213363112548556 + -0.021258159864751373i, -0.003965381097889153 + 0.0038066872021064275i }, { 0.0014713159212534372 + 0.00030788300482133377i, 0.0013053200685587438 + -0.010652592146459833i, -0.0014819136892676725 + 0.017526366136327735i, 0.1255793238640044 + 1.1502153212702988e-20i, -0.00021470907912350223 + -0.0004169440995500401i, -0.0028404304065373803 + 0.0017758077472499693i, 0.004536920273917109 + -0.0030870565224555375i, -0.024667010969735587 + -0.030462161793494556i }, { -0.020110095062685976 + 0.024835566004314136i, 0.005300410930957931 + 0.0036065584467458636i, -0.001982200950621514 + -0.0012392026746642802i, -0.00021470907912350229 + 0.00041694409955004007i, 0.11907666683945516 + 4.409410332305797e-20i, -0.0020114111575418934 + -0.02381598982804386i, 0.001059441914402838 + 0.008646004063554431i, 0.0017113526684299082 + -0.00035794020801634195i }, { -0.004632690910946704 + -0.004447291386798394i, -0.028818071882308414 + 0.035588453312503036i, 0.000281694418939053 + -0.00037594192489725435i, -0.0028404304065373803 + -0.0017758077472499697i, -0.002011411157541894 + 0.02381598982804386i, 0.17063314049153297 + 6.459453403426593e-21i, -0.0017471442864514387 + 6.584823898209172e-05i, 0.001518147138487246 + 0.012389453494326567i }, { 0.0016243562413677665 + 0.0016811337480014854i, 0.0003090260877006209 + -0.00035276798030448313i, -0.017213363112548556 + 0.021258159864751373i, 0.004536920273917109 + 0.0030870565224555375i, 0.0010594419144028381 + -0.00864600406355443i, -0.0017471442864514387 + -6.584823898209178e-05i, 0.10192442642117198 + -5.580367207435863e-21i, -0.0017216801072036216 + -0.020385447185455863i }, { -0.00036412982896186284 + 0.00029680556635121926i, 0.0023276334992212745 + 0.002409078733225222i, -0.003965381097889153 + -0.0038066872021064275i, -0.02466701096973558 + 0.030462161793494553i, 0.0017113526684299082 + 0.0003579402080163421i, 0.0015181471384872471 + -0.012389453494326567i, -0.0017216801072036216 + 0.020385447185455867i, 0.14605451625960492 + 1.629235613999757e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, false, true, false, true, false, false}), ElementsAreArray({ DoubleNear(0.10238367171946922, 1.0e-7), DoubleNear(0.14671230277899217, 1.0e-7), DoubleNear(0.08763595162577037, 1.0e-7), DoubleNear(0.1255793238640044, 1.0e-7), DoubleNear(0.11907666683945516, 1.0e-7), DoubleNear(0.17063314049153297, 1.0e-7), DoubleNear(0.10192442642117198, 1.0e-7), DoubleNear(0.14605451625960492, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, false, true, false, false, true, false}), Matrix({ { 0.10893502174045314 + -4.025722605173075e-20i, 0.0002611615431961278 + -0.028769736691331954i, 0.0009692102663053388 + 0.007909632219561525i, 0.002091257275127458 + -0.00023700580392851i, -0.01625783289357253 + -0.006778084428434361i, -0.04068103755488749 + -0.003972190204782257i, 0.00034749978316356376 + -0.001240765969746702i, -7.352929744909634e-05 + -0.0029891391004753702i }, { 0.0002611615431961278 + 0.02876973669133195i, 0.14389973331012576 + -8.912664305105735e-21i, -0.0020866100928937613 + 0.000274931013352825i, 0.0012802962409561094 + 0.010448375084441847i, -0.012385375636834034 + -0.013714037836989481i, 0.02787508392967484 + 0.026259544069100537i, 0.0008855642636792758 + -0.0010213019713500458i, -0.0016586632603029206 + 0.0022576089649053617i }, { 0.0009692102663053389 + -0.007909632219561525i, -0.0020866100928937613 + -0.0002749310133528252i, 0.0932436211289267 + 5.503997757381905e-20i, 0.00022354287535963818 + -0.024625638157185527i, -0.000636796251766106 + 0.0011201548217620793i, -0.00065036057033083 + 0.0029184568264980417i, -0.013915994934278638 + -0.005801744253841853i, -0.03482119149833466 + -0.0034000213392274842i }, { 0.002091257275127458 + 0.00023700580392851023i, 0.0012802962409561094 + -0.010448375084441845i, 0.0002235428753596382 + 0.024625638157185527i, 0.12317188723101223 + -9.746793234804208e-20i, -0.0011059531345397084 + 0.0007772705101771848i, 0.002154680373754895 + -0.0017903392238498381i, -0.010601340642974641 + -0.011738617460110616i, 0.02385985446506253 + 0.022477022899315205i }, { -0.01625783289357253 + 0.006778084428434361i, -0.012385375636834034 + 0.013714037836989481i, -0.0006367962517661058 + -0.0011201548217620793i, -0.0011059531345397084 + -0.000777270510177185i, 0.11252531681847125 + 1.0057316836756615e-19i, -0.0040038686114217 + -0.015522024594065858i, 0.0010011536284407177 + 0.008170318940628012i, 0.0010914113145558872 + -0.0004288174089091656i }, { -0.04068103755488749 + 0.003972190204782256i, 0.02787508392967484 + -0.026259544069100534i, -0.0006503605703308298 + -0.0029184568264980417i, 0.002154680373754895 + 0.0017903392238498381i, -0.0040038686114217 + 0.015522024594065858i, 0.17344570996039937 + 2.1184922668095592e-20i, -0.0011626572830447622 + -0.00015261412092972332i, 0.00154317096608988 + 0.012593670556344553i }, { 0.0003474997831635637 + 0.001240765969746702i, 0.0008855642636792758 + 0.0010213019713500456i, -0.013915994934278638 + 0.005801744253841853i, -0.010601340642974643 + 0.011738617460110616i, 0.0010011536284407182 + -0.008170318940628012i, -0.0011626572830447622 + 0.0001526141209297233i, 0.09631675691801567 + -8.1988487955031e-20i, -0.0034271366718309324 + -0.01328617516459807i }, { -7.352929744909649e-05 + 0.0029891391004753702i, -0.0016586632603029204 + -0.0022576089649053626i, -0.03482119149833466 + 0.003400021339227484i, 0.023859854465062526 + -0.0224770228993152i, 0.0010914113145558872 + 0.0004288174089091656i, 0.0015431709660898812 + -0.012593670556344552i, -0.003427136671830933 + 0.01328617516459807i, 0.14846195289259706 + 1.2526244170074264e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, false, true, false, false, true, false}), ElementsAreArray({ DoubleNear(0.10893502174045314, 1.0e-7), DoubleNear(0.14389973331012576, 1.0e-7), DoubleNear(0.0932436211289267, 1.0e-7), DoubleNear(0.12317188723101223, 1.0e-7), DoubleNear(0.11252531681847125, 1.0e-7), DoubleNear(0.17344570996039937, 1.0e-7), DoubleNear(0.09631675691801567, 1.0e-7), DoubleNear(0.14846195289259706, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, false, true, false, false, false, true}), Matrix({ { 0.11504847434823251 + 2.169653387695964e-20i, -0.001944333423012128 + -0.023009535681375762i, 0.0010236025171661157 + 0.00835352217291798i, 0.001653393867189833 + -0.0003458946433527258i, -0.008437293611231507 + -0.007849776166792199i, -0.0014273530680249035 + 0.0018201092344111583i, 0.000494894387828884 + -0.000682461634968799i, -0.0001448551589624576 + -8.74445068955627e-05i }, { -0.001944333423012128 + 0.023009535681375762i, 0.16486071197765811 + 1.412514293510864e-20i, -0.0016879918850650003 + 6.354353087268704e-05i, 0.0014667890271308176 + 0.011970324863065594i, 0.0017125356758086311 + -0.0015547848613462743i, -0.01209036660235853 + -0.0112484732635874i, 0.0001281276064317863 + 0.00011051187870228364i, 0.0007091675191125256 + -0.0009779452676429285i }, { 0.0010236025171661157 + -0.008353522172917979i, -0.0016879918850650003 + -6.354353087268713e-05i, 0.09847646957051968 + -3.6596745046030465e-20i, -0.0016642644959084566 + -0.01969515765589636i, -0.0006450299724588048 + 0.0005427805016197669i, 0.00011945643548364402 + 0.00011983204448639344i, -0.0072219548522569725 + -0.006719065578259697i, -0.0012217518899406577 + 0.0015579340156653366i }, { 0.001653393867189833 + 0.00034589464335272604i, 0.0014667890271308182 + -0.011970324863065594i, -0.0016642644959084568 + 0.019695157655896363i, 0.1411135695489688 + 5.132614341860909e-20i, -9.765426311410637e-05 + -0.00013817815948943544i, -0.0009243069159232311 + 0.0007777867585951166i, 0.0014658557475237736 + -0.0013308279397398481i, -0.010348825793289444 + -0.009628201863013115i }, { -0.008437293611231507 + 0.007849776166792199i, 0.0017125356758086311 + 0.0015547848613462743i, -0.0006450299724588047 + -0.0005427805016197669i, -9.76542631141064e-05 + 0.00013817815948943544i, 0.10641186421069188 + 3.8619408438875756e-20i, -0.0017983736452134441 + -0.02128222560402205i, 0.0009467613775799408 + 0.0077264289872715575i, 0.0015292747224935125 + -0.00031992856948494973i }, { -0.0014273530680249035 + -0.0018201092344111583i, -0.01209036660235853 + 0.011248473263587399i, 0.00011945643548364402 + -0.00011983204448639344i, -0.000924306915923231 + -0.0007777867585951168i, -0.0017983736452134443 + 0.021282225604022046i, 0.15248473129286705 + -1.852884572118782e-21i, -0.0015612754908735228 + 5.877336155041466e-05i, 0.0013566781799151718 + 0.011071720777720806i }, { 0.000494894387828884 + 0.000682461634968799i, 0.0001281276064317863 + -0.00011051187870228364i, -0.0072219548522569725 + 0.006719065578259698i, 0.0014658557475237734 + 0.0013308279397398481i, 0.0009467613775799412 + -0.0077264289872715575i, -0.001561275490873523 + -5.8773361550414784e-05i, 0.09108390847642268 + 9.648234664818515e-21i, -0.0015393293005628375 + -0.01821665566588724i }, { -0.00014485515896245764 + 8.744450689556269e-05i, 0.0007091675191125254 + 0.0009779452676429285i, -0.0012217518899406577 + -0.0015579340156653366i, -0.010348825793289444 + 0.009628201863013115i, 0.0015292747224935125 + 0.00031992856948494984i, 0.0013566781799151727 + -0.011071720777720805i, -0.0015393293005628375 + 0.01821665566588724i, 0.1305202705746405 + -2.353163406590853e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, false, true, false, false, false, true}), ElementsAreArray({ DoubleNear(0.11504847434823251, 1.0e-7), DoubleNear(0.16486071197765811, 1.0e-7), DoubleNear(0.09847646957051968, 1.0e-7), DoubleNear(0.1411135695489688, 1.0e-7), DoubleNear(0.10641186421069188, 1.0e-7), DoubleNear(0.15248473129286705, 1.0e-7), DoubleNear(0.09108390847642268, 1.0e-7), DoubleNear(0.1305202705746405, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, false, false, true, true, false, false}), Matrix({ { 0.11065538427153429 + 9.952637130238029e-21i, -0.001882700982059097 + -0.022120558920803113i, -0.00036361848809356753 + 0.0005477696409814832i, 0.0001076301980870869 + 6.073381366465013e-05i, -0.023982827857108365 + -0.02669703248318957i, -0.00500316004807482 + 0.005318092303498145i, -0.0035507198643281446 + 0.000990624855954908i, 0.00025351646561717764 + 0.000692899546410107i }, { -0.0018827009820590972 + 0.022120558920803113i, 0.158563537327793 + 2.7422691667357973e-20i, -0.0001022905033027827 + -9.042512230547102e-05i, -0.0005216100478533487 + 0.0007840410136093816i, 0.005662253182252882 + -0.00439951184057138i, -0.03437874494612216 + -0.03825467851958258i, -0.0001385214633851873 + -0.0007315045122231897i, -0.005088467793753783 + 0.0014191229761653025i }, { -0.00036361848809356764 + -0.0005477696409814832i, -0.00010229050330278272 + 9.042512230547105e-05i, 0.0793642390737053 + -1.509894131123669e-20i, -0.0013305086178922543 + -0.01588157867287858i, 0.002000011235265328 + -0.002901998179680301i, -0.0006126018777136456 + -0.000346596195861061i, -0.01334063031812617 + -0.019396693385875942i, -0.003594911960761037 + 0.002935886285406677i }, { 0.00010763019808708688 + -6.073381366465011e-05i, -0.0005216100478533487 + -0.0007840410136093816i, -0.0013305086178922543 + 0.015881578672878576i, 0.11372808931520355 + -1.0107733495091722e-20i, 0.0005426273761469412 + 0.0004514519584716718i, 0.002865760799058046 + -0.004157926814436373i, 0.004175078022622157 + -0.0022941031286300216i, -0.01910633790592183 + -0.02779593658641501i }, { -0.02398282785710836 + 0.02669703248318957i, 0.005662253182252882 + 0.00439951184057138i, 0.002000011235265328 + 0.002901998179680301i, 0.0005426273761469412 + -0.0004514519584716718i, 0.12948077828343457 + 4.33310292079778e-20i, -0.002175629817845791 + -0.02590634132276448i, 0.00036361848809356796 + -0.0005477696409814834i, -0.00010763019808708692 + -6.07338136646502e-05i }, { -0.005003160048074821 + -0.005318092303498145i, -0.03437874494612217 + 0.03825467851958257i, -0.0006126018777136456 + 0.000346596195861061i, 0.0028657607990580465 + 0.004157926814436373i, -0.002175629817845791 + 0.02590634132276448i, 0.18554375270514972 + 2.4431606572366225e-20i, 0.00010229050330278272 + 9.04251223054711e-05i, 0.0005216100478533491 + -0.0007840410136093817i }, { -0.0035507198643281446 + -0.000990624855954908i, -0.00013852146338518736 + 0.0007315045122231895i, -0.01334063031812617 + 0.019396693385875935i, 0.004175078022622157 + 0.002294103128630021i, 0.0003636184880935678 + 0.0005477696409814834i, 0.00010229050330278275 + -9.042512230547112e-05i, 0.09152031497719257 + -4.817293092355695e-21i, -0.0015574614468997238 + -0.01829509569073524i }, { 0.00025351646561717764 + -0.000692899546410107i, -0.005088467793753783 + -0.0014191229761653028i, -0.003594911960761037 + -0.002935886285406677i, -0.01910633790592183 + 0.02779593658641501i, -0.00010763019808708693 + 6.073381366465016e-05i, 0.0005216100478533494 + 0.0007840410136093819i, -0.0015574614468997238 + 0.01829509569073524i, 0.13114390404598814 + -1.679797028942061e-21i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, false, false, true, true, false, false}), ElementsAreArray({ DoubleNear(0.11065538427153429, 1.0e-7), DoubleNear(0.158563537327793, 1.0e-7), DoubleNear(0.0793642390737053, 1.0e-7), DoubleNear(0.11372808931520355, 1.0e-7), DoubleNear(0.12948077828343457, 1.0e-7), DoubleNear(0.18554375270514972, 1.0e-7), DoubleNear(0.09152031497719257, 1.0e-7), DoubleNear(0.13114390404598814, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, false, false, true, false, true, false}), Matrix({ { 0.11812154834954469 + 9.079134403382032e-21i, 0.00028318538298163656 + -0.031195898153723554i, 2.0328790734103208e-19 + -9.486769009248164e-20i, -1.3552527156068805e-20 + -4.404571325722362e-20i, -0.017628861347936953 + -0.007349682542297485i, -0.04411168298013779 + -0.004307166325680704i, -2.0328790734103208e-20 + -5.082197683525802e-21i, -7.453889935837843e-20 + 2.710505431213761e-20i }, { 0.0002831853829816366 + 0.031195898153723554i, 0.1560348456732029 + -5.86305618177586e-20i, 2.0328790734103208e-20 + 3.3881317890172014e-20i, 2.439454888092385e-19 + -8.131516293641283e-20i, -0.01342983848297416 + -0.01487054720830774i, 0.030225799027164234 + 0.028474020152909146i, -2.710505431213761e-20 + -2.541098841762901e-21i, 6.098637220230962e-20 + 2.0328790734103208e-20i }, { 2.710505431213761e-20 + 8.131516293641283e-20i, 2.0328790734103208e-20 + -2.371692252312041e-20i, 0.08405709451983513 + 5.703617118706264e-21i, 0.0002015190355741294 + -0.022199476694793926i, -3.7269449679189215e-20 + -2.710505431213761e-20i, -4.404571325722362e-20 + -3.3881317890172014e-20i, -0.012544966479914217 + -0.005230146139978728i, -0.03139054607308436 + -0.003065045218329036i }, { -2.710505431213761e-20 + 4.0657581468206416e-20i, 2.846030702774449e-19 + 1.3552527156068805e-19i, 0.00020151903557412938 + 0.022199476694793926i, 0.11103677486793509 + -4.7750034835389214e-20i, -1.0164395367051604e-20 + -2.710505431213761e-20i, 2.879912020664621e-20 + 6.098637220230962e-20i, -0.009556877796834515 + -0.010582108088792357i, 0.02150913936757313 + 0.020262546815506592i }, { -0.017628861347936953 + 0.007349682542297485i, -0.01342983848297416 + 0.01487054720830774i, -2.964615315390051e-20 + 2.371692252312041e-20i, 1.6940658945086007e-20 + 3.7269449679189215e-20i, 0.1220146142054242 + 4.42045319348338e-20i, -0.0043415161828865255 + -0.01683100208984404i, 1.7618285302889447e-19 + -1.0842021724855044e-19i, 0.0 + -1.8634724839594607e-20i }, { -0.04411168298013779 + 0.004307166325680704i, 0.030225799027164234 + -0.028474020152909146i, -4.0657581468206416e-20 + 4.743384504624082e-20i, 2.879912020664621e-20 + -5.421010862427522e-20i, -0.0043415161828865255 + 0.01683100208984404i, 0.18807244435973985 + 1.104848600574828e-19i, 3.3881317890172014e-21 + 4.404571325722362e-20i, 1.6263032587282567e-19 + -1.0842021724855044e-19i }, { -2.710505431213761e-20 + 1.6940658945086007e-21i, -3.3881317890172014e-20 + 5.929230630780102e-21i, -0.012544966479914217 + 0.005230146139978728i, -0.009556877796834515 + 0.010582108088792357i, 1.2197274440461925e-19 + 1.3552527156068805e-19i, 5.082197683525802e-21 + -4.743384504624082e-20i, 0.08682745953106272 + -2.561985152229865e-20i, -0.0030894891003661077 + -0.011977197668819892i }, { -6.098637220230962e-20 + -4.743384504624082e-20i, 6.098637220230962e-20 + -3.7269449679189215e-20i, -0.03139054607308436 + 0.003065045218329036i, 0.021509139367573135 + -0.020262546815506592i, -1.0164395367051604e-20 + 2.541098841762901e-21i, 3.2526065174565133e-19 + 1.6263032587282567e-19i, -0.0030894891003661077 + 0.011977197668819892i, 0.13383521849325658 + 3.596250431135543e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, false, false, true, false, true, false}), ElementsAreArray({ DoubleNear(0.11812154834954469, 1.0e-7), DoubleNear(0.1560348456732029, 1.0e-7), DoubleNear(0.08405709451983513, 1.0e-7), DoubleNear(0.11103677486793509, 1.0e-7), DoubleNear(0.1220146142054242, 1.0e-7), DoubleNear(0.18807244435973985, 1.0e-7), DoubleNear(0.08682745953106272, 1.0e-7), DoubleNear(0.13383521849325658, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, false, false, true, false, false, true}), Matrix({ { 0.1249920321268723 + 1.2943722225229777e-20i, -0.002112380777331161 + -0.02499823347857475i, 2.303929616531697e-19 + -1.0842021724855044e-19i, -6.776263578034403e-21 + -2.879912020664621e-20i, -0.009007351391713075 + -0.009264744978965431i, -0.0017007108257375645 + 0.0019580331493901184i, -1.6940658945086007e-20 + -1.0164395367051604e-20i, -8.470329472543003e-22 + 3.5998900258307764e-21i }, { -0.002112380777331161 + 0.02499823347857475i, 0.17910950601221126 + 6.328924302765725e-20i, 6.776263578034403e-21 + 4.404571325722362e-20i, 2.439454888092385e-19 + -8.131516293641283e-20i, 0.0020051615272864217 + -0.001644882481024684i, -0.012907240812042812 + -0.013276077428897602i, 2.964615315390051e-21 + -4.235164736271502e-21i, -3.7269449679189215e-20 + -1.0164395367051604e-20i }, { 6.776263578034403e-20 + 1.3552527156068805e-19i, 1.6940658945086007e-20 + -3.7269449679189215e-20i, 0.08853291179187989 + -2.78439333943006e-20i, -0.0014962171415894244 + -0.017706459858697378i, -8.470329472543003e-22 + -2.371692252312041e-20i, -2.541098841762901e-21 + -8.470329472543003e-22i, -0.006651897071775404 + -0.0053040967660864646i, -0.0009483941322279968 + 0.001420010100686376i }, { -2.0328790734103208e-20 + 1.2705494208814505e-20i, 3.5236570605778894e-19 + 1.3552527156068805e-19i, -0.0014962171415894244 + 0.017706459858697378i, 0.12686477551441563 + 2.162043326060476e-21i, 3.8116482626443515e-21 + 4.235164736271502e-22i, 0.0 + -2.0328790734103208e-20i, 0.0011732298960459827 + -0.0012407303200614383i, -0.009531951583605161 + -0.0076005976977029125i }, { -0.009007351391713075 + 0.009264744978965431i, 0.0020051615272864217 + 0.001644882481024684i, 1.0164395367051604e-20 + 1.3552527156068805e-20i, 3.8116482626443515e-21 + -1.5881867761018131e-21i, 0.1151441304280966 + 4.0339944112986054e-20i, -0.0019459500225737277 + -0.023028666764992843i, 1.4907779871675686e-19 + -9.486769009248164e-20i, -6.776263578034403e-21 + -3.3881317890172014e-20i }, { -0.0017007108257375645 + -0.0019580331493901184i, -0.012907240812042812 + 0.0132760774288976i, -1.2705494208814505e-21 + 7.411538288475128e-22i, 8.470329472543003e-22 + 1.6940658945086007e-20i, -0.0019459500225737277 + 0.023028666764992843i, 0.16499778402073148 + -1.1434944787933055e-20i, 1.6940658945086007e-20 + 3.3881317890172014e-20i, 1.6263032587282567e-19 + -1.0842021724855044e-19i }, { -1.3552527156068805e-20 + -3.3881317890172014e-21i, 2.117582368135751e-22 + 2.541098841762901e-21i, -0.006651897071775404 + 0.0053040967660864646i, 0.0011732298960459829 + 0.0012407303200614385i, 8.131516293641283e-20 + 8.131516293641283e-20i, 8.470329472543003e-21 + -3.3881317890172014e-20i, 0.08235164225901796 + 7.927698990708217e-21i, -0.001391752923202554 + -0.016470214504916446i }, { 2.964615315390051e-21 + -1.9058241313221758e-21i, -2.710505431213761e-20 + 0.0i, -0.0009483941322279965 + -0.001420010100686376i, -0.009531951583605161 + 0.007600597697702913i, -1.6940658945086007e-20 + 3.049318610115481e-20i, 2.574980159653073e-19 + 1.6263032587282567e-19i, -0.001391752923202554 + 0.01647021450491644i, 0.11800721784677604 + -1.394957385009426e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, false, false, true, false, false, true}), ElementsAreArray({ DoubleNear(0.1249920321268723, 1.0e-7), DoubleNear(0.17910950601221126, 1.0e-7), DoubleNear(0.08853291179187989, 1.0e-7), DoubleNear(0.12686477551441563, 1.0e-7), DoubleNear(0.1151441304280966, 1.0e-7), DoubleNear(0.16499778402073148, 1.0e-7), DoubleNear(0.08235164225901796, 1.0e-7), DoubleNear(0.11800721784677604, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, false, false, false, true, true, false}), Matrix({ { 0.09347088114910862 + -1.2930900925735205e-21i, 0.0002247098121043618 + -0.024684723171170188i, -0.018351016264256136 + -0.02267410352694582i, -0.00602788695957118 + 0.0047973573972324175i, -0.013949812279677776 + -0.005814401708937777i, -0.03490669903170741 + -0.0034102123525793357i, 0.001329507009007944 + 0.004534630611810213i, 0.006021214094186414 + 0.00912560771826183i }, { 0.00022470981210436186 + 0.02468472317117018i, 0.12346742229808269 + -6.481332330628621e-20i, 0.005947372180655897 + -0.0049068753158146485i, -0.024269160548228218 + -0.029948775787618374i, -0.010628600490750116 + -0.011767256766427507i, 0.0239191948034522 + 0.022531095410935287i, -0.0007766247773190135 + 0.004888917327923435i, 0.0007766361583160164 + -0.010230683581248852i }, { -0.018351016264256136 + 0.02267410352694582i, 0.005947372180655897 + 0.0049068753158146485i, 0.10870776172027122 + 1.6075841614661816e-20i, 0.00025999460645140417 + -0.028710651677347297i, 0.004149227171270472 + -0.0022331617400532795i, 0.007677232525272135 + -0.0078101908660238644i, -0.01622401554817339 + -0.006765426973338437i, -0.04059553002151474 + -0.003961999191430405i }, { -0.00602788695957118 + -0.0047973573972324175i, -0.024269160548228218 + 0.029948775787618374i, 0.00025999460645140417 + 0.028710651677347297i, 0.14360419824305531 + -4.156727334686161e-20i, 0.004932384999947427 + -0.0002687781471697433i, -0.010153951355486858 + 0.0013748713565842853i, -0.012358115789058557 + -0.013685398530672592i, 0.027815743591285167 + 0.02620547155748045i }, { -0.013949812279677776 + 0.005814401708937777i, -0.010628600490750116 + 0.011767256766427505i, 0.004149227171270472 + 0.0022331617400532795i, 0.004932384999947427 + 0.00026877814716974325i, 0.09654874219613097 + -3.853214088425141e-21i, -0.0034379194120557136 + -0.013317414422511505i, -0.018972441910978396 + -0.023419622342119688i, -0.0025701850492646774 + 0.0034566211916724036i }, { -0.03490669903170741 + 0.0034102123525793357i, 0.0239191948034522 + -0.022531095410935283i, 0.007677232525272135 + 0.0078101908660238644i, -0.010153951355486858 + -0.0013748713565842855i, -0.0034379194120557136 + 0.013317414422511505i, 0.1488242043449139 + 8.212828147855246e-20i, 0.0038899590242191424 + -0.0017867396533867521i, -0.02921592230381578 + -0.036101839318379216i }, { 0.001329507009007944 + -0.004534630611810213i, -0.0007766247773190136 + -0.004888917327923435i, -0.01622401554817339 + 0.006765426973338437i, -0.012358115789058557 + 0.01368539853067259i, -0.018972441910978396 + 0.023419622342119688i, 0.0038899590242191424 + 0.0017867396533867521i, 0.11229333154035595 + 2.243789450096029e-20i, -0.003993085871196919 + -0.015490785336152425i }, { 0.006021214094186414 + -0.00912560771826183i, 0.0007766361583160163 + 0.010230683581248854i, -0.04059553002151474 + 0.003961999191430405i, 0.027815743591285167 + -0.02620547155748045i, -0.0025701850492646774 + -0.003456621191672404i, -0.02921592230381578 + 0.036101839318379216i, -0.00399308587119692 + 0.015490785336152425i, 0.1730834585080826 + 6.431908289028577e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, false, false, false, true, true, false}), ElementsAreArray({ DoubleNear(0.09347088114910862, 1.0e-7), DoubleNear(0.12346742229808269, 1.0e-7), DoubleNear(0.10870776172027122, 1.0e-7), DoubleNear(0.14360419824305531, 1.0e-7), DoubleNear(0.09654874219613097, 1.0e-7), DoubleNear(0.1488242043449139, 1.0e-7), DoubleNear(0.11229333154035595, 1.0e-7), DoubleNear(0.1730834585080826, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, false, false, false, true, false, true}), Matrix({ { 0.0987189760849184 + -1.9744387631334494e-20i, -0.0016692012975896948 + -0.01974296956083839i, -0.019365903380669687 + -0.023948180572145657i, -0.004466910862726016 + 0.004282559797296033i, -0.007242372028401863 + -0.006731377921903684i, -0.0012237338335203199 + 0.0015624357120097396i, -0.00022684759393025428 + 0.003104751822824303i, 0.0006257287393536504 + -5.9256676613798995e-06i }, { -0.001669201297589695 + 0.01974296956083839i, 0.1414609391958709 + 4.4075905349581803e-20i, 0.005111409177539404 + -0.0034720274475048985i, -0.027751514743093703 + -0.03431687548211759i, 0.0014684832614628121 + -0.0013345296593687786i, -0.010378086507277357 + -0.009645814313920092i, -0.0006180820597482533 + -9.668119291749385e-05i, -0.0003250668722113736 + 0.0044491950634785666i }, { -0.019365903380669687 + 0.023948180572145657i, 0.005111409177539404 + 0.0034720274475048985i, 0.11480596783383379 + 4.844176462263668e-21i, -0.00193939662133089 + -0.022961723776433737i, 0.003035685462431625 + -0.0004112013821269331i, -0.00013286451082548424 + -0.0005988335686927813i, -0.008416876435086618 + -0.007837463823148212i, -0.0014253711244452412 + 0.001815607538066755i }, { -0.004466910862726017 + -0.004282559797296033i, -0.027751514743093703 + 0.03431687548211759i, -0.00193939662133089 + 0.022961723776433737i, 0.164513342330756 + 2.1375381004135926e-20i, 2.9743300878013486e-05 + 0.0006150095365401677i, 0.004349997088624246 + -0.0005890558082249005i, 0.0017099081618695924 + -0.0015510831417173436i, -0.012061105888370616 + -0.011230860812680423i }, { -0.007242372028401863 + 0.006731377921903684i, 0.0014684832614628124 + 0.0013345296593687789i, 0.003035685462431625 + 0.0004112013821269329i, 2.9743300878013496e-05 + -0.0006150095365401678i, 0.09130064726032118 + 1.4598083450335832e-20i, -0.0015440083023616567 + -0.0182591680328433i, -0.017957554794564845 + -0.022145545296919852i, -0.004131161146109841 + 0.003971418791608789i }, { -0.0012237338335203199 + -0.0015624357120097398i, -0.010378086507277357 + 0.00964581431392009i, -0.00013286451082548427 + 0.0005988335686927815i, 0.004349997088624246 + 0.0005890558082249004i, -0.0015440083023616565 + 0.018259168032843297i, 0.13083068744712567 + -2.676094717731555e-20i, 0.004725922027335635 + -0.0032215875216965017i, -0.025733568108950295 + -0.03173373962387999i }, { -0.00022684759393025428 + -0.003104751822824303i, -0.0006180820597482533 + 9.668119291749385e-05i, -0.008416876435086618 + 0.007837463823148212i, 0.0017099081618695924 + 0.0015510831417173436i, -0.017957554794564845 + 0.022145545296919852i, 0.004725922027335635 + 0.003221587521696502i, 0.10619512542679338 + 3.366955965335844e-20i, -0.001793694643414625 + -0.021239713237065985i }, { 0.0006257287393536504 + 5.92566766137994e-06i, -0.00032506687221137376 + -0.004449195063478567i, -0.0014253711244452412 + -0.0018156075380667551i, -0.012061105888370616 + 0.011230860812680422i, -0.004131161146109841 + -0.003971418791608789i, -0.025733568108950295 + 0.03173373962387999i, -0.0017936946434146252 + 0.021239713237065985i, 0.15217431442038187 + 1.376428539288238e-21i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, false, false, false, true, false, true}), ElementsAreArray({ DoubleNear(0.0987189760849184, 1.0e-7), DoubleNear(0.1414609391958709, 1.0e-7), DoubleNear(0.11480596783383379, 1.0e-7), DoubleNear(0.164513342330756, 1.0e-7), DoubleNear(0.09130064726032118, 1.0e-7), DoubleNear(0.13083068744712567, 1.0e-7), DoubleNear(0.10619512542679338, 1.0e-7), DoubleNear(0.15217431442038187, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, false, false, false, false, true, true}), Matrix({ { 0.10503164837224062 + -3.028204824980065e-20i, 0.0002518035700096729 + -0.027738855876170476i, -0.01567528018529089 + -0.0065352112566780494i, -0.03922334951254846 + -0.003829858186932538i, -0.007702691068339529 + -0.007166326496914382i, -0.0019110931426858377 + 0.00201709993217198i, 0.0007036772651930341 + 0.0015487987824242006i, 0.002615205359652567 + 0.002957085299263845i }, { 0.00025180357000967297 + 0.027738855876170476i, 0.1387435000095632 + -3.6341559827057856e-20i, -0.011941581302893278 + -0.01322263471237171i, 0.026876260424530434 + 0.025318608790958794i, 0.00187416017743682 + -0.0020514611294633455i, -0.010175012340340265 + -0.009466491631830446i, -2.642447202967473e-05 + 0.0017844825222643975i, -0.00024352768403757135 + -0.0036905588460480875i }, { -0.01567528018529089 + 0.0065352112566780494i, -0.01194158130289328 + 0.01322263471237171i, 0.10849329554651158 + 1.5381837080729826e-20i, -0.0038604014889302577 + -0.014965837461101649i, 0.0015954743247932701 + 0.000590255064284664i, 0.0017779405734937525 + -0.0001549304428247085i, -0.007956557395148951 + -0.007402515248137515i, -0.0007380118152797234 + 0.0013609433179045147i }, { -0.03922334951254845 + 0.003829858186932538i, 0.026876260424530434 + -0.02531860879095879i, -0.003860401488930258 + 0.01496583746110165i, 0.16723078151706372 + 1.0179284618077559e-19i, 0.003137829056981742 + 0.0023953457682428492i, -0.0036985132975283623 + 2.3015582598968636e-05i, 0.0013042312458955846 + -0.0008341516716227764i, -0.012264180055307708 + -0.01141018349477007i }, { -0.007702691068339529 + 0.007166326496914382i, 0.0018741601774368202 + 0.002051461129463346i, 0.0015954743247932701 + -0.0005902550642846642i, 0.003137829056981742 + -0.0023953457682428497i, 0.09714699449713922 + 4.506479977188895e-20i, 0.00023290084854609303 + -0.025656518972347005i, -0.01449854764256028 + -0.006044617425598165i, -0.036278879540673686 + -0.0035423533570772027i }, { -0.0019110931426858377 + -0.0020170999321719803i, -0.010175012340340265 + 0.009466491631830444i, 0.0017779405734937525 + 0.0001549304428247085i, -0.0036985132975283623 + -2.301558259896873e-05i, 0.00023290084854609303 + 0.025656518972347005i, 0.12832812053157477 + -7.003903682608996e-20i, -0.011045134976915397 + -0.012230020584728388i, 0.02485867797020693 + 0.023417958177456948i }, { 0.0007036772651930342 + -0.0015487987824242006i, -2.6424472029674723e-05 + -0.0017844825222643975i, -0.007956557395148951 + 0.007402515248137515i, 0.0013042312458955846 + 0.0008341516716227765i, -0.01449854764256028 + 0.006044617425598165i, -0.011045134976915397 + 0.012230020584728387i, 0.10034877818997534 + 3.202843331805323e-21i, -0.0035706037943223747 + -0.013842362297562277i }, { 0.002615205359652567 + -0.002957085299263845i, -0.00024352768403757122 + 0.0036905588460480875i, -0.0007380118152797234 + -0.0013609433179045147i, -0.012264180055307708 + 0.01141018349477007i, -0.036278879540673686 + 0.0035423533570772027i, 0.02485867797020693 + -0.023417958177456944i, -0.0035706037943223747 + 0.013842362297562277i, 0.15467688133593277 + 4.4654518188062646e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, false, false, false, false, true, true}), ElementsAreArray({ DoubleNear(0.10503164837224062, 1.0e-7), DoubleNear(0.1387435000095632, 1.0e-7), DoubleNear(0.10849329554651158, 1.0e-7), DoubleNear(0.16723078151706372, 1.0e-7), DoubleNear(0.09714699449713922, 1.0e-7), DoubleNear(0.12832812053157477, 1.0e-7), DoubleNear(0.10034877818997534, 1.0e-7), DoubleNear(0.15467688133593277, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, true, true, true, false, false, false}), Matrix({ { 0.11154752542354969 + -9.873227791432938e-21i, 2.710505431213761e-19 + -3.3610267347050637e-18i, 0.000992454080369566 + 0.008099322761458852i, 1.9651164376299768e-19 + -3.7269449679189215e-20i, -1.9651164376299768e-19 + -5.421010862427522e-19i, -0.0007592791124123703 + -0.0026872214920208425i, 3.8963515573697816e-20 + -2.159934015498466e-20i, 0.00018836029273059036 + -7.903887153567749e-05i }, { -2.168404344971009e-19 + 3.577867169202165e-18i, 0.2032462248268166 + 1.2176098616780567e-20i, -1.8295911660692887e-19 + 3.3881317890172014e-20i, 0.0018083103536647278 + 0.014757447721676536i, 0.002274075681036479 + -0.0016205690095281089i, 5.963111948670274e-19 + 4.2012834183813297e-19i, 0.0001379002097598499 + 0.00015069928745477335i, -3.8116482626443515e-20 + 3.8963515573697816e-20i }, { 0.0009924540803695665 + -0.008099322761458852i, -1.6940658945086007e-19 + 1.6940658945086007e-20i, 0.0954798101867026 + 3.5734202462290796e-21i, 5.421010862427522e-20 + -2.4936649967166602e-18i, -4.743384504624082e-20 + 1.6517142471458857e-20i, -0.00020187111962507835 + 3.1221693620050886e-05i, -2.1006417091906648e-19 + -6.369687763352339e-19i, -0.0006499097604952874 + -0.00230014423909049i }, { 2.303929616531697e-19 + 1.3552527156068805e-20i, 0.0018083103536647286 + -0.014757447721676536i, 0.0 + 1.8431436932253575e-18i, 0.17396989215084274 + 9.926167350636332e-20i, -9.743466504885307e-05 + -0.00017953614994759367i, 4.2351647362715017e-20 + -3.8963515573697816e-20i, 0.0019465094680596094 + -0.0013871362976155262i, 5.692061405548898e-19 + 3.8285889215894375e-19i }, { -1.8295911660692887e-19 + 6.776263578034403e-19i, 0.0022740756810364785 + 0.0016205690095281089i, -5.082197683525802e-20 + -6.3527471044072525e-21i, -9.743466504885312e-05 + 0.00017953614994759362i, 0.07937891958742826 + 4.1005410915784964e-21i, 2.0599841277224584e-18 + 1.0299920638612292e-18i, 0.0007062454531442165 + 0.0057636015478899965i, -3.049318610115481e-20 + 1.3552527156068805e-19i }, { -0.0007592791124123703 + 0.0026872214920208425i, 4.87890977618477e-19 + -4.404571325722362e-19i, -0.00020187111962507835 + -3.122169362005091e-05i, 2.752857078576476e-20 + 3.5575383784680614e-20i, 2.0599841277224584e-18 + -8.131516293641283e-19i, 0.14463311199165496 + 6.618478876189913e-20i, 9.486769009248164e-20 + 1.0842021724855044e-19i, 0.0012868212146135353 + 0.010501624769950552i }, { 4.404571325722362e-20 + 2.0328790734103208e-20i, 0.0001379002097598499 + -0.00015069928745477338i, -1.2197274440461925e-19 + 5.827586677109586e-19i, 0.0019465094680596092 + 0.001387136297615526i, 0.0007062454531442169 + -0.005763601547889996i, 9.147955830346444e-20 + -1.3552527156068805e-19i, 0.06794488847919435 + -1.0121175180045708e-20i, 2.168404344971009e-18 + 6.2341624917916505e-19i }, { 0.00018836029273059036 + 7.903887153567751e-05i, -1.7787691892340307e-20 + -4.0657581468206416e-20i, -0.0006499097604952874 + 0.00230014423909049i, 5.285485590866834e-19 + -3.4897757426877174e-19i, -7.453889935837843e-20 + -1.4230153513872246e-19i, 0.0012868212146135358 + -0.010501624769950552i, 2.1141942363467336e-18 + -5.149960319306146e-19i, 0.12379962735381195 + -9.186791960105808e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, true, true, true, false, false, false}), ElementsAreArray({ DoubleNear(0.11154752542354969, 1.0e-7), DoubleNear(0.2032462248268166, 1.0e-7), DoubleNear(0.0954798101867026, 1.0e-7), DoubleNear(0.17396989215084274, 1.0e-7), DoubleNear(0.07937891958742826, 1.0e-7), DoubleNear(0.14463311199165496, 1.0e-7), DoubleNear(0.06794488847919435, 1.0e-7), DoubleNear(0.12379962735381195, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, true, true, false, true, false, false}), Matrix({ { 0.08838772291061538 + -1.2343395895669417e-20i, -0.0038039665004084783 + 0.0029324363486828405i, 0.0007863980480439721 + 0.006417719203408971i, -0.0002467648693757981 + -0.00025011082885950794i, -0.016615138166668986 + -0.021488641013960086i, -0.021498582744122433 + -0.007073593338630633i, 0.0014124354351164117 + -0.0013975913459490733i, 0.0003223286149090765 + -0.001623919279630505i }, { -0.0038039665004084783 + -0.002932436348682841i, 0.16070825158784602 + 3.4378039848010107e-20i, 0.00017907601548890572 + -0.0003022914291663956i, 0.0014298440008579897 + 0.01166882003968597i, -0.0004993692495073535 + -0.022833610460289776i, -0.03231302877832541 + -0.038935378302857086i, 0.0016534762127415727 + -0.0002394124163524764i, 0.00253955430547263 + -0.0026926211352776342i }, { 0.0007863980480439722 + -0.00641771920340897i, 0.00017907601548890575 + 0.0003022914291663956i, 0.07565603068554261 + 4.785033048466127e-21i, -0.00325602919505822 + 0.0025100374472109476i, -0.0017080898946268772 + 0.0010152164008317504i, -0.0007048804659797693 + 0.0014980497626664495i, -0.014221832643581647 + -0.01839333824208658i, -0.01840184792892386 + -0.006054686975313132i }, { -0.0002467648693757981 + 0.00025011082885950794i, 0.00142984400085799 + -0.01166882003968597i, -0.003256029195058221 + -0.002510037447210947i, 0.13755924480423215 + -1.4651023009539226e-20i, -0.001662362130154852 + -0.00016689529481974454i, -0.003114541462532017 + 0.001999794021082499i, -0.00042743826880064725 + -0.01954457334976708i, -0.027658541438702493 + -0.03332698341615935i }, { -0.016615138166668982 + 0.021488641013960086i, -0.0004993692495073534 + 0.022833610460289776i, -0.0017080898946268772 + -0.0010152164008317504i, -0.0016623621301548519 + 0.00016689529481974438i, 0.10253872210036258 + 6.570709195814975e-21i, 0.003803966500408481 + -0.0029324363486828427i, 0.0009123014854698105 + 0.007445205105939878i, 0.00024676486937579825 + 0.00025011082885950805i }, { -0.021498582744122433 + 0.007073593338630633i, -0.03231302877832541 + 0.038935378302857086i, -0.000704880465979769 + -0.0014980497626664495i, -0.0031145414625320176 + -0.0019997940210824995i, 0.0038039665004084805 + 0.002932436348682843i, 0.18717108523062556 + 4.398284753066959e-20i, -0.0001790760154889058 + 0.0003022914291663958i, 0.0016652875674202732 + 0.013590252451941117i }, { 0.0014124354351164115 + 0.0013975913459490735i, 0.0016534762127415731 + 0.00023941241635247647i, -0.014221832643581647 + 0.01839333824208658i, -0.0004274382688006469 + 0.01954457334976708i, 0.0009123014854698111 + -0.007445205105939878i, -0.0001790760154889058 + -0.0003022914291663957i, 0.08776866798035433 + -1.1332787982282756e-20i, 0.0032560291950582223 + -0.0025100374472109494i }, { 0.0003223286149090763 + 0.0016239192796305053i, 0.0025395543054726293 + 0.002692621135277634i, -0.018401847928923864 + 0.006054686975313132i, -0.027658541438702493 + 0.03332698341615935i, 0.00024676486937579825 + -0.00025011082885950805i, 0.0016652875674202745 + -0.013590252451941117i, 0.0032560291950582227 + 0.002510037447210948i, 0.16021027470042254 + 2.2044776914844464e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, true, true, false, true, false, false}), ElementsAreArray({ DoubleNear(0.08838772291061538, 1.0e-7), DoubleNear(0.16070825158784602, 1.0e-7), DoubleNear(0.07565603068554261, 1.0e-7), DoubleNear(0.13755924480423215, 1.0e-7), DoubleNear(0.10253872210036258, 1.0e-7), DoubleNear(0.18717108523062556, 1.0e-7), DoubleNear(0.08776866798035433, 1.0e-7), DoubleNear(0.16021027470042254, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, true, true, false, false, true, false}), Matrix({ { 0.0888344403343742 + -1.2316512525761444e-20i, 1.1926223897340549e-18 + -1.3010426069826053e-18i, 0.0007903725560242992 + 0.006450154782633628i, 1.0842021724855044e-19 + 4.0657581468206416e-20i, 0.004910964061235862 + 0.007470301650184495i, 1.8973538018496328e-19 + 1.6263032587282567e-19i, -0.0004987154816563637 + 0.00042304313051330666i, 4.235164736271502e-21 + 1.1858461261560205e-20i }, { 7.589415207398531e-19 + 1.1926223897340549e-18i, 0.1640003147162047 + -3.685337783107504e-20i, -4.0657581468206416e-20 + 6.776263578034403e-20i, 0.001459133951237149 + 0.011907852521369743i, -9.486769009248164e-20 + 1.3552527156068805e-19i, 0.006706286974866447 + 0.01201115799048168i, -1.3552527156068805e-20 + 2.541098841762901e-21i, -0.000812447995482993 + 0.0005937998646453533i }, { 0.0007903725560242992 + -0.006450154782633628i, -5.421010862427522e-20 + -4.0657581468206416e-20i, 0.0760384012909472 + -5.067577266198927e-20i, 1.1926223897340549e-18 + -9.75781955236954e-19i, 0.0005861025626806259 + -0.00029011447385030736i, -4.235164736271502e-21 + -3.3881317890172014e-21i, 0.004203570761611226 + 0.0063942519647006354i, 1.7618285302889447e-19 + 1.3552527156068805e-20i }, { 9.486769009248164e-20 + -3.3881317890172014e-20i, 0.0014591339512371492 + -0.011907852521369743i, 1.1926223897340549e-18 + 5.421010862427522e-19i, 0.1403771070689917 + 8.247817887766239e-21i, 5.082197683525802e-21 + 8.470329472543003e-21i, 0.0009317815593081633 + -0.0003800699282374514i, 5.421010862427522e-20 + 9.486769009248164e-20i, 0.005740288769172664 + 0.010281026680772713i }, { 0.004910964061235862 + -0.007470301650184494i, -4.0657581468206416e-20 + -9.486769009248164e-20i, 0.0005861025626806259 + 0.00029011447385030747i, 1.8634724839594607e-20 + -1.1011428314305904e-20i, 0.10209200467660376 + 6.543825825907002e-21i, 1.1926223897340549e-18 + -8.673617379884035e-19i, 0.0009083269774894836 + 0.00741276952671522i, 4.743384504624082e-20 + 6.776263578034403e-20i }, { 1.0842021724855044e-19 + -1.0164395367051604e-19i, 0.006706286974866448 + -0.01201115799048168i, -1.6940658945086007e-21 + 1.1858461261560205e-20i, 0.0009317815593081634 + 0.00038006992823745134i, 1.1926223897340549e-18 + 1.3010426069826053e-18i, 0.18387902210226686 + 1.1521426520975474e-19i, -4.743384504624082e-20 + 8.131516293641283e-20i, 0.001635997617041114 + 0.013351219970257344i }, { -0.0004987154816563637 + -0.00042304313051330677i, -6.776263578034403e-21 + 5.082197683525802e-21i, 0.004203570761611225 + -0.0063942519647006354i, 1.3552527156068805e-20 + -8.131516293641283e-20i, 0.0009083269774894842 + -0.00741276952671522i, -2.710505431213761e-20 + -9.486769009248164e-20i, 0.08738629737494975 + 4.4128017728172644e-20i, 1.0842021724855044e-18 + -9.75781955236954e-19i }, { 1.6940658945086007e-21 + -1.8634724839594607e-20i, -0.000812447995482993 + -0.0005937998646453533i, 1.3552527156068805e-19 + 2.0328790734103208e-20i, 0.005740288769172664 + -0.010281026680772713i, 5.421010862427522e-20 + -9.486769009248164e-20i, 0.0016359976170411154 + -0.013351219970257344i, 8.673617379884035e-19 + 5.421010862427522e-19i, 0.157392412435663 + -8.54063982461001e-22i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, true, true, false, false, true, false}), ElementsAreArray({ DoubleNear(0.0888344403343742, 1.0e-7), DoubleNear(0.1640003147162047, 1.0e-7), DoubleNear(0.0760384012909472, 1.0e-7), DoubleNear(0.1403771070689917, 1.0e-7), DoubleNear(0.10209200467660376, 1.0e-7), DoubleNear(0.18387902210226686, 1.0e-7), DoubleNear(0.08738629737494975, 1.0e-7), DoubleNear(0.157392412435663, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, true, true, false, false, false, true}), Matrix({ { 0.0991861403002427 + -3.178648298888147e-21i, 1.3010426069826053e-18 + -1.3010426069826053e-18i, 0.000882473091924836 + 0.007201778441114635i, 5.421010862427522e-20 + 6.776263578034403e-20i, -0.007273999873695903 + -0.006767486527881228i, -1.8973538018496328e-19 + -3.3881317890172014e-20i, 0.0004266607137824469 + -0.0005883670849094423i, -3.3881317890172014e-21 + -1.1858461261560205e-20i }, { 8.673617379884035e-19 + 1.1926223897340549e-18i, 0.18072304602564793 + 3.9000325110956425e-20i, -4.0657581468206416e-20 + 8.131516293641283e-20i, 0.001607918452372097 + 0.013122068594868938i, -2.0328790734103208e-20 + -1.3552527156068805e-19i, -0.013253660339894132 + -0.01233076290249837i, 1.0164395367051604e-20 + 1.6940658945086007e-21i, 0.0007774011931589628 + -0.0010720398177022851i }, { 0.0008824730919248364 + -0.007201778441114635i, -5.421010862427522e-20 + -6.776263578034403e-20i, 0.08489900437557785 + 4.953364303120668e-21i, 1.0842021724855044e-18 + -8.673617379884035e-19i, -0.0005560963212124819 + 0.00046794451895938065i, -2.964615315390051e-21 + 1.3552527156068805e-20i, -0.0062262262170448635 + -0.005792672913806755i, -1.4907779871675686e-19 + 0.0i }, { 5.421010862427522e-20 + -6.776263578034403e-20i, 0.001607918452372098 + -0.013122068594868938i, 1.0842021724855044e-18 + 5.421010862427522e-19i, 0.15469103474391063 + 9.776034069457958e-21i, -1.5246593050577406e-20 + -8.470329472543003e-22i, -0.0010132405671695538 + 0.0008526227412555029i, -4.0657581468206416e-20 + -1.3552527156068805e-19i, -0.011344554428501553 + -0.010554594527466057i }, { -0.007273999873695903 + 0.006767486527881228i, 6.776263578034403e-21 + 1.3552527156068805e-19i, -0.0005560963212124818 + -0.0004679445189593807i, -1.0164395367051604e-20 + 2.117582368135751e-21i, 0.09174030471073526 + -2.5940384009662948e-21i, 1.0842021724855044e-18 + -8.673617379884035e-19i, 0.0008162264415889468 + 0.006661145868234213i, 1.0164395367051604e-19 + 4.0657581468206416e-20i }, { -1.6263032587282567e-19 + 6.098637220230962e-20i, -0.013253660339894134 + 0.012330762902498371i, -3.8116482626443515e-21 + -1.6940658945086007e-20i, -0.0010132405671695538 + -0.0008526227412555029i, 1.0842021724855044e-18 + 1.3010426069826053e-18i, 0.16715629079282365 + 3.936056226772327e-20i, -4.743384504624082e-20 + 6.776263578034403e-20i, 0.0014872131159061658 + 0.01213700389675815i }, { 0.0004266607137824468 + 0.0005883670849094422i, 1.1858461261560205e-20 + -4.235164736271502e-21i, -0.0062262262170448635 + 0.005792672913806755i, -6.776263578034403e-21 + 1.0842021724855044e-19i, 0.0008162264415889471 + -0.006661145868234213i, -2.710505431213761e-20 + -6.776263578034403e-20i, 0.07852569429031911 + -1.1501119236937297e-20i, 1.1926223897340549e-18 + -1.0842021724855044e-18i }, { -4.235164736271502e-22 + 6.776263578034403e-21i, 0.0007774011931589626 + 0.0010720398177022851i, -1.3552527156068805e-19 + -1.0164395367051604e-20i, -0.011344554428501553 + 0.010554594527466057i, 9.486769009248164e-20 + -6.098637220230962e-20i, 0.0014872131159061666 + -0.01213700389675815i, 9.75781955236954e-19 + 5.421010862427522e-19i, 0.14307848476074408 + -2.3822801641527197e-21i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, true, true, false, false, false, true}), ElementsAreArray({ DoubleNear(0.0991861403002427, 1.0e-7), DoubleNear(0.18072304602564793, 1.0e-7), DoubleNear(0.08489900437557785, 1.0e-7), DoubleNear(0.15469103474391063, 1.0e-7), DoubleNear(0.09174030471073526, 1.0e-7), DoubleNear(0.16715629079282365, 1.0e-7), DoubleNear(0.07852569429031911, 1.0e-7), DoubleNear(0.14307848476074408, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, true, false, true, true, false, false}), Matrix({ { 0.09691610620122693 + -8.232101456127731e-21i, -0.002746105435049045 + 0.0051376077846495595i, 0.00010465946399286854 + 0.0011446113021996505i, -0.0006305155526581466 + -0.002356364320894139i, -0.011560223671492027 + -0.023991594107800523i, -0.022346482751946017 + -0.006791991948175908i, -0.002759155293176795 + 0.0011621502832856435i, -0.0003379245306458115 + 0.0002931598832254383i }, { -0.002746105435049046 + -0.0051376077846495595i, 0.1723028153981004 + 4.5607430253723734e-20i, 0.001897670847316147 + -0.0013940212534760195i, -0.0009898879999397847 + 0.00018719935239121433i, -4.001869067198343e-05 + -0.025963756974307986i, -0.0468013491317385 + -0.04096011689497163i, -0.0010445645604887908 + -0.00018694218955837702i, -0.005880032364905133 + 0.0012475975488345668i }, { 0.00010465946399286856 + -0.0011446113021996503i, 0.001897670847316147 + 0.0013940212534760195i, 0.06712764739493106 + 6.73738608924441e-22i, -0.0043138902604176535 + 0.00030486601124422874i, 0.0018670532326060122 + -0.0029090079137128848i, -0.00036543794118773536 + -0.0006908348876284395i, -0.0192767471387586 + -0.015890385148246138i, -0.01755394792110028 + -0.006336288365767857i }, { -0.0006305155526581466 + 0.002356364320894139i, -0.0009898879999397851 + -0.00018719935239121447i, -0.0043138902604176535 + -0.0003048660112442285i, 0.12596468099397778 + -2.5880413415252853e-20i, 0.0008458037881386284 + -4.053388358181683e-06i, 0.002998718801717362 + -0.004150917080403788i, -0.0008867888276360173 + -0.01641442683574887i, -0.0131702210852894 + -0.03130224482404481i }, { -0.011560223671492027 + 0.023991594107800523i, -4.001869067198318e-05 + 0.025963756974307986i, 0.0018670532326060122 + 0.0029090079137128848i, 0.0008458037881386285 + 4.053388358181622e-06i, 0.11011122940902535 + 1.9322939109238726e-21i, 0.002746105435049045 + -0.005137607784649565i, -0.00010465946399286895 + -0.0011446113021996516i, -0.0007786733202495111 + -0.0026310014102171935i }, { -0.022346482751946017 + 0.006791991948175908i, -0.0468013491317385 + 0.040960116894971615i, -0.00036543794118773536 + 0.0006908348876284395i, 0.002998718801717362 + 0.004150917080403788i, 0.002746105435049046 + 0.005137607784649565i, 0.20491330157955895 + 6.583034186942015e-20i, 0.002322914301779941 + -0.0016136840536676153i, 0.000989887999939786 + -0.00018719935239121352i }, { -0.0027591552931767946 + -0.0011621502832856435i, -0.001044564560488791 + 0.00018694218955837697i, -0.019276747138758602 + 0.015890385148246138i, -0.0008867888276360171 + 0.01641442683574887i, -0.00010465946399286887 + 0.0011446113021996518i, 0.002322914301779941 + 0.0016136840536676153i, 0.08019616067169157 + -6.694372697391653e-21i, 0.004313890260417657 + -0.0003048660112442271i }, { -0.00033792453064581155 + -0.0002931598832254383i, -0.005880032364905133 + -0.0012475975488345672i, -0.01755394792110028 + 0.006336288365767856i, -0.013170221085289398 + 0.03130224482404481i, -0.0007786733202495111 + 0.0026310014102171935i, 0.000989887999939786 + 0.00018719935239121366i, 0.004313890260417657 + 0.0003048660112442272i, 0.14246805835148915 + 1.972825760938971e-22i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, true, false, true, true, false, false}), ElementsAreArray({ DoubleNear(0.09691610620122693, 1.0e-7), DoubleNear(0.1723028153981004, 1.0e-7), DoubleNear(0.06712764739493106, 1.0e-7), DoubleNear(0.12596468099397778, 1.0e-7), DoubleNear(0.11011122940902535, 1.0e-7), DoubleNear(0.20491330157955895, 1.0e-7), DoubleNear(0.08019616067169157, 1.0e-7), DoubleNear(0.14246805835148915, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, true, false, true, false, true, false}), Matrix({ { 0.09632587822915761 + -4.298692207315574e-20i, 2.168404344971009e-19 + -2.8189256484623115e-18i, -2.0328790734103208e-19 + -5.421010862427522e-19i, -0.0007628595271706701 + -0.002394252373360533i, 0.005325107293632925 + 0.00810027467255069i, 2.710505431213761e-19 + -9.486769009248164e-20i, 3.7269449679189215e-20 + -6.098637220230962e-20i, 0.00017658031313917588 + -0.00024340561358700887i }, { -4.336808689942018e-19 + 2.8189256484623115e-18i, 0.17783051579359 + -6.564505341220828e-21i, 0.002093501613174354 + -0.001389838149272779i, 5.963111948670274e-19 + 3.7947076036992655e-19i, -2.710505431213761e-19 + 6.776263578034403e-20i, 0.007271830385594357 + 0.013024062938060972i, 0.00020118369006887594 + 0.0001799816458573631i, 0.0 + 7.115076756936123e-20i }, { -1.7618285302889447e-19 + 5.963111948670274e-19i, 0.0020935016131743535 + 0.001389838149272779i, 0.06854696339616378 + -2.0005363114594974e-20i, 2.168404344971009e-18 + 6.776263578034403e-19i, -4.0657581468206416e-20 + 1.0164395367051604e-20i, 1.462819177654294e-05 + 0.00030035464990465246i, 0.003789427529214162 + 0.005764278942334441i, 6.776263578034403e-20 + 2.574980159653073e-19i }, { -0.00076285952717067 + 0.002394252373360533i, 4.87890977618477e-19 + -3.9302328752599536e-19i, 2.168404344971009e-18 + -7.047314121155779e-19i, 0.12654690599160645 + -2.2041054602087975e-20i, -0.0002695541568982895 + -1.4450830222070737e-05i, 3.8963515573697816e-20 + 3.049318610115481e-20i, 2.168404344971009e-19 + 1.7618285302889447e-19i, 0.0051747453584447545 + 0.009268121733193423i }, { 0.005325107293632925 + -0.00810027467255069i, -2.0328790734103208e-19 + -4.0657581468206416e-20i, -4.404571325722362e-20 + -2.202285662861181e-20i, -0.0002695541568982895 + 1.4450830222070745e-05i, 0.11070145738109466 + 3.6687114527951883e-20i, 1.0842021724855044e-19 + -3.0357660829594124e-18i, -2.0328790734103208e-19 + -5.963111948670274e-19i, -0.0006463293457369875 + -0.0025931133577507997i }, { 2.168404344971009e-19 + 1.4230153513872246e-19i, 0.007271830385594356 + -0.013024062938060972i, 1.4628191776542959e-05 + -0.0003003546499046524i, 4.404571325722362e-20 + -2.710505431213761e-20i, 1.0842021724855044e-19 + 2.6020852139652106e-18i, 0.1993856011840694 + 1.1800227746436472e-19i, 0.0021270835359217346 + -0.0016178671578708558i, 5.421010862427522e-19 + 4.2690460541616737e-19i }, { 4.0657581468206416e-20 + 4.404571325722362e-20i, 0.00020118369006887594 + -0.00017998164585736307i, 0.003789427529214162 + -0.00576427894233444i, 1.6263032587282567e-19 + -1.4907779871675686e-19i, -1.2874900798265365e-19 + 7.047314121155779e-19i, 0.002127083535921734 + 0.0016178671578708558i, 0.07877684467045884 + 1.3984729026127762e-20i, 2.3852447794681098e-18 + 9.75781955236954e-19i }, { 0.0001765803131391759 + 0.00024340561358700887i, -5.082197683525802e-21 + -8.131516293641283e-20i, 4.0657581468206416e-20 + -2.168404344971009e-19i, 0.0051747453584447545 + -0.009268121733193422i, -0.0006463293457369876 + 0.0025931133577507997i, 5.421010862427522e-19 + -3.9979955110402976e-19i, 2.168404344971009e-18 + -6.2341624917916505e-19i, 0.14188583335386049 + -3.642076237070981e-21i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, true, false, true, false, true, false}), ElementsAreArray({ DoubleNear(0.09632587822915761, 1.0e-7), DoubleNear(0.17783051579359, 1.0e-7), DoubleNear(0.06854696339616378, 1.0e-7), DoubleNear(0.12654690599160645, 1.0e-7), DoubleNear(0.11070145738109466, 1.0e-7), DoubleNear(0.1993856011840694, 1.0e-7), DoubleNear(0.07877684467045884, 1.0e-7), DoubleNear(0.14188583335386049, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, true, false, true, false, false, true}), Matrix({ { 0.10775872783348092 + 1.5193653491374012e-20i, 1.0842021724855044e-19 + -3.2526065174565133e-18i, -2.168404344971009e-19 + -5.963111948670274e-19i, -0.0007806727179459351 + -0.002793380432795491i, -0.007765460810613216 + -0.007987366199643586i, -1.8973538018496328e-19 + 1.6263032587282567e-19i, -4.743384504624082e-20 + 1.3552527156068805e-19i, 2.4268092390372114e-06 + 0.0004839332328673255i }, { -2.168404344971009e-19 + 2.8189256484623115e-18i, 0.19634281030560263 + 6.103931176151302e-20i, 0.0023668124535110692 + -0.0016764912599756474i, 6.505213034913027e-19 + 4.87890977618477e-19i, 1.5585406229479126e-19 + -2.439454888092385e-19i, -0.014149131393142672 + -0.014553456208219448i, -0.00045479951291155376 + 0.00016539246153291648i, 0.0 + -1.4738373282224826e-19i }, { -1.0164395367051604e-19 + 7.047314121155779e-19i, 0.0023668124535110692 + 0.0016764912599756474i, 0.07632641684233962 + -1.3418937487141491e-20i, 2.6020852139652106e-18 + 8.673617379884035e-19i, -1.2705494208814505e-20 + -3.7269449679189215e-20i, -0.00014231038458558298 + -0.00019764964335373388i, -0.005734765280127551 + -0.004572793242044396i, -1.2197274440461925e-19 + -1.8973538018496328e-19i }, { -0.0007806727179459351 + 0.0027933804327954915i, 5.421010862427522e-19 + -4.743384504624082e-19i, 2.168404344971009e-18 + -7.047314121155779e-19i, 0.13907127046395593 + -1.2262952581098635e-20i, 0.00013811970619771914 + -0.00020060053299682552i, 1.1858461261560205e-20 + -3.3881317890172014e-21i, -2.303929616531697e-19 + -2.710505431213761e-20i, -0.010449083375253014 + -0.008331901221744981i }, { -0.007765460810613216 + 0.007987366199643586i, 1.6940658945086007e-19 + 1.8973538018496328e-19i, -5.929230630780102e-21 + 3.3881317890172014e-20i, 0.00013811970619771914 + 0.00020060053299682552i, 0.09926860777677135 + -2.149346103657787e-20i, 2.168404344971009e-19 + -2.6020852139652106e-18i, -1.8973538018496328e-19 + -5.421010862427522e-19i, -0.0006285161549617226 + -0.002193985298315841i }, { -1.8973538018496328e-19 + -1.2197274440461925e-19i, -0.014149131393142672 + 0.014553456208219448i, -0.00014231038458558298 + 0.0001976496433537339i, 1.6940658945086007e-20 + -6.776263578034403e-21i, -1.0842021724855044e-19 + 2.6020852139652106e-18i, 0.18087330667205673 + 5.039846036163087e-20i, 0.001853772695585019 + -0.0013312140471679874i, 4.87890977618477e-19 + 3.1848438816761693e-19i }, { -5.082197683525802e-20 + -1.4907779871675686e-19i, -0.00045479951291155376 + -0.00016539246153291648i, -0.005734765280127551 + 0.004572793242044396i, -1.7618285302889447e-19 + 5.421010862427522e-20i, -2.0328790734103208e-19 + 5.963111948670274e-19i, 0.0018537726955850187 + 0.0013312140471679874i, 0.070997391224283 + 7.39830339867428e-21i, 1.951563910473908e-18 + 7.860465750519907e-19i }, { 2.426809239037208e-06 + -0.0004839332328673255i, 1.0164395367051604e-20 + 1.4060746924421386e-19i, -1.2197274440461925e-19 + 1.7618285302889447e-19i, -0.010449083375253014 + 0.008331901221744983i, -0.0006285161549617225 + 0.002193985298315841i, 4.87890977618477e-19 + -3.1848438816761693e-19i, 2.168404344971009e-18 + -6.2341624917916505e-19i, 0.129361468881511 + -1.3420178258060321e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, true, false, true, false, false, true}), ElementsAreArray({ DoubleNear(0.10775872783348092, 1.0e-7), DoubleNear(0.19634281030560263, 1.0e-7), DoubleNear(0.07632641684233962, 1.0e-7), DoubleNear(0.13907127046395593, 1.0e-7), DoubleNear(0.09926860777677135, 1.0e-7), DoubleNear(0.18087330667205673, 1.0e-7), DoubleNear(0.070997391224283, 1.0e-7), DoubleNear(0.129361468881511, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, true, false, false, true, true, false}), Matrix({ { 0.07632643576549478 + -3.694953757728433e-20i, -0.003333961721742453 + 0.0027506021734655392i, -0.014347855496804219 + -0.018556325743321292i, -0.019546041377758536 + -0.005722070162924845i, 0.004219493943516528 + 0.00641847347611472i, -0.0005016281688966618 + -0.00012608187263461393i, 0.0007672649015914275 + -0.002232380332244696i, -0.0008355984912627468 + -0.002289514019930057i }, { -0.003333961721742454 + -0.0027506021734655392i, 0.14061186768169653 + -2.9156875821575396e-20i, 0.00023042660610541566 + -0.020551090745382077i, -0.028272321315680138 + -0.03406655357124291i, 0.00019563072363606735 + -0.0004210807217186793i, 0.005749888580257893 + 0.010298220225882788i, 0.002142601625667581 + -0.000532697097635605i, 0.001338878265732533 + -0.003463672637193943i }, { -0.014347855496804217 + 0.018556325743321292i, 0.00023042660610541593 + 0.020551090745382077i, 0.08854640585982662 + -2.6042747610466385e-20i, 0.0033339617217424556 + -0.002750602173465541i, -0.002353627182602972 + -0.00018071099114176246i, -0.0019639736541852597 + 0.0014805054309462826i, 0.004895040879330559 + 0.007446080138770411i, 0.0005016281688966621 + 0.0001260818726346141i }, { -0.019546041377758536 + 0.005722070162924845i, -0.028272321315680138 + 0.0340665535712429i, 0.0033339617217424556 + 0.0027506021734655414i, 0.16376555410349988 + 5.513158782665929e-22i, -0.00112425771619048 + -0.0018768926404469132i, -0.003651097001613414 + -0.0006775793923272316i, -0.00019563072363606738 + 0.0004210807217186795i, 0.0066966871637812175 + 0.011993964445371605i }, { 0.004219493943516528 + -0.00641847347611472i, 0.00019563072363606738 + 0.0004210807217186793i, -0.0023536271826029723 + 0.0001807109911417625i, -0.0011242577161904798 + 0.001876892640446913i, 0.08771731783066321 + 2.939117473008104e-20i, -0.0037260339737242446 + 0.002691871622428249i, -0.01648911531344641 + -0.021325653512725376i, -0.02035438929528776 + -0.0074062101510189195i }, { -0.0005016281688966619 + 0.00012608187263461398i, 0.005749888580257894 + -0.010298220225882788i, -0.0019639736541852597 + -0.0014805054309462826i, -0.003651097001613414 + 0.0006775793923272312i, -0.0037260339737242455 + -0.0026918716224282485i, 0.15765562871038163 + 4.8883892660046277e-20i, -0.0011572341244134165 + -0.021827093064674778i, -0.03169924890134777 + -0.03819580814777353i }, { 0.0007672649015914273 + 0.002232380332244696i, 0.002142601625667581 + 0.000532697097635605i, 0.004895040879330558 + -0.00744608013877041i, -0.00019563072363606743 + -0.00042108072171867945i, -0.016489115313446413 + 0.021325653512725376i, -0.0011572341244134162 + 0.021827093064674778i, 0.1017609842208903 + 2.1280668823998605e-20i, 0.003726033973724247 + -0.0026918716224282506i }, { -0.0008355984912627468 + 0.002289514019930057i, 0.0013388782657325331 + 0.0034636726371939435i, 0.0005016281688966621 + -0.00012608187263461404i, 0.0066966871637812175 + -0.011993964445371603i, -0.02035438929528776 + 0.0074062101510189195i, -0.03169924890134777 + 0.03819580814777353i, 0.003726033973724247 + 0.0026918716224282506i, 0.18361580582754822 + 6.547630856724746e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, true, false, false, true, true, false}), ElementsAreArray({ DoubleNear(0.07632643576549478, 1.0e-7), DoubleNear(0.14061186768169653, 1.0e-7), DoubleNear(0.08854640585982662, 1.0e-7), DoubleNear(0.16376555410349988, 1.0e-7), DoubleNear(0.08771731783066321, 1.0e-7), DoubleNear(0.15765562871038163, 1.0e-7), DoubleNear(0.1017609842208903, 1.0e-7), DoubleNear(0.18361580582754822, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, true, false, false, true, false, true}), Matrix({ { 0.08520895049407311 + 6.907371705124058e-21i, -0.0036826114729608755 + 0.00280613098653224i, -0.01608978785326167 + -0.02071116665855955i, -0.02073870754712158 + -0.006829653205472115i, -0.0062411491955765945 + -0.005826377528887661i, 0.0004944282186591004 + 4.358748404296177e-05i, -0.00019431812411300185 + 0.002536242286228229i, 0.0010721958440629577 + 0.0019109735484346038i }, { -0.003682611472960876 + -0.0028061309865322396i, 0.1549709647867162 + 1.742414601312325e-20i, -0.0004869133158763543 + -0.022002371990491758i, -0.03102763027050172 + -0.0375538893957037i, 6.574691706415125e-05 + 0.0004267237098442441i, -0.011379309340102624 + -0.010550814706936116i, -0.0014759489906119906 + 0.0016321956665993934i, -0.000357596342028626 + 0.005017704600074641i }, { -0.01608978785326167 + 0.02071116665855955i, -0.0004869133158763541 + 0.022002371990491758i, 0.09887619418174742 + -5.132655700891537e-21i, 0.0036826114729608785 + -0.002806130986532242i, 0.0026480786857138974 + -0.0004915035156627084i, 0.0015546530014737252 + -0.0015774705321409763i, -0.007259076895164172 + -0.006733781912800322i, -0.0004944282186591007 + -4.3587484042961794e-05i }, { -0.02073870754712158 + 0.006829653205472114i, -0.03102763027050172 + 0.0375538893957037i, 0.003682611472960878 + 0.0028061309865322417i, 0.18044311598284235 + 3.135221316729113e-20i, 0.0019836508236096375 + 0.0008964831972911831i, 0.004737603865341974 + -0.0005087536746891253i, -6.574691706415132e-05 + -0.0004267237098442443i, -0.013218905428293062 + -0.012334542723028315i }, { -0.0062411491955765945 + 0.005826377528887661i, 6.574691706415127e-05 + -0.0004267237098442441i, 0.0026480786857138974 + 0.0004915035156627084i, 0.001983650823609637 + -0.0008964831972911831i, 0.07883480310208488 + -1.4465734552327348e-20i, -0.0033773842225058226 + 0.002636342809361548i, -0.014747182956988958 + -0.01917081259748711i, -0.019161723125924717 + -0.00629862710847165i }, { 0.0004944282186591005 + -4.358748404296174e-05i, -0.011379309340102624 + 0.010550814706936116i, 0.0015546530014737252 + 0.0015774705321409761i, 0.004737603865341974 + 0.0005087536746891249i, -0.003377384222505823 + -0.002636342809361548i, 0.143296531605362 + 2.302870825347629e-21i, -0.0004398942024316465 + -0.020375811819565097i, -0.028943939946526186 + -0.03470847232331273i }, { -0.00019431812411300185 + -0.002536242286228229i, -0.0014759489906119906 + -0.0016321956665993934i, -0.007259076895164172 + 0.006733781912800321i, -6.574691706415128e-05 + 0.0004267237098442443i, -0.014747182956988956 + 0.019170812597487114i, -0.0004398942024316463 + 0.020375811819565097i, 0.0914311958989695 + 3.705769144237564e-22i, 0.0033773842225058247 + -0.00263634280936155i }, { 0.0010721958440629577 + -0.001910973548434604i, -0.0003575963420286262 + -0.005017704600074641i, -0.0004944282186591007 + 4.3587484042961794e-05i, -0.013218905428293062 + 0.012334542723028313i, -0.019161723125924717 + 0.00629862710847165i, -0.028943939946526186 + 0.03470847232331273i, 0.003377384222505825 + 0.0026363428093615503i, 0.16693824394820575 + 3.467541127822292e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, true, false, false, true, false, true}), ElementsAreArray({ DoubleNear(0.08520895049407311, 1.0e-7), DoubleNear(0.1549709647867162, 1.0e-7), DoubleNear(0.09887619418174742, 1.0e-7), DoubleNear(0.18044311598284235, 1.0e-7), DoubleNear(0.07883480310208488, 1.0e-7), DoubleNear(0.143296531605362, 1.0e-7), DoubleNear(0.0914311958989695, 1.0e-7), DoubleNear(0.16693824394820575, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, true, false, false, false, true, true}), Matrix({ { 0.08565131352133301 + -6.207907779149217e-20i, 1.3010426069826053e-18 + -1.0842021724855044e-18i, 0.0047349937807639915 + 0.007202624864078747i, 1.0842021724855044e-19 + 5.421010862427522e-20i, -0.00628139820594007 + -0.005844003089507599i, -1.3552527156068805e-19 + -6.776263578034403e-21i, 0.00014418670316756064 + -0.0008512872737755165i, -2.0328790734103208e-20 + -2.0328790734103208e-20i }, { 1.0842021724855044e-18 + 1.0842021724855044e-18i, 0.15812383486047082 + -4.544530285366334e-21i, -9.486769009248164e-20 + 1.6263032587282567e-19i, 0.006465986458475553 + 0.011580772670201998i, -2.710505431213761e-20 + -1.3552527156068805e-19i, -0.011596305202739722 + -0.010788815039237228i, 1.3552527156068805e-20 + -1.0164395367051604e-20i, 0.00031596287798790214 + -0.0012904727898483703i }, { 0.0047349937807639915 + -0.007202624864078747i, 1.3552527156068805e-20 + -1.0842021724855044e-19i, 0.09843383115448752 + 6.38537937957247e-20i, 1.5178830414797062e-18 + -1.3010426069826053e-18i, -0.0008386858349811188 + 0.00020514847809453753i, 0.0 + 2.0328790734103208e-20i, -0.007218827884800696 + -0.006716156352180384i, -1.6263032587282567e-19 + -2.0328790734103208e-20i }, { 1.0842021724855044e-19 + 1.3552527156068805e-20i, 0.006465986458475554 + -0.011580772670201998i, 8.673617379884035e-19 + 1.0842021724855044e-18i, 0.17729024590908776 + 5.3320889465780717e-20i, -1.0164395367051604e-20 + -2.0328790734103208e-20i, -0.0012643531377539738 + 0.00040812216878909524i, -4.743384504624082e-20 + -1.3552527156068805e-19i, -0.013001909565655962 + -0.012096542390727202i }, { -0.006281398205940071 + 0.005844003089507599i, -3.3881317890172014e-20 + 1.3552527156068805e-19i, -0.0008386858349811188 + -0.0002051484780945376i, -1.3552527156068805e-20 + 8.470329472543003e-21i, 0.07922152810398839 + -9.132073962585426e-22i, 1.3010426069826053e-18 + -8.673617379884035e-19i, 0.0043795410420830955 + 0.006661928750806383i, 2.168404344971009e-19 + 1.0842021724855044e-19i }, { -1.6263032587282567e-19 + 2.710505431213761e-20i, -0.011596305202739722 + 0.010788815039237228i, -1.6940658945086007e-21 + -6.776263578034403e-21i, -0.0012643531377539736 + -0.00040812216878909524i, 6.505213034913027e-19 + 1.0842021724855044e-18i, 0.14625358692472562 + -2.406102965794247e-20i, 5.421010862427522e-20 + 8.131516293641283e-20i, 0.005980589285563558 + 0.010711412001052398i }, { 0.0001441867031675607 + 0.0008512872737755165i, 2.710505431213761e-20 + 3.3881317890172014e-21i, -0.007218827884800696 + 0.006716156352180383i, 2.710505431213761e-20 + 1.0842021724855044e-19i, 0.004379541042083095 + -0.0066619287508063825i, -6.776263578034403e-20 + -8.131516293641283e-20i, 0.091044470897066 + -1.3181950241645049e-20i, 8.673617379884035e-19 + -8.673617379884035e-19i }, { -1.6940658945086007e-20 + 2.0328790734103208e-20i, 0.00031596287798790225 + 0.0012904727898483703i, -1.0842021724855044e-19 + 2.710505431213761e-20i, -0.013001909565655962 + 0.0120965423907272i, 1.3552527156068805e-19 + -8.131516293641283e-20i, 0.005980589285563557 + -0.010711412001052398i, 1.3010426069826053e-18 + 1.0842021724855044e-18i, 0.16398118862884212 + 6.103931176151302e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, true, false, false, false, true, true}), ElementsAreArray({ DoubleNear(0.08565131352133301, 1.0e-7), DoubleNear(0.15812383486047082, 1.0e-7), DoubleNear(0.09843383115448752, 1.0e-7), DoubleNear(0.17729024590908776, 1.0e-7), DoubleNear(0.07922152810398839, 1.0e-7), DoubleNear(0.14625358692472562, 1.0e-7), DoubleNear(0.091044470897066, 1.0e-7), DoubleNear(0.16398118862884212, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, true, true, true, false, false}), Matrix({ { 0.14505671153560667 + -7.451242957877673e-21i, 0.0012905900395537683 + 0.010532381789571062i, -0.0004769662534086167 + 0.0007175872809956211i, -5.63467282562256e-05 + -2.8247432613772126e-05i, -0.031445552863040925 + -0.034996357428009064i, 0.002261265107214735 + -0.002594588796827604i, -0.004654844260484159 + 0.0012983860646973494i, -0.00013568895346889657 + -0.0003264303478174178i }, { 0.001290590039553769 + -0.010532381789571062i, 0.12416221006372066 + 4.4826571755473676e-20i, 4.785945608059326e-05 + 4.101638328912356e-05i, -0.00040826228253829967 + 0.0006142233735952437i, -0.0028208161529219896 + 0.001971853732188209i, -0.026916019940189606 + -0.02995535357476308i, 5.2859340489834335e-05 + 0.00034953419602760537i, -0.003984343397597769 + 0.0011113617674228609i }, { -0.0004769662534086168 + -0.0007175872809956211i, 4.785945608059326e-05 + -4.101638328912353e-05i, 0.1040392629628547 + 2.948588691021836e-20i, 0.0009256520093481936 + 0.007554157453523878i, 0.0026217061051574736 + -0.003803928406112301i, 0.00029952405234733156 + 0.00015651462994796154i, -0.017482614081953465 + -0.025427661888808108i, 0.0016907246333743063 + -0.0014956236843991038i }, { -5.634672825622559e-05 + 2.8247432613772133e-05i, -0.0004082622825382996 + -0.0006142233735952438i, 0.0009256520093481936 + -0.007554157453523877i, 0.08905306542605412 + -5.469256171654678e-20i, -0.0002528726737225929 + -0.00022420280597419256i, 0.0022440659291659004 + -0.0032559965880043715i, -0.002001815204236905 + 0.0010431566897260405i, -0.014964354142094533 + -0.02176496808348284i }, { -0.031445552863040925 + 0.034996357428009064i, -0.0028208161529219896 + -0.0019718537321882093i, 0.0026217061051574736 + 0.0038039284061123016i, -0.0002528726737225929 + 0.00022420280597419248i, 0.16973703871475962 + 9.754113783225302e-21i, 0.0015101743944805255 + 0.012324388693564326i, 0.00047696625340861706 + -0.0007175872809956212i, 5.63467282562256e-05 + 2.824743261377214e-05i }, { 0.0022612651072147346 + 0.002594588796827604i, -0.026916019940189606 + 0.02995535357476308i, 0.00029952405234733156 + -0.00015651462994796146i, 0.0022440659291659004 + 0.0032559965880043715i, 0.0015101743944805263 + -0.012324388693564326i, 0.1452874922738247 + 5.800852199711872e-20i, -4.7859456080593265e-05 + -4.101638328912358e-05i, 0.0004082622825383 + -0.0006142233735952439i }, { -0.0046548442604841585 + -0.0012983860646973496i, 5.2859340489834396e-05 + -0.00034953419602760537i, -0.017482614081953465 + 0.025427661888808108i, -0.002001815204236905 + -0.0010431566897260405i, 0.0004769662534086171 + 0.0007175872809956213i, -4.785945608059328e-05 + 4.101638328912356e-05i, 0.11997276861622852 + 4.079944294325926e-20i, 0.0010674146584095587 + 0.008711068864316671i }, { -0.00013568895346889663 + 0.0003264303478174178i, -0.003984343397597769 + -0.0011113617674228609i, 0.001690724633374306 + 0.001495623684399104i, -0.014964354142094533 + 0.02176496808348284i, 5.634672825622562e-05 + -2.824743261377216e-05i, 0.0004082622825383 + 0.000614223373595244i, 0.0010674146584095591 + -0.008711068864316671i, 0.10269145040695218 + -4.7296533064557016e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, true, true, true, false, false}), ElementsAreArray({ DoubleNear(0.14505671153560667, 1.0e-7), DoubleNear(0.12416221006372066, 1.0e-7), DoubleNear(0.1040392629628547, 1.0e-7), DoubleNear(0.08905306542605412, 1.0e-7), DoubleNear(0.16973703871475962, 1.0e-7), DoubleNear(0.1452874922738247, 1.0e-7), DoubleNear(0.11997276861622852, 1.0e-7), DoubleNear(0.10269145040695218, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, true, true, false, true, false}), Matrix({ { 0.14771705022496895 + -4.625593985396531e-20i, 0.001314259448421401 + 0.010725545569925016i, 2.168404344971009e-19 + -5.421010862427522e-20i, 3.3881317890172014e-21 + 1.1858461261560205e-20i, 0.006787302854912898 + 0.011381915241914849i, -0.0007660386767910682 + 0.0005940838622313279i, 3.049318610115481e-20 + 1.5246593050577406e-20i, -2.6469779601696886e-21 + 6.352747104407253e-22i }, { 0.001314259448421401 + -0.010725545569925016i, 0.12643934379777863 + -3.2954875604112623e-21i, -3.3881317890172014e-21 + -1.1858461261560205e-20i, 1.7618285302889447e-19 + -1.0842021724855044e-19i, 0.0008868138600590999 + -0.00039155084894631695i, 0.005809634824314383 + 0.009742422368696813i, -5.293955920339377e-22 + -1.0587911840678754e-21i, 8.470329472543003e-21 + -8.470329472543003e-22i }, { 1.0842021724855044e-19 + 8.131516293641283e-20i, -1.1858461261560205e-20 + 1.1858461261560205e-20i, 0.10511770482560992 + -2.9139505028711782e-21i, 0.0009352470588400471 + 0.007632461734078355i, -5.082197683525802e-21 + 1.8634724839594607e-20i, -2.117582368135751e-21 + -6.352747104407253e-22i, 0.0048299481811894095 + 0.008099544398751326i, -0.0005451248003482885 + 0.00042275913292733205i }, { 8.470329472543003e-21 + -9.317362419797304e-21i, 2.168404344971009e-19 + 1.0842021724855044e-19i, 0.0009352470588400471 + -0.007632461734078355i, 0.08997616456216029 + -3.913246721381177e-20i, 4.235164736271502e-22 + -6.352747104407253e-22i, -1.6940658945086007e-21 + 2.541098841762901e-20i, 0.0006310702619296892 + -0.0002786335531414418i, 0.004134224706469506 + 0.006932856276776537i }, { 0.006787302854912898 + -0.011381915241914849i, 0.0008868138600591 + 0.00039155084894631695i, 2.0328790734103208e-20 + -2.371692252312041e-20i, 1.4823076576950256e-21 + 1.0587911840678754e-22i, 0.16707670002539732 + 4.8558810679312937e-20i, 0.0014865049856128928 + 0.012131224913210371i, 1.6263032587282567e-19 + -2.710505431213761e-20i, 0.0 + 4.235164736271502e-21i }, { -0.0007660386767910682 + -0.000594083862231328i, 0.005809634824314383 + -0.009742422368696813i, -1.6940658945086007e-21 + 6.352747104407253e-22i, -2.0328790734103208e-20 + -2.202285662861181e-20i, 0.001486504985612894 + -0.012131224913210371i, 0.14301035853976674 + 1.0613058131300366e-19i, -1.6940658945086007e-21 + -1.0164395367051604e-20i, 1.7618285302889447e-19 + -1.3552527156068805e-19i }, { 1.0164395367051604e-20 + -1.0164395367051604e-20i, 6.352747104407253e-22 + 0.0i, 0.004829948181189411 + -0.008099544398751326i, 0.0006310702619296892 + 0.00027863355314144186i, 1.8973538018496328e-19 + 1.6263032587282567e-19i, -1.1858461261560205e-20 + 1.6940658945086007e-20i, 0.1188943267534733 + 7.31992803563488e-20i, 0.0010578196089177049 + 0.008632764583762194i }, { -5.293955920339377e-22 + -2.117582368135751e-21i, 2.371692252312041e-20 + -2.625802136488331e-20i, -0.0005451248003482885 + -0.0004227591329273322i, 0.004134224706469505 + -0.006932856276776537i, 2.0328790734103208e-20 + -1.1858461261560205e-20i, 2.0328790734103208e-19 + 1.0842021724855044e-19i, 0.0010578196089177055 + -0.008632764583762194i, 0.101768351270846 + -6.285662756729202e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, true, true, false, true, false}), ElementsAreArray({ DoubleNear(0.14771705022496895, 1.0e-7), DoubleNear(0.12643934379777863, 1.0e-7), DoubleNear(0.10511770482560992, 1.0e-7), DoubleNear(0.08997616456216029, 1.0e-7), DoubleNear(0.16707670002539732, 1.0e-7), DoubleNear(0.14301035853976674, 1.0e-7), DoubleNear(0.1188943267534733, 1.0e-7), DoubleNear(0.101768351270846, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, true, true, false, false, true}), Matrix({ { 0.16385166701256687 + -1.241432663319584e-20i, 0.0014578114116339368 + 0.011897059402249074i, 2.168404344971009e-19 + -2.710505431213761e-20i, 0.0 + 1.3552527156068805e-20i, -0.011807708985818236 + -0.012145125440547402i, 0.000776787128442329 + -0.000965399501608814i, -3.3881317890172014e-20 + 6.776263578034403e-21i, -1.0587911840678754e-21 + -6.352747104407253e-22i }, { 0.0014578114116339377 + -0.011897059402249074i, 0.14024987112651668 + 8.864729188608287e-20i, -1.6940658945086007e-21 + -1.0164395367051604e-20i, 2.303929616531697e-19 + -1.0842021724855044e-19i, -0.0009868968358212379 + 0.0007492857105712441i, -0.010106883217937651 + -0.010395696967315632i, -1.6940658945086007e-21 + 2.117582368135751e-21i, -1.6940658945086007e-20 + -2.0328790734103208e-20i }, { 1.8973538018496328e-19 + 1.0842021724855044e-19i, -1.3552527156068805e-20 + 1.6940658945086007e-20i, 0.11605751931332373 + 4.823600344526412e-20i, 0.0010325801326629962 + 0.008426787633734499i, -8.470329472543003e-21 + -2.0328790734103208e-20i, 3.1763735522036263e-21 + -3.705769144237564e-22i, -0.0087199512277718 + -0.006953123989832196i, 0.0004272747784990807 + -0.0006950074010029135i }, { 1.8634724839594607e-20 + -7.623296525288703e-21i, 2.168404344971009e-19 + 1.0842021724855044e-19i, 0.0010325801326629964 + -0.008426787633734499i, 0.09934016799297181 + -7.391789351350424e-20i, -1.6940658945086007e-21 + 1.0587911840678754e-22i, 7.623296525288703e-21 + -2.710505431213761e-20i, -0.000582440052560798 + 0.0005712815496436393i, -0.007463897427608764 + -0.005951570473957182i }, { -0.011807708985818236 + 0.012145125440547402i, -0.0009868968358212374 + -0.0007492857105712443i, 5.082197683525802e-21 + 1.6940658945086007e-20i, -1.2705494208814505e-21 + 1.5881867761018131e-22i, 0.1509420832377994 + 1.4717197458543468e-20i, 0.0013429530224003568 + 0.010959711080886314i, 1.6263032587282567e-19 + -5.421010862427522e-20i, 3.3881317890172014e-21 + 2.541098841762901e-21i }, { 0.0007767871284423289 + 0.000965399501608814i, -0.010106883217937651 + 0.010395696967315633i, 8.470329472543003e-22 + -1.0587911840678754e-21i, 5.929230630780102e-21 + 1.0164395367051604e-20i, 0.0013429530224003576 + -0.010959711080886314i, 0.12919983121102868 + 1.418780186650953e-20i, -3.3881317890172014e-21 + -1.1858461261560205e-20i, 1.2197274440461925e-19 + -1.3552527156068805e-19i }, { -3.3881317890172014e-20 + 0.0i, -4.235164736271502e-22 + -1.4823076576950256e-21i, -0.0087199512277718 + 0.006953123989832197i, -0.000582440052560798 + -0.0005712815496436393i, 1.0842021724855044e-19 + 1.3552527156068805e-19i, -1.0164395367051604e-20 + 1.1858461261560205e-20i, 0.1079545122657595 + 2.2049326408213506e-20i, 0.0009604865350947558 + 0.00783843868410605i }, { -1.2705494208814505e-21 + 1.4823076576950256e-21i, -3.3881317890172014e-21 + 0.0i, 0.0004272747784990807 + 0.0006950074010029135i, -0.007463897427608764 + 0.005951570473957182i, 1.0164395367051604e-20 + -1.3552527156068805e-20i, 2.0328790734103208e-19 + 1.0842021724855044e-19i, 0.0009604865350947562 + -0.00783843868410605i, 0.09240434784003448 + -2.807120126759955e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, true, true, false, false, true}), ElementsAreArray({ DoubleNear(0.16385166701256687, 1.0e-7), DoubleNear(0.14024987112651668, 1.0e-7), DoubleNear(0.11605751931332373, 1.0e-7), DoubleNear(0.09934016799297181, 1.0e-7), DoubleNear(0.1509420832377994, 1.0e-7), DoubleNear(0.12919983121102868, 1.0e-7), DoubleNear(0.1079545122657595, 1.0e-7), DoubleNear(0.09240434784003448, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, true, false, true, true, false}), Matrix({ { 0.11688761219761815 + -3.7088090329886964e-20i, 0.0010399655862351454 + 0.008487059613470155i, -0.02296399768915998 + -0.028353511631200496i, 0.0018543981870349571 + -0.0019196516164390464i, 0.005371560945079121 + 0.009007051219708195i, -0.0006061989015243085 + 0.0004701591573905747i, 0.0011348021159147386 + -0.0030690662735403398i, 0.0002329374606689121 + 5.509061037209532e-05i }, { 0.0010399655862351454 + -0.008487059613470155i, 0.10005069124957316 + -2.9018323068972764e-20i, -0.002263026045370084 + 0.0014151212253910327i, -0.019656179123324374 + -0.024269367683363702i, 0.0007017819735405722 + -0.0003098851450150412i, 0.004597821578695301 + 0.007709642482289317i, -0.00021274447142822334 + -0.00010970244213679506i, 0.0009713410514092218 + -0.0026269866958982995i }, { -0.02296399768915998 + 0.028353511631200493i, -0.0022630260453700844 + -0.001415121225391033i, 0.13594714285296075 + -1.2081800026949522e-20i, 0.0012095409210263028 + 0.009870947690533215i, -0.00323538010874691 + -0.00046245182110170915i, 4.792400084402979e-06 + -0.0002390312994602987i, 0.006245690091023187 + 0.010474408420957981i, -0.0007049645756150483 + 0.0005466838377680852i }, { 0.0018543981870349571 + 0.0019196516164390468i, -0.01965617912332437 + 0.024269367683363702i, 0.001209540921026303 + -0.009870947690533215i, 0.11636481711036577 + -1.340963170525027e-20i, -6.236366718836173e-05 + 0.00023080230119101338i, -0.002769344075469476 + -0.00039583856236728493i, 0.0008161021484482168 + -0.0003602992570727176i, 0.005346037952088588 + 0.008965636163184033i }, { 0.005371560945079122 + -0.009007051219708191i, 0.0007017819735405723 + 0.0003098851450150412i, -0.0032353801087469094 + 0.0004624518211017089i, -6.236366718836167e-05 + -0.00023080230119101338i, 0.1322083623008432 + 5.912273428222765e-20i, 0.0011762764626668165 + 0.009599479629624784i, -0.025964169255834415 + -0.03207050768561667i, 0.0020975915535540843 + -0.002170560864787661i }, { -0.0006061989015243085 + -0.0004701591573905747i, 0.0045978215786953 + -0.007709642482289317i, 4.7924000844030114e-06 + 0.00023903129946029874i, -0.0027693440754694766 + 0.00039583856236728493i, 0.0011762764626668172 + -0.009599479629624784i, 0.11316458424020162 + 1.9152333107899665e-20i, -0.0025596053117888104 + 0.0015998891965232165i, -0.02222419495895976 + -0.027450953974882224i }, { 0.0011348021159147382 + 0.00306906627354034i, -0.00021274447142822332 + 0.00010970244213679505i, 0.006245690091023187 + -0.010474408420957981i, 0.0008161021484482168 + 0.0003602992570727176i, -0.02596416925583441 + 0.03207050768561667i, -0.0025596053117888104 + -0.0015998891965232171i, 0.1537626644780274 + 6.263535675343409e-20i, 0.0013680481318637811 + 0.01116450986734778i }, { 0.00023293746066891212 + -5.509061037209526e-05i, 0.0009713410514092221 + 0.0026269866958982995i, -0.0007049645756150482 + -0.0005466838377680854i, 0.005346037952088588 + -0.008965636163184031i, 0.002097591553554084 + 0.002170560864787661i, -0.022224194958959765 + 0.027450953974882224i, 0.0013680481318637824 + -0.01116450986734778i, 0.13161412557041113 + 2.4121620637811978e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, true, false, true, true, false}), ElementsAreArray({ DoubleNear(0.11688761219761815, 1.0e-7), DoubleNear(0.10005069124957316, 1.0e-7), DoubleNear(0.13594714285296075, 1.0e-7), DoubleNear(0.11636481711036577, 1.0e-7), DoubleNear(0.1322083623008432, 1.0e-7), DoubleNear(0.11316458424020162, 1.0e-7), DoubleNear(0.1537626644780274, 1.0e-7), DoubleNear(0.13161412557041113, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, true, false, true, false, true}), Matrix({ { 0.12941032703259647 + 1.1182034315644966e-20i, 0.0011513819478988253 + 0.0093963178772737i, -0.025387137309959375 + -0.031393549080653976i, 0.002053572392125731 + -0.0021226403189686985i, -0.009494004937510028 + -0.00882412586679421i, 0.0005562389601026889 + -0.0007678570159646899i, -0.00029737470543242264 + 0.004070110257972549i, -0.00029817127065400134 + 1.4620349546038789e-05i }, { 0.0011513819478988258 + -0.0093963178772737i, 0.11076958824819283 + 1.3149483402602343e-20i, -0.0025053182810014047 + 0.0015640146432475308i, -0.021730280813804015 + -0.02687150697360928i, -0.0007251779644150411 + 0.0006108380289644515i, -0.00812645359816919 + -0.007553066369029566i, 0.000292879701187364 + 5.780434150364893e-05i, -0.0002545397607092052 + 0.0034838366283303206i }, { -0.025387137309959375 + 0.031393549080653976i, -0.0025053182810014047 + -0.001564014643247531i, 0.15049885929329412 + 2.4639642496423312e-20i, 0.001339009596398108 + 0.010927529158709873i, 0.003979448461265777 + -0.0005389443574780476i, 7.453777332231198e-05 + 0.0002841475851065316i, -0.01103365527608001 + -0.01027412356358539i, 0.0006478229468387206 + -0.0008925498866470374i }, { 0.002053572392125731 + 0.002122640318968699i, -0.02173028081380401 + 0.02687150697360928i, 0.0013390095963981084 + -0.010927529158709873i, 0.12882045087129565 + 1.5799149699762829e-21i, -3.726343879883119e-06 + -0.00029373771316433094i, 0.0034062340897900944 + -0.00046131283287378607i, -0.0008441589239669946 + 0.0007097292312504319i, -0.009444327047377226 + -0.008794201072243246i }, { -0.009494004937510028 + 0.00882412586679421i, -0.000725177964415041 + -0.0006108380289644517i, 0.003979448461265777 + 0.0005389443574780473i, -3.7263438798831545e-06 + 0.00029373771316433094i, 0.11968564746586488 + 1.0852609636695723e-20i, 0.0010648601010031363 + 0.00869022136582124i, -0.023541029635035016 + -0.029030470236163196i, 0.0018984173484633106 + -0.001967572162258009i }, { 0.0005562389601026889 + 0.0007678570159646899i, -0.00812645359816919 + 0.007553066369029566i, 7.453777332231198e-05 + -0.00028414758510653153i, 0.0034062340897900944 + 0.0004613128328737859i, 0.0010648601010031368 + -0.00869022136582124i, 0.10244568724158196 + -2.3015473363675442e-20i, -0.0023173130761574897 + 0.0014509957786667184i, -0.020150093268480124 + -0.02484881468463665i }, { -0.0002973747054324228 + -0.004070110257972549i, 0.00029287970118736394 + -5.7804341503648925e-05i, -0.01103365527608001 + 0.01027412356358539i, -0.0008441589239669945 + -0.0007097292312504321i, -0.023541029635035016 + 0.029030470236163196i, -0.0023173130761574897 + -0.0014509957786667188i, 0.13921094803769402 + 2.591391423006125e-20i, 0.0012385794564919762 + 0.010107928399171124i }, { -0.0002981712706540013 + -1.4620349546038772e-05i, -0.0002545397607092053 + -0.0034838366283303206i, 0.0006478229468387206 + 0.0008925498866470374i, -0.009444327047377226 + 0.008794201072243248i, 0.0018984173484633102 + 0.001967572162258009i, -0.020150093268480124 + 0.02484881468463665i, 0.001238579456491977 + -0.010107928399171124i, 0.11915849180948124 + 9.132073962585426e-21i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, true, false, true, false, true}), ElementsAreArray({ DoubleNear(0.12941032703259647, 1.0e-7), DoubleNear(0.11076958824819283, 1.0e-7), DoubleNear(0.15049885929329412, 1.0e-7), DoubleNear(0.12882045087129565, 1.0e-7), DoubleNear(0.11968564746586488, 1.0e-7), DoubleNear(0.10244568724158196, 1.0e-7), DoubleNear(0.13921094803769402, 1.0e-7), DoubleNear(0.11915849180948124, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, true, false, false, true, true}), Matrix({ { 0.13134745941444773 + -4.216863365218766e-20i, 0.001168616888156661 + 0.009536970575150351i, 0.00603515291505967 + 0.01012060319387148i, -0.0006811484108061651 + 0.0005282491483844826i, -0.00963260996242872 + -0.008961858575885388i, 0.0005650063669948261 + -0.0007791463764191941i, 0.0002479312548329627 + -0.0011539927055719584i, 8.599580973117127e-05 + 7.73473443635812e-06i }, { 0.0011686168881566612 + -0.009536970575150351i, 0.11242768896735611 + -2.4454974424670848e-20i, 0.0007885396256890143 + -0.00034816027779016476i, 0.005165827324179874 + 0.008662794340409265i, -0.0007364117482531117 + 0.0006196765347071392i, -0.008245093446251073 + -0.0076709595528594385i, -8.1584050983932e-05 + -2.8269206447510708e-05i, 0.00021221832632250007 + -0.0009877673580519282i }, { 0.006035152915059671 + -0.01012060319387148i, 0.0007885396256890145 + 0.0003481602777901648i, 0.14856172691144287 + 7.799031046425594e-20i, 0.0013217746561402723 + 0.01078687646083322i, -0.0011331295579223325 + 0.00033043377036718767i, -3.4073985921292175e-05 + -7.933516806282306e-05i, -0.010895050251161317 + -0.010136390854494212i, 0.0006390555399465835 + -0.0008812605261925333i }, { -0.000681148410806165 + -0.0005282491483844826i, 0.005165827324179875 + -0.008662794340409265i, 0.001321774656140273 + -0.01078687646083322i, 0.1271623501521324 + 3.9184372797249474e-20i, 1.3910758649735644e-05 + 8.52149998645168e-05i, -0.0009699094148127598 + 0.000282836876516445i, -0.0008329251401289241 + 0.0007008907255077443i, -0.009325687199295343 + -0.008676307888413374i }, { -0.00963260996242872 + 0.008961858575885388i, -0.0007364117482531116 + -0.0006196765347071392i, -0.0011331295579223325 + -0.0003304337703671878i, 1.391075864973563e-05 + -8.52149998645168e-05i, 0.12148729563613117 + -7.001256704648826e-21i, 0.0010808896191047872 + 0.00882103672885302i, 0.005582098121042638 + 0.009360856446794696i, -0.0006300150663331917 + 0.0004885938467741774i }, { 0.0005650063669948261 + 0.0007791463764191941i, -0.008245093446251073 + 0.007670959552859439i, -3.407398592129217e-05 + 7.933516806282303e-05i, -0.0009699094148127599 + -0.0002828368765164451i, 0.0010808896191047872 + -0.00882103672885302i, 0.10398781939258284 + -1.7972980349552185e-20i, 0.0007293444962997748 + -0.000322024124297594i, 0.004778032206604015 + 0.008012484305064085i }, { 0.0002479312548329627 + 0.0011539927055719584i, -8.158405098393197e-05 + 2.82692064475107e-05i, -0.010895050251161317 + 0.01013639085449421i, -0.0008329251401289239 + -0.0007008907255077444i, 0.005582098121042638 + -0.009360856446794696i, 0.0007293444962997748 + 0.000322024124297594i, 0.13740929986742773 + 4.37677805714058e-20i, 0.0012225499383903254 + 0.009977113036139344i }, { 8.599580973117124e-05 + -7.734734436358125e-06i, 0.0002122183263225003 + 0.0009877673580519282i, 0.0006390555399465835 + 0.0008812605261925333i, -0.009325687199295343 + 0.008676307888413374i, -0.0006300150663331917 + -0.0004885938467741775i, 0.004778032206604013 + -0.008012484305064084i, 0.0012225499383903267 + -0.009977113036139344i, 0.11761635965848037 + 4.089580948462169e-21i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, true, false, false, true, true}), ElementsAreArray({ DoubleNear(0.13134745941444773, 1.0e-7), DoubleNear(0.11242768896735611, 1.0e-7), DoubleNear(0.14856172691144287, 1.0e-7), DoubleNear(0.1271623501521324, 1.0e-7), DoubleNear(0.12148729563613117, 1.0e-7), DoubleNear(0.10398781939258284, 1.0e-7), DoubleNear(0.13740929986742773, 1.0e-7), DoubleNear(0.11761635965848037, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, false, true, true, true, false}), Matrix({ { 0.1263217171115723 + -3.756061725480788e-20i, -0.00041796558856625515 + 0.0006208170031396026i, -0.02744225269729194 + -0.03047260800637347i, -0.00405579863696701 + 0.0011288797345423694i, 0.005814441606227226 + 0.009741060926243238i, -6.763879889044768e-05 + 2.9674850621474475e-06i, 0.0011533627834375722 + -0.003474932431731026i, -0.0002728699060719963 + -0.00025703174776981505i }, { -0.00041796558856625526 + -0.0006208170031396027i, 0.09061658633561899 + -2.8545796144051847e-20i, 0.0022823865303128765 + -0.0033103675822594826i, -0.015177924115192414 + -0.022150271308190726i, 3.4857473083787275e-05 + -6.313286510952031e-05i, 0.0041549409175471955 + 0.0069756327757542706i, 0.0003629694970679892 + 2.1742960688325e-05i, 0.0009527803838863882 + -0.0022211205377076133i }, { -0.02744225269729194 + 0.03047260800637347i, 0.002282386530312877 + 0.0033103675822594826i, 0.1478346769111753 + -1.1990810159568689e-20i, 0.0004179655885662556 + -0.0006208170031396028i, -0.00355249896634486 + -0.0006614929676398458i, -0.00015130536365235168 + 0.000331432198972506i, 0.006782496073000056 + 0.011383276684368424i, 6.763879889044771e-05 + -2.967485062147433e-06i }, { -0.00405579863696701 + -0.0011288797345423698i, -0.015177924115192412 + 0.022150271308190726i, 0.0004179655885662556 + 0.0006208170031396029i, 0.10447728305215123 + -1.3500621572631103e-20i, -9.577685398472098e-05 + -0.0003649182798099625i, -0.002452225217871526 + -0.0001967974158291483i, -3.485747308378728e-05 + 6.313286510952035e-05i, 0.004809231970111719 + 0.008056767899773592i }, { 0.005814441606227226 + -0.009741060926243238i, 3.4857473083787275e-05 + 6.31328651095203e-05i, -0.0035524989663448603 + 0.0006614929676398455i, -9.577685398472091e-05 + 0.0003649182798099625i, 0.142897204487755 + 7.493594605240388e-20i, -0.0004672629473806611 + 0.0007109936514512621i, -0.03091932010593859 + -0.034479102996398676i, -0.004583389021114918 + 0.0012808680975778409i }, { -6.763879889044767e-05 + -2.967485062147479e-06i, 0.004154940917547197 + -0.0069756327757542706i, -0.00015130536365235168 + -0.000331432198972506i, -0.002452225217871526 + 0.00019679741582914832i, -0.00046726294738066114 + -0.0007109936514512621i, 0.10247574205328984 + 3.3391213377234345e-21i, 0.0025833855040104975 + -0.0037495574118571904i, -0.01726904410885559 + -0.025042358664100227i }, { 0.0011533627834375718 + 0.003474932431731027i, 0.0003629694970679892 + -2.1742960688325037e-05i, 0.0067824960730000555 + -0.011383276684368424i, -3.4857473083787275e-05 + -6.313286510952033e-05i, -0.03091932010593859 + 0.034479102996398676i, 0.002583385504010498 + 0.003749557411857191i, 0.16718985407740905 + 7.975344593991272e-20i, 0.0004672629473806614 + -0.0007109936514512623i }, { -0.0002728699060719963 + 0.000257031747769815i, 0.0009527803838863887 + 0.0022211205377076133i, 6.76387988904477e-05 + 2.9674850621474424e-06i, 0.00480923197011172 + -0.008056767899773592i, -0.004583389021114919 + -0.0012808680975778409i, -0.01726904410885559 + 0.025042358664100227i, 0.0004672629473806615 + 0.0007109936514512626i, 0.11818693597102947 + 7.003531451333347e-21i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, false, true, true, true, false}), ElementsAreArray({ DoubleNear(0.1263217171115723, 1.0e-7), DoubleNear(0.09061658633561899, 1.0e-7), DoubleNear(0.1478346769111753, 1.0e-7), DoubleNear(0.10447728305215123, 1.0e-7), DoubleNear(0.142897204487755, 1.0e-7), DoubleNear(0.10247574205328984, 1.0e-7), DoubleNear(0.16718985407740905, 1.0e-7), DoubleNear(0.11818693597102947, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, false, true, true, false, true}), Matrix({ { 0.14013784198731208 + 4.298692207315574e-20i, -0.00048231963700262175 + 0.0007382271311649577i, -0.03032885730416518 + -0.033812881944702305i, -0.004831264982055713 + 0.0013299629571999708i, -0.01010097084766369 + -0.010387425962948924i, 8.637377780848466e-05 + -8.726067306236082e-05i, -0.00033370383326550865 + 0.004685919158887456i, 0.0008246467687633899 + 7.3352834078635056e-06i }, { -0.0004823196370026219 + -0.0007382271311649577i, 0.10004207329347724 + -1.8655404354908433e-20i, 0.0027205724640588236 + -0.003957561867487424i, -0.01678856081959821 + -0.024452174109560944i, -3.941607499757994e-06 + 7.752504660691936e-05i, -0.007519487688015528 + -0.005989766272874852i, -0.0003350159299786474 + 0.0002458892035381938i, -0.00021821063287611923 + 0.002868027727415413i }, { -0.03032885730416518 + 0.033812881944702305i, 0.002720572464058824 + 0.003957561867487425i, 0.16396369615177148 + 3.324604317973129e-20i, 0.00048231963700262224 + -0.000738227131164958i, 0.004678941630656293 + -0.00019020177520370367i, -0.00027711851778302937 + -0.0007541858717185815i, -0.011813621356092199 + -0.01215339644491411i, -8.637377780848472e-05 + 8.726067306236081e-05i }, { -0.004831264982055713 + -0.0013299629571999708i, -0.01678856081959821 + 0.024452174109560944i, 0.00048231963700262224 + 0.0007382271311649581i, 0.1153556140128183 + -7.026485713331694e-21i, 0.0003350440479595549 + 0.0002377118095214182i, 0.0027067409203995786 + -0.0008100554151481299i, 3.9416074997579936e-06 + -7.752504660691941e-05i, -0.008664360967365035 + -0.006914928190914526i }, { -0.01010097084766369 + 0.010387425962948924i, -3.941607499757992e-06 + -7.752504660691936e-05i, 0.004678941630656293 + 0.0001902017752037033i, 0.0003350440479595549 + -0.0002377118095214182i, 0.12908107961201526 + -5.61159327555974e-21i, -0.00040290889894429454 + 0.000593583523425907i, -0.02803271549906535 + -0.03113882905806984i, -0.003807922676026216 + 0.0010797848749202394i }, { 8.637377780848467e-05 + 8.726067306236084e-05i, -0.007519487688015528 + 0.005989766272874852i, -0.0002771185177830293 + 0.0007541858717185815i, 0.0027067409203995786 + 0.0008100554151481299i, -0.00040290889894429454 + -0.0005935835234259071i, 0.09305025509543159 + -6.551270451419979e-21i, 0.0021451995702645504 + -0.003102363126629249i, -0.015658407404449792 + -0.022740455862730005i }, { -0.00033370383326550876 + -0.004685919158887456i, -0.00033501592997864745 + -0.0002458892035381938i, -0.011813621356092199 + 0.01215339644491411i, 3.941607499758003e-06 + 7.752504660691939e-05i, -0.02803271549906535 + 0.031138829058069837i, 0.0021451995702645504 + 0.003102363126629249i, 0.15106083483681285 + 3.451659260061274e-20i, 0.0004029088989442948 + -0.0005935835234259072i }, { 0.0008246467687633899 + -7.335283407863507e-06i, -0.00021821063287611928 + -0.0028680277274154135i, -8.637377780848472e-05 + -8.726067306236084e-05i, -0.008664360967365035 + 0.006914928190914526i, -0.003807922676026216 + -0.0010797848749202396i, -0.015658407404449792 + 0.022740455862730005i, 0.00040290889894429487 + 0.0005935835234259074i, 0.1073086050103624 + 5.293955920339377e-22i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, false, true, true, false, true}), ElementsAreArray({ DoubleNear(0.14013784198731208, 1.0e-7), DoubleNear(0.10004207329347724, 1.0e-7), DoubleNear(0.16396369615177148, 1.0e-7), DoubleNear(0.1153556140128183, 1.0e-7), DoubleNear(0.12908107961201526, 1.0e-7), DoubleNear(0.09305025509543159, 1.0e-7), DoubleNear(0.15106083483681285, 1.0e-7), DoubleNear(0.1073086050103624, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, false, true, false, true, true}), Matrix({ { 0.1426997268753084 + -1.4293680984916318e-20i, 2.439454888092385e-19 + -5.421010862427522e-20i, 0.006556766887376933 + 0.010995319726907309i, 2.710505431213761e-20 + 1.6940658945086007e-21i, -0.01028342816414652 + -0.010577286852379417i, -1.3552527156068805e-20 + -1.3552527156068805e-20i, 0.0003424996710220497 + -0.0012783653391631546i, 0.0 + -1.9058241313221758e-21i }, { 1.3552527156068805e-19 + 1.0842021724855044e-19i, 0.10107542150649541 + -5.232992709194219e-20i, 3.3881317890172014e-21 + 2.0328790734103208e-20i, 0.004644213351862611 + 0.007788077807373436i, 3.3881317890172014e-21 + -2.710505431213761e-20i, -0.007594275244533275 + -0.006055531276365409i, -8.470329472543003e-22 + -1.2705494208814505e-21i, 0.00011764991013341313 + -0.000863394724460732i }, { 0.006556766887376933 + -0.010995319726907309i, 0.0 + -2.710505431213761e-20i, 0.16140181126377512 + 9.052664623780335e-20i, 2.168404344971009e-19 + -5.421010862427522e-20i, -0.0012875055620888544 + 0.000306355010754194i, 8.470329472543003e-22 + 8.470329472543003e-22i, -0.01163116403960937 + -0.011963535555483617i, -3.3881317890172014e-20 + 0.0i }, { 1.3552527156068805e-20 + -2.371692252312041e-20i, 0.004644213351862613 + -0.007788077807373436i, 2.168404344971009e-19 + 1.6263032587282567e-19i, 0.11432226579980012 + 2.6648037023702063e-20i, -3.3881317890172014e-21 + 8.470329472543003e-22i, -0.000815533410646238 + 0.0003069156361294388i, -4.235164736271502e-21 + -2.0328790734103208e-20i, -0.00858957341084729 + -0.006849163187423969i }, { -0.01028342816414652 + 0.010577286852379417i, 6.776263578034403e-21 + 2.0328790734103208e-20i, -0.0012875055620888542 + -0.0003063550107541941i, -2.964615315390051e-21 + -2.329340604949326e-21i, 0.13145666714743917 + -3.525774642946025e-20i, 1.6263032587282567e-19 + -1.0842021724855044e-19i, 0.006040170791850349 + 0.010129017883704353i, 1.0164395367051604e-20 + 1.2705494208814505e-20i }, { -1.3552527156068805e-20 + 6.776263578034403e-21i, -0.007594275244533275 + 0.006055531276365409i, -1.4823076576950256e-21 + -8.470329472543003e-22i, -0.0008155334106462381 + -0.0003069156361294388i, 1.8973538018496328e-19 + 1.0842021724855044e-19i, 0.09401844788127481 + 1.028350937525924e-20i, -1.0164395367051604e-20 + 2.0328790734103208e-20i, 0.004319959535796304 + 0.007244322868154426i }, { 0.0003424996710220498 + 0.0012783653391631546i, 2.541098841762901e-21 + 8.470329472543003e-22i, -0.01163116403960937 + 0.011963535555483615i, 4.235164736271502e-21 + 6.776263578034403e-21i, 0.006040170791850348 + -0.010129017883704353i, 0.0 + -2.0328790734103208e-20i, 0.14868524730138893 + 6.416274575451325e-20i, 1.3552527156068805e-19 + -1.0842021724855044e-19i }, { -8.470329472543003e-22 + -4.235164736271502e-22i, 0.00011764991013341317 + 0.0008633947244607323i, -2.710505431213761e-20 + -6.776263578034403e-21i, -0.00858957341084729 + 0.006849163187423969i, 1.3552527156068805e-20 + -1.2705494208814505e-20i, 0.004319959535796304 + -0.007244322868154426i, 1.3552527156068805e-19 + 1.6263032587282567e-19i, 0.10634041222451919 + -1.6305384234645282e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, false, true, false, true, true}), ElementsAreArray({ DoubleNear(0.1426997268753084, 1.0e-7), DoubleNear(0.10107542150649541, 1.0e-7), DoubleNear(0.16140181126377512, 1.0e-7), DoubleNear(0.11432226579980012, 1.0e-7), DoubleNear(0.13145666714743917, 1.0e-7), DoubleNear(0.09401844788127481, 1.0e-7), DoubleNear(0.14868524730138893, 1.0e-7), DoubleNear(0.10634041222451919, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, false, false, true, true, true}), Matrix({ { 0.11270386806125647 + -2.9829580454734146e-20i, -0.02211358840012725 + -0.027340494049799186i, 0.005179196069682595 + 0.008684586563351289i, 0.0010949761729061927 + -0.0029575005843543974i, -0.008268421287997839 + -0.007684859752645712i, -0.0002589937142188384 + 0.0035455553733501084i, 0.00021235273068510524 + -0.0009903452950766614i, -0.0002843715860725902 + 0.0001420163735718346i }, { -0.022113588400127247 + 0.027340494049799186i, 0.13107128032054738 + -3.679402762212436e-20i, -0.0031189694394526055 + -0.000444145795175425i, 0.006021784169556948 + 0.010098810970929456i, 0.0034655431868174415 + -0.00046852832930207813i, -0.009609282120681954 + -0.008947958376099114i, 0.00019623947937847056 + 0.00024473467454219595i, 0.00024779685047035755 + -0.0011514147685472253i }, { 0.005179196069682597 + -0.008684586563351289i, -0.0031189694394526055 + 0.0004441457951754247i, 0.12747604721953285 + 5.4161098172981455e-20i, -0.02500382972363614 + -0.030924562004464067i, -0.000972151493919294 + 0.00028382666146507053i, 0.00026058796255210834 + 0.00018191569662370365i, -0.00935203724768138 + -0.008692332483178064i, -0.00029292075192278956 + 0.004008391512952761i }, { 0.0010949761729061927 + 0.0029575005843543974i, 0.006021784169556949 + -0.010098810970929456i, -0.025003829723636142 + 0.030924562004464067i, 0.14824802984404242 + 6.301358508852396e-20i, 0.0001226464955451001 + -0.00028963446865656845i, -0.0011308874788157983 + 0.00032944398541856224i, 0.00392013936423843 + -0.0005317288610497556i, -0.01086870020277528 + -0.010120366259729521i }, { -0.008268421287997839 + 0.007684859752645712i, 0.0034655431868174415 + 0.00046852832930207797i, -0.000972151493919294 + -0.0002838266614650706i, 0.00012264649554510004 + 0.0002896344686565685i, 0.10423443538593483 + -3.627683294412558e-20i, -0.020506588412357106 + -0.025282385264765013i, 0.004790186454091826 + 0.00803210713864622i, 0.0010111669944177677 + -0.0027385523850842423i }, { -0.0002589937142188384 + -0.003545555373350109i, -0.009609282120681954 + 0.008947958376099114i, 0.00026058796255210834 + -0.00018191569662370365i, -0.0011308874788157983 + -0.0003294439854185623i, -0.020506588412357106 + 0.02528238526476501i, 0.12124067964277915 + 1.130259588992457e-20i, -0.002885754744763781 + -0.0004141445882935691i, 0.005569943873554827 + 0.00934123361321256i }, { 0.00021235273068510532 + 0.0009903452950766616i, 0.00019623947937847058 + -0.000244734674542196i, -0.00935203724768138 + 0.008692332483178064i, 0.00392013936423843 + 0.0005317288610497553i, 0.004790186454091826 + -0.00803210713864622i, -0.002885754744763781 + 0.0004141445882935691i, 0.11789689932151201 + 2.4113969217145863e-20i, -0.02318453449115804 + -0.028596899656034833i }, { -0.0002843715860725902 + -0.00014201637357183456i, 0.00024779685047035766 + 0.0011514147685472253i, -0.00029292075192278967 + -0.004008391512952761i, -0.01086870020277528 + 0.010120366259729521i, 0.0010111669944177677 + 0.0027385523850842423i, 0.0055699438735548265 + -0.00934123361321256i, -0.023184534491158038 + 0.028596899656034833i, 0.1371287602043961 + 2.3743392302722106e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, false, false, true, true, true}), ElementsAreArray({ DoubleNear(0.11270386806125647, 1.0e-7), DoubleNear(0.13107128032054738, 1.0e-7), DoubleNear(0.12747604721953285, 1.0e-7), DoubleNear(0.14824802984404242, 1.0e-7), DoubleNear(0.10423443538593483, 1.0e-7), DoubleNear(0.12124067964277915, 1.0e-7), DoubleNear(0.11789689932151201, 1.0e-7), DoubleNear(0.1371287602043961, 1.0e-7) }));


}
}

}

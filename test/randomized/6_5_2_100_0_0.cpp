#include "gtest/gtest.h"
#include "gmock/gmock.h"
#include <chrono>
#include <iostream>

#include "superpositeur/Circuit.hpp"
#include "superpositeur/DefaultOperations.hpp"

namespace superpositeur {

using namespace std::complex_literals;

using testing::ElementsAreArray;
using testing::DoubleNear;

namespace {
Circuit randomCircuit() {

    Circuit c;
    c.addInstruction(CircuitInstruction({ Matrix({ { 0.3899378185481024 + -0.020114122172012493i, -0.3780688639560591 + -0.21922115453015847i }, { 0.15153053872412572 + 0.06331594576846875i, 0.15048364057070837 + 0.5122136069863502i } }), Matrix({ { -0.05505205163604038 + 0.02137180792036247i, -0.25867307025397707 + 0.07643060875321925i }, { -0.3676024388796269 + -0.019451720977377226i, -0.23829200382076954 + -0.1445770953379614i } }), Matrix({ { -0.3242194723431943 + 0.40261774362720576i, 0.11361541761589444 + 0.17032427155984634i }, { -0.3088618446792477 + -0.2126034311625619i, 0.4247930913717768 + -0.09046838794642212i } }), Matrix({ { 0.272407442211544 + 0.13639873181888515i, -0.19205453488208019 + -0.08673521151880395i }, { 0.0495922418120574 + -0.42248208327165643i, -0.06984560733160905 + -0.3061372780224998i } }) }, { QubitIndex{ 4 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { -0.03259695942453589 + -0.041090018387783006i, 0.2588212901537038 + 0.2932276850210526i }, { -0.05971260652149096 + 0.09668613258110954i, 0.032215470889988114 + 0.3888148944204801i } }), Matrix({ { 0.09042496011314739 + 0.2634710376813107i, 0.32252582152292153 + 0.09048567344212537i }, { -0.08088367129972622 + -0.10953569196281354i, 0.4116791624910352 + 0.1721875200494344i } }), Matrix({ { -0.2342489596954453 + 0.4448418954621981i, 0.1123624017573945 + -0.2610095350317089i }, { 0.2767610612770512 + -0.5888689413846118i, 0.1178105462301503 + 0.16172418596297042i } }), Matrix({ { -0.18865151294825083 + 0.07212809062663304i, -0.28501516504843477 + 0.3282994098865363i }, { 0.1839443296716553 + 0.3707475884643946i, 0.1480308477243315 + 0.22751431981982934i } }) }, { QubitIndex{ 1 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { -0.44971493707648813 + -0.23457239570850233i, 0.2769905682926828 + 0.2136445461119777i }, { -0.1614747461773946 + -0.04462126446396948i, -0.16440813783877675 + -0.18865059864277706i } }), Matrix({ { 0.27671924082982596 + -0.5332883415317692i, 0.10632585144719696 + -0.14472044421865787i }, { -0.2645912177582601 + -0.16059314456890822i, 0.33783459157496376 + -0.04245163603716019i } }), Matrix({ { 0.002140310723859798 + -0.1016082076693385i, 0.15251440739049327 + 0.10865275397406529i }, { -0.07400695462063513 + 0.21871272869449834i, 0.05815569646911618 + 0.6761559447104057i } }), Matrix({ { 0.3354182103790508 + -0.125029875923167i, 0.1584414160648126 + -0.1549734525923859i }, { 0.19931193070061762 + 0.16246311680543787i, -0.28277324904478096 + -0.20521556177521977i } }) }, { QubitIndex{ 0 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { -0.005043681853800663 + 0.019122339082952498i, -0.0031995135759981504 + 0.018856458680224186i, 0.08187404621796218 + -0.14474530092184304i, -0.05598023544753209 + -0.0849255524769167i }, { 0.05749691249311246 + 0.0676806966635388i, 0.01840209806422065 + -0.008722249131060698i, -0.07641818953919663 + -0.08545677925953664i, -0.08253035841186596 + -0.025452208202611258i }, { -0.01145462892918552 + -0.17976463175117186i, 0.05107335507539519 + 0.02466789591603242i, -0.017973807488906975 + 0.02851498434900805i, -0.0003105480981121354 + 0.1457291442221019i }, { 0.08831395085980362 + -0.10996177121987068i, 0.09079371628738699 + -0.06487270909627389i, -0.07157372791984594 + 0.0688355590635064i, -0.027445124363107545 + 0.11181151946762583i } }), Matrix({ { 0.1317952309697065 + 0.09153300051218484i, 0.026158611999984014 + -0.15788566269074616i, -0.03717132777333673 + 0.04670081082458656i, 0.1282915630796947 + -0.0693574654951662i }, { 0.08070389361064709 + -0.03273492087560069i, 0.05227590525566467 + 0.04484882624330374i, 0.013048416542575547 + -0.016956068502435046i, -0.09244543123470535 + -0.08430579854845144i }, { 0.07528998010370455 + -0.009535041948430918i, 0.09159195507579487 + -0.05974741406582685i, -0.08437758531888283 + -0.037883125688272574i, -0.027319845723547065 + 0.08015147923091354i }, { 0.04234147786081033 + 0.10421233238831004i, -0.02542253048351261 + -0.049453845140665385i, -0.021714747421678376 + -0.03201963737396134i, -0.02162887802446571 + -0.002058285601678192i } }), Matrix({ { -0.12833145651351693 + -0.008239954607822186i, 0.00433409780372473 + 0.04856658662874804i, -0.008681444000950273 + 0.14576578084433015i, -0.04021490952068048 + -0.008324704134460193i }, { -0.011511736998093457 + -0.0839542276940026i, 0.14767419822560843 + -0.007035721031808658i, -0.028921979093520993 + 0.005599722362770641i, -0.02028377842633585 + -0.06646055991093007i }, { -0.01789366345814842 + -0.1014727016117162i, 0.026775492480083006 + 0.022017650850851736i, -0.001956755379976388 + 0.07955205959690405i, 0.007301646306001132 + 0.025493397253179364i }, { -0.058335953310304584 + 0.041333804506422475i, -0.18702972622185463 + 0.1675252634041311i, -0.10222311967600776 + 0.22928099733561116i, -0.20664214315449855 + 0.08563686865332915i } }), Matrix({ { 0.08734221292124919 + -0.1792100836979167i, 0.037897572533650246 + -0.1130451147606522i, 0.097636137911288 + 0.06331047956385785i, 0.07042912745232277 + -0.11816907545592827i }, { 0.03735362784133167 + -0.037131958790922376i, -0.07799819742406548 + 0.14195186093296777i, -0.05160706482369795 + -0.09040408708098467i, -0.15185646757944896 + -0.05048781987054475i }, { 0.07086570980944061 + -0.013851216308043968i, -0.019858004755235 + 0.06755340536861144i, 0.11977134846212378 + 0.040168819240082115i, -0.1865153176036957 + -0.015591553815178934i }, { 0.028870285114087332 + 0.19674290372546985i, 0.03098955093164288 + -0.0992841013707146i, -0.010893750189715173 + 0.03621780219337183i, -0.09322584952340049 + 0.08217748771256204i } }), Matrix({ { -0.11627201374857263 + 0.028366248346932417i, 0.016025881430683685 + 0.11245271385760613i, -0.016389206188531347 + -0.1487776431755351i, -0.020140119876105384 + -0.05168695761975698i }, { -0.06727420936180138 + 0.017335111354324917i, 0.05285578491503947 + -0.10501364851241236i, 0.13401249238270505 + -0.08664791102013467i, 0.17985364173287735 + -0.11701329790966095i }, { -0.04335606225400488 + 0.050422116089352854i, 0.09715031472890694 + 0.04740180107257482i, -0.010873513218732032 + 0.04026473016864015i, -0.0615497991510239 + 0.06458166344506415i }, { -0.03939421284050356 + -0.05541922824496323i, -0.0442819725580906 + -0.15286590308934392i, -0.1997155240289537 + -0.004306312873709585i, -0.04995735346398017 + 0.1331689783385639i } }), Matrix({ { -0.2049165331731551 + 0.1801878702287054i, 0.002901633145765357 + 0.05957198611909263i, -0.14791604250864634 + 0.06974793669251701i, 0.09776215290210453 + -0.13425307449653512i }, { -0.14832397398637365 + 0.0009028841429197722i, -0.03042714579168557 + 0.14427056988850184i, -0.13916263108100832 + -0.04155939313738209i, 0.07615008332554932 + -0.06221122281006954i }, { 0.006775519506688981 + -0.05293545722854584i, 0.03996180545955481 + 0.05787555416827216i, 0.05948777353106765 + 0.10105018599780492i, 0.011522125566921901 + 0.06461709618410928i }, { -0.00802563032965427 + -0.00856573167383066i, 0.07904278810175114 + 0.12398746830973927i, 0.01851700667318345 + 0.006538203631513336i, 0.21618006551300242 + 0.06215482669145819i } }), Matrix({ { -0.02515759822073592 + -0.038379297690432905i, 0.00819214979480818 + 0.00807643979649093i, -0.03926557912224385 + -0.03680958099733329i, 0.020640380638508423 + -0.10156406735406855i }, { 0.04799450429611127 + 0.20202993507773825i, -0.001344570007954254 + -0.013946179687258585i, -0.20278711321550288 + 0.0900031135483546i, 0.015114302221060116 + 0.017318726328216356i }, { -0.1317221856705198 + -0.19932596653025142i, 0.04412520671870906 + -0.013200529346136433i, -0.08186004413948443 + 0.016589684322072668i, 0.018828517106958063 + 0.12365835152127866i }, { 0.09912161353816433 + 0.16800723733234674i, 0.060101150082740445 + -0.33486536148198676i, -0.14046939715127954 + 0.037399551495938085i, 0.0052046493013942876 + -0.006955984737162343i } }), Matrix({ { 0.055612159567435045 + 0.05811737995180538i, 0.10288631691986769 + -0.06887967816946376i, 0.04760152486996157 + 0.020264335403047326i, 0.0816117608021902 + -0.06074217088836748i }, { 0.16087866462544193 + -0.04830343119164863i, -0.08263654110638233 + 0.033984174943171186i, 0.0641829328827503 + -0.04721704861963894i, -0.14315395123039118 + 0.0907061850814295i }, { 0.10516876974718377 + 0.024939017719623358i, -0.09907615571963345 + -0.06012484062318808i, -0.000821894346269753 + -0.0978301287023577i, 0.15996137246291958 + -0.13444504582492445i }, { 0.006372577055446084 + -0.0417477893859922i, 0.01484113075247556 + -0.027870529398166366i, -0.042924570824043266 + 0.053827557952179785i, -0.0016343524015650656 + 0.013279317334419411i } }), Matrix({ { 0.007934284056874342 + 0.05837565037741056i, 0.027325076294475083 + -0.13345638603481333i, 0.013921218602030511 + 0.09147841712060845i, 0.055582086224827396 + 0.11762577179335126i }, { 0.09254121982795492 + 0.1005144457401458i, 0.11422526857936503 + 0.00861738345849487i, 0.07112848410453179 + -0.08829707290444652i, -0.027439081892701687 + -0.06610992835749495i }, { -0.10366733112121636 + 0.09156886779121051i, 0.0019843304176710703 + 0.054185642231915875i, 0.10959878010650019 + 0.0690231144152116i, -0.03436169094358136 + -0.056042737867685335i }, { -0.08758564581631151 + 0.09830438578451113i, -0.03042732609804894 + -0.00995766233687596i, 0.09121859753147397 + -0.03690013006092139i, 0.12539917829587036 + 0.1258432432664614i } }), Matrix({ { -0.01907465521713687 + -0.05503619834366396i, 0.2081635163168806 + 0.16587507302456334i, -0.012114824432379226 + 0.026247935069720087i, 0.03424578022826525 + -0.03706511002250929i }, { 0.022716899138428077 + 0.06722941199901664i, 0.05099590824162986 + -0.08438833801602368i, 0.10318828997964287 + -0.11326879426210498i, -0.14070973647184556 + 0.07826597757752732i }, { 0.06817056594163684 + 0.05558990475520998i, -0.1576567088909223 + 0.13832640461072998i, -0.08191494681755955 + 0.05578101603450608i, 0.061722889592301954 + -0.10329004761657182i }, { 0.1447540705487954 + 0.01071706266251843i, 0.07906591054222978 + -0.006841785316154404i, -0.11426206247617135 + -0.09938312884012128i, -0.10757706904578151 + -0.03652553660927851i } }), Matrix({ { -0.021538338584620245 + 0.01383362040285228i, 0.07214713814581619 + -0.006030612195894841i, 0.06798890492862997 + 0.11396203036715546i, -0.017012170021772136 + -0.14444236547455377i }, { -0.04151748194259954 + -0.06377495445097597i, -0.011687283724189467 + -0.1262969589679705i, 0.07875343622266634 + -0.032140878092188525i, 0.019659324976537853 + -0.08862462169883106i }, { 0.13832764827752705 + -0.06326329433236981i, 0.05210805617824076 + 0.15975831626001222i, -0.05825990046637163 + 0.07386919150691894i, 0.03650103288033774 + -0.14423462193560316i }, { -0.038142316475365944 + -0.06608260703183759i, 0.18149844676451657 + -0.0662544806497276i, 0.08206678231031188 + 0.08321181079407898i, -0.020779966992500256 + 0.03501643974779594i } }), Matrix({ { -0.0911032227667576 + 0.051534529888502385i, -0.031598962522126975 + -0.006302420533641823i, 0.07273186931775491 + -0.1447482046951292i, -0.03678377924099999 + -0.024589242608617i }, { 0.06249428896632717 + 0.016820648655649032i, 0.029690189793413327 + -0.010339628699659844i, 0.13727071177921485 + 0.10609849775192998i, -0.09738453667498972 + -0.13278222252668395i }, { -0.0594214561192975 + 0.04494999177850297i, -0.040206349115509285 + -0.09252915979435473i, 0.04104063884351313 + 0.016835328389408773i, -0.13512171439651857 + -0.09518102453676429i }, { -0.037049550237689424 + -0.06656347749880716i, -0.1626545613425995 + -0.011376775684312257i, 0.11295753499547943 + 0.0025512099838474124i, -0.0824808015056313 + 0.04631300588908096i } }), Matrix({ { 0.08034896828668285 + -0.10424498722792618i, -0.12485654702474784 + 0.015209130274249014i, 0.0987908852232741 + 0.04247632658100341i, -0.0036675243700861324 + 0.00380541866904369i }, { -0.007899043723751935 + -0.050021388167332294i, 0.10178949830894596 + -0.12082553106940865i, -0.02407103031238628 + 0.04731017002548871i, -0.1263851819184202 + -0.07590444743801802i }, { 0.22291781619059536 + -0.02280364366956766i, 0.05744447522993866 + -0.019112679896199365i, -0.013594334414555376 + -0.19184954484473637i, 0.07078956088081961 + -0.05464427547671733i }, { -0.0592397112759002 + -0.028157004162019345i, 0.012173090953141508 + -0.005874008358361725i, -0.13756512263678916 + 0.09250044890672852i, 0.003244835435519405 + -0.12408897346563928i } }), Matrix({ { 0.07316516610786115 + 0.1017693495975077i, -0.08795732815785602 + 0.05209089926028611i, 0.10108454777178312 + -0.10134223609983314i, 0.04933371843810018 + 0.29224972735725563i }, { -0.11434292503129065 + -0.022776912308218926i, 0.012668185940791872 + -0.04019947374292648i, 0.03362989046169619 + 0.1254359505246155i, -0.031030160283205755 + -0.1054876721672728i }, { -0.05262552175643378 + -0.014799284782175598i, -0.07691634957616797 + 0.030728385710447063i, 0.14632340480788547 + -0.022257008509020473i, -0.053783396668091156 + -0.0292767817306504i }, { -0.033628586012666356 + 0.02376076191981038i, -0.11542513304488612 + 0.16795088310283582i, -0.08796143931582451 + -0.02854151613606438i, 0.006987763192447037 + -0.11273072516156372i } }), Matrix({ { 0.12168424281369834 + -0.08089525495239633i, 0.13646068710329978 + 0.04995275630103627i, 0.1542130462189722 + -0.07206828936508328i, 0.014233029603069635 + -0.03067751120645884i }, { 0.13407830829683676 + 0.06036737468870988i, -0.059359052733453106 + 0.15650814597974874i, 0.03165770751834115 + 0.12245917035391198i, 0.03217428584138777 + -0.00671694658847851i }, { 0.10981253775601144 + -0.168003845946758i, 0.035780257348828795 + -0.007049926380636083i, 0.006794823559218089 + 0.07050278726440576i, 0.05468893612482038 + 0.04836189728884385i }, { 0.023691904295027422 + -0.00443215788194006i, 0.09386895187563385 + -0.01377944273830667i, -0.19049427328068427 + 0.1473516563857487i, 0.13550100030099854 + 0.03592940724762617i } }), Matrix({ { 0.09587786501195746 + 0.05703922382491462i, -0.004200604392748905 + -0.14898058394334268i, -0.16982466814195663 + 0.09879185520989828i, 0.011957850066270058 + 0.1018636803799386i }, { -0.17182263432009864 + -0.11814943777485391i, -0.048729018133965206 + -0.06973269303114599i, 0.007646200329751248 + 0.06529699316235305i, -0.011785177738095622 + 0.0421395787486982i }, { 0.10002118540359073 + 0.040075523537143165i, 0.11884920031496653 + -0.0658535636351969i, 0.12782182095347053 + 0.05357692704336974i, 0.08553585157045482 + 0.12209369603777952i }, { 0.09120976457847471 + -0.13762778010594215i, 0.05354722639274878 + 0.11922898707373725i, -0.032729047500526895 + -0.06738327036907482i, 0.01715133342347788 + -0.12421968858762118i } }) }, { QubitIndex{ 3 }, QubitIndex{ 5 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { 0.09378400001633835 + 0.5393781169096301i, -0.0208168212480815 + -0.29863119715477043i }, { -0.011949915884848838 + -0.38888090379076207i, -0.1092322696670318 + -0.571463447665286i } }), Matrix({ { -0.16818225789044525 + 0.3080115898568328i, 0.1873005972537034 + 0.25495294971709814i }, { -0.19791012352035633 + 0.023866554334030995i, 0.39352044634475203 + 0.08252680622566233i } }), Matrix({ { -0.14983827089543816 + -0.03481794081703001i, 0.10605827558092841 + 0.04906600238353587i }, { 0.07281684673097719 + 0.32197003320547574i, -0.45684726711790596 + 0.16795754889375025i } }), Matrix({ { -0.3288713718868336 + -0.05714915384698542i, -0.09662697839470402 + -0.11087922723687446i }, { -0.04960246878071645 + 0.3734924469586377i, 0.046229646408571995 + -0.18918039338342746i } }) }, { QubitIndex{ 2 } }));


    return c;
}

TEST(RandomizedIntegrationTests, 6_5_2_100_0_0) {
    auto c = randomCircuit();
    
    auto s = c.execute();

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, false, false}), Matrix({ { 0.7567043814402942 + 0.0i, 0.1196681945724714 + 0.13099186062473456i }, { 0.1196681945724714 + -0.13099186062473456i, 0.24329561855970608 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.7567043814402942, 1.0e-7), DoubleNear(0.24329561855970608, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, false, false}), Matrix({ { 0.37389335435507154 + 0.0i, -0.3729443979125022 + 0.06258214674734822i }, { -0.3729443979125022 + -0.06258214674734822i, 0.6261066456449287 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, false, false}), ElementsAreArray({ DoubleNear(0.37389335435507154, 1.0e-7), DoubleNear(0.6261066456449287, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, false, false}), Matrix({ { 0.5579668044751327 + 0.0i, -0.1973914430447278 + 0.14445441569785397i }, { -0.1973914430447278 + -0.14445441569785397i, 0.44203319552486753 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, false, false}), ElementsAreArray({ DoubleNear(0.5579668044751327, 1.0e-7), DoubleNear(0.44203319552486753, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, false, false}), Matrix({ { 0.5036157626821858 + 0.0i, 0.13913546506671004 + -0.05693709468643093i }, { 0.13913546506671004 + 0.05693709468643093i, 0.49638423731781445 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, false, false}), ElementsAreArray({ DoubleNear(0.5036157626821858, 1.0e-7), DoubleNear(0.49638423731781445, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, true, false}), Matrix({ { 0.5159733051519231 + 0.0i, 0.0480598789850505 + -0.10809622009512024i }, { 0.0480598789850505 + 0.10809622009512024i, 0.4840266948480772 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, true, false}), ElementsAreArray({ DoubleNear(0.5159733051519231, 1.0e-7), DoubleNear(0.4840266948480772, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, true}), Matrix({ { 0.5558078283666934 + 0.0i, 0.028532252385820116 + -0.0178241985845341i }, { 0.028532252385820116 + 0.0178241985845341i, 0.4441921716333068 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, true}), ElementsAreArray({ DoubleNear(0.5558078283666934, 1.0e-7), DoubleNear(0.4441921716333068, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, true, false, false, false, false}), Matrix({ { 0.28292673943189106 + 0.0i, 0.044743142678316694 + 0.048976986162194015i, -0.28220865993400285 + 0.04735618464365785i, -0.05282733461843183 + -0.0413635880784054i }, { 0.044743142678316694 + -0.048976986162194015i, 0.09096661492318048 + 0.0i, -0.03643183092978118 + 0.05634177310585465i, -0.09073573797849935 + 0.01522596210369038i }, { -0.28220865993400285 + -0.04735618464365785i, -0.03643183092978118 + -0.05634177310585465i, 0.4737776420084031 + 0.0i, 0.07492505189415472 + 0.08201487446254055i }, { -0.05282733461843183 + 0.0413635880784054i, -0.09073573797849935 + -0.01522596210369038i, 0.07492505189415472 + -0.08201487446254055i, 0.15232900363652557 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, true, false, false, false, false}), ElementsAreArray({ DoubleNear(0.28292673943189106, 1.0e-7), DoubleNear(0.09096661492318048, 1.0e-7), DoubleNear(0.4737776420084031, 1.0e-7), DoubleNear(0.15232900363652557, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, true, false, false, false}), Matrix({ { 0.4222159256445727 + 0.0i, 0.06677088012291027 + 0.07308910988503509i, -0.14936696981076775 + 0.10930928927696368i, -0.04254383030093814 + -0.008570073271246755i }, { 0.06677088012291027 + -0.07308910988503509i, 0.13575087883055995 + 0.0i, -0.004699124925496636 + 0.04314327152041366i, -0.048024473233960016 + 0.03514512642089028i }, { -0.14936696981076775 + -0.10930928927696368i, -0.004699124925496636 + -0.04314327152041366i, 0.3344884557957214 + 0.0i, 0.05289731444956114 + 0.057902750739699485i }, { -0.04254383030093814 + 0.008570073271246755i, -0.048024473233960016 + -0.03514512642089028i, 0.05289731444956114 + -0.057902750739699485i, 0.10754473972914613 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, true, false, false, false}), ElementsAreArray({ DoubleNear(0.4222159256445727, 1.0e-7), DoubleNear(0.13575087883055995, 1.0e-7), DoubleNear(0.3344884557957214, 1.0e-7), DoubleNear(0.10754473972914613, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, true, false, false}), Matrix({ { 0.3810882541840053 + 0.0i, 0.06026678907841537 + 0.06596956579368426i, 0.10528441602971245 + -0.04308454901570316i, 0.024108385877076623 + 0.011412054122649059i }, { 0.06026678907841537 + -0.06596956579368426i, 0.12252750849818049 + 0.0i, 0.009191793933992077 + -0.025039172773303142i, 0.03385104903699758 + -0.013852545670727762i }, { 0.10528441602971245 + 0.04308454901570316i, 0.009191793933992077 + 0.025039172773303142i, 0.3756161272562889 + 0.0i, 0.05940140549405602 + 0.0650222948310503i }, { 0.024108385877076623 + -0.011412054122649059i, 0.03385104903699758 + 0.013852545670727762i, 0.05940140549405602 + -0.0650222948310503i, 0.12076811006152557 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, true, false, false}), ElementsAreArray({ DoubleNear(0.3810882541840053, 1.0e-7), DoubleNear(0.12252750849818049, 1.0e-7), DoubleNear(0.3756161272562889, 1.0e-7), DoubleNear(0.12076811006152557, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, true, false}), Matrix({ { 0.39043926071469 + 0.0i, 0.06174559387512147 + 0.06758830327454432i, 0.036367120999478024 + -0.08179688336311183i, 0.01991096394627307 + -0.006640226529240197i }, { 0.06174559387512147 + -0.06758830327454432i, 0.12553404443723304 + 0.0i, -0.008408486047248165 + -0.019231132468542883i, 0.011692757985572476 + -0.026299336732008398i }, { 0.036367120999478024 + 0.08179688336311183i, -0.008408486047248165 + 0.019231132468542883i, 0.36626512072560424 + 0.0i, 0.05792260069734993 + 0.06340355735019024i }, { 0.01991096394627307 + 0.006640226529240197i, 0.011692757985572476 + 0.026299336732008398i, 0.05792260069734993 + -0.06340355735019024i, 0.11776157412247301 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, true, false}), ElementsAreArray({ DoubleNear(0.39043926071469, 1.0e-7), DoubleNear(0.12553404443723304, 1.0e-7), DoubleNear(0.36626512072560424, 1.0e-7), DoubleNear(0.11776157412247301, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, false, true}), Matrix({ { 0.4205822189638918 + 0.0i, 0.06651251934988824 + 0.07280630158754628i, 0.021590480392710363 + -0.013487649164578841i, 0.005749228066830064 + 0.001604503163520702i }, { 0.06651251934988824 + -0.07280630158754628i, 0.1352256094028016 + 0.0i, 0.0010795781933643006 + -0.005870482492145494i, 0.006941771993109752 + -0.004336549419955261i }, { 0.021590480392710363 + 0.013487649164578841i, 0.0010795781933643006 + 0.005870482492145494i, 0.33612216247640236 + 0.0i, 0.05315567522258316 + 0.05818555903718829i }, { 0.005749228066830064 + -0.001604503163520702i, 0.006941771993109752 + 0.004336549419955261i, 0.05315567522258316 + -0.05818555903718829i, 0.10807000915690448 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, false, true}), ElementsAreArray({ DoubleNear(0.4205822189638918, 1.0e-7), DoubleNear(0.1352256094028016, 1.0e-7), DoubleNear(0.33612216247640236, 1.0e-7), DoubleNear(0.10807000915690448, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, true, false, false, false}), Matrix({ { 0.20862008014398764 + 0.0i, -0.20809059395014115 + 0.034918760437811704i, -0.07380334876098132 + 0.05401054603667251i, 0.06457576543789043 + -0.06622664534353442i }, { -0.20809059395014115 + -0.034918760437811704i, 0.349346724331145 + 0.0i, 0.08265630032090149 + -0.04152028483294246i, -0.12358809428374648 + 0.09044386966118145i }, { -0.07380334876098132 + -0.05401054603667251i, 0.08265630032090149 + 0.04152028483294246i, 0.16527327421108387 + 0.0i, -0.16485380396236105 + 0.027663386309536533i }, { 0.06457576543789043 + 0.06622664534353442i, -0.12358809428374648 + -0.09044386966118145i, -0.16485380396236105 + -0.027663386309536533i, 0.2767599213137837 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, true, false, false, false}), ElementsAreArray({ DoubleNear(0.20862008014398764, 1.0e-7), DoubleNear(0.349346724331145, 1.0e-7), DoubleNear(0.16527327421108387, 1.0e-7), DoubleNear(0.2767599213137837, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, true, false, false}), Matrix({ { 0.18829858681533007 + 0.0i, -0.18782067739275332 + 0.031517355564454244i, 0.05202182574354507 + -0.021288401319541975i, -0.04832654663254625 + 0.02994176658928349i }, { -0.18782067739275332 + -0.031517355564454244i, 0.3153171758668557 + 0.0i, -0.05545303786261402 + 0.012526974404152716i, 0.08711363932316495 + -0.03564869336688895i }, { 0.05202182574354507 + 0.021288401319541975i, -0.05545303786261402 + -0.012526974404152716i, 0.18559476753974147 + 0.0i, -0.18512372051974887 + 0.031064791182893986i }, { -0.04832654663254625 + -0.02994176658928349i, 0.08711363932316495 + 0.03564869336688895i, -0.18512372051974887 + -0.031064791182893986i, 0.310789469778073 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, true, false, false}), ElementsAreArray({ DoubleNear(0.18829858681533007, 1.0e-7), DoubleNear(0.3153171758668557, 1.0e-7), DoubleNear(0.18559476753974147, 1.0e-7), DoubleNear(0.310789469778073, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, true, false}), Matrix({ { 0.19291898982092537 + 0.0i, -0.1924293536288077 + 0.03229071710073193i, 0.01796926936361934 + -0.040416458324468586i, -0.011158769123000909 + 0.04332157011929416i }, { -0.1924293536288077 + -0.03229071710073193i, 0.32305431533099765 + 0.0i, -0.024688556140653843 + 0.0373061893206897i, 0.03009060962143116 + -0.06767976177065166i }, { 0.01796926936361934 + 0.040416458324468586i, -0.024688556140653843 + -0.0373061893206897i, 0.18097436453414617 + 0.0i, -0.18051504428369453 + 0.030291429646616297i }, { -0.011158769123000909 + -0.04332157011929416i, 0.03009060962143116 + 0.06767976177065166i, -0.18051504428369453 + -0.030291429646616297i, 0.3030523303139311 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, true, false}), ElementsAreArray({ DoubleNear(0.19291898982092537, 1.0e-7), DoubleNear(0.32305431533099765, 1.0e-7), DoubleNear(0.18097436453414617, 1.0e-7), DoubleNear(0.3030523303139311, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, false, true}), Matrix({ { 0.20781285332483085 + 0.0i, -0.2072854159052718 + 0.03478364707816933i, 0.010668019551839774 + -0.006664349397462373i, -0.009525467075646046 + 0.008433044615223715i }, { -0.2072854159052718 + -0.03478364707816933i, 0.3479949750418626 + 0.0i, -0.011756420298588425 + 0.004861825403540173i, 0.017864232833980344 + -0.011159849187071729i }, { 0.010668019551839774 + 0.006664349397462373i, -0.011756420298588425 + -0.004861825403540173i, 0.1660805010302407 + 0.0i, -0.16565898200723042 + 0.02779849966917889i }, { -0.009525467075646046 + -0.008433044615223715i, 0.017864232833980344 + 0.011159849187071729i, -0.16565898200723042 + -0.02779849966917889i, 0.27811167060306613 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, false, true}), ElementsAreArray({ DoubleNear(0.20781285332483085, 1.0e-7), DoubleNear(0.3479949750418626, 1.0e-7), DoubleNear(0.1660805010302407, 1.0e-7), DoubleNear(0.27811167060306613, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, true, false, false}), Matrix({ { 0.28100087778708593 + 0.0i, -0.0994094421359078 + 0.07274952073448422i, 0.07763297083243362 + -0.031769008778285916i, -0.019239335483755435 + 0.031337627591989665i }, { -0.0994094421359078 + -0.07274952073448422i, 0.2226148848950999 + 0.0i, -0.03568896497267896 + -0.008859837026131863i, 0.061502494234276395 + -0.025168085908145017i }, { 0.07763297083243362 + 0.031769008778285916i, -0.03568896497267896 + 0.008859837026131863i, 0.27696592668804676 + 0.0i, -0.09798200090882 + 0.07170489496336975i }, { -0.019239335483755435 + -0.031337627591989665i, 0.061502494234276395 + 0.025168085908145017i, -0.09798200090882 + -0.07170489496336975i, 0.2194183106297677 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, true, false, false}), ElementsAreArray({ DoubleNear(0.28100087778708593, 1.0e-7), DoubleNear(0.2226148848950999, 1.0e-7), DoubleNear(0.27696592668804676, 1.0e-7), DoubleNear(0.2194183106297677, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, true, false}), Matrix({ { 0.2878959762700909 + 0.0i, -0.10184871527649575 + 0.07453462231141153i, 0.026815817100750206 + -0.060314102502314844i, 0.006128367447573108 + 0.02827973060955132i }, { -0.10184871527649575 + -0.07453462231141153i, 0.2280773288818321 + 0.0i, -0.025101585178401314 + 0.014394807134961243i, 0.021244061884300294 + -0.047782117592805394i }, { 0.026815817100750206 + 0.060314102502314844i, -0.025101585178401314 + -0.014394807134961243i, 0.27007082820504175 + 0.0i, -0.09554272776823206 + 0.06991979338644244i }, { 0.006128367447573108 + -0.02827973060955132i, 0.021244061884300294 + 0.047782117592805394i, -0.09554272776823206 + -0.06991979338644244i, 0.21395586664303545 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, true, false}), ElementsAreArray({ DoubleNear(0.2878959762700909, 1.0e-7), DoubleNear(0.2280773288818321, 1.0e-7), DoubleNear(0.27007082820504175, 1.0e-7), DoubleNear(0.21395586664303545, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, false, true}), Matrix({ { 0.31012231789602684 + 0.0i, -0.10971170929685797 + 0.08028889508700378i, 0.015920049688194025 + -0.009945311126542674i, -0.003057238279942019 + 0.007639954126654324i }, { -0.10971170929685797 + -0.08028889508700378i, 0.24568551047066656 + 0.0i, -0.008206806663564797 + -0.0006032655672203631i, 0.012612202697626092 + -0.007878887457991429i }, { 0.015920049688194025 + 0.009945311126542674i, -0.008206806663564797 + 0.0006032655672203631i, 0.2478444865791058 + 0.0i, -0.08767973374786983 + 0.0641655206108502i }, { -0.003057238279942019 + -0.007639954126654324i, 0.012612202697626092 + 0.007878887457991429i, -0.08767973374786983 + -0.0641655206108502i, 0.196347685054201 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, false, true}), ElementsAreArray({ DoubleNear(0.31012231789602684, 1.0e-7), DoubleNear(0.24568551047066656, 1.0e-7), DoubleNear(0.2478444865791058, 1.0e-7), DoubleNear(0.196347685054201, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, true, false}), Matrix({ { 0.2598522895977338 + 0.0i, 0.07179018577432028 + -0.029378020931105753i, 0.024203712609469755 + -0.054438960326265384i, 0.0005321488948336662 + -0.017776407735278228i }, { 0.07179018577432028 + 0.029378020931105753i, 0.2561210155541892 + 0.0i, 0.01284151833243594 + -0.012303627974497763i, 0.023856166375580745 + -0.053657259768854854i }, { 0.024203712609469755 + 0.054438960326265384i, 0.01284151833243594 + 0.012303627974497763i, 0.24376347308445195 + 0.0i, 0.06734527929238975 + -0.027559073755325174i }, { 0.0005321488948336662 + 0.017776407735278228i, 0.023856166375580745 + 0.053657259768854854i, 0.06734527929238975 + 0.027559073755325174i, 0.24026322176362525 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, true, false}), ElementsAreArray({ DoubleNear(0.2598522895977338, 1.0e-7), DoubleNear(0.2561210155541892, 1.0e-7), DoubleNear(0.24376347308445195, 1.0e-7), DoubleNear(0.24026322176362525, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, false, true}), Matrix({ { 0.2650842687276781 + 0.0i, 0.08908044655549086 + -0.03771152281227168i, 0.036547657983430744 + -0.026495498328736447i, -0.017109428695580613 + -0.036227457323653955i }, { 0.08908044655549086 + 0.03771152281227168i, 0.29072355963901536 + 0.0i, -0.034063772953084465 + 0.043688556843714726i, -0.00801540559761063 + 0.008671299744202342i }, { 0.036547657983430744 + 0.026495498328736447i, -0.034063772953084465 + -0.043688556843714726i, 0.23853149395450773 + 0.0i, 0.05005501851121918 + -0.01922557187415925i }, { -0.017109428695580613 + 0.036227457323653955i, -0.00801540559761063 + -0.008671299744202342i, 0.05005501851121918 + 0.01922557187415925i, 0.2056606776787991 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, false, true}), ElementsAreArray({ DoubleNear(0.2650842687276781, 1.0e-7), DoubleNear(0.29072355963901536, 1.0e-7), DoubleNear(0.23853149395450773, 1.0e-7), DoubleNear(0.2056606776787991, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, true, true}), Matrix({ { 0.2867820022316755 + 0.0i, 0.026712056970246995 + -0.06008072534571689i, 0.014721880566940442 + -0.009196810655346286i, -0.0005554718963794959 + -0.003940857460685348i }, { 0.026712056970246995 + 0.06008072534571689i, 0.2690258261350179 + 0.0i, 0.003297985090046361 + 0.0022275998067289127i, 0.013810371818879674 + -0.008627387929187817i }, { 0.014721880566940442 + 0.009196810655346286i, 0.003297985090046361 + -0.0022275998067289127i, 0.22919130292024753 + 0.0i, 0.0213478220148035 + -0.04801549474940335i }, { -0.0005554718963794959 + 0.003940857460685348i, 0.013810371818879674 + 0.008627387929187817i, 0.0213478220148035 + 0.04801549474940335i, 0.2150008687130593 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, true, true}), ElementsAreArray({ DoubleNear(0.2867820022316755, 1.0e-7), DoubleNear(0.2690258261350179, 1.0e-7), DoubleNear(0.22919130292024753, 1.0e-7), DoubleNear(0.2150008687130593, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, true, true, false, false, false}), Matrix({ { 0.15786372870138074 + 0.0i, 0.024965188342395292 + 0.02732753246174218i, -0.15746306417858494 + 0.026423179017756114i, -0.02947589908598495 + -0.023079509061733547i, -0.05584731737240066 + 0.0408700168299328i, -0.01590685541833069 + -0.0032042934424551892i, 0.04886476464171238 + -0.050113992699544946i, 0.01640281675957173 + 0.0005336765851235581i }, { 0.024965188342395292 + -0.02732753246174218i, 0.050756351442606915 + 0.0i, -0.0203277522850683 + 0.03143683909833668i, -0.0506275297715562 + 0.008495581420055588i, -0.001756971580927463 + 0.01613098250661909i, -0.017956031388580658 + 0.013140529206739714i, -0.0009474862333962417 + -0.016384122746827823i, 0.015711000796178036 + -0.01611265264398948i }, { -0.15746306417858494 + -0.026423179017756114i, -0.0203277522850683 + -0.03143683909833668i, 0.264352196943192 + 0.0i, 0.04180569178051498 + 0.045761577423292905i, 0.06254638460647094 + -0.031418581451736545i, 0.015330149593378344 + 0.005858645047298739i, -0.09351965243836712 + 0.06843927244703088i, -0.02663697488260745 + -0.005365779828791567i }, { -0.02947589908598495 + 0.023079509061733547i, -0.0506275297715562 + -0.008495581420055588i, 0.04180569178051498 + -0.045761577423292905i, 0.08499452738795302 + 0.0i, 0.004452510865506191 + -0.015795960095484722i, 0.020109915714430555 + -0.010101703381205914i, -0.002942153344569172 + 0.02701228901379457i, -0.030068441845379365 + 0.022004597214150573i }, { -0.05584731737240066 + -0.0408700168299328i, -0.001756971580927463 + -0.01613098250661909i, 0.06254638460647094 + 0.031418581451736545i, 0.004452510865506191 + 0.015795960095484722i, 0.12506301073051035 + 0.0i, 0.019777954335921406 + 0.021649453700451834i, -0.12474559575541791 + 0.020933005625901738i, -0.023351435532446875 + -0.018284079016671853i }, { -0.01590685541833069 + 0.0032042934424551892i, -0.017956031388580658 + -0.013140529206739714i, 0.015330149593378344 + -0.005858645047298739i, 0.020109915714430555 + 0.010101703381205914i, 0.019777954335921406 + -0.021649453700451834i, 0.04021026348057356 + 0.0i, -0.016104078644712878 + 0.02490493400751797i, -0.04010820820694314 + 0.006730380683634792i }, { 0.04886476464171238 + 0.050113992699544946i, -0.0009474862333962417 + 0.016384122746827823i, -0.09351965243836712 + -0.06843927244703088i, -0.002942153344569172 + -0.02701228901379457i, -0.12474559575541791 + -0.020933005625901738i, -0.016104078644712878 + -0.02490493400751797i, 0.20942544506521113 + 0.0i, 0.03311936011363974 + 0.03625329703924765i }, { 0.01640281675957173 + -0.0005336765851235581i, 0.015711000796178036 + 0.01611265264398948i, -0.02663697488260745 + 0.005365779828791567i, -0.030068441845379365 + -0.022004597214150573i, -0.023351435532446875 + 0.018284079016671853i, -0.04010820820694314 + -0.006730380683634792i, 0.03311936011363974 + -0.03625329703924765i, 0.06733447624857256 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, true, true, false, false, false}), ElementsAreArray({ DoubleNear(0.15786372870138074, 1.0e-7), DoubleNear(0.050756351442606915, 1.0e-7), DoubleNear(0.264352196943192, 1.0e-7), DoubleNear(0.08499452738795302, 1.0e-7), DoubleNear(0.12506301073051035, 1.0e-7), DoubleNear(0.04021026348057356, 1.0e-7), DoubleNear(0.20942544506521113, 1.0e-7), DoubleNear(0.06733447624857256, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, true, false, true, false, false}), Matrix({ { 0.14248636566217582 + 0.0i, 0.022533351924738314 + 0.02466558223994819i, -0.14212472950818042 + 0.023849321047034154i, -0.02660467841432857 + -0.0208313549573779i, 0.03936514347066404 + -0.01610902655235675i, 0.009013965263666612 + 0.004266891195998879i, -0.03656890957672644 + 0.022657065966173427i, -0.009705278301360913 + -0.0027473071109153334i }, { 0.022533351924738314 + -0.02466558223994819i, 0.045812221153154226 + 0.0i, -0.01834764431961019 + 0.028374605033571646i, -0.0456959478845729 + 0.0076680345174200875i, 0.003436750666520896 + -0.009361980298486488i, 0.012656682272881036 + -0.005179374767185226i, -0.0018610228695174007 + 0.009913461411015134i, -0.011757637055819817 + 0.007284700623110066i }, { -0.14212472950818042 + -0.023849321047034154i, -0.01834764431961019 + -0.028374605033571646i, 0.23860188852182945 + 0.0i, 0.037733437153677066 + 0.04130398355373607i, -0.041961556714814545 + 0.009479216417812778i, -0.008276896609776305 + -0.005764816196517147i, 0.06591927255904839 + -0.02697552246334642i, 0.015094420613410013 + 0.0071451629266501785i }, { -0.02660467841432857 + 0.0208313549573779i, -0.0456959478845729 + -0.0076680345174200875i, 0.037733437153677066 + -0.04130398355373607i, 0.07671528734502626 + 0.0i, -0.004995033239379528 + 0.00876297701731818i, -0.013491481147799474 + 0.0030477579863399393i, 0.00575504326747118 + -0.01567719247481665i, 0.021194366764116547 + -0.008673170903542537i }, { 0.03936514347066404 + 0.01610902655235675i, 0.003436750666520896 + 0.009361980298486488i, -0.041961556714814545 + -0.009479216417812778i, -0.004995033239379528 + -0.00876297701731818i, 0.14044037376971524 + 0.0i, 0.02220979075357838 + 0.024311403922245824i, -0.14008393042582246 + 0.023506863596623694i, -0.026222656204103252 + -0.0205322331210275i }, { 0.009013965263666612 + -0.004266891195998879i, 0.012656682272881036 + 0.005179374767185226i, -0.008276896609776305 + 0.005764816196517147i, -0.013491481147799474 + -0.0030477579863399393i, 0.02220979075357838 + -0.024311403922245824i, 0.04515439377002625 + 0.0i, -0.018084186610170992 + 0.027967168072283007i, -0.04503979009392644 + 0.007557927586270294i }, { -0.03656890957672644 + -0.022657065966173427i, -0.0018610228695174007 + -0.009913461411015134i, 0.06591927255904839 + 0.02697552246334642i, 0.00575504326747118 + 0.01567719247481665i, -0.14008393042582246 + -0.023506863596623694i, -0.018084186610170992 + -0.027967168072283007i, 0.23517575348657366 + 0.0i, 0.03719161474047765 + 0.04071089090880448i }, { -0.009705278301360913 + 0.0027473071109153334i, -0.011757637055819817 + -0.007284700623110066i, 0.015094420613410013 + -0.0071451629266501785i, 0.021194366764116547 + 0.008673170903542537i, -0.026222656204103252 + 0.0205322331210275i, -0.04503979009392644 + -0.007557927586270294i, 0.03719161474047765 + -0.04071089090880448i, 0.07561371629149932 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, true, false, true, false, false}), ElementsAreArray({ DoubleNear(0.14248636566217582, 1.0e-7), DoubleNear(0.045812221153154226, 1.0e-7), DoubleNear(0.23860188852182945, 1.0e-7), DoubleNear(0.07671528734502626, 1.0e-7), DoubleNear(0.14044037376971524, 1.0e-7), DoubleNear(0.04515439377002625, 1.0e-7), DoubleNear(0.23517575348657366, 1.0e-7), DoubleNear(0.07561371629149932, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, true, false, false, true, false}), Matrix({ { 0.1459826448605297 + 0.0i, 0.023086267210615123 + 0.025270817426487242i, -0.1456121350086425 + 0.024434527109972883i, -0.027257494445438867 + -0.02134250725375751i, 0.0135974248587316 + -0.030583311096424422i, 0.007444577098314929 + -0.0024827365706951506i, -0.008443889486855455 + 0.032781621920142806i, -0.0070101228297118024 + 0.00372250615251693i }, { 0.023086267210615123 + -0.025270817426487242i, 0.04693634496039567 + 0.0i, -0.01879785221757525 + 0.029070850887547545i, -0.04681721862016516 + 0.00785618999075905i, -0.0031438770532534327 + -0.007190392626710224i, 0.0043718445048877425 + -0.009833147228044164i, 0.004339423320510686 + 0.006645922011924382i, -0.002714879636145454 + 0.010539948199151349i }, { -0.1456121350086425 + -0.024434527109972883i, -0.01879785221757525 + -0.029070850887547545i, 0.2444566158541603 + 0.0i, 0.03865932666450635 + 0.042317485848057085i, -0.01868193860306744 + 0.028229756913806997i, -0.00784124209188889 + 0.0012303644173832866i, 0.022769696140746427 + -0.05121357226668742i, 0.01246638684795814 + -0.004157489958545047i }, { -0.027257494445438867 + 0.02134250725375751i, -0.04681721862016516 + -0.00785618999075905i, 0.03865932666450635 + -0.042317485848057085i, 0.07859769947683738 + 0.0i, 0.0019323722119825978 + 0.00769836422738821i, -0.006006617537586403 + 0.009076432406882697i, -0.0052646089939947325 + -0.01204073984183266i, 0.007320913480684735 + -0.016466189503964238i }, { 0.0135974248587316 + 0.030583311096424422i, -0.0031438770532534327 + 0.007190392626710224i, -0.01868193860306744 + -0.028229756913806997i, 0.0019323722119825978 + -0.00769836422738821i, 0.13694409457136136 + 0.0i, 0.021656875467701567 + 0.023706168735706773i, -0.13659652492536034 + 0.02292165753368497i, -0.02556984017299296 + -0.020021080824647885i }, { 0.007444577098314929 + 0.0024827365706951506i, 0.0043718445048877425 + 0.009833147228044164i, -0.00784124209188889 + -0.0012303644173832866i, -0.006006617537586403 + -0.009076432406882697i, 0.021656875467701567 + -0.023706168735706773i, 0.04403026996278481 + 0.0i, -0.01763397871220593 + 0.027270922218307105i, -0.04391851935833418 + 0.007369772112931329i }, { -0.008443889486855455 + -0.032781621920142806i, 0.004339423320510686 + -0.006645922011924382i, 0.022769696140746427 + 0.05121357226668742i, -0.0052646089939947325 + 0.01204073984183266i, -0.13659652492536034 + -0.02292165753368497i, -0.01763397871220593 + -0.027270922218307105i, 0.22932102615424282 + 0.0i, 0.03626572522964837 + 0.039697388614483464i }, { -0.0070101228297118024 + -0.00372250615251693i, -0.002714879636145454 + -0.010539948199151349i, 0.01246638684795814 + 0.004157489958545047i, 0.007320913480684735 + 0.016466189503964238i, -0.02556984017299296 + 0.020021080824647885i, -0.04391851935833418 + -0.007369772112931329i, 0.03626572522964837 + -0.039697388614483464i, 0.0737313041596882 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, true, false, false, true, false}), ElementsAreArray({ DoubleNear(0.1459826448605297, 1.0e-7), DoubleNear(0.04693634496039567, 1.0e-7), DoubleNear(0.2444566158541603, 1.0e-7), DoubleNear(0.07859769947683738, 1.0e-7), DoubleNear(0.13694409457136136, 1.0e-7), DoubleNear(0.04403026996278481, 1.0e-7), DoubleNear(0.22932102615424282, 1.0e-7), DoubleNear(0.0737313041596882, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, true, false, false, false, true}), Matrix({ { 0.15725289663050868 + 0.0i, 0.024868588966336314 + 0.027221792318754642i, -0.1568537824241928 + 0.02632093814652362i, -0.029361846132671232 + -0.022990206063312948i, 0.008072537136167878 + -0.005042942388508761i, 0.002149598166859416 + 0.0005999130698820791i, -0.007207962671406627 + 0.006381321809221264i, -0.0022445556522816337 + -0.0002385914317056009i }, { 0.024868588966336314 + -0.027221792318754642i, 0.05055995669432217 + 0.0i, -0.020249096832504206 + 0.031315198556294034i, -0.05043163348107901 + 0.008462708931645718i, 0.0004036471120055664 + -0.002194934390670998i, 0.002595482415671895 + -0.0016214070089536118i, -3.523524252252806e-05 + 0.002256925879411448i, -0.002317504404239418 + 0.002051722806002451i }, { -0.1568537824241928 + -0.02632093814652362i, -0.020249096832504206 + -0.031315198556294034i, 0.26332932233338313 + 0.0i, 0.041643930383551936 + 0.04558450926879164i, -0.00889613474999547 + 0.0036789645846565743i, -0.002043729147409559 + -0.000958189500830265i, 0.013517943256542486 + -0.008444706776070083i, 0.0035996298999706484 + 0.001004590093638623i }, { -0.029361846132671232 + 0.022990206063312948i, -0.05043163348107901 + -0.008462708931645718i, 0.041643930383551936 + -0.04558450926879164i, 0.08466565270847941 + 0.0i, -0.0007700100361249036 + 0.0021218012375667245i, -0.0028602855485929542 + 0.001182860818883598i, 0.0006759310813587342 + -0.003675548101474496i, 0.004346289577437857 + -0.0027151424110016488i }, { 0.008072537136167878 + 0.005042942388508761i, 0.0004036471120055664 + 0.002194934390670998i, -0.00889613474999547 + -0.0036789645846565743i, -0.0007700100361249036 + -0.0021218012375667245i, 0.12567384280138238 + 0.0i, 0.01987455371198038 + 0.021755193843439373i, -0.12535487750981006 + 0.02103524649713423i, -0.023465488485760598 + -0.01837338201509245i }, { 0.002149598166859416 + -0.0005999130698820791i, 0.002595482415671895 + 0.0016214070089536118i, -0.002043729147409559 + 0.000958189500830265i, -0.0028602855485929542 + -0.001182860818883598i, 0.01987455371198038 + -0.021755193843439373i, 0.040406658228858305 + 0.0i, -0.016182734097276975 + 0.025026574549560615i, -0.04030410449742033 + 0.006763253172044662i }, { -0.007207962671406627 + -0.006381321809221264i, -3.523524252252806e-05 + -0.002256925879411448i, 0.013517943256542486 + 0.008444706776070083i, 0.0006759310813587342 + 0.003675548101474496i, -0.12535487750981006 + -0.02103524649713423i, -0.016182734097276975 + -0.025026574549560615i, 0.21044831967501995 + 0.0i, 0.03328112151060278 + 0.03643036519374892i }, { -0.0022445556522816337 + 0.0002385914317056009i, -0.002317504404239418 + -0.002051722806002451i, 0.0035996298999706484 + -0.001004590093638623i, 0.004346289577437857 + 0.0027151424110016488i, -0.023465488485760598 + 0.01837338201509245i, -0.04030410449742033 + -0.006763253172044662i, 0.03328112151060278 + -0.03643036519374892i, 0.06766335092804618 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, true, false, false, false, true}), ElementsAreArray({ DoubleNear(0.15725289663050868, 1.0e-7), DoubleNear(0.05055995669432217, 1.0e-7), DoubleNear(0.26332932233338313, 1.0e-7), DoubleNear(0.08466565270847941, 1.0e-7), DoubleNear(0.12567384280138238, 1.0e-7), DoubleNear(0.040406658228858305, 1.0e-7), DoubleNear(0.21044831967501995, 1.0e-7), DoubleNear(0.06766335092804618, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, true, true, false, false}), Matrix({ { 0.21263459541005647 + 0.0i, 0.03362686771806024 + 0.03680882781851402i, -0.0752235604207768 + 0.055049881087465724i, -0.02142574354442844 + -0.004316023986741148i, 0.05874520917312907 + -0.024039748136544116i, 0.013451679028885858 + 0.006367547371311757i, -0.014558489456557456 + 0.023713320102802832i, -0.0064073106879548435 + 0.0012299209639172652i }, { 0.03362686771806024 + -0.03680882781851402i, 0.06836628237702941 + 0.0i, -0.0023665533832928566 + 0.021727631591357745i, -0.02418588171513099 + 0.017699639647018497i, 0.005128715888743466 + -0.013971027219020694i, 0.01888776165930455 + -0.007729260641741801i, 0.0018026376037246473 + 0.006270313668318469i, -0.004680846027197979 + 0.0076243074891868354i }, { -0.0752235604207768 + -0.055049881087465724i, -0.0023665533832928566 + -0.021727631591357745i, 0.1684536587739488 + 0.0i, 0.02663992136035513 + 0.029160737975170246i, -0.027005996163895353 + -0.006704277496520926i, -0.0031102674675557345 + -0.0057352046266657295i, 0.04653920685658337 + -0.01904480087915905i, 0.010656706848190764 + 0.0050445067513373i }, { -0.02142574354442844 + 0.004316023986741148i, -0.02418588171513099 + -0.017699639647018497i, 0.02663992136035513 + -0.029160737975170246i, 0.05416122612115108 + 0.0i, -0.00543140054132559 + 0.003614723224418661i, -0.008682968808783609 + -0.002155559529610938i, 0.00406307804524861 + -0.011068145554282444i, 0.01496328737769303 + -0.006123285028985962i }, { 0.05874520917312907 + 0.024039748136544116i, 0.005128715888743466 + 0.013971027219020694i, -0.027005996163895353 + 0.006704277496520926i, -0.00543140054132559 + -0.003614723224418661i, 0.20958133023451625 + 0.0i, 0.03314401240485003 + 0.03628028206652106i, -0.07414340938999095 + 0.054259408189497954i, -0.0211180867565097 + -0.004254049284505608i }, { 0.013451679028885858 + -0.006367547371311757i, 0.01888776165930455 + 0.007729260641741801i, -0.0031102674675557345 + 0.0057352046266657295i, -0.008682968808783609 + 0.002155559529610938i, 0.03314401240485003 + -0.03628028206652106i, 0.06738459645353052 + 0.0i, -0.0023325715422037787 + 0.021415639929055916i, -0.023838591518829035 + 0.01744548677387179i }, { -0.014558489456557456 + -0.023713320102802832i, 0.0018026376037246473 + -0.006270313668318469i, 0.04653920685658337 + 0.01904480087915905i, 0.00406307804524861 + 0.011068145554282444i, -0.07414340938999095 + -0.054259408189497954i, -0.0023325715422037787 + -0.021415639929055916i, 0.16603479702177265 + 0.0i, 0.026257393089206004 + 0.028742012764529243i }, { -0.0064073106879548435 + -0.0012299209639172652i, -0.004680846027197979 + -0.0076243074891868354i, 0.010656706848190764 + -0.0050445067513373i, 0.01496328737769303 + 0.006123285028985962i, -0.0211180867565097 + 0.004254049284505608i, -0.023838591518829035 + -0.01744548677387179i, 0.026257393089206004 + -0.028742012764529243i, 0.053383513607995044 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, true, true, false, false}), ElementsAreArray({ DoubleNear(0.21263459541005647, 1.0e-7), DoubleNear(0.06836628237702941, 1.0e-7), DoubleNear(0.1684536587739488, 1.0e-7), DoubleNear(0.05416122612115108, 1.0e-7), DoubleNear(0.20958133023451625, 1.0e-7), DoubleNear(0.06738459645353052, 1.0e-7), DoubleNear(0.16603479702177265, 1.0e-7), DoubleNear(0.053383513607995044, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, true, false, true, false}), Matrix({ { 0.2178521466426087 + 0.0i, 0.034451991704920845 + 0.037712029597993635i, -0.07706936909378934 + 0.056400675272042594i, -0.02195148073419758 + -0.0044219290311593405i, 0.02029164629203924 + -0.04563994562614065i, 0.011109656927121559 + -0.003705025977511153i, 0.004637362498654643 + 0.021399396058198683i, -0.002971043862383607 + 0.004186950559590518i }, { 0.034451991704920845 + -0.037712029597993635i, 0.07004382962748221 + 0.0i, -0.0024246230191302814 + 0.022260776401454664i, -0.024779346182706406 + 0.01813394703936893i, -0.0046916560902567975 + -0.010730333529910839i, 0.006524170808710963 + -0.014674156876174202i, 0.004437785198639164 + 0.002581418050491206i, 0.0014910049489184657 + 0.00688033455135264i }, { -0.07706936909378934 + -0.056400675272042594i, -0.0024246230191302814 + -0.022260776401454664i, 0.17258711407208124 + 0.0i, 0.02729360217020063 + 0.029876273676550692i, -0.01899447948559302 + 0.010892613629013177i, -0.004889463949149169 + -0.0015655027660893056i, 0.01607547470743878 + -0.03615693773697119i, 0.008801307019151512 + -0.002935200551729044i }, { -0.02195148073419758 + 0.0044219290311593405i, -0.024779346182706406 + -0.01813394703936893i, 0.02729360217020063 + -0.029876273676550692i, 0.05549021480975084 + 0.0i, -0.0011182588092636153 + 0.005010703928208788i, -0.006107105692808296 + 0.0035021935059480645i, -0.0037168299569913686 + -0.008500798938632044i, 0.005168587176861514 + -0.011625179855834198i }, { 0.02029164629203924 + 0.04563994562614065i, -0.0046916560902567975 + 0.010730333529910839i, -0.01899447948559302 + -0.010892613629013177i, -0.0011182588092636153 + -0.005010703928208788i, 0.204363779001964 + 0.0i, 0.032318888417989425 + 0.03537708028704145i, -0.07229760071697842 + 0.052908614004921084i, -0.02059234956674056 + -0.004148144240087415i }, { 0.011109656927121559 + 0.003705025977511153i, 0.006524170808710963 + 0.014674156876174202i, -0.004889463949149169 + 0.0015655027660893056i, -0.006107105692808296 + -0.0035021935059480645i, 0.032318888417989425 + -0.03537708028704145i, 0.06570704920307772 + 0.0i, -0.0022745019063663535 + 0.020882495118958996i, -0.023245127051253613 + 0.017011179381521354i }, { 0.004637362498654643 + -0.021399396058198683i, 0.004437785198639164 + -0.002581418050491206i, 0.01607547470743878 + 0.03615693773697119i, -0.0037168299569913686 + 0.008500798938632044i, -0.07229760071697842 + -0.052908614004921084i, -0.0022745019063663535 + -0.020882495118958996i, 0.16190134172364018 + 0.0i, 0.025603712279360508 + 0.028026477063148793i }, { -0.002971043862383607 + -0.004186950559590518i, 0.0014910049489184657 + -0.00688033455135264i, 0.008801307019151512 + 0.002935200551729044i, 0.005168587176861514 + 0.011625179855834198i, -0.02059234956674056 + 0.004148144240087415i, -0.023245127051253613 + -0.017011179381521354i, 0.025603712279360508 + -0.028026477063148793i, 0.05205452491939529 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, true, false, true, false}), ElementsAreArray({ DoubleNear(0.2178521466426087, 1.0e-7), DoubleNear(0.07004382962748221, 1.0e-7), DoubleNear(0.17258711407208124, 1.0e-7), DoubleNear(0.05549021480975084, 1.0e-7), DoubleNear(0.204363779001964, 1.0e-7), DoubleNear(0.06570704920307772, 1.0e-7), DoubleNear(0.16190134172364018, 1.0e-7), DoubleNear(0.05205452491939529, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, true, false, false, true}), Matrix({ { 0.2346709167343432 + 0.0i, 0.03711177787924756 + 0.04062349944245597i, -0.08301933112023627 + 0.06075495869333586i, -0.02364619392996555 + -0.0047633138138351025i, 0.012046771351803605 + -0.007525660504241748i, 0.003207878412647915 + 0.000895259502919887i, -0.0023134256015391137 + 0.005781186761642182i, -0.001366625991476578 + 0.0005137861862904571i }, { 0.03711177787924756 + -0.04062349944245597i, 0.07545140116168364 + 0.0i, -0.002611810420064084 + 0.02397936805239572i, -0.026692378176621706 + 0.019533936393667923i, 0.0006023687947325155 + -0.0032755343568696338i, 0.00387327833639042 + -0.0024196506223009267i, 0.0006349176207995594 + 0.0013147328476159933i, -0.0007438126784029052 + 0.0018587673650121424i }, { -0.08301933112023627 + -0.06075495869333586i, -0.002611810420064084 + -0.02397936805239572i, 0.1859113022295486 + 0.0i, 0.02940074147064068 + 0.03218280214509031i, -0.006210126559952883 + -0.000456493697887713i, -0.0009030708575330958 + -0.0011472165759248212i, 0.009543709040906758 + -0.0059619886603370946i, 0.0025413496541821495 + 0.0007092436606008149i }, { -0.02364619392996555 + 0.0047633138138351025i, -0.026692378176621706 + -0.019533936393667923i, 0.02940074147064068 + -0.03218280214509031i, 0.059774208241117954 + 0.0i, -0.0010611166157351581 + 0.0010028331733708238i, -0.001996680103611915 + -0.00014677186933265016i, 0.000477209398631785 + -0.0025949481352758605i, 0.003068493656719332 + -0.0019168987976543345i }, { 0.012046771351803605 + 0.007525660504241748i, 0.0006023687947325155 + 0.0032755343568696338i, -0.006210126559952883 + 0.000456493697887713i, -0.0010611166157351581 + -0.0010028331733708238i, 0.18754500891022952 + 0.0i, 0.029659102243662708 + 0.03246561044257912i, -0.0663476386905315 + 0.048554330583627826i, -0.018897636370972592 + -0.003806759457411653i }, { 0.003207878412647915 + -0.000895259502919887i, 0.00387327833639042 + 0.0024196506223009267i, -0.0009030708575330958 + 0.0011472165759248212i, -0.001996680103611915 + 0.00014677186933265016i, 0.029659102243662708 + -0.03246561044257912i, 0.060299477668876306 + 0.0i, -0.0020873145054325516 + 0.01916390346801794i, -0.021332095057338313 + 0.01561119002722236i }, { -0.0023134256015391137 + -0.005781186761642182i, 0.0006349176207995594 + -0.0013147328476159933i, 0.009543709040906758 + 0.0059619886603370946i, 0.000477209398631785 + 0.0025949481352758605i, -0.0663476386905315 + -0.048554330583627826i, -0.0020873145054325516 + -0.01916390346801794i, 0.14857715356617282 + 0.0i, 0.02349657297892046 + 0.025719948594609174i }, { -0.001366625991476578 + -0.0005137861862904571i, -0.0007438126784029052 + -0.0018587673650121424i, 0.0025413496541821495 + -0.0007092436606008149i, 0.003068493656719332 + 0.0019168987976543345i, -0.018897636370972592 + 0.003806759457411653i, -0.021332095057338313 + -0.01561119002722236i, 0.02349657297892046 + -0.025719948594609174i, 0.04777053148802818 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, true, false, false, true}), ElementsAreArray({ DoubleNear(0.2346709167343432, 1.0e-7), DoubleNear(0.07545140116168364, 1.0e-7), DoubleNear(0.1859113022295486, 1.0e-7), DoubleNear(0.059774208241117954, 1.0e-7), DoubleNear(0.18754500891022952, 1.0e-7), DoubleNear(0.060299477668876306, 1.0e-7), DoubleNear(0.14857715356617282, 1.0e-7), DoubleNear(0.04777053148802818, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, true, true, false}), Matrix({ { 0.19663136606589732 + 0.0i, 0.031096054351683795 + 0.03403853490200451i, 0.05432394811984083 + -0.022230477156612388i, 0.012439283542873165 + 0.005888315284235862i, 0.018315055378707455 + -0.04119419979993935i, 0.010027475293539813 + -0.0033441227479057843i, 0.00040267940029924544 + -0.013451485619554171i, 0.002392246021956499 + -0.0020575634458012025i }, { 0.031096054351683795 + -0.03403853490200451i, 0.0632209235318365 + 0.0i, 0.0047427202963972875 + -0.012919544734111261i, 0.01746623765447946 + -0.0071475437744933645i, -0.004234646113687401 + -0.009685101445387367i, 0.0058886572307623 + -0.01324476052632603i, -0.0022648834269795378 + -0.0021969777935285186i, 0.00012946949453442088 + -0.004324922115724059i }, { 0.05432394811984083 + 0.022230477156612388i, 0.0047427202963972875 + 0.012919544734111261i, 0.19380789464879267 + 0.0i, 0.03064953952343768 + 0.03354976837253982i, 0.009717233186500134 + -0.009310209195913828i, 0.003148396435225898 + 0.0002097814332129215i, 0.01805206562077057 + -0.040602683563172495i, 0.009883488652733256 + -0.003296103781334413i }, { 0.012439283542873165 + -0.005888315284235862i, 0.01746623765447946 + 0.0071475437744933645i, 0.03064953952343768 + -0.03354976837253982i, 0.06231312090539654 + 0.0i, -7.495380640209339e-05 + -0.0031544873260119224i, 0.003124285145935807 + -0.002993418778583936i, -0.004173839933560764 + -0.009546031023155516i, 0.0058041007548101774 + -0.013054576205682369i }, { 0.018315055378707455 + 0.04119419979993935i, -0.004234646113687401 + 0.009685101445387367i, 0.009717233186500134 + 0.009310209195913828i, -7.495380640209339e-05 + 0.0031544873260119224i, 0.18445688811810798 + 0.0i, 0.02917073472673158 + 0.03193103089167976i, 0.05096046790987162 + -0.020854071859090776i, 0.011669102334203457 + 0.005523738838413195i }, { 0.010027475293539813 + 0.0033441227479057843i, 0.0058886572307623 + 0.01324476052632603i, 0.003148396435225898 + -0.0002097814332129215i, 0.003124285145935807 + 0.002993418778583936i, 0.02917073472673158 + -0.03193103089167976i, 0.059306584966343986 + 0.0i, 0.004449073637594789 + -0.01211962803919188i, 0.01638481138251812 + -0.006705001896234399i }, { 0.00040267940029924544 + 0.013451485619554171i, -0.0022648834269795378 + 0.0021969777935285186i, 0.01805206562077057 + 0.040602683563172495i, -0.004173839933560764 + 0.009546031023155516i, 0.05096046790987162 + 0.020854071859090776i, 0.004449073637594789 + 0.01211962803919188i, 0.18180823260749623 + 0.0i, 0.028751865970618348 + 0.03147252645851049i }, { 0.002392246021956499 + 0.0020575634458012025i, 0.00012946949453442088 + 0.004324922115724059i, 0.009883488652733256 + 0.003296103781334413i, 0.0058041007548101774 + 0.013054576205682369i, 0.011669102334203457 + -0.005523738838413195i, 0.01638481138251812 + 0.006705001896234399i, 0.028751865970618348 + -0.03147252645851049i, 0.058454989156129025 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, true, true, false}), ElementsAreArray({ DoubleNear(0.19663136606589732, 1.0e-7), DoubleNear(0.0632209235318365, 1.0e-7), DoubleNear(0.19380789464879267, 1.0e-7), DoubleNear(0.06231312090539654, 1.0e-7), DoubleNear(0.18445688811810798, 1.0e-7), DoubleNear(0.059306584966343986, 1.0e-7), DoubleNear(0.18180823260749623, 1.0e-7), DoubleNear(0.058454989156129025, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, true, false, true}), Matrix({ { 0.2005904275971303 + 0.0i, 0.031722155848205064 + 0.03472388158298568i, 0.06740756420919787 + -0.028536474542831577i, 0.015599998751176705 + 0.007155943590062851i, 0.02765577292744338 + -0.020049259673798857i, 0.00784428687099006 + 0.0016167772714282033i, -0.012946779657886143 + -0.027413475685250214i, 0.0026980475983620312 + -0.006576470310933255i }, { 0.031722155848205064 + -0.03472388158298568i, 0.06449384113054776 + 0.0i, 0.005720193670833528 + -0.01618168328910909i, 0.021672882346292978 + -0.009175048269440102i, 0.0009028976224685959 + -0.00795811417002385i, 0.00889188505598736 + -0.00644623865493759i, -0.006792956482695163 + -0.002094078512812596i, -0.004162649037694469 + -0.00881398163840374i }, { 0.06740756420919787 + 0.028536474542831577i, 0.005720193670833528 + 0.01618168328910909i, 0.21999179136676156 + 0.0i, 0.03479036350168317 + 0.0380824200045606i, -0.025776206241986392 + 0.033059322382442274i, -0.00979919555858987 + 0.0007660537219410881i, -0.006065292534733021 + 0.006561610509220013i, -0.002095058804159994 + -1.2274107907501346e-05i }, { 0.015599998751176705 + -0.007155943590062851i, 0.021672882346292978 + 0.009175048269440102i, 0.03479036350168317 + -0.0380824200045606i, 0.07073176827225382 + 0.0i, 0.0016464951393454722 + 0.009690207719987172i, -0.008287566711098066 + 0.01062923446127245i, 0.00017668057089570449 + 0.0020876316778783563i, -0.001950113062877608 + 0.0021096892349823293i }, { 0.02765577292744338 + 0.020049259673798857i, 0.0009028976224685959 + 0.00795811417002385i, -0.025776206241986392 + -0.033059322382442274i, 0.0016464951393454722 + -0.009690207719987172i, 0.18049782658687502 + 0.0i, 0.028544633230210312 + 0.031245684210698586i, 0.037876851820514576 + -0.014548074472871587i, 0.008508387125899918 + 0.004256110532586207i }, { 0.00784428687099006 + -0.0016167772714282033i, 0.00889188505598736 + 0.00644623865493759i, -0.00979919555858987 + -0.0007660537219410881i, -0.008287566711098066 + -0.01062923446127245i, 0.028544633230210312 + -0.031245684210698586i, 0.05803366736763273 + 0.0i, 0.0034716002631585484 + -0.00885748948419405i, 0.012178166690704605 + -0.004677497401287661i }, { -0.012946779657886143 + 0.027413475685250214i, -0.006792956482695163 + 0.002094078512812596i, -0.006065292534733021 + -0.006561610509220013i, 0.00017668057089570449 + -0.0020876316778783563i, 0.037876851820514576 + 0.014548074472871587i, 0.0034716002631585484 + 0.00885748948419405i, 0.15562433588952734 + 0.0i, 0.02461104199237285 + 0.026939874826489706i }, { 0.0026980475983620312 + 0.006576470310933255i, -0.004162649037694469 + 0.00881398163840374i, -0.002095058804159994 + 1.2274107907501346e-05i, -0.001950113062877608 + -0.0021096892349823293i, 0.008508387125899918 + -0.004256110532586207i, 0.012178166690704605 + 0.004677497401287661i, 0.02461104199237285 + -0.026939874826489706i, 0.05003634178927175 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, true, false, true}), ElementsAreArray({ DoubleNear(0.2005904275971303, 1.0e-7), DoubleNear(0.06449384113054776, 1.0e-7), DoubleNear(0.21999179136676156, 1.0e-7), DoubleNear(0.07073176827225382, 1.0e-7), DoubleNear(0.18049782658687502, 1.0e-7), DoubleNear(0.05803366736763273, 1.0e-7), DoubleNear(0.15562433588952734, 1.0e-7), DoubleNear(0.05003634178927175, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, true, true}), Matrix({ { 0.21700919760692902 + 0.0i, 0.03431868444294306 + 0.037566108066013945i, 0.020213130546668647 + -0.045463348109214895i, 0.01106666963166556 + -0.0036906898870798987i, 0.01114011152804455 + -0.006959266918177316i, 0.0029664482077145092 + 0.000827880800408493i, -0.0004203280177573136 + -0.0029820641071322735i, 0.0004497479322565591 + -0.0005443575946191694i }, { 0.03431868444294306 + -0.037566108066013945i, 0.06977280462474647 + 0.0i, -0.0046735023697726434 + -0.010688813974373027i, 0.00649892642357835 + -0.014617377236501996i, 0.0005570335286001198 + -0.0030290122543088077i, 0.0035817690388958894 + -0.00223754373716897i, -0.0005826925702075215 + -0.0003988330001561697i, -0.00013514387862218228 + -0.0009587933535530739i }, { 0.020213130546668647 + 0.045463348109214895i, -0.0046735023697726434 + 0.010688813974373027i, 0.2035730213569628 + 0.0i, 0.032193834906945176 + 0.035240193521532334i, 0.002495599767562844 + 0.0016856345338473202i, 0.00010286647804205824 + 0.0006985820503590408i, 0.010450368864665813 + -0.006528382246401525i, 0.0027827798591155556 + 0.000776622363112209i }, { 0.01106666963166556 + 0.0036906898870798987i, 0.00649892642357835 + 0.014617377236501996i, 0.032193834906945176 + -0.035240193521532334i, 0.06545280477805511 + 0.0i, 0.0006864613648634969 + -0.0001654363561565703i, 0.0008023853224835172 + 0.0005419652728815923i, 0.0005225446647641807 + -0.002841470237836686i, 0.003360002954213862 + -0.002099005682786291i }, { 0.01114011152804455 + 0.006959266918177316i, 0.0005570335286001198 + 0.0030290122543088077i, 0.002495599767562844 + -0.0016856345338473202i, 0.0006864613648634969 + 0.0001654363561565703i, 0.17343006310776096 + 0.0i, 0.02742690943217841 + 0.030022195208530382i, 0.016153990452809377 + -0.036333535253896945i, 0.00884429431460751 + -0.002949536642160298i }, { 0.0029664482077145092 + -0.000827880800408493i, 0.0035817690388958894 + 0.00223754373716897i, 0.00010286647804205824 + -0.0006985820503590408i, 0.0008023853224835172 + -0.0005419652728815923i, 0.02742690943217841 + -0.030022195208530382i, 0.05576123981248658 + 0.0i, -0.003734983677475522 + -0.008542318494169858i, 0.005193831561994127 + -0.011681959495506402i }, { -0.0004203280177573136 + 0.0029820641071322735i, -0.0005826925702075215 + 0.0003988330001561697i, 0.010450368864665813 + 0.006528382246401525i, 0.0005225446647641807 + 0.002841470237836686i, 0.016153990452809377 + 0.036333535253896945i, -0.003734983677475522 + 0.008542318494169858i, 0.1626920993686414 + 0.0i, 0.025728765790404753 + 0.02816336382865791i }, { 0.0004497479322565591 + 0.0005443575946191694i, -0.00013514387862218228 + 0.0009587933535530739i, 0.0027827798591155556 + -0.000776622363112209i, 0.003360002954213862 + 0.002099005682786291i, 0.00884429431460751 + 0.002949536642160298i, 0.005193831561994127 + 0.011681959495506402i, 0.025728765790404753 + -0.02816336382865791i, 0.0523087693444179 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, true, true}), ElementsAreArray({ DoubleNear(0.21700919760692902, 1.0e-7), DoubleNear(0.06977280462474647, 1.0e-7), DoubleNear(0.2035730213569628, 1.0e-7), DoubleNear(0.06545280477805511, 1.0e-7), DoubleNear(0.17343006310776096, 1.0e-7), DoubleNear(0.05576123981248658, 1.0e-7), DoubleNear(0.1626920993686414, 1.0e-7), DoubleNear(0.0523087693444179, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, true, true, false, false}), Matrix({ { 0.10506436077253303 + 0.0i, -0.10479770317918935 + 0.01758563816980507i, -0.03716852977476094 + 0.027200562335140125i, 0.032521373361789105 + -0.033352782504566705i, 0.029026451873088027 + -0.011878221256649031i, -0.02696460879588031 + 0.016706511824162797i, -0.007193459679583871 + 0.011716930697899057i, 0.005214026379550162 + -0.012891231570866645i }, { -0.10479770317918935 + -0.01758563816980507i, 0.17593651701455287 + 0.0i, 0.04162701572659859 + -0.020910269912923902i, -0.06224091236114685 + 0.0455489583993441i, -0.030940954334641276 + 0.006989635878026869i, 0.04860651895934559 + -0.019890787521636883i, 0.009136378396901453 + -0.010483153737734952i, -0.012045875804171564 + 0.01962069689409061i }, { -0.03716852977476094 + -0.027200562335140125i, 0.04162701572659859 + 0.020910269912923902i, 0.08323422604279701 + 0.0i, -0.08302297421356399 + 0.01393171739464917i, -0.01334386682709559 + -0.003312634184739703i, 0.013864467174783105 + 0.0010707345421324757i, 0.022995373870457046 + -0.009410180062892945i, -0.021361937836665946 + 0.013235254765120694i }, { 0.032521373361789105 + 0.033352782504566705i, -0.06224091236114685 + -0.0455489583993441i, -0.08302297421356399 + -0.01393171739464917i, 0.13938065885230286 + 0.0i, 0.012755531932929158 + 0.005537718628494805i, -0.022345098145583372 + -0.00554720284139216i, -0.024512083527972742 + 0.005537338526125848i, 0.038507120363819355 + -0.015757905845252072i }, { 0.029026451873088027 + 0.011878221256649031i, -0.030940954334641276 + -0.006989635878026869i, -0.01334386682709559 + 0.003312634184739703i, 0.012755531932929158 + -0.005537718628494805i, 0.10355571937145461 + 0.0i, -0.1032928907709518 + 0.01733312226800663i, -0.03663481898622037 + 0.026809983701532383i, 0.032054392076101314 + -0.03287386283896772i }, { -0.02696460879588031 + -0.016706511824162797i, 0.04860651895934559 + 0.019890787521636883i, 0.013864467174783105 + -0.0010707345421324757i, -0.022345098145583372 + 0.00554720284139216i, -0.1032928907709518 + -0.01733312226800663i, 0.17341020731659215 + 0.0i, 0.0410292845943029 + -0.020610014920018557i, -0.06134718192259963 + 0.04489491126183737i }, { -0.007193459679583871 + -0.011716930697899057i, 0.009136378396901453 + 0.010483153737734952i, 0.022995373870457046 + 0.009410180062892945i, -0.024512083527972742 + -0.005537338526125848i, -0.03663481898622037 + -0.026809983701532383i, 0.0410292845943029 + 0.020610014920018557i, 0.08203904816828687 + 0.0i, -0.08183082974879709 + 0.013731668914887358i }, { 0.005214026379550162 + 0.012891231570866645i, -0.012045875804171564 + -0.01962069689409061i, -0.021361937836665946 + -0.013235254765120694i, 0.038507120363819355 + 0.015757905845252072i, 0.032054392076101314 + 0.03287386283896772i, -0.06134718192259963 + -0.04489491126183737i, -0.08183082974879709 + -0.013731668914887358i, 0.1373792624614808 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, true, true, false, false}), ElementsAreArray({ DoubleNear(0.10506436077253303, 1.0e-7), DoubleNear(0.17593651701455287, 1.0e-7), DoubleNear(0.08323422604279701, 1.0e-7), DoubleNear(0.13938065885230286, 1.0e-7), DoubleNear(0.10355571937145461, 1.0e-7), DoubleNear(0.17341020731659215, 1.0e-7), DoubleNear(0.08203904816828687, 1.0e-7), DoubleNear(0.1373792624614808, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, true, false, true, false}), Matrix({ { 0.10764239227295236 + 0.0i, -0.10736919153148106 + 0.01801714823490591i, -0.0380805577914836 + 0.027867999951602006i, 0.03331937112570363 + -0.034171181087027665i, 0.010026255805571583 + -0.022551042099506105i, -0.0062262227494365935 + 0.024171998044307946i, 0.002291355861693536 + 0.010573603337862933i, -0.004055346558904146 + -0.010163240714381181i }, { -0.10736919153148106 + -0.01801714823490591i, 0.1802535839971386 + 0.0i, 0.042648444468205496 + -0.021423358596102574i, -0.06376815748501213 + 0.04666662235980952i, -0.013775394776905533 + 0.020815615242409546i, 0.01678956129517862 + -0.037763060402808746i, -0.0005157340569393125 + -0.010930293496232564i, 0.003837011585879572 + 0.01770612727168839i }, { -0.0380805577914836 + -0.027867999951602006i, 0.042648444468205496 + 0.021423358596102574i, 0.08527659754797301 + 0.0i, -0.0850601620973266 + 0.014273568865826022i, -0.009385315881982013 + 0.0053821227249849736i, 0.008460637638488346 + -0.006939373767240482i, 0.00794301355804776 + -0.01786541622496248i, -0.004932546373564314 + 0.01914957207498621i }, { 0.03331937112570363 + 0.034171181087027665i, -0.06376815748501213 + -0.04666662235980952i, -0.0850601620973266 + -0.014273568865826022i, 0.14280073133385907 + 0.0i, 0.010262353503528183 + -0.0037975515927889366i, -0.015716269296419304 + 0.009012684409976268i, -0.010913161363748307 + 0.01649057407828015i, 0.013301048326252538 + -0.029916701367842913i }, { 0.010026255805571583 + 0.022551042099506105i, -0.013775394776905533 + -0.020815615242409546i, -0.009385315881982013 + -0.0053821227249849736i, 0.010262353503528183 + 0.0037975515927889366i, 0.10097768787103528 + 0.0i, -0.1007214024186601 + 0.01690161220290579i, -0.03572279096949771 + 0.026142546085070505i, 0.03125639431218679 + -0.03205546425650676i }, { -0.0062262227494365935 + -0.024171998044307946i, 0.01678956129517862 + 0.037763060402808746i, 0.008460637638488346 + 0.006939373767240482i, -0.015716269296419304 + -0.009012684409976268i, -0.1007214024186601 + -0.01690161220290579i, 0.16909314033400644 + 0.0i, 0.040007855852696006 + -0.020096926236839886i, -0.05981993679873435 + 0.04377724730137194i }, { 0.002291355861693536 + -0.010573603337862933i, -0.0005157340569393125 + 0.010930293496232564i, 0.00794301355804776 + 0.01786541622496248i, -0.010913161363748307 + -0.01649057407828015i, -0.03572279096949771 + -0.026142546085070505i, 0.040007855852696006 + 0.020096926236839886i, 0.07999667666311086 + 0.0i, -0.07979364186503446 + 0.01338981744371051i }, { -0.004055346558904146 + 0.010163240714381181i, 0.003837011585879572 + -0.01770612727168839i, -0.004932546373564314 + -0.01914957207498621i, 0.013301048326252538 + 0.029916701367842913i, 0.03125639431218679 + 0.03205546425650676i, -0.05981993679873435 + -0.04377724730137194i, -0.07979364186503446 + -0.01338981744371051i, 0.13395918997992462 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, true, false, true, false}), ElementsAreArray({ DoubleNear(0.10764239227295236, 1.0e-7), DoubleNear(0.1802535839971386, 1.0e-7), DoubleNear(0.08527659754797301, 1.0e-7), DoubleNear(0.14280073133385907, 1.0e-7), DoubleNear(0.10097768787103528, 1.0e-7), DoubleNear(0.16909314033400644, 1.0e-7), DoubleNear(0.07999667666311086, 1.0e-7), DoubleNear(0.13395918997992462, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, true, false, false, true}), Matrix({ { 0.11595267369851528 + 0.0i, -0.1156583811269633 + 0.019408120408196925i, -0.04102047900103071 + 0.030019484301542262i, 0.03589171595315084 + -0.03680928792840105i, 0.005952400779418273 + -0.003718485737207855i, -0.00531489442533131 + 0.0047053589559526i, -0.0011430810755502503 + 0.0028565280755336554i, 0.0006620551592907407 + -0.0030406066265211747i }, { -0.1156583811269633 + -0.019408120408196925i, 0.19416964419751157 + 0.0i, 0.045941018782185476 + -0.0230772993461643i, -0.06869123029582727 + 0.05026941078546152i, -0.006559692266069967 + 0.002712737184329332i, 0.009967648908775752 + -0.00622682538933482i, 0.0016183046198853196 + -0.0026579495571672908i, -0.0019141572043917688 + 0.004783426051120668i }, { -0.04102047900103071 + -0.030019484301542262i, 0.045941018782185476 + 0.0230772993461643i, 0.09186017962631554 + 0.0i, -0.09162703477830847 + 0.015375526669972413i, -0.0030684704719837943 + -0.0002255569864949364i, 0.0030984362241828906 + -0.0002886150651979848i, 0.0047156187724215 + -0.0029458636602545177i, -0.004210572650314735 + 0.003727685659271115i }, { 0.03589171595315084 + 0.03680928792840105i, -0.06869123029582727 + -0.05026941078546152i, -0.09162703477830847 + -0.015375526669972413i, 0.15382533084435102 + 0.0i, 0.0030229289156720766 + 0.0007385840926946697i, -0.005138336191581003 + -0.00037770858072542677i, -0.005196728032518458 + 0.002149088219210841i, 0.007896583925204589 + -0.004933023797736911i }, { 0.005952400779418273 + 0.003718485737207855i, -0.006559692266069967 + -0.002712737184329332i, -0.0030684704719837943 + 0.0002255569864949364i, 0.0030229289156720766 + -0.0007385840926946697i, 0.09266740644547236 + 0.0i, -0.09243221282317785 + 0.015510640029614777i, -0.03278286975995061 + 0.02399106173513025i, 0.028684049484739578 + -0.029417357415133377i }, { -0.00531489442533131 + -0.0047053589559526i, 0.009967648908775752 + 0.00622682538933482i, 0.0030984362241828906 + 0.0002886150651979848i, -0.005138336191581003 + 0.00037770858072542677i, -0.09243221282317785 + -0.015510640029614777i, 0.15517708013363346 + 0.0i, 0.03671528153871602 + -0.01844298548677816i, -0.05489686398791921 + 0.04017445887571994i }, { -0.0011430810755502503 + -0.0028565280755336554i, 0.0016183046198853196 + 0.0026579495571672908i, 0.0047156187724215 + 0.0029458636602545177i, -0.005196728032518458 + -0.002149088219210841i, -0.03278286975995061 + -0.02399106173513025i, 0.03671528153871602 + 0.01844298548677816i, 0.07341309458476833 + 0.0i, -0.07322676918405258 + 0.012287859639564119i }, { 0.0006620551592907407 + 0.0030406066265211747i, -0.0019141572043917688 + -0.004783426051120668i, -0.004210572650314735 + -0.003727685659271115i, 0.007896583925204589 + 0.004933023797736911i, 0.028684049484739578 + 0.029417357415133377i, -0.05489686398791921 + -0.04017445887571994i, -0.07322676918405258 + -0.012287859639564119i, 0.12293459046943267 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, true, false, false, true}), ElementsAreArray({ DoubleNear(0.11595267369851528, 1.0e-7), DoubleNear(0.19416964419751157, 1.0e-7), DoubleNear(0.09186017962631554, 1.0e-7), DoubleNear(0.15382533084435102, 1.0e-7), DoubleNear(0.09266740644547236, 1.0e-7), DoubleNear(0.15517708013363346, 1.0e-7), DoubleNear(0.07341309458476833, 1.0e-7), DoubleNear(0.12293459046943267, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, true, true, false}), Matrix({ { 0.09715704419454214 + 0.0i, -0.09691045569021199 + 0.016262114120239805i, 0.026841873368934344 + -0.01098424679024463i, -0.02493520799257342 + 0.015449152269160021i, 0.009049607295400787 + -0.020354365483990017i, -0.005619732022474526 + 0.021817425576218113i, 0.00019896693530570394 + -0.006646480716526616i, 0.0009140238083463329 + 0.006662914700108403i }, { -0.09691045569021199 + -0.016262114120239805i, 0.1626952454031917 + 0.0i, -0.02861228722668768 + 0.006463584386864217i, 0.04494831240538594 + -0.018393774140861123i, -0.012433546030297341 + 0.01878798498750515i, 0.015154105314068968 + -0.03408459484227537i, -0.0013109477067134235 + 0.006596308659652564i, 0.0003331819595279623 + -0.011129927018751613i }, { 0.026841873368934344 + 0.01098424679024463i, -0.02861228722668768 + -0.006463584386864217i, 0.09576194562638322 + 0.0i, -0.09551889793859569 + 0.016028602980492128i, 0.004801358364326618 + -0.004600244734121862i, -0.004019184871347883 + 0.005392218911827755i, 0.008919662068218554 + -0.02006209284047857i, -0.0055390371005263825 + 0.021504144543076045i }, { -0.02493520799257342 + -0.015449152269160021i, 0.04494831240538594 + 0.018393774140861123i, -0.09551889793859569 + -0.016028602980492128i, 0.16035906992780596 + 0.0i, -0.005559159774197477 + 0.0037849193423492174i, 0.008040159968109323 + -0.007703383240375903i, -0.012255010110356498 + 0.018518204333184546i, 0.014936504307362193 + -0.033595166928376295i }, { 0.009049607295400787 + 0.020354365483990017i, -0.012433546030297341 + -0.01878798498750515i, 0.004801358364326618 + 0.004600244734121862i, -0.005559159774197477 + -0.0037849193423492174i, 0.09114154262078791 + 0.0i, -0.09091022170254134 + 0.015255241444214435i, 0.02517995237461073 + -0.010304154529297345i, -0.023391338639972833 + 0.01449261432012347i }, { -0.005619732022474526 + -0.021817425576218113i, 0.015154105314068968 + 0.03408459484227537i, -0.004019184871347883 + -0.005392218911827755i, 0.008040159968109323 + 0.007703383240375903i, -0.09091022170254134 + -0.015255241444214435i, 0.15262193046366404 + 0.0i, -0.02684075063592634 + 0.006063390017288499i, 0.04216532691777901 + -0.01725491922602783i }, { 0.00019896693530570394 + 0.006646480716526616i, -0.0013109477067134235 + -0.006596308659652564i, 0.008919662068218554 + 0.02006209284047857i, -0.012255010110356498 + -0.018518204333184546i, 0.02517995237461073 + 0.010304154529297345i, -0.02684075063592634 + -0.006063390017288499i, 0.08983282191335826 + 0.0i, -0.0896048225811532 + 0.015036188202401862i }, { 0.0009140238083463329 + -0.006662914700108403i, 0.0003331819595279623 + 0.011129927018751613i, -0.0055390371005263825 + -0.021504144543076045i, 0.014936504307362193 + 0.033595166928376295i, -0.023391338639972833 + -0.01449261432012347i, 0.04216532691777901 + 0.01725491922602783i, -0.0896048225811532 + -0.015036188202401862i, 0.15043039985026702 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, true, true, false}), ElementsAreArray({ DoubleNear(0.09715704419454214, 1.0e-7), DoubleNear(0.1626952454031917, 1.0e-7), DoubleNear(0.09576194562638322, 1.0e-7), DoubleNear(0.16035906992780596, 1.0e-7), DoubleNear(0.09114154262078791, 1.0e-7), DoubleNear(0.15262193046366404, 1.0e-7), DoubleNear(0.08983282191335826, 1.0e-7), DoubleNear(0.15043039985026702, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, true, false, true}), Matrix({ { 0.09911324642135272 + 0.0i, -0.0988616929967198 + 0.016589542605929035i, 0.03330658697008014 + -0.014100087762118057i, -0.030861985451710795 + 0.019639146748241285i, 0.013664926437246828 + -0.00990649074544046i, -0.011972099137189527 + 0.012168578566793275i, -0.00639710168608955 + -0.013545205538496176i, 0.008648057634012406 + 0.012440082482080873i }, { -0.0988616929967198 + -0.016589542605929035i, 0.16597102230632532 + 0.0i, -0.03558212156111791 + 0.00848945559093121i, 0.0557738595854107 + -0.023611435050153624i, -0.015288389466295734 + 0.007594116776411364i, 0.022882731546183917 + -0.016589007583295984i, 0.004113673532987991 + 0.014581572036861105i, -0.010712327009491065 + -0.02268225178515778i }, { 0.03330658697008014 + 0.014100087762118057i, -0.03558212156111791 + -0.00848945559093121i, 0.10869960690347812 + 0.0i, -0.10842372290855198 + 0.018194104472240298i, -0.012736218331418307 + 0.01633486106522871i, 0.009969769619043039 + -0.018425186565463592i, -0.002996906885407054 + 0.003242141347978087i, 0.002446632061543481 + -0.0037355339515695606i }, { -0.030861985451710795 + -0.019639146748241285i, 0.0557738595854107 + 0.023611435050153624i, -0.10842372290855198 + -0.018194104472240298i, 0.18202395273553723 + 0.0i, 0.015438016970189476 + -0.01416161849002703i, -0.021327554621666155 + 0.027353695778486013i, 0.0035319691677073097 + -0.0027322913728711914i, -0.005018498712203575 + 0.005429158396224256i }, { 0.013664926437246828 + 0.00990649074544046i, -0.015288389466295734 + -0.007594116776411364i, -0.012736218331418307 + -0.01633486106522871i, 0.015438016970189476 + 0.01416161849002703i, 0.08918534039397734 + 0.0i, -0.08895898439603353 + 0.014927812958525206i, 0.018715238773464933 + -0.0071883135574239195i, -0.017464561180835454 + 0.010302619841042207i }, { -0.011972099137189527 + -0.012168578566793275i, 0.022882731546183917 + 0.016589007583295984i, 0.009969769619043039 + 0.018425186565463592i, -0.021327554621666155 + -0.027353695778486013i, -0.08895898439603353 + -0.014927812958525206i, 0.14934615356053038 + 0.0i, -0.019870916301496108 + 0.004037518813221506i, 0.031339779737754245 + -0.01203725831673533i }, { -0.00639710168608955 + 0.013545205538496176i, 0.004113673532987991 + -0.014581572036861105i, -0.002996906885407054 + -0.003242141347978087i, 0.0035319691677073097 + 0.0027322913728711914i, 0.018715238773464933 + 0.0071883135574239195i, -0.019870916301496108 + -0.004037518813221506i, 0.07689516063626337 + 0.0i, -0.07669999761119689 + 0.012870686710653688i }, { 0.008648057634012406 + -0.012440082482080873i, -0.010712327009491065 + 0.02268225178515778i, 0.002446632061543481 + 0.0037355339515695606i, -0.005018498712203575 + -0.005429158396224256i, -0.017464561180835454 + -0.010302619841042207i, 0.031339779737754245 + 0.01203725831673533i, -0.07669999761119689 + -0.012870686710653688i, 0.12876551704253575 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, true, false, true}), ElementsAreArray({ DoubleNear(0.09911324642135272, 1.0e-7), DoubleNear(0.16597102230632532, 1.0e-7), DoubleNear(0.10869960690347812, 1.0e-7), DoubleNear(0.18202395273553723, 1.0e-7), DoubleNear(0.08918534039397734, 1.0e-7), DoubleNear(0.14934615356053038, 1.0e-7), DoubleNear(0.07689516063626337, 1.0e-7), DoubleNear(0.12876551704253575, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, true, true}), Matrix({ { 0.10722588478306473 + 0.0i, -0.10695374115443407 + 0.01794743334816106i, 0.009987460582329417 + -0.022463783931595847i, -0.006202131233500446 + 0.024078467809440316i, 0.005504413307588104 + -0.0034386263852958865i, -0.004914886730136913 + 0.004351225902610606i, -0.0002076872505873023 + -0.0014734604150108534i, 0.0004537874518675592 + 0.0014349580892010399i }, { -0.10695374115443407 + -0.01794743334816106i, 0.17955611744861075 + 0.0i, -0.013722092774046003 + 0.020735072070969265i, 0.01672459638791758 + -0.037616941414121044i, -0.006065999038217827 + 0.0025085721225362044i, 0.00921746725935234 + -0.0057581842700504i, -3.946718796242592e-05 + 0.0015044833366675385i, -0.00034778464579219366 + -0.0024673970456744933i }, { 0.009987460582329417 + 0.022463783931595847i, -0.013722092774046003 + -0.020735072070969265i, 0.1005869685417661 + 0.0i, -0.10033167475083773 + 0.016836213730008275i, 0.0012330947079304466 + 0.0008328847638985821i, -0.0013693730417308225 + -0.0006243758818346724i, 0.00516360624425167 + -0.0032257230121664864i, -0.004610580345509133 + 0.004081818712613108i }, { -0.006202131233500446 + -0.024078467809440316i, 0.01672459638791758 + 0.037616941414121044i, -0.10033167475083773 + -0.016836213730008275i, 0.16843885759325183 + 0.0i, -0.001090557085732676 + -0.0010371658555863683i, 0.0020648903821159146 + 0.0013947150428303306i, -0.005690421260370598 + 0.0023532532810039684i, 0.008646765574628002 + -0.00540166491702133i }, { 0.005504413307588104 + 0.0034386263852958865i, -0.006065999038217827 + -0.0025085721225362044i, 0.0012330947079304466 + -0.0008328847638985821i, -0.001090557085732676 + 0.0010371658555863683i, 0.08569310503786064 + 0.0i, -0.08547561247437362 + 0.01434328375257087i, 0.007981808781289922 + -0.01795267439287274i, -0.004956637889500463 + 0.019243102309853842i }, { -0.004914886730136913 + -0.004351225902610606i, 0.00921746725935234 + 0.0057581842700504i, -0.0013693730417308225 + 0.0006243758818346724i, 0.0020648903821159146 + -0.0013947150428303306i, -0.08547561247437362 + -0.01434328375257087i, 0.1434981978823869 + 0.0i, -0.010966463366607839 + 0.01657111724972043i, 0.013366013233513581 + -0.030062820356530615i }, { -0.0002076872505873023 + 0.0014734604150108534i, -3.946718796242592e-05 + -0.0015044833366675385i, 0.00516360624425167 + 0.0032257230121664864i, -0.005690421260370598 + -0.0023532532810039684i, 0.007981808781289922 + 0.01795267439287274i, -0.010966463366607839 + -0.01657111724972043i, 0.08038739599238007 + 0.0i, -0.0801833695328568 + 0.013455215916608022i }, { 0.0004537874518675592 + -0.0014349580892010399i, -0.00034778464579219366 + 0.0024673970456744933i, -0.004610580345509133 + -0.004081818712613108i, 0.008646765574628002 + 0.00540166491702133i, -0.004956637889500463 + -0.019243102309853842i, 0.013366013233513581 + 0.030062820356530615i, -0.0801833695328568 + -0.013455215916608022i, 0.13461347272067922 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, true, true}), ElementsAreArray({ DoubleNear(0.10722588478306473, 1.0e-7), DoubleNear(0.17955611744861075, 1.0e-7), DoubleNear(0.1005869685417661, 1.0e-7), DoubleNear(0.16843885759325183, 1.0e-7), DoubleNear(0.08569310503786064, 1.0e-7), DoubleNear(0.1434981978823869, 1.0e-7), DoubleNear(0.08038739599238007, 1.0e-7), DoubleNear(0.13461347272067922, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, true, true, false}), Matrix({ { 0.14498895166239428 + 0.0i, -0.051292618422173177 + 0.037536810661590175i, 0.040056540549173604 + -0.016391960460732637i, -0.00992698351847996 + 0.016169379284259003i, 0.01350486818114031 + -0.030375132732194814i, 0.0030863424461062103 + 0.01424211809937594i, 0.00029692141835531416 + -0.009918645419100222i, 0.002462838954340553 + 0.003585782032685486i }, { -0.051292618422173177 + -0.037536810661590175i, 0.11486333793533957 + 0.0i, -0.01841455321440437 + -0.0045714393934806405i, 0.03173364522514668 + -0.01298606047037312i, -0.012641553964152424 + 0.007249451773936473i, 0.010698844428329444 + -0.02406382759407057i, -0.002672922230872302 + 0.0034320395173505743i, 0.00023522747647835212 + -0.007857762316178008i }, { 0.040056540549173604 + 0.016391960460732637i, -0.01841455321440437 + 0.0045714393934806405i, 0.14290702460769666 + 0.0i, -0.050556096854322566 + 0.03699781164982136i, 0.007165140948558114 + -0.006865015984381365i, -0.0007574924445050117 + 0.004283644907956908i, 0.013310948919609895 + -0.029938969770120033i, 0.0030420250014668976 + 0.01403761251017538i }, { -0.00992698351847996 + -0.016169379284259003i, 0.03173364522514668 + 0.01298606047037312i, -0.050556096854322566 + -0.03699781164982136i, 0.11321399094649254 + 0.0i, -0.004312119224544701 + 0.0005736168531862811i, 0.005676377383877827 + -0.0054386119901164i, -0.01246003121424889 + 0.007145355361024769i, 0.010545217455970852 + -0.023718289998734824i }, { 0.01350486818114031 + 0.030375132732194814i, -0.012641553964152424 + -0.007249451773936473i, 0.007165140948558114 + 0.006865015984381365i, -0.004312119224544701 + -0.0005736168531862811i, 0.13601192612469165 + 0.0i, -0.04811682371373462 + 0.03521271007289405i, 0.03757643028326002 + -0.015377048317553278i, -0.009312351965275474 + 0.015168248307730664i }, { 0.0030863424461062103 + -0.01424211809937594i, 0.010698844428329444 + 0.02406382759407057i, -0.0007574924445050117 + -0.004283644907956908i, 0.005676377383877827 + 0.0054386119901164i, -0.04811682371373462 + -0.03521271007289405i, 0.10775154695976032 + 0.0i, -0.017274411758274592 + -0.004288397632651222i, 0.029768849009129725 + -0.012182025437771896i }, { 0.00029692141835531416 + 0.009918645419100222i, -0.002672922230872302 + -0.0034320395173505743i, 0.013310948919609895 + 0.029938969770120033i, -0.01246003121424889 + -0.007145355361024769i, 0.03757643028326002 + 0.015377048317553278i, -0.017274411758274592 + 0.004288397632651222i, 0.1340589020803501 + 0.0i, -0.047425904054497425 + 0.03470708331354839i }, { 0.002462838954340553 + -0.003585782032685486i, 0.00023522747647835212 + 0.007857762316178008i, 0.0030420250014668976 + -0.01403761251017538i, 0.010545217455970852 + 0.023718289998734824i, -0.009312351965275474 + -0.015168248307730664i, 0.029768849009129725 + 0.012182025437771896i, -0.047425904054497425 + -0.03470708331354839i, 0.10620431968327515 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, true, true, false}), ElementsAreArray({ DoubleNear(0.14498895166239428, 1.0e-7), DoubleNear(0.11486333793533957, 1.0e-7), DoubleNear(0.14290702460769666, 1.0e-7), DoubleNear(0.11321399094649254, 1.0e-7), DoubleNear(0.13601192612469165, 1.0e-7), DoubleNear(0.10775154695976032, 1.0e-7), DoubleNear(0.1340589020803501, 1.0e-7), DoubleNear(0.10620431968327515, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, true, false, true}), Matrix({ { 0.14790822233860984 + 0.0i, -0.05232536633261277 + 0.03829259314974963i, 0.049703932105785054 + -0.021041777875454293i, -0.01213612189973409 + 0.020311995764605812i, 0.020392379936064915 + -0.01478360853546129i, -0.00338680321955347 + 0.010509455228419954i, -0.00954649325566825 + -0.020213718597138434i, 0.008610470999798902 + 0.004679457553813153i }, { -0.05232536633261277 + -0.03829259314974963i, 0.11717604638906823 + 0.0i, -0.02303131388558008 + -0.00542413194994886i, 0.03937651444970579 + -0.016669744936817388i, -0.011041586678955648 + -4.948592982303526e-05i, 0.01615527804736583 + -0.011711889793275157i, -0.0018559613600158402 + 0.009622522604101538i, -0.007562935439912363 + -0.01601373872651552i }, { 0.049703932105785054 + 0.021041777875454293i, -0.02303131388558008 + 0.00542413194994886i, 0.162214095557417 + 0.0i, -0.05738634296424521 + 0.041996301937254156i, -0.019006454542998985 + 0.024376764454217686i, 0.00041289234721602047 + -0.01354440969832464i, -0.004472330247870893 + 0.004838297408918615i, 0.0003295649396114507 + -0.00286950110176563i }, { -0.01213612189973409 + -0.020311995764605812i, 0.03937651444970579 + 0.016669744936817388i, -0.05738634296424521 + -0.041996301937254156i, 0.12850946408159836 + 0.0i, 0.013034902250298595 + -0.003703084861520289i, -0.015057318410085476 + 0.019311792389497037i, 0.0028347800153908503 + -0.0005537796373973279i, -0.003543075349739736 + 0.0038330023352837277i }, { 0.020392379936064915 + 0.01478360853546129i, -0.011041586678955648 + 4.948592982303526e-05i, -0.019006454542998985 + -0.024376764454217686i, 0.013034902250298595 + 0.003703084861520289i, 0.13309265544847607 + 0.0i, -0.04708407580329503 + 0.03445692758473459i, 0.02792903872664857 + -0.010727230902831621i, -0.007103213584021344 + 0.011025631827383853i }, { -0.00338680321955347 + -0.010509455228419954i, 0.01615527804736583 + 0.011711889793275157i, 0.00041289234721602047 + 0.01354440969832464i, -0.015057318410085476 + -0.019311792389497037i, -0.04708407580329503 + -0.03445692758473459i, 0.10543883850603165 + 0.0i, -0.012657651087098883 + -0.0034357050761830038i, 0.022125979784570607 + -0.00849834097132763i }, { -0.00954649325566825 + 0.020213718597138434i, -0.0018559613600158402 + -0.009622522604101538i, -0.004472330247870893 + -0.004838297408918615i, 0.0028347800153908503 + 0.0005537796373973279i, 0.02792903872664857 + 0.010727230902831621i, -0.012657651087098883 + 0.0034357050761830038i, 0.11475183113062976 + 0.0i, -0.04059565794457479 + 0.029708593026115594i }, { 0.008610470999798902 + -0.004679457553813153i, -0.007562935439912363 + 0.01601373872651552i, 0.0003295649396114507 + 0.00286950110176563i, -0.003543075349739736 + -0.0038330023352837277i, -0.007103213584021344 + -0.011025631827383853i, 0.022125979784570607 + 0.00849834097132763i, -0.04059565794457479 + -0.029708593026115594i, 0.09090884654816934 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, true, false, true}), ElementsAreArray({ DoubleNear(0.14790822233860984, 1.0e-7), DoubleNear(0.11717604638906823, 1.0e-7), DoubleNear(0.162214095557417, 1.0e-7), DoubleNear(0.12850946408159836, 1.0e-7), DoubleNear(0.13309265544847607, 1.0e-7), DoubleNear(0.10543883850603165, 1.0e-7), DoubleNear(0.11475183113062976, 1.0e-7), DoubleNear(0.09090884654816934, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, true, true}), Matrix({ { 0.1600148373661883 + 0.0i, -0.05660831325976676 + 0.041426926565037325i, 0.014904441068646407 + -0.03352305033169775i, 0.003406194602468744 + 0.01571809565688982i, 0.00821432065580031 + -0.005131515052726417i, -0.001577453339938663 + 0.003942012381938904i, -0.0003099348789986093 + -0.0021988676442305883i, 0.0006789196610289703 + 0.0006976511727701832i }, { -0.05660831325976676 + -0.041426926565037325i, 0.1267671648654872 + 0.0i, -0.013951657546568809 + 0.008000746493440191i, 0.01180761590160059 + -0.026557675014019136i, -0.004234493158942353 + -0.0003112689286030403i, 0.006507559911140132 + -0.00406529560261987i, -0.00045962886263469004 + 0.000858131909226341i, -0.0002455370173808866 + -0.001741989816454759i }, { 0.014904441068646407 + 0.03352305033169775i, -0.013951657546568809 + -0.008000746493440191i, 0.15010748052983855 + 0.0i, -0.053103396037091216 + 0.03886196852196645i, 0.0018401662018998001 + 0.0012429267458099543i, -0.000972780664553925 + 3.669936878650457e-05i, 0.007705729032393714 + -0.004813796073816257i, -0.001479784940003356 + 0.00369794174471542i }, { 0.003406194602468744 + -0.01571809565688982i, 0.01180761590160059 + 0.026557675014019136i, -0.053103396037091216 + -0.03886196852196645i, 0.11891834560517937 + 0.0i, -0.0003292074075745701 + -0.0009161176495392581i, 0.001457818888146561 + 0.0009846730609189584i, -0.003972313504622444 + -0.00029199663861732286i, 0.006104642786485959 + -0.0038135918553715595i }, { 0.00821432065580031 + 0.005131515052726417i, -0.004234493158942353 + 0.0003112689286030403i, 0.0018401662018998001 + -0.0012429267458099543i, -0.0003292074075745701 + 0.0009161176495392581i, 0.12788113890390262 + 0.0i, -0.04524040201672899 + 0.033107695746374205i, 0.011911376032103797 + -0.026791052170617093i, 0.002722172845104364 + 0.012561634952661497i }, { -0.001577453339938663 + -0.003942012381938904i, 0.006507559911140132 + 0.00406529560261987i, -0.000972780664553925 + -3.669936878650457e-05i, 0.001457818888146561 + -0.0009846730609189584i, -0.04524040201672899 + -0.033107695746374205i, 0.1013101640163449 + 0.0i, -0.011149927631832505 + 0.006394060641521052i, 0.009436445982699706 + -0.021224442578786258i }, { -0.0003099348789986093 + 0.0021988676442305883i, -0.00045962886263469004 + -0.000858131909226341i, 0.007705729032393714 + 0.004813796073816257i, -0.003972313504622444 + 0.00029199663861732286i, 0.011911376032103797 + 0.026791052170617093i, -0.011149927631832505 + -0.006394060641521052i, 0.11996334767520318 + 0.0i, -0.04243933173114083 + 0.03105782486447599i }, { 0.0006789196610289703 + -0.0006976511727701832i, -0.0002455370173808866 + 0.001741989816454759i, -0.001479784940003356 + -0.00369794174471542i, 0.006104642786485959 + 0.0038135918553715595i, 0.002722172845104364 + -0.012561634952661497i, 0.009436445982699706 + 0.021224442578786258i, -0.04243933173114083 + -0.03105782486447599i, 0.0950375210378561 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, true, true}), ElementsAreArray({ DoubleNear(0.1600148373661883, 1.0e-7), DoubleNear(0.1267671648654872, 1.0e-7), DoubleNear(0.15010748052983855, 1.0e-7), DoubleNear(0.11891834560517937, 1.0e-7), DoubleNear(0.12788113890390262, 1.0e-7), DoubleNear(0.1013101640163449, 1.0e-7), DoubleNear(0.11996334767520318, 1.0e-7), DoubleNear(0.0950375210378561, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, true, true}), Matrix({ { 0.13677640627920057 + 0.0i, 0.04596313243364584 + -0.019458139067759957i, 0.01273991787589281 + -0.02865460745614108i, 0.00020472241135368168 + -0.011441670779733681i, 0.01885761588527282 + -0.013670969844325392i, -0.008828008473319882 + -0.018692400892535967i, -0.0011075871990022888 + -0.005224034124665789i, -0.004738328272957227 + 0.00010837735506835736i }, { 0.04596313243364584 + 0.019458139067759957i, 0.15000559595247492 + 0.0i, 0.008357668551428613 + -0.007816848334334183i, 0.013972139094354186 + -0.03142611788957581i, -0.01757599751654767 + 0.022542129071969147i, -0.00413573531833238 + 0.004474159188979107i, 0.003085467050316882 + 0.00578183185334725i, 0.0005521153026227929 + 0.001283176663980441i }, { 0.01273991787589281 + 0.02865460745614108i, 0.008357668551428613 + 0.007816848334334183i, 0.1283078624484775 + 0.0i, 0.04311731412184501 + -0.01825338374451172i, 0.00462053923874368 + 0.002677293238010426i, 0.0030937741277313182 + -0.0035905517848901377i, 0.017690042098157922 + -0.012824528484411053i, -0.008281420222260732 + -0.01753505643111799i }, { 0.00020472241135368168 + 0.011441670779733681i, 0.013972139094354186 + 0.03142611788957581i, 0.04311731412184501 + 0.01825338374451172i, 0.14071796368654044 + 0.0i, -0.0063596686621158315 + -0.0015824983434663915i, -0.001322554148697319 + -0.00044969343128151325i, -0.016487775436536792 + 0.021146427771745576i, -0.003879670279278249 + 0.004197140555223236i }, { 0.01885761588527282 + 0.013670969844325392i, -0.01757599751654767 + -0.022542129071969147i, 0.00462053923874368 + -0.002677293238010426i, -0.0063596686621158315 + 0.0015824983434663915i, 0.12307588331853327 + 0.0i, 0.025827053340674443 + -0.009919881863345796i, 0.011463794733576943 + -0.025784352870124306i, 0.0003274264834799846 + -0.0063347369555445485i }, { -0.008828008473319882 + 0.018692400892535967i, -0.00413573531833238 + -0.004474159188979107i, 0.0030937741277313182 + 0.0035905517848901377i, -0.001322554148697319 + 0.00044969343128151325i, 0.025827053340674443 + 0.009919881863345796i, 0.10611541960171428 + 0.0i, 0.004483849781007326 + -0.00448677964016358i, 0.00988402728122656 + -0.022231141879279045i }, { -0.0011075871990022888 + 0.005224034124665789i, 0.003085467050316882 + -0.00578183185334725i, 0.017690042098157922 + 0.012824528484411053i, -0.016487775436536792 + -0.021146427771745576i, 0.011463794733576943 + 0.025784352870124306i, 0.004483849781007326 + 0.00448677964016358i, 0.11545561063597445 + 0.0i, 0.024227965170544735 + -0.009305690010813453i }, { -0.004738328272957227 + -0.00010837735506835736i, 0.0005521153026227929 + -0.001283176663980441i, -0.008281420222260732 + 0.01753505643111799i, -0.003879670279278249 + -0.004197140555223236i, 0.0003274264834799846 + 0.0063347369555445485i, 0.00988402728122656 + 0.022231141879279045i, 0.024227965170544735 + 0.009305690010813453i, 0.09954525807708482 + 0.0i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, true, true}), ElementsAreArray({ DoubleNear(0.13677640627920057, 1.0e-7), DoubleNear(0.15000559595247492, 1.0e-7), DoubleNear(0.1283078624484775, 1.0e-7), DoubleNear(0.14071796368654044, 1.0e-7), DoubleNear(0.12307588331853327, 1.0e-7), DoubleNear(0.10611541960171428, 1.0e-7), DoubleNear(0.11545561063597445, 1.0e-7), DoubleNear(0.09954525807708482, 1.0e-7) }));


}
}

}

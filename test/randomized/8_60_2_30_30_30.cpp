#include "gtest/gtest.h"
#include "gmock/gmock.h"
#include <chrono>
#include <iostream>

#include "superpositeur/Circuit.hpp"
#include "superpositeur/DefaultOperations.hpp"

namespace superpositeur {

using namespace std::complex_literals;

using testing::ElementsAreArray;
using testing::DoubleNear;

namespace {
Circuit randomCircuit() {

    Circuit c;
    c.addInstruction(CircuitInstruction({ Matrix({ { 0.022125658945291615 + 0.28792994832673163i, -0.19114271778744885 + 0.1237057972266736i }, { 0.21998284493116704 + 0.05371761672024727i, 0.14558516794973306 + -0.03805627847718128i } }), Matrix({ { 0.2559986616014811 + -0.157528010517524i, -0.2316642765957791 + 0.45015114243962234i }, { -0.6516406714094966 + 0.1524230209771861i, 0.22805253145709592 + -0.13861975826844236i } }), Matrix({ { -0.41003582107757447 + 0.2886929423236755i, -0.30412058216186 + 0.3768903613194734i }, { 0.11130847067913785 + 0.09949032243428295i, 0.2646790338446844 + -0.36976737497620227i } }), Matrix({ { 0.038336369143342035 + 0.19789488383125395i, 0.32046184629144886 + -0.049141089405131816i }, { -0.1063880997038211 + -0.03739860215249942i, -0.012831578216669911 + -0.22670766778917104i } }) }, { QubitIndex{ 1 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { 0.0810477754603367 + 0.6155151933681159i, -0.014257227302357296 + -0.12939969131974705i, 0.1519698699904565 + 0.4758427708623709i, 0.396806153098333 + -0.4366330828949545i }, { 0.36208579927716616 + 0.21998321240428795i, 0.5581455711848199 + 0.10325377878691397i, -0.5576662014864717 + -0.3646775420267506i, 0.036021978432509025 + -0.23029232268116462i }, { 0.4085345242682451 + -0.054181878096312946i, -0.7184791264959797 + 0.20091026825279304i, -0.43012516651219534 + -0.019457440969505094i, 0.29140755236762506 + 0.05728929231474644i }, { 0.06277965337181743 + -0.5111713477273904i, 0.12268206663733099 + -0.298724872273395i, 0.22011735449035585 + -0.2695544721758933i, 0.6768054315568287 + -0.22649122321457116i } }) }, { QubitIndex{ 6 }, QubitIndex{ 4 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 6 }, QubitIndex{ 4 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { -0.2896340895345419 + -0.2782044447080813i, -0.8244721648105486 + 0.39869791895214607i }, { 0.8843890830258306 + 0.23784518273216101i, -0.2326327075300649 + 0.32736469306121924i } }) }, { QubitIndex{ 6 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 3 }, QubitIndex{ 4 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { -0.41576146090504396 + 0.13317997806009516i, -0.10075068362383044 + 0.48584336577742965i }, { -0.21729535897894084 + -0.062407634389052204i, -0.1251552162300654 + -0.38338565361513843i } }), Matrix({ { 0.20537938627177812 + -0.12686475151748594i, -0.02878337629492728 + -0.14680022309234322i }, { -0.42924730863304317 + 0.02639270213363287i, 0.03955282547695348 + -0.1673859013638768i } }), Matrix({ { 0.20356344972029614 + 0.1176722045865185i, -0.4874340110788125 + 0.21248812777927029i }, { -0.06994675259649187 + 0.1928907247497867i, 0.017274371320557688 + -0.38364909769020755i } }), Matrix({ { 0.11328535742927967 + -0.42489511557816423i, 0.1820939964405287 + 0.03409011493697926i }, { -0.47357746279060575 + 0.00625145005417755i, 0.015730979463531504 + 0.2727634598784278i } }) }, { QubitIndex{ 5 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { 0.03155410874030706 + 0.2834355926623949i, 0.695767349562449 + -0.6592240880888429i }, { -0.8680863509030188 + -0.4063184593512865i, -0.05939196353624088 + -0.27893366887772425i } }) }, { QubitIndex{ 4 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { -0.3857282821141701 + -0.80471757088841i, -0.21265438528368258 + -0.3980219037946619i }, { 0.2814542781410196 + 0.3527418500785321i, -0.5865301749285402 + -0.6725615439627723i } }) }, { QubitIndex{ 6 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { -0.5176409153949304 + 0.05815062806437192i, 0.267044823833769 + -0.06001549980524942i }, { 0.16307850104142116 + -0.06231339433615994i, -0.11403476435164109 + -0.12114429380769923i } }), Matrix({ { -0.2557709746276799 + -0.1884841334007645i, -0.04682999555528949 + 0.158020450620314i }, { 0.4878129036615091 + -0.05594207383907278i, 0.5835788580907366 + 0.026893538922324326i } }), Matrix({ { 0.050263388775357305 + -0.25607612661869955i, 0.12410715883486854 + 0.28617866650246165i }, { 0.06879144282614173 + 0.09517300914976486i, 0.12453384480621708 + -0.6178792066016487i } }), Matrix({ { -0.4815397179508456 + -0.0521665207324673i, 0.060351967091817296 + -0.017670362528359983i }, { 0.15527586878698166 + 0.12469494580889098i, 0.09288763934360367 + 0.14760539768230516i } }) }, { QubitIndex{ 5 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { 0.06983910511189384 + 0.009410232023688226i, -0.023831163714082677 + -0.03612568331316768i, -0.08155633486312375 + -0.09211512134013722i, -0.12428940310467894 + 0.05493595071505248i }, { 0.2776795771222272 + 0.05279414335344851i, 0.055729232798806635 + -0.07898958568478417i, -0.11723411033342483 + 0.05739756855525712i, -0.11968644680802741 + 0.021616525524414235i }, { 0.002349222051218903 + -0.062322681431779256i, -0.16328073545871122 + -0.0712932659996636i, -0.10135506894872429 + 0.013664519922253022i, -0.21520716138691404 + 0.0032125152039130353i }, { 0.020969364857417603 + 0.13720721649254466i, -0.01564903034731461 + 0.07518437457435584i, -0.07540484027988252 + 0.0390130832102845i, 0.03383727591147678 + -0.08141023271885477i } }), Matrix({ { -0.08332350935887314 + 0.04444281629201452i, -0.015009096527930975 + -0.050823373940587474i, 0.1408678624553698 + -0.17412177391673941i, -0.03511751841125945 + -0.157678006260264i }, { 0.1345265053525941 + 0.05444977116811085i, -0.03925144491252906 + 0.14184814128465928i, -0.08942188275837964 + 0.068649906821732i, 0.20245297636626744 + 0.058441232520564323i }, { 0.06235401886029251 + 0.1772776528199466i, -0.08955866452281232 + -0.028081203398055928i, 0.05411216773823429 + 0.015210808901073887i, -0.12748674706614688 + -0.054906827165524294i }, { -0.07724814677761152 + -0.15408210904861908i, -0.0027235472302867404 + 0.08134430474985055i, -0.07095888211492019 + -0.05965225638684464i, -0.12852367591899372 + -0.08963641408558311i } }), Matrix({ { -0.07082134933061253 + 0.03656712202481029i, 0.017654555579984153 + -0.0871935329984874i, 0.15363418270842852 + 0.053466488387940186i, 0.1779655055996277 + 0.083214358718489i }, { -0.025494906158092134 + 0.05485035976302653i, 0.04782454524282622 + 0.2115623982481365i, -0.17923243875433728 + -0.1522140424268737i, 0.059946963013806545 + 0.05787460101636522i }, { 0.06921288425885641 + 0.001922834520625429i, 0.11313415937942911 + 0.06073332001967582i, 0.019512122344863235 + 0.1546638394031108i, -0.12138550065075843 + -0.006239622560843533i }, { 0.16396265762651385 + -0.0011242769781387915i, -0.14934222218679677 + 0.13861402589172497i, -0.13681466765165334 + 0.04022481500615263i, -0.05592334457007893 + -0.012175504405974221i } }), Matrix({ { -0.001474154906723742 + -0.04571792916233216i, 0.038845485051779066 + -0.060573005247451246i, -0.05225954305062264 + -0.18138173864682494i, 0.06304778295815353 + -0.13354920264483783i }, { -0.006206511736892561 + 0.0009393405387379254i, 0.06676457854179534 + 0.059412945589253i, 0.13635468807390339 + -0.04523860182702465i, -0.04288664058318922 + 0.07663170596064241i }, { -0.09628177185285315 + 0.09032209486381176i, -0.08175760082108585 + -0.07950409787923017i, -0.02671529297798299 + -0.03466873724231578i, 0.1005568042712324 + 0.07850977934201968i }, { -0.09075303144783116 + 0.01061987633211073i, -0.057789034099187155 + -0.01399780896683393i, -0.04456821055168455 + 0.01474831944618761i, -0.021146785063703422 + -0.016841625247484924i } }), Matrix({ { 0.09781927127972664 + -0.02161819770889269i, -0.15384435727686602 + -0.08244451727785192i, -0.0984828614790936 + 0.04671440900091073i, 0.15371682631738856 + -0.03849790936835225i }, { 0.02569763709152844 + 0.12414095530634206i, 0.019080671473306655 + -0.06423898779579329i, 0.09337382576020928 + 0.15660964277505543i, -0.11161215949535305 + 0.1621579392882939i }, { -0.031483584023358366 + -0.024643727625328505i, -0.012866383866595735 + 0.06646832877217415i, 0.1412698681140319 + 0.01709678618025879i, -0.021028553166401776 + -0.04796476395337507i }, { -0.06404759655476604 + 0.08799938339458356i, -0.03449133208667199 + 0.1058963186820904i, 0.0819078193023595 + -0.014079687879334403i, -0.04372503968042615 + 0.23419953598494428i } }), Matrix({ { -0.022294006481004696 + -0.04080324034707187i, 0.11492480568527194 + 0.011375899597567178i, -0.11429768799515859 + -0.09915140897993105i, -0.07064644285140873 + 0.019594362349012923i }, { -0.099895057698578 + 0.11134732204105109i, -0.061378924602354126 + -0.06503562233064834i, -0.02828133971077612 + 0.028749773820732898i, -0.003146793679620278 + 0.11212514002107479i }, { -0.1307099676974481 + -0.010715493356488453i, 0.0720606269332923 + -0.1046232701145499i, -0.11994219581504527 + 0.03860512593175548i, -0.021466988835100162 + -0.012947549742623316i }, { -0.11228829944674536 + -0.16707454396580665i, 0.19301238681968555 + 0.1743853746714546i, -0.20865594345521088 + 0.13247499369492335i, 0.10053011570752851 + -0.05557797257654845i } }), Matrix({ { -0.028862865617068384 + -0.1715761761271665i, 0.06307025955331641 + -0.09308151559173074i, 0.00615274753171359 + -0.10485184354560076i, -0.0971122060297659 + -0.04204171196167251i }, { -0.08036489395816243 + -0.08766080204979805i, 0.037417460563965825 + -0.024636309987671755i, -0.03947016115721057 + 0.028952630598110853i, 0.15482918345430746 + 0.11860083092821594i }, { 0.080649873664299 + 0.14989539551485848i, -0.05269740157790177 + 0.09854466928784464i, -0.06460440946964233 + -0.002527307104291969i, 0.017931773625590706 + 0.1225914439408906i }, { 0.08067849635596316 + 0.12106157216722736i, 0.22718867385266858 + -0.12250788540700618i, -0.21031063623868762 + -0.03526737682605736i, 0.06651014893797448 + -0.021670927637490886i } }), Matrix({ { 0.07354819920596795 + -0.046504991478831394i, -0.0690984902161572 + -0.006298021116121512i, 0.017985714085479707 + 0.07122395303205155i, 0.09584181292780555 + 0.06634724547537818i }, { 0.2336008787632079 + 0.06110632292830863i, -0.13110481562694065 + -0.08771788549418277i, 0.009443456854176014 + 0.07749654782317987i, 0.05942471252508935 + -0.0014761559377460321i }, { 0.0543623562182085 + -0.011332386782260022i, -0.01661108738863745 + -0.02639663893948064i, -0.07217457397684343 + 0.15954782338332177i, 0.009609675701234827 + -0.08226650979587417i }, { -0.03981421024759592 + -0.043677584672724125i, 0.11305656188406452 + 0.14068306359363486i, 0.07561578669437963 + -0.14597677886641072i, 0.026430589446495886 + 0.026129156428369157i } }), Matrix({ { -0.011708777802937116 + 0.03971001865331139i, 0.022691775487141207 + -0.03330889159324281i, 0.0572194231568928 + -0.11978732739213178i, -0.003203616944846362 + -0.020653449472284254i }, { 0.07657425070329599 + -0.08507142606028145i, -0.0023896081750634933 + -0.038747491564334754i, 0.1813336928974333 + 0.010300179574573515i, 0.06712507937397459 + -0.08117709188282185i }, { -0.08044721051319793 + -0.07042351496450633i, -0.00896252941106964 + -0.004151812994411175i, -0.0021096623982392497 + -0.052540797484865585i, -0.07679732040020254 + 0.03152033248374251i }, { 0.015481170787587957 + -0.07150811262822433i, 0.1975979555010483 + -0.03662282827605204i, 0.024108511873218816 + -0.03487678581981534i, 0.015176953685772158 + 0.006395970221344779i } }), Matrix({ { -0.055119815116989476 + -0.09890529773246594i, 0.007602923944477035 + -0.009360850678086055i, -0.13090130886748147 + -0.11718620860027217i, 0.048877023161260226 + 0.11825803630484291i }, { 0.10733239863553679 + -0.02491682090956691i, 0.03538489048630038 + 0.09434005687560008i, 0.0002861557877822366 + -0.14384110807604816i, -0.06743844944885696 + 0.0015625839839895038i }, { -0.045779245843409505 + -0.000918497790585253i, 0.0669428608715781 + 0.006433925040519137i, -0.00032988931244970363 + -0.01427815751433634i, -0.09745954493810358 + -0.1337410555308367i }, { -0.07578743160399594 + -0.05600550843934302i, -0.17292625215759053 + 0.057570406531318306i, 0.035463552114925335 + -0.0360475208930848i, 0.10980229727019654 + -0.01052533738715601i } }), Matrix({ { 0.055949641996567365 + -0.02400468086788502i, 0.03601799074257192 + -0.02071952032747823i, 0.12705908519420944 + -0.04593755963984905i, -0.024095474360080953 + 0.01936941993179363i }, { -0.18619877457149 + 0.07156157005272679i, 0.13047881801958264 + 0.07846601706033066i, 0.11733481379788138 + -0.03549774911197396i, 0.05191978902483079 + 0.007740885522704043i }, { -0.014420934252114607 + 0.01905841830962597i, -0.04190196512956657 + -0.06603580993722234i, -0.055603889785464294 + -0.02430481123551875i, 0.009087118822902205 + 0.023115645620519473i }, { 0.10089020061237108 + -0.06475208140029245i, -0.03544228050678482 + -0.07097744110645139i, 0.02506448193303725 + 0.07062658536146867i, -0.0018663227226832658 + -0.16259794545659925i } }), Matrix({ { 0.03214827045078117 + -0.05188937737956395i, 0.04304065360996369 + 0.08529020297283425i, 0.026553351849011638 + 0.027847771365534773i, -0.226909557512925 + -0.16816972345478112i }, { -0.1553371889475948 + 0.1354841398658393i, 0.06595019694717405 + 0.07973585181163684i, 0.028654325933679035 + 0.12979241980536987i, -0.03950982152549194 + -0.0736080062970855i }, { -0.028660157798532298 + 0.08586950081358478i, 0.11284271429349324 + 0.0028655556805262878i, -0.004436338320782783 + -0.10427884338894951i, -0.13527971563870025 + 0.056618229696452825i }, { 0.12279385052726857 + -0.1260112780802535i, -0.025855040683154137 + -0.0270989780068044i, 0.016164608180454523 + -0.17291934065692907i, 0.041306996269571516 + 0.02884823636422808i } }), Matrix({ { -0.04706598697785161 + -0.04128722453767256i, -0.06919522350215096 + -0.011693813370267044i, -0.0955228052625579 + -0.13530700965490344i, 0.13215523924178316 + 0.11028788549446968i }, { -0.008878408424930824 + 0.13864584230587193i, -0.08388310012178969 + -0.03274514150749971i, 0.04630467444443974 + -0.1462382991103431i, 0.02603934102289245 + -0.06921039832167533i }, { 0.05489276972141413 + 0.061912379287452815i, -0.06819712804366934 + 0.024584270692223277i, -0.005392097990358 + -0.08673586442177375i, 0.12818934071099686 + 0.039570928299220175i }, { -0.1259787054317058 + -0.07263500522410077i, -0.01644744131171655 + -0.1262404613161036i, 0.07042749195146887 + -0.06520940392225814i, 0.06723561600408895 + -0.0743484779632318i } }), Matrix({ { -0.020028535191958845 + 0.11793391761655264i, 0.08681918989466539 + 0.1303736928903888i, 0.09290495622440116 + 0.06422691392599651i, 0.035004646472882 + 0.0937423050172521i }, { -0.02086984858944681 + -0.07623100256334099i, 0.035353884636177765 + 0.01618883639804223i, 0.01900946312231709 + -0.01603000727202467i, 0.07035117229907244 + 0.14421177379533998i }, { 0.0030978996652452503 + 0.039027033738212716i, -0.07509477742274824 + 0.0774559461340234i, 0.1648261621677494 + -0.07296101271803908i, 0.06216095433234211 + 0.026253127961611996i }, { 0.1351750598397677 + 0.030000736371128423i, 0.15480154525535011 + 0.16321575565071994i, -0.05920392744502991 + -0.012775286046961905i, 0.053437123391162675 + 0.034035839925452956i } }), Matrix({ { 0.08354579293689315 + -0.04794131259728878i, -0.07898958789509979 + -0.10202928347843412i, -0.0055721078339063 + -0.048133405716176796i, -0.07395297647913639 + 0.04807547349751447i }, { -0.023475374357326734 + -0.07878883807129773i, -0.1165872889309575 + -0.24284626865454675i, 0.03685546694074723 + -0.04769034743985567i, 0.0375625912328805 + 0.019271608033969604i }, { -0.113498370887048 + -0.019467978255153756i, 0.09667828380084427 + -0.024411617197406633i, 0.0645962193283892 + -0.06197551994501073i, 0.13386840369630992 + 0.03311006422506083i }, { 0.07851375947428076 + 0.04287565182240351i, 0.03903319693865875 + 0.03861312385888605i, -0.03204549253331738 + 0.022649005253242146i, -0.16091273604429926 + -0.040421346261901955i } }), Matrix({ { -0.06255295732679535 + 0.053542800842144446i, -0.033789759556725654 + 0.0004185278029044343i, -0.104704401965655 + 0.02400315812962015i, -0.10877171956427176 + 0.07292981866330744i }, { 0.05207774597684518 + -0.17584287803126727i, 0.034675511616899087 + -0.06667098836897097i, -0.010181285416179018 + -0.05718424863713119i, 0.07514928030696519 + 0.038390508249060935i }, { 0.13178382067840685 + 0.03299160354949241i, 0.0789125147091318 + 0.1305099463602849i, 0.07494050713502404 + -0.09759896782158123i, -0.15012147820334423 + -0.06860601295326249i }, { 0.18558296578514755 + -0.06432303609867342i, -0.01658702860815858 + -0.1903943466114938i, -0.040652921290162625 + -0.0770608782262483i, 0.003393130611145213 + -0.04880885531360907i } }) }, { QubitIndex{ 1 }, QubitIndex{ 4 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 5 }, QubitIndex{ 3 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { -0.19380818099470276 + 0.12241213508421553i, 0.3772591478945214 + 0.5746347622356045i, -0.3491790191775488 + 0.013818508946820202i, 0.289487460058411 + 0.5186561051116622i }, { -0.0684265994458306 + 0.3384727069039514i, -0.008648329966096324 + 0.22796822939904995i, 0.8787781387920119 + 0.11301260524504216i, 0.07456058735463852 + 0.195262829522565i }, { 0.5745529876252452 + -0.30922692664129564i, -0.36125731896324575 + -0.12179645958143559i, 0.03175982408113284 + 0.1643809699470355i, 0.4362289966820607 + 0.4589126462924824i }, { -0.5802257237818399 + -0.2565411605293842i, 0.08747085154157277 + -0.5678324930763446i, 0.124006067613076 + -0.22238008162246875i, 0.11253342586824466 + 0.43582757474539574i } }) }, { QubitIndex{ 2 }, QubitIndex{ 1 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { -0.24747074512584466 + 0.022645365123369444i, -0.41455427276024875 + -0.12524918476824648i }, { 0.37706443583096955 + 0.04041573136611018i, -0.07853512686057981 + -0.11322563514816557i } }), Matrix({ { -0.4598299029018548 + -0.10650697533767778i, 0.48094836659389417 + -0.09360529696874155i }, { 0.3331839440134415 + 0.49118992157912883i, 0.19399914198262136 + 0.07954015488858049i } }), Matrix({ { -0.14821523001504183 + 0.22013422180021688i, 0.2308889352600034 + 0.11089128197405312i }, { -0.17145853339050457 + 0.10471603212323134i, -0.0439745261779867 + -0.3811938250499029i } }), Matrix({ { -0.019455253078790202 + -0.04677082829065108i, -0.30215802331597774 + -0.40917018931620946i }, { -0.14918506816076016 + -0.28940548498912694i, -0.14558570186544187 + -0.1291124325800104i } }) }, { QubitIndex{ 6 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 1 }, QubitIndex{ 4 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { -0.0732449676610949 + -0.010436784406478068i, 0.07847908729404496 + -0.06031749517914929i, 0.14781806080422416 + 0.008280364581614012i, -0.13060602244111377 + -0.038461627618067144i }, { -0.058925108969656755 + -0.024189475159359073i, -0.0018195941650972285 + 0.0594762244355077i, -0.0722949359791917 + 0.036248691727069224i, -0.12531153142776194 + 0.003032952611957704i }, { 0.06530106249485956 + 0.08587738744829221i, -0.10679681312671616 + -0.11212233060561035i, -0.05455573595735865 + 0.15389417818250833i, 0.1222570296028267 + -0.013912224751649358i }, { 0.013591782293478401 + 0.04140118713544528i, 0.03328239477271343 + 0.02519265675517131i, -0.12033582109196571 + 0.029311691392582665i, -0.2034591267809939 + -0.02385463121920299i } }), Matrix({ { -0.12775143816184964 + 0.028770159405939022i, 0.1939179584988419 + 0.09274353436897215i, -0.046815495766049896 + -0.025624490062034926i, 0.07415839807534035 + -0.007980665947238234i }, { 0.03557878833912579 + -0.027894874111727325i, -0.13139918061546624 + -0.0932804974798837i, -0.16752965252472216 + 0.12925318445471484i, 0.10524670779374247 + 0.04391764183111087i }, { -0.12091506338318687 + -0.21831040639510593i, -0.1095434582787474 + 0.10460493841580869i, -0.16039750109228443 + 0.02027200652223309i, 0.03791258629753874 + 0.07197076007508428i }, { 0.09546205334988098 + -0.06101533545243103i, 0.1272707981062354 + -0.06834027111495719i, -0.0206171129722049 + -0.01836201612710782i, 0.044488346389798636 + 0.05920559813722902i } }), Matrix({ { 0.05150386461558532 + 0.02538603233077621i, -0.06715867473589476 + 0.03555385450972576i, 0.0020063862430388184 + -0.17285931644372632i, -0.030696434320864517 + 0.14674225503034033i }, { -0.16664098390185386 + -0.031431117954798665i, -0.0021026213148238886 + 0.04002560686701352i, -0.014172435117852778 + 0.03283437230846513i, -0.03258133080053908 + 0.07836349134063461i }, { -0.022124963280353425 + -0.07531408578293236i, -0.06903727929709141 + 0.04605146439999979i, 0.0357886794942821 + -0.1557581994069062i, -0.0868555325275831 + 0.05440808296749906i }, { 0.014819635625788039 + 0.0009219672927042657i, 0.030536414427539543 + 0.04845943254754959i, 0.08144603824529195 + -0.0860779834272221i, -0.07005069478911403 + -0.05044779113994968i } }), Matrix({ { 0.004933790474118795 + -0.06611323635087821i, 0.09070213782072767 + -0.016684266737056287i, -0.003941633356926215 + -0.02480910295370757i, 0.12365000262109631 + -0.08231727457147706i }, { 0.1948779583041819 + 0.08166194386325346i, 0.15013434847728166 + 0.06772681700834096i, -0.00404243865766591 + -0.14439846266842282i, 0.07428883370079281 + 0.05128547104692542i }, { 0.12898191487812238 + -0.23865854186022556i, 0.18002270628332967 + -0.08593751853890509i, 0.0033299140785074586 + 0.043665773687754324i, -0.1756634088057351 + -0.03312113362478834i }, { 0.04313227866382823 + 0.03389372298476702i, -0.07270324662711411 + -0.02508361187497434i, -0.09514408138336995 + 0.0404177631653046i, 0.048847817917474945 + 0.04255855430943988i } }), Matrix({ { -0.03483722449473885 + 0.015232876897644231i, 0.005552683765107718 + 0.17520398520581767i, 0.004766166494575255 + -0.08994461991815371i, 0.11554287887949313 + -0.08089504121941458i }, { 0.1815785818490784 + 0.03204463331586901i, -0.1025465003320416 + -0.09089376973793944i, 0.020416582000909275 + 0.05394682634613383i, -0.09641937055127067 + -0.15551587108189874i }, { -0.05465118588948272 + -0.0038365366119725596i, 0.07080109075295676 + 0.06786009463412956i, 0.09453519998579964 + 0.06030762069979699i, 0.04591220933843257 + 0.059835787228668065i }, { -0.04346400100807947 + 0.16130063053117735i, -0.0497168527249237 + -0.12993082782393725i, 0.20352946437865066 + -0.08797096162222948i, -0.014095394165636698 + 0.0804532745148291i } }), Matrix({ { 0.18508865957478876 + -0.053137420444021866i, 0.09159760616384328 + -0.07064779687829315i, 0.14654451312590955 + 0.11075037736372165i, 0.015380813443808806 + 0.12467279142408065i }, { -0.09855883925433764 + 0.06923350948373952i, -0.15048744321449137 + 0.0514020845248874i, 0.015095823058974464 + 0.0470327740934638i, -0.04338983718466447 + -0.17854714123179694i }, { -0.08012998496728987 + 0.0455996977739404i, 0.042539871446842105 + 0.06185812902855854i, -0.12742077083804498 + 0.047910008585222645i, 0.14775133230695112 + 0.007650801006078577i }, { -0.10910984444668005 + 0.05290904592850176i, 0.09445964248212087 + -0.06435059218796546i, 0.05591077218296804 + -0.1050066221110247i, 0.031726080801034916 + -0.03002110180684382i } }), Matrix({ { -0.09494006159445555 + -0.04531384476681693i, 0.03158895149644175 + 0.027027038439965748i, 0.20891834331429562 + 0.0741267942525357i, 0.07223780788614018 + -0.01857010520995367i }, { 0.08988841322870986 + 0.12467538204091203i, -0.1351540663428825 + 0.20588775388961691i, 0.03023497997295522 + 0.03425914893277239i, 0.026899149572038497 + 0.059760337592662374i }, { 0.0747144189979145 + 0.09182744051425486i, -0.11089902041575679 + 0.04201099824432124i, -0.07812328248205752 + -0.14743446685779765i, -0.059911128665365854 + -0.0785522781082763i }, { 0.11562473855681094 + -0.039544857796829605i, -0.01450697199075181 + 0.05764612055136214i, 0.0350290824578717 + 0.14774277460379856i, -0.12966251232168824 + -0.010620786440167953i } }), Matrix({ { 0.0059578515384566605 + -0.01684516290568039i, -0.019264399866041115 + 0.029323826839489885i, 0.027888312092627772 + -0.07052142445877319i, 0.1505250526818004 + 0.009181509189642568i }, { 0.031699426654142146 + -0.07920789982686917i, 0.18319072748288145 + -0.05928638248739311i, -0.0437955569062053 + -0.057568450936084536i, 0.18387143006736917 + -0.22715450148299296i }, { 0.016204036554619404 + -0.2111400131569735i, -0.07178559558352096 + 0.018119861965099675i, 0.00603762845824113 + 0.027981105973791987i, -0.09550849023827389 + -0.15785347995087654i }, { 0.03734075200619482 + -0.023179557004267982i, 0.06886202110851827 + 0.02662955336227223i, -0.08047216624560707 + -0.13253225319958842i, 0.07027178656234727 + -0.1321235242171048i } }), Matrix({ { 0.0067053160364275895 + 0.04234625960289969i, -0.09077822189672696 + 0.10660248579967083i, -0.09482352136679613 + 0.02794304849019591i, 0.03938337986079285 + 0.15771259673195898i }, { -0.04917188797582572 + -0.20222865284800587i, 0.055762970933023216 + 0.01955825067893232i, 0.04010338026847808 + -0.0424144009659016i, 0.13042851836863614 + 0.12855478394866013i }, { -0.04038775375071934 + -0.020871692379422182i, -0.03167229170559867 + -0.12113193848601132i, 0.017796273572872317 + -0.0488344938648739i, 0.01546617452914007 + -0.015210894467988295i }, { 0.0031918885505482814 + -0.06552096182520016i, 0.10045537127182126 + 0.10061640260110594i, -0.0574445276334035 + 0.12904034787771163i, 0.08268885337444322 + 0.059724362351438895i } }), Matrix({ { 0.13511027997541988 + 0.045089847591758624i, -0.09016132340911684 + -0.029499947491169087i, -0.0038567885324639617 + 0.05469973073564493i, 0.13425167606501504 + -0.022835213816223898i }, { -0.03503848190109458 + 0.015661596184336435i, -0.022470665034915308 + -0.009307151099635645i, -0.16945506468617486 + -0.0378830133418498i, 0.08899287843285235 + -0.004821018859248739i }, { 0.09417289665735802 + 0.019496074577078935i, -0.07804926927418432 + -0.011264305918472292i, -0.0743735305543851 + 0.034547918959507914i, 0.103254971211034 + -0.03757052085257543i }, { 0.017834433235179366 + -0.18262562989914885i, 0.010524752662329197 + -0.029165899190312587i, -0.011418593827502009 + -0.15701570416014038i, 0.13885712706990277 + -0.01203380305798655i } }), Matrix({ { -0.08850764801802412 + -0.08119508512267185i, 0.12265896221470456 + 0.026086775507167745i, -0.08380748983171087 + 0.0021005890517922675i, -0.08340715960744834 + 0.10043072602641163i }, { 0.019739017384351538 + 0.055427568485398135i, 0.13254631500101358 + 0.10022708227058343i, 0.020424002195746523 + -0.11495429180090617i, -0.06397709683220167 + -0.0614924212629566i }, { -0.11058426467478837 + 0.017784785646999864i, -0.1421556090013936 + 0.05114279855488241i, 0.05229728554996624 + -0.18238170560954212i, 0.0651783415356396 + -0.018969322386038493i }, { 0.02618696378907682 + -0.11068742031002005i, -0.1856307416339699 + 0.02677450812723964i, -0.007486366830736156 + 0.017314908222326432i, 0.04019340328989381 + -0.044187427698379814i } }), Matrix({ { 0.06797626906546697 + 0.16626574677485234i, -0.07241900454353895 + 0.003440253975166197i, 0.04135659456128777 + 0.052042476264707975i, 0.15557997538823584 + -0.05484164045148131i }, { -0.05429107258672981 + 0.11427966275705832i, -0.04066533565602659 + -0.02154001307609467i, 0.1121677973579795 + -0.08567295367224503i, 0.009628210801559574 + 0.008720107527695836i }, { -0.04534496366411643 + -0.04057693981962942i, 0.10399965938900056 + 0.08981910065157499i, 0.04012706985355578 + 0.1995432970113466i, 0.04782757557009722 + -0.02457493614704946i }, { -0.0394648890871487 + -0.001650446609645528i, 0.05929107895503489 + -0.10354471833540001i, 0.03412038406985061 + -0.11032600351020865i, 0.016593322520675986 + -0.024113015438131134i } }), Matrix({ { 0.026495169523401606 + -0.06553971292776363i, -0.16275482037907277 + 0.03256859016646424i, 0.0044094770216725025 + -0.0652766518360024i, 0.11337763623341908 + -0.05574772002110628i }, { 0.11870549678804086 + 0.0895832412364594i, -0.010586887994469368 + 0.0434168028401783i, 0.16814777614492304 + -0.05455597871856706i, 0.11520496452968731 + -0.06717923025987023i }, { 0.05911793374271172 + -0.02654089153572914i, -0.16514249657317115 + -0.04556348805133218i, -0.013162150640514611 + -0.022943487015414817i, 0.02961077701846147 + 0.10677055171613842i }, { 0.06310259363418308 + 0.01739566550172669i, -0.05070677714632886 + -0.060303825247356516i, 0.14319717796992024 + 0.07114225843877185i, -0.10089645182242223 + 0.015583598875169259i } }), Matrix({ { 0.14771470119897157 + 0.19616091954101653i, 0.010725715395727755 + -0.008491762915625601i, -0.11484539983119937 + 0.12073641216812404i, 0.052058092511009124 + -0.060376478213802424i }, { 0.02831422755074753 + 0.13925134054751692i, 0.10816215977496332 + -0.0058525121487953i, 0.061465948089113015 + -0.016552104854898726i, -0.025840200833544002 + -0.005384091291505022i }, { -0.038555029849910605 + 0.032642606526405i, 0.01874557395044771 + -0.22143165687369298i, -0.08098909637258796 + 0.048713404665466434i, 0.08176183377318584 + -0.1346756919281133i }, { 0.05324811259575037 + -0.06217433762242589i, -0.062339521725943134 + 0.10431878772148205i, 0.0017988469414745906 + -0.00445580925123031i, -0.007575427733542763 + 0.16481925335245598i } }), Matrix({ { 0.10154629303706834 + -0.06044564281977699i, 0.133017170936489 + -0.0812642568988431i, -0.12623575975786105 + 0.009591732488264428i, -0.12013908735463899 + 0.19571666831085094i }, { 0.04093280087356393 + 0.13805326703662588i, 0.09412509279582112 + 0.07021436115901106i, -0.00031484049403326556 + 0.06359699475053603i, -0.0896900460739654 + 0.14176849387257848i }, { -0.018733005884966458 + 0.015341921117464498i, -0.15523732901073073 + 0.05885447806055744i, -0.004496545681225438 + 0.0967518409527097i, 0.009651576449688806 + 0.017676907497019303i }, { 0.07802188812050355 + 0.01817499320421529i, 0.010722048026171386 + -0.03686716082160775i, 0.09237528498049606 + 0.0009007877133348433i, 0.036025385443440756 + -0.00897094579557725i } }), Matrix({ { 0.06050804532379883 + 0.2222416649551696i, 0.009316044911015568 + -0.007461211480446825i, 0.054202218387671454 + 0.1286472331139805i, -0.022259350144246796 + 0.10230690571880982i }, { 0.11894426186586961 + 0.010165884757611002i, 0.08317239974139365 + -0.010407167885421042i, -0.24859252839368048 + 0.04826821693288904i, -0.03235876234665077 + 0.10064562680637705i }, { 0.0012307654969867252 + 0.03695436547157104i, 0.2019467131578715 + 0.03887043823391476i, 0.04977021642748387 + -0.028023232531499305i, -0.040468349227932916 + -0.005092332665300658i }, { 0.00928002373500201 + -0.10235233363409767i, 0.04717802411216994 + 0.058540684561854336i, 0.027583886110155335 + 0.07312052919569192i, 0.02882007141828599 + -0.08878538731458613i } }) }, { QubitIndex{ 0 }, QubitIndex{ 6 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { 0.004715342922863685 + 0.45875382722299385i, 0.233971914602829 + -0.3050668469897326i, -0.15896312214654157 + 0.03116354534403592i, -0.5227145862032322 + 0.5850154478333046i }, { -0.04686281564491662 + -0.061896755553471745i, -0.7149249565814688 + -0.2868714777415628i, 0.45709982405653843 + -0.18531974656542088i, -0.39514296300574653 + -0.0337359014195602i }, { -0.5293069944258212 + 0.11888247208722756i, -0.2010250609670218 + 0.2730730658491501i, 0.16884235827993135 + 0.7249658708225206i, 0.049130583487075385 + 0.18499734866348486i }, { -0.5068005856662268 + -0.482026544457732i, 0.3095345337706121 + -0.21905894579895005i, 0.28987473545123305 + -0.3039165733544599i, 0.17845432310449796 + 0.39845518722717865i } }) }, { QubitIndex{ 1 }, QubitIndex{ 0 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { -0.14851880632132297 + 0.3741165676463916i, 0.41906175486859554 + 0.4716502664135792i, 0.2913217937718762 + 0.04203719434547544i, -0.4226038756836061 + 0.41795057219977255i }, { -0.4379706211859687 + -0.30737063035691303i, 0.07535654780798695 + 0.016774356575167126i, -0.2053800625222705 + -0.7938753464912679i, -0.17327532140703072 + 0.07281256333168223i }, { 0.3609440303270196 + -0.2498854332971529i, -0.4996951522099916 + -0.0031557702778646363i, -0.16688608843198743 + 0.021039487477772983i, -0.3083714429704667 + 0.6589270822965345i }, { 0.20859746165338258 + 0.5616473668969616i, -0.46715601991889943 + 0.35781745693541i, 0.07157339380482879 + -0.45555359033885057i, 0.2705173471006642 + -0.09455049106982247i } }) }, { QubitIndex{ 2 }, QubitIndex{ 1 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { -0.19737616773136035 + 0.2742472329981924i, 0.4228190418846544 + 0.35776031097988303i, 0.4638120453413366 + -0.5087343651020967i, -0.2540203489627295 + 0.20150463018288967i }, { 0.8288869769348948 + 0.1983396790545899i, 0.02832370460815725 + -0.050782256352827564i, 0.2884390898364833 + 0.024708420983492407i, -0.2540559265777575 + -0.34910550401670815i }, { -0.20712998292544937 + -0.3304407727976647i, 0.5491640355201837 + -0.36848674802835046i, 0.2676058488010809 + 0.014653780883363568i, 0.236868326610707 + -0.5316090826037319i }, { 0.07802434078214494 + -0.035455928650473555i, -0.49676463785769664 + -0.07557659093326871i, 0.3974063851486081 + -0.46097793784914237i, 0.6079609884063819 + -0.010913078459566142i } }) }, { QubitIndex{ 1 }, QubitIndex{ 7 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 7 }, QubitIndex{ 0 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 1 }, QubitIndex{ 4 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { 0.9213965847501284 + -0.053092875995179784i, -0.15992367212307776 + 0.2817873943755754i, -0.11209811277597358 + 0.1299100286963055i, -0.05418939387627831 + -0.10416655289758826i }, { -0.000711755986880737 + 0.11446848272169116i, 0.5502885099520529 + 0.19175429048151885i, -0.2518907762587543 + 0.2850959434014391i, 0.69746722156971 + -0.12696504436703196i }, { -0.020124954106183604 + -0.10658371500287006i, -0.10094680001751845 + 0.2770348860889127i, 0.1894271005124486 + -0.7314581465019332i, 0.29899094755776634 + -0.4909043492985669i }, { -0.33511506677653946 + -0.10506536029508257i, -0.6033838996083744 + 0.32314457524719564i, -0.15977066449756647 + 0.47894511765066033i, 0.08092033687218209 + -0.3830162181843145i } }) }, { QubitIndex{ 7 }, QubitIndex{ 4 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { 0.0567192080909702 + 0.07820719530706394i, -0.28204065146730867 + 0.42359411144433506i }, { -0.5937061812841715 + -0.14386426614243944i, 0.3515024894208346 + 0.06894093092666156i } }), Matrix({ { -0.3103684085607204 + -0.061798301496502527i, 0.2231695390639343 + -0.26701531394218i }, { -0.2646118189696545 + 0.00931530292938659i, -0.264689501112639 + 0.18955764602611921i } }), Matrix({ { 0.12437588757720508 + -0.2143597878065055i, -0.10292581620587238 + -0.5460476792823917i }, { -0.13510750193390528 + 0.3261307038196259i, -0.1679674189298115 + 0.18142189404307646i } }), Matrix({ { 0.02432142394093422 + 0.2329610447956301i, 0.1182078045406399 + 0.003262233229637576i }, { 0.44856228413199195 + 0.07157921952821947i, -0.009814294405121243 + -0.040632458522054576i } }) }, { QubitIndex{ 4 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 5 }, QubitIndex{ 3 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 4 }, QubitIndex{ 0 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { 0.33998139459645627 + 0.8827404355108519i, 0.2622362769675809 + -0.19082481464563866i }, { -0.32411681773767553 + -0.011413294965195858i, -0.21218290159541792 + -0.9218440439836824i } }) }, { QubitIndex{ 2 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { -0.055088191599482306 + 0.3916104009614099i, 0.3263042156996379 + 0.0032179911679503514i }, { 0.15187880328967246 + 0.14132214243868285i, 0.044479411693724595 + 0.26120411478347266i } }), Matrix({ { -0.33754126421337954 + 0.011448956792958404i, 0.17274746826074405 + -0.02495146636270295i }, { 0.15923891623808567 + -0.1641578811640509i, 0.223462426960856 + -0.5142559042982564i } }), Matrix({ { 0.5615585894835322 + -0.04147188804180571i, 0.30747413770901855 + -0.06972590025442682i }, { -0.22049371331960732 + -0.25057077838698255i, 0.266969499593105 + 0.19753278653816053i } }), Matrix({ { -0.03239472823679584 + -0.11937888929664146i, 0.1313327673051231 + -0.16661552780380517i }, { -0.43518755975485046 + 0.03220762042723831i, 0.3717297989875429 + -0.2925137698410984i } }) }, { QubitIndex{ 1 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 6 }, QubitIndex{ 3 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { 0.03286412420719875 + -0.035121609566059406i, 0.08582126121786585 + 0.03626277575831446i, 0.044994348279864656 + 0.010360437302366847i, 0.001197278324689662 + 0.1216192246646557i }, { -0.015645065020970135 + 0.12549690660383894i, -0.03121199591457787 + -0.05834137531439647i, 0.02654939726823393 + -0.0625290587874817i, 0.06170358765031824 + -0.1690186681701584i }, { -0.0579428424336608 + -0.04526952091678958i, 0.08770879285826921 + -0.06811792000220109i, -0.026893718942457068 + -0.13491033552285367i, -0.047071421918386425 + 0.03223639509436933i }, { 0.08170139867651816 + -0.07841849306077976i, 0.005627601826042174 + -0.058083949966533835i, 0.03982460741565717 + -0.06977251404941051i, 0.019920041107420315 + -0.10110321275992828i } }), Matrix({ { 0.006223962800567564 + 0.06641130409110621i, -0.12477609568134183 + -0.11024751824400722i, 0.08007770351613328 + 0.156243154544434i, -0.045450404257086734 + -0.039855477723038935i }, { 0.06723198935193812 + -0.029381226556959794i, -0.10455041713058767 + -0.06816269478393244i, -0.0744831339894976 + -0.20778613360107606i, -0.021214704000340517 + 0.1618116329930283i }, { 0.014350662339082337 + -0.04181409299959323i, 0.1249121047065155 + 0.10159153598608267i, 0.14785507081625984 + -0.06156993671701971i, -0.048373882668767965 + -0.03575256819227259i }, { -0.09903474687258636 + 0.10714950474013751i, 0.08909999501898369 + -0.05112782112478947i, -0.008366231067211839 + -0.03468909210707543i, -0.2083169711098782 + -0.15088648673359714i } }), Matrix({ { 0.09501201046652302 + 0.06175391566631468i, 0.17669524875727016 + 0.16528129829608143i, -0.05413149763367902 + -0.05105095399301103i, 0.15719174714699277 + -0.00586922800480802i }, { -0.07253716960847297 + -0.016092336861159975i, -0.011552076484927072 + -0.01910585155990301i, -0.10210461670570704 + 0.10759996439846002i, -0.00753904865649082 + -0.010502908519573726i }, { 0.001934748112202852 + -0.08295053488996092i, -0.14261648372582525 + 0.041344659106521145i, -0.13694461466687874 + -0.10538951615016127i, 0.08184025815162865 + 0.04222785431433547i }, { 0.06405624872770381 + -0.14101432281810908i, 0.009823663030719734 + 0.1405367087651335i, -0.07119413458843614 + -0.02129319213829415i, -0.07258782328461275 + 0.0026693259955233705i } }), Matrix({ { -0.07338183629245702 + -0.03501744277684706i, 0.24275155338673263 + 0.02386126502667521i, 0.06887940631335779 + 0.06398888707681458i, 0.20221747414878088 + 0.07026391841286794i }, { -0.00942030637250886 + -0.06327720333004155i, -0.026826705633799453 + 0.00403481653289796i, -0.035036712965374896 + 0.02067043876533833i, 0.012346646837536166 + -0.13341801964289446i }, { -0.03551171040556941 + 0.08735281797794645i, -0.09868188244946621 + 0.015830339380158463i, 0.0006001650710080399 + -0.2587744212868486i, 0.05480141736248285 + 0.10894680831950414i }, { -0.05581785747390937 + 0.038943784722301984i, 0.18725593192210402 + 0.13840123127532686i, -0.08703288982632632 + -0.09478375722945066i, -0.03064157256477662 + -0.062296559262784414i } }), Matrix({ { -0.12088089191782654 + 0.07105576742999554i, 0.006874557204931812 + 0.1389221683320019i, -0.017687931553306023 + -0.035323132763786125i, -0.1423097221034393 + -0.1089082003442543i }, { -0.027646664205749426 + 0.06152491320718522i, -0.056814813843569206 + 0.022358861980066633i, -0.08180505450437348 + -0.023237797787616525i, -0.07902991848656235 + -0.04860013287484154i }, { 0.1372623872554525 + 0.15029848305310722i, -0.05692547001052337 + -0.025237009591821628i, -0.06828376271284396 + 0.15432358651148506i, -0.01329673917669208 + -0.007840007522067318i }, { -0.08353437896977135 + -0.00242647932112466i, -0.1902934934568617 + 0.09463083678237105i, 0.15055558486594958 + 0.04986918995457141i, 0.01943282470025708 + 0.0287303773893596i } }), Matrix({ { 0.0020078149389481615 + 0.04519672568092658i, 0.0006850931459185735 + -0.004151372082118667i, 0.0014632345897167747 + -0.11670219445704595i, 0.019483138299791855 + -0.10434547388485477i }, { -0.04609329926055562 + -0.04193181590739771i, -0.044070876031757626 + -0.04985194393145616i, -0.13522001943242912 + -0.02763310470673492i, -0.009870319448982458 + 0.13165694934460595i }, { -0.08574898875215205 + -0.0024996829758435605i, 0.20058200115700428 + 0.030810264130013344i, 0.07474847857116218 + 0.08726665449083022i, -0.08326723066379843 + -0.11854111190941057i }, { -0.06491741230851424 + -0.07902904849392138i, -0.0853022349077972 + 0.006718538253236992i, -0.0014001348420481536 + 0.04805156659197525i, -0.05299703380141481 + -0.024993687387337357i } }), Matrix({ { -0.18772363045532045 + -0.04114535041792723i, 0.0724908772933585 + -0.023848744403096915i, 0.20414483293228872 + -0.04396468811125664i, -0.08007137398346677 + 0.04041573240183327i }, { 0.06855821348524196 + 0.020975444571851208i, -0.05029420164345285 + 0.10164723925364165i, -0.0013920735276997892 + 0.06918022453203984i, -0.10871383029545698 + 0.07708830621779218i }, { 0.015425046339806337 + 0.1292855431562802i, 0.04809365093706404 + 0.11365155646303943i, -0.008527561848877496 + -0.09961651063328468i, 0.004527365630292197 + 0.14142313121824696i }, { -0.021843477248612988 + -0.09267785801786291i, -0.13530771406229147 + 0.06232413007534855i, -0.10943150303304008 + 0.023903473044034274i, -0.03425422179158 + -0.07221420785418896i } }), Matrix({ { -0.028069309400223747 + -0.025721536835248592i, 0.169326791653017 + 0.08460532064451977i, -0.0014895944884799053 + 0.06888051603356131i, -0.06951374113219905 + -0.110545579071262i }, { 0.20544217155162395 + 0.07432434342078015i, -0.004933104809563334 + 0.08437150524154184i, -0.013055502569734395 + 0.020246333429783676i, -0.06788539176764508 + -0.05762640985842487i }, { -0.052881343836140834 + 0.13423505499761895i, 0.05051873976605714 + 0.03339758458489403i, 0.05284796351589827 + 0.054300089051708876i, -0.011860378508103281 + 0.0665872820792493i }, { -0.003749119806046545 + 0.1514796395948158i, 0.07736236727730654 + 0.20191038379231363i, -0.0010076532204963782 + -0.01876105324401896i, 0.01570843173698032 + 0.1585435938301102i } }), Matrix({ { 0.1487630019697407 + 0.09956489991092891i, 0.06415906352101361 + 0.08980994444293836i, 0.08929343877765554 + 0.20797157200260427i, -0.017168086029171584 + 0.05955056146855041i }, { 0.07998687669099823 + -0.02849804487889251i, -0.019608154540774633 + -0.024212492764573854i, 0.0590419911604186 + 0.041538355900342036i, -0.017014249277153663 + 0.08060649547626769i }, { 0.03587723800935608 + 0.20690174497842861i, 0.062476266721976995 + -0.03025855402651063i, 0.048210193613742285 + 0.17772509926660068i, 0.01143877816059627 + -0.010691717061535546i }, { 0.17039875615730987 + 0.1454625997048665i, 0.07606227254642108 + -0.06102649725369035i, -0.03506396221277668 + -0.0012131206845382373i, -0.005919192312362946 + -0.05459298422601116i } }), Matrix({ { -0.03341664511538116 + -0.026379512165590643i, -0.04292114127821945 + -0.06561627801338012i, -0.0031267583600184594 + 0.0667985886486238i, 0.11401972403836139 + 0.19528607481619426i }, { 0.18814138015611268 + 0.023149013885946375i, 0.08473932739338033 + 0.03410475465947929i, 0.06889467027854047 + -0.07322830060300513i, -0.10454537022788757 + 0.025711420335589017i }, { 0.15689419381560551 + -0.0410552575465016i, -0.03046200714949464 + 0.006337767341384314i, -0.09798969274063452 + -0.03062555586134115i, 0.08174907647545551 + -0.010393401375044764i }, { -0.009983026158928859 + -0.0066248514208158945i, -0.0067401655117889725 + -0.02593195787351879i, -0.023737414307994115 + 0.057249966054948184i, -0.03535347573085765 + -0.06455431838131681i } }), Matrix({ { 0.006359422291070962 + -0.0695208487831944i, 0.017714572639666682 + -0.06030490052390051i, -0.21604432455315045 + -0.023042134926498998i, -0.1143527235658225 + 0.19933778652719103i }, { 0.15213179359051188 + -0.1344935833896086i, 0.04843706179417448 + -0.03654915668368625i, 0.03691271731925202 + -0.058570062576676206i, -0.07275356383410193 + -0.02151402226376453i }, { -0.010947293688988722 + 0.25521890014141335i, -0.013607786209295617 + 0.11694394199349241i, 0.07385009860095504 + -0.06440930241354804i, 0.06884834550787006 + 0.07325438834613156i }, { 0.012680518414150448 + -0.11978392667634055i, -0.09251914519028431 + -0.06666885376503469i, -0.02827552121405871 + -0.10670320616895787i, 0.17073516982711476 + -0.01290323354907046i } }), Matrix({ { 0.0544247439278101 + 0.005915668566408724i, 0.04398955584887815 + 0.09239773846594211i, 0.016470603945860696 + -0.10210203059145652i, 0.12910242287291487 + -0.03224266379923136i }, { 0.12649080384285322 + 0.24717160275961i, -0.018247707999258997 + -0.12220801421772778i, -0.00684704341391173 + 0.0471860647764654i, 0.15916594933724765 + 0.08875013003053019i }, { 0.05038370729136929 + -0.04279040148777405i, 0.08891725398518734 + 0.053669001945953254i, 0.15227969381960219 + -0.054092998492407056i, -0.039693183323586845 + 0.047647086825199754i }, { -0.011234479302045025 + 0.008784195437263814i, 0.0053822698152890735 + -0.10477029874160704i, -0.04589581069583988 + 0.14366058582130203i, -0.0747143118685046 + -0.03193862047271101i } }), Matrix({ { 0.019851910197500162 + -0.02031249567960089i, 0.05025962945719883 + -0.08856709731581248i, 0.023831798644106058 + 0.05484806634988947i, -0.01450008325736085 + -0.11295550433798102i }, { 0.011640079355212551 + 0.08917996334081445i, -0.16835980694615316 + -0.012493563220678908i, 0.03418666989877888 + -0.158119088269816i, 0.04419697349999303 + -0.028590508194483808i }, { 0.026625046708994914 + -0.057436640928410415i, -0.1007516062269185 + 0.048321980247240104i, -0.08554457265560152 + -0.07842634263075986i, -0.005049189974850298 + -0.06968415008774889i }, { 0.03364556545239366 + 0.14552077424163176i, -0.1303927996590161 + -0.042687152648892855i, -0.15681548251847346 + 0.11327502388836748i, 0.029967411801085087 + 0.0007037779460582572i } }), Matrix({ { 0.05802468887006084 + 0.1120256960590603i, -0.05119214691605209 + -0.18444239112394228i, 0.0981383484889441 + 0.016588825938486988i, -0.0077134240525283055 + -0.15545292095355565i }, { -0.02667929419896524 + 0.09294520941294887i, -0.04544921484106323 + 0.04066109874779633i, -0.04854269771809495 + -0.06418014192305042i, 0.060206635081484966 + -0.006615844776586816i }, { -0.00026576819378051984 + -0.18498812065381842i, 0.0461711193213968 + -0.003107945604808116i, 0.08511973289473565 + 0.022379522311307274i, 0.033648902515225225 + -0.05278476962895835i }, { -0.07141743654172755 + 0.06353719759367747i, 0.05956945324096584 + 0.014124802670689884i, 0.01806556055889083 + -0.06729846407128985i, -0.1643826433246402 + -0.2444187851389476i } }), Matrix({ { -0.04031005983582279 + 0.006874225406785261i, 0.1780201568331988 + -0.2410196068339889i, -0.16068395282010972 + -0.04907504143321782i, -0.043846967298230205 + 0.04613329572677465i }, { -0.11627184993812473 + 0.023238835097375055i, -0.11585358753849606 + -0.09470518543287836i, 0.1434199903646604 + -0.013039293337293706i, 0.02391411847306937 + -0.06991790857438139i }, { 0.009412124952414844 + 0.01952430800305469i, -0.02091884186273011 + 0.046464290968106794i, 0.06838882890142521 + -0.19665245681496238i, 0.034379449938072855 + 0.02133710268963966i }, { 0.1204010246645129 + 0.04003382133924291i, -0.07416660731625002 + -0.05891494741365175i, 0.014125291028958329 + -0.12340573068979664i, -0.04651958654514728 + -0.11491747781488651i } }), Matrix({ { 0.0786681693758964 + -0.07542138278118529i, -0.03273999760710731 + -0.05644026709741645i, -0.03831810149846712 + 0.037305011978132976i, 0.058372622576843815 + -0.04709081206861307i }, { 0.11208053868972963 + -0.09309020660242866i, -0.10227077736941874 + 0.02921426125528797i, 0.10430666401227702 + 0.05281356992341169i, -0.1615668017583871 + 0.043662382373947574i }, { -0.021285670842162964 + -0.10946805555883593i, 0.03583284332203163 + -0.0763274523632745i, 0.006558131175546317 + 0.11593662389051829i, -0.02584302166252766 + 0.18634739227313463i }, { -0.06949644309830488 + 0.06872497761298463i, -0.04959336840791277 + -0.021971054822289955i, -0.048466272776318584 + -0.07490548687256024i, -0.022878223675546615 + -0.17311533017207875i } }) }, { QubitIndex{ 2 }, QubitIndex{ 0 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 1 }, QubitIndex{ 3 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 7 }, QubitIndex{ 6 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 2 }, QubitIndex{ 4 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 2 }, QubitIndex{ 4 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { -0.5727587121733653 + -0.3665404988702712i, 0.11708701228790991 + -0.43199000067377924i, -0.03895511463612672 + -0.3703814563513804i, 0.35599404186951233 + -0.26802818728059963i }, { 0.14202077112929049 + 0.05647073774226935i, 0.531536680251073 + -0.3043760656279156i, -0.7299830234052388 + 0.1869595904401891i, -0.004864710798035299 + 0.18333672910429016i }, { -0.511536124899494 + 0.15964860888282983i, -0.11010253788739285 + 0.3154543011537769i, -0.09876000727317163 + 0.17381107409030444i, 0.40494902233930247 + 0.6302869112018312i }, { 0.4401053513184605 + 0.18272129325715433i, -0.4376764684857417 + -0.34828804610564135i, -0.12269531420659568 + -0.48831650010625566i, 0.3307384121756689 + 0.3117048490355757i } }) }, { QubitIndex{ 6 }, QubitIndex{ 1 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 4 }, QubitIndex{ 5 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { 0.13391541858248845 + 0.004525736052275021i, -0.13613031427095343 + 0.16540689702720685i, 0.03078671020138384 + -0.06948143351415986i, -0.10153309292578366 + 0.10311648532750954i }, { 0.1105551146110627 + -0.022614990692385675i, 0.014634000808551182 + -0.03567795230218638i, -0.17280301862832315 + -0.10853496080192108i, -0.07321844595566993 + -0.05766385168329615i }, { -0.0003932110251265741 + 0.028511088812964446i, -0.12154044932597327 + 0.018468698594718995i, 0.0035462835031249687 + 0.09830595493649975i, -0.023303573156263496 + -0.03259626126132301i }, { 0.032922533445590485 + 0.07768259222596795i, 0.1084385825552918 + 0.0856524116920503i, -0.05015325539536574 + -0.017361649655077162i, -0.03057699888344506 + -0.11262912517160462i } }), Matrix({ { 0.10569749978594495 + -0.18527541791733157i, 0.023914258988504297 + -0.17421226389407274i, 0.07696112838729662 + -0.01836540147586631i, -0.10197190397371503 + -0.019461836326932477i }, { -0.13185776926264334 + -0.02117850527598073i, 0.09377957648915763 + 0.01791202900140438i, 0.06731824978438397 + 0.03316379824606604i, -0.16073897363526304 + 0.04497790878704459i }, { 0.07627256569031472 + -0.07837575483776767i, -0.030659326922270247 + 0.22158964676907236i, 0.008144077218412973 + -0.08513119615808916i, -0.10410048294244036 + -0.01751158495410027i }, { 0.08793827650759431 + 0.09435670809164699i, -0.14321696850715174 + -0.05212203474088427i, -0.007045372121835882 + 0.1290385781271463i, 0.016930661352673314 + 0.03113509354478313i } }), Matrix({ { 0.03564710985119088 + 0.13269279471652598i, 0.18067595670907077 + 0.046369053376990016i, -0.11000739280311879 + 0.0033826397170831613i, -0.0702342748819938 + -0.0851193292775706i }, { -0.02296822684985889 + 0.009460157458100445i, 0.11025641719191191 + -0.01329298293512249i, -0.07871553191007179 + 0.00445151991994125i, 0.009767324055087637 + 0.007377113442754492i }, { -0.01133744979575425 + -0.02351041635671952i, 0.02147361342166396 + -0.013880824502109914i, 0.10559936728954916 + -0.01838601385037003i, 0.02575747169502445 + -0.05188411010792725i }, { 0.16515614090294717 + -0.0934728137463984i, -0.020719868494448707 + 0.055934312300660226i, 0.06270412103855418 + 0.10032546586556244i, 0.0662208238174443 + -0.06877621585842604i } }), Matrix({ { 0.0434396359903525 + -0.0014606154963895475i, 0.12681842171655233 + 0.0021023410571815115i, 0.062222301750198654 + 0.11206964799807881i, -0.12243064396010464 + 0.11684784839197457i }, { -0.2647512045570052 + -0.07786713781324814i, 0.1576497894049307 + -0.026199038407014125i, 0.04014957966022159 + 0.07835569504375776i, 0.1676891466370705 + -0.0018111056512994598i }, { 0.0839769534316494 + -0.057938149414506625i, -0.19752824962601712 + -0.045707594759771826i, -0.007017015154728579 + 0.0834428084851797i, 0.04901851171638217 + 0.025784824803089315i }, { 0.016518078308073048 + 0.006182873052704614i, 0.09533423504210281 + 0.001476459755316733i, -0.07575455179834115 + 0.09736040742540539i, -0.17456011888582315 + -0.07127819642952894i } }), Matrix({ { -0.005430403682028248 + 0.12580927588847537i, -0.1043675815213974 + 0.025452916696430402i, 0.06858493244100224 + 0.042047670550924066i, 0.13029261215471385 + -0.03070573661055027i }, { -0.09181694593818424 + 0.022594142193739963i, -0.006973082200363908 + 0.17512533635951263i, 0.0792065733032286 + 0.15674407136667243i, 0.013119267991796036 + -0.03179333900152664i }, { 0.0668267653432669 + -0.0656370849175232i, -0.05126592006561489 + -0.0625554630382353i, -0.015882274995811588 + -0.019326528724251585i, 0.17863656500565933 + -0.034076882439184754i }, { 0.10005406818062594 + -0.13769752615912165i, -0.08071624659797666 + 0.11551502726989928i, -0.05166937575263455 + -0.026075332837157787i, -0.13307710413900553 + -0.003048872037205125i } }), Matrix({ { -0.031057471926650013 + -0.08394016059748388i, -0.13571861712144853 + -0.07012896985123353i, -0.05373163198800755 + -0.015437205518881144i, -0.06947282749944948 + -0.19650949283348376i }, { 0.08310430912307191 + -0.016415219925431542i, 0.042809369740368315 + 0.08721232832413386i, -0.07923316763311133 + 0.12081256072057484i, 0.19758666967727706 + 0.025212896221057823i }, { 0.15575741114590336 + 0.046700322033226514i, -0.0031954659520328104 + -0.1454586043515154i, 0.02163239489846443 + -0.056029679964669336i, 0.08303848648740608 + -0.00794795529830362i }, { -0.034582712907400136 + -0.1643012047496675i, 0.035745366410048586 + -0.10825579373102967i, -0.06448382535991545 + -0.11933164894409251i, 0.027619570248632975 + -0.18353717627515384i } }), Matrix({ { -0.10218225215430991 + 0.09379091344348855i, -0.03828219686207027 + 0.19533966117612572i, -0.05523558747596259 + -0.08295240711273011i, 0.09352224596686243 + 0.07911228153289727i }, { -0.11870023183163834 + 0.10649748544031203i, -0.07818311521420693 + 0.03694353667432655i, -0.13818417743768188 + 0.04989162773358551i, -0.05729315757538523 + 0.013810761872912306i }, { 0.016232343110571968 + -0.039143684057017306i, -0.021748263741133065 + -0.058976552351697305i, 0.061720123135286534 + 0.03885251984607503i, -0.1410665237315133 + -0.05070191526520922i }, { -0.12027674018911148 + 0.10516338097707567i, 0.008978513752209169 + 0.024984252799750573i, 0.06173210920693326 + 0.030335320859032008i, -0.09009670357460112 + 0.0730973662244634i } }), Matrix({ { -0.038705434083454726 + -0.05378880153827393i, -0.07482469932998176 + -0.04077278132569472i, -0.14504240790559403 + -0.07484303519973934i, -0.05871193907571357 + -0.04218889640260541i }, { 0.06569067475348175 + -0.22208318250800096i, -0.111123881493656 + -0.04378355052035857i, 0.021529380583406064 + 0.14344051145906048i, -0.09919225893179201 + -0.08341978325732047i }, { 0.04346995387417397 + 0.030557179160066356i, 0.030856079140519146 + 0.01658697746802654i, 0.05856503294736041 + -0.015601672066854567i, -0.07466978812902052 + -0.05771743603007948i }, { 0.06934055861655167 + 0.02148477551397648i, -0.013430819976084878 + -0.014899192594538433i, 0.028309887986988084 + -0.185863325520293i, -0.062310463533943185 + 0.12145738252177032i } }), Matrix({ { -0.10507080829337452 + 0.04317184787096746i, -0.002255252620130328 + 0.07935890730149386i, -0.12344276242964652 + -0.01653824971163805i, -0.0773895173709837 + 0.019449858998393407i }, { 0.05232353662790533 + -0.11394441923807964i, 0.06339298487962106 + -0.012378641953220849i, 0.0723288228649926 + -0.1132172600575977i, -0.0003799022264756066 + -0.05964906337682857i }, { -0.069079954863143 + -0.0050100041631891395i, 0.03624393722549315 + -0.1347867104019282i, -0.10238636648027521 + -0.09382410671751266i, 0.0642403336834052 + -0.2590910283964663i }, { -0.07950283090745988 + 0.11701184071245205i, 0.043891956397855564 + -0.09869423592150692i, -0.08517956649734326 + -0.07316152534346093i, -0.09580473747893284 + -0.09514130301682798i } }), Matrix({ { -0.022184304553987233 + -0.0073762508397291525i, 0.05718323616368038 + 0.0003557686876104987i, -0.006378291399364824 + 0.0972082148756789i, -0.1314315350491284 + -0.10827255020199802i }, { 0.04274916983006923 + 0.12437538323168898i, 0.062862945331443 + 0.028391351826718945i, 0.02961810507268616 + -0.1288269040108768i, -0.02537568535655063 + -0.020783930626574614i }, { -0.00690579709003164 + -0.11675608286663326i, 0.05867367130615651 + -0.013739513392787657i, 0.06296290522820801 + -0.099871408773622i, 0.0631689500545739 + -0.013740302176404104i }, { -0.003933808417553554 + 0.024817899614411162i, 0.07155639905476154 + -0.08256650116606762i, 0.06733180577121756 + 0.05150080793305592i, 0.13633775089815456 + 0.16603604742710235i } }), Matrix({ { -0.07197342505643635 + 0.0019580835193520538i, 0.11698237444582765 + 0.1471792346655916i, -0.06684853379608273 + 0.2796692806566703i, -0.004154137521116333 + -0.05688634960905121i }, { -0.009480178507822443 + 0.05297969842716109i, 0.014579757159507269 + 0.11519981300964834i, 0.006341231040790019 + 0.08556831443833027i, 0.14176536932280523 + 0.007534727114829566i }, { -0.017519016987489824 + -0.13917881964100975i, -0.046748517647139935 + -0.07367161888755129i, 0.05017951543684705 + -0.07747985522808504i, 0.046959593360550875 + 0.05465464600252706i }, { 0.062214868900467624 + 0.09130923066818936i, 0.028496381741875226 + 0.06023266456726648i, -0.057882016438803696 + -0.015850258615141992i, 0.08481282918909859 + -0.05515204159268063i } }), Matrix({ { 0.03523414349911026 + -0.022372224399725835i, 0.14318114825730807 + 0.0771166182261681i, 0.012532644528810383 + 0.05480984508672861i, 0.0141378533103227 + -0.07258498396497078i }, { 0.011400914171456627 + -0.04431350416602094i, 0.025616708004683617 + 0.11090480461716754i, -0.18361700189572405 + -0.2567711391454873i, -0.10498836200267198 + 0.051160081199436845i }, { -0.03655547185777064 + 0.03336506703982253i, -0.08925957381514209 + 0.10020396988014438i, 0.10593428964809093 + -0.06078594335333317i, -0.08358819679816899 + -0.08779932024334834i }, { 0.056089926015723456 + 0.04320298793508086i, -0.14060373016064714 + 0.019563404835747707i, -0.034661399267811525 + 0.020459690650562048i, 0.0847545977527401 + 0.053925835030577005i } }), Matrix({ { 0.03582633460126589 + -0.11168983847924546i, 0.001163594285184796 + 0.06735476588270155i, 0.04935967768960344 + 0.14114131755281895i, 0.0845086194725188 + -0.026285853141736017i }, { -0.08342530850007122 + -0.0010155749943328454i, -0.16561536041150446 + -0.08702279706423872i, -0.01042760416229773 + -0.014077253085692992i, 0.09064884218861737 + -0.009592936797035649i }, { -0.135216861967305 + 0.05508467998436976i, 0.028683639039760355 + 0.0457777275872835i, 0.0292091345174069 + 0.04485960786855077i, 0.0010876275691645287 + 0.04577344991514953i }, { 0.16962546177932522 + -0.05138519781083738i, 0.18567252887453992 + 0.005699357711230009i, 0.021994811058761776 + -0.03427575162044866i, -0.17741910187713647 + 0.05853403777374423i } }), Matrix({ { 0.13199949148402876 + 0.1086372651289369i, 0.01741924717563497 + 0.0731029209793792i, -0.03422983584530737 + 0.01900593707816284i, 0.03619569700444132 + -0.010873338111177985i }, { -0.013652935443785595 + -0.11039951172482451i, -0.011878412904150851 + -0.11941275142992107i, -0.0315194506050269 + 0.15093720241136765i, 0.15370603086870252 + -0.028015572041849457i }, { -0.07517435464834214 + 0.053945337311503944i, -0.084528596038514 + 0.08081716361632879i, 0.14363219170182298 + -0.05762087351790828i, 0.0241271545345975 + 0.16587801765965765i }, { 0.06610224880938947 + -0.14423540326264217i, -0.06498045734254215 + 0.06029720992486192i, -0.08096568264107498 + -0.09973173172528786i, 0.07082952769490317 + 0.0553338757326319i } }), Matrix({ { 0.027706634979784577 + -0.01058953606437694i, -0.02917862121565602 + 0.04283906073341517i, -0.18882760886483652 + 0.005837131915759908i, -0.022409110897466483 + 0.014815005420469507i }, { -0.07899738742220272 + 0.14995264184689802i, -0.0832123149911297 + 0.09949612007105028i, 0.171612176148831 + 0.03233632041808392i, -0.07925580760195397 + -0.0877163249705585i }, { -0.003622130960961168 + 0.13326832714319212i, -0.13322221053779798 + -0.08140251822587648i, 0.03474314339044809 + 0.0016827161529801668i, 0.14808716931040092 + 0.08540111547430454i }, { -0.02538274383671983 + -0.11065633821628867i, 0.05814256700615091 + -0.056879355439208454i, 0.06517353281195751 + 0.13270186752178062i, 0.002157828644264548 + -0.010840810255131401i } }), Matrix({ { -0.10096644592480832 + -0.2492955353451797i, 0.12296891107413412 + 0.13029469244101138i, 0.06168026233963283 + -0.13652708099185815i, -0.0681498255968138 + 0.07116911927881801i }, { -0.09831124170043021 + -0.010267312217570978i, 0.09194884407005947 + -0.008652466736688838i, -0.03373234367015921 + -0.1711261160941684i, 0.08665468278884089 + -0.08482546021406225i }, { -0.04723444021685289 + -0.12086715576409623i, -0.08955315654989103 + 0.04477581586023586i, 0.12919424367925803 + 0.017182948839852406i, 0.08611746641953211 + 0.05741198529523411i }, { 0.011313911792933383 + -0.0950409025738749i, -0.024954225919197437 + 0.16565214188163394i, -0.08847824187708896 + 0.05880826746902435i, 0.16585581256526707 + 0.03387304972054597i } }) }, { QubitIndex{ 7 }, QubitIndex{ 6 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { -0.022819791642749276 + -0.10507062145527202i, -0.0005128875557039637 + 0.1382687365926908i, -0.05936094854881044 + 0.11974822399373204i, 0.09335428286626819 + -0.048203113579002546i }, { 0.004455440121882095 + -0.08133881962292812i, -0.10580157358582717 + 0.12883109022396594i, 0.03553441255562936 + -0.163288630790404i, 0.21891399130403946 + -0.03044077417999445i }, { 0.019382667693007043 + -0.15578472398404045i, 0.11265889487559033 + -0.005201371488230812i, -0.06009620172311177 + 0.09121389459958669i, 0.09958424996654247 + 0.06227207033039715i }, { -0.0916657966155188 + 0.1260356135859051i, 0.1568641839011348 + -0.02421871112574091i, -0.06224677843659404 + -0.06068463908197534i, 0.017633152323115422 + 0.10136747305160142i } }), Matrix({ { 0.027217102364025574 + 0.0027931769109229934i, 0.10187740927530443 + 0.06465556401638695i, 0.11476489673550247 + 0.13025966030383268i, -0.038329113941339484 + 0.167292475824812i }, { -0.09393647532064454 + -0.04466393728127279i, -0.11113234617755835 + 0.08254507562321091i, -0.08899712212452737 + -0.11938779538966528i, 0.04034811007674897 + 0.036011565580398905i }, { 0.08566241861608528 + -0.03204549509761965i, -0.1010600573788229 + 0.020462372245167417i, -0.04023929133718927 + 0.0013553539671979592i, 0.16720396976892482 + -0.09474845481734206i }, { -0.04656254459297082 + -0.04212737493149926i, 0.12989000206892434 + 0.03686648766559659i, 0.08581121271959796 + 0.12942666617774826i, -0.020390275476879837 + -0.06301370229851612i } }), Matrix({ { 0.15001823676044349 + 0.001198635477733372i, 0.027898215741694505 + 0.01840727664896169i, 0.01713360804021172 + -0.03516669880226774i, 0.02958860721203133 + 0.16912569985111434i }, { 0.011579561215185412 + 0.007297141457494543i, 0.17295749758248205 + -0.022147109055895724i, -0.10772106334416115 + 0.17172408409712342i, 0.07838680255040106 + 0.042259672561824065i }, { -0.10456404097709586 + -0.014202565387747196i, -0.1402032202391433 + 0.008243232372712465i, -0.007442193179437374 + -0.028672683803832734i, 0.06359381942267296 + 0.04220883786766367i }, { 0.11965390796076272 + -0.040785994495124184i, -0.09871059729716646 + 0.11480555181885102i, 0.040663709664602574 + -0.01586068382668666i, 0.01657828178202414 + -0.029424771831349783i } }), Matrix({ { -0.03637132422236298 + -0.12250864105378718i, -0.018797517186740165 + -0.06700108498749915i, 0.10949484779933814 + -0.021457564540563048i, -0.12419305374043138 + -0.16327729448648748i }, { 0.09337178379893404 + -0.046163553778520515i, -0.0854490990069864 + -0.01631153184545022i, -0.12132312009846072 + 0.08991839981582031i, 0.009168534312406725 + -0.04288220737088653i }, { 0.05776818581187769 + -0.08645708407622547i, 0.0935726440883431 + 0.05651550823227512i, 0.10342992945879562 + 0.1264029380970033i, -0.019731634559716302 + 0.04968556682827755i }, { -0.020468614578348372 + 0.1027482650071974i, -0.0278368581470058 + -0.07834159833197038i, 0.0036197050676525767 + -0.09233690541913266i, -0.09172488372728357 + -0.10425357300797575i } }), Matrix({ { 0.10446940004714585 + -0.0910193874057731i, -0.16158354481212925 + 0.11020162474866112i, -0.09279898472277828 + -0.06880736291730867i, -0.051671794758742305 + 0.060749772811131135i }, { 0.05176413937469493 + 0.05316926991430481i, -0.08771889758418447 + 0.08997344236900431i, -0.013128036944774638 + -0.05770957299640837i, -0.1942580946328003 + -0.17932186887952473i }, { 0.043213904009268354 + 0.08687606123268564i, -0.15110278918923062 + 0.0021014150939623615i, -0.11329977516015594 + -0.013149557655919498i, 0.08930271094026597 + -0.03766841023936918i }, { -0.08490096681818614 + 0.037798820458965085i, -0.0015531501777668595 + 0.12448810813399286i, -0.058907666206187155 + 0.12796749159298368i, 0.14177089209819949 + -0.023223688951265874i } }), Matrix({ { 0.0072646198355401145 + -0.039503409653944783i, -0.019567746697299798 + 0.11702518819499275i, -0.004396400505492513 + -0.020489751545540162i, 0.03352580067466771 + -0.1261390321048966i }, { -0.028292294429268942 + -0.10158677154498075i, 0.10820769266385877 + -0.04123437111761812i, 0.029856800409225955 + -0.12485443534455531i, 0.14218248801044403 + 0.023146025907885535i }, { -0.0005936665355932569 + 0.04922109615038678i, 0.027803909932814345 + -0.027152375926005647i, 0.061809575566464214 + 0.031016524085969513i, -0.08789413176611334 + 0.09296332637274786i }, { 0.027721448643657293 + 0.09456731362514825i, 0.06516903959686575 + 0.03645598621385507i, 0.14215816352477822 + 0.01264462364560774i, -0.003987034536591826 + 0.025001310676982195i } }), Matrix({ { -0.09445019885346115 + 0.0651188338742167i, -0.19998111237902874 + 0.05318845710906123i, 0.018788494226891817 + 0.07664722970513597i, -0.015353214318381067 + 0.08565300308676929i }, { 0.132944141491046 + 0.03326456746909958i, -0.05003741946169266 + 0.016618552975811263i, -0.0817444746672274 + 0.03654657102367619i, -0.03063571334618939 + 0.08069682123420628i }, { 0.16641305580586963 + 0.07856519269105061i, 0.08166658260355249 + -0.07668276625881879i, -0.07548398560710148 + -0.00199045183187307i, 0.13074179397192834 + -0.10505935848892112i }, { 0.06228505054849516 + -0.004458370677115927i, 0.04081399513754431 + 0.04343658863077275i, 0.2034235525965758 + 0.010265454766992692i, -0.030118631099826303 + -0.03505839218241327i } }), Matrix({ { 0.06774851348183013 + -0.060872615998843485i, -0.13996970701273873 + 0.024792910181020828i, -0.0184174962014109 + -0.016447907431353128i, -0.009541007994065574 + -0.031220164494539196i }, { 0.017492675773936928 + -0.09058045946276894i, -0.07366251141720608 + 0.0750367654574618i, 0.12732467966176594 + -0.05009161093039818i, 0.02939823847908664 + 0.16206722348176567i }, { -0.0062734031742975 + 0.12712624183009374i, 0.13666962720268017 + -0.002783951431936566i, 0.14568045886747602 + -0.006788560691466205i, -0.10869385882734052 + 0.059582115482978i }, { 0.05393964737585167 + -0.012864981097029446i, -0.09871256682086811 + -0.033505521672158575i, -0.05330275616448352 + -0.017892189796523017i, -0.04006659875746367 + 0.03680942976859422i } }), Matrix({ { 0.10316698923188772 + -0.04936492328448723i, -0.06195141332423465 + 0.08212205166555553i, 0.003181146136079345 + -0.06440646478252116i, 0.05266757372615886 + -0.00010974318069048946i }, { -0.0815469153685663 + -0.12070420760435305i, 0.037314930996966644 + -0.0918895300635838i, -0.04833669679027619 + 0.0474224854061322i, -0.06287715551256608 + 0.07232046604014329i }, { 0.1956016788302563 + 0.0011116957991979676i, 0.0886130141922693 + 0.09175493201592784i, 0.0842984559285521 + 0.05288395876077964i, 0.03581658199618811 + -0.048970933714307815i }, { -0.10758231165075541 + -0.07427771664152566i, -0.09007672051147046 + -0.05297781772816916i, -0.11203101640772666 + 0.10373601950341921i, -0.005575369317048704 + 0.05411302063502206i } }), Matrix({ { -0.02614589243593904 + 0.18685508062390452i, -0.09761450855573955 + -0.10422395268396432i, -0.13555856313278825 + 0.023512735417374444i, -0.12523609771273003 + -0.030823057611651i }, { -0.025857164305766234 + 0.11022457229360418i, 0.14492277690267513 + 0.05025086405563158i, 0.027082900157813804 + -0.19095422881445184i, -0.0007875927391621495 + 0.12184301096491743i }, { 0.09031662084838862 + -0.06781735953328048i, -0.08543341155027924 + -0.05771242890419718i, 0.027353988179273148 + 0.1869221473030769i, -0.0391401546400749 + 0.10739169268903542i }, { -0.07879875892079105 + 0.11596540546424834i, 0.1760443515709692 + -0.002555723572843903i, 0.05599250456007042 + -0.07147133062700879i, -0.13326353112024406 + 0.038709054498698506i } }), Matrix({ { -0.028224289994319838 + -0.20527831923264464i, -0.018126471978670348 + 0.006111360813299369i, 0.05623500208685788 + 0.010837430620799542i, -0.1110115142438724 + -0.12862122779664092i }, { -0.07416071894940152 + 0.0782004306981918i, -0.09524992790223408 + -0.17813227506541984i, 0.012129112427780373 + 0.1475326394665889i, 0.010642394810002958 + -0.11364183174586409i }, { -0.02547641051605057 + 0.06513849343055066i, 0.05289453763364473 + -0.08660243754086136i, -0.09612334622101154 + 0.04422335940023006i, 0.028819582084647157 + -0.008801502003015592i }, { 0.12495826763476932 + 0.10061257301561576i, 0.12850884443166363 + 0.2598969886518978i, 0.0005514563848446145 + -0.12848329232058753i, 0.029802919528462878 + -0.10656883775366623i } }), Matrix({ { 0.052403078324926355 + -0.07877311237603576i, 0.12514237070820344 + -0.013892065852839015i, 0.0503935260732228 + 0.09825516334367611i, -0.013726246132420381 + 0.12116454515398713i }, { 0.002692478095867869 + 0.04669051398151867i, 0.07431371888420613 + -0.0006591907398615478i, 0.011222239501206602 + 0.22420236515512745i, -0.00012359266937772968 + 0.03267782604949015i }, { 0.1324336991509834 + 0.008732324569911914i, 0.00967038853199605 + -0.1286886544734496i, 0.13451112618849115 + 0.11355124407368053i, 0.02307895993353036 + -0.14195109637922093i }, { -0.1253507904460984 + 0.09309729796263273i, 0.043621948281133936 + -0.004178518281132482i, -0.047449612266462694 + 0.05598087092000189i, 0.14657637716717478 + 0.07319982156921569i } }), Matrix({ { -0.06191600442128617 + -0.006111350160808848i, -0.12340144729873108 + 0.042083367046271164i, -0.10205427042922388 + 0.08504398107666591i, -0.04711484424491885 + -0.08132697209007392i }, { -0.03358785875028086 + -0.06980926924133322i, -0.09475039638114585 + -0.02437964202232324i, 0.014124616128958989 + 0.1305744589321319i, -0.06666255957699461 + -0.07031695004370096i }, { 0.002281375938330183 + 0.12463500253517522i, -0.007504960893785396 + -0.04955555779929001i, -0.03830814812669065 + -0.06759049600078888i, -0.07008240530421254 + -0.14284516955744805i }, { 0.041446267602810734 + 0.04407495873441792i, -0.07183121084003137 + -0.08952314514117309i, -0.0028590162409811823 + 0.08523486677174212i, 0.09468488471256857 + 0.09568264545508909i } }), Matrix({ { -0.20266729234750322 + 0.09442364156540341i, -0.10571264741393552 + 0.11440701576556477i, 0.0796809617339386 + 0.08377252044969051i, 0.1421984614243855 + -0.008438187778500673i }, { 0.021434231770069978 + -0.13002341756988933i, 0.010604684117752972 + 0.03607842471695836i, 0.12131599310318017 + -0.05070065833448124i, 0.11779761363606572 + -0.01802145147806529i }, { 0.02932214392859 + -0.15234282976788435i, 0.05853246401430789 + -0.02720671716784045i, 0.009387187024524573 + -0.14406601295120142i, -0.17699306715614327 + -0.04898905447310343i }, { 0.09177335888902477 + -0.025203410522496018i, 0.010612072833853917 + -0.04074818216810354i, 0.036059436827656555 + -0.12948938154690745i, 0.1227391223245858 + 0.12386478805899744i } }), Matrix({ { 0.14977371708838277 + -0.09160592888269624i, 0.2410496237893866 + 0.07255854892877045i, -0.11916114913974823 + 0.028818850718378117i, 0.0034117775399131935 + -0.016613342969514437i }, { -0.22679980881188364 + 0.015785060441337435i, 0.05900778718030742 + 0.014923596223273314i, -0.1273617521056816 + 0.05300533513440185i, -0.020876632119956044 + -0.0344792589025761i }, { -0.0004699018585630037 + 0.1939244231162319i, -0.011147879665467857 + -0.09717431386834931i, 0.06942448229681218 + -0.07726273285120079i, 0.02845005375611502 + -0.15620006830281474i }, { 0.13673417574954994 + 0.0365096141392354i, 0.1270572499721995 + 0.02532631846978759i, -0.07004410150450177 + -0.03041212490165629i, 0.09995365520239691 + -0.12145742200218487i } }), Matrix({ { 0.0035663275269233415 + 0.027006815899037424i, -0.0918172296086992 + -0.04767296514080181i, 0.1294880090824806 + -0.12272120092692695i, -0.06978648951511188 + -0.15358793597150952i }, { 0.0016373764339157318 + -0.09245896811345405i, -0.06982834167563778 + -0.012065829219785586i, -0.056918631150979046 + 0.045086318628794336i, 0.10806211494236288 + 0.021940310187342237i }, { -0.06776776115780528 + -0.09500526937253025i, 0.016507071286641865 + 0.002326332940654891i, 0.16185414276725682 + 0.037516000933429834i, -0.07666468348839553 + 0.08540018272949183i }, { 0.11468106202067661 + -0.14914408791205808i, -0.05538483997080632 + -0.051665796483629935i, 0.1276255379581541 + -0.022646057117153732i, 0.10824724192197546 + 0.00704528855587213i } }) }, { QubitIndex{ 6 }, QubitIndex{ 1 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { 0.755479072571698 + 0.05350544773299421i, -0.6510493201556846 + -0.05023266560634646i }, { -0.5677635707927944 + -0.32254157197129524i, -0.656157695581606 + -0.3782440225039087i } }) }, { QubitIndex{ 2 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { 0.7177696535332369 + -0.3998327555294064i, 0.4244482174161971 + -0.09601410254120536i, 0.19056324868781568 + 0.13687911005344688i, -0.02839447789390814 + -0.282327834305463i }, { 0.04999432824425317 + -0.15919168167498288i, -0.5257275717830211 + 0.3214593641967243i, 0.32191484260927494 + 0.6516007135904441i, -0.2531557576846292 + 0.01150997713525512i }, { -0.11948210449484721 + 0.31887438982757i, 0.4146031646444175 + -0.47572186532430316i, 0.23441335117227083 + 0.4497066300282835i, -0.2141684556297253 + 0.427530435467167i }, { -0.3319854356953165 + 0.26632290251723345i, 0.055910767189300395 + -0.17194856531617014i, 0.39206166323722336 + 0.07641388327551599i, 0.09199983338433167 + -0.7862251970006269i } }) }, { QubitIndex{ 5 }, QubitIndex{ 4 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { 0.00589255205182404 + 0.045704785966645144i, -0.014341299497490051 + 0.16461888976170916i, 0.08006129034392162 + 0.11433701392089322i, 0.036947069750786536 + 0.042145205595617234i }, { 0.016381540269309894 + 0.01827609146081162i, 0.08619717817131588 + -0.137945631067115i, 0.021572950606693713 + -0.0445871833818521i, 0.057807550592192315 + 0.023779620596350585i }, { -0.03409825186267701 + -0.07104413856340425i, 0.09700624577690185 + -0.09263230261415638i, -0.08943937108203326 + 0.037769711465003804i, 0.10845309741730842 + 0.03761650424674973i }, { -0.001780110422986406 + -0.1475791428132273i, -0.04749749088860167 + 0.009058040432301235i, 0.08584100004335023 + -0.0812552959222075i, -0.13582853293610372 + 0.04295110785462741i } }), Matrix({ { 0.0799645515347135 + -0.009696786720288779i, -0.1012302234341424 + -0.007081454207613547i, -0.08245075420494133 + 0.09144238050790007i, -0.035724879942438205 + 0.018639868709963196i }, { 0.08923836665245646 + -0.02947749087689111i, 0.0022300322066261783 + -0.1304462767833571i, -0.012679630253916158 + 0.044450648274272184i, -0.05811137293961239 + 0.12649334381996333i }, { -0.03796808133919874 + -0.06457565573779066i, -0.013426896975148145 + 0.032821583045858194i, -0.1494998999405373 + -0.11229313322708181i, 0.1811325881547526 + 0.06271367220300043i }, { 0.07279450332090684 + 0.24517436943837478i, -0.0009841268560051221 + -0.04199458145069755i, 0.04450536126696183 + 0.09855879502935704i, 0.07238201477932199 + 0.07629608328028291i } }), Matrix({ { -0.055457224065209754 + 0.07637330002348189i, -0.0766548637337837 + 0.04322134465511163i, 0.008275689334831842 + 0.08857138601358068i, -0.07637990456999584 + -0.133203015150684i }, { -0.07451202760723472 + 0.0294264030658014i, 0.07279637492866009 + 0.047724280081406716i, 0.18624636069545727 + 0.010193129565900457i, -0.0773768992391331 + -0.09228593621289258i }, { 0.1375869362415666 + 0.01613476759189401i, 0.15123811667963435 + -0.10047349829996932i, 0.08322699917038828 + -0.09026597995716677i, -0.07645240226798257 + -0.02977991625872665i }, { 0.06822004720705367 + 0.12487736027432422i, 0.0944449943541246 + 0.1494803421197352i, -0.058606778734030536 + -0.030348556629268837i, 0.10915000587030554 + 0.006315697500981314i } }), Matrix({ { 0.06558187157593144 + 0.021886663217999407i, -0.22336875753542318 + -0.10879460119680379i, -0.024846066681805234 + 0.1314792793031308i, -0.06057121236175797 + 0.054226465025976146i }, { 0.02100035803945964 + 0.008846379640934607i, 0.09222308593260965 + -0.1674160788594612i, 0.03531115013135381 + -0.05218027316569715i, 0.03609941964015926 + -0.09532111125517552i }, { -0.12102499001406182 + -0.09835513069405645i, 0.08870491460266931 + -0.08370632417149879i, 0.06404855001729017 + 0.10900075091578994i, 0.09789817396738529 + 0.13217919452816537i }, { -0.023854207859384746 + 0.25037437732656903i, -0.05914105124833585 + -0.16525116865414105i, -0.011045247239918909 + 0.1466039385422774i, 0.12849006748403352 + -0.01684008318518028i } }), Matrix({ { 0.1396788022473336 + -0.08865865278536311i, 0.07168701945281214 + -0.04376693264996604i, -0.028007466518079865 + -0.12945633475086404i, 0.07262982190834258 + 0.021369685073966534i }, { -0.1357129123242819 + 0.03307076749021297i, 0.08578962295162064 + -0.16090020711536174i, -0.009673634154824595 + -0.04095856940993814i, 0.12624710199211428 + 0.013390011618432266i }, { 0.23501829905523783 + -0.06498917982160286i, -0.08358271743097803 + -0.05536991344436313i, -0.014495169689109725 + -0.03456744949801771i, 0.08831889851535847 + 0.11869932494989452i }, { 0.04375534376964862 + -0.00242775079752693i, -0.12633289450345322 + -0.12783622869858785i, -0.11495623179324947 + 0.1073512970494634i, 0.006256117631390824 + 0.1549007184108278i } }), Matrix({ { -0.11798650852733455 + -0.012844048558607742i, -0.10188430593719952 + 0.010180928364211073i, -0.03534196975038489 + -0.13318095613048891i, -0.015976562963126786 + 0.13153293541757835i }, { -0.05623294217528562 + 0.015637931106358145i, 0.029395418273886174 + -0.002489330669926036i, 0.02914981588407889 + -0.07765698818103066i, 0.035970119459201304 + 0.1632586135157775i }, { 0.027214371979301627 + 0.06885660629228983i, 0.011879301186383463 + 0.09595171186211388i, -0.07782737274059885 + 0.02340996472934355i, -0.07288246254299988 + 0.0305040448975034i }, { -0.049467073275778185 + -0.006260444600248931i, 0.09337044257076547 + 0.03740333598701033i, 0.11226936087877265 + -0.030744219283590075i, 0.02012723325144029 + -0.056791469967013425i } }), Matrix({ { -0.002613558869426128 + -0.05101568537264095i, -0.019595641824613427 + -0.02019838136818574i, 0.0597623746210513 + 0.07308518650945726i, 0.05295528096499491 + -0.058856125862397225i }, { 0.013189041544165904 + -0.04741677028628698i, 0.05093575722607331 + -0.10362522937530978i, 0.04159708003349767 + -0.009463045424220483i, 0.003791253519063324 + -0.18518301052010847i }, { 0.026337916260594757 + -0.09704485480152139i, 0.07453444117658377 + -0.050475869288399415i, -0.01682601436679206 + -0.07143744844725418i, -0.015275704064469655 + -0.0846243367148367i }, { 0.0128017956704762 + -0.021898303962398755i, 0.1075312285211654 + -0.03722219248306668i, -0.025883061695425976 + 0.022872558173467523i, 0.09691625760244184 + -0.006984676343736193i } }), Matrix({ { -0.16446614883469557 + 0.06053643726887708i, 0.11736975080957394 + 0.021662885267708085i, -0.15433160535949564 + -0.09796954606999245i, -0.06913366443107409 + -0.2859650731691496i }, { -0.10050064337467661 + 0.015646680161402256i, -0.0096081205484687 + -0.12573287547785328i, 0.09641506052223474 + -0.052154412310015184i, -0.1685590514498788 + -0.08823312921821656i }, { -0.07094622503742648 + 0.0578823952194752i, -0.03366449268579022 + -0.07869930723468184i, -0.09230640845278094 + 0.058457541481157914i, 0.06404627749439848 + -0.19260335665978084i }, { -0.049252689865305434 + -0.07414259743312042i, -0.06835865021067772 + -0.028646589476636796i, 0.027890797373600094 + -0.09425307408822382i, 0.19714545695534844 + 0.009444632135912774i } }), Matrix({ { -0.07042130950243435 + 0.1250815200297522i, -0.04990564270070267 + 0.11062795213999262i, 0.013547460186711663 + -0.04286321499937226i, 0.09712031977717742 + -0.09192402640605497i }, { -0.05877593299029362 + -0.012715448149342973i, -0.01882987581742235 + 0.014411566834068626i, 0.08222140579976367 + -0.030923030613629235i, -0.027320022795904342 + 0.04033418160514888i }, { 0.026824810080827703 + 0.12768394618999826i, -0.05870506801715883 + 0.022701681914169283i, -0.20205348812329452 + -0.2508452457068587i, -0.003419803217605635 + -0.022378232743950066i }, { 0.006094779194825518 + -0.08194269493921806i, -0.1572275346852292 + -0.1333923012687159i, 0.07288684670922158 + -0.030730059650528704i, 0.13645698860088884 + 0.008951254033021827i } }), Matrix({ { -0.07407362813896302 + -0.009800681315872811i, 0.09571577305576089 + 0.07658101823855046i, 0.15198380382843035 + 0.0038824938373825625i, -0.021980198479353088 + 0.019950050280663805i }, { -0.08234290525942199 + 0.1015246098061107i, -0.033442334945776885 + -0.025500920681625534i, 0.08616714011008704 + -0.13095576518525404i, 0.08307379011375203 + 0.030394466981588854i }, { 0.02538391320729616 + 0.09314548668548395i, 0.06846596171891899 + 0.03959548539811645i, 0.11361297777145934 + 0.015181630111559161i, -0.08394989568378441 + -0.1333214442414156i }, { 0.16003743527786204 + 0.03864387461944585i, 0.054425077577549726 + -0.02124560120870579i, -0.0903234339614321 + 0.02288917266578388i, 0.23346994688460185 + 0.10379826840282849i } }), Matrix({ { -0.06628818035623868 + -0.1483579941840701i, 0.004810705436846243 + 0.041288415620237946i, -0.0858629015845029 + -0.009722512466543078i, -0.18205646517464022 + 0.0892269984892182i }, { 0.09781455511902144 + -0.1402352744247277i, -0.08105149921497454 + -0.14000336571974795i, -0.029049548714911687 + 0.03385322147572321i, -0.019982290642924075 + 0.001510711361676677i }, { 0.008343392737689585 + 0.04053731689421684i, -0.11366571612301127 + -0.02372372949202703i, 0.0940036161454087 + -0.10567699767214596i, -0.0742183461876556 + -0.07416501683663508i }, { -0.05073355333061842 + 0.056380426945170425i, 0.06643893279520381 + 0.05235301382497953i, 0.1544761325844182 + 0.049468247774765i, 0.030420162765997284 + 0.0869927591823678i } }), Matrix({ { -0.10064032693685254 + -0.005022029530514369i, -0.009210315047405314 + 0.03784916382840317i, 0.0027070656915703897 + -0.07716972207888866i, -0.037154771759659096 + -0.016603566894866965i }, { -0.08651727960809112 + 0.13007364298982216i, 3.3628928864851995e-05 + -0.043159822257871835i, -0.03648552335791814 + 0.09277599088392471i, 0.0764213319729696 + 0.06422192558283378i }, { 0.024978480683482778 + 0.07962050853216965i, 0.029847962428848393 + -0.11948475407926097i, -0.16328840968797106 + -0.06882087201732594i, 0.02186653512665819 + 0.05402274843752485i }, { 0.0384668393669382 + -0.17170504854266655i, -0.04794348438766331 + 0.019975292481312537i, -0.06754163725156721 + -0.10596544900321506i, 0.027108589833678403 + -0.03673262946959032i } }), Matrix({ { -0.1099490677019726 + -0.017277021286094235i, -0.11822421425774889 + 0.017312269777441353i, -0.07528491989018317 + 0.11194821277872445i, -0.10673681741524373 + 0.06333984471346171i }, { -0.142031604767947 + -0.08119190811846849i, 0.0904534161594854 + 0.08879222930404256i, -0.1622107336531279 + -0.11641473100367734i, 0.018706183650101616 + -0.12035378196948458i }, { 0.006769405001381762 + -0.18422944547272152i, 0.15177633287069497 + -0.07879081280000474i, -0.08950582016835175 + 0.18447385544870204i, 0.05477039218931924 + -0.040316282185586916i }, { -0.002738600677128271 + -0.024973579012567394i, 0.0985998250090283 + 0.21192236166057168i, -0.024352150337411078 + 0.01549875854952965i, -0.12948438416704067 + 0.017723849280187758i } }), Matrix({ { 0.04161028397297391 + -0.049712012953783934i, -0.09627511459699176 + 0.02952423211317723i, 0.061512384447790426 + 0.012633017941098708i, -0.06612852316205285 + 0.026129261840942324i }, { -0.08061534859465048 + -0.06931704513642084i, -0.015941947616361224 + 0.04656789740201491i, 0.04563928655425787 + 0.02596499725853232i, -0.05911306063916942 + 0.03346308041901757i }, { 0.045161087461501444 + 0.08420804743482788i, 0.05843280697939375 + 0.03997449428384475i, -0.037060772316964245 + -0.12906611194860193i, 0.07564080418070288 + -0.0893018262154219i }, { -0.15048790207227652 + -0.16764664963595646i, 0.20872104686448698 + -0.07918548632962823i, 0.09122008938805791 + -0.03415609637509238i, -0.08381228712442551 + -0.04713234722838785i } }), Matrix({ { 0.04618392715844584 + 0.007865414512941812i, 0.11689116112580804 + -0.08099994510735489i, -0.0967173112079918 + -0.10243630217083063i, 0.038032560039219565 + 0.03312018323931589i }, { 0.01820363515818032 + -0.023426572756106753i, 0.09210682418252149 + 0.12221755360450015i, -0.21361315711717496 + 0.05400816208319142i, 0.042284543562504655 + 0.011579598140065088i }, { -0.016964734103610067 + 0.10731658331662096i, 0.047913798116186866 + 8.495806325792634e-05i, -0.0307360000044435 + -0.020720882103962057i, -0.06405325424692676 + -0.010273376370195913i }, { 0.017837788113253785 + -0.19829775193978735i, 0.09750446668529902 + -0.16721689007928262i, 0.00058783547772359 + -0.03905843496771021i, -0.052433681185170646 + 0.10237335644293437i } }), Matrix({ { 0.13353739403642345 + -0.14997602501706092i, 0.10161241710394359 + -0.03671361578128047i, 0.08119991938017541 + 0.10382217578700655i, -0.018871923219876203 + 0.01911249928105958i }, { 0.09845501957522021 + -0.030700229551633266i, -0.08989892080417403 + 0.008107590642094056i, -0.014060222949299072 + -0.09353082521047992i, -0.18241283220722335 + 0.000732778079660633i }, { 0.08509660554511064 + -0.017632007954080688i, -0.1764354674308681 + 0.001995722408876837i, 0.0026176446688854437 + -0.16345883109685225i, 0.029299792888943875 + 0.0423806746047284i }, { 0.13546957856108147 + 0.07212888088893475i, 0.012220833398249045 + -0.07933936965168854i, 0.12716316674793574 + -0.09747371432859275i, 0.17070524033633266 + -0.0308886541921569i } }) }, { QubitIndex{ 7 }, QubitIndex{ 5 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { 0.05024633604763306 + -0.07500695396614286i, -0.03429912302524764 + 0.16937444587313297i, -0.0664831574809876 + 0.04153510023667227i, -0.027472025938958127 + 0.056851756991893425i }, { -0.1678396466945931 + 0.16585985463369196i, 0.013848479778743301 + -0.08332860225700234i, 0.08705710680147978 + 0.0864760845698408i, 0.11811774230551801 + 0.16009268239002508i }, { 0.15142821640836748 + -0.08535887334027424i, 0.09836143164695557 + 0.06098207367903037i, 0.0868691300311706 + 0.059436174224213226i, -0.09080472723849635 + -0.06588725110580679i }, { -0.075119231234657 + 0.07788819640269293i, 0.057038972959330095 + 0.05157911943456163i, -0.00819561449341911 + -0.02871792857305946i, -0.06234354482559009 + 0.03518510197952074i } }), Matrix({ { 0.0924571417649444 + 0.0011887790171411685i, -0.02332852742846282 + -0.1851387827961194i, 0.09088349406488912 + 0.07404148083199256i, 0.019620961911020758 + -0.24685317426221465i }, { -0.2017832202051348 + -0.016574193059925687i, 0.03462174023275153 + 0.06929183652710805i, -0.13745368419214435 + -0.10293713247370832i, 0.03919522318078882 + -0.04182432712500952i }, { -0.02648545128307553 + 0.02654878563463856i, -0.1061203212620899 + -0.022521922294735527i, 0.04565880153451705 + -0.006406189875775716i, 0.11332951668978027 + -0.05195473096816174i }, { -0.05841363871018069 + 0.17981242543415435i, 0.09900190605697691 + 0.10162160273648344i, 0.04850931544181294 + 0.045439533826824335i, -0.16620651699786593 + -0.09520263268610334i } }), Matrix({ { -0.028238648993456048 + 0.10460545455515871i, -0.02577558565619128 + -0.16285836013603883i, -0.1251855884176628 + 0.0038188474472611155i, 0.04006126612452687 + -0.0804759927287056i }, { 0.04643136696222338 + -0.12742395040898596i, -0.057162271633768844 + -0.017627870663892962i, -0.056122398040615716 + -0.17035239614713155i, -0.2624330645771762 + 0.044140174455508885i }, { -0.08268792327225469 + 0.022031937067150696i, -0.04557744326759978 + 0.021575014878952043i, -0.21550292123402437 + 0.020740127867726887i, -0.05035385405987277 + -0.1035230513589318i }, { -0.016032640414605615 + -0.027741417979563317i, -0.05850105701006986 + 0.07618192410593919i, -0.008085993663685051 + -0.07353053442729923i, -0.02512780557304544 + -0.017581217938854306i } }), Matrix({ { 0.010450028966934415 + -0.0772742219137656i, -0.03357588654155121 + 0.050672417430567794i, -0.05473280688637157 + -0.02392416474528653i, -0.05427459955218562 + 0.012292692074942697i }, { -0.02328973745229389 + -0.018404842716734253i, -0.060602233295921695 + -0.11678826434239804i, -0.025518250554487976 + 0.0053863576813988935i, 0.06670063779354433 + 0.12088195503152256i }, { 0.01983345672644494 + 0.05924684208980385i, 0.07544698026305903 + -0.11673165294846141i, 0.006664766018319822 + 0.011108086928701709i, -0.1263454535929798 + 0.07273779678770992i }, { 0.05609582472868969 + -0.044500564971552754i, 0.07738994370756838 + -0.17105669592899858i, 0.024749046697370193 + 0.02197444577676613i, -0.0019055600616597471 + -0.01001662558168334i } }), Matrix({ { 0.06538779430328022 + -0.09029795851853951i, -0.021061389036326744 + -0.04067079761401058i, -0.07564160618875011 + 0.0187158316724401i, 0.017724126814373298 + -0.02224284021476576i }, { -0.06510975543844787 + 0.11299843630375173i, -0.1325735275486863 + -0.10943446727687206i, -0.09345642260517849 + 0.017817388208011077i, 0.023004381126225337 + 0.08343070650203414i }, { -0.1153061378929395 + -0.032409246769096976i, -0.02500774876647456 + 0.03823922167865339i, -0.09249154381471213 + -0.03558824214886567i, -0.011077843287809377 + -0.009948221106096998i }, { 0.14176289678964688 + -0.01167473753731371i, 0.09365105887716618 + 0.14127579679784522i, -0.10633678719183723 + 0.07046329917031795i, -0.07117385442612659 + 0.07691360270013413i } }), Matrix({ { -0.017073719439628068 + -0.0893535523206466i, 0.0680675806969964 + -0.04363354133687896i, -0.10702610783282092 + -0.026954443977766192i, 0.10491028377583426 + -0.23567857678829848i }, { 0.043121628842991984 + 0.19780578898135195i, 0.08478054170149518 + -0.01853197369507605i, -0.07162481749674195 + -0.06642063372565886i, 0.016054520366162513 + 0.08289819537910727i }, { 0.06128529337505718 + 0.16568293737903647i, 0.1889275221110385 + 0.09259537070208808i, 0.14397343656719216 + -0.2229602089202989i, -0.06960356708887296 + -0.03751203379111491i }, { -0.0507731646838663 + -0.025199156340890132i, 0.0019258993669907596 + -0.03303765948406687i, 0.1280215988918379 + -0.11090275943492264i, -0.13131138391163394 + 0.12182086098881635i } }), Matrix({ { -0.02303694269432995 + 0.10697814565926585i, 0.02354407553569068 + -0.033739862957933034i, 0.0715267148837363 + 0.021132951445017683i, -0.005400885002425128 + -0.07092783781247058i }, { 0.13650515721260567 + -0.042595686021748146i, 0.16779123163940626 + 0.03832890478401899i, -0.12820709137377528 + 0.03048257683077586i, -0.11770879916535598 + 0.13552743108200208i }, { -0.034407617352069174 + -0.04359697606163648i, -0.011131657190517109 + 0.02895159402185672i, -0.048092213312352826 + 0.01018593145135472i, -0.13654907958740753 + 0.023804078080534787i }, { 0.08957484962707656 + 0.14346378583727384i, 0.050747981383441707 + -0.2183189918147513i, 0.0047289387661661455 + 0.03881755174937597i, 0.0006257735504652424 + 0.013901783057819816i } }), Matrix({ { -0.0021545375194113713 + -0.07316841878625181i, 0.12250997917006055 + 0.023445095754875085i, -0.11497267075892821 + 0.23804896315973972i, 0.14033650977659878 + 0.04747165677461403i }, { -0.15732081773531073 + -0.01162819511614598i, 0.057732735893315124 + 0.027310569909557953i, -0.046838365513291694 + -0.25735829939369387i, 0.1949192599529067 + -0.03953299383088479i }, { -0.11764392301326737 + -0.061626560294609965i, -0.04110422200596559 + -0.06132340603969147i, -0.13949410975213358 + -0.027989704390313012i, 0.022219575990266933 + 0.04722998108088242i }, { -0.09572121944674677 + -0.026544596052910593i, -0.18548050903356336 + -0.020940855158569523i, 0.03623725947524495 + -0.012160972968567147i, 0.02795087393546848 + 0.1314183057228317i } }), Matrix({ { 0.11280633587773282 + 0.01776031210019396i, 0.01639158071185417 + -0.14354445393905219i, 0.09930767331279496 + 0.07252926264593809i, 0.06488262383315954 + -0.07283190088022315i }, { 0.09423650079687211 + 0.0390099097772868i, -0.14092329774714424 + 0.08169261313629535i, 0.13496713242779917 + -0.08930302403261307i, 0.07531813486500286 + 0.08141607089474288i }, { 0.0803176873928018 + -0.011710912747267512i, -0.025389223292133677 + -0.04795358249358437i, -0.007305989547947551 + -0.025614193400578397i, -0.013295694008082089 + -0.08764495523786699i }, { 0.08657377694765502 + -0.06964180995512856i, 0.02439042641247232 + 0.10260855660295784i, -0.024200264123999907 + -0.14049109864738685i, 0.054760196820210195 + -0.06978409167190432i } }), Matrix({ { 0.03497004460659168 + 0.038951018331140494i, 0.03258605297108097 + 0.01527240470354343i, 0.07077260066086763 + 0.191464460343724i, -0.12956150650816703 + 0.13863474590180763i }, { -0.009720295156221552 + -0.0065584025944976625i, 0.039641337428166855 + 0.05847535815529828i, 0.004695469040917275 + -0.010529503881767014i, 0.06927084105593095 + -0.1315308655764783i }, { 0.09645108567195926 + 0.05376043041579306i, -0.19755313922241052 + -0.1132245150191175i, -0.06565231448027009 + 0.05745489236317209i, 0.1422413818548935 + 0.0013476588836274707i }, { -0.0012705425121083966 + 0.18430224424836714i, -0.0024059799440149052 + 0.053660334499686005i, -0.18450725362006826 + 0.00155300830009446i, -0.12644459472879346 + -0.08824654897233707i } }), Matrix({ { 0.06437307571956244 + -0.007196846849225936i, 0.14746853406487806 + -0.08697012665985218i, 0.004603641794895076 + -0.1126810805673274i, 0.021463064462712837 + 0.08293708180655963i }, { -0.07568739932699936 + 0.01042697860464181i, -0.18348042068126377 + 0.005175420610737344i, -0.01479367102750031 + 0.05035408798901238i, -0.1273327034110263 + 0.10259561970657043i }, { -0.01589904839959896 + 0.03215580851586774i, -0.07932790703800845 + 0.1268362515433761i, 0.11311327776474682 + 0.004193995868206245i, 0.06968409894427402 + 0.015013776895459088i }, { 0.1500141593425277 + -0.11603786464614249i, 0.061917065101788765 + 0.1002291459396399i, 0.06739630267796072 + 0.027791798699216653i, -0.03020527508361603 + -0.0270023224020164i } }), Matrix({ { -0.05445181227062406 + 0.15943028221356423i, -0.04879024109654772 + -0.04392592855208934i, 0.16746122418304 + 0.014619904163818122i, -0.07508294174136446 + -0.06079698984728426i }, { 0.0564991823366659 + 0.09613892222497833i, 0.014627425356728072 + -0.02764992975300025i, -0.1686660144332496 + -0.009780936204174065i, 0.11900053465439868 + 0.018796990066947208i }, { -0.12925760822464488 + 0.09077445967543199i, 0.05135979348251473 + -0.06375866659791672i, -0.006996117073646423 + -0.009783525214254768i, 0.041559749622729895 + 0.0027225070080557972i }, { 0.053896166907955 + 0.03025425925565952i, 0.008262371526868059 + 0.003461154922590884i, 0.18283993640839083 + -0.1527758769670694i, 0.08205443068143796 + 0.006686848585491079i } }), Matrix({ { -0.040379336382079356 + 0.020189854699573056i, 0.02597432659592975 + -0.0831731403596887i, 0.09049605884390198 + -0.030158201877565547i, 0.08832365537884464 + -0.054454213252721255i }, { 0.06843252924466388 + -0.052828624100381714i, 0.043207553691151895 + 0.05330828208009941i, -0.0364996151245903 + -0.025248026735065248i, 0.12366885996182297 + 0.12261401311037391i }, { -0.014723282101836871 + -0.11574099913115164i, 0.09885574661943332 + 0.1197448296027355i, 0.04550115596081272 + -0.1044493581358032i, 0.09164333082895525 + 0.09398440226014738i }, { -0.1957256456987027 + 0.024054397430426675i, -0.025349078478044653 + 0.01768485511093805i, 0.08096481361370576 + -0.007297925138029762i, 0.08036773179909232 + -0.16984476222187037i } }), Matrix({ { 0.021835020901125088 + -0.013478525874371724i, -0.026950397312852602 + -0.11034834052972216i, 0.012826786397830844 + -0.09435342394630086i, -0.019570029445773126 + -0.08839045754096381i }, { 0.0028088977155512874 + 0.036190112769921345i, -0.27897068010299686 + 0.11620838517026369i, -0.11938363623691967 + 0.017660259322359668i, 0.06811719139988863 + 0.06207064046484321i }, { -0.04357668587025751 + -0.10331914035283223i, 0.09440653191986177 + 0.0013622709811308604i, 0.05036884089891953 + 0.13506402994199218i, 0.023114360172767218 + -0.00962621012210761i }, { 0.12121513816474036 + -0.02896354237328216i, 0.015845936623383707 + 0.008324957939804511i, 0.021076600730537173 + -0.07279330408202167i, 0.008719511049334275 + -0.050197738940132526i } }), Matrix({ { -0.16183875917741217 + 0.02452917850184046i, -0.000772776614611742 + 0.16680693951676343i, 0.11895680475812767 + -0.031459039957022844i, -0.14742655625707304 + -0.040366259778508946i }, { 0.10086651660143778 + -0.005017077707956694i, 0.00023906357426287174 + 0.07335081063452606i, -0.08425053713203948 + 0.03706103424040826i, 0.05348725156886982 + 0.036047412791231956i }, { -0.06533751490841025 + 0.05280115584610514i, -0.054240228890215084 + 0.021604471557394887i, -0.01785350744032723 + -0.051495190943622544i, 0.004142214282147959 + 0.08751687795585854i }, { 0.025925023599944055 + 0.022636679420935252i, -0.053544162438558994 + -0.21199662260073474i, 0.040229990388348735 + -0.16460578200996867i, -0.046303902771113195 + 0.013097381081183619i } }), Matrix({ { 0.15517864017183056 + -0.009527975262946324i, 0.054337918016892105 + -0.05958241591928404i, -0.16067533801166337 + -0.015508602545690989i, -0.016115604960116926 + -0.11202797765435958i }, { -0.031740262733200846 + -0.09817135493452246i, 0.002281412410362389 + -0.08391061367881969i, 0.05839222078370485 + -0.0234535455362114i, -0.14277810165903754 + 0.0062180828573716075i }, { 0.11602329316952131 + 0.03021428491551866i, -0.013260115960900931 + -0.03720616336884882i, -0.03397889440467915 + 0.015573837255899052i, 0.021045924501188768 + 0.021502352863930145i }, { 0.29604481960647905 + -0.03266858292631505i, -0.013029376636249113 + 0.06448895831490897i, 0.02777389715019686 + -0.03113266315098801i, 0.12948753220522238 + -7.039362490529423e-05i } }) }, { QubitIndex{ 0 }, QubitIndex{ 2 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { -0.2976269893042094 + 0.2707989906429314i, -0.24748223243210715 + 0.2653601891091605i }, { 0.22876294056623125 + 0.1905455375666196i, 0.03993636599565864 + 0.23473913616170716i } }), Matrix({ { 0.10129437316938233 + -0.13879137560523147i, 0.15914394176173388 + 0.30424381297405356i }, { 0.003172483670809717 + 0.12626065414155083i, -0.3643732145223634 + -0.4251346585601238i } }), Matrix({ { 0.06679919309356575 + -0.24373909359550278i, -0.15132507282590432 + 0.4604415089546678i }, { 0.07008981452109034 + 0.4362471410627627i, -0.17415200547312826 + -0.08500318881771235i } }), Matrix({ { -0.189365283194068 + 0.28825253459708505i, 0.002360448205036274 + 0.14873603014863446i }, { 0.5365717114118754 + -0.19498107556460426i, -0.08203840018328995 + -0.2809311811639903i } }) }, { QubitIndex{ 5 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 2 }, QubitIndex{ 4 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { -0.019560770397353933 + -0.07943752322499419i, 0.13404200051615006 + 0.3519307054398686i }, { 0.050465423362529016 + 0.4152930965164708i, 0.09671430381940818 + 0.22203589056381595i } }), Matrix({ { -0.1855177860100282 + 0.25862355728337666i, 0.20743371808179936 + -0.6371802856624829i }, { 0.3102891252713491 + 0.14645583760719783i, 0.2370325745152318 + 0.06282739110976063i } }), Matrix({ { 0.415629843676952 + -0.07886221360648527i, -0.09637720579311879 + 0.11666113726997887i }, { -0.371601972489025 + -0.008051447991992384i, -0.09061762696199797 + -0.3197739567345852i } }), Matrix({ { -0.45995234032924753 + -0.054398140870555146i, -0.07482482191563294 + 0.30707899510329684i }, { 0.2372931110763467 + 0.10637994701035848i, 0.23251357791578514 + -0.05514154082230034i } }) }, { QubitIndex{ 2 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 6 }, QubitIndex{ 1 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { 0.49098053424574806 + -0.004911591301479512i, 0.36104763597109485 + 0.32055641749367225i, -0.16429739381322914 + 0.4222512411850308i, 0.2354944964341115 + 0.5148347083084808i }, { 0.04290722359492656 + 0.13241006144870915i, 0.3961548246313401 + -0.004451431604783i, -0.2620229486550876 + 0.4813358412836838i, -0.35111585063486594 + -0.6324915234019185i }, { 0.23298975606550898 + -0.45139745676353427i, 0.1927627511370031 + -0.4196123043699442i, -0.5818057838832806 + -0.3739143396510486i, -0.19568558093918953 + 0.11009720817150717i }, { 0.4606922350243188 + 0.5189020246996694i, -0.30479924278207143 + -0.551176183117704i, -0.09756467896423127 + 0.08087810482195365i, 0.3044728426205363 + -0.11420045446381655i } }) }, { QubitIndex{ 0 }, QubitIndex{ 3 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { 0.17232076252158968 + 0.15877272864933945i, 0.42049212967839933 + -0.4640373711916605i, 0.05764863710124348 + 0.5056122708215278i, -0.13807457841441373 + -0.5243288467059842i }, { -0.6781969552646393 + 0.1532838330407797i, -0.4659939243873495 + -0.31164717129725905i, 0.027569874895105425 + 0.12403402235664705i, 0.3549728026478709 + -0.2452109951270705i }, { 0.046244408702866405 + -0.4593173249735402i, -0.30979062817665315 + 0.42953677201381335i, -0.03353901183884616 + 0.7070346892253291i, -0.032737277052503455 + -0.06574444031889684i }, { 0.45904787846158424 + -0.19445777629632766i, -0.11304217924961152 + 0.018187467248583944i, 0.4300647275654827 + -0.19725552603744453i, 0.6389368512640277 + -0.32595427273148947i } }) }, { QubitIndex{ 5 }, QubitIndex{ 7 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 7 }, QubitIndex{ 1 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { 0.1090184788069346 + 0.023547249806416634i, -0.09120001587341162 + 0.25491751053169637i, 0.006378962126032514 + 0.01787668499837632i, -0.0963861418166333 + 0.09111730681853462i }, { 0.09821710370647041 + -0.017801148633382738i, 0.024521583773853443 + 0.014733583511787314i, 0.016891932540575236 + 0.09086027362489729i, 0.05939986994434121 + 0.07376989382524232i }, { 0.0034568498015381355 + 0.06196919193688235i, -0.02009559112665206 + -0.04803710257500886i, 0.08487229386273665 + -0.0801676624686319i, 0.07952543327345368 + 0.02124583847486122i }, { -0.002310908255457174 + 0.12462760798347912i, 0.02507518393991911 + 0.025033773791163078i, -0.021999816655247684 + -0.025883042061087328i, -0.05364321445715384 + 0.03101049938205804i } }), Matrix({ { -0.047512747059542476 + 0.0981571742257042i, -0.06348262561672437 + 0.04207122164668206i, -0.005938581056079577 + -0.015247718991243931i, -0.07683879815442085 + -0.0071192855861722665i }, { -0.0314792496029642 + 0.10360294661125861i, -0.010725285137284784 + 0.08341306493513423i, -0.08684689812865284 + -0.09081607887666679i, -0.038501822597724104 + 0.1038386847197667i }, { 0.0074186717396241995 + 0.05104319827352761i, -0.08724034458856487 + 0.07247014898832968i, 0.038612562695497996 + 0.11379622821880253i, 0.14070530890981725 + 0.14302497025648167i }, { -0.03933316066305945 + 0.10144736268917653i, 0.17160929040056466 + -0.023649758595045697i, -0.013500989334633715 + 0.10054235197058543i, -0.1329124742356174 + 0.11784442245986723i } }), Matrix({ { 0.14746475426190123 + 0.015959718743174617i, -0.05667639669487308 + -0.21521006023460434i, 0.18605848668335817 + 0.08735743589618748i, -0.0965213106821833 + 0.044861527811654485i }, { 0.05584184165565686 + -0.09825706810022478i, -0.12484597436614751 + 0.07051710271005981i, 0.0697783691860099 + -0.17646876495726876i, 0.04616322493945296 + 0.08786719486097273i }, { -0.04782448081983223 + -0.136838794490442i, 0.04020575749348449 + 0.2373091929932442i, 0.06121711636676865 + 0.04636493263350721i, -0.04072167992670255 + -0.010391223326981874i }, { 0.02264114740460135 + 0.1271547671221549i, 0.05291829376757811 + -0.09340633558797716i, -0.0478099867931253 + -0.17853096911856828i, -0.1128053077487803 + 0.07254736330172584i } }), Matrix({ { -0.02903868397571956 + 0.03365249356665137i, -0.06729977442062016 + 0.03246653657629231i, 0.059257032107119884 + 0.047501246886400374i, 0.03467649471341225 + 0.016776419961431664i }, { 0.004918567326794983 + -0.001637108973413709i, -0.11832569647461316 + 0.08656951180733068i, -0.15519961224760245 + -0.11395031462194834i, 0.024594779048685043 + 0.21806071563687224i }, { 0.0884005402313315 + 0.07364702690486444i, -0.03559149829365048 + 0.03552063301853998i, -0.2848223010593293 + -0.017440387143384195i, -0.12438960052373124 + -0.026144217743749365i }, { 0.12479498110443665 + 0.09791755956415628i, -0.038675815541965974 + -0.03393991275144715i, 0.060397119544320484 + -0.06020035389922607i, -0.03565886522448436 + -0.08538494876254613i } }), Matrix({ { -0.009992848941959 + -0.12075561833336704i, 0.006733867309028132 + 0.053720852246549246i, -0.018664232370216884 + -0.1567189505450982i, -0.011658396344270905 + -0.29930579388141304i }, { -0.13096058866509447 + 0.23165366946109037i, -0.06234369084285655 + 0.0813838079320112i, 0.13412912090874982 + -0.054270198359081256i, -0.09123566226368014 + -0.1931379658986179i }, { 0.014763881635687148 + -0.0998007902008177i, 0.029037135763088407 + 0.033333228830502604i, -0.020542194082033508 + -0.056534801702466206i, 0.07128705145465432 + -0.14862715866564774i }, { 0.031247087143096052 + 0.003511234554951529i, 0.026684497492518514 + -0.16989404280041076i, -0.002482929478610963 + -0.0530676243933383i, 0.08017209555061697 + -0.07697352097398638i } }), Matrix({ { -0.09544000497638706 + -0.13429163292187546i, 0.12871171335659098 + -0.1309035958251575i, -0.09016791214812618 + -0.10066921212988156i, 0.08084113827632351 + 0.05839427062809742i }, { -0.06176358452181686 + -0.008407715036896605i, -0.16100004597008957 + 0.14360014326965406i, 0.019193417365725766 + 0.06649225459842999i, 0.030282330979552657 + 0.13019032490206187i }, { 0.033288281678662456 + 0.08259229915935358i, -0.06665281249664748 + 0.023814671642335083i, 0.18196627400851975 + 0.013551575361725798i, -0.09103017684223128 + 0.12985499749049684i }, { 0.07097357822301892 + -0.09854745554092867i, 0.11440910603159372 + -0.08317116592931699i, -0.04720222438365457 + 0.06387784273933293i, 0.002462997222829774 + 0.1291863254340628i } }), Matrix({ { 0.03173448262787825 + 0.06636113626564194i, 0.10077287741235932 + 0.0824171010082617i, -0.1524159067292404 + 0.07125138359264656i, 0.20085655779244316 + -0.05222311095176294i }, { 0.024445903924433004 + -0.05028704356904103i, -0.030956941726848958 + -0.07430960262869597i, -0.1027461199060532 + 0.08383321911966944i, 0.049123769372194724 + -0.045573767809097526i }, { -0.11491457020055165 + 0.07233986597842082i, -0.022988339609428195 + -0.15811995591613343i, 0.05862571525689366 + -0.03879850437999111i, 0.002062897416228088 + 0.08710741574558448i }, { -0.02117796856871891 + 0.09500280198304947i, 0.012752039799338087 + 0.022763887296090447i, 0.11221029484605896 + 0.16575646689986803i, 0.02560637824580338 + -0.01891329778848352i } }), Matrix({ { -0.043994826674762254 + 0.06710101535929705i, 0.030197679870254786 + -0.028141244322807027i, -0.11220057703295377 + -0.03093045122680841i, 0.00999959321520406 + -0.05674562299173304i }, { -0.13379111982469835 + -0.05954402786944554i, 0.03905953872996942 + -0.05082097724419979i, 0.056555981998036894 + -0.15436915175958082i, 0.030791705491186372 + 0.15373545574482417i }, { 0.05929024500605517 + -0.07470441102171552i, -0.014607098692097878 + 0.09707302106929178i, -0.12113478715868808 + 0.00677642585894411i, -0.016735958151496342 + -0.04781771563041644i }, { 0.03816281423432651 + 0.021200731630832328i, 0.039363598848894774 + -0.16801685992983356i, -0.04091050064981328 + -0.08259164211169032i, -0.038882590365462134 + 0.13178696090969533i } }), Matrix({ { -0.07008135917349836 + -0.13556920655658153i, 0.04208871514433749 + -0.1656177155579846i, 0.11678753079680738 + -0.046458240300134575i, 0.04366548057706227 + 0.07217126144902722i }, { 0.19959647556449123 + 0.05659385728162557i, 0.07811537638758353 + -0.03367246295105258i, -0.08319891458162657 + 0.08302026578154358i, 0.036510590910696764 + 0.012087665490205839i }, { 0.055538231725270684 + -0.054373251572900703i, -0.06322296701976361 + 0.14154292417736128i, 0.06337832204618761 + -0.07418865860801553i, 0.09655288564303607 + 0.0032823026562412852i }, { 0.09383118023982379 + -0.03143237685577853i, -0.03785372373001648 + -0.003398674274005918i, -0.01621480278500619 + 0.14523946074215088i, 0.08021497388036522 + -0.021499497634063988i } }), Matrix({ { 0.02380375268199202 + -0.10657322659965625i, -0.016201898205193323 + -0.04422721481319997i, -0.11156721950376994 + 0.05920207278279777i, 0.1550120950885145 + -0.09781605014565456i }, { 0.13271318329879833 + -0.00467234463358838i, -0.01334768101655544 + 0.036601861962540144i, -0.10848207727411138 + -0.028607309909569768i, 0.026569032258501556 + -0.08673509956315775i }, { 0.1097445022974623 + 0.14731633839973718i, 0.018690461850987092 + -0.07475974689168728i, 0.045823687527810054 + -0.16295284570425111i, -0.07769742266744269 + 0.060515922557550866i }, { 0.1322507263663457 + -0.012867100563619904i, 0.02578091874695011 + -0.0451069439516009i, 0.1627198978715643 + 0.0754964832823158i, 0.040440877419549506 + 0.0006656929634943475i } }), Matrix({ { -0.04473967731157016 + 0.13631608082045268i, -0.0447995453411023 + -0.13910117270020134i, -0.009823370495758259 + -0.00525013551333282i, 0.09066239498360056 + -0.03874141246921328i }, { -0.010224246147689423 + -0.09889531326087311i, 0.004802420137241568 + 0.0609448319767523i, 0.12881385305827292 + 0.02255263919891268i, -0.1143767007722134 + 0.03635794353177225i }, { -0.09310143623998057 + 0.09326871366672869i, 0.10540551827252455 + -0.026133223148572943i, 0.0028707425640680812 + 0.05273637170914303i, 0.011771557152677855 + 0.016855642619107956i }, { 0.10028066591696184 + -0.1117828209280953i, 0.08427382434560964 + -0.059147715787781774i, -0.044683901303983226 + 0.08998427144156224i, 0.07432275890204945 + 0.05947861876758596i } }), Matrix({ { -0.02567621719081016 + -0.12063308213599375i, -0.09030022220561792 + -0.02043218564691552i, 0.0063938441677931675 + -0.04084584308991499i, 0.06844071621528497 + 0.0031976044945978745i }, { 0.011401589474878375 + -0.05388131762264113i, 0.17016129401957136 + 0.12489965800587532i, -0.07481725762070845 + -0.003604408543695901i, -0.060947493105913034 + 0.005767121400619342i }, { -0.10729529631239355 + 0.07532505226948195i, -0.027066829409670475 + -0.12950833222159555i, -0.0848396983346246 + -0.10997056353122454i, -0.12552915840215392 + -0.09429581785860101i }, { 0.026401040652856287 + 0.11034791890234386i, -0.16010513171285964 + -0.021205414141192435i, -0.016267230313103648 + 0.11233887360375713i, 0.010386860672339706 + -0.047490536597810884i } }), Matrix({ { -0.05080310947058498 + 0.09067482352873665i, 0.05900991665292402 + 0.009750949855307521i, 0.056048535019166804 + 0.0025049720796010084i, -0.022581723893848497 + 0.16952365588561266i }, { 0.06565075239698287 + -0.06612018735030913i, 0.02010604036718411 + 0.07231496613873332i, 0.012364269996292003 + -0.01398038513479475i, -0.032041637137610615 + -0.05633075299905674i }, { 0.03482217256702271 + -0.08191698673413275i, 0.0706664264098289 + -0.03721027342979003i, 0.12433754675520294 + 0.05420931639558055i, -0.03590739208455337 + 0.16266170451646936i }, { 0.08398389579161807 + 0.048865903877252974i, -0.08077268031800608 + -0.07933814710853103i, 0.11532652643227413 + 0.03574181073102702i, 0.025076458817688156 + 0.06511850431616556i } }), Matrix({ { 0.15689965580601692 + 0.09740177158738937i, 0.010798789763636234 + -0.12738794801126874i, 0.06547284282805875 + 0.1250139485418211i, -0.0035770855483582206 + -0.15123755228637106i }, { -0.06035903202344353 + -0.10238563092257058i, -0.04611178413256798 + -0.08252329370861633i, -0.18387471461044466 + 0.0312521381480386i, -0.15839221249788202 + -0.03559918198471835i }, { -0.06129041035190879 + 0.13778608642085602i, -0.09336581882064933 + 0.06651802387310823i, 0.1241019275063321 + 0.1524505394009593i, 0.19749412703914349 + -0.10305915138598207i }, { -0.18022493453988447 + 0.08389756736988666i, 0.010222363410860356 + 0.1480464077175706i, 0.11738470860485845 + 0.0013321200978196103i, -0.030608322811919168 + 0.08265827206512293i } }), Matrix({ { -0.06698933282318134 + -0.0908670030127209i, -0.06634348225701525 + -0.16584757569438727i, 0.05589163005567422 + -0.002213580897387819i, 0.0005475742135115413 + 0.019947486844878216i }, { 0.0310435427839371 + 0.06754183405851043i, 0.14026891814908393 + -0.015720346777689263i, 0.047257062589076644 + -0.007993031490413947i, 0.09264406652893054 + -0.04581427831615798i }, { 0.1554831675253071 + 0.13118362615639656i, -0.09495878871407591 + 0.09009276192472794i, -0.01983226492363599 + 0.079727337826451i, 0.053567970111393005 + -0.021367300722156313i }, { -0.1646944594922061 + -0.1704349005447845i, -0.13276340648608073 + 0.0077851697453896985i, -0.0566980056627426 + 0.03291294657719893i, 0.01175292862916091 + 0.09134925125754746i } }), Matrix({ { 0.078327066902337 + -0.11185778600133905i, -0.0485293621848033 + 0.06997297165773467i, -0.06880808607439273 + 0.01275595710616831i, -0.0851537255210658 + -0.056218798854643995i }, { -0.0657229332153028 + 0.03640965176833424i, 0.09006732199156066 + 0.06077714767819628i, -0.04181234325221909 + 0.034397370012812525i, 0.16435659389396148 + -0.07393872344098014i }, { 0.008165554726231304 + -0.005661274873456378i, 0.02303621890748968 + -0.13742392531241418i, -0.09893847703777213 + 0.015355237492378037i, -0.04714109147534974 + -0.023683362223480133i }, { -0.012574437649173622 + -0.10946688365051221i, -0.11376716082384077 + -0.062156017711895335i, -0.12898826854891543 + 0.04483935585849922i, -0.06337308656497288 + -0.1230114178880459i } }) }, { QubitIndex{ 3 }, QubitIndex{ 0 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { -0.07827576154625815 + -0.09393861229186164i, -0.004709284375300212 + -0.12599827983823536i, 0.1269177217342529 + 0.03132454124174253i, 0.06389175778447048 + -0.15236554379906314i }, { 0.0896578581967279 + -0.008119834338305806i, 0.08626035860814574 + 0.08440855070610721i, -0.0001713247475173895 + -0.2816086712215738i, 0.04775531652381732 + -0.17017908007984897i }, { 0.10865496486012932 + 0.10701835821603892i, -0.09286406219888003 + 0.04790192403775847i, 0.05835516010033856 + -0.04684971576848107i, 0.011775860223564284 + 0.07100942416974439i }, { -0.08990351234828439 + -0.015209404050158176i, 0.16996183432440215 + -0.01724114641601569i, -0.04968932783226448 + 0.038616066422566035i, -0.10990254386923405 + -0.11207515781042413i } }), Matrix({ { 0.0674552544879281 + -0.013116810218375517i, -0.08146096262590852 + -0.08788338256403674i, -0.014145420083971471 + 0.028590484300819216i, -0.1590606321938541 + -0.004869834186353503i }, { 0.012433893549114228 + 0.04631881361262381i, -0.0628798930957793 + -0.08430535249674227i, -0.08346997014674909 + 0.2273130367913533i, 0.0885924296424439 + -0.07513864479923633i }, { -0.1174099509054789 + 0.02624456125389434i, 0.10162680697019265 + -0.0004619854990610626i, -0.06662989165679513 + -0.10012139849537571i, -0.06017574333063594 + 0.04330821524940348i }, { -0.007677897479425698 + 0.0871756140464059i, -0.024245545912712347 + 0.20223494751947058i, -0.02500586815623891 + 0.12460966051789056i, -0.024132631752002025 + 0.09423924643811767i } }), Matrix({ { 0.007558764897257104 + 0.058006816663714884i, -0.09430924568183927 + 0.06946131026907347i, -0.1467007460252624 + -0.012731390007502737i, 0.05870912662890717 + 0.04554150828385746i }, { -0.04915069467080564 + -0.029236111467130094i, -0.02374499551665211 + 0.04387020065132069i, 0.10021726338785357 + 0.002773964734178525i, 0.06419300002133843 + 0.15429797041991614i }, { -0.07651417061877766 + -0.032009458441871134i, 0.03416263504567358 + -0.13642213577582044i, 0.027108865279406015 + -0.05214477417050681i, 0.00024908604726670935 + 0.07158737093849996i }, { 0.09646850966286646 + 0.019018914278302698i, -0.061142213925662145 + -0.0865909522102903i, -0.06201568730045333 + -0.035128468688107276i, -0.13855969089535677 + -0.10593716788592697i } }), Matrix({ { -0.08829811456353905 + -0.007811029761527858i, 0.1348024329003831 + -0.11537520563213711i, 0.07501807795754299 + 0.13996907338777687i, 0.055735016660416796 + -0.0724063401536081i }, { 0.040870622510589746 + 0.01852188330031617i, 0.12049905994237906 + 0.1651503033202576i, -0.0032735687360358613 + -0.000861706713574767i, -0.09397658332420747 + -0.12298210014420846i }, { 0.15819550085282819 + -0.058265096137835926i, -0.0347336032267604 + 0.03373767625000591i, -0.021518439952402293 + 0.019981735010326084i, -0.15725378977020138 + 0.002637749304310293i }, { -0.09426003438883737 + -0.04267294742542366i, 0.1277060323865062 + -0.08212857740195528i, 0.1215985275911991 + -0.06486044939882978i, 0.027636222565724882 + 0.07127914466119233i } }), Matrix({ { -0.031649360828780046 + -0.015799327525205i, 0.06784569542748693 + 0.05617501580668643i, -0.002316162210365686 + 0.08585103919912185i, 0.02253198858194716 + -0.03287469370182891i }, { -0.024627036038471842 + 0.0630888663444487i, -0.08827560858783648 + 0.003156725449136153i, 0.06657068714167826 + 0.10199765909280273i, -0.0013291776923043883 + -0.016356686795548882i }, { -0.05433666173089241 + 0.0035073559301351982i, -0.10907406846553881 + -0.011939846918510398i, 0.06860877355284069 + -0.04827258170275895i, 0.011441000773968306 + -0.026938748668454422i }, { -0.011952878407999303 + 0.03416719154708051i, -0.022143211457878297 + -0.09064239826039065i, -0.1106068425327272 + 0.0001628515392578439i, -0.003148666151835698 + -0.22478835452524826i } }), Matrix({ { -0.12178620135653126 + -0.020940608770067086i, -0.004737858940116101 + 0.023038300137799603i, -0.005418507839378238 + -0.006754085646580354i, -0.002513227137481637 + -0.00941246146930993i }, { -0.1374873259085468 + -0.012781940621641749i, 0.030401150067099317 + 0.0554698494806469i, 0.006671906237883824 + -0.10616123280910399i, 0.10410092989413143 + -0.07987664096997299i }, { 0.06540654041096472 + -0.04068244104634344i, -0.11860001416614478 + -0.0463829697053026i, 0.08990183593766878 + -0.013747343264989331i, -0.21886018665879334 + 0.013691588261019154i }, { -0.13723584371405376 + 0.11721672854707524i, -0.06388802556940229 + 0.08716144399276914i, 0.0570271541360856 + -0.08938837313067607i, 0.060280576440256466 + -0.074312587851226i } }), Matrix({ { -0.1409093335588206 + 0.17504726600100853i, 0.01779562129542883 + 0.184600073802886i, -0.0033570832901874954 + -0.06055537996651296i, -0.0686028833142539 + 0.11753470780147858i }, { -0.036858858444828224 + 0.1615448439829354i, -0.06311586448721411 + -0.1250901588536214i, 0.06326707690831675 + 0.0804280001099389i, -0.10471399867577807 + 0.1148797523828275i }, { -0.06504132419369191 + -0.0900662970852292i, 8.234653678456875e-05 + -0.06322916238647446i, -0.0847629657570704 + 0.013125032524973353i, -0.06874815256139326 + 0.022772449625866612i }, { 0.08299567041508557 + 0.0436265428803355i, 0.06526053392261731 + 0.051670510254522975i, 0.01436622175606262 + -0.00992374107821008i, -0.03606473427105706 + -0.017011037211199634i } }), Matrix({ { -0.06534431672224669 + -0.17129442923516666i, -0.10777266223740849 + -0.0033855287684301876i, -0.06608448168118297 + 0.14883731933213556i, -0.09819357376536673 + -0.033819584038015056i }, { -0.11876552963337417 + -0.20111035319741938i, -0.02065888342643352 + -0.03653136083186968i, -0.0038756779147394106 + -0.10442340001664756i, 0.0012415651945904824 + 0.004172000912383998i }, { -0.1176779689751142 + -0.002115293860338636i, -0.04705567367365816 + -0.021299817871455556i, -0.08350007760489837 + 0.11801034850421281i, 0.09263154821708419 + -0.14077365904125877i }, { -0.1079047830679791 + 0.040286733096423125i, -0.04396279627569166 + 0.17041353528627284i, -0.09291906014524387 + 0.02863653955687855i, -0.006583015063019043 + -0.08640363243341538i } }), Matrix({ { -0.07854766587199977 + -0.16155959640355466i, -0.06351785158877675 + -0.09073582442272789i, 0.04614990219003426 + -0.05560863907137923i, 0.06333842780274314 + -0.02472208892406214i }, { 0.09902555399718112 + -0.10624818192873105i, -0.0548541935000449 + 0.014641265788771899i, 0.12104115863941142 + 0.06695520815076664i, -0.21715296940811882 + 0.10334261674088635i }, { -0.06308036230564536 + 0.13481800169066277i, 0.025344893088267418 + -0.17481792243779493i, 0.07452406686377547 + -0.014781110918269318i, 0.0932333619840953 + -0.02058534140199585i }, { 0.018056553962051417 + -0.04203867998466699i, -0.06549005544583453 + -0.002741407387967475i, -0.08298687964937577 + 0.12333164161312007i, -0.12290455981990538 + -0.043884634424327475i } }), Matrix({ { -0.07909706034793722 + 0.030435065203970584i, 0.01592489047320789 + -0.05991823794248232i, -0.2575701066930001 + -0.11604540378942502i, 0.020157138026311947 + 0.09207921963443438i }, { -0.11116882872541026 + -0.10981362313896172i, 0.31550362363539924 + 0.2610103781200236i, -0.0687366176271808 + 0.017172070025304426i, 0.0029969575891327783 + -0.04697575554425879i }, { 0.04960261131065373 + -0.023977513492261404i, -0.15700092438503702 + 0.0952974612316704i, -0.04993111843902043 + -0.04373900073166552i, -0.030657276998567365 + -0.07815986668383264i }, { 0.07446042169969339 + -0.07393944926365749i, 0.019528897522516398 + 0.09563250211407097i, 0.15187856355109522 + 0.1817480563709909i, 0.026408998761512155 + -0.008119534873799612i } }), Matrix({ { 0.05573663001537958 + 0.01500736620504078i, 0.08099720899751237 + -0.00637116071029151i, -0.07789141625718553 + 0.0798901409183291i, -0.054426888745919715 + 0.23350880821480943i }, { -0.044798440869920034 + -0.12251283718117773i, -0.08169931305547506 + 0.07227411868073105i, -0.06929434211409528 + 0.07847801217734736i, 0.06497616890501554 + -0.039397975794520666i }, { 0.13001347296933083 + -0.0007234270292514333i, -0.08760099121881806 + -0.03570623208405041i, 0.14887315431689244 + 0.08550353936762943i, -0.07976710756828644 + -0.0850172724230137i }, { -0.12932775237249922 + -0.1158632499395005i, -0.01748317786530059 + 0.09496017080409778i, -0.18906823421446 + -0.007999208261043106i, -0.12044450514908368 + 0.008827880095357152i } }), Matrix({ { 0.0372251723129373 + 0.05656693111521546i, -0.047218670881528736 + 0.012419487915670092i, -0.036539425515249184 + -0.04229271203047505i, 0.06851566407291966 + 0.1260674294170876i }, { -0.027887997846832102 + -0.020723231882458625i, -0.07157150678512869 + 0.004671977702587006i, 0.20660914703080313 + 0.033475212670664174i, -0.019571561643532163 + -0.020938793283947887i }, { -0.0758081868778877 + -0.02297221087169328i, 0.13638745159574253 + -0.038274618989162935i, 0.029504992726225414 + -0.10380302367484805i, -0.05484672453779502 + -0.04207438318658727i }, { 0.06996476556917976 + 0.024152552737064965i, 0.013526769797488864 + 0.014766290002382686i, -0.09753769689685733 + -0.14675871471473248i, 0.037655628744275735 + 0.06572457672184898i } }), Matrix({ { -0.13505263891713715 + 0.11537345150400073i, -0.10960399005395739 + -0.06653575937600832i, -0.09324049187490493 + -0.15199228735374354i, -0.078521539285487 + 0.23396488579539326i }, { 0.06571274432420689 + -0.09868928000873765i, -0.12676386198679618 + 0.015530982962417927i, -0.16506691388381126 + -0.0004478542471902309i, 0.019882959381754464 + 0.02079596124297277i }, { 0.0188154271000171 + 0.09180166272613707i, -0.031079495852855278 + 0.1730868062995889i, -0.0634784784756042 + 0.04923761385376948i, -0.010907313989243236 + -0.06468875084304876i }, { -0.17893544193981556 + -0.07276093116222734i, -0.058330823332501065 + -0.10872607194124827i, -0.03295605818437992 + 0.0499414498850784i, 0.1723701724852795 + -0.009914427047022816i } }), Matrix({ { 0.06766109216862211 + -0.0405870398524721i, 0.09063465778113115 + -0.009431974430491761i, -0.005835061827658144 + -0.035155109048077025i, 0.024542316295207204 + 0.062231698576409235i }, { 0.18200406907496097 + 0.20806049401828874i, 0.01975473279874285 + -0.04732270381389538i, 0.09642244149004085 + -0.07095090344169304i, 0.14351047116338866 + 0.0872097282845511i }, { 0.089694585448994 + -0.10074354256010257i, -0.11245359702242348 + -0.07248980315701807i, 0.07059338391057306 + -0.049198340298782485i, 0.017243823902163044 + 0.019668821003789923i }, { -0.083116371108585 + 0.04220445195094666i, -0.025968574984000178 + -0.15864291131284364i, -0.10973401493438141 + 0.05980192013621155i, 0.01648328423874121 + 0.024579452266463596i } }), Matrix({ { 0.060764209053971854 + -0.0493067328397945i, 0.09001581968816803 + -0.038007452081005186i, 0.011398475493834529 + 0.022813832199826283i, 0.0733201669006819 + 0.057362305856360846i }, { -0.190070549709269 + 0.03737349370205324i, 0.005308859519133735 + 0.031096811744993104i, 0.03837708809781945 + -0.009657293772748581i, -0.10703551652567313 + 0.03939737321995977i }, { 0.018138205796668645 + -0.14734403478967148i, 0.022080983728485756 + 0.010113548151587048i, 0.07784596167309785 + 0.10402570464147048i, 0.21852600798248287 + -0.0788336509853847i }, { 0.14718954833362055 + -0.14972411072977077i, 0.08305314853890948 + -0.118937587883585i, -0.13078011076435445 + 0.021328580346268538i, -0.16477867970098306 + 0.14294890344434233i } }), Matrix({ { 0.0830041187370848 + -0.06653403663168536i, 0.016060521517949407 + -0.08759919981906869i, -0.1085390511912561 + -0.04768514767487059i, 0.034138030995602676 + -0.0611609130336222i }, { -0.05053369145622217 + -0.015860822960418953i, -0.056740105107928825 + -0.036879185396026394i, 0.0021819715104294908 + -0.10925309157517145i, -0.03428212315925948 + -0.03533168920918308i }, { 0.07746669622417371 + -0.07159516074328263i, -0.012626625793583542 + -0.12279272292710036i, 0.04519602861649517 + -0.006264140723624288i, -0.03872115125616237 + 0.07827815870112101i }, { -0.04641845326036237 + -0.0070494619843432735i, -0.014720555447311169 + 0.03627589915439355i, 0.06169322039483005 + 0.06563115789015381i, 0.010328843110801487 + 0.05181584136829237i } }) }, { QubitIndex{ 2 }, QubitIndex{ 7 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { 0.13718244472915808 + 0.16552425305544477i, -0.054853965698634315 + -0.07113304983653312i, -0.029140498552172683 + 0.02421068838891989i, 0.07539639519501164 + 0.05800538754324135i }, { 0.006931292583837087 + -0.0413877948500042i, -0.016738290721841267 + 0.08439384944402144i, -0.07801397258131858 + -0.25276807982752086i, -0.028407434190394168 + 0.01083161733271716i }, { 0.03490725162911151 + 0.10128407156304828i, -0.25175089285628266 + 0.04842022879209116i, -0.014709544185556951 + -0.017553269889820686i, -0.010875977111063277 + -0.09536141168795709i }, { 0.13674749207970527 + 0.11324470229653388i, 0.0015778145191285614 + 0.04470246491553016i, 0.005501096185642887 + -0.03335081255036909i, 0.09548559754182315 + -0.060841778426953055i } }), Matrix({ { -0.0685988482181935 + -0.0006548143151819258i, 0.0701315179715866 + 0.0101887865425027i, 0.012834256473296 + 0.09291776948796268i, 0.0717164772796089 + -0.07855863649992167i }, { -0.05471705287732578 + -0.1525678516978647i, -0.16258372818347633 + -0.05050213322694843i, -0.12520632881371216 + -0.05813983302865634i, -0.12483468053785635 + 0.0288280448465959i }, { 0.05317805768283202 + 0.03569021152817806i, 0.010544124744035453 + 0.12033842243959249i, 0.10617633177470676 + -0.04987226153955162i, -0.2338386571930079 + -0.0189780530960824i }, { -0.09049444264399908 + 0.23976532022841351i, 0.06832618349004492 + -0.032977221815389236i, 0.10576558297091929 + -0.005129280050017053i, 0.1345152441134912 + -0.13011947819015562i } }), Matrix({ { 0.13435443187886192 + -0.07384317299317825i, -0.056755688068650736 + 0.07048194816161125i, 0.017640650882720793 + 0.00033655979609143583i, -0.031009743484065655 + -0.13886411921278075i }, { 0.03362952158323798 + 0.11007652770038641i, 0.057501310342575725 + 0.07205660827690782i, -0.17896363733939513 + -0.005396792064393263i, 0.06856958976194655 + 0.05964348124894795i }, { 0.0026196853754185123 + -0.19184941298477284i, -0.07093122655804746 + -0.08001357117712199i, 0.1370657878275312 + 0.006690224120916565i, 0.04930545995155918 + -0.09136614478382203i }, { 0.0872488712048881 + -0.05379210154146458i, 0.014356470603492384 + -0.13357016103674277i, -0.04759223696791455 + -0.061414501693551005i, 0.06183243318621355 + -0.15143853284127243i } }), Matrix({ { 0.05876060661347727 + 0.019882009850807014i, -0.03325220428342741 + -0.09513054788974075i, 0.023824982742524765 + 0.07602329669351258i, 0.003933867561343991 + 0.07534017783857198i }, { -0.07909627271589292 + -0.1368821014648296i, -0.2253454096734172 + 0.09630867037806154i, -0.24718343775103505 + 0.08530851169880314i, 0.11476039216395552 + -0.07130597641112084i }, { -0.09055983535527992 + -0.08393683693644581i, 0.042506161622910224 + 0.07242200618578906i, 0.04025643254084284 + 0.01795427741588215i, 0.14701055843693378 + 0.1844869662153008i }, { -0.07963116463343196 + -0.011815367570866675i, -0.12163657687864536 + -0.002371101694840331i, 0.0235781784150291 + 0.08346337873473363i, -0.05626024336735422 + -0.00867882084635879i } }), Matrix({ { -0.13698199631904823 + 0.16094120141056598i, -0.03081011466911521 + 0.010136981954895971i, 0.08770182713618445 + -0.126511246334248i, 0.13021769842730052 + -0.06584932231901008i }, { 0.09747682985703096 + -0.09018819645514221i, -0.11235153254958352 + -0.1573001979299903i, -0.03297690407846363 + -0.0014627851618052741i, -0.15870716244399896 + 0.007880411439182906i }, { 0.10056594908009521 + -0.06316450022488236i, -0.08385341494566116 + 0.05215681686770426i, -0.02140866581463586 + -0.12630545018624442i, -0.05527636472501281 + -0.06738925071089631i }, { -0.0041881139146083485 + 0.03535709847467341i, 0.08071115487329433 + 0.06051982012162219i, -0.08942193922920615 + 0.01686130998748836i, 0.0950648248001023 + -0.008457207722044283i } }), Matrix({ { 0.01616702504370469 + -0.027245215060869427i, 0.0431974406186481 + -0.21032962521594226i, -0.1534302015815961 + -0.017921941938143646i, 0.11318729657911507 + 0.10906814787469049i }, { -0.08266542595955811 + 0.017347457798909872i, 0.08809235620873417 + -0.07372604926637541i, -0.05705643130293963 + -0.1231964609211751i, -0.05921753219467428 + -0.007192894150526533i }, { 0.2265757008323479 + -0.059915276535834i, 0.02559671306879419 + -0.03226384579102834i, 0.03647033545933997 + -0.14253406024734167i, 0.024452263320015048 + 0.03840761890661756i }, { -0.0767515440591809 + -0.03032318528109898i, -0.19235793821503752 + -0.018936194582626496i, -0.04000997162587415 + 0.02885112099602168i, -0.023507794092697584 + -0.05128777580976929i } }), Matrix({ { 0.07649016776894324 + -0.03529740734839288i, -0.080751599521451 + -0.00510618629579166i, -0.0409538611238028 + 0.04400914785468151i, -0.13645693515286736 + -0.06503669678459649i }, { 0.07235415991374744 + -0.1690736531046529i, 0.1934417239479955 + -0.08696923284485733i, -0.09671744066956263 + 0.0692239015769215i, 0.10594296804321592 + -0.13796875504912903i }, { -0.07363581519398826 + -0.11364867265219512i, -0.027060355708420032 + -0.049115415675208815i, 0.017884959840902766 + 0.006003113818423789i, -0.2090380568731144 + 0.1035050623772382i }, { -0.014477341685358476 + -0.12173736454933932i, 0.015100877917977889 + -0.022008457342766234i, 0.07215819100143131 + 0.07657861401366373i, -0.004674069538903757 + -0.0022717510069042244i } }), Matrix({ { 0.06106250358459957 + -0.028745593428428043i, -0.057846574231955786 + -0.10258624403404476i, 0.1396462085900016 + -0.0013319987275656213i, 0.1226172983102562 + 0.023828382310776445i }, { 0.05774080900055062 + 0.12743518246547186i, -0.09673049926119377 + 0.14662776928161247i, -0.03846735865590641 + -0.11427132983416591i, 0.12136793708134568 + 0.028878713278335123i }, { -0.10969828444563032 + 0.062180716065823094i, 0.19956645412737825 + -0.11444889463633903i, -0.09573113223817502 + -0.014753493925975511i, -0.15848320416287037 + 0.15030709304477222i }, { -0.05981312502972454 + 0.02595111532265457i, 0.07409317526588881 + 0.05783462205544148i, 0.1253786231258798 + 0.11003163722625792i, -0.06836948695490219 + 0.07843368381423514i } }), Matrix({ { 0.03608763566990432 + 0.07408558292283188i, -0.22879015267277358 + 0.01223081643460813i, 0.12332383219147526 + 0.010804062135491437i, 0.03863293558519002 + 0.029915494066640794i }, { -0.004304336933218105 + -0.03451537061109157i, -0.07424762786090822 + 0.0144682010282805i, 0.03279063830143901 + 0.05134395570412795i, -0.004798312713304535 + 0.03390442406829395i }, { -0.16342390384043154 + -0.0848534250436159i, 0.17060197477205277 + 0.12653622467470152i, 0.14465871255100432 + 0.015206575940989009i, 0.19540434636175297 + -0.03448765321615368i }, { -0.016098061606884935 + -0.06630560024596278i, 0.015583577679854537 + -0.08145758924754544i, 0.10846327771156591 + -0.08935501614156019i, 0.06827491804688877 + 0.0031301035085159147i } }), Matrix({ { -0.185999810365699 + -0.1260180045511548i, -0.17278037953380818 + -0.07336990736388149i, 0.07730406029820855 + 0.004815179212498148i, 0.011745620862682821 + -0.08421536031054495i }, { -0.05242575822682911 + -0.016392012259996022i, 0.0007537537840542238 + -0.04894600915132386i, -0.004842566207096406 + -0.030589836277737998i, -0.02794439950262666 + 0.005706511638517015i }, { -0.06196888890627407 + 0.05342919568509408i, -0.10190252143118157 + -0.05228927190608103i, 0.1442145651039303 + -0.15152913992216993i, 0.01195588978601114 + 0.0072133100557555i }, { 0.036373016440088515 + 0.06751198405662245i, 0.01564657440092394 + 0.05621010987460936i, -0.06859421111744496 + -0.14959488391407222i, 0.008042497038845997 + 0.04144246147845972i } }), Matrix({ { 0.028967891148384897 + 0.012818300791321978i, 0.09663156177679601 + 0.0011793174865661758i, 0.11633304954179291 + -0.08189634615286595i, -0.08075564927550472 + 0.115338825829778i }, { 0.12771250542456747 + -0.07247635507134i, 0.058778685917616265 + -0.07367454203910986i, 0.22364867369694266 + 0.14498480122729404i, 0.11010311755750714 + -5.2029624698137206e-05i }, { 0.12037944761986025 + 0.15817692345731807i, -0.07992400100936989 + -0.030606269170789808i, -0.08651957983869121 + 0.0691542383944386i, -0.10624798074064798 + 0.07646473930172086i }, { -0.06192663012640813 + 0.05236523915018193i, -0.0320424805844334 + -0.02570171279020029i, -0.12437733771794163 + -0.18382970884552124i, 0.08067834374743248 + -0.005629771332642264i } }), Matrix({ { -0.04200558672234025 + -0.028115112436204584i, -0.16811550725178687 + 0.04370321032827052i, -0.09543247300915891 + -0.008066902965541965i, 0.11299464893546861 + -0.03198955009710221i }, { 0.041959743998899755 + -0.029326438647073547i, -0.023195457214033117 + 0.18432176889495652i, 0.15822211400556566 + 0.11085796702021522i, 0.03481854272271347 + -0.09699261802224833i }, { -0.13919414040697323 + -0.10320847207030158i, 0.020606412910131194 + -0.08514789625317483i, -0.08563247235713548 + -0.09939918999762506i, -0.0367918004175187 + 0.05478863283015688i }, { 0.11225500265132969 + 0.0399254399530735i, -0.03631081216359933 + 0.10696091526790957i, 0.0030450581038708674 + -0.035712580224788654i, -0.15812020317278722 + -0.14435105046069804i } }), Matrix({ { 0.021868668056643812 + 0.043983278310629634i, -0.12130755101962787 + 0.012924167405212716i, 0.06339126361071817 + 0.0053500838871578275i, -0.026738632627585367 + 0.15965088535016392i }, { -0.09029426919188209 + 0.03777656381312539i, -0.08060444968093697 + -0.13331861550537033i, 0.00945694235141086 + 0.08763148367922997i, -0.07497658141173381 + -0.03357173937452609i }, { -0.08950539841058427 + -0.07126192931224709i, -0.08665472958558083 + 0.022553986082632538i, -0.007996435388359658 + -0.01834946175910133i, 0.020102969342186246 + -0.024179137802614048i }, { -0.0937668895412079 + -0.08591102868824516i, 0.13310354790499584 + 0.03938450018164664i, -0.12090147908220511 + -0.08389214293293423i, 0.05785931755734202 + -0.09712761679392257i } }), Matrix({ { 0.03827532551139642 + 0.010205118990526636i, -0.06677451440815607 + -0.011031089225199492i, 0.048003651513803314 + -0.073920367399837i, -0.10401679893197391 + -0.039288344842740935i }, { 0.0771527891573264 + -0.022651435575040825i, 0.022325006848373605 + 0.036902911111951146i, 0.07267220308993301 + 0.20906667348782007i, 0.04994371144228718 + 0.0411791007635873i }, { 0.037532265519811384 + 0.05538885281506574i, -0.057999213626364926 + -0.03706603973129613i, 0.07697009535148219 + 0.05736427696748541i, 0.07279339878826736 + 0.011926710874228766i }, { -0.06407997022516795 + 0.1606526957398656i, 0.015544298097982193 + -0.048286269875958604i, -0.027405487932851105 + 0.06130752534958536i, 0.042081487469083155 + -0.11625371018856881i } }), Matrix({ { 0.05099585056113873 + 0.07663667288310877i, 0.03055533295692846 + -0.07555019464022382i, 0.038356489156448556 + 0.0351724929761445i, -0.09939372997812661 + 0.11972510356566711i }, { -0.031044372223674118 + 0.03992581614466286i, -0.10754532673351869 + -0.07055513555613215i, 0.0848677724095249 + -0.059377936838658156i, -0.07533884980347409 + 0.16069128036336272i }, { 0.018971467604183386 + 0.13476121346583742i, 0.03302795215537587 + -0.10912769666237204i, -0.017150280688502762 + 0.06197939107884446i, -0.0034173907435423668 + -0.0665016852787411i }, { -0.13375688692436033 + 0.07592773106644912i, 0.06494792278824191 + 0.04125802288425393i, 0.10571332286834903 + 0.014402551140075718i, -0.09637125133729875 + -0.02746178640398905i } }), Matrix({ { -0.03634401454477046 + 0.042280021746692306i, -0.05560790553113681 + -0.0166510497406327i, -0.050713246551690065 + -0.11914243228131031i, 0.02461488905939616 + -0.08295337161839124i }, { 0.010053412915647066 + -0.04355797438723436i, 0.030296420229121906 + -0.0017146234369685535i, -0.03024827699131968 + -0.05874116726623504i, 0.023023205578251413 + 0.035871433426228054i }, { 0.06785566013381344 + -0.02161106013380778i, -0.011902863988926168 + 0.033045443723782i, 0.017852350408379822 + -0.0016487529166223838i, 0.06024536380700349 + -0.14226010264016592i }, { 0.16784363296211333 + 0.03983876841442213i, -0.03056819833635869 + 0.012899500593025621i, 0.07756652425109983 + 0.0068681218369527055i, -0.04903731134382936 + 0.17230250207143502i } }) }, { QubitIndex{ 7 }, QubitIndex{ 0 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 0 }, QubitIndex{ 6 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { -0.2800870956037444 + -0.23702766373997727i, -0.23209400421992762 + -0.059052477522200914i }, { -0.30209788416795014 + 0.23006520617611945i, 0.03271739819976841 + -0.25402822408028325i } }), Matrix({ { -0.039638271411540776 + -0.02098402991803572i, -0.005258481463115356 + 0.34702063038714326i }, { -0.19210292724375058 + 0.4511772212378349i, 0.14874772936078157 + -0.36762674847220567i } }), Matrix({ { 0.054844268928077415 + 0.023388761564695087i, 0.12602753213189793 + -0.30804908319033747i }, { 0.3652760909398919 + -0.006342877213676156i, 0.04395811838404737 + -0.1156406771370212i } }), Matrix({ { -0.21338537762827017 + -0.29010615804735257i, 0.029252380391785737 + -0.6479143499835954i }, { -0.41633085673654546 + 0.19660103203188886i, 0.11218076157275447 + 0.20000659932849732i } }) }, { QubitIndex{ 5 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 6 }, QubitIndex{ 2 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 0 }, QubitIndex{ 4 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 2 }, QubitIndex{ 5 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 1 }, QubitIndex{ 6 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 6 }, QubitIndex{ 7 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { -0.09562138995739722 + 0.34130893332619505i, 0.9347592079520862 + -0.024289606072116218i }, { -0.365543649161216 + -0.860664047333367i, 0.2709222625140733 + -0.22855276384219278i } }) }, { QubitIndex{ 5 } }));

    c.addInstruction(CircuitInstruction({ Matrix({ { -0.4479293755248823 + -0.3582445425516035i, 0.11788621818907515 + -0.241215977451896i, 0.5871938834035002 + -0.3543541816323606i, -0.3585722179944631 + -0.0004855847953319503i }, { 0.13534456850592821 + -0.3121737272562461i, 0.12970713380116325 + -0.46344426776849124i, 0.06515448148499506 + -0.1270319199289938i, 0.7290275838185193 + 0.3174294390786846i }, { -0.16784819143999244 + -0.15612989210062383i, 0.5822707566680165 + -0.3843224251099695i, -0.6022389621408594 + 0.06148755792387969i, -0.23107773192110925 + -0.20208432749739041i }, { 0.2936971333361196 + 0.6453231511063936i, 0.2715121161298413 + -0.3685802113219882i, 0.34161660868438704 + -0.16149256170420956i, 0.04512401602073504 + -0.37803689171315735i } }) }, { QubitIndex{ 7 }, QubitIndex{ 5 } }));

    c.addInstruction(CircuitInstruction({ default_operations::CNOT }, { QubitIndex{ 3 }, QubitIndex{ 1 } }));


    return c;
}

TEST(RandomizedIntegrationTests, 8_60_2_30_30_30) {
    auto c = randomCircuit();
    
    auto s = c.execute();

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, false, false, false, false}), Matrix({ { 0.49491928580736355 + -7.792703114739563e-20i, 3.950371403761357e-05 + -3.6282880902479266e-05i }, { 3.950371403761355e-05 + 3.628288090247929e-05i, 0.505080714192633 + 6.412039410715054e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.49491928580736355, 1.0e-7), DoubleNear(0.505080714192633, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, false, false, false, false}), Matrix({ { 0.5000356705862663 + 5.251604272976662e-20i, 0.0013269404109618648 + -1.1744988878271238e-05i }, { 0.0013269404109618648 + 1.1744988878271313e-05i, 0.4999643294137305 + 5.107608671943431e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.5000356705862663, 1.0e-7), DoubleNear(0.4999643294137305, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, false, false, false, false}), Matrix({ { 0.4996904253466656 + -9.351243737687476e-19i, 0.0021902785471967223 + 6.347067619109461e-05i }, { 0.0021902785471967228 + -6.347067619109479e-05i, 0.500309574653331 + 1.4984012836928573e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.4996904253466656, 1.0e-7), DoubleNear(0.500309574653331, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, false, false, false, false}), Matrix({ { 0.5141642352807816 + -1.5246593050577406e-20i, -0.00011250698049399422 + -8.063034867710167e-05i }, { -0.00011250698049399423 + 8.06303486771017e-05i, 0.485835764719215 + 5.785235029746871e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, false, false, false, false}), ElementsAreArray({ DoubleNear(0.5141642352807816, 1.0e-7), DoubleNear(0.485835764719215, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, true, false, false, false}), Matrix({ { 0.5004382043938862 + 1.2197274440461925e-19i, 0.002963906181403929 + -4.921196305123072e-05i }, { 0.002963906181403929 + 4.921196305123769e-05i, 0.4995617956061105 + 4.413041655194905e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, true, false, false, false}), ElementsAreArray({ DoubleNear(0.5004382043938862, 1.0e-7), DoubleNear(0.4995617956061105, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, true, false, false}), Matrix({ { 0.4868974961174519 + -3.5490680489955184e-19i, -0.009353192289520713 + -0.03265396152623588i }, { -0.009353192289520713 + 0.03265396152623588i, 0.5131025038825447 + 9.181837148236616e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, true, false, false}), ElementsAreArray({ DoubleNear(0.4868974961174519, 1.0e-7), DoubleNear(0.5131025038825447, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, false, true, false}), Matrix({ { 0.5000271795104367 + -2.3505164286306834e-18i, 3.4627233985559436e-06 + -1.073159074610748e-05i }, { 3.4627233985559707e-06 + 1.0731590746107474e-05i, 0.49997282048955993 + 2.913793338554793e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, false, true, false}), ElementsAreArray({ DoubleNear(0.5000271795104367, 1.0e-7), DoubleNear(0.49997282048955993, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, false, false, true}), Matrix({ { 0.49588904970421605 + -1.601739303257882e-18i, -0.011642211655800871 + -0.0014905832832836042i }, { -0.011642211655800868 + 0.0014905832832836016i, 0.5041109502957807 + 2.1650162131819917e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, false, false, true}), ElementsAreArray({ DoubleNear(0.49588904970421605, 1.0e-7), DoubleNear(0.5041109502957807, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, true, false, false, false, false, false, false}), Matrix({ { 0.24747535877910637 + 3.7947076036992655e-19i, 2.241935644223876e-05 + -1.7625025133147027e-05i, 0.0005195234927874261 + 1.2890279278307896e-05i, 9.018689710009627e-06 + -2.7440756240602336e-06i }, { 2.241935644223875e-05 + 1.7625025133147037e-05i, 0.2525603118071599 + -3.2695471764015993e-19i, 8.990179638169261e-06 + 8.210513791505643e-07i, 0.0008074169181744386 + -2.4635268156579106e-05i }, { 0.0005195234927874261 + -1.2890279278307842e-05i, 8.990179638169263e-06 + -8.210513791505635e-07i, 0.24744392702825718 + -4.573977915173222e-19i, 1.7084357595374814e-05 + -1.865785576933224e-05i }, { 9.018689710009622e-06 + 2.74407562406023e-06i, 0.0008074169181744386 + 2.4635268156579153e-05i, 1.70843575953748e-05 + 1.865785576933225e-05i, 0.25252040238547324 + 9.681586587116653e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, true, false, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.24747535877910637, 1.0e-7), DoubleNear(0.2525603118071599, 1.0e-7), DoubleNear(0.24744392702825718, 1.0e-7), DoubleNear(0.25252040238547324, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, true, false, false, false, false, false}), Matrix({ { 0.2482520390187864 + -4.607859233063394e-19i, 1.2786817204295754e-05 + -1.0199475351012636e-05i, 0.000817827736019677 + -0.00029545081683277373i, 5.656054857389934e-06 + 3.1726524413420174e-06i }, { 1.2786817204295745e-05 + 1.019947535101265e-05i, 0.2514383863278792 + -4.743384504624082e-19i, 2.6489702845802897e-06 + -7.920265517850406e-07i, 0.0013724508111770453 + 0.00035892149302386837i }, { 0.000817827736019677 + 0.0002954508168327738i, 2.6489702845802893e-06 + 7.920265517850393e-07i, 0.24666724678857718 + 3.8285889215894375e-19i, 2.671689683331782e-05 + -2.608340555146663e-05i }, { 5.656054857389935e-06 + -3.1726524413420157e-06i, 0.0013724508111770458 + -0.00035892149302386853i, 2.6716896833317807e-05 + 2.6083405551466637e-05i, 0.25364232786475394 + 1.1155423915339135e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, true, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.2482520390187864, 1.0e-7), DoubleNear(0.2514383863278792, 1.0e-7), DoubleNear(0.24666724678857718, 1.0e-7), DoubleNear(0.25364232786475394, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, true, false, false, false, false}), Matrix({ { 0.2546883833237184 + -1.1519648082658485e-19i, 2.530731941363885e-05 + -1.981091943030674e-05i, -5.6906107161600394e-05 + -5.5845712809232326e-05i, 2.1684246479483334e-06 + -2.6124838301767855e-06i }, { 2.5307319413638836e-05 + 1.981091943030674e-05i, 0.25947585195706324 + 9.994988777600744e-20i, -2.664023116334632e-06 + -3.927708148292416e-06i, -5.5600873332393826e-05 + -2.4784635867869343e-05i }, { -5.6906107161600394e-05 + 5.5845712809232326e-05i, -2.664023116334633e-06 + 3.927708148292415e-06i, 0.24023090248364515 + 3.7269449679189215e-20i, 1.4196394623974726e-05 + -1.6471961472172524e-05i }, { 2.168424647948334e-06 + 2.6124838301767846e-06i, -5.5600873332393846e-05 + 2.4784635867869367e-05i, 1.4196394623974717e-05 + 1.647196147217254e-05i, 0.24560486223556988 + 5.412540532954979e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, true, false, false, false, false}), ElementsAreArray({ DoubleNear(0.2546883833237184, 1.0e-7), DoubleNear(0.25947585195706324, 1.0e-7), DoubleNear(0.24023090248364515, 1.0e-7), DoubleNear(0.24560486223556988, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, true, false, false, false}), Matrix({ { 0.2461739349099635 + 3.9641141931501256e-19i, 1.835260667589678e-05 + -1.6881833202842648e-05i, 0.0014060098186266102 + 0.00043676406171269536i, 0.00023914481458628303 + -0.00044420731139683026i }, { 1.8352606675896765e-05 + 1.6881833202842654e-05i, 0.2542642694839226 + -2.744386749103933e-19i, 0.0002356991708804397 + 0.0004476627436804826i, 0.001557896362777319 + -0.0004859760247639261i }, { 0.0014060098186266102 + -0.0004367640617126919i, 0.00023569917088043976 + -0.0004476627436804826i, 0.24874535089740005 + -4.743384504624082e-19i, 2.1151107361716788e-05 + -1.940104769963662e-05i }, { 0.00023914481458628303 + 0.0004442073113968303i, 0.0015578963627773184 + 0.00048597602476392956i, 2.1151107361716784e-05 + 1.940104769963663e-05i, 0.25081644470871045 + 9.156426159818987e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, true, false, false, false}), ElementsAreArray({ DoubleNear(0.2461739349099635, 1.0e-7), DoubleNear(0.2542642694839226, 1.0e-7), DoubleNear(0.24874535089740005, 1.0e-7), DoubleNear(0.25081644470871045, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, false, true, false, false}), Matrix({ { 0.23734037487481202 + -4.472333961502706e-19i, 2.4673575984914077e-05 + -2.2348440678961086e-05i, -0.0025508560268254574 + -0.01488207464066123i, -8.025482824131576e-06 + 3.905118634502694e-08i }, { 2.4673575984914063e-05 + 2.2348440678961096e-05i, 0.24955712124263987 + 9.232659125071874e-20i, -4.346939806728433e-06 + -6.257659678269873e-06i, -0.006802336262695256 + -0.017771886885574656i }, { -0.002550856026825461 + 0.014882074640661226i, -4.3469398067284335e-06 + 6.25765967826987e-06i, 0.2575789109325516 + 3.6930636500287495e-19i, 1.4830138052699496e-05 + -1.3934440223518184e-05i }, { -8.025482824131576e-06 + -3.905118634503541e-08i, -0.006802336262695252 + 0.017771886885574663i, 1.483013805269949e-05 + 1.3934440223518187e-05i, 0.2555235929499932 + 5.488773498207866e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, false, true, false, false}), ElementsAreArray({ DoubleNear(0.23734037487481202, 1.0e-7), DoubleNear(0.24955712124263987, 1.0e-7), DoubleNear(0.2575789109325516, 1.0e-7), DoubleNear(0.2555235929499932, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, false, false, true, false}), Matrix({ { 0.2473239031212069 + -1.212951180468158e-18i, 1.870761380011759e-05 + -2.371908333358184e-05i, -3.230478936526301e-05 + -3.1605488143420555e-07i, -0.00022920733365704708 + 0.00012538723555294637i }, { 1.8707613800117574e-05 + 2.3719083333581844e-05i, 0.25270327638922985 + -1.1375652481625254e-18i, -0.00023374488858521716 + -0.00013190737912863897i, 3.576751276381896e-05 + -1.041553586467327e-05i }, { -3.230478936526301e-05 + 3.160548814341886e-07i, -0.00023374488858521716 + 0.00013190737912863895i, 0.2475953826861567 + 1.1350241493207625e-18i, 2.0796100237495986e-05 + -1.2563797568897428e-05i }, { -0.00022920733365704708 + -0.00012538723555294642i, 3.576751276381897e-05 + 1.0415535864673274e-05i, 2.079610023749598e-05 + 1.256379756889744e-05i, 0.25237743780340327 + 1.7787691892340307e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, false, false, true, false}), ElementsAreArray({ DoubleNear(0.2473239031212069, 1.0e-7), DoubleNear(0.25270327638922985, 1.0e-7), DoubleNear(0.2475953826861567, 1.0e-7), DoubleNear(0.25237743780340327, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, false, false, false, true}), Matrix({ { 0.2411689326702101 + -1.4772254600114998e-18i, 2.207086840842847e-05 + -2.774381244788661e-05i, -0.0002444041436699181 + 0.005682376037348245i, -1.3870927842409245e-05 + 1.4501448407588474e-07i }, { 2.2070868408428453e-05 + 2.7743812447886624e-05i, 0.25472011703400593 + -1.2451384324638215e-19i, -6.611680891429727e-07 + -1.713561619363693e-05i, -0.011397807512130952 + -0.00717295932063185i }, { -0.00024440414366991205 + -0.005682376037348246i, -6.611680891429845e-07 + 1.7135616193636925e-05i, 0.25375035313715344 + 1.3992984288641042e-18i, 1.7432845629185103e-05 + -8.539068454592656e-06i }, { -1.3870927842409245e-05 + -1.450144840758949e-07i, -0.011397807512130953 + 0.007172959320631849i, 1.74328456291851e-05 + 8.539068454592659e-06i, 0.25036059715862713 + 7.657177843178875e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, false, false, false, true}), ElementsAreArray({ DoubleNear(0.2411689326702101, 1.0e-7), DoubleNear(0.25472011703400593, 1.0e-7), DoubleNear(0.25375035313715344, 1.0e-7), DoubleNear(0.25036059715862713, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, true, false, false, false, false, false}), Matrix({ { 0.24986398155131817 + -4.54009659728305e-19i, 0.0006072837015822267 + -1.042582624934657e-05i, 0.0010896158699829747 + 3.244220204125293e-05i, 0.002310747000193858 + -4.892741523625365e-05i }, { 0.0006072837015822267 + 1.0425826249346603e-05i, 0.24982644379534744 + -4.811147140404426e-19i, 0.0023094014419739266 + 3.5612766495611066e-05i, 0.0011006626772137478 + 3.102847414984173e-05i }, { 0.0010896158699829751 + -3.244220204125295e-05i, 0.002309401441973928 + -3.561276649561096e-05i, 0.25017168903494813 + 5.065257024580716e-19i, 0.0007196567093796382 + -1.3191626289246622e-06i }, { 0.0023107470001938585 + 4.892741523625417e-05i, 0.001100662677213748 + -3.102847414984184e-05i, 0.0007196567093796382 + 1.319162628924713e-06i, 0.250137885618383 + 9.918755812347857e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, true, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.24986398155131817, 1.0e-7), DoubleNear(0.24982644379534744, 1.0e-7), DoubleNear(0.25017168903494813, 1.0e-7), DoubleNear(0.250137885618383, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, true, false, false, false, false}), Matrix({ { 0.2572028588874877 + 4.692562527788824e-19i, 0.0006787941929144552 + -0.00019222020016288973i, -6.709302632868216e-05 + -2.2758944073052394e-05i, -0.02084084146802822 + -0.015399890364094903i }, { 0.0006787941929144552 + 0.00019222020016288987i, 0.25696137639329397 + -4.845028458294598e-19i, -0.020817145709728088 + -0.01540644612479705i, -4.541395416531204e-05 + -5.787140460404928e-05i }, { -6.709302632868218e-05 + 2.2758944073052394e-05i, -0.020817145709728088 + 0.015406446124797048i, 0.24283281169877852 + -4.1674021004911577e-19i, 0.0006481462180474095 + 0.0001804752112846185i }, { -0.020840841468028223 + 0.015399890364094903i, -4.541395416531205e-05 + 5.7871404604049295e-05i, 0.0006481462180474095 + -0.00018047521128461853i, 0.24300295302043645 + 9.952637130238029e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, true, false, false, false, false}), ElementsAreArray({ DoubleNear(0.2572028588874877, 1.0e-7), DoubleNear(0.25696137639329397, 1.0e-7), DoubleNear(0.24283281169877852, 1.0e-7), DoubleNear(0.24300295302043645, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, true, false, false, false}), Matrix({ { 0.2502368093153945 + -8.99548989984067e-19i, 0.0006809239868062051 + -6.067360419898053e-06i, 0.0014921569713337985 + -2.4963474526119832e-05i, 1.484903133323789e-05 + -1.5760607719147635e-06i }, { 0.000680923986806205 + 6.067360419898074e-06i, 0.25020139507849165 + 1.0215217343886862e-18i, 1.4721241739490579e-05 + -3.814972286298727e-06i, 0.0014717492100701304 + -2.4248488525110893e-05i }, { 0.0014921569713337985 + 2.4963474526123373e-05i, 1.472124173949058e-05 + 3.8149722862987396e-06i, 0.24979886127087178 + 9.520650327138336e-19i, 0.0006460164241556598 + -5.677628458373185e-06i }, { 1.4849031333237884e-05 + 1.5760607719147718e-06i, 0.0014717492100701302 + 2.424848852511432e-05i, 0.0006460164241556597 + 5.677628458373239e-06i, 0.24976293433523877 + -5.107608671943431e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, true, false, false, false}), ElementsAreArray({ DoubleNear(0.2502368093153945, 1.0e-7), DoubleNear(0.25020139507849165, 1.0e-7), DoubleNear(0.24979886127087178, 1.0e-7), DoubleNear(0.24976293433523877, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, false, true, false, false}), Matrix({ { 0.24348758764962583 + 2.964615315390051e-19i, 0.0006481914734869399 + -4.538755585103572e-06i, -0.0046287110565251055 + -0.01632368766255743i, -4.798618947589245e-05 + -8.327598871725387e-05i }, { 0.0006481914734869399 + 4.538755585103585e-06i, 0.24340990846782606 + -6.51368336438557e-19i, -4.856257499401045e-05 + -7.493264641064069e-05i, -0.004724481232995607 + -0.016330273863678458i }, { -0.004628711056525107 + 0.01632368766255743i, -4.856257499401045e-05 + 7.493264641064069e-05i, 0.2565480829366404 + -2.439454888092385e-19i, 0.000678748937474925 + -7.206233293167667e-06i }, { -4.798618947589241e-05 + 8.327598871725385e-05i, -0.0047244812329956054 + 0.016330273863678458i, 0.0006787489374749249 + 7.206233293167728e-06i, 0.2565544209459044 + 1.1621292036329e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, false, true, false, false}), ElementsAreArray({ DoubleNear(0.24348758764962583, 1.0e-7), DoubleNear(0.24340990846782606, 1.0e-7), DoubleNear(0.2565480829366404, 1.0e-7), DoubleNear(0.2565544209459044, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, false, false, true, false}), Matrix({ { 0.2500313880813631 + -1.2553028278308731e-18i, 0.0005910631975098323 + -1.1622463440421027e-06i, -3.0196033757767774e-06 + -9.245739381907808e-06i, 7.764422861528223e-05 + 7.313820191191682e-05i }, { 0.0005910631975098323 + 1.162246344042123e-06i, 0.24999579142907366 + -1.0952136007998103e-18i, 0.00022061343938826523 + 7.155087635423262e-05i, 6.482326774332728e-06 + -1.4858513641996624e-06i }, { -3.019603375776757e-06 + 9.245739381907822e-06i, 0.00022061343938826534 + -7.15508763542326e-05i, 0.25000428250490314 + 1.3078188705606397e-18i, 0.0007358772134520325 + -1.0582742534229136e-05i }, { 7.764422861528206e-05 + -7.313820191191651e-05i, 6.482326774332721e-06 + 1.485851364199654e-06i, 0.0007358772134520325 + 1.058274253422919e-05i, 0.2499685379846568 + 1.6059744679941534e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, false, false, true, false}), ElementsAreArray({ DoubleNear(0.2500313880813631, 1.0e-7), DoubleNear(0.24999579142907366, 1.0e-7), DoubleNear(0.25000428250490314, 1.0e-7), DoubleNear(0.2499685379846568, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, false, false, false, true}), Matrix({ { 0.2480229162303497 + 3.4389537658524594e-19i, 0.0006342675490823767 + 6.268570284691837e-06i, -0.005812159840111596 + -0.0007155743328360869i, -3.749435762467422e-05 + -5.447241188167219e-06i }, { 0.0006342675490823766 + -6.268570284691854e-06i, 0.24786613347386632 + -1.945634679843128e-18i, -2.770291420779828e-05 + 5.1921401838393e-06i, -0.005830051815689276 + -0.0007750089504475173i }, { -0.005812159840111595 + 0.000715574332836088i, -2.7702914207798297e-05 + -5.19214018383935e-06i, 0.2520127543559166 + -2.913793338554793e-19i, 0.0006926728618794882 + -1.8013559162963075e-05i }, { -3.7494357624674215e-05 + 5.447241188167219e-06i, -0.005830051815689273 + 0.0007750089504475152i, 0.0006926728618794882 + 1.8013559162963167e-05i, 0.25209819593986416 + 2.456395547037471e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, false, false, false, true}), ElementsAreArray({ DoubleNear(0.2480229162303497, 1.0e-7), DoubleNear(0.24786613347386632, 1.0e-7), DoubleNear(0.2520127543559166, 1.0e-7), DoubleNear(0.25209819593986416, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, true, false, false, false, false}), Matrix({ { 0.2569290737633453 + -1.3552527156068805e-18i, 0.0011263599073435071 + 3.128114569582127e-05i, -5.1706677363371166e-05 + -3.0736659659578425e-05i, -0.000203457981923251 + -0.00014056764457163763i }, { 0.0011263599073435076 + -3.12811456958214e-05i, 0.2572351615174364 + 1.3400061225563031e-18i, -0.00020425564113999881 + -0.0001370962886053785i, -6.080030313062305e-05 + -4.989368901752324e-05i }, { -5.1706677363371186e-05 + 3.073665965957844e-05i, -0.00020425564113999887 + 0.0001370962886053785i, 0.2427613515833203 + 4.2012834183813297e-19i, 0.0010639186398532154 + 3.21895304952734e-05i }, { -0.00020345798192325108 + 0.00014056764457163757i, -6.080030313062305e-05 + 4.9893689017523244e-05i, 0.0010639186398532154 + -3.2189530495273374e-05i, 0.24307441313589473 + 1.5839516113655416e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, true, false, false, false, false}), ElementsAreArray({ DoubleNear(0.2569290737633453, 1.0e-7), DoubleNear(0.2572351615174364, 1.0e-7), DoubleNear(0.2427613515833203, 1.0e-7), DoubleNear(0.24307441313589473, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, true, false, false, false}), Matrix({ { 0.2500509105864788 + -1.849919956803392e-18i, 0.0011103098864190786 + 2.8590538441446095e-05i, 0.001480526290338007 + -2.0350561844847942e-05i, 7.751896758724055e-05 + -3.209326032312204e-06i }, { 0.0011103098864190788 + -2.8590538441446048e-05i, 0.2503872938074074 + 1.971892701208011e-18i, 8.051168472102835e-05 + -8.36147999999244e-06i, 0.001483379891065922 + -2.8861401206382787e-05i }, { 0.001480526290338007 + 2.035056184485143e-05i, 8.051168472102832e-05 + 8.361479999992451e-06i, 0.24963951476018675 + 9.147955830346444e-19i, 0.0010799686607776437 + 3.488013774964854e-05i }, { 7.751896758724055e-05 + 3.209326032312194e-06i, 0.001483379891065922 + 2.8861401206386263e-05i, 0.001079968660777644 + -3.488013774964877e-05i, 0.2499222808459238 + -4.734914175151539e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, true, false, false, false}), ElementsAreArray({ DoubleNear(0.2500509105864788, 1.0e-7), DoubleNear(0.2503872938074074, 1.0e-7), DoubleNear(0.24963951476018675, 1.0e-7), DoubleNear(0.2499222808459238, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, false, true, false, false}), Matrix({ { 0.22312462513618575 + -2.168404344971009e-19i, -0.0010748048982997399 + 0.00020904728653348337i, 0.013827781306801408 + -0.02080655699568966i, 0.00042551051656440327 + -0.0041413382994351i }, { -0.0010748048982997397 + -0.0002090472865334836i, 0.26377287098126617 + -1.3806637040245096e-19i, -0.0027550879315122716 + -0.005120418253771352i, -0.02318097359632212 + -0.011847404530546226i }, { 0.013827781306801413 + 0.020806556995689663i, -0.0027550879315122716 + 0.005120418253771352i, 0.27656580021047983 + -7.182839392716467e-19i, 0.003265083445496462 + -0.00014557661034238873i }, { 0.00042551051656440327 + 0.004141338299435099i, -0.023180973596322124 + 0.011847404530546222i, 0.003265083445496463 + 0.0001455766103423888i, 0.23653670367206497 + 1.6364676540953083e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, false, true, false, false}), ElementsAreArray({ DoubleNear(0.22312462513618575, 1.0e-7), DoubleNear(0.26377287098126617, 1.0e-7), DoubleNear(0.27656580021047983, 1.0e-7), DoubleNear(0.23653670367206497, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, false, false, true, false}), Matrix({ { 0.2497283176438328 + -1.4568966692773966e-18i, 0.001086963338196259 + 7.220924058657792e-05i, 7.547742822347599e-07 + -6.495214709775867e-05i, 2.484774596800052e-05 + -3.153357405006295e-05i }, { 0.0010869633381962592 + -7.220924058657817e-05i, 0.250298861866604 + -8.936197593532869e-19i, -2.5328684245200348e-05 + -1.461477380656481e-05i, 2.707949116321194e-06 + 5.422055635165119e-05i }, { 7.547742822347768e-07 + 6.495214709775865e-05i, -2.532868424520024e-05 + 1.461477380656481e-05i, 0.24996210770283278 + 5.21772295508649e-19i, 0.0011033152090004635 + -8.738564395483308e-06i }, { 2.484774596800041e-05 + 3.153357405006284e-05i, 2.707949116321187e-06 + -5.422055635165118e-05i, 0.0011033152090004635 + 8.738564395483376e-06i, 0.25001071278672715 + 2.392021043046144e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, false, false, true, false}), ElementsAreArray({ DoubleNear(0.2497283176438328, 1.0e-7), DoubleNear(0.250298861866604, 1.0e-7), DoubleNear(0.24996210770283278, 1.0e-7), DoubleNear(0.25001071278672715, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, false, false, false, true}), Matrix({ { 0.25136112855486603 + -1.463672932855431e-18i, 0.00015708683630100666 + 8.274536419733243e-05i, 0.02143714634691534 + 0.0022758738806525508i, -0.0012059849306008262 + 0.0004693294314817804i }, { 0.00015708683630100666 + -8.274536419733271e-05i, 0.24452792114935 + -1.3806637040245096e-19i, -0.0015247814432748322 + 0.00019268812590266275i, -0.03307935800271621 + -0.0037664571639361563i }, { 0.02143714634691534 + -0.0022758738806525525i, -0.0015247814432748329 + -0.00019268812590266318i, 0.24832929679179955 + 5.285485590866834e-19i, 0.0020331917108957157 + -1.9274688006237816e-05i }, { -0.0012059849306008262 + -0.00046932943148178074i, -0.033079358002716205 + 0.0037664571639361537i, 0.002033191710895716 + 1.9274688006237924e-05i, 0.2557816535039811 + 1.6364676540953083e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, false, false, false, true}), ElementsAreArray({ DoubleNear(0.25136112855486603, 1.0e-7), DoubleNear(0.24452792114935, 1.0e-7), DoubleNear(0.24832929679179955, 1.0e-7), DoubleNear(0.2557816535039811, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, true, false, false, false}), Matrix({ { 0.2573339450564902 + 1.4314856808597676e-18i, -5.665641540306986e-05 + -4.035295010729204e-05i, 0.0016600032708958333 + -2.175472329869852e-05i, 2.5382576418447314e-06 + -2.786581668129529e-06i }, { -5.665641540306986e-05 + 4.0352950107292045e-05i, 0.24310425933739593 + -1.3095129364551483e-18i, 2.090510213441603e-06 + 2.7416895909104894e-06i, 0.0013039029105080956 + -2.7457239752532204e-05i }, { 0.0016600032708958333 + 2.1754723298701967e-05i, 2.0905102134416034e-06 + -2.7416895909104855e-06i, 0.25683029022429144 + -1.446732273910345e-18i, -5.585056509092435e-05 + -4.0277398569809624e-05i }, { 2.538257641844728e-06 + 2.7865816681295314e-06i, 0.0013039029105080956 + 2.7457239752535728e-05i, -5.5850565090924373e-05 + 4.027739856980965e-05i, 0.24273150538181912 + 1.8880364394298355e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, true, false, false, false}), ElementsAreArray({ DoubleNear(0.2573339450564902, 1.0e-7), DoubleNear(0.24310425933739593, 1.0e-7), DoubleNear(0.25683029022429144, 1.0e-7), DoubleNear(0.24273150538181912, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, false, true, false, false}), Matrix({ { 0.25036262219335503 + -2.591920818598159e-19i, -5.6333736758858604e-05 + -3.935665303082948e-05i, -0.004816549717575863 + -0.016786093002254338i, -2.1622939766493717e-06 + 8.405694144836166e-06i }, { -5.633373675885862e-05 + 3.9356653030829486e-05i, 0.23653487392409686 + -9.571472303973594e-20i, 4.6608875702038725e-06 + 7.577933097519489e-06i, -0.0045366425719448504 + -0.015867868523981553i }, { -0.004816549717575863 + 0.016786093002254334i, 4.660887570203865e-06 + -7.577933097519484e-06i, 0.26380161308742667 + 2.439454888092385e-19i, -5.617324373513561e-05 + -4.1273695646272184e-05i }, { -2.162293976649372e-06 + -8.40569414483617e-06i, -0.004536642571944851 + 0.015867868523981553i, -5.617324373513562e-05 + 4.1273695646272204e-05i, 0.2493008907951182 + 6.742382260144231e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, false, true, false, false}), ElementsAreArray({ DoubleNear(0.25036262219335503, 1.0e-7), DoubleNear(0.23653487392409686, 1.0e-7), DoubleNear(0.26380161308742667, 1.0e-7), DoubleNear(0.2493008907951182, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, false, false, true, false}), Matrix({ { 0.2570948457302297 + -1.8888834723770898e-18i, -3.638405012630886e-05 + -1.188491168308722e-05i, 2.840034730311722e-06 + -5.790884035654028e-06i, -1.1914209050449336e-05 + -1.3558036046913143e-05i }, { -3.638405012630887e-05 + 1.1884911683087232e-05i, 0.24293233378020704 + -4.616329562535937e-19i, -2.574895439972475e-06 + 7.744333408812425e-06i, 6.226886682442284e-07 + -4.940706710453446e-06i }, { 2.8400347303117356e-06 + 5.790884035654024e-06i, -2.5748954399725054e-06 + -7.744333408812425e-06i, 0.2570693895505519 + 1.8736368793265124e-18i, -7.612293036768535e-05 + -6.874543699401445e-05i }, { -1.191420905044933e-05 + 1.3558036046913143e-05i, 6.226886682442419e-07 + 4.940706710453443e-06i, -7.612293036768537e-05 + 6.874543699401445e-05i, 0.242903430939008 + 1.0401564592282808e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, false, false, true, false}), ElementsAreArray({ DoubleNear(0.2570948457302297, 1.0e-7), DoubleNear(0.24293233378020704, 1.0e-7), DoubleNear(0.2570693895505519, 1.0e-7), DoubleNear(0.242903430939008, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, false, false, false, true}), Matrix({ { 0.2549881098807035 + -6.945670167485263e-20i, -4.6476278986061006e-05 + -3.203516778706049e-05i, -0.006007284856104145 + -0.0007943385459563894i, -1.0217742729811866e-06 + 7.41669818632488e-06i }, { -4.647627898606101e-05 + 3.203516778706049e-05i, 0.24090093982351257 + -1.5322826015830293e-18i, 5.399528704636398e-07 + 1.2131301532090014e-05i, -0.0056349267996967265 + -0.0006962447373272151i }, { -0.006007284856104144 + 0.0007943385459563861i, 5.399528704636364e-07 + -1.2131301532090017e-05i, 0.25917612540007817 + 5.421010862427522e-20i, -6.603070150793321e-05 + -4.859518089004118e-05i }, { -1.0217742729811798e-06 + -7.416698186324874e-06i, -0.005634926799696722 + 0.0006962447373272157i, -6.603070150793322e-05 + 4.85951808900412e-05i, 0.24493482489570245 + 2.1108061045577164e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, false, false, false, true}), ElementsAreArray({ DoubleNear(0.2549881098807035, 1.0e-7), DoubleNear(0.24090093982351257, 1.0e-7), DoubleNear(0.25917612540007817, 1.0e-7), DoubleNear(0.24493482489570245, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, true, true, false, false}), Matrix({ { 0.24368586889735994 + -9.656175598699024e-19i, 0.0016361552918080912 + -2.7622804081381767e-05i, -0.004697722637967633 + -0.016360399395182065i, 7.67708638445807e-05 + 0.0003314730499842282i }, { 0.001636155291808091 + 2.76228040813852e-05i, 0.24321162722009193 + 6.107107549703505e-19i, 8.535998975363385e-05 + 0.0003196000717533984i, -0.00465546965155308 + -0.01629356213105382i }, { -0.0046977226379676315 + 0.016360399395182065i, 8.535998975363365e-05 + -0.00031960007175339843i, 0.2567523354965262 + 1.0875903042745216e-18i, 0.001327750889595838 + -2.1589158969848955e-05i }, { 7.677086384458058e-05 + -0.00033147304998422833i, -0.00465546965155308 + 0.016293562131053818i, 0.0013277508895958377 + 2.1589158969852493e-05i, 0.2563501683860186 + -1.6940658945086007e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, true, true, false, false}), ElementsAreArray({ DoubleNear(0.24368586889735994, 1.0e-7), DoubleNear(0.24321162722009193, 1.0e-7), DoubleNear(0.2567523354965262, 1.0e-7), DoubleNear(0.2563501683860186, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, true, false, true, false}), Matrix({ { 0.2502347403339622 + -9.723938234479368e-19i, 0.0014847217439719577 + -2.34660209037219e-05i, 2.9894471458371124e-06 + -4.680637610233774e-06i, -8.832443442299512e-06 + -5.282061325714797e-07i }, { 0.0014847217439719583 + 2.3466020903725377e-05i, 0.24979243917647456 + -1.3781226051827467e-18i, -6.959097097863822e-06 + -1.9083283718935805e-06i, 4.7327625271883453e-07 + -6.050953135873702e-06i }, { 2.9894471458370955e-06 + 4.680637610233791e-06i, -6.959097097863821e-06 + 1.908328371893578e-06i, 0.250203464059924 + 1.094366567852556e-18i, 0.0014791844374319714 + -2.5745942147508825e-05i }, { -8.832443442299514e-06 + 5.282061325714818e-07i, 4.732762527188684e-07 + 6.0509531358736816e-06i, 0.0014791844374319706 + 2.5745942147512314e-05i, 0.24976935642963596 + 1.819426770702237e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, true, false, true, false}), ElementsAreArray({ DoubleNear(0.2502347403339622, 1.0e-7), DoubleNear(0.24979243917647456, 1.0e-7), DoubleNear(0.250203464059924, 1.0e-7), DoubleNear(0.24976935642963596, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, true, false, false, true}), Matrix({ { 0.24819216624049728 + -1.9413995151068564e-18i, 0.0015498272820736755 + -3.0051512344233842e-05i, -0.005874331290573163 + -0.000792478090037413i, 9.147563600323357e-05 + -1.805917584036247e-05i }, { 0.0015498272820736753 + 3.005151234423731e-05i, 0.24769688346371876 + 3.3966021184897444e-19i, 0.00010905326010425648 + -5.1168186017899125e-05i, -0.005767880365227709 + -0.0006981051932461919i }, { -0.005874331290573161 + 0.0007924780900374145i, 0.0001090532601042565 + 5.1168186017899084e-05i, 0.2522460381533889 + 2.0633722595114756e-18i, 0.0014140788993302535 + -1.9160450706996884e-05i }, { 9.147563600323359e-05 + 1.805917584036239e-05i, -0.005767880365227705 + 0.0006981051932461869i, 0.0014140788993302535 + 1.916045070700038e-05i, 0.25186491214239176 + 1.0164395367051604e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, true, false, false, true}), ElementsAreArray({ DoubleNear(0.24819216624049728, 1.0e-7), DoubleNear(0.24769688346371876, 1.0e-7), DoubleNear(0.2522460381533889, 1.0e-7), DoubleNear(0.25186491214239176, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, true, true, false}), Matrix({ { 0.24331015318478133 + -1.2595379925671446e-18i, -0.0018357621392725764 + -0.01559953653499266i, 6.704169871483126e-05 + 1.3467495603489395e-05i, 1.8627403255193936e-05 + -3.767043314268364e-05i }, { -0.0018357621392725756 + 0.015599536534992662i, 0.2567170263256554 + -1.0909784360635388e-18i, -1.0779379758435994e-05 + 1.6914396962242707e-05i, -6.357897531627531e-05 + -2.4199086349596876e-05i }, { 6.704169871483127e-05 + -1.3467495603489392e-05i, -1.0779379758435994e-05 + -1.6914396962242707e-05i, 0.24358734293267054 + 9.046311876675928e-19i, -0.007517430150248136 + -0.017054424991243225i }, { 1.8627403255193946e-05 + 3.767043314268362e-05i, -6.35789753162753e-05 + 2.4199086349596866e-05i, -0.007517430150248137 + 0.017054424991243225i, 0.25638547755688934 + 2.0091621508872004e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, true, true, false}), ElementsAreArray({ DoubleNear(0.24331015318478133, 1.0e-7), DoubleNear(0.2567170263256554, 1.0e-7), DoubleNear(0.24358734293267054, 1.0e-7), DoubleNear(0.25638547755688934, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, true, false, true}), Matrix({ { 0.2500338957501432 + -1.0054281083908545e-18i, -0.010193340883750334 + -0.016782329123945387i, -0.008815195978667577 + 0.008971793712109752i, 0.0028021252579068234 + -0.005650703328481944i }, { -0.010193340883750335 + 0.016782329123945387i, 0.24585515395407287 + -5.963111948670274e-19i, -0.0024206525247157844 + -0.02064806542736153i, -0.0028270156771332943 + -0.010462376995393357i }, { -0.008815195978667575 + -0.008971793712109755i, -0.0024206525247157835 + 0.02064806542736153i, 0.23686360036730872 + 6.505213034913027e-19i, 0.0008401485942296206 + -0.015871632402290496i }, { 0.0028021252579068195 + 0.005650703328481946i, -0.0028270156771332917 + 0.010462376995393357i, 0.0008401485942296219 + 0.015871632402290496i, 0.26724734992847193 + 1.514494909690689e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, true, false, true}), ElementsAreArray({ DoubleNear(0.2500338957501432, 1.0e-7), DoubleNear(0.24585515395407287, 1.0e-7), DoubleNear(0.23686360036730872, 1.0e-7), DoubleNear(0.26724734992847193, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, false, true, true}), Matrix({ { 0.253963288585124 + -1.2188804110989382e-18i, 4.273165642463888e-05 + 1.153165992445717e-05i, -0.004733802004823099 + 0.001518652535294535i, -0.0001643937922387089 + -8.486017127327974e-05i }, { 4.273165642463891e-05 + -1.1531659924457144e-05i, 0.24192576111909203 + -3.8285889215894375e-19i, -7.345343593208899e-05 + -2.2952854561356594e-05i, -0.0069084096509777725 + -0.003009235818578139i }, { -0.004733802004823098 + -0.0015186525352945375i, -7.345343593208904e-05 + 2.295285456135658e-05i, 0.24606389092531275 + -1.1316360175317453e-18i, -3.926893302608294e-05 + -2.226325067056465e-05i }, { -0.0001643937922387089 + 8.486017127327974e-05i, -0.006908409650977769 + 0.003009235818578139i, -3.926893302608294e-05 + 2.2263250670564618e-05i, 0.2580470593704679 + 3.296652230713737e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, false, true, true}), ElementsAreArray({ DoubleNear(0.253963288585124, 1.0e-7), DoubleNear(0.24192576111909203, 1.0e-7), DoubleNear(0.24606389092531275, 1.0e-7), DoubleNear(0.2580470593704679, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, true, true, false, false, false, false, false}), Matrix({ { 0.12413172398831819 + 1.4907779871675686e-19i, 7.662310126772782e-06 + -4.8548063615874455e-06i, 0.0004198041568582813 + -2.1534311314587314e-07i, 4.543924867275241e-06 + 4.606297551254163e-06i, 0.0004063988106765521 + -0.00014648617213881688i, 2.816066997513387e-06 + 1.6313413964009727e-06i, 0.0011512249547992954 + 1.375287036835581e-05i, -3.3417594911508477e-06 + -4.0437165559033665e-06i }, { 7.662310126772775e-06 + 4.8548063615874506e-06i, 0.125732257563 + -6.030874584450618e-19i, 5.4944687341147e-06 + -3.6555810761851954e-06i, 0.00018747954472394528 + -1.0210483136200682e-05i, 1.6159357610242754e-06 + -4.977260732510917e-07i, 0.0006832170593064228 + 0.0001789283741800698i, -5.5826554616238e-08 + 1.0855818626255536e-06i, 0.0011595220453945634 + -6.268028560460955e-05i }, { 0.0004198041568582813 + 2.153431131459119e-07i, 5.494468734114702e-06 + 3.6555810761851984e-06i, 0.1241203150304682 + -6.098637220230962e-19i, 5.124507077522973e-06 + -5.3446689894251935e-06i, 0.0011479476118003758 + 5.5809166095688344e-05i, -2.9232699886692213e-06 + -3.938905101947264e-06i, 0.0004114289253431248 + -0.00014896464469395682i, 2.8399878598765466e-06 + 1.5413110449410445e-06i }, { 4.5439248672752335e-06 + -4.60629755125416e-06i, 0.00018747954472394526 + 1.0210483136200686e-05i, 5.124507077522967e-06 + 5.344668989425199e-06i, 0.1257061287648792 + 1.2874900798265365e-19i, 3.4333212031901104e-07 + 1.253408684703182e-06i, 0.0011614538301735508 + -2.019639960007719e-05i, 1.0330345235560135e-06 + -2.9430047853394895e-07i, 0.0006892337518706229 + 0.0001799931188437986i }, { 0.000406398810676552 + 0.00014648617213881688i, 1.6159357610242756e-06 + 4.977260732510921e-07i, 0.001147947611800376 + -5.580916609568818e-05i, 3.4333212031901273e-07 + -1.2534086847031825e-06i, 0.12334363479078819 + 2.303929616531697e-19i, 1.4757046315465976e-05 + -1.2770218771559578e-05i, 9.971933592914477e-05 + 1.3105622391453768e-05i, 4.474764842734386e-06 + -7.350373175314395e-06i }, { 2.8160669975133876e-06 + -1.631341396400972e-06i, 0.0006832170593064227 + -0.00017892837418006984i, -2.9232699886692204e-06 + 3.938905101947265e-06i, 0.0011614538301735517 + 2.0196399600077238e-05i, 1.4757046315465971e-05 + 1.2770218771559585e-05i, 0.1268280542441599 + 2.761327408049019e-19i, 3.495710904054559e-06 + 4.476632455335761e-06i, 0.0006199373734504934 + -1.4424785020378422e-05i }, { 0.0011512249547992954 + -1.3752870368355418e-05i, -5.5826554616239694e-08 + -1.0855818626255498e-06i, 0.0004114289253431249 + 0.0001489646446939569i, 1.0330345235560137e-06 + 2.943004785339481e-07i, 9.971933592914478e-05 + -1.3105622391453753e-05i, 3.4957109040545582e-06 + -4.476632455335762e-06i, 0.12332361199778899 + 1.5246593050577406e-19i, 1.1959850517851841e-05 + -1.3313186779907048e-05i }, { -3.341759491150847e-06 + 4.043716555903365e-06i, 0.0011595220453945634 + 6.268028560460955e-05i, 2.839987859876548e-06 + -1.5413110449410437e-06i, 0.0006892337518706229 + -0.00017999311884379874i, 4.474764842734388e-06 + 7.35037317531439e-06i, 0.0006199373734504934 + 1.442478502037847e-05i, 1.1959850517851834e-05 + 1.3313186779907048e-05i, 0.12681427362059405 + 8.394096507290116e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, true, true, false, false, false, false, false}), ElementsAreArray({ DoubleNear(0.12413172398831819, 1.0e-7), DoubleNear(0.125732257563, 1.0e-7), DoubleNear(0.1241203150304682, 1.0e-7), DoubleNear(0.1257061287648792, 1.0e-7), DoubleNear(0.12334363479078819, 1.0e-7), DoubleNear(0.1268280542441599, 1.0e-7), DoubleNear(0.12332361199778899, 1.0e-7), DoubleNear(0.12681427362059405, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, true, false, true, false, false, false, false}), Matrix({ { 0.12739889557408013 + 9.486769009248164e-20i, 1.3330132313822214e-05 + -6.935374650820295e-06i, 0.0002701152065802914 + -5.2689014442925544e-05i, 1.02087871866454e-05 + -1.5053805127424596e-06i, -1.814409623784573e-05 + -2.6799510845262554e-05i, 1.2516939715087081e-06 + -1.6910350743134917e-06i, -0.010402362018973212 + -0.0066760085729793694i, 4.499418727060238e-07 + 5.151762084940911e-08i }, { 1.333013231382221e-05 + 6.9353746508202945e-06i, 0.12980396331340754 + 3.7438856268640075e-19i, 5.6244018234199685e-06 + -2.631366208176497e-07i, 0.00040867898633416375 + -0.00013953118571996418i, -1.1946554899432423e-06 + -2.814309435287004e-06i, -4.894893009083644e-05 + 4.040566772210165e-06i, -4.57377041253988e-08 + -2.8611602735883406e-06i, -0.010438479449055005 + -0.008723881791115533i }, { 0.0002701152065802914 + 5.2689014442925585e-05i, 5.6244018234199685e-06 + 2.63136620817651e-07i, 0.12728948774963827 + -2.1006417091906648e-19i, 1.197718709981663e-05 + -1.2875544779486446e-05i, -0.010388730477674048 + -0.006679726866614241i, -1.7437094014343266e-06 + -7.760848182486419e-07i, -3.876201092375465e-05 + -2.9046201963969765e-05i, 9.167306764396253e-07 + -9.21448755863294e-07i }, { 1.0208787186645395e-05 + 1.5053805127424579e-06i, 0.0004086789863341638 + 0.00013953118571996423i, 1.1977187099816625e-05 + 1.2875544779486446e-05i, 0.1296718886436557 + -2.744386749103933e-19i, -1.5835034449570765e-06 + -5.936294169337485e-06i, -0.010428415232054037 + -0.008726719258182811i, -1.4693676263913897e-06 + -1.1133987130054124e-06i, -6.651943241557385e-06 + -2.882520264007951e-05i }, { -1.814409623784574e-05 + 2.6799510845262547e-05i, -1.194655489943242e-06 + 2.814309435287003e-06i, -0.010388730477674048 + 0.006679726866614239i, -1.5835034449570786e-06 + 5.936294169337486e-06i, 0.12007646320502623 + 2.846030702774449e-19i, 9.089224128416542e-06 + -1.068965048232673e-05i, 0.00024940828620713466 + 6.557929372123344e-05i, -1.190097476635774e-06 + -1.2386951113177723e-06i }, { 1.2516939715087073e-06 + 1.691035074313491e-06i, -4.894893009083644e-05 + -4.040566772210155e-06i, -1.7437094014343276e-06 + 7.760848182486402e-07i, -0.010428415232054037 + 0.00872671925818281i, 9.089224128416539e-06 + 1.068965048232674e-05i, 0.12275634849375232 + -7.013432803265607e-19i, 3.365777814749293e-06 + 1.084187999968214e-06i, 0.0003987379318402749 + 0.00011489591756338508i }, { -0.010402362018973214 + 0.0066760085729793694i, -4.5737704125401766e-08 + 2.8611602735883398e-06i, -3.876201092375465e-05 + 2.904620196396977e-05i, -1.469367626391391e-06 + 1.1133987130054126e-06i, 0.00024940828620713466 + -6.557929372123343e-05i, 3.365777814749294e-06 + -1.084187999968215e-06i, 0.12015443927861894 + -2.473336205982557e-19i, 5.107170495558185e-06 + -5.782310989845795e-06i }, { 4.4994187270602365e-07 + -5.151762084941059e-08i, -0.010438479449055009 + 0.008723881791115535i, 9.167306764396268e-07 + 9.214487558632931e-07i, -6.651943241557397e-06 + 2.882520264007952e-05i, -1.1900974766357723e-06 + 1.2386951113177719e-06i, 0.0003987379318402749 + -0.00011489591756338508i, 5.107170495558178e-06 + 5.7823109898458e-06i, 0.12284851374181754 + 1.2425973336220586e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, true, false, true, false, false, false, false}), ElementsAreArray({ DoubleNear(0.12739889557408013, 1.0e-7), DoubleNear(0.12980396331340754, 1.0e-7), DoubleNear(0.12728948774963827, 1.0e-7), DoubleNear(0.1296718886436557, 1.0e-7), DoubleNear(0.12007646320502623, 1.0e-7), DoubleNear(0.12275634849375232, 1.0e-7), DoubleNear(0.12015443927861894, 1.0e-7), DoubleNear(0.12284851374181754, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, true, false, false, true, false, false, false}), Matrix({ { 0.12309483486474919 + 8.131516293641283e-20i, 1.0539212790212487e-05 + -8.022516321978545e-06i, 0.0002522448082872778 + 6.2498352434494364e-06i, 5.300528577417596e-06 + -9.439956825736608e-07i, 0.0007076763932032236 + 0.0002177312423549679i, 0.00012077183770352825 + -0.0002226539682525963i, 1.2605085221484741e-05 + 9.915744995308276e-07i, 3.9300338839748875e-05 + -2.9980912963140967e-06i }, { 1.053921279021248e-05 + 8.022516321978547e-06i, 0.1271419744506453 + -9.808641529204798e-19i, 5.403138496052128e-06 + 3.1341104077166667e-07i, 0.00042867917851892713 + -1.2317195663347467e-05i, 0.00011896979613823112 + 0.00022457108662437907i, 0.000784480578130575 + -0.00024269471688108773i, 3.51466431448535e-05 + -2.672905507682827e-06i, 2.2439461117531477e-06 + -2.567635271445593e-06i }, { 0.0002522448082872779 + -6.249835243449408e-06i, 5.403138496052131e-06 + -3.1341104077166804e-07i, 0.12307910004521432 + 3.1509625637859973e-19i, 7.813393885684295e-06 + -8.859316880864103e-06i, 1.1734328516282528e-05 + 4.69233977351935e-07i, 3.476218234360742e-05 + 2.5569729604767843e-06i, 0.0006983334254233866 + 0.0002190328193577275i, 0.00011837297688275477 + -0.00022155334314423399i }, { 5.300528577417597e-06 + 9.439956825736593e-07i, 0.00042867917851892713 + 1.2317195663347484e-05i, 7.813393885684287e-06 + 8.859316880864108e-06i, 0.12712229503327735 + 7.064254780100865e-19i, 3.8599801681279156e-05 + 2.2060062830103285e-06i, 2.986913223208053e-06 + -4.2842062636506636e-06i, 0.00011672937474220858 + 0.0002230916570561035i, 0.0007734157846467438 + -0.0002432813078828384i }, { 0.0007076763932032239 + -0.0002177312423549661i, 0.00011896979613823115 + -0.00022457108662437907i, 1.173432851628253e-05 + -4.6923397735193097e-07i, 3.859980168127918e-05 + -2.206006283010308e-06i, 0.12438052391435717 + 2.981555974335137e-19i, 1.188014365202627e-05 + -9.602508811168478e-06i, 0.0002672786845001482 + 6.6404440348584605e-06i, 3.718161132592032e-06 + -1.8000799414865725e-06i }, { 0.00012077183770352825 + 0.00022265396825259633i, 0.0007844805781305747 + 0.00024269471688108952i, 3.476218234360745e-05 + -2.556972960476757e-06i, 2.9869132232080486e-06 + 4.284206263650668e-06i, 1.188014365202627e-05 + 9.602508811168488e-06i, 0.1254183373565146 + 6.539094352803199e-19i, 3.587041142117132e-06 + 5.076403383788978e-07i, 0.0003787377396555115 + -1.2318072493231639e-05i }, { 1.2605085221484741e-05 + -9.915744995308242e-07i, 3.51466431448535e-05 + 2.672905507682868e-06i, 0.0006983334254233866 + -0.0002190328193577258i, 0.00011672937474220859 + -0.0002230916570561035i, 0.0002672786845001482 + -6.6404440348584334e-06i, 3.5870411421171295e-06 + -5.076403383788953e-07i, 0.12436482698304288 + -7.724940478959219e-19i, 9.270963709690518e-06 + -9.798538888468137e-06i }, { 3.930033883974889e-05 + 2.998091296314117e-06i, 2.2439461117531443e-06 + 2.5676352714455956e-06i, 0.00011837297688275481 + 0.00022155334314423399i, 0.0007734157846467437 + 0.00024328130788284013i, 3.718161132592025e-06 + 1.8000799414865708e-06i, 0.00037873773965551157 + 1.2318072493231668e-05i, 9.270963709690516e-06 + 9.79853888846814e-06i, 0.1253981073521959 + 2.617331807015788e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, true, false, false, true, false, false, false}), ElementsAreArray({ DoubleNear(0.12309483486474919, 1.0e-7), DoubleNear(0.1271419744506453, 1.0e-7), DoubleNear(0.12307910004521432, 1.0e-7), DoubleNear(0.12712229503327735, 1.0e-7), DoubleNear(0.12438052391435717, 1.0e-7), DoubleNear(0.1254183373565146, 1.0e-7), DoubleNear(0.12436482698304288, 1.0e-7), DoubleNear(0.1253981073521959, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, true, false, false, false, true, false, false}), Matrix({ { 0.1186862767720955 + 3.4558944247975454e-19i, 1.3923729308723253e-05 + -1.140294592030898e-05i, 0.00022985980532469653 + 8.60101344030015e-06i, 2.397763874456942e-06 + -4.7755807543042135e-06i, -0.0012623543376518048 + -0.0074355846713545625i, -2.4552739067672315e-06 + 2.531236857888363e-06i, -1.7527585020683573e-06 + -3.120666204554321e-05i, 3.5855223425764904e-06 + -4.6493264267778105e-06i }, { 1.3923729308723246e-05 + 1.1402945920308987e-05i, 0.12480131087753032 + -4.912791094074942e-20i, 2.2916023827625416e-06 + 2.680524716597666e-06i, 0.0004183316681622433 + -1.313976902540372e-05i, -5.409183916188513e-07 + -4.278463209247027e-06i, -0.003366356718873301 + -0.008888102991202866i, -9.763305369441286e-06 + -4.675155768297033e-06i, -4.623343097382409e-05 + -5.206932667171066e-05i }, { 0.0002298598053246966 + -8.601013440300145e-06i, 2.2916023827625446e-06 + -2.680524716597667e-06i, 0.1186540981027165 + -7.928228386300251e-19i, 1.0749846676190824e-05 + -1.0945494758652104e-05i, -3.7981957211277914e-06 + -2.9132715964855556e-05i, 9.74860659671298e-07 + -6.2894706022928646e-06i, -0.0012885016891736527 + -0.007446489969306666i, -5.570208917364344e-06 + -2.492185671543334e-06i }, { 2.3977638744569393e-06 + 4.775580754304213e-06i, 0.0004183316681622433 + 1.3139769025403725e-05i, 1.0749846676190817e-05 + 1.0945494758652107e-05i, 0.12475581036510955 + 1.4145450219146816e-19i, -5.400629882137312e-06 + -6.252335966254684e-06i, -4.476437927288266e-05 + -4.579993044578514e-05i, -3.8060214151095814e-06 + -1.9791964690228464e-06i, -0.003435979543821954 + -0.008883783894371791i }, { -0.001262354337651808 + 0.007435584671354562i, -5.40918391618853e-07 + 4.278463209247023e-06i, -3.798195721127744e-06 + 2.9132715964855536e-05i, -5.400629882137313e-06 + 6.252335966254686e-06i, 0.12878908200701086 + 3.3881317890172014e-20i, 8.495627133515506e-06 + -6.2220792128380464e-06i, 0.00028966368746272955 + 4.289265838007746e-06i, 6.620925835552685e-06 + 2.03150513024398e-06i }, { -2.455273906767231e-06 + -2.531236857888368e-06i, -0.0033663567188732986 + 0.008888102991202866i, 9.74860659671293e-07 + 6.2894706022928646e-06i, -4.476437927288269e-05 + 4.5799930445785157e-05i, 8.495627133515504e-06 + 6.222079212838051e-06i, 0.12775900092962955 + -2.778268066994105e-19i, 6.698577255406719e-06 + -1.8594733374471007e-06i, 0.0003890852500121954 + -1.1495499131175386e-05i }, { -1.7527585020683064e-06 + 3.120666204554321e-05i, -9.763305369441288e-06 + 4.675155768297039e-06i, -0.0012885016891736535 + 0.007446489969306663i, -3.8060214151095793e-06 + 1.9791964690228473e-06i, 0.00028966368746272955 + -4.289265838007696e-06i, 6.698577255406716e-06 + 1.8594733374471037e-06i, 0.1287898289255407 + 3.3542504711270293e-19i, 6.33451091918399e-06 + -7.712361010680138e-06i }, { 3.5855223425764887e-06 + 4.649326426777818e-06i, -4.6233430973824095e-05 + 5.206932667171064e-05i, -5.570208917364346e-06 + 2.4921856715433334e-06i, -0.0034359795438219523 + 0.008883783894371795i, 6.620925835552683e-06 + -2.0315051302439825e-06i, 0.00038908525001219536 + 1.1495499131175426e-05i, 6.334510919183985e-06 + 7.71236101068014e-06i, 0.1277645920203637 + 8.267041565201971e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, true, false, false, false, true, false, false}), ElementsAreArray({ DoubleNear(0.1186862767720955, 1.0e-7), DoubleNear(0.12480131087753032, 1.0e-7), DoubleNear(0.1186540981027165, 1.0e-7), DoubleNear(0.12475581036510955, 1.0e-7), DoubleNear(0.12878908200701086, 1.0e-7), DoubleNear(0.12775900092962955, 1.0e-7), DoubleNear(0.1287898289255407, 1.0e-7), DoubleNear(0.1277645920203637, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, true, false, false, false, false, true, false}), Matrix({ { 0.12370121201775502 + -4.743384504624082e-19i, 9.949223599311793e-06 + -3.4307559052573124e-06i, 0.00029383292469717165 + 1.370818551780821e-05i, 3.208858163991362e-06 + -2.9273434442558352e-06i, -1.81863733914033e-05 + -2.3159466762480693e-06i, -0.00011569869467524456 + 6.394883066508283e-05i, -0.0002009346896214466 + 3.231178793090548e-05i, -1.0638306575718663e-06 + 2.4738174927406076e-05i }, { 9.949223599311791e-06 + 3.430755905257314e-06i, 0.12633017606360808 + -7.809643773684649e-19i, 6.815087975170894e-06 + -4.7590512614712705e-06i, 0.00029723027281266064 + -1.4870431861850302e-05i, -0.00011560152118279243 + -6.412552431461066e-05i, 1.5166770015626521e-05 + -6.929792705659751e-06i, 9.881437750156084e-06 + -6.491569023873453e-06i, 0.00027857891823672887 + 4.082641398101133e-05i }, { 0.00029383292469717165 + -1.3708185517808172e-05i, 6.815087975170897e-06 + 4.759051261471275e-06i, 0.12362269110345185 + -7.386127300057499e-19i, 8.758390200805794e-06 + -2.0288327428324525e-05i, -9.964106340065813e-05 + 2.8181178886870127e-05i, -1.875863508329084e-05 + 7.220229403825982e-08i, -1.4118415973859707e-05 + 1.9998917948138663e-06i, -0.00011350863898180254 + 6.143840488786356e-05i }, { 3.2088581639913575e-06 + 2.9273434442558335e-06i, 0.00029723027281266064 + 1.487043186185029e-05i, 8.758390200805782e-06 + 2.028832742832453e-05i, 0.12637310032562182 + -3.5660087079406044e-19i, -4.5407447094547295e-06 + 1.56653866322646e-05i, 0.0003202545027889233 + 4.3369697467362454e-05i, -0.00011814336740242472 + -6.778185481402831e-05i, 2.0600742748192438e-05 + -3.4857431590135245e-06i }, { -1.8186373391403288e-05 + 2.3159466762480655e-06i, -0.00011560152118279246 + 6.412552431461065e-05i, -9.964106340065799e-05 + -2.81811788868701e-05i, -4.5407447094547185e-06 + -1.5665386632264602e-05i, 0.12377414676135133 + 8.538092108323347e-19i, 1.2470132842926966e-05 + -1.4194269227889714e-05i, 0.0002256905680902544 + -8.179062395003124e-07i, 5.809831546018265e-06 + 1.8326782019560178e-07i }, { -0.00011569869467524455 + -6.394883066508284e-05i, 1.5166770015626533e-05 + 6.9297927056597474e-06i, -1.875863508329085e-05 + -7.220229403824797e-08i, 0.0003202545027889233 + -4.336969746736251e-05i, 1.2470132842926959e-05 + 1.4194269227889721e-05i, 0.12623013574355182 + 4.54009659728305e-19i, 2.175091662998366e-06 + 5.580102640621834e-06i, 0.000510186645361778 + -9.764836294728804e-06i }, { -0.00020093468962144662 + -3.23117879309054e-05i, 9.881437750156081e-06 + 6.491569023873457e-06i, -1.4118415973859717e-05 + -1.9998917948138765e-06i, -0.0001181433674024247 + 6.778185481402828e-05i, 0.00022569056809025443 + 8.17906239500331e-07i, 2.1750916629983653e-06 + -5.580102640621838e-06i, 0.12382123592480533 + 2.812149384884277e-19i, 8.32596739456902e-06 + 1.6304716589922858e-06i }, { -1.0638306575718684e-06 + -2.4738174927406066e-05i, 0.0002785789182367287 + -4.08264139810111e-05i, -0.00011350863898180251 + -6.14384048878636e-05i, 2.0600742748192445e-05 + 3.485743159013528e-06i, 5.809831546018265e-06 + -1.8326782019560347e-07i, 0.000510186645361778 + 9.764836294728862e-06i, 8.32596739456902e-06 + -1.6304716589922815e-06i, 0.12614730205985145 + 1.3247595295057257e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, true, false, false, false, false, true, false}), ElementsAreArray({ DoubleNear(0.12370121201775502, 1.0e-7), DoubleNear(0.12633017606360808, 1.0e-7), DoubleNear(0.12362269110345185, 1.0e-7), DoubleNear(0.12637310032562182, 1.0e-7), DoubleNear(0.12377414676135133, 1.0e-7), DoubleNear(0.12623013574355182, 1.0e-7), DoubleNear(0.12382123592480533, 1.0e-7), DoubleNear(0.12614730205985145, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, true, false, false, false, false, false, true}), Matrix({ { 0.1206120784384595 + 4.2012834183813297e-19i, 1.5501642305955584e-05 + -1.270309952400882e-05i, 0.00024126307340161592 + 1.1491047728036942e-05i, 3.856393400663014e-06 + -3.8872294263065466e-07i, -0.0001216180171836282 + 0.002850700100458709i, -5.372509527136191e-06 + 1.7890350767401847e-06i, 2.0879065421234952e-05 + 3.3167742050579697e-06i, -4.597004925297591e-06 + -6.633558741643893e-07i }, { 1.5501642305955577e-05 + 1.2703099524008826e-05i, 0.1274108377918902 + -7.623296525288703e-20i, 5.401507808530392e-06 + -2.2243578915498617e-07i, 0.0003930044756807607 + -5.222477443345076e-06i, 1.6714304450578744e-07 + -8.797381868557123e-06i, -0.0056905418229279674 + -0.0035662744332947967i, 2.549712813814744e-06 + 2.71795087157338e-06i, -5.8373423045909174e-05 + -8.76401539322519e-06i }, { 0.00024126307340161592 + -1.1491047728036945e-05i, 5.401507808530394e-06 + 2.224357891549866e-07i, 0.12055685423175057 + -1.8973538018496328e-18i, 6.569226102472886e-06 + -1.5040712923877791e-05i, 1.7683752391193903e-05 + 9.497743872865531e-06i, -6.473364959262099e-06 + 9.149108159851894e-07i, -0.00012278612648628992 + 0.002831675936889537i, -8.498418315273055e-06 + -1.6440205926643e-06i }, { 3.856393400663013e-06 + 3.887229426306517e-07i, 0.00039300447568076064 + 5.222477443345098e-06i, 6.569226102472878e-06 + 1.5040712923877798e-05i, 0.12730927924211577 + -4.828087799349512e-20i, 4.219175175497116e-06 + 3.7149541646482968e-06i, -4.538666659899219e-05 + -4.305603689026235e-06i, -8.28311133648761e-07 + -8.338234325079804e-06i, -0.005707265689202987 + -0.0036066848873370534i }, { -0.00012161801718362734 + -0.002850700100458709i, 1.671430445057849e-07 + 8.797381868557121e-06i, 1.7683752391193876e-05 + -9.497743872865555e-06i, 4.21917517549712e-06 + -3.714954164648296e-06i, 0.12686328034064687 + -4.0657581468206416e-20i, 6.9177141362831744e-06 + -4.921925609138207e-06i, 0.00027826041938581016 + 1.3992315502709544e-06i, 5.162296309346613e-06 + -2.355352681429579e-06i }, { -5.372509527136188e-06 + -1.7890350767401881e-06i, -0.0056905418229279674 + 0.0035662744332947967i, -6.473364959262102e-06 + -9.149108159851911e-07i, -4.538666659899218e-05 + 4.305603689026205e-06i, 6.9177141362831744e-06 + 4.921925609138209e-06i, 0.1251494740152697 + -2.507217523872729e-19i, 3.5886718296388685e-06 + 1.0434871683055505e-06i, 0.00041441244249367795 + -1.9412790713234028e-05i }, { 2.0879065421234932e-05 + -3.3167742050579393e-06i, 2.549712813814745e-06 + -2.717950871573381e-06i, -0.00012278612648628602 + -0.0028316759368895382i, -8.283111336487673e-07 + 8.338234325079807e-06i, 0.00027826041938581016 + -1.3992315502708968e-06i, 3.588671829638869e-06 + -1.04348716830555e-06i, 0.12688707279650663 + 1.4399560103323106e-18i, 1.0515131492901928e-05 + -3.6171428454544492e-06i }, { -4.597004925297593e-06 + 6.63355874164387e-07i, -5.837342304590915e-05 + 8.764015393225156e-06i, -8.498418315273058e-06 + 1.6440205926642915e-06i, -0.005707265689202988 + 0.003606684887337054i, 5.162296309346609e-06 + 2.3553526814295784e-06i, 0.000414412442493678 + 1.9412790713234055e-05i, 1.0515131492901925e-05 + 3.617142845454451e-06i, 0.12521112314335747 + 1.0164395367051604e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, true, false, false, false, false, false, true}), ElementsAreArray({ DoubleNear(0.1206120784384595, 1.0e-7), DoubleNear(0.1274108377918902, 1.0e-7), DoubleNear(0.12055685423175057, 1.0e-7), DoubleNear(0.12730927924211577, 1.0e-7), DoubleNear(0.12686328034064687, 1.0e-7), DoubleNear(0.1251494740152697, 1.0e-7), DoubleNear(0.12688707279650663, 1.0e-7), DoubleNear(0.12521112314335747, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, true, true, false, false, false, false}), Matrix({ { 0.1277443031009448 + -5.55653613398821e-19i, 9.066494294130364e-06 + -5.456036215648119e-06i, 0.0004222014648817659 + -0.00015147671537185696i, 3.2186222752994312e-06 + 1.8675294443089138e-06i, -3.86888839924577e-05 + -3.903308496770067e-05i, 1.8310111460023737e-06 + -1.4277051446489877e-06i, -9.841964468696903e-05 + -6.233704660174174e-05i, 1.9619101947179186e-06 + 2.666408130808347e-06i }, { 9.066494294130357e-06 + 5.4560362156481205e-06i, 0.12918477066240047 + -7.995991022080595e-19i, 1.0344033703138722e-06 + -3.809323880762035e-07i, 0.0007041584424617415 + 0.0001827578610676783i, -2.0909651649074093e-06 + -1.7313235551871725e-06i, -1.301779337091347e-05 + 8.29642530812224e-06i, -2.043515589895741e-06 + -6.20109707426005e-07i, -0.00010503833723628194 + -7.823059796989589e-05i }, { 0.0004222014648817657 + 0.0001514767153718569i, 1.0344033703138718e-06 + 3.809323880762029e-07i, 0.12694408022277362 + 4.404571325722362e-19i, 1.6240825119508485e-05 + -1.4354883214658624e-05i, -0.00010467299758696333 + -5.720253760675185e-05i, 2.02230238068572e-06 + 2.748151642240488e-06i, -1.821722316914269e-05 + -1.6812627841531654e-05i, 3.374135019459595e-07 + -1.184778685527798e-06i }, { 3.2186222752994317e-06 + -1.8675294443089131e-06i, 0.0007041584424617418 + -0.00018275786106767834i, 1.6240825119508475e-05 + 1.4354883214658622e-05i, 0.13029108129466277 + 8.99548989984067e-19i, -2.0331655147650905e-06 + -7.762672362442005e-07i, -9.95826435530355e-05 + -7.989375099862666e-05i, -5.730579514272231e-07 + -2.196384593105244e-06i, -4.258307996148036e-05 + -3.3081061175991584e-05i }, { -3.868888399245769e-05 + 3.903308496770066e-05i, -2.0909651649074105e-06 + 1.7313235551871713e-06i, -0.00010467299758696336 + 5.720253760675186e-05i, -2.0331655147650913e-06 + 7.762672362442003e-07i, 0.1205077359178416 + 9.486769009248164e-20i, 3.720322910165392e-06 + -4.743439135364518e-06i, 0.0003956262711379113 + -0.0001439741014609167i, 2.4374325820905025e-06 + 1.3051229970331036e-06i }, { 1.8310111460023733e-06 + 1.4277051446489866e-06i, -1.3017793370913485e-05 + -8.296425308122227e-06i, 2.0223023806857188e-06 + -2.7481516422404874e-06i, -9.958264355303548e-05 + 7.989375099862665e-05i, 3.720322910165387e-06 + 4.743439135364529e-06i, 0.12225361566547871 + 3.2526065174565133e-19i, 1.6145669142664175e-06 + -4.1109416370883727e-07i, 0.0006682923687153042 + 0.0001761636319561901i }, { -9.841964468696905e-05 + 6.233704660174174e-05i, -2.043515589895741e-06 + 6.201097074260035e-07i, -1.8217223169142697e-05 + 1.681262784153166e-05i, -5.730579514272227e-07 + 2.196384593105244e-06i, 0.0003956262711379114 + 0.00014397410146091684i, 1.6145669142664177e-06 + 4.110941637088377e-07i, 0.11972316656580356 + -5.759824041329242e-20i, 1.0476071713809334e-05 + -1.1728522336808004e-05i }, { 1.961910194717919e-06 + -2.6664081308083456e-06i, -0.00010503833723628198 + 7.823059796989586e-05i, 3.374135019459607e-07 + 1.1847786855277978e-06i, -4.258307996148036e-05 + 3.308106117599159e-05i, 2.4374325820905033e-06 + -1.3051229970331028e-06i, 0.0006682923687153037 + -0.0001761636319561902i, 1.047607171380933e-05 + 1.1728522336808013e-05i, 0.12335124657009117 + 2.1599340154984659e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, true, true, false, false, false, false}), ElementsAreArray({ DoubleNear(0.1277443031009448, 1.0e-7), DoubleNear(0.12918477066240047, 1.0e-7), DoubleNear(0.12694408022277362, 1.0e-7), DoubleNear(0.13029108129466277, 1.0e-7), DoubleNear(0.1205077359178416, 1.0e-7), DoubleNear(0.12225361566547871, 1.0e-7), DoubleNear(0.11972316656580356, 1.0e-7), DoubleNear(0.12335124657009117, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, true, false, true, false, false, false}), Matrix({ { 0.12348302818101994 + -1.0842021724855044e-18i, 7.871748033697931e-06 + -3.2688850087066012e-06i, 0.0003992819073356368 + -0.00015025172785289857i, 3.027005887838976e-06 + 1.4520307279779603e-06i, 0.0007141781021471859 + 0.00022071610698311579i, 0.00011639888707701775 + -0.0002187970938360211i, 4.901368972142842e-05 + -1.1938672888109236e-06i, 2.8393557297015567e-05 + 1.347159083093894e-05i }, { 7.871748033697921e-06 + 3.268885008706607e-06i, 0.1265678824054589 + -7.657177843178875e-19i, 1.290266679368924e-06 + -5.355000022931847e-07i, 0.0007110279790834417 + 0.0001788422662943447i, 0.0001140508867056889 + 0.00022110852619891406i, 0.000766348188190821 + -0.00024106666882796373i, 1.5292190351192252e-05 + -1.6773781392566237e-06i, 2.850527786581211e-05 + -2.0154587435012813e-06i }, { 0.0003992819073356368 + 0.00015025172785289867i, 1.2902666793689232e-06 + 5.355000022931843e-07i, 0.12269090672894359 + 1.480613591800517e-18i, 1.048085864219885e-05 + -1.3612948194136046e-05i, 5.077607353800159e-05 + 1.045809039974894e-06i, 1.5491219206322756e-05 + 2.3119902769144957e-06i, 0.0006918317164794244 + 0.0002160479547295796i, 0.00012274592750926525 + -0.00022541021756080916i }, { 3.027005887838976e-06 + -1.4520307279779588e-06i, 0.0007110279790834421 + -0.00017884226629434483i, 1.0480858642198846e-05 + 1.3612948194136048e-05i, 0.12769638707846376 + 4.912791094074942e-19i, 2.968418711763295e-05 + -1.3262422754974915e-05i, 2.9735611183026734e-05 + -9.407289039967328e-06i, 0.00012164828417475081 + 0.00022655421748156852i, 0.0007915481745864977 + -0.0002449093559359624i }, { 0.0007141781021471859 + -0.00022071610698311402i, 0.0001140508867056889 + -0.00022110852619891406i, 5.077607353800159e-05 + -1.0458090399748973e-06i, 2.9684187117632948e-05 + 1.326242275497491e-05i, 0.12476901083776645 + 6.2341624917916505e-19i, 4.915069170597825e-06 + -6.9305903423060365e-06i, 0.00041854582868404026 + -0.0001451990889798751i, 2.6290489695509583e-06 + 1.720621713364057e-06i }, { 0.00011639888707701775 + 0.0002187970938360211i, 0.0007663481881908209 + 0.00024106666882796546i, 1.549121920632275e-05 + -2.3119902769145016e-06i, 2.9735611183026714e-05 + 9.407289039967338e-06i, 4.915069170597823e-06 + 6.930590342306042e-06i, 0.1248705039224203 + 2.913793338554793e-19i, 1.3587036052113653e-06 + -2.56526549491856e-07i, 0.0006614228320936037 + 0.0001800792267295237i }, { 4.901368972142845e-05 + 1.1938672888109134e-06i, 1.529219035119225e-05 + 1.6773781392566228e-06i, 0.0006918317164794246 + -0.0002160479547295779i, 0.00012164828417475084 + -0.00022655421748156852i, 0.0004185458286840402 + 0.00014519908897987508i, 1.3587036052113661e-06 + 2.565265494918556e-07i, 0.1239763400596336 + -1.0977546996415732e-18i, 1.6236038191118967e-05 + -1.2470457357330582e-05i }, { 2.8393557297015563e-05 + -1.3471590830938936e-05i, 2.850527786581208e-05 + 2.015458743501289e-06i, 0.0001227459275092653 + 0.00022541021756080916i, 0.0007915481745864976 + 0.00024490935593596416i, 2.629048969550959e-06 + -1.7206217133640569e-06i, 0.0006614228320936035 + -0.00018007922672952375i, 1.623603819111896e-05 + 1.2470457357330584e-05i, 0.12594594078629018 + 6.2426328212641935e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, true, false, true, false, false, false}), ElementsAreArray({ DoubleNear(0.12348302818101994, 1.0e-7), DoubleNear(0.1265678824054589, 1.0e-7), DoubleNear(0.12269090672894359, 1.0e-7), DoubleNear(0.12769638707846376, 1.0e-7), DoubleNear(0.12476901083776645, 1.0e-7), DoubleNear(0.1248705039224203, 1.0e-7), DoubleNear(0.1239763400596336, 1.0e-7), DoubleNear(0.12594594078629018, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, true, false, false, true, false, false}), Matrix({ { 0.10890407879942662 + -3.7947076036992655e-19i, 8.583581765987781e-06 + -6.387875044525755e-06i, -0.00045957220960687087 + 1.499319947323701e-05i, 1.475337929927341e-06 + 2.4469568708025604e-06i, 0.007925736528147804 + -0.011020089018970988i, 6.784588513832069e-07 + 4.119828668533736e-06i, 4.7385392344600975e-06 + -0.0015262970705230447i, 2.979706046025853e-06 + -5.984502874026992e-06i }, { 8.583581765987776e-06 + 6.387875044525763e-06i, 0.11422054633675914 + 1.6263032587282567e-19i, -3.7510452291778005e-06 + 5.532208784327696e-06i, -0.0006152326886928689 + 0.00019405408706024636i, -7.669488685669717e-07 + -4.821313143837514e-06i, 0.005902044778653604 + -0.009786467976718673i, -3.449857740239804e-06 + -1.144905986088611e-05i, 0.00042077197732994317 + -0.0026150412289120536i }, { -0.0004595722096068708 + -1.4993199473237065e-05i, -3.7510452291778e-06 + -5.5322087843276966e-06i, 0.12843629607538537 + -6.776263578034403e-20i, 1.6089994218926298e-05 + -1.596056563443533e-05i, -0.0009403259420100949 + -0.002006281021384263i, -6.2127670138432075e-06 + -6.559242030801108e-06i, -0.010476592554973262 + -0.003861985621690241i, -8.703941675514785e-06 + -4.080777482188708e-06i }, { 1.4753379299273405e-06 + -2.4469568708025612e-06i, -0.0006152326886928689 + -0.00019405408706024647i, 1.6089994218926287e-05 + 1.596056563443533e-05i, 0.13533657490588075 + -7.030373462210693e-20i, -1.1313545228840122e-05 + -3.857221862827301e-06i, -0.0018147619895021764 + -0.003114137232387089i, -3.5799909381614606e-06 + -1.4363465344323599e-06i, -0.01270438104134886 + -0.007985418908855983i }, { 0.007925736528147802 + 0.011020089018970987i, -7.6694886856697e-07 + 4.821313143837513e-06i, -0.000940325942010095 + 0.0020062810213842624i, -1.1313545228840122e-05 + 3.8572218628273005e-06i, 0.13934796021935977 + -8.131516293641283e-20i, 4.2032354383079726e-06 + -3.811600306486882e-06i, 0.0012773999456265478 + -0.00031044401630601074i, 4.180716927462593e-06 + 7.256955705394568e-07i }, { 6.784588513832069e-07 + -4.11982866853374e-06i, 0.005902044778653609 + 0.009786467976718673i, -6.212767013843208e-06 + 6.559242030801109e-06i, -0.0018147619895021764 + 0.0031141372323870895i, 4.2032354383079675e-06 + 3.8116003064868865e-06i, 0.13721783999112003 + -6.369687763352339e-19i, 6.400015513758091e-06 + -6.3242353361127365e-06i, 0.0019876834998699146 + 0.000164867405963622i }, { 4.738539234459989e-06 + 0.0015262970705230447i, -3.4498577402398037e-06 + 1.144905986088611e-05i, -0.010476592554973263 + 0.0038619856216902397i, -3.5799909381614622e-06 + 1.4363465344323565e-06i, 0.0012773999456265478 + 0.0003104440163060108i, 6.40001551375809e-06 + 6.3242353361127365e-06i, 0.11823095071319178 + 4.506215279392878e-19i, 1.0626902614391522e-05 + -1.01228399170313e-05i }, { 2.9797060460258503e-06 + 5.9845028740269925e-06i, 0.00042077197732994306 + 0.002615041228912054i, -8.703941675514785e-06 + 4.080777482188705e-06i, -0.01270438104134886 + 0.007985418908855985i, 4.180716927462595e-06 + -7.256955705394544e-07i, 0.0019876834998699146 + -0.0001648674059636221i, 1.062690261439152e-05 + 1.0122839917031302e-05i, 0.11830575295887319 + 1.1858461261560205e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, true, false, false, true, false, false}), ElementsAreArray({ DoubleNear(0.10890407879942662, 1.0e-7), DoubleNear(0.11422054633675914, 1.0e-7), DoubleNear(0.12843629607538537, 1.0e-7), DoubleNear(0.13533657490588075, 1.0e-7), DoubleNear(0.13934796021935977, 1.0e-7), DoubleNear(0.13721783999112003, 1.0e-7), DoubleNear(0.11823095071319178, 1.0e-7), DoubleNear(0.11830575295887319, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, true, false, false, false, true, false}), Matrix({ { 0.12398600144925173 + -2.574980159653073e-19i, 8.864130798040881e-06 + -5.219459664599908e-06i, 0.00035959828991297284 + -0.00012008803180630391i, 3.826387744077206e-06 + 1.0135218630926033e-06i, -1.552566327070056e-05 + -2.5959440140218465e-05i, -0.00011602839267046618 + 6.264495039822046e-05i, -3.2603924435650234e-05 + -1.905225917257783e-05i, -2.081275339912166e-05 + 2.2461278898160884e-05i }, { 8.864130798040872e-06 + 5.219459664599912e-06i, 0.12574231619458107 + -1.1993986533120893e-18i, 7.702831848407823e-07 + -2.8272579146089833e-06i, 0.0007273650482832861 + 0.00019229727239288192i, -0.00011728509975789223 + -6.63617778190481e-05i, 1.6280437552935328e-05 + -3.89927069575402e-05i, -1.784396511113465e-05 + -2.106283035449461e-05i, 5.7451670403650646e-05 + -1.2481314877485174e-05i }, { 0.0003595982899129729 + 0.00012008803180630403i, 7.70283184840782e-07 + 2.8272579146089833e-06i, 0.12333790167195516 + -9.554531645028508e-19i, 9.843483002076708e-06 + -1.849962366898193e-05i, -5.325188909900469e-05 + -1.1677929539506297e-05i, -1.895683089147805e-05 + 2.1150931654036706e-05i, -1.677912609456244e-05 + 2.5643385258784264e-05i, -0.00011317894098658092 + 6.274228515472593e-05i }, { 3.826387744077208e-06 + -1.0135218630926026e-06i, 0.0007273650482832862 + -0.00019229727239288225i, 9.843483002076703e-06 + 1.8499623668981934e-05i, 0.1269609601946488 + 6.183340514956392e-20i, -1.987106724197226e-05 + -2.196586275267524e-05i, 2.7923204853804503e-05 + -2.936844267058513e-06i, -0.00011645978882732493 + -6.554560130959088e-05i, 1.948707521088363e-05 + 2.8577171092866933e-05i }, { -1.5525663270700544e-05 + 2.5959440140218454e-05i, -0.00011728509975789223 + 6.636177781904809e-05i, -5.325188909900485e-05 + 1.1677929539506243e-05i, -1.9871067241972244e-05 + 2.1965862752675258e-05i, 0.12426603756953465 + -2.0328790734103208e-19i, 3.9226864062548745e-06 + -4.98001568641273e-06i, 0.00045822944610670414 + -0.0001753627850264698i, 1.8296671133127274e-06 + 2.159130578249414e-06i }, { -0.00011602839267046619 + -6.264495039822048e-05i, 1.628043755293533e-05 + 3.89927069575402e-05i, -1.895683089147806e-05 + -2.11509316540367e-05i, 2.7923204853804503e-05 + 2.9368442670585403e-06i, 3.922686406254871e-06 + 4.980015686412738e-06i, 0.12569607013329812 + 7.250602028496811e-19i, 1.8786870997395074e-06 + 2.035231362823943e-06i, 0.0006450857628937593 + 0.00016662422063098647i }, { -3.260392443565018e-05 + 1.905225917257772e-05i, -1.784396511113464e-05 + 2.106283035449463e-05i, -1.6779126094562454e-05 + -2.5643385258784264e-05i, -0.00011645978882732493 + 6.554560130959085e-05i, 0.000458229446106704 + 0.00017536278502646975i, 1.8786870997395074e-06 + -2.035231362823944e-06i, 0.12332934511662202 + 1.3383120566617945e-18i, 1.687341383124111e-05 + -7.583781882484699e-06i }, { -2.0812753399121664e-05 + -2.246127889816087e-05i, 5.74516704036507e-05 + 1.2481314877485147e-05i, -0.0001131789409865809 + -6.274228515472595e-05i, 1.948707521088364e-05 + -2.857717109286692e-05i, 1.8296671133127276e-06 + -2.159130578249413e-06i, 0.0006450857628937594 + -0.00016662422063098628i, 1.6873413831241105e-05 + 7.583781882484702e-06i, 0.12668136767010513 + 1.0537089863843496e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, true, false, false, false, true, false}), ElementsAreArray({ DoubleNear(0.12398600144925173, 1.0e-7), DoubleNear(0.12574231619458107, 1.0e-7), DoubleNear(0.12333790167195516, 1.0e-7), DoubleNear(0.1269609601946488, 1.0e-7), DoubleNear(0.12426603756953465, 1.0e-7), DoubleNear(0.12569607013329812, 1.0e-7), DoubleNear(0.12332934511662202, 1.0e-7), DoubleNear(0.12668136767010513, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, true, false, false, false, false, true}), Matrix({ { 0.12306904138136593 + -1.0299920638612292e-18i, 9.684768875266985e-06 + -9.991426794548895e-06i, 9.052859188091238e-05 + -5.125222245924242e-05i, 2.5306685660797108e-06 + 1.3662887130064637e-06i, 0.013729536851108356 + 0.0042465050598625475i, -5.4664213163961375e-06 + 2.7477597156158665e-06i, -0.0001782008687455592 + 0.00020211616694263296i, 9.793442289304515e-07 + -1.2004846387785333e-06i }, { 9.684768875266978e-06 + 9.991426794548904e-06i, 0.1282920871735001 + -4.336808689942018e-19i, -2.040161961987215e-08 + 1.4908770688575595e-06i, 6.655824442009423e-05 + 0.00013399758665657487i, 7.27556861546491e-08 + -9.1163672239196e-06i, 0.007707609495806984 + -0.001970631179209997i, 3.612880719954054e-06 + 1.8557652413867733e-06i, -0.001027784061855267 + 0.0002672132645391474i }, { 9.05285918809124e-05 + 5.1252222459242206e-05i, -2.0401619619871622e-08 + -1.49087706885756e-06i, 0.11809989128884416 + -4.472333961502706e-19i, 1.2386099533161487e-05 + -1.7752385653337717e-05i, -0.0003225417004434081 + -0.00012172759645537085i, -3.4039044589596955e-06 + -4.6633247179116485e-06i, -0.013973940994778276 + 0.0014358709774856962i, -8.404506526013107e-06 + -2.6027452315399818e-06i }, { 2.5306685660797116e-06 + -1.3662887130064628e-06i, 6.65582444200942e-05 + -0.00013399758665657495i, 1.2386099533161477e-05 + 1.775238565333772e-05i, 0.12642802986050586 + 3.091670257478196e-19i, 1.3048630398408336e-06 + -5.890974814702173e-07i, -0.001202239742831424 + 0.0003144157223580337i, -7.339237752976226e-07 + -8.019248969717327e-06i, -0.019105417007937938 + -0.0052023281414218525i }, { 0.013729536851108358 + -0.00424650505986255i, 7.275568615464317e-08 + 9.116367223919602e-06i, -0.0003225417004434083 + 0.00012172759645537074i, 1.3048630398408334e-06 + 5.890974814702173e-07i, 0.12518299763742047 + 5.692061405548898e-19i, 3.1020483290287695e-06 + -2.0804855646374198e-07i, 0.0007272991441387646 + -0.0002441985943735313i, 3.1253862913102234e-06 + 1.8063637283355535e-06i }, { -5.466421316396137e-06 + -2.7477597156158733e-06i, 0.007707609495806983 + 0.0019706311792099967i, -3.4039044589596985e-06 + 4.663324717911648e-06i, -0.0012022397428314243 + -0.000314415722358034i, 3.1020483290287665e-06 + 2.0804855646374537e-07i, 0.1231462991543791 + -4.0657581468206416e-20i, 2.669371904200162e-06 + -2.2829036206426e-06i, 0.0013058925667569512 + 0.00022492390636729353i }, { -0.00017820086874555915 + -0.00020211616694263315i, 3.6128807199540537e-06 + -1.855765241386774e-06i, -0.01397394099477827 + -0.0014358709774856962i, -7.339237752976273e-07 + 8.019248969717325e-06i, 0.0007272991441387646 + 0.00024419859437353156i, 2.669371904200161e-06 + 2.282903620642599e-06i, 0.12856735549973303 + 8.300922883092143e-19i, 1.4330797300156332e-05 + -8.331019898128915e-06i }, { 9.7934422893045e-07 + 1.2004846387785325e-06i, -0.001027784061855267 + -0.00026721326453914767i, -8.404506526013109e-06 + 2.6027452315399775e-06i, -0.01910541700793794 + 0.0052023281414218525i, 3.1253862913102234e-06 + -1.8063637283355526e-06i, 0.0013058925667569516 + -0.00022492390636729358i, 1.433079730015633e-05 + 8.331019898128915e-06i, 0.1272142980042481 + 8.063753657860939e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, true, false, false, false, false, true}), ElementsAreArray({ DoubleNear(0.12306904138136593, 1.0e-7), DoubleNear(0.1282920871735001, 1.0e-7), DoubleNear(0.11809989128884416, 1.0e-7), DoubleNear(0.12642802986050586, 1.0e-7), DoubleNear(0.12518299763742047, 1.0e-7), DoubleNear(0.1231462991543791, 1.0e-7), DoubleNear(0.12856735549973303, 1.0e-7), DoubleNear(0.1272142980042481, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, true, true, false, false, false}), Matrix({ { 0.12674137428771137 + 7.657177843178875e-19i, 1.1815307274513777e-05 + -9.486201156960054e-06i, -2.7723236195300733e-05 + -2.6777837725523002e-05i, 1.3989420309534225e-06 + -2.081929906979305e-06i, 0.0007619678699358469 + 0.00021955617080514779i, 0.0001439906909516477 + -0.00022884049608116146i, 4.783658320192799e-07 + -1.8096605563253306e-06i, -8.486674042452084e-07 + -6.210396207310348e-06i }, { 1.181530727451377e-05 + 9.486201156960052e-06i, 0.13059257076877887 + 6.657678965418801e-19i, -1.3191684540339806e-06 + -1.795839994449041e-06i, -2.893317920776913e-05 + -1.3575112381769036e-05i, 0.0001439123676028226 + 0.00023074646737752464i, 0.0008980354009599865 + -0.0002413108941038463i, -1.1316817321036728e-05 + -1.1093036300075486e-05i, 2.0598918098254516e-06 + -9.76921111804198e-07i }, { -2.772323619530073e-05 + 2.6777837725523002e-05i, -1.3191684540339812e-06 + 1.7958399944490408e-06i, 0.11943256062225213 + -3.6930636500287495e-19i, 6.537299401383003e-06 + -7.395632045882596e-06i, 9.779119863337107e-07 + 2.2430362544820274e-06i, -1.0210400413423766e-05 + 1.043496715248632e-05i, 0.0006440419486907632 + 0.00021720789090754763i, 9.515412363463532e-05 + -0.0002153668153156688i }, { 1.3989420309534214e-06 + 2.081929906979305e-06i, -2.8933179207769134e-05 + 1.3575112381769038e-05i, 6.537299401382997e-06 + 7.3956320458826025e-06i, 0.1236716987151438 + -9.402065714522734e-19i, -6.918203394072713e-08 + 6.726231821358609e-06i, 1.1125982271078925e-06 + 4.986533364284621e-07i, 9.178680327761712e-05 + 0.00021691627630295794i, 0.0006598609618173323 + -0.0002446651306600798i }, { 0.0007619678699358471 + -0.00021955617080514605i, 0.00014391236760282264 + -0.0002307464673775246i, 9.779119863337111e-07 + -2.243036254482026e-06i, -6.918203394071104e-08 + -6.726231821358632e-06i, 0.12794700903600703 + -8.809142651444724e-19i, 1.3492012139125068e-05 + -1.0324718273346689e-05i, -2.9182870966299654e-05 + -2.906787508370932e-05i, 7.69482616994911e-07 + -5.305539231974805e-07i }, { 0.0001439906909516477 + 0.00022884049608116143i, 0.0008980354009599864 + 0.000241310894103848i, -1.0210400413423784e-05 + -1.0434967152486323e-05i, 1.112598227107892e-06 + -4.986533364284597e-07i, 1.3492012139125063e-05 + 1.0324718273346689e-05i, 0.1288832811882844 + -5.658180087658726e-19i, -1.344854662300651e-06 + -2.1318681538433753e-06i, -2.6667694124624702e-05 + -1.1209523486100309e-05i }, { 4.78365832019279e-07 + 1.809660556325332e-06i, -1.1316817321036732e-05 + 1.1093036300075485e-05i, 0.0006440419486907634 + -0.00021720789090754587i, 9.178680327761712e-05 + -0.00021691627630295794i, -2.9182870966299668e-05 + 2.906787508370932e-05i, -1.3448546623006523e-06 + 2.1318681538433745e-06i, 0.12079834186139302 + 4.0657581468206416e-19i, 7.659095222591724e-06 + -9.076329426289928e-06i }, { -8.486674042452084e-07 + 6.210396207310336e-06i, 2.0598918098254486e-06 + 9.769211118041997e-07i, 9.515412363463532e-05 + 0.00021536681531566886i, 0.0006598609618173321 + 0.0002446651306600816i, 7.694826169949127e-07 + 5.305539231974799e-07i, -2.666769412462471e-05 + 1.1209523486100324e-05i, 7.659095222591721e-06 + 9.076329426289938e-06i, 0.12193316352042607 + 1.4814606247477713e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, true, true, false, false, false}), ElementsAreArray({ DoubleNear(0.12674137428771137, 1.0e-7), DoubleNear(0.13059257076877887, 1.0e-7), DoubleNear(0.11943256062225213, 1.0e-7), DoubleNear(0.1236716987151438, 1.0e-7), DoubleNear(0.12794700903600703, 1.0e-7), DoubleNear(0.1288832811882844, 1.0e-7), DoubleNear(0.12079834186139302, 1.0e-7), DoubleNear(0.12193316352042607, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, true, false, true, false, false}), Matrix({ { 0.12224505491875 + -4.404571325722362e-19i, 1.5207035563437336e-05 + -1.2145944958271862e-05i, -2.663588427342466e-05 + -2.7501054097374143e-05i, 1.2890307454829302e-06 + -8.493169757542608e-07i, -0.001373404215256952 + -0.007695834149864614i, -4.460508747957079e-06 + 1.9415128383061763e-07i, -3.5555971068693207e-06 + -2.4494680844345028e-06i, -1.078297389776147e-06 + -4.34534730838068e-08i }, { 1.5207035563437327e-05 + 1.2145944958271862e-05i, 0.12811756727460505 + 1.8126505071242027e-19i, -1.3473394821193983e-06 + -3.106722171764853e-06i, -2.9697852485433943e-05 + -1.1855598933455334e-05i, -1.842084599489488e-06 + -3.667989299125974e-06i, -0.0034431455023189103 + -0.009090258852389723i, 2.6635926123735298e-06 + 9.447537982526834e-07i, 1.3933031302199478e-06 + 1.0855162229270668e-05i }, { -2.6635884273424664e-05 + 2.7501054097374143e-05i, -1.347339482119399e-06 + 3.106722171764852e-06i, 0.11509531995606201 + -6.776263578034403e-21i, 9.466540421476745e-06 + -1.0202495720689222e-05i, 1.2739536856496324e-06 + 5.05686207781105e-06i, -7.622767436632635e-07 + -1.508190199794934e-07i, -0.0011774518115685053 + -0.007186240490796616i, -3.564974076174497e-06 + -1.5510009748558942e-07i }, { 1.2890307454829315e-06 + 8.493169757542614e-07i, -2.969785248543395e-05 + 1.1855598933455346e-05i, 9.466540421476736e-06 + 1.020249572068923e-05i, 0.12143955396803484 + -8.893845946170154e-20i, 1.7649847367625727e-06 + -7.856338921889591e-08i, 3.3869338845542393e-06 + 2.5210710197084388e-06i, -2.5048552072389427e-06 + -2.589670379143899e-06i, -0.0033591907603763454 + -0.008681628033184934i }, { -0.0013734042152569533 + 0.00769583414986461i, -1.8420845994894883e-06 + 3.667989299125973e-06i, 1.273953685649627e-06 + -5.056862077811049e-06i, 1.7649847367625744e-06 + 7.856338921889634e-08i, 0.13244332840496842 + 3.2526065174565133e-19i, 1.0100283850201512e-05 + -7.66497447203488e-06i, -3.0270222888175723e-05 + -2.8344658711858183e-05i, 8.793939024654032e-07 + -1.7631668544225243e-06i }, { -4.460508747957078e-06 + -1.9415128383062017e-07i, -0.0034431455023189086 + 0.009090258852389725i, -7.622767436632641e-07 + 1.5081901997949253e-07i, 3.3869338845542368e-06 + -2.5210710197084367e-06i, 1.0100283850201507e-05 + 7.664974472034879e-06i, 0.1313582846824582 + -8.131516293641283e-20i, -1.3166836342152338e-06 + -8.209859765275641e-07i, -2.5903020846959886e-05 + -1.2929036934414009e-05i }, { -3.555597106869322e-06 + 2.4494680844345007e-06i, 2.6635926123735298e-06 + -9.447537982526839e-07i, -0.0011774518115685074 + 0.007186240490796615i, -2.504855207238943e-06 + 2.5896703791438967e-06i, -3.0270222888175733e-05 + 2.8344658711858176e-05i, -1.3166836342152344e-06 + 8.209859765275633e-07i, 0.12513558252758314 + 4.404571325722362e-20i, 4.729854202497982e-06 + -6.269465751483301e-06i }, { -1.0782973897761474e-06 + 4.3453473083805156e-08i, 1.3933031302199512e-06 + -1.085516222927067e-05i, -3.5649740761744995e-06 + 1.5510009748558518e-07i, -0.0033591907603763432 + 0.008681628033184936i, 8.793939024654026e-07 + 1.7631668544225233e-06i, -2.5903020846959893e-05 + 1.292903693441402e-05i, 4.7298542024979824e-06 + 6.269465751483309e-06i, 0.12416530826753502 + 6.301925127571995e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, true, false, true, false, false}), ElementsAreArray({ DoubleNear(0.12224505491875, 1.0e-7), DoubleNear(0.12811756727460505, 1.0e-7), DoubleNear(0.11509531995606201, 1.0e-7), DoubleNear(0.12143955396803484, 1.0e-7), DoubleNear(0.13244332840496842, 1.0e-7), DoubleNear(0.1313582846824582, 1.0e-7), DoubleNear(0.12513558252758314, 1.0e-7), DoubleNear(0.12416530826753502, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, true, false, false, true, false}), Matrix({ { 0.1272738793904402 + -1.2807138162485021e-18i, 1.189433685703301e-05 + -1.1943525283124488e-05i, -2.6400556744476365e-05 + -1.819533347843223e-05i, 2.0944649296452237e-06 + -1.6882653931638438e-06i, -1.5311075021570637e-05 + -1.2492198026044862e-06i, -0.0001369108187483265 + 8.80239344097755e-05i, 7.293889096287342e-06 + -3.440475413842138e-06i, -8.970809303875099e-07 + 3.4767753695041326e-06i }, { 1.1894336857033002e-05 + 1.1943525283124486e-05i, 0.1298209663397895 + -6.081696561285876e-19i, -8.560509957252632e-07 + -3.488872096000695e-07i, -9.983493381832496e-06 + 6.310421795345015e-06i, -0.00013927504083464495 + -9.134615355582935e-05i, 1.8151109751882366e-05 + -4.541664233049546e-06i, -4.046615809155691e-07 + -2.8533450722016035e-06i, -1.920809814673668e-05 + -1.0117560633070998e-05i }, { -2.640055674447637e-05 + 1.8195333478432234e-05i, -8.560509957252639e-07 + 3.48887209600069e-07i, 0.12005002373076669 + 6.776263578034403e-20i, 6.813276943084578e-06 + -1.1775558050457349e-05i, 8.631902171017012e-06 + 2.363621247738065e-06i, 6.005004816918221e-07 + 8.211259818750232e-07i, -1.6993714343692368e-05 + 9.33164921170284e-07i, -9.229651490872061e-05 + 3.7363301143170873e-05i }, { 2.0944649296452224e-06 + 1.688265393163843e-06i, -9.983493381832498e-06 + -6.310421795344999e-06i, 6.813276943084574e-06 + 1.1775558050457358e-05i, 0.12288231004944034 + -5.293955920339377e-19i, -3.971601546498185e-06 + -5.237223774291675e-06i, -1.120679761098949e-05 + 5.380712161074362e-06i, -9.44698477505722e-05 + -4.056122557280963e-05i, 1.761640301193659e-05 + -5.873871631623733e-06i }, { -1.5311075021570634e-05 + 1.2492198026044735e-06i, -0.00013927504083464495 + 9.134615355582931e-05i, 8.631902171016985e-06 + -2.3636212477380785e-06i, -3.971601546498184e-06 + 5.237223774291677e-06i, 0.12741450393327822 + 1.1655173354219173e-18i, 1.3412982556605837e-05 + -7.867394147182253e-06i, -3.0505550417124022e-05 + -3.765037933080009e-05i, 7.395971830310978e-08 + -9.242184370129415e-07i }, { -0.00013691081874832648 + -8.802393440977554e-05i, 1.8151109751882363e-05 + 4.541664233049551e-06i, 6.005004816918246e-07 + -8.211259818750184e-07i, -1.1206797610989494e-05 + -5.380712161074344e-06i, 1.3412982556605834e-05 + 7.867394147182256e-06i, 0.12965488561727373 + 7.081195439045951e-19i, -1.807972120609369e-06 + -3.578820938692347e-06i, -4.5617379950561336e-05 + -3.109505766321436e-05i }, { 7.293889096287342e-06 + 3.4404754138421396e-06i, -4.0466158091557103e-07 + 2.8533450722016094e-06i, -1.699371434369237e-05 + -9.33164921170284e-07i, -9.44698477505722e-05 + 4.0561225572809624e-05i, -3.0505550417124026e-05 + 3.765037933080009e-05i, -1.8079721206093694e-06 + 3.5788209386923464e-06i, 0.12018087875287845 + -3.049318610115481e-20i, 7.383117680890147e-06 + -4.696403421715174e-06i }, { -8.970809303875088e-07 + -3.4767753695041314e-06i, -1.9208098146736672e-05 + 1.0117560633070992e-05i, -9.229651490872061e-05 + -3.736330114317089e-05i, 1.7616403011936606e-05 + 5.873871631623733e-06i, 7.395971830311174e-08 + 9.242184370129415e-07i, -4.561737995056135e-05 + 3.1095057663214365e-05i, 7.383117680890144e-06 + 4.696403421715184e-06i, 0.12272255218612954 + 1.0706496453294356e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, true, false, false, true, false}), ElementsAreArray({ DoubleNear(0.1272738793904402, 1.0e-7), DoubleNear(0.1298209663397895, 1.0e-7), DoubleNear(0.12005002373076669, 1.0e-7), DoubleNear(0.12288231004944034, 1.0e-7), DoubleNear(0.12741450393327822, 1.0e-7), DoubleNear(0.12965488561727373, 1.0e-7), DoubleNear(0.12018087875287845, 1.0e-7), DoubleNear(0.12272255218612954, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, true, false, false, false, true}), Matrix({ { 0.12423719979891895 + -5.759824041329242e-19i, 1.40932359477679e-05 + -1.4885466662359121e-05i, -2.460133815546866e-05 + -2.536471177243893e-05i, 5.81354503154446e-07 + -1.8814295157776028e-06i, -0.00028899385274338066 + 0.0027300859024606983i, -7.685131996983085e-06 + 9.972962143869964e-07i, -8.948660299327344e-06 + 1.0490530593692012e-06i, -1.5365246301518374e-07 + 1.0219585373138447e-06i }, { 1.409323594776789e-05 + 1.4885466662359125e-05i, 0.13075091008178452 + 5.065257024580716e-19i, -1.9815770670394257e-06 + -2.353216880962361e-06i, -2.1874940830592345e-05 + -6.6704560146215534e-06i, 3.678443099358306e-08 + -9.10876565857556e-06i, -0.005718291003360764 + -0.0035244244484170873i, -1.873827713014843e-06 + -9.368985605169163e-07i, 7.926886026346157e-06 + 6.367645126955679e-06i }, { -2.4601338155468664e-05 + 2.536471177243893e-05i, -1.9815770670394274e-06 + 2.3532168809623607e-06i, 0.11693173287129113 + -9.012430558785756e-19i, 7.977632460660571e-06 + -1.2858345785527488e-05i, 3.7462420592899436e-06 + 7.606676769457679e-06i, 1.0059754741241144e-06 + 2.8809771507733253e-06i, 4.4589709073462967e-05 + 0.0029522901348875475i, -6.18579584542616e-06 + -8.522817303111117e-07i }, { 5.813545031544465e-07 + 1.8814295157776033e-06i, -2.1874940830592355e-05 + 6.670456014621564e-06i, 7.977632460660563e-06 + 1.28583457855275e-05i, 0.12396920695222144 + -6.310395457044538e-19i, -1.2524506139185977e-06 + 4.1488339063343017e-07i, -3.2062891888263034e-06 + 4.524624762632335e-06i, -6.979525201365566e-07 + -8.026850535061368e-06i, -0.00567951650877019 + -0.0036485348722147632i }, { -0.00028899385274337806 + -0.0027300859024606996i, 3.678443099357798e-08 + 9.108765658575561e-06i, 3.7462420592899415e-06 + -7.606676769457678e-06i, -1.2524506139185975e-06 + -4.148833906334291e-07i, 0.13045118352479945 + 4.607859233063394e-19i, 1.1214083465870947e-05 + -4.92545276794762e-06i, -3.230476900613173e-05 + -3.048100103679339e-05i, 1.5870701447938877e-06 + -7.310543143991826e-07i }, { -7.685131996983085e-06 + -9.97296214387001e-07i, -0.005718291003360766 + 0.003524424448417087i, 1.0059754741241148e-06 + -2.8809771507733245e-06i, -3.2062891888263046e-06 + -4.524624762632342e-06i, 1.1214083465870943e-05 + 4.925452767947616e-06i, 0.12872494187527875 + -4.0657581468206416e-19i, -6.824460492952065e-07 + -1.5744912673300552e-06i, -3.3725932501801484e-05 + -1.811417985324779e-05i }, { -8.948660299327344e-06 + -1.0490530593691987e-06i, -1.8738277130148428e-06 + 9.368985605169174e-07i, 4.458970907346557e-05 + -0.002952290134887547i, -6.979525201365621e-07 + 8.026850535061368e-06i, -3.230476900613173e-05 + 3.048100103679339e-05i, -6.824460492952057e-07 + 1.5744912673300545e-06i, 0.12329916961235401 + 9.385125055577648e-19i, 6.218762163314154e-06 + -3.613615686645036e-06i }, { -1.5365246301518364e-07 + -1.0219585373138445e-06i, 7.926886026346164e-06 + -6.367645126955675e-06i, -6.18579584542616e-06 + 8.522817303111066e-07i, -0.005679516508770188 + 0.0036485348722147632i, 1.5870701447938875e-06 + 7.310543143991814e-07i, -3.372593250180149e-05 + 1.8114179853247804e-05i, 6.218762163314155e-06 + 3.613615686645042e-06i, 0.12163565528334844 + 1.1722935989999517e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, true, false, false, false, true}), ElementsAreArray({ DoubleNear(0.12423719979891895, 1.0e-7), DoubleNear(0.13075091008178452, 1.0e-7), DoubleNear(0.11693173287129113, 1.0e-7), DoubleNear(0.12396920695222144, 1.0e-7), DoubleNear(0.13045118352479945, 1.0e-7), DoubleNear(0.12872494187527875, 1.0e-7), DoubleNear(0.12329916961235401, 1.0e-7), DoubleNear(0.12163565528334844, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, true, true, false, false}), Matrix({ { 0.11804982230995596 + -5.421010862427522e-20i, 1.1454586059621432e-05 + -1.0823727060635158e-05i, 0.000762389108655874 + 0.0002031870901716261i, 0.00013853965572003016 + -0.00025038444329164664i, -0.0012638382660659468 + -0.007394312762944024i, -3.648000624100587e-06 + 1.315760855821091e-07i, 8.668193227750593e-05 + 0.0001451454004876751i, -5.804485292417956e-05 + -9.86099880408652e-07i }, { 1.1454586059621421e-05 + 1.0823727060635163e-05i, 0.12563604658740396 + -9.114074512456272e-19i, 0.00013741116130847 + 0.0002531520160596629i, 0.000873766183152217 + -0.00023080989425300786i, -2.0436778558731853e-06 + -3.4684530583452816e-06i, -0.0034338843719016856 + -0.00896608663223804i, -5.179774548779741e-06 + -5.9569857260143235e-05i, -9.911068432925217e-06 + 0.00018632764949655316i }, { 0.0007623891086558743 + -0.00020318709017162442i, 0.00013741116130847004 + -0.00025315201605966285i, 0.11929055256485604 + -3.9302328752599536e-19i, 1.3218989925292647e-05 + -1.1524713618325926e-05i, 2.2951532747099735e-05 + 0.00015740953658549133i, -5.726226663133523e-05 + -1.9170044765529873e-06i, -0.0012870177607595102 + -0.007487761877717204i, -4.37748220003099e-06 + -9.252489923708174e-08i }, { 0.00013853965572003016 + 0.0002503844432916467i, 0.0008737661831522169 + 0.00023080989425300962i, 1.3218989925292642e-05 + 1.152471361832593e-05i, 0.12392107465523591 + 1.0037340424963459e-18i, -4.257683393036615e-06 + -5.880996025621188e-05i, 6.240845700653411e-05 + 0.00016219053516790705i, -2.3032619508552456e-06 + -2.7892066199245914e-06i, -0.0033684518907935697 + -0.008805800253336618i }, { -0.0012638382660659481 + 0.007394312762944022i, -2.0436778558731866e-06 + 3.4684530583452783e-06i, 2.2951532747099647e-05 + -0.00015740953658549133i, -4.257683393036642e-06 + 5.880996025621188e-05i, 0.12812411260000756 + 4.506215279392878e-19i, 6.898020616275349e-06 + -6.058106142207489e-06i, 0.000643620709970736 + 0.0002335769715410693i, 0.00010060515886625285 + -0.0001938228681051836i }, { -3.6480006241005866e-06 + -1.315760855821125e-07i, -0.003433884371901683 + 0.008966086632238045i, -5.726226663133523e-05 + 1.9170044765529805e-06i, 6.240845700653399e-05 + -0.0001621905351679071i, 6.898020616275343e-06 + 6.058106142207491e-06i, 0.12862822289651865 + 6.369687763352339e-19i, 9.828800957196969e-05 + 0.00019451072762081972i, 0.0006841301796251017 + -0.00025516613051091824i }, { 8.668193227750588e-05 + -0.00014514540048767512i, -5.1797745487797e-06 + 5.956985726014321e-05i, -0.0012870177607595128 + 0.0074877618777172035i, -2.303261950855246e-06 + 2.7892066199245914e-06i, 0.0006436207099707361 + -0.00023357697154106753i, 9.828800957196971e-05 + -0.00019451072762081967i, 0.12945479833254403 + -8.131516293641283e-20i, 7.932117436424146e-06 + -7.876334081310695e-06i }, { -5.8044852924179555e-05 + 9.860998804086588e-07i, -9.911068432925309e-06 + -0.00018632764949655319i, -4.377482200030989e-06 + 9.252489923707665e-08i, -0.003368451890793568 + 0.008805800253336618i, 0.00010060515886625285 + 0.0001938228681051836i, 0.0006841301796251016 + 0.00025516613051091997i, 7.932117436424142e-06 + 7.876334081310696e-06i, 0.12689537005347457 + -8.809142651444724e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, true, true, false, false}), ElementsAreArray({ DoubleNear(0.11804982230995596, 1.0e-7), DoubleNear(0.12563604658740396, 1.0e-7), DoubleNear(0.11929055256485604, 1.0e-7), DoubleNear(0.12392107465523591, 1.0e-7), DoubleNear(0.12812411260000756, 1.0e-7), DoubleNear(0.12862822289651865, 1.0e-7), DoubleNear(0.12945479833254403, 1.0e-7), DoubleNear(0.12689537005347457, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, true, false, true, false}), Matrix({ { 0.12302087674358428 + -8.470329472543003e-19i, 8.501036972807769e-06 + -1.126262885157705e-05i, 0.0006726101098321212 + 0.00021889997488221154i, 0.0001202607620384909 + -0.0002365272281066429i, -1.6838226328842983e-05 + 2.5957607138081007e-07i, -0.00011560771254885948 + 6.353243188381826e-05i, -5.381491867728769e-06 + -5.059627097486359e-07i, -0.0011131660678564649 + 0.0007923365444093693i }, { 8.501036972807762e-06 + 1.126262885157705e-05i, 0.12721386359037792 + -1.2536087619363645e-19i, 0.00011876048079761268 + 0.00023806576477777028i, 0.0008121116341398365 + -0.00024236599578593345i, -0.00011789185023253275 + -6.666766677084766e-05i, 1.9827673474680096e-05 + -4.940213681614585e-06i, -0.0011967698677433896 + -0.0008567411839237306i, -3.4509515745707405e-06 + -2.2243422822843954e-08i }, { 0.0006726101098321216 + -0.00021889997488220978i, 0.00011876048079761271 + -0.00023806576477777025i, 0.12430302637762261 + -3.6591823321385775e-19i, 1.0206576827309818e-05 + -1.2456454482004789e-05i, -5.126099138774585e-06 + 2.636051038649321e-07i, -0.0011856932455715664 + 0.0008334027484688188i, -1.5466563036420022e-05 + -5.756309528150139e-07i, -0.00011359962110818762 + 6.185480366912812e-05i }, { 0.0001202607620384909 + 0.0002365272281066429i, 0.0008121116341398365 + 0.00024236599578593513i, 1.0206576827309813e-05 + 1.2456454482004792e-05i, 0.12548941279885192 + -1.012204371968889e-18i, -0.0011235285244589402 + -0.0008153012215148422i, -1.8329979590892349e-06 + -2.1719334757585124e-06i, -0.00011585303835268437 + -6.523971235779132e-05i, 1.5939839289138863e-05 + -5.475322183058689e-06i }, { -1.6838226328842993e-05 + -2.595760713808067e-07i, -0.00011789185023253275 + 6.666766677084765e-05i, -5.126099138774587e-06 + -2.6360510386493254e-07i, -0.00112352852445894 + 0.0008153012215148424i, 0.12315305816637924 + 1.2434443665693129e-18i, 9.85156970308901e-06 + -5.619204351265599e-06i, 0.0007333997087944888 + 0.00021786408683048384i, 0.00011888405254779211 + -0.00020768008329018737i }, { -0.0001156077125488595 + -6.35324318838183e-05i, 1.9827673474680096e-05 + 4.940213681614593e-06i, -0.0011856932455715662 + -0.0008334027484688187i, -1.832997959089235e-06 + 2.17193347575851e-06i, 9.851569703089004e-06 + 5.619204351265604e-06i, 0.12705040589354472 + -1.4907779871675686e-19i, 0.00011693869008282702 + 0.0002095969789027123i, 0.0007457847286374824 + -0.00024361002897799267i }, { -5.381491867728771e-06 + 5.059627097486378e-07i, -0.0011967698677433894 + 0.0008567411839237306i, -1.5466563036420015e-05 + 5.756309528149978e-07i, -0.00011585303835268441 + 6.52397123577913e-05i, 0.0007333997087944886 + -0.00021786408683048216i, 0.00011693869008282703 + -0.0002095969789027123i, 0.12444232451977744 + -1.0842021724855044e-19i, 1.0944530534406973e-05 + -6.94459321763183e-06i }, { -0.0011131660678564649 + -0.0007923365444093692i, -3.450951574570743e-06 + 2.2243422822843107e-08i, -0.0001135996211081876 + -6.185480366912813e-05i, 1.5939839289138877e-05 + 5.475322183058679e-06i, 0.00011888405254779214 + 0.0002076800832901874i, 0.0007457847286374819 + 0.00024361002897799446i, 1.0944530534406971e-05 + 6.944593217631836e-06i, 0.12532703190985856 + 1.9278469879507876e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, true, false, true, false}), ElementsAreArray({ DoubleNear(0.12302087674358428, 1.0e-7), DoubleNear(0.12721386359037792, 1.0e-7), DoubleNear(0.12430302637762261, 1.0e-7), DoubleNear(0.12548941279885192, 1.0e-7), DoubleNear(0.12315305816637924, 1.0e-7), DoubleNear(0.12705040589354472, 1.0e-7), DoubleNear(0.12444232451977744, 1.0e-7), DoubleNear(0.12532703190985856, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, true, false, false, true}), Matrix({ { 0.11995151776784671 + -8.673617379884035e-19i, 1.0188933804459503e-05 + -1.3201652423589025e-05i, 0.000713767775559298 + 0.00021113159610833948i, 0.0001593340994749608 + -0.0002812678739153839i, -0.00011084656529202971 + 0.0028375072363268595i, -6.7748620744247536e-06 + 1.9414447873716786e-08i, 4.83908287343635e-05 + 1.2142825739883344e-05i, -0.00013295335358265006 + -4.4427176070509667e-07i }, { 1.0188933804459494e-05 + 1.3201652423589028e-05i, 0.12824064847265054 + -1.0740377771184528e-18i, 0.00015774286403346063 + 0.0002833276691607327i, 0.0008360595065143774 + -0.00024118310845257335i, 3.819801863051015e-07 + -8.870340828469132e-06i, -0.005763484725281133 + -0.003629985326364271i, 1.2964579257584763e-05 + -0.00014225863674917664i, 4.3084807268870054e-05 + -3.0202001580245822e-05i }, { 0.0007137677755592981 + -0.0002111315961083378i, 0.00015774286403346066 + -0.0002833276691607327i, 0.12121741490236337 + -6.098637220230962e-19i, 1.1881934603968968e-05 + -1.4542160024297586e-05i, 5.6109178227345115e-05 + 2.1256309099859736e-05i, -0.00013275655704121506 + -5.113524725337267e-07i, -0.00013355757837788798 + 0.0028448688010213868i, -7.09606576798449e-06 + 1.2560003620216796e-07i }, { 0.0001593340994749608 + 0.00028126787391538394i, 0.0008360595065143772 + 0.0002411831084525751i, 1.188193460396896e-05 + 1.4542160024297594e-05i, 0.1264794685613554 + 9.495239338720707e-19i, 1.2752801361436318e-05 + -0.0001414996134847404i, 5.2944081876911365e-05 + -7.242449511775885e-05i, -1.0431482754480746e-06 + -8.265275365167794e-06i, -0.00563432278684982 + -0.003542973994267578i }, { -0.00011084656529202668 + -0.0028375072363268587i, 3.8198018630509303e-07 + 8.870340828469136e-06i, 5.610917822734517e-05 + -2.1256309099859702e-05i, 1.2752801361436318e-05 + 0.00014149961348474037i, 0.1262224171421168 + 1.2637731573034161e-18i, 8.163672871437277e-06 + -3.680180779253623e-06i, 0.0006922420430673121 + 0.0002256324656043559i, 7.98107151113222e-05 + -0.00016293943748144638i }, { -6.774862074424755e-06 + -1.941444787371848e-08i, -0.005763484725281134 + 0.003629985326364272i, -0.000132756557041215 + 5.113524725337403e-07i, 5.294408187691131e-05 + 7.242449511775879e-05i, 8.163672871437272e-06 + 3.6801807792536243e-06i, 0.12602362101127207 + 7.995991022080595e-19i, 7.795630684697908e-05 + 0.0001643350745197499i, 0.0007218368562629415 + -0.0002447929163113528i }, { 4.839082873436357e-05 + -1.2142825739883334e-05i, 1.2964579257584763e-05 + 0.00014225863674917664i, -0.0001335575783778858 + -0.0028448688010213876i, -1.0431482754480772e-06 + 8.265275365167791e-06i, 0.0006922420430673121 + -0.00022563246560435411i, 7.795630684697908e-05 + -0.00016433507451974987i, 0.12752793599503667 + 1.3552527156068805e-19i, 9.269172757747822e-06 + -4.858887675339033e-06i }, { -0.00013295335358265006 + 4.4427176070509667e-07i, 4.3084807268870006e-05 + 3.020200158024574e-05i, -7.096065767984491e-06 + -1.2560003620217558e-07i, -0.00563432278684982 + 0.0035429739942675754i, 7.981071511132223e-05 + 0.00016293943748144638i, 0.0007218368562629412 + 0.00024479291631135445i, 9.269172757747824e-06 + 4.858887675339035e-06i, 0.12433697614735509 + -3.3881317890172014e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, true, false, false, true}), ElementsAreArray({ DoubleNear(0.11995151776784671, 1.0e-7), DoubleNear(0.12824064847265054, 1.0e-7), DoubleNear(0.12121741490236337, 1.0e-7), DoubleNear(0.1264794685613554, 1.0e-7), DoubleNear(0.1262224171421168, 1.0e-7), DoubleNear(0.12602362101127207, 1.0e-7), DoubleNear(0.12752793599503667, 1.0e-7), DoubleNear(0.12433697614735509, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, false, true, true, false}), Matrix({ { 0.11995933150495505 + -8.673617379884035e-19i, 1.2256943358114695e-05 + -1.535993047524684e-05i, -0.00455409120730453 + -0.007154232399614336i, -2.6592735896370763e-06 + -1.1082908229165273e-06i, 1.6759824398345637e-05 + 1.0726852770646133e-05i, -7.326814902544843e-05 + 9.881508444835862e-05i, 3.7771536038703796e-05 + -1.986669921964719e-05i, -2.3289970343566172e-05 + -9.203959463711767e-05i }, { 1.2256943358114685e-05 + 1.5359930475246843e-05i, 0.12335082167982628 + -3.9217625457874106e-19i, -2.3661287657385426e-06 + 7.594880071078105e-07i, 0.002718329068031954 + -0.008445304135378324i, -6.616810635849433e-05 + -7.21830306169926e-05i, 5.028187431648563e-05 + 2.7406428328432687e-06i, -2.1876511671782643e-05 + -4.972559219167347e-05i, -1.914413278350987e-05 + -1.7803733923036452e-05i }, { -0.004554091207304533 + 0.0071542323996143355i, -2.366128765738541e-06 + -7.594880071078117e-07i, 0.12736457161625184 + -3.4558944247975454e-19i, 6.450670442002893e-06 + -8.359152858335001e-06i, 8.362628621679423e-06 + -5.385965307854358e-06i, -4.381448395429276e-05 + -5.0898602131076044e-05i, -4.906461376360864e-05 + -1.1042907652080337e-05i, -0.00015593918463159868 + 2.6572151104587765e-05i }, { -2.6592735896370746e-06 + 1.1082908229165263e-06i, 0.002718329068031956 + 0.008445304135378327i, 6.450670442002889e-06 + 8.359152858335001e-06i, 0.1293524547094036 + -7.453889935837843e-19i, -1.2656171599085882e-05 + -4.007328854424073e-05i, -1.914200838011542e-05 + 2.2300362270097062e-05i, -0.0001675767822267228 + -5.972434851164639e-05i, -1.4514361552666668e-05 + -1.3156178697516537e-05i }, { 1.675982439834563e-05 + -1.0726852770646145e-05i, -6.616810635849435e-05 + 7.218303061699258e-05i, 8.36262862167942e-06 + 5.385965307854358e-06i, -1.2656171599085875e-05 + 4.0073288544240734e-05i, 0.11738104336985695 + 4.2012834183813297e-19i, 1.2416632626799383e-05 + -6.988510203714244e-06i, 0.0020032351804790726 + -0.007727842241046893i, -5.3662092344945e-06 + 1.1473420092615547e-06i }, { -7.32681490254484e-05 + -9.881508444835863e-05i, 5.028187431648563e-05 + -2.740642832843255e-06i, -4.381448395429277e-05 + 5.0898602131076044e-05i, -1.914200838011541e-05 + -2.2300362270097065e-05i, 1.2416632626799378e-05 + 6.988510203714253e-06i, 0.1262062995628136 + 4.845028458294598e-19i, -1.9808110409898893e-06 + -7.017147685377683e-06i, -0.00952066533072721 + -0.009326582750196332i }, { 3.77715360387038e-05 + 1.9866699219647185e-05i, -2.1876511671782647e-05 + 4.972559219167347e-05i, -4.906461376360864e-05 + 1.1042907652080333e-05i, -0.0001675767822267228 + 5.972434851164636e-05i, 0.0020032351804790713 + 0.00772784224104689i, -1.980811040989892e-06 + 7.017147685377681e-06i, 0.13021433931629972 + 7.148958074826295e-19i, 8.379467610696602e-06 + -5.575287365183183e-06i }, { -2.32899703435662e-05 + 9.203959463711765e-05i, -1.9144132783509863e-05 + 1.7803733923036445e-05i, -0.00015593918463159868 + -2.6572151104587792e-05i, -1.4514361552666655e-05 + 1.315617869751653e-05i, -5.366209234494501e-06 + -1.1473420092615615e-06i, -0.009520665330727207 + 0.009326582750196334i, 8.379467610696599e-06 + 5.5752873651831866e-06i, 0.12617113824058965 + 1.294266343404571e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, false, true, true, false}), ElementsAreArray({ DoubleNear(0.11995933150495505, 1.0e-7), DoubleNear(0.12335082167982628, 1.0e-7), DoubleNear(0.12736457161625184, 1.0e-7), DoubleNear(0.1293524547094036, 1.0e-7), DoubleNear(0.11738104336985695, 1.0e-7), DoubleNear(0.1262062995628136, 1.0e-7), DoubleNear(0.13021433931629972, 1.0e-7), DoubleNear(0.12617113824058965, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, false, true, false, true}), Matrix({ { 0.11996755132578636 + -1.0570971181733668e-18i, 1.3847942595164141e-05 + -1.697608955264509e-05i, -0.0026911073766889074 + -0.01210542780546154i, 1.0379754555245547e-06 + 6.700351714032226e-06i, -0.003678662771122282 + 0.008033177244674974i, -3.7544437099664325e-06 + -3.685451189679496e-06i, -0.0006192950369329519 + -0.013410701710144276i, 1.9250810698930994e-05 + 1.3747842177218482e-05i }, { 1.3847942595164131e-05 + 1.6976089552645093e-05i, 0.1300663444243568 + 5.166900978251232e-20i, -9.666784517157453e-06 + 1.690743393077362e-06i, -0.007502233507061426 + -0.004676901318483847i, 1.6738924499963015e-06 + -5.711954896529126e-06i, -0.005136533207545295 + 0.0009386164674347803i, -1.0578648018624339e-05 + 1.4819501363196332e-05i, 0.003421420294839775 + 0.00775999838166233i }, { -0.002691107376688909 + 0.012105427805461538i, -9.66678451715745e-06 + -1.6907433930773692e-06i, 0.12120138134442374 + -4.2012834183813297e-19i, 8.22292581326433e-06 + -1.0767722895241525e-05i, 0.0017205023768870923 + -0.00036955691345823814i, -1.774277837497798e-05 + -6.037146452972174e-06i, 0.0034342586274523643 + -0.0023508012073267274i, -1.0116484132442812e-05 + 3.83046567375538e-06i }, { 1.0379754555245604e-06 + -6.700351714032227e-06i, -0.0075022335070614255 + 0.004676901318483849i, 8.222925813264323e-06 + 1.0767722895241531e-05i, 0.12465377260964913 + -1.7618285302889447e-19i, 1.1558200918087177e-05 + -1.6990852340329187e-05i, -0.004141154901602877 + -0.02027850851390329i, -2.3350605391392742e-06 + -1.1423661297107801e-05i, -0.006261274304585659 + -0.00811157578806663i }, { -0.0036786627711222785 + -0.008033177244674974i, 1.6738924499962965e-06 + 5.711954896529127e-06i, 0.0017205023768870915 + 0.00036955691345823846i, 1.155820091808716e-05 + 1.6990852340329194e-05i, 0.11737282354902565 + 6.098637220230962e-19i, 1.0825633389749936e-05 + -5.372351126315996e-06i, 0.00014025134986345015 + -0.0027766468351996896i, -9.063458279656131e-06 + -6.661300527687199e-06i }, { -3.754443709966436e-06 + 3.685451189679491e-06i, -0.0051365332075452965 + -0.0009386164674347805i, -1.7742778374977988e-05 + 6.0371464529721614e-06i, -0.004141154901602875 + 0.02027850851390329i, 1.0825633389749933e-05 + 5.372351126316002e-06i, 0.11949077681828307 + 4.0657581468206416e-20i, 5.3198447104290206e-06 + -7.948403071347235e-06i, 0.0006998972443661702 + -0.01309498556709081i }, { -0.0006192950369329534 + 0.013410701710144274i, -1.0578648018624327e-05 + -1.4819501363196337e-05i, 0.003434258627452367 + 0.0023508012073267266i, -2.3350605391392806e-06 + 1.14236612971078e-05i, 0.00014025134986344842 + 0.002776646835199688i, 5.319844710429016e-06 + 7.948403071347238e-06i, 0.13637752958812782 + 7.894347068410079e-19i, 6.607212239435166e-06 + -3.1667173282766586e-06i }, { 1.9250810698931004e-05 + -1.3747842177218472e-05i, 0.003421420294839774 + -0.007759998381662329i, -1.011648413244281e-05 + -3.830465673755386e-06i, -0.006261274304585658 + 0.008111575788066629i, -9.063458279656136e-06 + 6.661300527687192e-06i, 0.0006998972443661737 + 0.013094985567090812i, 6.607212239435166e-06 + 3.1667173282766565e-06i, 0.13086982034034408 + 7.250602028496811e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, false, true, false, true}), ElementsAreArray({ DoubleNear(0.11996755132578636, 1.0e-7), DoubleNear(0.1300663444243568, 1.0e-7), DoubleNear(0.12120138134442374, 1.0e-7), DoubleNear(0.12465377260964913, 1.0e-7), DoubleNear(0.11737282354902565, 1.0e-7), DoubleNear(0.11949077681828307, 1.0e-7), DoubleNear(0.13637752958812782, 1.0e-7), DoubleNear(0.13086982034034408, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({true, false, false, false, false, false, true, true}), Matrix({ { 0.12944243749724654 + -1.0570971181733668e-18i, 2.012132781571303e-05 + -2.6508723094609035e-05i, -1.2127561719273252e-05 + -1.1698484848924553e-05i, -0.00015956821705355505 + 0.00013239132088596845i, -0.0042443508310013554 + 0.011500061197474432i, -2.8379809658955832e-06 + 7.898976580367322e-06i, -0.00013118984577110493 + -8.02880694385937e-05i, -8.52152046872299e-05 + -0.00022560873682939345i }, { 2.0121327815713013e-05 + 2.6508723094609046e-05i, 0.12452085108787747 + -1.6178329292557136e-19i, 3.855308795928969e-05 + -5.021494343234642e-05i, 5.485921814391213e-05 + 2.3230144773381735e-05i, -6.47410998864646e-06 + -5.076773388944818e-07i, -0.0004894511738217444 + -0.009981408662179897i, -0.00019410320012152942 + -3.976698544718221e-05i, -3.320394646760395e-05 + -4.5721018346860335e-06i }, { -1.2127561719273259e-05 + 1.1698484848924549e-05i, 3.855308795928968e-05 + 5.0214943432346416e-05i, 0.11172649517296357 + -4.2012834183813297e-19i, 1.9495405927154417e-06 + -1.235089353277577e-06i, -2.8778320102765764e-05 + 3.974191577957645e-05i, 3.428427885999682e-05 + 5.350517112436026e-06i, 0.003999946687331437 + -0.005817685160126186i, -1.1032946876513661e-05 + -7.753962096291437e-06i }, { -0.00015956821705355505 + -0.0001323913208859685i, 5.485921814391216e-05 + -2.3230144773381705e-05i, 1.94954059271544e-06 + 1.2350893532775787e-06i, 0.13019926594612846 + 3.7269449679189215e-20i, -1.834343378469379e-05 + -6.233588936072137e-05i, -4.4675115829323226e-05 + -6.269477034093304e-05i, 5.812941899503488e-06 + -1.6627938854742446e-05i, -0.010908356338309208 + 0.002808449341548047i }, { -0.004244350831001353 + -0.011500061197474432i, -6.474109988646462e-06 + 5.076773388944778e-07i, -2.877832010276577e-05 + -3.9741915779576464e-05i, -1.8343433784693794e-05 + 6.233588936072137e-05i, 0.11788146562396035 + -1.5585406229479126e-19i, -1.4137140155954413e-06 + 2.7896397610271953e-06i, -2.0177227645989753e-05 + 1.1382429967490347e-05i, -6.963911660349203e-05 + -7.004085333022074e-06i }, { -2.837980965895578e-06 + -7.898976580367324e-06i, -0.0004894511738217453 + 0.009981408662179895i, 3.4284278859996806e-05 + -5.350517112436026e-06i, -4.467511582932327e-05 + 6.269477034093306e-05i, -1.4137140155954394e-06 + -2.789639761027202e-06i, 0.12818242530135238 + -9.75781955236954e-19i, -0.00027229797654450684 + -8.169243569629256e-05i, -1.9091705380093173e-05 + -3.3645680638055005e-05i }, { -0.00013118984577110493 + 8.02880694385937e-05i, -0.00019410320012152942 + 3.97669854471822e-05i, 0.003999946687331441 + 0.005817685160126185i, 5.8129418995034776e-06 + 1.662793885474245e-05i, -2.0177227645989753e-05 + -1.138242996749036e-05i, -0.00027229797654450684 + 8.169243569629252e-05i, 0.13586888751319312 + 1.5551524911588954e-18i, 1.8846559644780542e-05 + -1.132870821561985e-05i }, { -8.521520468722994e-05 + 0.00022560873682939348i, -3.3203946467603944e-05 + 4.572101834686042e-06i, -1.1032946876513668e-05 + 7.753962096291429e-06i, -0.010908356338309208 + -0.0028084493415480465i, -6.963911660349203e-05 + 7.004085333022067e-06i, -1.9091705380093186e-05 + 3.364568063805498e-05i, 1.884655964478054e-05 + 1.132870821561986e-05i, 0.12217817185727478 + 1.7414997395548415e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({true, false, false, false, false, false, true, true}), ElementsAreArray({ DoubleNear(0.12944243749724654, 1.0e-7), DoubleNear(0.12452085108787747, 1.0e-7), DoubleNear(0.11172649517296357, 1.0e-7), DoubleNear(0.13019926594612846, 1.0e-7), DoubleNear(0.11788146562396035, 1.0e-7), DoubleNear(0.12818242530135238, 1.0e-7), DoubleNear(0.13586888751319312, 1.0e-7), DoubleNear(0.12217817185727478, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, true, true, false, false, false, false}), Matrix({ { 0.12852428734947216 + 4.743384504624082e-20i, 0.0003094619905202505 + -0.00011459685226063485i, 0.0005132041271926833 + 2.5698966332956237e-05i, 0.0011760590649045597 + -0.0005286379176236534i, -3.4544159829962016e-05 + -1.6082781940534383e-06i, -0.010413881838509097 + -0.0076956550660893346i, -0.00013107947140482588 + -2.6532119923655322e-05i, -4.3071671977490275e-05 + -3.23822440657674e-05i }, { 0.0003094619905202505 + 0.00011459685226063491i, 0.1284047864138731 + -1.4026865606531214e-18i, 0.0011846789351721285 + 0.0005226979370596294i, 0.000613155780150824 + 5.582179362865125e-06i, -0.010400190100507436 + -0.007697484928700506i, -1.716251753340915e-05 + -2.9128381465524983e-05i, -4.583678780334304e-05 + -3.804556492512639e-05i, -7.237851051842509e-05 + -0.00011403552464798231i }, { 0.0005132041271926833 + -2.569896633295617e-05i, 0.0011846789351721285 + -0.0005226979370596297i, 0.12867857153801554 + 4.2182240773264157e-19i, 0.00036933220239420474 + -7.762334790225488e-05i, -0.00013061203983053265 + -2.449394582281619e-05i, -4.50170989930446e-05 + -2.996771318432858e-05i, -3.254886649872015e-05 + -2.1150665878998946e-05i, -0.01042695962951912 + -0.007704235298005568i }, { 0.0011760590649045602 + 0.0005286379176236536i, 0.0006131557801508241 + -5.582179362865301e-06i, 0.0003693322023942048 + 7.762334790225499e-05i, 0.12855658997942085 + 9.181837148236616e-19i, -4.76481713132539e-05 + -3.7069286246204434e-05i, -7.364360130946614e-05 + -0.00011260234278256231i, -0.010416955609220652 + -0.007708961196096544i, -2.8251436631902896e-05 + -2.874302313852429e-05i }, { -3.454415982996202e-05 + 1.6082781940534417e-06i, -0.010400190100507436 + 0.007697484928700506i, -0.0001306120398305327 + 2.44939458228162e-05i, -4.764817131325388e-05 + 3.7069286246204406e-05i, 0.12133969420184598 + -5.014435047745458e-19i, 0.00029782171106197615 + 0.0001041710260112883i, 0.0005764117427902915 + 6.743235708296739e-06i, 0.0011346879352892988 + 0.0004797105023873997i }, { -0.010413881838509097 + 0.007695655066089336i, -1.7162517533409163e-05 + 2.9128381465524997e-05i, -4.5017098993044596e-05 + 2.9967713184328582e-05i, -7.364360130946614e-05 + 0.00011260234278256233i, 0.00029782171106197615 + -0.0001041710260112883i, 0.12142165738147431 + 9.215718466126788e-19i, 0.0011247225068017983 + -0.0004870851705640183i, 0.0004875068970629237 + 2.5446294786976652e-05i }, { -0.00013107947140482596 + 2.6532119923655312e-05i, -4.583678780334304e-05 + 3.8045564925126365e-05i, -3.254886649872016e-05 + 2.1150665878998956e-05i, -0.010416955609220652 + 0.007708961196096543i, 0.0005764117427902915 + -6.743235708296861e-06i, 0.001124722506801799 + 0.0004870851705640187i, 0.12149311749693255 + 8.470329472543003e-20i, 0.0003503245069854334 + 7.630418527333021e-05i }, { -4.3071671977490275e-05 + 3.238224406576745e-05i, -7.237851051842509e-05 + 0.00011403552464798227i, -0.010426959629519124 + 0.007704235298005568i, -2.8251436631902893e-05 + 2.87430231385243e-05i, 0.0011346879352892984 + -0.0004797105023873994i, 0.0004875068970629237 + -2.5446294786976625e-05i, 0.0003503245069854334 + -7.630418527333024e-05i, 0.12158129563896217 + 7.369186641112413e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, true, true, false, false, false, false}), ElementsAreArray({ DoubleNear(0.12852428734947216, 1.0e-7), DoubleNear(0.1284047864138731, 1.0e-7), DoubleNear(0.12867857153801554, 1.0e-7), DoubleNear(0.12855658997942085, 1.0e-7), DoubleNear(0.12133969420184598, 1.0e-7), DoubleNear(0.12142165738147431, 1.0e-7), DoubleNear(0.12149311749693255, 1.0e-7), DoubleNear(0.12158129563896217, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, true, false, true, false, false, false}), Matrix({ { 0.1250347150577247 + -1.666960840196463e-18i, 0.000311206935203249 + -5.003155019818596e-06i, 0.00055234788848676 + 1.4629455164420462e-05i, 0.001157089284038605 + -2.4527273038880883e-05i, 0.0007453212705456208 + -1.0735149216986347e-05i, 6.898779963845979e-06 + -6.758786862466263e-07i, 3.799673807732623e-05 + -1.6190878794204935e-06i, -3.4610729216061635e-05 + 1.4544331127716956e-06i }, { 0.00031120693520324895 + 5.003155019818609e-06i, 0.12501619552875415 + -1.8295911660692887e-19i, 0.0011563055430880978 + 1.7969627624843132e-05i, 0.0005579619979323186 + 1.3961083277025654e-05i, 4.426928899002905e-06 + -3.5564566588426774e-06i, 0.0007352050197923862 + -9.615412627861596e-06i, -3.432296837190326e-05 + -1.9101721369589265e-06i, 3.952222950991431e-05 + -1.590238152891713e-06i }, { 0.0005523478884867601 + -1.4629455164420475e-05i, 0.0011563055430880982 + -1.7969627624843187e-05i, 0.12520209425766982 + 7.674118502123961e-19i, 0.00036971705160295605 + -1.0642054000794542e-06i, 3.920451947850772e-05 + -4.198436313935576e-06i, -3.369955321010411e-05 + 1.0056140377975856e-06i, 0.0007468357007881779 + -1.4228325309133486e-05i, 7.95025136939191e-06 + -9.001820856681375e-07i }, { 0.0011570892840386047 + 2.4527273038881195e-05i, 0.0005579619979323189 + -1.3961083277025565e-05i, 0.00036971705160295605 + 1.0642054000794678e-06i, 0.12518519954973753 + 1.204480850995615e-18i, -3.394487928271851e-05 + -2.810594748517465e-06i, 4.130716524252061e-05 + -4.163043686056861e-06i, 1.0294312840487673e-05 + -2.5851562745605046e-07i, 0.0007365441902777443 + -1.4633075897249298e-05i }, { 0.0007453212705456206 + 1.0735149216988119e-05i, 4.426928899002901e-06 + 3.5564566588426786e-06i, 3.920451947850772e-05 + 4.198436313935576e-06i, -3.39448792827185e-05 + 2.8105947485174667e-06i, 0.12482926649359347 + 1.212951180468158e-18i, 0.0002960767663789777 + -5.422671229527974e-06i, 0.0005372679814962148 + 1.7812746876832466e-05i, 0.0011536577161552538 + -2.440014219737285e-05i }, { 6.898779963845968e-06 + 6.758786862466303e-07i, 0.0007352050197923861 + 9.61541262786331e-06i, -3.3699553210104113e-05 + -1.0056140377975823e-06i, 4.130716524252058e-05 + 4.1630436860568716e-06i, 0.00029607676637897763 + 5.422671229527994e-06i, 0.1248102482665933 + -2.981555974335137e-19i, 0.0011530958988858286 + 1.7643138870767933e-05i, 0.0005427006792814291 + 1.706739087281608e-05i }, { 3.7996738077326226e-05 + 1.6190878794204884e-06i, -3.432296837190326e-05 + 1.9101721369589367e-06i, 0.0007468357007881779 + 1.4228325309135254e-05i, 1.0294312840487678e-05 + 2.585156274560604e-07i, 0.0005372679814962148 + -1.781274687683247e-05i, 0.001153095898885829 + -1.764313887076773e-05i, 0.1249695947772783 + -2.608861477543245e-19i, 0.0003499396577766821 + -2.5495722884520797e-07i }, { -3.4610729216061635e-05 + -1.4544331127716913e-06i, 3.952222950991432e-05 + 1.5902381528917088e-06i, 7.950251369391917e-06 + 9.001820856681433e-07i, 0.0007365441902777442 + 1.4633075897251009e-05i, 0.0011536577161552538 + 2.440014219737296e-05i, 0.0005427006792814291 + -1.7067390872816282e-05i, 0.00034993965777668215 + 2.5495722884524524e-07i, 0.12495268606864547 + -2.1260526976082939e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, true, false, true, false, false, false}), ElementsAreArray({ DoubleNear(0.1250347150577247, 1.0e-7), DoubleNear(0.12501619552875415, 1.0e-7), DoubleNear(0.12520209425766982, 1.0e-7), DoubleNear(0.12518519954973753, 1.0e-7), DoubleNear(0.12482926649359347, 1.0e-7), DoubleNear(0.1248102482665933, 1.0e-7), DoubleNear(0.1249695947772783, 1.0e-7), DoubleNear(0.12495268606864547, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, true, false, false, true, false, false}), Matrix({ { 0.11157799557459513 + -1.0842021724855044e-19i, 0.0002679343889135263 + -6.010657973806416e-06i, -0.0005328756836939158 + 0.000133206182960716i, -0.0017050991905677318 + 0.0003295798949081904i, 0.006899094116256721 + -0.010409735505029773i, 1.1599624617260775e-05 + -3.1553460310839224e-05i, 0.00021075832400642468 + -0.0020914554778367193i, 0.0005486033565551123 + -0.005445735836821416i }, { 0.0002679343889135263 + 6.010657973806443e-06i, 0.11154662956159064 + -1.0842021724855044e-19i, -0.0016991925013432015 + 0.00035503274729843887i, -0.000541929214605824 + 7.584110357276741e-05i, 1.4058360115918263e-05 + -2.224637606926444e-05i, 0.006928687190544687 + -0.010396821490659888i, 0.0005368271009604955 + -0.005444019428574971i, 0.00021475219255797853 + -0.00204988282159838i }, { -0.0005328756836939158 + -0.00013320618296071605i, -0.0016991925013432013 + -0.00035503274729843887i, 0.13190959207503072 + 4.0488174878755556e-19i, 0.00038025708457341354 + 1.4719023887028442e-06i, -0.001392225608362009 + -0.0025462675280144894i, -0.0035344155097320196 + -0.006672411013591525i, -0.011527805172781829 + -0.005913952157527655i, -5.958581409315323e-05 + -5.172252840641464e-05i }, { -0.001705099190567732 + -0.0003295798949081903i, -0.000541929214605824 + -7.58411035727676e-05i, 0.0003802570845734136 + -1.4719023887028578e-06i, 0.13186327890623542 + -5.429481191900065e-19i, -0.00357096081713406 + -0.0066331704495343115i, -0.0013628623231502627 + -0.002574150725756863i, -6.262093510992872e-05 + -5.268627034137626e-05i, -0.011653168423540293 + -0.00593345237301857i }, { 0.006899094116256722 + 0.010409735505029775i, 1.405836011591826e-05 + 2.2246376069264427e-05i, -0.0013922256083620087 + 0.002546267528014489i, -0.00357096081713406 + 0.0066331704495343115i, 0.13828598597672304 + -3.4558944247975454e-19i, 0.00033934931266870036 + -4.415168275540154e-06i, 0.0016224915536768904 + -0.00010076398091946306i, 0.0040158461907615906 + -0.000378507310144444i }, { 1.1599624617260785e-05 + 3.155346031083925e-05i, 0.0069286871905446905 + 0.010396821490659888i, -0.0035344155097320204 + 0.006672411013591525i, -0.0013628623231502625 + 0.0025741507257568633i, 0.00033934931266870036 + 4.4151682755401604e-06i, 0.1382798142337568 + -3.7269449679189215e-19i, 0.004008593943317128 + -0.0003194199808028279i, 0.001642591891819572 + -4.4812629422925676e-05i }, { 0.0002107583240064248 + 0.0020914554778367197i, 0.0005368271009604954 + 0.005444019428574971i, -0.011527805172781829 + 0.005913952157527655i, -6.26209351099287e-05 + 5.268627034137627e-05i, 0.0016224915536768908 + 0.00010076398091946309i, 0.004008593943317129 + 0.00031941998080282783i, 0.11826209695991738 + 1.0164395367051604e-19i, 0.00033939962480622455 + -2.7910650176275065e-06i }, { 0.0005486033565551121 + 0.005445735836821416i, 0.00021475219255797843 + 0.0020498828215983794i, -5.958581409315319e-05 + 5.17225284064146e-05i, -0.011653168423540295 + 0.005933452373018569i, 0.00401584619076159 + 0.00037850731014444446i, 0.001642591891819572 + 4.481262942292573e-05i, 0.00033939962480622455 + 2.791065017627571e-06i, 0.1182746067121476 + 1.5348237004247922e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, true, false, false, true, false, false}), ElementsAreArray({ DoubleNear(0.11157799557459513, 1.0e-7), DoubleNear(0.11154662956159064, 1.0e-7), DoubleNear(0.13190959207503072, 1.0e-7), DoubleNear(0.13186327890623542, 1.0e-7), DoubleNear(0.13828598597672304, 1.0e-7), DoubleNear(0.1382798142337568, 1.0e-7), DoubleNear(0.11826209695991738, 1.0e-7), DoubleNear(0.1182746067121476, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, true, false, false, false, true, false}), Matrix({ { 0.1251384645669663 + -2.981555974335137e-19i, 4.8280524137112935e-05 + -1.7425882124223707e-05i, 0.0005396913012220323 + 4.060435014043693e-06i, 0.0011577399550364352 + -0.0001497017382613431i, -1.2197058918854711e-06 + -3.36216111747876e-05i, 0.00013406553069303547 + 8.131591360072199e-05i, 1.1427596004418017e-05 + -1.9055012409944084e-05i, -3.560374445029662e-05 + -1.9346614245716628e-05i }, { 4.828052413711292e-05 + 1.7425882124223714e-05i, 0.12458985307686651 + -1.1587410718438829e-18i, 0.001150719762539809 + -0.00010814076952885492i, 0.0005472720369742266 + 6.814880557253426e-05i, 0.00019937595714174033 + 7.393659134143776e-05i, 1.9744801741202276e-06 + -3.133053592297106e-05i, -3.663161184278807e-05 + -3.0342798165683966e-05i, 1.3420149963582395e-05 + -1.2478561640118864e-05i }, { 0.0005396913012220324 + -4.060435014043747e-06i, 0.0011507197625398099 + 0.00010814076952885525i, 0.12489292351439682 + -9.571472303973594e-19i, 0.0005427826733727195 + 1.626363578018161e-05i, -1.2161836514659144e-05 + -1.0035698495957832e-05i, -4.511479218756117e-05 + 4.355814710297782e-06i, -1.799897483891308e-06 + 2.4375871792879785e-05i, -5.6421302077753295e-05 + -8.177711688805138e-06i }, { 0.0011577399550364354 + 0.00014970173826134328i, 0.0005472720369742269 + -6.814880557253445e-05i, 0.0005427826733727195 + -1.6263635780181587e-05i, 0.12540593835220715 + 6.352747104407253e-20i, -4.576838718446679e-05 + 1.5578938993199228e-05i, -1.3166847730541203e-05 + -4.579075310606897e-06i, 2.12374822465249e-05 + -2.3857149872051142e-06i, 4.507846600212502e-06 + 2.9844684558771398e-05i }, { -1.2197058918854474e-06 + 3.362161117478759e-05i, 0.00019937595714174038 + -7.393659134143776e-05i, -1.216183651465909e-05 + 1.0035698495957886e-05i, -4.57683871844668e-05 + -1.5578938993199173e-05i, 0.12472551698435186 + -1.5585406229479126e-19i, 0.0005590031774451137 + 7.000055874877137e-06i, 0.0005499245687609423 + 2.8381767027209236e-05i, 0.001153007045157423 + 0.00010077432302508946i }, { 0.00013406553069303539 + -8.131591360072181e-05i, 1.974480174120226e-06 + 3.133053592297107e-05i, -4.511479218756115e-05 + -4.355814710297714e-06i, -1.3166847730541149e-05 + 4.579075310606897e-06i, 0.0005590031774451137 + -7.00005587487711e-06i, 0.12523659071848092 + 6.776263578034403e-19i, 0.0011586816794341174 + 0.000143753536024466i, 0.0005533906402395212 + -3.712033142269252e-05i }, { 1.1427596004418125e-05 + 1.905501240994411e-05i, -3.663161184278807e-05 + 3.0342798165684006e-05i, -1.799897483891308e-06 + -2.437587179287978e-05i, 2.123748224652498e-05 + 2.385714987205128e-06i, 0.0005499245687609426 + -2.8381767027209202e-05i, 0.0011586816794341176 + -0.0001437535360244662i, 0.12527876552055128 + 1.463672932855431e-18i, 0.0001768740360069188 + -1.7582798409106273e-05i }, { -3.560374445029652e-05 + 1.9346614245716615e-05i, 1.3420149963582503e-05 + 1.2478561640118756e-05i, -5.642130207775332e-05 + 8.1777116888053e-06i, 4.50784660021249e-06 + -2.9844684558771405e-05i, 0.001153007045157423 + -0.00010077432302508911i, 0.0005533906402395211 + 3.7120331422692604e-05i, 0.0001768740360069188 + 1.75827984091063e-05i, 0.12473194726617587 + 9.283481101907132e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, true, false, false, false, true, false}), ElementsAreArray({ DoubleNear(0.1251384645669663, 1.0e-7), DoubleNear(0.12458985307686651, 1.0e-7), DoubleNear(0.12489292351439682, 1.0e-7), DoubleNear(0.12540593835220715, 1.0e-7), DoubleNear(0.12472551698435186, 1.0e-7), DoubleNear(0.12523659071848092, 1.0e-7), DoubleNear(0.12527876552055128, 1.0e-7), DoubleNear(0.12473194726617587, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, true, false, false, false, false, true}), Matrix({ { 0.1256678745110455 + -4.0657581468206416e-19i, 0.0003006108398742884 + 2.182793393138355e-06i, 8.492935604220142e-05 + 4.046740096130089e-05i, -8.003605483045497e-05 + 0.00010618223552938581i, 0.010710829661781636 + 0.001143841347166762i, 2.7214885989397205e-05 + 8.36762898386637e-06i, -0.0006399561679898179 + 0.00024193026280218952i, -0.0014547243890876455 + 0.0007064218199504364i }, { 0.0003006108398742884 + -2.1827933931383448e-06i, 0.12569325404382053 + -1.0570971181733668e-18i, -6.639451790012939e-05 + 0.00014327790635519148i, 7.215748025880521e-05 + 4.227796323603159e-05i, 3.8669603681289316e-05 + 1.6431659088792863e-05i, 0.010726316685133703 + 0.0011320325334857886i, -0.0014913818520595752 + 0.0006961977175694657i, -0.0005660287626110082 + 0.0002273991686795909i }, { 8.492935604220157e-05 + -4.046740096130092e-05i, -6.639451790012914e-05 + -0.00014327790635519148i, 0.1223550417193042 + 7.504711912673101e-19i, 0.00033365670920808824 + 4.085776891553489e-06i, -0.0007328950728236606 + 7.69719384542329e-05i, -0.0021278883510375142 + 0.00019668464848383437i, -0.01652298950189323 + -0.0018594156800028488i, -6.470924361407143e-05 + -1.381487017203359e-05i }, { -8.003605483045514e-05 + -0.00010618223552938562i, 7.215748025880506e-05 + -4.227796323603182e-05i, 0.00033365670920808824 + -4.085776891553506e-06i, 0.1221728794300458 + -8.88537561669761e-19i, -0.0021539833243955503 + 0.000228220583335618i, -0.0007918863704511716 + 0.0001157161874484298i, -6.637251788908759e-05 + -1.1239518904953567e-05i, -0.016556368500822982 + -0.0019070414839333057i }, { 0.010710829661781638 + -0.0011438413471667609i, 3.8669603681289316e-05 + -1.6431659088792894e-05i, -0.0007328950728236607 + -7.697193845423327e-05i, -0.0021539833243955503 + -0.000228220583335618i, 0.12419610704027266 + -4.743384504624082e-20i, 0.00030667286170793826 + -1.2608619642484924e-05i, 0.0010046865139407733 + -8.02519892004796e-06i, 0.0023907830550243133 + -0.00015510965076563946i }, { 2.7214885989397205e-05 + -8.367628983866357e-06i, 0.010726316685133705 + -0.0011320325334857914i, -0.002127888351037514 + -0.0001966846484838349i, -0.000791886370451172 + -0.00011571618744842991i, 0.00030667286170793826 + 1.2608619642484948e-05i, 0.1241331897515269 + 5.759824041329242e-19i, 0.002375795959874056 + -0.00010766513985958041i, 0.0010285051969549427 + -1.1249489086189856e-05i }, { -0.0006399561679898181 + -0.00024193026280218963i, -0.0014913818520595752 + -0.0006961977175694659i, -0.01652298950189323 + 0.0018594156800028488i, -6.63725178890876e-05 + 1.1239518904953537e-05i, 0.0010046865139407735 + 8.025198920047974e-06i, 0.002375795959874057 + 0.00010766513985958052i, 0.1278166473156439 + -2.439454888092385e-19i, 0.00038600000017154995 + -5.404939520478151e-06i }, { -0.0014547243890876453 + -0.0007064218199504368i, -0.000566028762611008 + -0.00022739916867959127i, -6.470924361407141e-05 + 1.3814870172033578e-05i, -0.01655636850082298 + 0.0019070414839333061i, 0.0023907830550243137 + 0.0001551096507656398i, 0.001028505196954943 + 1.1249489086189978e-05i, 0.00038600000017154995 + 5.404939520478219e-06i, 0.12796500618833723 + 1.8804131429045468e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, true, false, false, false, false, true}), ElementsAreArray({ DoubleNear(0.1256678745110455, 1.0e-7), DoubleNear(0.12569325404382053, 1.0e-7), DoubleNear(0.1223550417193042, 1.0e-7), DoubleNear(0.1221728794300458, 1.0e-7), DoubleNear(0.12419610704027266, 1.0e-7), DoubleNear(0.1241331897515269, 1.0e-7), DoubleNear(0.1278166473156439, 1.0e-7), DoubleNear(0.12796500618833723, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, true, true, false, false, false}), Matrix({ { 0.12872712764384395 + 1.3721933745519665e-19i, 0.0003480197348502151 + -9.30089206883786e-05i, -3.3744299732686635e-05 + -1.1400836302100822e-05i, -0.010426127056439607 + -0.007705904333180822i, 0.0008530970101689212 + -1.1117762154939424e-05i, 8.194232718339225e-06 + -3.531558662616022e-05i, -1.0104263119946656e-06 + -5.381711506779107e-07i, -0.00017159466376757247 + -2.6809496512640054e-05i }, { 0.0003480197348502151 + 9.300892068837869e-05i, 0.1286068174126463 + 1.294266343404571e-18i, -0.010414427777123252 + -0.0077091858084387035i, -2.2912115670383225e-05 + -2.8952113805191213e-05i, 9.759729753151653e-06 + 3.2115008002247045e-05i, 0.0008069062607269123 + -1.06369611437591e-05i, -0.0001729133270741796 + -2.7334748381884326e-05i, 3.548683953839397e-06 + -2.248410517451618e-06i }, { -3.374429973268664e-05 + 1.1400836302100826e-05i, -0.010414427777123252 + 0.007709185808438703i, 0.12150968167155055 + -1.0367683274392636e-18i, 0.0003329042519559899 + 8.694156026848056e-05i, -1.5044517846335372e-06 + 3.791172799472308e-07i, -0.00016840632485074866 + 3.033329530318651e-05i, 0.0006390599611648775 + -1.384571237118041e-05i, 6.654798614898664e-06 + 3.373952585424546e-05i }, { -0.010426127056439607 + 0.007705904333180823i, -2.291211567038322e-05 + 2.8952113805191216e-05i, 0.0003329042519559899 + -8.694156026848061e-05i, 0.12159457766584537 + -2.727446090158847e-19i, -0.00016761362772974115 + 2.9033211693266938e-05i, 3.5949619980751406e-06 + 2.3625723109632588e-06i, 4.961511986338927e-06 + -3.5929980288545767e-05i, 0.0006648429493432181 + -1.3611527381351794e-05i }, { 0.0008530970101689212 + 1.1117762154941393e-05i, 9.759729753151639e-06 + -3.211500800224703e-05i, -1.5044517846335376e-06 + -3.7911727994722895e-07i, -0.000167613627729741 + -2.9033211693266986e-05i, 0.12847573124364375 + 3.3203691532368573e-19i, 0.0003307744580642401 + -9.921127947451114e-05i, -3.3348726595995535e-05 + -1.1358107770951568e-05i, -0.010414714411588614 + -0.007693986030914082i }, { 8.194232718339235e-06 + 3.531558662616022e-05i, 0.0008069062607269123 + 1.0636961143760573e-05i, -0.00016840632485074858 + -3.0333295303186657e-05i, 3.594961998075141e-06 + -2.3625723109632566e-06i, 0.0003307744580642401 + 9.921127947451117e-05i, 0.12835455898064768 + -1.7787691892340307e-18i, -0.010402717932604836 + -0.007697260316358347i, -2.2501838494928818e-05 + -2.8919290798858062e-05i }, { -1.010426311994667e-06 + 5.381711506779122e-07i, -0.00017291332707417966 + 2.733474838188418e-05i, 0.0006390599611648773 + 1.3845712371181982e-05i, 4.96151198633894e-06 + 3.592998028854577e-05i, -3.334872659599554e-05 + 1.135810777095157e-05i, -0.010402717932604836 + 0.007697260316358346i, 0.121323130027228 + 6.2002811739014785e-19i, 0.0003152419660914196 + 9.353365101613797e-05i }, { -0.0001715946637675726 + 2.6809496512639997e-05i, 3.5486839538393945e-06 + 2.248410517451619e-06i, 6.654798614898651e-06 + -3.373952585424545e-05i, 0.0006648429493432181 + 1.3611527381353746e-05i, -0.010414714411588614 + 0.007693986030914082i, -2.250183849492883e-05 + 2.8919290798858076e-05i, 0.0003152419660914196 + -9.353365101613794e-05i, 0.12140837535459112 + 1.2680083220396876e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, true, true, false, false, false}), ElementsAreArray({ DoubleNear(0.12872712764384395, 1.0e-7), DoubleNear(0.1286068174126463, 1.0e-7), DoubleNear(0.12150968167155055, 1.0e-7), DoubleNear(0.12159457766584537, 1.0e-7), DoubleNear(0.12847573124364375, 1.0e-7), DoubleNear(0.12835455898064768, 1.0e-7), DoubleNear(0.121323130027228, 1.0e-7), DoubleNear(0.12140837535459112, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, true, false, true, false, false}), Matrix({ { 0.12552325768237288 + 2.659683454378503e-19i, 0.000331743300919964 + -9.658912503307323e-05i, -3.445501938387182e-05 + -1.0819891748819904e-05i, -0.010194559036503754 + -0.007530820719625412i, -0.0024068913165978707 + -0.00840504346063596i, -1.035169644667977e-05 + -4.4209394659165364e-05i, -3.837732048213462e-06 + 6.342740904934855e-06i, -0.00030516804562223063 + 0.0007845604843612031i }, { 0.000331743300919964 + 9.658912503307326e-05i, 0.12483936451098214 + -5.251604272976662e-19i, -0.010137113442616991 + -0.00745651496044915i, -2.1878717374986786e-05 + -2.8536761282009575e-05i, -3.7419390639203855e-05 + -3.637501609939008e-05i, -0.0024096584009779915 + -0.008381049541618377i, -0.0002760036828857661 + 0.0008636647630630549i, 1.6754380715640888e-06 + 2.062953239901311e-06i }, { -3.445501938387182e-05 + 1.08198917488199e-05i, -0.010137113442616991 + 0.00745651496044915i, 0.11796432996725294 + 3.049318610115481e-20i, 0.0003164481725669759 + 9.205036944796965e-05i, 2.663047799237717e-06 + 2.8805924177713166e-07i, 0.0007125944821717018 + 0.0004959296825673939i, -0.002221819739927235 + -0.007918644201921468i, -3.7634493029212683e-05 + -3.906659405808851e-05i }, { -0.010194559036503757 + 0.007530820719625412i, -2.187871737498679e-05 + 2.8536761282009585e-05i, 0.00031644817256697594 + -9.205036944796968e-05i, 0.11857054395684391 + -1.2620790914089075e-19i, 0.000697526085867861 + 0.0005894458775842749i, 1.9978397709661552e-06 + 7.2898738557423575e-06i, -1.1143184354806596e-05 + -3.855763031125062e-05i, -0.0023148228320176156 + -0.007949224322060081i }, { -0.0024068913165978716 + 0.008405043460635957i, -3.741939063920386e-05 + 3.6375016099390054e-05i, 2.6630477992377113e-06 + -2.8805924177712827e-07i, 0.0006975260858678612 + -0.0005894458775842751i, 0.13167960120511482 + 2.0328790734103208e-19i, 0.0003470508919944913 + -9.56310751298165e-05i, -3.263800694481035e-05 + -1.193905232423249e-05i, -0.010646282431524465 + -0.007869069644469491i }, { -1.0351696446679752e-05 + 4.4209394659165337e-05i, -0.0024096584009779902 + 0.008381049541618375i, 0.0007125944821717019 + -0.0004959296825673937i, 1.9978397709661544e-06 + -7.289873855742357e-06i, 0.0003470508919944913 + 9.563107512981659e-05i, 0.13212201188231182 + 4.0657581468206416e-20i, -0.010680032267111096 + -0.0079499311643479i, -2.353523679032526e-05 + -2.9334643322039697e-05i }, { -3.83773204821346e-06 + -6.342740904934858e-06i, -0.0002760036828857657 + -0.0008636647630630551i, -0.0022218197399272357 + 0.007918644201921468i, -1.1143184354806582e-05 + 3.855763031125064e-05i, -3.263800694481036e-05 + 1.193905232423249e-05i, -0.010680032267111096 + 0.0079499311643479i, 0.1248684817315256 + -4.472333961502706e-19i, 0.00033169804548043366 + 8.842484183664884e-05i }, { -0.00030516804562223025 + -0.000784560484361203i, 1.6754380715640886e-06 + -2.0629532399013115e-06i, -3.763449302921266e-05 + 3.906659405808851e-05i, -0.0023148228320176156 + 0.007949224322060081i, -0.010646282431524465 + 0.007869069644469491i, -2.3535236790325263e-05 + 2.9334643322039707e-05i, 0.0003316980454804336 + -8.842484183664886e-05i, 0.12443240906359258 + 1.1214716221646936e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, true, false, true, false, false}), ElementsAreArray({ DoubleNear(0.12552325768237288, 1.0e-7), DoubleNear(0.12483936451098214, 1.0e-7), DoubleNear(0.11796432996725294, 1.0e-7), DoubleNear(0.11857054395684391, 1.0e-7), DoubleNear(0.13167960120511482, 1.0e-7), DoubleNear(0.13212201188231182, 1.0e-7), DoubleNear(0.1248684817315256, 1.0e-7), DoubleNear(0.12443240906359258, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, true, false, false, true, false}), Matrix({ { 0.1285483574291857 + -8.639736061993863e-20i, 0.0002968218866412804 + -0.00011414253031978347i, -2.0237526505596523e-05 + 2.761845262431705e-06i, -0.010419254965818022 + -0.00765814891730662i, 8.808032776526699e-06 + -6.9982968399892545e-06i, 0.0011656079710451184 + 3.2039617996186597e-05i, -3.373496881234395e-05 + 1.0619704670334441e-07i, 1.0604559255366211e-06 + 1.7849489465496667e-06i }, { 0.0002968218866412804 + 0.00011414253031978352i, 0.128546488301044 + -1.802486111757151e-18i, -0.010410976890211851 + -0.0077462351837833225i, -1.6146523620712332e-05 + -1.4646756945518925e-05i, -0.0010169180193240358 + 4.070636891506825e-05i, -5.9679980462149755e-06 + 1.2074128043352336e-06i, -6.694621397616457e-06 + 5.986950391256242e-06i, 2.1820759761894614e-05 + -1.366423309361648e-05i }, { -2.0237526505596533e-05 + -2.761845262431695e-06i, -0.010410976890211851 + 0.0077462351837833225i, 0.12148303065217739 + -1.1689054672109345e-18i, 0.0002942413108685519 + 0.00011298028397574138i, 2.9273712355559864e-05 + 1.0800798991510742e-05i, -3.5067620601806425e-06 + -1.4072461873832962e-06i, -1.1827636152303475e-05 + -2.2474425419185504e-06i, -0.0010879637424298363 + 4.109858391573021e-05i }, { -0.010419254965818024 + 0.00765814891730662i, -1.6146523620712332e-05 + 1.4646756945518928e-05i, 0.0002942413108685519 + -0.00011298028397574139i, 0.12144930312802965 + 7.072725109573408e-19i, 3.13715809062594e-06 + -1.4977755522700203e-06i, -3.1848607795532346e-05 + -3.056465582698323e-06i, 0.0012375314587123013 + 3.0844507439164396e-05i, 1.2450324820547698e-05 + -2.693264168534896e-06i }, { 8.808032776526716e-06 + 6.998296839989268e-06i, -0.0010169180193240358 + -4.070636891506825e-05i, 2.9273712355559854e-05 + -1.0800798991510718e-05i, 3.13715809062594e-06 + 1.4977755522700177e-06i, 0.12865450145830198 + 5.55653613398821e-19i, 0.0003819723062731748 + -7.807766984310627e-05i, -4.685549982308564e-05 + -2.5520789335484097e-05i, -0.010421586502210197 + -0.007741741446788283i }, { 0.0011656079710451184 + -3.2039617996186705e-05i, -5.967998046214982e-06 + -1.2074128043352403e-06i, -3.5067620601806383e-06 + 1.4072461873832991e-06i, -3.1848607795532366e-05 + 3.0564655826982992e-06i, 0.0003819723062731748 + 7.807766984310633e-05i, 0.12841488809224993 + 1.3179832659276913e-18i, -0.010406168819516236 + -0.007660210941013728i, -2.926743054459971e-05 + -4.3224647658530354e-05i }, { -3.3734968812343953e-05 + -1.0619704670332408e-07i, -6.694621397616458e-06 + -5.986950391256241e-06i, -1.182763615230347e-05 + 2.2474425419185504e-06i, 0.0012375314587123013 + -3.084450743916434e-05i, -4.6855499823085655e-05 + 2.5520789335484087e-05i, -0.010406168819516236 + 0.007660210941013727i, 0.12134978104660114 + 7.521652571618187e-19i, 0.00035390490717885763 + 6.749492730887713e-05i }, { 1.0604559255366203e-06 + -1.7849489465496655e-06i, 2.1820759761894624e-05 + 1.366423309361646e-05i, -0.0010879637424298363 + -4.109858391572978e-05i, 1.2450324820547708e-05 + 2.693264168534896e-06i, -0.010421586502210197 + 0.007741741446788283i, -2.9267430544599717e-05 + 4.322464765853037e-05i, 0.00035390490717885763 + -6.749492730887715e-05i, 0.12155364989240683 + 2.879912020664621e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, true, false, false, true, false}), ElementsAreArray({ DoubleNear(0.1285483574291857, 1.0e-7), DoubleNear(0.128546488301044, 1.0e-7), DoubleNear(0.12148303065217739, 1.0e-7), DoubleNear(0.12144930312802965, 1.0e-7), DoubleNear(0.12865450145830198, 1.0e-7), DoubleNear(0.12841488809224993, 1.0e-7), DoubleNear(0.12134978104660114, 1.0e-7), DoubleNear(0.12155364989240683, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, true, false, false, false, true}), Matrix({ { 0.12792091681403656 + 5.234663614031576e-19i, 0.00032182764607698977 + -6.570678263389637e-05i, -2.3861652546536087e-05 + -1.3237268146400584e-05i, -0.010435418887903442 + -0.007666794248449664i, -0.003237990667186822 + 5.064449748147341e-05i, -3.933835719577382e-05 + -1.4373628967194638e-05i, -6.71618788912349e-07 + 8.880841415924509e-06i, 0.0003163326891053109 + 0.00018566815801976047i }, { 0.00032182764607698977 + 6.570678263389642e-05i, 0.1270671930666669 + -5.929230630780102e-19i, -0.010275235311438417 + -0.0075906744879507375i, -2.261462643952492e-05 + -1.8797899640659908e-05i, 8.633790777510243e-06 + 5.9339970976177685e-06i, -0.002769294188917323 + -0.0008449830434378628i, 0.00021522363374548457 + 0.0002941770007155778i, -3.501554840688379e-07 + -1.4641432295996308e-06i }, { -2.3861652546536098e-05 + 1.3237268146400579e-05i, -0.010275235311438417 + 0.0075906744879507375i, 0.12010199941631312 + -1.7957098481791167e-19i, 0.0003124399030053868 + 7.197535291858821e-05i, -3.8082479714147394e-06 + 4.7334492870995755e-06i, 0.0002943577462143131 + -3.0114299904856242e-05i, -0.0025741691729247737 + -0.0007662188303175608i, 1.8439995710995965e-06 + 8.92638777902741e-06i }, { -0.010435418887903444 + 0.007666794248449665i, -2.261462643952492e-05 + 1.8797899640659914e-05i, 0.0003124399030053868 + -7.197535291858826e-05i, 0.12079894040719945 + -1.3527116167651176e-18i, 0.000273818708046002 + -0.0001661731007977216i, 4.34820084187838e-06 + 7.397852244990439e-06i, -3.633670498530852e-05 + -7.418569137784626e-07i, -0.003060757626771953 + 6.997409299034567e-05i }, { -0.0032379906671868215 + -5.064449748147493e-05i, 8.633790777510251e-06 + -5.933997097617809e-06i, -3.808247971414742e-06 + -4.733449287099581e-06i, 0.00027381870804600155 + 0.00016617310079772166i, 0.12928194207345112 + -5.421010862427522e-20i, 0.0003569665468374654 + -0.00012651341752899337i, -4.323137378214608e-05 + -9.521675926651809e-06i, -0.010405422580124779 + -0.00773309611564524i }, { -3.933835719577381e-05 + 1.4373628967194624e-05i, -0.002769294188917323 + 0.0008449830434378616i, 0.0002943577462143133 + 3.0114299904856717e-05i, 4.3482008418783775e-06 + -7.397852244990436e-06i, 0.00035696654683746546 + 0.00012651341752899345i, 0.12989418332662706 + 1.0842021724855044e-19i, -0.01054191039828967 + -0.007815771636846313i, -2.2799327725787124e-05 + -3.907350496338937e-05i }, { -6.716187889123439e-07 + -8.880841415924504e-06i, 0.0002152236337454848 + -0.0002941770007155776i, -0.002574169172924773 + 0.0007662188303175623i, -3.6336704985308547e-05 + 7.418569137784592e-07i, -4.3231373782146083e-05 + 9.521675926651814e-06i, -0.01054191039828967 + 0.007815771636846311i, 0.1227308122824654 + -2.371692252312041e-19i, 0.0003357063150420227 + 0.00010849985836603029i }, { 0.0003163326891053107 + -0.00018566815801976058i, -3.501554840688362e-07 + 1.464143229599631e-06i, 1.8439995710995948e-06 + -8.926387779027404e-06i, -0.00306075762677195 + -6.997409299034664e-05i, -0.010405422580124779 + 0.007733096115645239i, -2.279932772578713e-05 + 3.907350496338938e-05i, 0.0003357063150420227 + -0.00010849985836603026i, 0.12220401261323702 + 2.3479753297889205e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, true, false, false, false, true}), ElementsAreArray({ DoubleNear(0.12792091681403656, 1.0e-7), DoubleNear(0.1270671930666669, 1.0e-7), DoubleNear(0.12010199941631312, 1.0e-7), DoubleNear(0.12079894040719945, 1.0e-7), DoubleNear(0.12928194207345112, 1.0e-7), DoubleNear(0.12989418332662706, 1.0e-7), DoubleNear(0.1227308122824654, 1.0e-7), DoubleNear(0.12220401261323702, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, true, true, false, false}), Matrix({ { 0.12186215924062707 + -7.436949276892757e-19i, 0.00033301328961624744 + -2.44124832785711e-06i, 0.0008256486890039381 + -1.4008219274378449e-05i, 4.762215197040144e-06 + -6.266423620650528e-07i, -0.0023250634974605992 + -0.008178547470926549i, -2.531642295214613e-05 + -4.263062332766616e-05i, 4.0771944238953634e-05 + 0.00016855266024618594i, -1.7783111664442136e-06 + -9.168540880796664e-07i }, { 0.00033301328961624744 + 2.4412483278571e-06i, 0.12182370965673286 + -2.219226321806267e-19i, 5.0790937909935314e-06 + -2.0537511393752077e-06i, 0.000810506602804153 + -1.3614584807003322e-05i, -2.554063683209248e-05 + -3.854318071358124e-05i, -0.002372659140507034 + -0.008181851924255516i, -1.604255197711645e-06 + -5.236792304120239e-07i, 3.5998919605627084e-05 + 0.00016292038973804231i }, { 0.0008256486890039381 + 1.4008219274380204e-05i, 5.079093790993532e-06 + 2.053751139375214e-06i, 0.12162542840899876 + 1.0401564592282808e-18i, 0.0003151781838706924 + -2.0975072572464614e-06i, 4.5034718437113995e-05 + 0.00016230462830447659i, -4.017915469616713e-07 + -1.3683321074560662e-06i, -0.0023036475590645063 + -0.00814514019163088i, -2.2669766523746317e-05 + -4.0645365389587715e-05i }, { 4.762215197040146e-06 + 6.266423620650595e-07i, 0.000810506602804153 + 1.3614584807004999e-05i, 0.0003151781838706924 + 2.097507257246485e-06i, 0.12158619881109321 + -4.2944570425793027e-19i, 1.44650170817705e-07 + -1.0430792872074618e-06i, 4.0325271316519853e-05 + 0.00015729544344892182i, -2.3021938161917972e-05 + -3.638946569705947e-05i, -0.002351822092488573 + -0.008148421939422942i }, { -0.0023250634974606 + 0.008178547470926549i, -2.5540636832092498e-05 + 3.854318071358121e-05i, 4.5034718437113914e-05 + -0.00016230462830447659i, 1.446501708177031e-07 + 1.0430792872074593e-06i, 0.12837465007476742 + -1.5585406229479126e-19i, 0.00034791069718995756 + -3.626112092040943e-06i, 0.0006665082823298603 + -1.0955255251741384e-05i, 1.0086816136197745e-05 + -9.494184098497108e-07i }, { -2.5316422952146125e-05 + 4.2630623327666165e-05i, -0.0023726591405070314 + 0.008181851924255518i, -4.017915469616697e-07 + 1.368332107456063e-06i, 4.032527131651973e-05 + -0.00015729544344892185i, 0.00034791069718995756 + 3.6261120920409737e-06i, 0.1283776854217588 + 1.2434443665693129e-18i, 9.642147948497048e-06 + -1.7612211469235186e-06i, 0.0006612426072659773 + -1.0633903718107572e-05i }, { 4.0771944238953594e-05 + -0.00016855266024618597i, -1.604255197711647e-06 + 5.236792304120273e-07i, -0.0023036475590645063 + 0.00814514019163088i, -2.3021938161917942e-05 + 3.638946569705948e-05i, 0.0006665082823298603 + 1.0955255251743171e-05i, 9.642147948497048e-06 + 1.7612211469235255e-06i, 0.128173432861873 + -8.809142651444724e-20i, 0.00033083824028496734 + -3.5801212011267237e-06i }, { -1.7783111664442152e-06 + 9.16854088079666e-07i, 3.5998919605627e-05 + -0.00016292038973804234i, -2.2669766523746287e-05 + 4.064536538958769e-05i, -0.0023518220924885745 + 0.00814842193942294i, 1.0086816136197738e-05 + 9.494184098497123e-07i, 0.0006612426072659773 + 1.0633903718109322e-05i, 0.00033083824028496734 + 3.5801212011267542e-06i, 0.12817673552414557 + -8.131516293641283e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, true, true, false, false}), ElementsAreArray({ DoubleNear(0.12186215924062707, 1.0e-7), DoubleNear(0.12182370965673286, 1.0e-7), DoubleNear(0.12162542840899876, 1.0e-7), DoubleNear(0.12158619881109321, 1.0e-7), DoubleNear(0.12837465007476742, 1.0e-7), DoubleNear(0.1283776854217588, 1.0e-7), DoubleNear(0.128173432861873, 1.0e-7), DoubleNear(0.12817673552414557, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, true, false, true, false}), Matrix({ { 0.12512882645034884 + -1.268855354986942e-18i, 0.0003105183987980024 + -9.3215879244642e-07i, 0.0007460196235404765 + -9.970596045371885e-06i, 1.0656473038961979e-05 + -2.378693414801609e-06i, -1.0145701163360824e-06 + -4.355290366930577e-06i, 4.134691326790292e-05 + 3.55834206141968e-05i, -3.6027286570035935e-06 + 2.2232326255083725e-07i, 1.1450051759945919e-05 + 9.419896916665573e-06i }, { 0.00031051839879800235 + 9.321587924464573e-07i, 0.12510591388361336 + 2.964615315390051e-19i, 9.346672568657937e-06 + -3.3997558879397447e-06i, 0.0007387021204314812 + -1.3495424858350017e-05i, 0.00011271589667912522 + 3.444750128165123e-05i, 4.004017262173191e-06 + -3.2534724330319506e-07i, 7.462576035878614e-06 + 7.612966629137999e-06i, -5.2297147852959176e-06 + -7.505293951223169e-07i }, { 0.0007460196235404766 + 9.970596045373649e-06i, 9.346672568657942e-06 + 3.3997558879397507e-06i, 0.12490256163101426 + 1.3552527156068805e-20i, 0.00028054479871182994 + -2.3008755159568267e-07i, -2.524983659549287e-06 + 1.2238660982606667e-07i, 1.3326313977289532e-05 + 1.0061060940728982e-05i, -2.0050332594406934e-06 + -4.8904490149772345e-06i, 3.629731534737931e-05 + 3.755478129772002e-05i }, { 1.0656473038961976e-05 + 2.37869341480161e-06i, 0.0007387021204314815 + 1.3495424858351732e-05i, 0.00028054479871182994 + 2.3008755159566573e-07i, 0.12488987754546031 + -1.3916751323388155e-18i, 8.85057374564065e-06 + 9.36689392028497e-06i, -4.434113438314534e-06 + -2.030714981719647e-06i, 0.00010789754270914003 + 3.710337507258139e-05i, 2.4783095121595347e-06 + -1.1605041208964682e-06i }, { -1.0145701163360756e-06 + 4.35529036693059e-06i, 0.00011271589667912545 + -3.4447501281651006e-05i, -2.5249836595492874e-06 + -1.2238660982606878e-07i, 8.850573745640643e-06 + -9.366893920284964e-06i, 0.12510798286504565 + 3.6930636500287495e-19i, 0.00037040558800820265 + -5.135201627451633e-06i, 0.000746137347793322 + -1.4992878480747949e-05i, 4.192558294275911e-06 + 8.026326428868454e-07i }, { 4.134691326790289e-05 + -3.5583420614196875e-05i, 4.004017262173178e-06 + 3.2534724330320184e-07i, 1.3326313977289529e-05 + -1.0061060940728977e-05i, -4.434113438314534e-06 + 2.0307149817196455e-06i, 0.00037040558800820265 + 5.1352016274516164e-06i, 0.12509548119487832 + 7.250602028496811e-19i, 5.374569170832642e-06 + -4.152163983589815e-07i, 0.0007330470896386491 + -1.0753063666760876e-05i }, { -3.6027286570035956e-06 + -2.2232326255083555e-07i, 7.4625760358786086e-06 + -7.6129666291379975e-06i, -2.005033259440678e-06 + 4.890449014977229e-06i, 0.0001078975427091399 + -3.71033750725816e-05i, 0.0007461373477933217 + 1.4992878480749724e-05i, 5.374569170832638e-06 + 4.152163983589889e-07i, 0.1248962996398575 + 9.385125055577648e-19i, 0.0003654716254438299 + -5.4475409067775024e-06i }, { 1.1450051759945912e-05 + -9.419896916665574e-06i, -5.229714785295918e-06 + 7.505293951223169e-07i, 3.629731534737917e-05 + -3.755478129771963e-05i, 2.4783095121595415e-06 + 1.1605041208964538e-06i, 4.192558294275908e-06 + -8.026326428868384e-07i, 0.0007330470896386488 + 1.0753063666762587e-05i, 0.00036547162544382984 + 5.447540906777574e-06i, 0.12487305678977847 + 8.809142651444724e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, true, false, true, false}), ElementsAreArray({ DoubleNear(0.12512882645034884, 1.0e-7), DoubleNear(0.12510591388361336, 1.0e-7), DoubleNear(0.12490256163101426, 1.0e-7), DoubleNear(0.12488987754546031, 1.0e-7), DoubleNear(0.12510798286504565, 1.0e-7), DoubleNear(0.12509548119487832, 1.0e-7), DoubleNear(0.1248962996398575, 1.0e-7), DoubleNear(0.12487305678977847, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, true, false, false, true}), Matrix({ { 0.12413577123251346 + -2.219226321806267e-19i, 0.00032422293870541514 + 3.274783819641428e-06i, 0.0007789868887556814 + -1.5297940786423922e-05i, 5.399143644202672e-06 + 1.0181879229278656e-06i, -0.002932586146674015 + -0.0003809632206530616i, -1.9778304401402596e-05 + -4.1731450093993905e-06i, 4.660720791874044e-05 + -1.0291237456239381e-05i, 1.501093097477438e-07 + 2.257987575682308e-06i }, { 0.00032422293870541514 + -3.2747838196414583e-06i, 0.1240563950079838 + -1.7194768829262297e-18i, 5.718653473504148e-06 + -2.936594371940869e-06i, 0.0007708403933179939 + -1.475357155780992e-05i, -1.4459215877260378e-05 + 1.116020369097223e-06i, -0.0029417451438991473 + -0.00041151486938435084i, 2.6767282641343057e-06 + 3.142403238510276e-06i, 4.486842808449313e-05 + -7.767938384123097e-06i }, { 0.0007789868887556814 + 1.5297940786425708e-05i, 5.718653473504148e-06 + 2.936594371940874e-06i, 0.12388714499783623 + 5.658180087658726e-19i, 0.0003100446103769615 + 2.993786465050409e-06i, 5.534887768801949e-05 + -2.7043114230162772e-05i, 1.9319512865503664e-07 + 2.476235143734185e-06i, -0.0028795736934375806 + -0.00033461111218302563i, -1.771605322327163e-05 + -1.2740961787678283e-06i }, { 5.39914364420267e-06 + -1.018187922927862e-06i, 0.0007708403933179939 + 1.4753571557811604e-05i, 0.0003100446103769614 + -2.9937864650503955e-06i, 0.12380973846588254 + -2.261577969168982e-19i, 3.4086732842149915e-06 + 3.147948617524396e-06i, 5.370438241623698e-05 + -2.4125071787736343e-05i, -1.32436983305379e-05 + 4.0761198147420745e-06i, -0.0028883066717901285 + -0.0003634940810631666i }, { -0.0029325861466740133 + 0.0003809632206530629i, -1.4459215877260365e-05 + -1.1160203690972738e-06i, 5.5348877688019505e-05 + 2.704311423016274e-05i, 3.4086732842149957e-06 + -3.1479486175243943e-06i, 0.12610103808288103 + -6.776263578034403e-19i, 0.0003567010481007899 + -9.342144239539481e-06i, 0.000713170082578117 + -9.66553373969591e-06i, 9.449887689035218e-06 + -2.594248694842629e-06i }, { -1.9778304401402582e-05 + 4.173145009399412e-06i, -0.0029417451438991478 + 0.0004115148693843517i, 1.9319512865503707e-07 + -2.476235143734183e-06i, 5.370438241623699e-05 + 2.4125071787736332e-05i, 0.0003567010481007898 + 9.342144239539532e-06i, 0.12614500007050786 + 2.740998617314916e-18i, 9.002588265986431e-06 + -8.783779143578575e-07i, 0.0007009088167521365 + -9.494916967300973e-06i }, { 4.660720791874046e-05 + 1.029123745623935e-05i, 2.676728264134304e-06 + -3.1424032385102762e-06i, -0.002879573693437581 + 0.00033461111218302444i, -1.3243698330537932e-05 + -4.076119814742078e-06i, 0.000713170082578117 + 9.665533739697665e-06i, 9.002588265986433e-06 + 8.783779143578656e-07i, 0.12591171627303555 + 3.8624702394796095e-19i, 0.0003359718137786983 + -8.671414923423594e-06i }, { 1.5010930974774697e-07 + -2.2579875756823093e-06i, 4.4868428084493124e-05 + 7.767938384123046e-06i, -1.7716053223271633e-05 + 1.2740961787678084e-06i, -0.0028883066717901255 + 0.00036349408106316325i, 9.449887689035214e-06 + 2.5942486948426338e-06i, 0.0007009088167521364 + 9.494916967302715e-06i, 0.0003359718137786983 + 8.671414923423635e-06i, 0.12595319586935624 + -2.846030702774449e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, true, false, false, true}), ElementsAreArray({ DoubleNear(0.12413577123251346, 1.0e-7), DoubleNear(0.1240563950079838, 1.0e-7), DoubleNear(0.12388714499783623, 1.0e-7), DoubleNear(0.12380973846588254, 1.0e-7), DoubleNear(0.12610103808288103, 1.0e-7), DoubleNear(0.12614500007050786, 1.0e-7), DoubleNear(0.12591171627303555, 1.0e-7), DoubleNear(0.12595319586935624, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, false, true, true, false}), Matrix({ { 0.12165933930355627 + -6.268043809681823e-20i, 0.0002824085306306249 + 2.1478387842337727e-06i, -0.0008806318668295888 + -0.007800420669381525i, -1.1602024726971452e-05 + -2.876688512221165e-05i, 3.1504014614250547e-05 + 4.230569184217352e-06i, 0.0003597969321713385 + 0.00010853268468616348i, 1.0299225088840532e-05 + -1.9644976339709265e-05i, -0.00019167281656690306 + -0.00012518878882550669i }, { 0.0002824085306306249 + -2.1478387842337795e-06i, 0.12165081388122509 + -1.1968575544703264e-18i, -1.0174676906887945e-05 + -1.922693457468981e-05i, -0.000955130272442987 + -0.007799115865611135i, 0.0004274566541981726 + 0.00011989854431484166i, 3.553768410058072e-05 + 9.23692641927205e-06i, -0.00020459843031324392 + -0.00014908424006171135i, 8.3281781663534e-06 + -1.8025456802974374e-05i }, { -0.0008806318668295899 + 0.007800420669381526i, -1.017467690688795e-05 + 1.9226934574689835e-05i, 0.12837204877780684 + -1.1926223897340549e-18i, 0.00030865466687920746 + -3.3100851282758754e-06i, -6.663895413469127e-06 + 7.117986812744061e-06i, -0.00012913471353038377 + -3.700626077969885e-05i, -3.4523617990027324e-05 + -1.347630856612516e-05i, -0.00028215270355605633 + -3.539448277424665e-05i }, { -1.1602024726971405e-05 + 2.876688512221163e-05i, -0.0009551302724429861 + 0.007799115865611136i, 0.00030865466687920746 + 3.3100851282759025e-06i, 0.12834497754784857 + 1.0164395367051604e-19i, -0.00012845826810293796 + -0.00011566231573951027i, -4.1154843449668676e-06 + 9.796410149498646e-06i, -0.0002068432148099074 + -4.834766796060904e-05i, -2.905535732624799e-05 + -1.0722777783471712e-05i }, { 3.150401461425055e-05 + -4.230569184217338e-06i, 0.00042745665419817284 + -0.00011989854431484161i, -6.6638954134691335e-06 + -7.117986812744058e-06i, -0.0001284582681029381 + 0.00011566231573951027i, 0.12182824834606959 + 3.5914196963582334e-19i, 0.000365782942856315 + -6.686594369337344e-06i, -0.0037480791896955168 + -0.008523266993175904i, -3.6384164748921e-05 + -5.4509103595042215e-05i }, { 0.0003597969321713383 + -0.00010853268468616323i, 3.553768410058071e-05 + -9.236926419272052e-06i, -0.00012913471353038385 + 3.700626077969896e-05i, -4.115484344966854e-06 + -9.796410149498646e-06i, 0.000365782942856315 + 6.686594369337365e-06i, 0.12175909458660099 + 5.454892180317694e-19i, -3.83878980871225e-05 + -5.57057118359509e-05i, -0.0037693509605526204 + -0.00853115799806732i }, { 1.0299225088840542e-05 + 1.9644976339709265e-05i, -0.00020459843031324403 + 0.00014908424006171157i, -3.452361799002731e-05 + 1.347630856612516e-05i, -0.0002068432148099075 + 4.8347667960609e-05i, -0.0037480791896955168 + 0.008523266993175902i, -3.8387898087122495e-05 + 5.570571183595086e-05i, 0.12817603415883355 + 9.486769009248164e-19i, 0.0003700942705957175 + -3.8961481648917915e-06i }, { -0.00019167281656690298 + 0.00012518878882550647i, 8.328178166353407e-06 + 1.802545680297436e-05i, -0.0002821527035560562 + 3.539448277424672e-05i, -2.905535732624799e-05 + 1.0722777783471705e-05i, -3.6384164748921004e-05 + 5.450910359504223e-05i, -0.00376935096055262 + 0.008531157998067323i, 0.00037009427059571745 + 3.896148164891825e-06i, 0.12820944339805582 + 1.060485249962384e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, false, true, true, false}), ElementsAreArray({ DoubleNear(0.12165933930355627, 1.0e-7), DoubleNear(0.12165081388122509, 1.0e-7), DoubleNear(0.12837204877780684, 1.0e-7), DoubleNear(0.12834497754784857, 1.0e-7), DoubleNear(0.12182824834606959, 1.0e-7), DoubleNear(0.12175909458660099, 1.0e-7), DoubleNear(0.12817603415883355, 1.0e-7), DoubleNear(0.12820944339805582, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, false, true, false, true}), Matrix({ { 0.1250720720839199 + -2.862971361719535e-19i, 0.0003320007036090954 + 3.5723482636781455e-06i, -0.005079314872439598 + -0.008404353538674535i, -3.681497062343186e-05 + -3.8798605688726635e-05i, -0.004401404723872419 + 0.004504913022959179i, -3.4118140343903526e-05 + 1.4023456372392608e-05i, 0.0013586300109941314 + -0.00281536979473208i, 1.9303280949112144e-05 + -1.760601623258056e-05i }, { 0.0003320007036090954 + -3.572348263678149e-06i, 0.12496182366622326 + -7.19130972218901e-19i, -3.2362872415821184e-05 + -3.4356620811621444e-05i, -0.005114026011310736 + -0.00837797558527085i, -3.106441138290965e-05 + 2.2220714513731e-05i, -0.004413791254795158 + 0.004466880689150575i, 2.8008833113189364e-05 + -1.934078282702273e-05i, 0.0014434952469126914 + -0.0028353335337498653i }, { -0.005079314872439597 + 0.008404353538674537i, -3.236287241582121e-05 + 3.435662081162144e-05i, 0.12295084414642977 + 6.301925127571995e-19i, 0.0003022668454732812 + 2.6962220210136913e-06i, -0.0012085333584744059 + -0.010333650866292338i, 1.9193894185057898e-08 + -3.3244987841642594e-05i, -0.0014107551162391768 + -0.005220487355795266i, -3.3762172807706983e-06 + -1.9470697560559826e-05i }, { -3.681497062343183e-05 + 3.8798605688726635e-05i, -0.005114026011310738 + 0.008377975585270852i, 0.00030226684547328116 + -2.696222021013705e-06i, 0.12290430980764308 + -1.2265037076242269e-18i, -6.5291673989721065e-06 + -2.5451349468374826e-05i, -0.001212119166241379 + -0.010314414561069189i, 3.36149717511137e-06 + -1.7028574329891696e-05i, -0.0014162605608941173 + -0.005241889639598091i }, { -0.004401404723872418 + -0.004504913022959178i, -3.106441138290964e-05 + -2.2220714513731026e-05i, -0.0012085333584744037 + 0.01033365086629234i, -6.529167398972127e-06 + 2.5451349468374822e-05i, 0.11841551556570593 + 5.827586677109586e-19i, 0.00031619076987784447 + -8.111103848781717e-06i, 0.00045060381591449194 + -0.007919334123882894i, -1.117121885246059e-05 + -4.447738302852723e-05i }, { -3.4118140343903505e-05 + -1.4023456372392613e-05i, -0.0044137912547951574 + -0.0044668806891505755i, 1.9193894185068062e-08 + 3.3244987841642615e-05i, -0.0012121191662413803 + 0.010314414561069187i, 0.00031619076987784447 + 8.111103848781734e-06i, 0.11844808480160282 + 6.776263578034403e-20i, -1.6199702578189263e-05 + -4.0576025599019255e-05i, 0.00038954477831512884 + -0.007952298278407608i }, { 0.0013586300109941296 + 0.002815369794732078i, 2.8008833113189388e-05 + 1.9340782827022736e-05i, -0.0014107551162391766 + 0.005220487355795266i, 3.361497175111348e-06 + 1.7028574329891676e-05i, 0.0004506038159144898 + 0.00791933412388289i, -1.6199702578189236e-05 + 4.0576025599019255e-05i, 0.13359723879021063 + -8.74138001566438e-19i, 0.00037648209200164375 + -9.902455314181358e-06i }, { 1.930328094911212e-05 + 1.760601623258054e-05i, 0.0014434952469126905 + 0.002835333533749868i, -3.37621728077071e-06 + 1.947069756055983e-05i, -0.0014162605608941154 + 0.005241889639598091i, -1.1171218852460577e-05 + 4.447738302852722e-05i, 0.0003895447783151321 + 0.007952298278407606i, 0.00037648209200164375 + 9.902455314181433e-06i, 0.1336501111382613 + 2.388632911257127e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, false, true, false, true}), ElementsAreArray({ DoubleNear(0.1250720720839199, 1.0e-7), DoubleNear(0.12496182366622326, 1.0e-7), DoubleNear(0.12295084414642977, 1.0e-7), DoubleNear(0.12290430980764308, 1.0e-7), DoubleNear(0.11841551556570593, 1.0e-7), DoubleNear(0.11844808480160282, 1.0e-7), DoubleNear(0.13359723879021063, 1.0e-7), DoubleNear(0.1336501111382613, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, true, false, false, false, false, true, true}), Matrix({ { 0.12702929138244734 + -2.659683454378503e-19i, 0.00028803052055118364 + 3.886695761321105e-06i, 1.9642705436586708e-05 + 4.5805525823182175e-06i, 0.0003741465831320225 + 5.573334478983076e-05i, -0.002343501670347968 + 0.0007692356133953394i, -6.772960316709132e-06 + -1.997126134038979e-06i, -8.515262357813394e-05 + -4.011144151163836e-05i, -0.0004922968485046456 + -0.0004830661658920375i }, { 0.00028803052055118364 + -3.886695761321132e-06i, 0.12693399720267665 + -9.529120656610879e-19i, 0.0004313981400596119 + 0.00013671129521200542i, 2.3088950988052175e-05 + 6.951107342138963e-06i, -4.0946077062521875e-06 + 8.162088085901838e-06i, -0.0023903003344751313 + 0.000749416921899196i, -0.0005722905249245326 + -0.0005297599839385436i, -7.924116866057496e-05 + -4.4748729761641374e-05i }, { 1.964270543658673e-05 + -4.5805525823181904e-06i, 0.00043139814005961207 + -0.00013671129521200526i, 0.12099362484790235 + 6.098637220230962e-19i, 0.00034623702853119303 + 2.381874523370732e-06i, -3.6333491750515944e-05 + -1.2561304328288255e-05i, -0.00028731458004893385 + -0.0005240803430132478i, -0.003468658169763628 + -0.0014848099462314262i, -3.072139730796509e-05 + -3.45011505412824e-06i }, { 0.0003741465831320224 + -5.573334478983055e-05i, 2.3088950988052175e-05 + -6.951107342138953e-06i, 0.000346237028531193 + -2.3818745233707218e-06i, 0.12093213627118968 + -9.9272261418204e-19i, -0.0003262877467685715 + -0.0005792309625443122i, -3.711994418157305e-05 + -1.039155023306833e-05i, -2.3608306501546093e-05 + -2.9699479020625378e-06i, -0.0034397514812141445 + -0.0015244258723467134i }, { -0.0023435016703479677 + -0.0007692356133953389i, -4.094607706252213e-06 + -8.162088085901858e-06i, -3.6333491750515964e-05 + 1.2561304328288234e-05i, -0.0003262877467685712 + 0.0005792309625443122i, 0.12300209669891576 + -9.893344823930228e-19i, 0.0003030326769586487 + -5.0489421053632075e-06i, -2.2662308812363486e-05 + -1.3826291964226026e-05i, -0.00029650235451674027 + 1.740485712208606e-05i }, { -6.772960316709151e-06 + 1.9971261340390127e-06i, -0.0023903003344751318 + -0.0007494169218991969i, -0.0002873145800489333 + 0.0005240803430132479i, -3.7119944181573076e-05 + 1.0391550233068346e-05i, 0.0003030326769586487 + 5.048942105363255e-06i, 0.12306179422639701 + -1.4230153513872246e-19i, -0.00021078470067134667 + -6.51604188577728e-05i, -1.6606624213719447e-05 + -8.436958706338626e-06i }, { -8.515262357813394e-05 + 4.011144151163836e-05i, -0.0005722905249245322 + 0.0005297599839385435i, -0.003468658169763627 + 0.001484809946231427i, -2.3608306501546086e-05 + 2.969947902062508e-06i, -2.2662308812363486e-05 + 1.3826291964226012e-05i, -0.00021078470067134673 + 6.516041885777266e-05i, 0.12901065765700082 + 6.979551485375435e-19i, 0.0003896401849208395 + -1.2964617057599868e-05i }, { -0.0004922968485046452 + 0.0004830661658920376i, -7.924116866057496e-05 + 4.4748729761641374e-05i, -3.0721397307965064e-05 + 3.4501150541282056e-06i, -0.0034397514812141415 + 0.001524425872346712i, -0.0002965023545167403 + -1.740485712208595e-05i, -1.6606624213719454e-05 + 8.436958706338607e-06i, 0.0003896401849208395 + 1.2964617057599912e-05i, 0.1290364017134671 + 2.5986970821761934e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, true, false, false, false, false, true, true}), ElementsAreArray({ DoubleNear(0.12702929138244734, 1.0e-7), DoubleNear(0.12693399720267665, 1.0e-7), DoubleNear(0.12099362484790235, 1.0e-7), DoubleNear(0.12093213627118968, 1.0e-7), DoubleNear(0.12300209669891576, 1.0e-7), DoubleNear(0.12306179422639701, 1.0e-7), DoubleNear(0.12901065765700082, 1.0e-7), DoubleNear(0.1290364017134671, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, true, true, false, false, false}), Matrix({ { 0.128583902797966 + -5.21772295508649e-19i, 0.0005706545259146597 + 1.3899559216047137e-05i, -2.625813559137489e-05 + -1.509624999584601e-05i, -0.00010191013975972702 + -7.044585868855949e-05i, 0.0008276864710047003 + -8.26121485124392e-06i, 4.271066640374092e-05 + -1.6184056532891759e-06i, 9.459404453018391e-07 + -1.2685978584457156e-06i, -3.709749374149688e-07 + 3.5987356828841226e-07i }, { 0.0005706545259146599 + -1.3899559216047198e-05i, 0.12875004225852427 + 1.9532579763684166e-18i, -0.00010220469015808942 + -6.862163237319136e-05i, -3.0398279811694962e-05 + -2.5256700111446027e-05i, 4.436027960082467e-05 + -4.194448115647212e-06i, 0.000832316799891133 + -1.3493508447454601e-05i, -6.085932135141008e-07 + 6.295409907469968e-07i, 1.592317196542892e-06 + -1.5179838096838132e-06i }, { -2.62581355913749e-05 + 1.5096249995846015e-05i, -0.00010220469015808944 + 6.862163237319137e-05i, 0.12146700778851285 + -1.328147661294743e-18i, 0.0005396553605044191 + 1.4690979225398972e-05i, 7.536205464790466e-07 + 9.801868899047222e-07i, -5.879393114374443e-07 + -8.174509856980559e-07i, 0.0006528398193333065 + -1.2089346993604025e-05i, 3.480830118349962e-05 + -1.5909203790230306e-06i }, { -0.00010191013975972707 + 7.044585868855946e-05i, -3.0398279811694962e-05 + 2.5256700111446027e-05i, 0.0005396553605044191 + -1.469097922539884e-05i, 0.12163725154888308 + 1.8634724839594607e-20i, -2.3311170609047058e-07 + -2.0850135282387414e-07i, 1.3368896669625564e-06 + 1.7615027010057676e-06i, 3.615140512020366e-05 + -4.167031884345229e-06i, 0.000651063091174789 + -1.5367892758928182e-05i }, { 0.0008276864710047003 + 8.261214851245638e-06i, 4.4360279600824666e-05 + 4.194448115647212e-06i, 7.536205464790468e-07 + -9.8018688990472e-07i, -2.3311170609046783e-07 + 2.0850135282387287e-07i, 0.12834517096537928 + -8.334804200982315e-19i, 0.0005557053814288476 + 1.7381586479774123e-05i, -2.5448541771996268e-05 + -1.5640409663732417e-05i, -0.00010154784216352397 + -7.012178588307815e-05i }, { 4.271066640374093e-05 + 1.6184056532891657e-06i, 0.000832316799891133 + 1.3493508447456326e-05i, -5.879393114374412e-07 + 8.174509856980534e-07i, 1.3368896669625562e-06 + -1.7615027010057655e-06i, 0.0005557053814288477 + -1.7381586479774215e-05i, 0.12848511925891215 + -6.132518538121134e-19i, -0.00010205095098190935 + -6.847465623218713e-05i, -3.040202331892808e-05 + -2.463698890607721e-05i }, { 9.459404453018394e-07 + 1.268597858445718e-06i, -6.08593213514105e-07 + -6.295409907469995e-07i, 0.0006528398193333064 + 1.208934699360579e-05i, 3.615140512020365e-05 + 4.167031884345237e-06i, -2.544854177199628e-05 + 1.564040966373242e-05i, -0.0001020509509819094 + 6.847465623218713e-05i, 0.12129434379480747 + 1.748276003132876e-18i, 0.0005242632793487963 + 1.749855126987442e-05i }, { -3.7097493741497156e-07 + -3.5987356828841396e-07i, 1.5923171965428885e-06 + 1.5179838096838134e-06i, 3.480830118349962e-05 + 1.5909203790230306e-06i, 0.000651063091174789 + 1.5367892758929937e-05i, -0.00010154784216352398 + 7.012178588307814e-05i, -3.0402023318928092e-05 + 2.4636988906077224e-05i, 0.0005242632793487963 + -1.7498551269874538e-05i, 0.12143716158701165 + 1.3976043629695956e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, true, true, false, false, false}), ElementsAreArray({ DoubleNear(0.128583902797966, 1.0e-7), DoubleNear(0.12875004225852427, 1.0e-7), DoubleNear(0.12146700778851285, 1.0e-7), DoubleNear(0.12163725154888308, 1.0e-7), DoubleNear(0.12834517096537928, 1.0e-7), DoubleNear(0.12848511925891215, 1.0e-7), DoubleNear(0.12129434379480747, 1.0e-7), DoubleNear(0.12143716158701165, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, true, false, true, false, false}), Matrix({ { 0.11473579124797012 + -6.098637220230962e-19i, -0.0005554645244694644 + 0.00010636062361610329i, -2.5030031826029472e-05 + -1.3776859363506518e-05i, 0.00016524048772592454 + 7.527243453566625e-05i, 0.0071065346773662216 + -0.010695331111126609i, 0.0002214527354114575 + -0.0021345108380995403i, -6.598316975016593e-06 + -1.9278800016560325e-06i, -0.00038132075159992064 + 0.00043209782317215625i }, { -0.0005554645244694645 + -0.00010636062361610353i, 0.1356268309453849 + 3.5067164016328034e-19i, 0.0001236462550261469 + 0.00013392956492080957i, -3.130370493282913e-05 + -2.557979366732296e-05i, -0.0014128251778723884 + -0.0026403230062304293i, -0.011923084394942085 + -0.006090761891127727i, -0.00010472411376687183 + 0.0007865471582796i, 4.43602299836722e-06 + 1.0333574146492198e-05i }, { -2.503003182602948e-05 + 1.377685936350652e-05i, 0.00012364625502614686 + -0.00013392956492080957i, 0.10838883388821566 + 3.9302328752599536e-19i, -0.0005193403738302753 + 0.00010268666291738011i, -3.057008744576372e-06 + 6.162986149733375e-06i, 0.00027939689740347803 + 0.0005010730370361799i, 0.006721246629435185 + -0.010111225884563053i, 0.00020405778115294571 + -0.002006827461335559i }, { 0.00016524048772592452 + -7.52724345356663e-05i, -3.130370493282914e-05 + 2.5579793667322967e-05i, -0.0005193403738302754 + -0.00010268666291738003i, 0.1281460400358812 + -4.887380105657313e-19i, 0.000705671168317223 + 0.000352242589205051i, 7.717896314780245e-06 + 1.4149469477861139e-06i, -0.001342262753639883 + -0.0024800952475409225i, -0.011257889201380034 + -0.0057566426394184975i }, { 0.007106534677366224 + 0.010695331111126607i, -0.0014128251778723878 + 0.0026403230062304293i, -3.057008744576379e-06 + -6.162986149733375e-06i, 0.0007056711683172228 + -0.00035224258920505097i, 0.14219328251537516 + -7.453889935837843e-19i, 0.0016818244318129716 + -7.507947792028202e-05i, -2.6676645537341694e-05 + -1.695980029607191e-05i, -0.00036869846964917555 + -0.0002158400791073039i }, { 0.00022145273541145766 + 0.0021345108380995403i, -0.011923084394942085 + 0.006090761891127726i, 0.00027939689740347803 + -0.00050107303703618i, 7.717896314780244e-06 + -1.4149469477861094e-06i, 0.0016818244318129718 + 7.507947792028216e-05i, 0.12160833057205146 + 9.893344823930228e-19i, -0.0003279018961661457 + -0.0002710258535261881i, -2.949659819779391e-05 + -2.4313895350200277e-05i }, { -6.598316975016591e-06 + 1.9278800016560325e-06i, -0.00010472411376687179 + -0.0007865471582796i, 0.006721246629435189 + 0.010111225884563054i, -0.0013422627536398835 + 0.0024800952475409225i, -2.6676645537341708e-05 + 1.6959800296071917e-05i, -0.0003279018961661457 + 0.00027102585352618803i, 0.13437251769510467 + 2.710505431213761e-20i, 0.0015832590136834908 + -7.049713242210671e-05i }, { -0.00038132075159992064 + -0.0004320978231721563i, 4.4360229983672194e-06 + -1.0333574146492203e-05i, 0.00020405778115294555 + 0.0020068274613355584i, -0.01125788920138004 + 0.0057566426394184975i, -0.0003686984696491756 + 0.0002158400791073039i, -2.9496598197793915e-05 + 2.431389535020028e-05i, 0.0015832590136834908 + 7.049713242210666e-05i, 0.11492837310001353 + 6.471331717022855e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, true, false, true, false, false}), ElementsAreArray({ DoubleNear(0.11473579124797012, 1.0e-7), DoubleNear(0.1356268309453849, 1.0e-7), DoubleNear(0.10838883388821566, 1.0e-7), DoubleNear(0.1281460400358812, 1.0e-7), DoubleNear(0.14219328251537516, 1.0e-7), DoubleNear(0.12160833057205146, 1.0e-7), DoubleNear(0.13437251769510467, 1.0e-7), DoubleNear(0.11492837310001353, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, true, false, false, true, false}), Matrix({ { 0.12840007488755922 + -1.700842158086635e-18i, 0.0005592151716468632 + 3.712581476670259e-05i, 1.7517550118822554e-06 + 1.197757097472216e-05i, -0.00010917220722879282 + -5.572333942589797e-05i, -6.76727296981317e-07 + -3.439932309673166e-05i, 1.30117243532498e-05 + -1.6608894003132768e-05i, -3.2504549056827736e-06 + -3.877748752062356e-06i, -8.154844415916525e-06 + -1.2676789079978975e-06i }, { 0.0005592151716468633 + -3.712581476670276e-05i, 0.12869477084267048 + -1.8804131429045468e-19i, -9.555727339708323e-05 + -7.573348776592105e-05i, -3.813580513819112e-05 + -2.3862482657809376e-05i, -1.2584070643600399e-05 + -6.226591938383554e-06i, 3.516762027293044e-06 + 2.8608439061077637e-05i, -9.179076349973029e-06 + -2.0014277041599305e-06i, -8.663754144766561e-06 + -9.680287294850777e-06i }, { 1.7517550118822427e-06 + -1.1977570974722148e-05i, -9.555727339708325e-05 + 7.573348776592104e-05i, 0.12132824275627356 + 2.439454888092385e-19i, 0.0005277481665493958 + 3.508342581987536e-05i, -7.2837665139303255e-06 + -4.2475391028674415e-06i, -8.150251227036432e-06 + 3.7662720368722902e-06i, 1.4315015792160778e-06 + -3.0552824001027e-05i, 1.1836021614750937e-05 + -1.4924680046930208e-05i }, { -0.00010917220722879287 + 5.5723339425897946e-05i, -3.81358051381911e-05 + 2.386248265780938e-05i, 0.0005277481665493959 + -3.50834258198754e-05i, 0.12160409102393348 + -7.055784450628322e-19i, -6.4192501931058086e-06 + 2.651399264824757e-06i, 4.708871073957852e-06 + 1.1991872511679864e-05i, -1.2744613601600084e-05 + -8.388181868181202e-06i, -8.088129109718503e-07 + 2.5612117290573556e-05i }, { -6.767272969813069e-07 + 3.4399323096731655e-05i, -1.2584070643600345e-05 + 6.226591938383581e-06i, -7.283766513930336e-06 + 4.247539102867448e-06i, -6.419250193105802e-06 + -2.6513992648247543e-06i, 0.12852899887578603 + 3.4558944247975454e-19i, 0.0005671447356966441 + -5.84466907088132e-06i, -5.345843237525342e-05 + -4.271423063430058e-05i, -9.428577469445817e-05 + -8.484430514573968e-05i }, { 1.3011724353249909e-05 + 1.660889400313274e-05i, 3.5167620272930373e-06 + -2.860843906107763e-05i, -8.150251227036438e-06 + -3.7662720368722945e-06i, 4.708871073957829e-06 + -1.199187251167987e-05i, 0.0005671447356966442 + 5.844669070881361e-06i, 0.12854039067476591 + 1.5280474368467578e-18i, -0.00010869836774291557 + -6.136280083945744e-05i, -2.266449799243193e-05 + -2.6031206359713858e-05i }, { -3.25045490568276e-06 + 3.877748752062376e-06i, -9.17907634997303e-06 + 2.001427704159927e-06i, 1.4315015792160829e-06 + 3.055282400102699e-05i, -1.2744613601600003e-05 + 8.388181868181202e-06i, -5.345843237525343e-05 + 4.271423063430058e-05i, -0.00010869836774291561 + 6.136280083945747e-05i, 0.12143310882704675 + 1.7618285302889447e-19i, 0.0005361704733038196 + -2.893895324601961e-06i }, { -8.154844415916524e-06 + 1.2676789079978967e-06i, -8.663754144766568e-06 + 9.680287294850763e-06i, 1.1836021614750774e-05 + 1.4924680046930045e-05i, -8.088129109718503e-07 + -2.561211729057355e-05i, -9.428577469445821e-05 + 8.484430514573964e-05i, -2.2664497992431944e-05 + 2.603120635971387e-05i, 0.0005361704733038194 + 2.8938953246020286e-06i, 0.12147032211196125 + 8.639736061993863e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, true, false, false, true, false}), ElementsAreArray({ DoubleNear(0.12840007488755922, 1.0e-7), DoubleNear(0.12869477084267048, 1.0e-7), DoubleNear(0.12132824275627356, 1.0e-7), DoubleNear(0.12160409102393348, 1.0e-7), DoubleNear(0.12852899887578603, 1.0e-7), DoubleNear(0.12854039067476591, 1.0e-7), DoubleNear(0.12143310882704675, 1.0e-7), DoubleNear(0.12147032211196125, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, true, false, false, false, true}), Matrix({ { 0.12925352806328372 + -5.421010862427522e-19i, 7.66127989174837e-05 + 3.765580123216963e-05i, -2.1554733330615698e-05 + -1.2150683130640232e-05i, 1.0127823241885392e-05 + -4.101629370253523e-06i, 0.011009321195849756 + 0.0011560142196615421i, -0.0006367735559692624 + 0.000243833660465853i, -6.3836590044122775e-06 + -4.471852469405408e-07i, 0.00017403357439779897 + 1.5865462364005337e-05i }, { 7.661279891748365e-05 + -3.765580123216986e-05i, 0.12573458181741973 + 4.726443845678996e-19i, -4.397536592712394e-06 + 1.3167074466202039e-05i, -2.4921545655445308e-05 + -1.9884484656420256e-05i, -0.0007965250976078839 + 0.00011091393355452728i, -0.017016606051953903 + -0.0019503527656179317i, 0.00020688801422329446 + 0.00010202225968694169i, 5.361884731431092e-06 + 7.863883433265421e-06i }, { -2.1554733330615708e-05 + 1.2150683130640235e-05i, -4.397536592712431e-06 + -1.3167074466202035e-05i, 0.12210760049158231 + -9.215718466126788e-19i, 8.047403738352296e-05 + 4.508956296516285e-05i, -3.757843219276301e-06 + 1.0934433973424461e-05i, 8.530970613255215e-05 + -0.00014311031365290405i, 0.010427825151065584 + 0.0011198596609910084i, -0.0005692113746315636 + 0.0002254957710159273i }, { 1.0127823241885363e-05 + 4.101629370253494e-06i, -2.492154565544531e-05 + 1.9884484656420256e-05i, 8.047403738352296e-05 + -4.5089562965162865e-05i, 0.11879333933193027 + -6.107107549703505e-19i, 0.00017603436111080336 + -0.0001528644551466135i, 4.297796089739943e-06 + 1.1968675586655534e-06i, -0.0007282563456669483 + 8.177419234813542e-05i, -0.01606275195076231 + -0.0018161043983182246i }, { 0.011009321195849757 + -0.0011560142196615445i, -0.0007965250976078843 + -0.00011091393355452749i, -3.757843219276304e-06 + -1.0934433973424463e-05i, 0.00017603436111080333 + 0.00015286445514661352i, 0.12767554570006157 + -8.131516293641283e-19i, 0.0010497471084260235 + -6.374655536348366e-06i, -3.0151944032755468e-05 + -1.8585976528938197e-05i, -0.00021358580516513638 + -0.00013646601520138411i }, { -0.0006367735559692626 + -0.00024383366046585323i, -0.017016606051953903 + 0.0019503527656179308i, 8.53097061325521e-05 + 0.000143110313652904i, 4.29779608973994e-06 + -1.1968675586655555e-06i, 0.001049747108426024 + 6.374655536348461e-06i, 0.13150057970001666 + 8.673617379884035e-19i, -0.0001998581045472864 + -0.00015026336307158054i, -3.587875747517774e-05 + -3.000920436110298e-05i }, { -6.383659004412275e-06 + 4.471852469405407e-07i, 0.0002068880142232945 + -0.00010202225968694177i, 0.010427825151065585 + -0.0011198596609910084i, -0.0007282563456669484 + -8.177419234813574e-05i, -3.015194403275548e-05 + 1.85859765289382e-05i, -0.00019985810454728643 + 0.00015026336307158054i, 0.120653751091738 + 1.3417001884508117e-18i, 0.0009834446024696924 + -1.290003246988945e-05i }, { 0.000174033574397799 + -1.586546236400533e-05i, 5.361884731431095e-06 + -7.863883433265414e-06i, -0.0005692113746315636 + -0.00022549577101592752i, -0.01606275195076231 + 0.0018161043983182237i, -0.00021358580516513644 + 0.0001364660152013841i, -3.587875747517774e-05 + 3.000920436110299e-05i, 0.0009834446024696924 + 1.290003246988949e-05i, 0.12428107380396446 + 7.691059161069047e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, true, false, false, false, true}), ElementsAreArray({ DoubleNear(0.12925352806328372, 1.0e-7), DoubleNear(0.12573458181741973, 1.0e-7), DoubleNear(0.12210760049158231, 1.0e-7), DoubleNear(0.11879333933193027, 1.0e-7), DoubleNear(0.12767554570006157, 1.0e-7), DoubleNear(0.13150057970001666, 1.0e-7), DoubleNear(0.120653751091738, 1.0e-7), DoubleNear(0.12428107380396446, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, true, true, false, false}), Matrix({ { 0.11166664325695785 + -1.3688052427629493e-18i, -0.0005573866989548495 + 0.00010595019729546612i, 0.0007517664570054702 + -9.765112481665558e-06i, 8.256679281318467e-06 + -1.3969809561778865e-07i, 0.006909803524514109 + -0.01040872386870209i, 0.00022315855768401105 + -0.0021244860329025853i, 0.0001664097254433775 + 1.2158996379951088e-05i, -1.8448517424815623e-05 + -4.5180112561406753e-05i }, { -0.0005573866989548492 + -0.00010595019729546615i, 0.13201922564040208 + 4.0318768289304696e-19i, 8.312029499604058e-06 + -4.217527123643411e-06i, 0.000884388834802621 + -1.7857691599716215e-05i, -0.0014077995029213447 + -0.0026257973630487135i, -0.011607526162481743 + -0.005951675526479976i, -4.9848198588102344e-05 + -4.968212039659942e-05i, -8.963886159879677e-05 + 0.00031931405360427717i }, { 0.0007517664570054702 + 9.765112481667117e-06i, 8.312029499604038e-06 + 4.217527123643396e-06i, 0.11145798187922792 + 1.1519648082658485e-18i, -0.0005174181993448904 + 0.00010309708923801728i, 0.00016205413860940658 + 4.96534750633943e-06i, -1.451920012131434e-05 + -5.0722121362971844e-05i, 0.006917977782287298 + -0.010397833126987572i, 0.00020235195888039227 + -0.002016852266532514i }, { 8.256679281318467e-06 + 1.3969809561776748e-07i, 0.000884388834802621 + 1.7857691599718082e-05i, -0.0005174181993448905 + -0.00010309708923801744i, 0.13175364534086403 + -5.412540532954979e-19i, -4.687848502749013e-05 + -4.777542472807739e-05i, -7.669414885577274e-05 + 0.00031463472424705897i, -0.001347288428590927 + -0.002494620890722639i, -0.011573447433840377 + -0.005895729004066249i }, { 0.006909803524514112 + 0.010408723868702091i, -0.0014077995029213443 + 0.0026257973630487135i, 0.00016205413860940647 + -4.965347506339342e-06i, -4.6878485027490164e-05 + 4.777542472807741e-05i, 0.13838426732952097 + -4.811147140404426e-19i, 0.0016676965853739281 + -7.735965885402002e-05i, 0.0007287598333325367 + -1.0585449363182384e-05i, 6.926228830592208e-05 + -3.069627936694416e-06i }, { 0.00022315855768401105 + 0.002124486032902585i, -0.011607526162481743 + 0.005951675526479976i, -1.4519200121314374e-05 + 5.0722121362971864e-05i, -7.669414885577282e-05 + -0.0003146347242470591i, 0.0016676965853739281 + 7.73596588540201e-05i, 0.11836806816700525 + 1.5687050183149642e-18i, 7.219965522142428e-05 + -4.143952876349027e-06i, 0.0005989910562633011 + -1.100370960666657e-05i }, { 0.00016640972544337745 + -1.2158996379950966e-05i, -4.9848198588102364e-05 + 4.968212039659939e-05i, 0.006917977782287301 + 0.010397833126987572i, -0.001347288428590927 + 0.0024946208907226384i, 0.0007287598333325367 + 1.0585449363184312e-05i, 7.219965522142428e-05 + 4.143952876349052e-06i, 0.13818153288095886 + -2.371692252312041e-19i, 0.001597386860122534 + -6.821695148836874e-05i }, { -1.8448517424815657e-05 + 4.5180112561406726e-05i, -8.963886159879685e-05 + -0.00031931405360427733i, 0.000202351958880392 + 0.002016852266532514i, -0.011573447433840381 + 0.005895729004066248i, 6.926228830592208e-05 + 3.069627936694428e-06i, 0.0005989910562633011 + 1.100370960666818e-05i, 0.0015973868601225347 + 6.821695148836868e-05i, 0.11816863550505972 + 6.776263578034403e-20i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, true, true, false, false}), ElementsAreArray({ DoubleNear(0.11166664325695785, 1.0e-7), DoubleNear(0.13201922564040208, 1.0e-7), DoubleNear(0.11145798187922792, 1.0e-7), DoubleNear(0.13175364534086403, 1.0e-7), DoubleNear(0.13838426732952097, 1.0e-7), DoubleNear(0.11836806816700525, 1.0e-7), DoubleNear(0.13818153288095886, 1.0e-7), DoubleNear(0.11816863550505972, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, true, false, true, false}), Matrix({ { 0.12496788971503522 + -1.145188544687814e-18i, 0.0005509776260582481 + 3.4571560714452345e-05i, 0.000735260891467695 + -9.176570926577446e-06i, 3.931717339784183e-05 + -1.2359812839424805e-07i, 1.1752252431433853e-06 + -3.4353543741524314e-05i, 1.3385835250932202e-05 + -1.602034291840206e-05i, -3.355028235560655e-06 + -3.3910987736646974e-06i, -1.2684168809974269e-06 + -3.333970583108909e-07i }, { 0.0005509776260582482 + -3.45715607144524e-05i, 0.12526685061892698 + 1.7279472123987727e-19i, 4.078151664980908e-05 + -4.358572089502552e-06i, 0.0007494608525042627 + -1.4289449977144455e-05i, -1.2522375030127856e-05 + -7.633995357774257e-06i, 1.8142219026937263e-06 + 2.9672906131290535e-05i, 5.960643993763268e-07 + 1.6055366288687445e-07i, -5.477415206738855e-06 + 2.8628926410932177e-06i }, { 0.0007352608914676952 + 9.176570926579213e-06i, 4.078151664980906e-05 + 4.358572089502566e-06i, 0.12476042792879757 + -3.1170812458958252e-19i, 0.0005359857121380108 + 3.7637679872125576e-05i, -1.9800404539739017e-07 + -3.7029488459976326e-06i, -8.209149012073018e-07 + -8.516127653021486e-08i, -4.2045096090862836e-07 + -3.059860335623435e-05i, 1.146191071706821e-05 + -1.5513231131660888e-05i }, { 3.931717339784182e-05 + 1.2359812839425483e-07i, 0.000749460852504263 + 1.428944997714617e-05i, 0.000535985712138011 + -3.763767987212578e-05i, 0.125032011247677 + -1.0664144805931641e-18i, 5.313387709780454e-07 + 3.642218351356781e-07i, -6.7610930524664316e-06 + 1.7946204741040526e-06i, -1.2806309215072383e-05 + -6.9807784487905535e-06i, 8.937272136274676e-07 + 2.4547650220360655e-05i }, { 1.1752252431433827e-06 + 3.43535437415243e-05i, -1.2522375030127748e-05 + 7.633995357774257e-06i, -1.980040453973889e-07 + 3.70294884599763e-06i, 5.313387709780318e-07 + -3.642218351356815e-07i, 0.1250830208714436 + -7.047314121155779e-19i, 0.0005593322603608306 + -5.98102227300625e-06i, 0.0007452653988703119 + -1.1173990918270496e-05i, 3.8201794189398716e-05 + -3.085727903917955e-06i }, { 1.338583525093231e-05 + 1.6020342918402088e-05i, 1.8142219026937161e-06 + -2.9672906131290515e-05i, -8.209149012072967e-07 + 8.516127653021655e-08i, -6.7610930524664316e-06 + -1.7946204741040522e-06i, 0.0005593322603608307 + 5.981022273006352e-06i, 0.12512044318848037 + 1.799097979968134e-18i, 3.9730168071219256e-05 + -4.002907910489886e-06i, 0.0007339190385616594 + -1.4571951229238328e-05i }, { -3.355028235560657e-06 + 3.3910987736646965e-06i, 5.9606439937632e-07 + -1.6055366288688123e-07i, -4.2045096090860337e-07 + 3.0598603356234346e-05i, -1.280630921507241e-05 + 6.9807784487905535e-06i, 0.0007452653988703116 + 1.1173990918272214e-05i, 3.973016807121927e-05 + 4.0029079104898836e-06i, 0.1248790868313892 + 1.2265037076242269e-18i, 0.000543982948639633 + -2.7575421224770375e-06i }, { -1.2684168809974252e-06 + 3.3339705831088923e-07i, -5.477415206738857e-06 + -2.8628926410932147e-06i, 1.1461910717068156e-05 + 1.5513231131660725e-05i, 8.937272136274709e-07 + -2.4547650220360665e-05i, 3.820179418939873e-05 + 3.085727903917939e-06i, 0.000733919038561659 + 1.4571951229240097e-05i, 0.0005439829486396329 + 2.7575421224770104e-06i, 0.12489026959824678 + 5.929230630780102e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, true, false, true, false}), ElementsAreArray({ DoubleNear(0.12496788971503522, 1.0e-7), DoubleNear(0.12526685061892698, 1.0e-7), DoubleNear(0.12476042792879757, 1.0e-7), DoubleNear(0.125032011247677, 1.0e-7), DoubleNear(0.1250830208714436, 1.0e-7), DoubleNear(0.12512044318848037, 1.0e-7), DoubleNear(0.1248790868313892, 1.0e-7), DoubleNear(0.12489026959824678, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, true, false, false, true}), Matrix({ { 0.12579689574466368 + -2.1277467635028025e-18i, 7.147354538929568e-05 + 3.709079759073778e-05i, 0.0007935801646395085 + -1.3888221815725869e-05i, 3.9800302347073625e-05 + 1.2265872881799646e-05i, 0.010701846773363131 + 0.0011172913998509651i, -0.0006314917348064619 + 0.00024153634220227394i, 0.0001793792550135487 + -1.5192516600014807e-05i, 5.166639437034139e-05 + -1.7702746707800899e-06i }, { 7.147354538929586e-05 + -3.709079759073792e-05i, 0.12239527049583358 + 1.8634724839594607e-19i, 4.072888273121875e-05 + -1.828031254648159e-05i, 0.0007562471174341668 + -1.6163290528507977e-05i, -0.0007944857374913774 + 0.00011037409735067662i, -0.016576178063936298 + -0.0019097694898883777i, 4.4771152646112346e-05 + -4.355453606051739e-05i, -8.790361901031514e-05 + -2.866659240347671e-06i }, { 0.0007935801646395085 + 1.3888221815727625e-05i, 4.072888273121875e-05 + 1.8280312546481596e-05i, 0.12556423281020235 + 6.640738306473715e-19i, 8.561329091171096e-05 + 4.565456660659467e-05i, 0.00018705584557739423 + -2.773016728970005e-05i, 5.2662621197753445e-05 + -2.912583934335478e-06i, 0.010735299573552208 + 0.001158582480801586i, -0.0005744931957943642 + 0.00022779308927950643i }, { 3.980030234707361e-05 + -1.2265872881799646e-05i, 0.0007562471174341668 + 1.6163290528509685e-05i, 8.561329091171077e-05 + -4.565456660659482e-05i, 0.12213265065351644 + -3.2441361879839703e-19i, 4.605087943469766e-05 + -4.179020416157126e-05i, -7.800258547313773e-05 + -2.3438018728199067e-05i, -0.000730295705783455 + 8.231402855198613e-05i, -0.016503179938779915 + -0.0018566876740477778i }, { 0.010701846773363135 + -0.0011172913998509638i, -0.0007944857374913777 + -0.00011037409735067678i, 0.00018705584557739423 + 2.7730167289700248e-05i, 4.605087943469764e-05 + 4.179020416157125e-05i, 0.12425401484181514 + 2.778268066994105e-19i, 0.001038836341029783 + -8.500259149291683e-06i, 0.0006869461256984984 + -6.462340029122075e-06i, 3.771866524016692e-05 + -1.547519891411185e-05i }, { -0.0006314917348064621 + -0.0002415363422022741i, -0.016576178063936298 + 0.0019097694898883785i, 5.266262119775341e-05 + 2.912583934335471e-06i, -7.800258547313775e-05 + 2.3438018728198823e-05i, 0.001038836341029783 + 8.500259149291873e-06i, 0.12799202331157378 + 1.785545452812065e-18i, 3.978280198980959e-05 + 9.91883254648915e-06i, 0.0007271327736317552 + -1.269811067787481e-05i }, { 0.00017937925501354873 + 1.5192516600014963e-05i, 4.477115264611234e-05 + 4.3554536060517376e-05i, 0.01073529957355221 + -0.0011585824808015887i, -0.0007302957057834551 + -8.231402855198635e-05i, 0.0006869461256984984 + 6.4623400291238025e-06i, 3.978280198980957e-05 + -9.918832546489145e-06i, 0.12407528194998442 + 2.507217523872729e-19i, 0.0009943553698659327 + -1.0774428856946133e-05i }, { 5.166639437034142e-05 + 1.7702746707800492e-06i, -8.790361901031516e-05 + 2.86665924034741e-06i, -0.000574493195794364 + -0.0002277930892795066i, -0.016503179938779915 + 0.001856687674047776i, 3.7718665240166935e-05 + 1.547519891411184e-05i, 0.0007271327736317552 + 1.2698110677876578e-05i, 0.0009943553698659332 + 1.0774428856946051e-05i, 0.12778963019240736 + -1.4907779871675686e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, true, false, false, true}), ElementsAreArray({ DoubleNear(0.12579689574466368, 1.0e-7), DoubleNear(0.12239527049583358, 1.0e-7), DoubleNear(0.12556423281020235, 1.0e-7), DoubleNear(0.12213265065351644, 1.0e-7), DoubleNear(0.12425401484181514, 1.0e-7), DoubleNear(0.12799202331157378, 1.0e-7), DoubleNear(0.12407528194998442, 1.0e-7), DoubleNear(0.12778963019240736, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, false, true, true, false}), Matrix({ { 0.11076484168728801 + -3.6591823321385775e-19i, -0.000526337621041274 + 5.5566412940146435e-05i, 0.00766534337652105 + -0.009768968276674403i, 0.0002461200577258678 + -0.0020007943760537604i, 3.792739455415007e-05 + -5.638000260493405e-05i, -0.00015190943444608434 + 1.7525749001664408e-05i, -1.92188271618633e-07 + -1.4530897864995553e-05i, 0.0003267034832496219 + -0.0007822805969020638i }, { -0.0005263376210412738 + -5.556641294014672e-05i, 0.13254531149749332 + -8.936197593532869e-19i, -0.0013956616122167886 + -0.0025809981005717056i, -0.009501105515793626 + -0.005830568258318259i, -0.00016577429591835377 + 8.365450991318284e-05i, 2.9114304160681192e-05 + 6.984749820842345e-05i, 0.0005731470941851509 + -0.0009258635183260284i, 1.8819591526812576e-05 + -2.3139535277688097e-05i }, { 0.00766534337652105 + 0.009768968276674403i, -0.0013956616122167886 + 0.0025809981005717056i, 0.1389634759565448 + -1.0909784360635388e-18i, 0.0016133009592375327 + 1.6642827646431486e-05i, -4.551958198518141e-06 + 8.546876728271486e-06i, 0.0005563998689810045 + 0.0010050843713295923i, -3.717262027191531e-05 + -8.572144492824618e-06i, 0.00017675718041408486 + -4.9059323051727356e-05i }, { 0.00024612005772586777 + 0.0020007943760537604i, -0.009501105515793628 + 0.005830568258318259i, 0.001613300959237533 + -1.664282764643146e-05i, 0.11775355036911064 + 0.0i, 0.00022163767930444462 + 0.0005199419948321378i, -6.227421559917853e-06 + 8.367520233971214e-06i, 0.00014044561167315343 + -9.826928371974762e-05i, -2.6406355044360005e-05 + -1.5626941856772257e-05i }, { 3.792739455415007e-05 + 5.6380002604934035e-05i, -0.00016577429591835377 + -8.365450991318295e-05i, -4.551958198518148e-06 + -8.54687672827149e-06i, 0.00022163767930444462 + -0.0005199419948321378i, 0.11235978344889774 + 1.4907779871675686e-19i, -0.0005484672772584659 + 0.00015348087359333694i, 0.006162437930280358 + -0.011037588719015258i, 0.0001793904588385354 + -0.002140543923381339i }, { -0.00015190943444608434 + -1.752574900166449e-05i, 2.9114304160681192e-05 + -6.984749820842343e-05i, 0.0005563998689810048 + -0.0010050843713295923i, -6.227421559917845e-06 + -8.36752023397122e-06i, -0.0005484672772584658 + -0.00015348087359333689i, 0.13122755948377282 + 7.555533889508359e-19i, -0.0013594263192954828 + -0.0025394201531996462i, -0.013679868080528497 + -0.006016836272227965i }, { -1.9218827161861606e-07 + 1.453089786499552e-05i, 0.000573147094185151 + 0.0009258635183260286i, -3.7172620271915295e-05 + 8.572144492824608e-06i, 0.00014044561167315354 + 9.826928371974776e-05i, 0.006162437930280363 + 0.011037588719015261i, -0.0013594263192954828 + 0.0025394201531996467i, 0.13760232425393504 + 3.7269449679189215e-19i, 0.0016517824862589295 + -0.00016221943798882025i }, { 0.00032670348324962203 + 0.0007822805969020638i, 1.881959152681257e-05 + 2.3139535277688097e-05i, 0.00017675718041408476 + 4.90593230517273e-05i, -2.6406355044360005e-05 + 1.562694185677225e-05i, 0.0001793904588385354 + 0.002140543923381339i, -0.013679868080528498 + 0.006016836272227965i, 0.0016517824862589295 + 0.00016221943798882025i, 0.11878315330295433 + 1.6364676540953083e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, false, true, true, false}), ElementsAreArray({ DoubleNear(0.11076484168728801, 1.0e-7), DoubleNear(0.13254531149749332, 1.0e-7), DoubleNear(0.1389634759565448, 1.0e-7), DoubleNear(0.11775355036911064, 1.0e-7), DoubleNear(0.11235978344889774, 1.0e-7), DoubleNear(0.13122755948377282, 1.0e-7), DoubleNear(0.13760232425393504, 1.0e-7), DoubleNear(0.11878315330295433, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, false, true, false, true}), Matrix({ { 0.09900715161459235 + -6.2341624917916505e-19i, 0.00022277576248238713 + -0.00027674526329613626i, -0.013081782484391367 + -0.005759554401087863i, -0.0006574197296387429 + -0.001864338350187844i, 0.013346807148443982 + -0.006595462729064888i, -0.00101544822000867 + 0.0016994043262507739i, 0.008915128471042373 + -0.019099339553630832i, 0.0002594831496401368 + -0.0017633202288935895i }, { 0.00022277576248238694 + 0.00027674526329613615i, 0.15102674413555084 + -3.8201185921168945e-19i, -0.0019578384655216706 + -0.0036071009825931967i, 0.002888441600641034 + -0.011022774722857523i, -0.001479740748982569 + 0.0015556528018792106i, -0.02216200312711156 + 0.01556725644117464i, 0.00026413613471461484 + -0.001401659013668491i, -0.006113003213135551 + 0.013448636225148889i }, { -0.013081782484391366 + 0.0057595544010878635i, -0.0019578384655216706 + 0.0036071009825931967i, 0.15235397694027367 + -8.402566836762659e-19i, -6.568892618138049e-05 + 0.0003594906274934687i, -0.0012232017610750458 + -0.025875003046719223i, -0.00014888427711433095 + -0.002338383465567604i, 0.008090339198471358 + 0.008871336609717438i, -0.00019053671059215586 + -0.0012300748947689935i }, { -0.0006574197296387429 + 0.001864338350187844i, 0.002888441600641031 + 0.011022774722857523i, -6.568892618138029e-05 + -0.0003594906274934689i, 0.09350117701379919 + 2.439454888092385e-19i, -1.7354045482447287e-05 + -0.0019930573283090816i, -0.0011974507636407386 + 0.005226937619357698i, -4.504069429226348e-05 + -0.0013629646759765479i, -0.010917354875604652 + -0.019333713605110797i }, { 0.013346807148443983 + 0.0065954627290648864i, -0.001479740748982569 + -0.001555652801879211i, -0.0012232017610750434 + 0.025875003046719223i, -1.735404548244699e-05 + 0.0019930573283090816i, 0.12411747352159341 + 4.0657581468206416e-19i, -0.001297580660782127 + 0.00048579254982961963i, 0.026909563791192775 + -0.015047002594601799i, 0.0010829302462031462 + -0.002276999949247255i }, { -0.0010154482200086705 + -0.0016994043262507739i, -0.022162003127111557 + -0.01556725644117464i, -0.00014888427711433105 + 0.002338383465567604i, -0.0011974507636407406 + -0.005226937619357697i, -0.0012975806607821265 + -0.00048579254982961974i, 0.11274612684571533 + 2.439454888092385e-19i, -0.000797249465990601 + -0.0015133172711781554i, -0.026069415196963156 + -0.0008246298076887021i }, { 0.008915128471042373 + 0.019099339553630836i, 0.000264136134714615 + 0.0014016590136684908i, 0.00809033919847136 + -0.00887133660971744i, -4.504069429226389e-05 + 0.0013629646759765479i, 0.02690956379119278 + 0.0150470025946018i, -0.0007972494659906011 + 0.0015133172711781554i, 0.12421182327020613 + 1.2197274440461925e-19i, 0.0033307723716778427 + -0.0005050672378358574i }, { 0.0002594831496401365 + 0.0017633202288935895i, -0.006113003213135552 + -0.013448636225148887i, -0.00019053671059215578 + 0.0012300748947689931i, -0.01091735487560465 + 0.019333713605110794i, 0.0010829302462031462 + 0.0022769999492472546i, -0.026069415196963156 + 0.0008246298076887i, 0.003330772371677843 + 0.0005050672378358577i, 0.1430355266582658 + 1.3925221652860698e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, false, true, false, true}), ElementsAreArray({ DoubleNear(0.09900715161459235, 1.0e-7), DoubleNear(0.15102674413555084, 1.0e-7), DoubleNear(0.15235397694027367, 1.0e-7), DoubleNear(0.09350117701379919, 1.0e-7), DoubleNear(0.12411747352159341, 1.0e-7), DoubleNear(0.11274612684571533, 1.0e-7), DoubleNear(0.12421182327020613, 1.0e-7), DoubleNear(0.1430355266582658, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, true, false, false, false, true, true}), Matrix({ { 0.12854327042557234 + -1.0299920638612292e-18i, 0.0001714191257636647 + 0.00014339901012493493i, 9.243990730293468e-06 + -4.934786566602595e-05i, -0.0004921450851599156 + -0.00046498047866740116i, 0.011285704900934349 + 0.00196604147458827i, -0.0006164422599454587 + -0.0002445357411256766i, -8.449077875166642e-05 + 4.789319494146171e-06i, -0.0024385091702733026 + 0.0002778746442517533i }, { 0.0001714191257636648 + -0.00014339901012493523i, 0.12542001815955167 + -1.8888834723770898e-19i, -0.00045633583865277666 + 0.0003934411701253325i, 3.348766569434542e-05 + 6.087952559048313e-05i, -0.0009530544214591783 + -0.00022518405498182553i, -0.016019506905757448 + -0.00044738893929373476i, -0.001861418011070608 + 0.0013416144984948544i, -7.990301348704247e-05 + -8.96494907674259e-05i }, { 9.243990730293485e-06 + 4.934786566602595e-05i, -0.00045633583865277655 + -0.00039344117012533257i, 0.12281785812929369 + -4.336808689942018e-19i, -1.4332289462658037e-05 + -6.0653645927602506e-05i, 3.9576508010241263e-05 + -0.00010041418291544079i, -0.0018886589539285088 + 0.00017553572290090243i, 0.010151441445980992 + 0.00030983240606428063i, -0.0005895426706553674 + 0.000713865172607457i }, { -0.0004921450851599158 + 0.0004649804786674011i, 3.348766569434542e-05 + -6.08795255904831e-05i, -1.4332289462658146e-05 + 6.065364592760252e-05i, 0.11910790298979834 + 5.082197683525802e-20i, -0.0020516493683512436 + 0.001499136131848601i, -0.00011302994394233026 + 7.746132835408421e-05i, -0.000571727021815654 + 0.0004178721808844883i, -0.017059851096958765 + -0.0033190682246424215i }, { 0.011285704900934349 + -0.001966041474588271i, -0.0009530544214591788 + 0.0002251840549818252i, 3.957650801024124e-05 + 0.0001004141829154408i, -0.0020516493683512436 + -0.001499136131848601i, 0.12118504721826047 + -4.2690460541616737e-19i, 0.0009155442124325942 + -7.118976953835701e-05i, -8.489216448058708e-06 + -1.5604281431732717e-05i, 0.0005169928311279161 + 0.0004334469046173382i }, { -0.0006164422599454589 + 0.0002445357411256764i, -0.016019506905757448 + 0.00044738893929373476i, -0.0018886589539285088 + -0.00017553572290090252i, -0.0001130299439423303 + -7.746132835408421e-05i, 0.0009155442124325944 + 7.118976953835707e-05i, 0.1248788437070523 + -7.047314121155779e-19i, 0.0004310071544075763 + -0.0004080559439318973i, -3.0779716578024224e-05 + -6.658969238831938e-06i }, { -8.44907787516664e-05 + -4.789319494146187e-06i, -0.001861418011070608 + -0.0013416144984948544i, 0.010151441445980994 + -0.0003098324060642815i, -0.000571727021815654 + -0.0004178721808844884i, -8.489216448058708e-06 + 1.56042814317327e-05i, 0.0004310071544075763 + 0.0004080559439318974i, 0.1271442495735391 + 9.554531645028508e-19i, 0.0011176474984631215 + 5.19150815321192e-05i }, { -0.0024385091702733026 + -0.0002778746442517535i, -7.990301348704248e-05 + 8.964949076742592e-05i, -0.0005895426706553674 + -0.0007138651726074571i, -0.01705985109695876 + 0.003319068224642419i, 0.0005169928311279162 + -0.00043344690461733827i, -3.077971657802423e-05 + 6.658969238831917e-06i, 0.0011176474984631217 + -5.1915081532119144e-05i, 0.1309028097969288 + 2.341199066210886e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, true, false, false, false, true, true}), ElementsAreArray({ DoubleNear(0.12854327042557234, 1.0e-7), DoubleNear(0.12542001815955167, 1.0e-7), DoubleNear(0.12281785812929369, 1.0e-7), DoubleNear(0.11910790298979834, 1.0e-7), DoubleNear(0.12118504721826047, 1.0e-7), DoubleNear(0.1248788437070523, 1.0e-7), DoubleNear(0.1271442495735391, 1.0e-7), DoubleNear(0.1309028097969288, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, true, true, false, false}), Matrix({ { 0.12531304911826557 + -4.573977915173222e-20i, -2.840354204969374e-05 + -1.966243681383409e-05i, 0.0009074894514438716 + -1.2324032572938391e-05i, 9.436253339300101e-07 + -1.0692941271204816e-06i, -0.002417669275850255 + -0.008410035776569662i, -9.450843457919876e-07 + 4.267332771596023e-06i, 3.837224908438356e-05 + 0.0001660936609245527i, -2.2391291233913174e-07 + 3.0844802606740257e-07i }, { -2.8403542049693744e-05 + 1.966243681383409e-05i, 0.11837281977909433 + -9.198777807181702e-19i, 7.093280694720282e-07 + 1.0760071855933822e-06i, 0.0007286658403642195 + -1.5298771508443382e-05i, 2.594836101286165e-06 + 3.7922229406213796e-06i, -0.002280053362117378 + -0.007950363618612401i, -2.7691421040026514e-09 + -1.52131039087168e-07i, 3.8398614760197156e-05 + 0.00016537938905967554i }, { 0.0009074894514438716 + 1.2324032572940079e-05i, 7.093280694720281e-07 + -1.0760071855933801e-06i, 0.12504957307508946 + -2.1345230270808369e-19i, -2.7930194709164867e-05 + -1.969421621699539e-05i, 4.236793949565848e-05 + 0.00015970861702172445i, -3.0266671082707105e-07 + 7.130520512551617e-08i, -0.0023988804417256074 + -0.008376057225684672i, -1.2172096308573843e-06 + 4.138361373240141e-06i }, { 9.436253339300083e-07 + 1.069294127120483e-06i, 0.0007286658403642195 + 1.529877150844512e-05i, -2.7930194709164873e-05 + 1.9694216216995396e-05i, 0.11816205414500253 + 8.241630576784342e-19i, -3.6710272264079564e-07 + -1.3033602047974062e-07i, 4.2992050257975364e-05 + 0.00015989145473167392i, 2.066051468917707e-06 + 3.78571015689811e-06i, -0.0022565892098274725 + -0.00791750490536915i }, { -0.002417669275850254 + 0.008410035776569664i, 2.5948361012861655e-06 + -3.7922229406213767e-06i, 4.236793949565837e-05 + -0.00015970861702172445i, -3.6710272264079654e-07 + 1.3033602047974035e-07i, 0.13202089593822464 + 1.4772254600114998e-18i, -2.8252873353376123e-05 + -2.069051329345795e-05i, 0.0007525138194519617 + -9.430690725760132e-06i, 1.594632307914721e-06 + -1.7172875410090468e-06i }, { -9.450843457919855e-07 + -4.267332771596028e-06i, -0.002280053362117378 + 0.007950363618612403i, -3.026667108270709e-07 + -7.13052051255167e-08i, 4.299205025797528e-05 + -0.00015989145473167398i, -2.825287335337612e-05 + 2.069051329345795e-05i, 0.12473143955830159 + -3.8963515573697816e-19i, 1.381182143969575e-06 + 1.6656824053171073e-06i, 0.000575237070143876 + -1.2158468244088822e-05i }, { 3.8372249084383495e-05 + -0.00016609366092455274i, -2.7691421040025984e-09 + 1.5213103908716828e-07i, -0.0023988804417256083 + 0.008376057225684668i, 2.0660514689176985e-06 + -3.7857101568981078e-06i, 0.0007525138194519618 + 9.430690725761885e-06i, 1.3811821439695752e-06 + -1.6656824053171054e-06i, 0.13178071714920198 + -1.2332799712022613e-18i, -2.7920370381759487e-05 + -2.058318235281424e-05i }, { -2.2391291233913254e-07 + -3.084480260674029e-07i, 3.8398614760197095e-05 + -0.00016537938905967557i, -1.2172096308573862e-06 + -4.138361373240143e-06i, -0.0022565892098274725 + 0.00791750490536915i, 1.5946323079147197e-06 + 1.7172875410090485e-06i, 0.0005752370701438759 + 1.2158468244090606e-05i, -2.79203703817595e-05 + 2.0583182352814248e-05i, 0.12456945123681659 + 1.0638733817514012e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, true, true, false, false}), ElementsAreArray({ DoubleNear(0.12531304911826557, 1.0e-7), DoubleNear(0.11837281977909433, 1.0e-7), DoubleNear(0.12504957307508946, 1.0e-7), DoubleNear(0.11816205414500253, 1.0e-7), DoubleNear(0.13202089593822464, 1.0e-7), DoubleNear(0.12473143955830159, 1.0e-7), DoubleNear(0.13178071714920198, 1.0e-7), DoubleNear(0.12456945123681659, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, true, false, true, false}), Matrix({ { 0.12867444255457267 + -8.978549240895584e-20i, -1.8797116296007004e-05 + -6.428440789534466e-06i, 0.0008316395352108324 + -1.0822708536345297e-05i, 2.509935607108868e-06 + -6.896212094056177e-07i, 1.956902987632092e-06 + -2.5555400563405097e-06i, -5.426569541029734e-06 + -7.064353145689431e-06i, -4.240595546286773e-06 + 4.564736769351989e-08i, -3.973105890246984e-07 + -1.894762849335219e-08i }, { -1.8797116296007007e-05 + 6.428440789534469e-06i, 0.12156029777938954 + -8.82608331038981e-19i, 2.0149335476654763e-06 + 1.3160470337588818e-06i, 0.0006530822087611253 + -1.2643312367376605e-05i, -1.013371240533886e-06 + 4.1644808227899995e-06i, 1.0325441582050169e-06 + -2.125097553893264e-06i, -1.881724951013315e-06 + 2.1590415730651228e-06i, -4.5918478960127384e-06 + -5.738535002649994e-07i }, { 0.0008316395352108327 + 1.0822708536347016e-05i, 2.0149335476654755e-06 + -1.3160470337588797e-06i, 0.12842040317565706 + -1.799097979968134e-18i, -1.7586933830301857e-05 + -5.456470893552754e-06i, -3.3214240590764386e-06 + -4.893159093245247e-07i, 2.881054495673981e-07 + -1.2178038893769816e-06i, 8.831317426796332e-07 + -3.235343979313518e-06i, -6.487639509419603e-06 + -6.4936829012237055e-06i }, { 2.509935607108867e-06 + 6.896212094056198e-07i, 0.0006530822087611255 + 1.2643312367378363e-05i, -1.7586933830301857e-05 + 5.456470893552765e-06i, 0.12137203600081752 + 4.2097537478538727e-19i, -2.2444324586502497e-06 + 6.786236441782171e-07i, -3.6376730387873825e-06 + -1.4190124625690558e-06i, -1.561524199438589e-06 + 3.5798525860224192e-06i, -4.098554899607936e-07 + -2.815609156560184e-06i }, { 1.956902987632094e-06 + 2.555540056340515e-06i, -1.0133712405338927e-06 + -4.164480822789986e-06i, -3.3214240590764386e-06 + 4.893159093245228e-07i, -2.244432458650249e-06 + -6.786236441782179e-07i, 0.12865950250191754 + 1.5212711732687234e-18i, -3.785929910706285e-05 + -3.3924509317757574e-05i, 0.000828363735685001 + -1.0932014762353225e-05i, 2.8322034735863153e-08 + -2.096960458723911e-06i }, { -5.4265695410297285e-06 + 7.0643531456894105e-06i, 1.0325441582050067e-06 + 2.125097553893275e-06i, 2.8810544956739985e-07 + 1.217803889376983e-06i, -3.637673038787382e-06 + 1.4190124625690547e-06i, -3.785929910706285e-05 + 3.3924509317757574e-05i, 0.1215439615580064 + -4.2690460541616737e-19i, 7.557666577612667e-08 + 1.4256425571516075e-06i, 0.0006508207017469702 + -1.4813927385155598e-05i }, { -4.240595546286775e-06 + -4.564736769351883e-08i, -1.8817249510133178e-06 + -2.159041573065124e-06i, 8.8313174267964e-07 + 3.2353439793135103e-06i, -1.561524199438611e-06 + -3.5798525860224396e-06i, 0.0008283637356850007 + 1.093201476235495e-05i, 7.557666577612763e-08 + -1.4256425571516058e-06i, 0.12840988704863437 + 3.5236570605778894e-19i, -3.826363126062249e-05 + -3.482092767625687e-05i }, { -3.9731058902469924e-07 + 1.8947628493353724e-08i, -4.5918478960127384e-06 + 5.738535002650006e-07i, -6.487639509419599e-06 + 6.493682901223729e-06i, -4.0985548996076987e-07 + 2.8156091565601695e-06i, 2.8322034735860824e-08 + 2.0969604587239115e-06i, 0.00065082070174697 + 1.4813927385157365e-05i, -3.826363126062252e-05 + 3.482092767625688e-05i, 0.12135946938100159 + 1.4670610646444482e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, true, false, true, false}), ElementsAreArray({ DoubleNear(0.12867444255457267, 1.0e-7), DoubleNear(0.12156029777938954, 1.0e-7), DoubleNear(0.12842040317565706, 1.0e-7), DoubleNear(0.12137203600081752, 1.0e-7), DoubleNear(0.12865950250191754, 1.0e-7), DoubleNear(0.1215439615580064, 1.0e-7), DoubleNear(0.12840988704863437, 1.0e-7), DoubleNear(0.12135946938100159, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, true, false, false, true}), Matrix({ { 0.12763083016062815 + 4.0149361699853836e-19i, -2.3239125967755872e-05 + -1.558869395533789e-05i, 0.0008640470520297587 + -1.3630432097071434e-05i, 7.982574421059459e-07 + -8.481387318147474e-07i, -0.0030267149787131264 + -0.0004159964824948523i, -3.2717534722005477e-07 + 3.7475555197594527e-06i, 4.448328672526006e-05 + -9.262929585437587e-06i, 7.118892290785637e-08 + -3.361734606003607e-07i }, { -2.3239125967755872e-05 + 1.5588693955337886e-05i, 0.12056133607986913 + -2.3428931321053947e-18i, 7.496255749632575e-07 + 1.2526659168581796e-06i, 0.0006857802300439166 + -1.6421080247162408e-05i, 4.0252511953353517e-07 + 6.371463555340289e-06i, -0.002847616311860036 + -0.00037648160754256066i, -4.2345203698885053e-07 + 1.519700124689917e-07i, 4.6992349277973514e-05 + -8.796246254924887e-06i }, { 0.0008640470520297587 + 1.3630432097073147e-05i, 7.496255749632579e-07 + -1.2526659168581775e-06i, 0.12735727972007532 + -4.70950318673391e-19i, -2.3237153018305134e-05 + -1.6446473831722602e-05i, 5.3439477899119855e-05 + -2.6021459004298295e-05i, 4.2995400264903785e-07 + -2.6325714269627935e-07i, -0.0029805698773910185 + -0.0003783420634615373i, -6.945989257611318e-07 + 3.669142666565427e-06i }, { 7.982574421059442e-07 + 8.481387318147485e-07i, 0.0006857802300439166 + 1.6421080247164166e-05i, -2.3237153018305144e-05 + 1.644647383172261e-05i, 0.12033960374364347 + 8.106105305223654e-19i, -2.1979716786595698e-07 + -5.246219437922798e-08i, 5.5613782205136625e-05 + -2.5146727013600833e-05i, 1.374277509301051e-07 + 5.759837976749727e-06i, -0.0027873104878366906 + -0.00031976312978465463i }, { -0.003026714978713127 + 0.00041599648249485187i, 4.025251195335343e-07 + -6.37146355534029e-06i, 5.3439477899119835e-05 + 2.602145900429826e-05i, -2.1979716786595703e-07 + 5.24621943792284e-08i, 0.1297031148958621 + 1.0299920638612292e-18i, -3.341728943531399e-05 + -2.476425615195415e-05i, 0.0007959562188660746 + -8.124291201627087e-06i, 1.7400001997387854e-06 + -1.9384429363147814e-06i }, { -3.271753472200498e-07 + -3.7475555197594476e-06i, -0.0028476163118600333 + 0.0003764816075425624i, 4.2995400264903743e-07 + 2.6325714269628025e-07i, 5.561378220513665e-05 + 2.5146727013600816e-05i, -3.341728943531399e-05 + 2.4764256151954156e-05i, 0.1225429232575268 + 1.0333801956502464e-18i, 1.3408846384783455e-06 + 1.4890236740523098e-06i, 0.000618122680464179 + -1.1036159505369795e-05i }, { 4.448328672526006e-05 + 9.262929585437543e-06i, -4.2345203698885064e-07 + -1.519700124689917e-07i, -0.0029805698773910172 + 0.00037834206346153403i, 1.3742775093010213e-07 + -5.7598379767497275e-06i, 0.0007959562188660746 + 8.124291201628819e-06i, 1.3408846384783455e-06 + -1.489023674052308e-06i, 0.1294730105042161 + -9.75781955236954e-19i, -3.261341207261922e-05 + -2.3830924738087026e-05i }, { 7.118892290785653e-08 + 3.3617346060036047e-07i, 4.699234927797353e-05 + 8.796246254924847e-06i, -6.945989257611298e-07 + -3.6691426665654264e-06i, -0.002787310487836689 + 0.00031976312978465333i, 1.7400001997387837e-06 + 1.938442936314783e-06i, 0.0006181226804641788 + 1.1036159505371561e-05i, -3.261341207261923e-05 + 2.383092473808704e-05i, 0.12239190163817565 + 1.07742590890747e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, true, false, false, true}), ElementsAreArray({ DoubleNear(0.12763083016062815, 1.0e-7), DoubleNear(0.12056133607986913, 1.0e-7), DoubleNear(0.12735727972007532, 1.0e-7), DoubleNear(0.12033960374364347, 1.0e-7), DoubleNear(0.1297031148958621, 1.0e-7), DoubleNear(0.1225429232575268, 1.0e-7), DoubleNear(0.1294730105042161, 1.0e-7), DoubleNear(0.12239190163817565, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, false, true, true, false}), Matrix({ { 0.1251275851348389 + -8.453388813597917e-19i, -1.689873866276322e-05 + -4.5575621474272496e-06i, -0.0011202908307316856 + -0.008053119035799142i, -2.0949344698496626e-06 + 5.848884810661563e-06i, 3.530714691039194e-05 + 6.206398376644118e-06i, -2.6189006731276475e-05 + -4.559006052774509e-05i, 9.74667571540714e-06 + -1.8392697002619974e-05i, 1.1032194325856945e-06 + 2.9000462811979475e-05i }, { -1.6898738662763215e-05 + 4.557562147427253e-06i, 0.11818256804994243 + -4.1419911120735287e-19i, 6.198226458576209e-07 + 4.786401705370788e-07i, -0.0007154713085408906 + -0.007546417499193518i, -3.990638190826789e-05 + 2.381845631077891e-05i, 3.173455180443932e-05 + 7.26109722684528e-06i, 2.7084122447984898e-05 + -7.80202776213675e-06i, 8.88072753978679e-06 + -1.9277736140063666e-05i }, { -0.0011202908307316847 + 0.008053119035799142i, 6.198226458576167e-07 + -4.78640170537075e-07i, 0.13196726059539082 + -1.043544591017298e-18i, -1.9485311463545643e-05 + -7.327349535659969e-06i, -5.337024611830135e-06 + 1.1024021275572814e-05i, 1.8968399398555192e-05 + 1.837860556879798e-05i, -3.246711218008022e-05 + -1.1997282412298144e-05i, 1.4274797680827135e-05 + 3.203202448083195e-05i }, { -2.094934469849663e-06 + -5.848884810661561e-06i, -0.0007154713085408908 + 0.0075464174991935196i, -1.9485311463545653e-05 + 7.32734953565998e-06i, 0.12474976573026461 + -4.743384504624082e-20i, 1.1466917235553232e-05 + -1.601514983467684e-05i, -5.442355146605859e-06 + 5.890375686669897e-06i, 3.7331486468295414e-05 + -1.6074122901966492e-05i, -3.111186313619509e-05 + -1.2201803937298728e-05i }, { 3.5307146910391945e-05 + -6.2063983766441216e-06i, -3.990638190826793e-05 + -2.3818456310778894e-05i, -5.337024611830132e-06 + -1.1024021275572824e-05i, 1.1466917235553232e-05 + 1.6015149834676813e-05i, 0.12523503705851613 + 5.861467994999758e-19i, -3.9434998096095385e-05 + -3.4799090883402234e-05i, -0.0036962588868441767 + -0.008732973966455192i, -6.735950679970927e-08 + 2.5568093341746023e-06i }, { -2.6189006731276448e-05 + 4.559006052774509e-05i, 3.173455180443932e-05 + -7.261097226845275e-06i, 1.8968399398555223e-05 + -1.8378605568797987e-05i, -5.442355146605863e-06 + -5.890375686669883e-06i, -3.94349980960954e-05 + 3.4799090883402234e-05i, 0.11835230587415442 + 3.1848438816761693e-19i, 4.041064924346251e-06 + 7.09929292698241e-06i, -0.00382117126340396 + -0.008321451024788033i }, { 9.746675715407154e-06 + 1.8392697002619954e-05i, 2.70841224479849e-05 + 7.802027762136737e-06i, -3.246711218008021e-05 + 1.1997282412298146e-05i, 3.733148646829542e-05 + 1.6074122901966472e-05i, -0.0036962588868441775 + 0.008732973966455192i, 4.041064924346248e-06 + -7.09929292698241e-06i, 0.1318343524920358 + 1.2874900798265365e-18i, -3.668793227158997e-05 + -3.394634611061222e-05i }, { 1.103219432585681e-06 + -2.900046281197952e-05i, 8.880727539786792e-06 + 1.9277736140063673e-05i, 1.4274797680827119e-05 + -3.203202448083195e-05i, -3.111186313619508e-05 + 1.2201803937298718e-05i, -6.735950679970868e-08 + -2.5568093341746086e-06i, -0.0038211712634039596 + 0.008321451024788033i, -3.6687932271589973e-05 + 3.394634611061222e-05i, 0.12455112506485357 + 7.216720710606639e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, false, true, true, false}), ElementsAreArray({ DoubleNear(0.1251275851348389, 1.0e-7), DoubleNear(0.11818256804994243, 1.0e-7), DoubleNear(0.13196726059539082, 1.0e-7), DoubleNear(0.12474976573026461, 1.0e-7), DoubleNear(0.12523503705851613, 1.0e-7), DoubleNear(0.11835230587415442, 1.0e-7), DoubleNear(0.1318343524920358, 1.0e-7), DoubleNear(0.12455112506485357, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, false, true, false, true}), Matrix({ { 0.1285736262077348 + 2.1514636860259229e-19i, -2.6148322548327597e-05 + -1.7767659332466165e-05i, -0.0052503813277579164 + -0.008607880407123493i, -2.5395188333276984e-06 + 3.6952498929209526e-06i, -0.0045332376867501505 + 0.004596589381788306i, 7.61043917974981e-07 + 3.394073238956552e-06i, 0.0014498802427023551 + -0.0028603887278615065i, -7.826190009168622e-06 + -2.701705103003534e-06i }, { -2.6148322548327607e-05 + 1.776765933246616e-05i, 0.12146026954240838 + -1.2205744769934468e-18i, 5.8898824130775024e-06 + 4.235872130595216e-06i, -0.004942959555992417 + -0.008174448716821894i, -3.4120174059598773e-06 + 1.674469933773684e-06i, -0.004281958291917427 + 0.004375204330321448i, 5.100689773669409e-06 + -2.0984773758781683e-06i, 0.001352245015204468 + -0.002790314600620438i }, { -0.005250381327757918 + 0.008607880407123493i, 5.889882413077496e-06 + -4.235872130595211e-06i, 0.12641448367296867 + -2.846030702774449e-19i, -2.032795643773341e-05 + -1.4267508454594325e-05i, -0.0012556209432446979 + -0.010653824235715944i, 1.2757049739950232e-06 + 2.056925223987536e-06i, -0.0014740471693539946 + -0.005390927927744695i, -1.7828181909561677e-06 + 4.022624947368327e-06i }, { -2.539518833327699e-06 + -3.6952498929209526e-06i, -0.004942959555992417 + 0.008174448716821896i, -2.032795643773341e-05 + 1.426750845459433e-05i, 0.11944067028110421 + -3.1170812458958252e-19i, -6.605520273237578e-06 + 9.924874660157031e-06i, -0.001165031581471087 + -0.009994241191645582i, 3.951970276423517e-06 + 1.045683159831633e-05i, -0.0013529685077792997 + -0.005071449067648663i }, { -0.0045332376867501505 + -0.004596589381788307i, -3.4120174059598806e-06 + -1.6744699337736872e-06i, -0.0012556209432446968 + 0.010653824235715943i, -6.605520273237578e-06 + -9.924874660157031e-06i, 0.12178899598562025 + -4.743384504624082e-19i, -3.0185414210531007e-05 + -2.1588993698363317e-05i, 0.00043383161018205373 + -0.008178212595130843i, 3.7722485667832656e-07 + 4.710444251915213e-06i }, { 7.610439179749855e-07 + -3.394073238956547e-06i, -0.004281958291917424 + -0.004375204330321448i, 1.275704973995024e-06 + -2.0569252239875344e-06i, -0.001165031581471087 + 0.009994241191645582i, -3.018541421053101e-05 + 2.1588993698363324e-05i, 0.11507460438168848 + 1.1248597539537109e-18i, -1.22899484287363e-06 + 3.342060966924273e-06i, 0.00040631698404756684 + -0.007693419807159657i }, { 0.0014498802427023545 + 0.0028603887278615056i, 5.10068977366941e-06 + 2.09847737587817e-06i, -0.001474047169353993 + 0.005390927927744692i, 3.951970276423517e-06 + -1.0456831598316331e-05i, 0.00043383161018205546 + 0.008178212595130841i, -1.228994842873631e-06 + -3.3420609669242733e-06i, 0.13738712941445796 + 5.285485590866834e-19i, -3.58452872974022e-05 + -2.700618719167786e-05i }, { -7.82619000916862e-06 + 2.7017051030035265e-06i, 0.0013522450152044655 + 0.0027903146006204396i, -1.7828181909561653e-06 + -4.0226249473683266e-06i, -0.0013529685077792982 + 0.005071449067648663i, 3.772248566783269e-07 + -4.710444251915218e-06i, 0.0004063169840475664 + 0.007693419807159657i, -3.584528729740221e-05 + 2.700618719167787e-05i, 0.12986022051401397 + 9.859463506040056e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, false, true, false, true}), ElementsAreArray({ DoubleNear(0.1285736262077348, 1.0e-7), DoubleNear(0.12146026954240838, 1.0e-7), DoubleNear(0.12641448367296867, 1.0e-7), DoubleNear(0.11944067028110421, 1.0e-7), DoubleNear(0.12178899598562025, 1.0e-7), DoubleNear(0.11507460438168848, 1.0e-7), DoubleNear(0.13738712941445796, 1.0e-7), DoubleNear(0.12986022051401397, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, true, false, false, true, true}), Matrix({ { 0.1303330685991745 + -1.4060746924421386e-19i, -8.762077977570154e-06 + 2.4361432921167827e-06i, 2.208659601191755e-05 + 6.2185341906294585e-06i, -3.859385404614628e-05 + -4.4969772792735345e-05i, -0.002530106111802991 + 0.0007080631955983241i, -8.846316076702144e-07 + 6.709989043849561e-06i, -8.493072968656885e-05 + -4.248472980769027e-05i, 5.744533012596765e-06 + 9.867341801167825e-05i }, { -8.762077977570153e-06 + -2.4361432921167815e-06i, 0.1236302199859495 + -1.0782729418547243e-18i, -3.289235166075385e-05 + 4.0149455668754964e-05i, 2.0645060412721334e-05 + 5.313125733827719e-06i, -4.633604447751548e-06 + 9.158935002589443e-06i, -0.002203695893020108 + 0.0008105893396962117i, 9.589867955381695e-05 + -7.73843577757634e-06i, -7.946306255214004e-05 + -4.237544146558947e-05i }, { 2.2086596011917556e-05 + -6.218534190629455e-06i, -3.28923516607539e-05 + -4.014945566875498e-05i, 0.12465504128152896 + 7.115076756936123e-20i, -3.771420100849085e-05 + -3.447131107917727e-05i, -3.865649867282786e-05 + -1.2320161997143582e-05i, -2.1140858517466513e-05 + 9.451031218838749e-05i, -0.0034771787443011537 + -0.0015024017415547135i, -1.3714266531097227e-07 + 7.067091424753192e-07i }, { -3.8593854046146244e-05 + 4.496977279273529e-05i, 2.064506041272135e-05 + -5.313125733827695e-06i, -3.771420100849086e-05 + 3.447131107917727e-05i, 0.11727071983756308 + -4.54009659728305e-19i, 0.00010246060150361408 + 1.3062765107506839e-05i, -3.4796937259261125e-05 + -1.0632692564213016e-05i, 5.173557318215188e-06 + 2.9723665295005716e-06i, -0.0034312309066766187 + -0.0015068340770234268i }, { -0.002530106111802991 + -0.000708063195598325i, -4.633604447751547e-06 + -9.158935002589443e-06i, -3.865649867282789e-05 + 1.2320161997143565e-05i, 0.00010246060150361407 + -1.3062765107506839e-05i, 0.12676177713105521 + -1.748276003132876e-18i, -2.7621972148738705e-05 + -1.4321054975204003e-05i, -1.9246561281605827e-05 + -1.2009418226283486e-05i, 2.667964499569694e-05 + 3.14117367458222e-05i }, { -8.846316076702135e-07 + -6.709989043849556e-06i, -0.002203695893020107 + -0.0008105893396962117i, -2.114085851746656e-05 + -9.451031218838753e-05i, -3.479693725926116e-05 + 1.0632692564213016e-05i, -2.7621972148738715e-05 + 1.4321054975204014e-05i, 0.11930211379425754 + 6.166399856011306e-19i, 3.0317456220781376e-05 + -3.240512225994254e-05i, -2.0022371744477106e-05 + -1.0253832444281165e-05i }, { -8.493072968656885e-05 + 4.2484729807690275e-05i, 9.589867955381697e-05 + 7.738435777576343e-06i, -0.003477178744301153 + 0.001502401741554711i, 5.173557318215183e-06 + -2.9723665295005746e-06i, -1.924656128160582e-05 + 1.200941822628348e-05i, 3.0317456220781393e-05 + 3.240512225994255e-05i, 0.13241434826902299 + 1.802486111757151e-18i, -3.84087293591945e-05 + -3.4274125914837175e-05i }, { 5.744533012596765e-06 + -9.86734180116782e-05i, -7.946306255214004e-05 + 4.237544146558946e-05i, -1.3714266531096634e-07 + -7.06709142475318e-07i, -0.0034312309066766153 + 0.0015068340770234274i, 2.6679644995696914e-05 + -3.141173674582215e-05i, -2.002237174447711e-05 + 1.0253832444281138e-05i, -3.840872935919451e-05 + 3.427412591483718e-05i, 0.12563271110144492 + 1.4941661189565858e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, true, false, false, true, true}), ElementsAreArray({ DoubleNear(0.1303330685991745, 1.0e-7), DoubleNear(0.1236302199859495, 1.0e-7), DoubleNear(0.12465504128152896, 1.0e-7), DoubleNear(0.11727071983756308, 1.0e-7), DoubleNear(0.12676177713105521, 1.0e-7), DoubleNear(0.11930211379425754, 1.0e-7), DoubleNear(0.13241434826902299, 1.0e-7), DoubleNear(0.12563271110144492, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, true, true, true, false}), Matrix({ { 0.12175795320492622 + -8.843023969334896e-19i, 0.0008137805201075857 + -8.428366616965825e-06i, -0.0008790228636807625 + -0.007814181111014031i, 6.922433548755533e-05 + 0.0001585368811465421i, 3.393593875710204e-05 + 7.374158941064016e-06i, -4.795246681407864e-07 + 2.190852899722926e-06i, 8.50771509749422e-06 + -1.8520714487334787e-05i, -4.179342043334451e-06 + -2.218576926359269e-06i }, { 0.0008137805201075861 + 8.428366616967532e-06i, 0.12155219997985511 + -3.7523559563365505e-19i, 7.248287474772087e-05 + 0.0001755831374399883i, -0.000956739275591814 + -0.007785355423978631i, 8.427005199589314e-08 + 5.339488580935322e-07i, 3.310575995772922e-05 + 6.0933366624253825e-06i, -3.1881740074633614e-06 + -1.630542897409125e-06i, 1.0119688157699714e-05 + -1.9149718655348852e-05i }, { -0.0008790228636807599 + 0.007814181111014031i, 7.248287474772079e-05 + -0.00017558313743998836i, 0.12847678712903599 + -8.809142651444724e-20i, 0.0006709412238643719 + -1.5037654286756076e-05i, -6.227694803821424e-06 + 8.976725871106464e-06i, 2.1437950261229562e-06 + -4.478772718033939e-06i, -3.094649161126493e-05 + -1.205479655129779e-05i, -8.352918774158725e-06 + -2.7190590322944053e-06i }, { 6.922433548755526e-05 + -0.00015853688114654204i, -0.0009567392755918157 + 0.007785355423978631i, 0.0006709412238643721 + 1.5037654286757848e-05i, 0.12824023919661945 + -1.0028870095490916e-18i, 1.6281643686414609e-06 + -4.200384514357473e-06i, -4.55168495461457e-06 + 7.937671091136243e-06i, -7.043367149859714e-06 + -2.4422772299871125e-06i, -3.263248370501038e-05 + -1.2144289798299084e-05i }, { 3.3935938757102035e-05 + -7.374158941063997e-06i, 8.427005199589441e-08 + -5.339488580935333e-07i, -6.227694803821431e-06 + -8.976725871106484e-06i, 1.6281643686414604e-06 + 4.200384514357472e-06i, 0.12192791569243372 + -8.131516293641283e-20i, 0.0008223747717005054 + -1.9194437464415946e-05i, -0.0038186997742868703 + -0.008546218284168034i, 7.546528357025383e-06 + 0.00017293616883768615i }, { -4.79524668140787e-07 + -2.190852899722924e-06i, 3.310575995772922e-05 + -6.093336662425396e-06i, 2.143795026122956e-06 + 4.4787727180339395e-06i, -4.551684954614563e-06 + -7.937671091136226e-06i, 0.000822374771700505 + 1.9194437464417667e-05i, 0.12165942724023684 + 9.859463506040056e-19i, 1.2877115005912964e-05 + 0.00014401693431341007i, -0.003698730375961266 + -0.00850820670707519i }, { 8.507715097494198e-06 + 1.8520714487334767e-05i, -3.1881740074633606e-06 + 1.630542897409122e-06i, -3.094649161126494e-05 + 1.2054796551297788e-05i, -7.043367149859716e-06 + 2.442277229987111e-06i, -0.003818699774286872 + 0.008546218284168034i, 1.2877115005912863e-05 + -0.0001440169343134101i, 0.12827554836749022 + 1.1756817307889689e-18i, 0.0006568096657314659 + -6.551504683092877e-06i }, { -4.1793420433344485e-06 + 2.2185769263592688e-06i, 1.0119688157699752e-05 + 1.9149718655348856e-05i, -8.352918774158727e-06 + 2.7190590322944058e-06i, -3.2632483705010353e-05 + 1.2144289798299078e-05i, 7.546528357025319e-06 + -0.00017293616883768626i, -0.003698730375961265 + 0.008508206707075189i, 0.0006568096657314656 + 6.551504683094644e-06i, 0.12810992918939912 + 8.334804200982315e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, true, true, true, false}), ElementsAreArray({ DoubleNear(0.12175795320492622, 1.0e-7), DoubleNear(0.12155219997985511, 1.0e-7), DoubleNear(0.12847678712903599, 1.0e-7), DoubleNear(0.12824023919661945, 1.0e-7), DoubleNear(0.12192791569243372, 1.0e-7), DoubleNear(0.12165942724023684, 1.0e-7), DoubleNear(0.12827554836749022, 1.0e-7), DoubleNear(0.12810992918939912, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, true, true, false, true}), Matrix({ { 0.12515295010812438 + -1.8058742435461683e-18i, 0.00077012153428511 + -1.733565322133885e-05i, -0.005122535663198929 + -0.008374666396144446i, 9.555870526970126e-05 + 0.00020291598565628133i, -0.004420086377327532 + 0.004465766972266758i, 8.894650194861037e-05 + -0.00011552473535370839i, 0.0014187867904528729 + -0.0027470902788141382i, 2.4020865786095144e-06 + 0.00011340615865513198i }, { 0.0007701215342851099 + 1.73356532213406e-05i, 0.12488094564201878 + 8.004461351553138e-19i, 8.563133359258194e-05 + 0.00018481355444820396i, -0.005070805220551405 + -0.00840766272780094i, 9.323055869433607e-05 + -0.00012344476308712203i, -0.004395109601340045 + 0.004506026739842996i, -3.677047680473092e-05 + 0.0001221530469517597i, 0.0013833384674539497 + -0.0029036130496678057i }, { -0.005122535663198929 + 0.008374666396144448i, 8.563133359258184e-05 + -0.00018481355444820404i, 0.1230392161323729 + -1.3552527156068805e-19i, 0.0007797057477885656 + -1.2715859122894993e-05i, -0.0012317396705758875 + -0.010411140662993985i, -1.582254225807896e-05 + 0.0001478217789745015i, -0.0014542449132456299 + -0.0052582450623041704i, 2.5291340546232038e-06 + 9.746555951334592e-05i }, { 9.55587052697012e-05 + -0.00020291598565628138i, -0.005070805220551405 + 0.008407662727800939i, 0.0007797057477885654 + 1.271585912289671e-05i, 0.12281593782169999 + -4.607859233063394e-19i, 2.459701871194666e-05 + 0.00014118667890791295i, -0.0011889128541398971 + -0.010236924764367541i, 1.5822701409920405e-05 + 7.227657706922292e-05i, -0.0013727707638876642 + -0.005204131933089187i }, { -0.004420086377327532 + -0.004465766972266757i, 9.323055869433616e-05 + 0.000123444763087122i, -0.001231739670575886 + 0.010411140662993985i, 2.459701871194655e-05 + -0.000141186678907913i, 0.11853291878923555 + 8.402566836762659e-19i, 0.0008660337575229812 + -1.028715086004292e-05i, 0.00042481302523129623 + -0.007985732999037619i, -1.8787841425120553e-05 + 0.00012855706432794692i }, { 8.894650194861041e-05 + 0.0001155247353537083i, -0.004395109601340042 + -0.004506026739842997i, -1.5822542258079058e-05 + -0.00014782177897450151i, -0.0011889128541398978 + 0.01023692476436754i, 0.0008660337575229812 + 1.0287150860044598e-05i, 0.11833068157807317 + -1.8973538018496328e-19i, -2.713438389480868e-07 + 0.00013478651730519442i, 0.00041533556899832434 + -0.00788589940325288i }, { 0.0014187867904528705 + 0.0027470902788141387i, -3.677047680473096e-05 + -0.0001221530469517597i, -0.001454244913245628 + 0.005258245062304171i, 1.5822701409920337e-05 + -7.227657706922292e-05i, 0.00042481302523129753 + 0.007985732999037619i, -2.713438389481935e-07 + -0.00013478651730519442i, 0.13371311936415334 + 1.2231155758352097e-18i, 0.0005480451418072722 + -8.873299846953962e-06i }, { 2.402086578609501e-06 + -0.00011340615865513191i, 0.0013833384674539488 + 0.0029036130496678074i, 2.529134054623175e-06 + -9.746555951334591e-05i, -0.0013727707638876636 + 0.005204131933089185i, -1.8787841425120617e-05 + -0.00012855706432794695i, 0.00041533556899832434 + 0.00788589940325288i, 0.0005480451418072722 + 8.873299846955782e-06i, 0.1335342305643186 + 2.913793338554793e-19i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, true, true, false, true}), ElementsAreArray({ DoubleNear(0.12515295010812438, 1.0e-7), DoubleNear(0.12488094564201878, 1.0e-7), DoubleNear(0.1230392161323729, 1.0e-7), DoubleNear(0.12281593782169999, 1.0e-7), DoubleNear(0.11853291878923555, 1.0e-7), DoubleNear(0.11833068157807317, 1.0e-7), DoubleNear(0.13371311936415334, 1.0e-7), DoubleNear(0.1335342305643186, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, true, false, true, true}), Matrix({ { 0.12705602187451334 + -7.487771253728015e-19i, 0.0008056970271923293 + -2.109659946518792e-06i, 2.2026147863493658e-05 + 7.098769444947702e-06i, -2.2759730343405103e-06 + 3.3607160354185805e-06i, -0.00234820746328272 + 0.000663589464464862i, 4.4774527243509216e-05 + -7.542252220269135e-06i, -8.326423222956854e-05 + -4.2593552350965005e-05i, -5.9779629312767965e-06 + -7.697430546424961e-06i }, { 0.0008056970271923295 + 2.1096599465205683e-06i, 0.12690726671061067 + -4.701032857261367e-19i, 1.020614507815799e-06 + 2.024551578454153e-06i, 2.0705508561145225e-05 + 4.432890479509474e-06i, 8.940931288101622e-05 + -6.3055865838610416e-06i, -0.002385594541540379 + 0.000855063070829673i, -4.967556808061838e-06 + -7.965700653616324e-06i, -8.112956000914034e-05 + -4.226661892231473e-05i }, { 2.2026147863493668e-05 + -7.098769444947673e-06i, 1.020614507815801e-06 + -2.024551578454155e-06i, 0.12113614436598394 + -1.1926223897340549e-18i, 0.0007441302548813462 + -2.794185239771505e-05i, -3.81220449385646e-05 + -1.1918482786913153e-05i, 4.612110602161405e-06 + -3.5697289868437937e-06i, -0.0035261238272904422 + -0.001456067554502275i, 4.6701108759724356e-05 + -1.0516923620093336e-05i }, { -2.2759730343405124e-06 + -3.3607160354185792e-06i, 2.0705508561145235e-05 + -4.432890479509474e-06i, 0.0007441302548813458 + 2.7941852397716744e-05i, 0.12078961675310809 + 8.097634975751111e-19i, 2.2721002235555734e-06 + -2.0997537620860217e-06i, -3.5331390993524386e-05 + -1.1034371774443438e-05i, 1.9643947223240255e-05 + -4.4862599434038083e-05i, -0.00338228582368733 + -0.0015531682640758649i }, { -0.002348207463282722 + -0.000663589464464862i, 8.94093128810163e-05 + 6.305586583861008e-06i, -3.812204493856463e-05 + 1.191848278691315e-05i, 2.2721002235555726e-06 + 2.0997537620860246e-06i, 0.12317871845944887 + -2.236166980751353e-19i, 0.0006790247167796284 + -2.135636095720311e-05i, -1.9036700717656546e-05 + -1.1779407055181476e-05i, -6.556470407959001e-06 + -3.88892216799006e-06i }, { 4.477452724350923e-05 + 7.542252220269115e-06i, -0.0023855945415403763 + -0.0008550630708296751i, 4.612110602161404e-06 + 3.5697289868437954e-06i, -3.533139099352442e-05 + 1.1034371774443435e-05i, 0.0006790247167796287 + 2.135636095720481e-05i, 0.12288517246586389 + -9.0801931945661e-19i, -7.97971160567962e-06 + -3.932879950347734e-06i, -2.023223230842639e-05 + -1.0483843615383176e-05i }, { -8.326423222956855e-05 + 4.259355235096503e-05i, -4.9675568080618416e-06 + 7.965700653616322e-06i, -0.003526123827290439 + 0.0014560675545022765i, 1.9643947223240194e-05 + 4.486259943403808e-05i, -1.9036700717656573e-05 + 1.1779407055181464e-05i, -7.979711605679622e-06 + 3.932879950347733e-06i, 0.12906731969394003 + 2.286988957586611e-18i, 0.0007350541825506251 + 2.1959102502062273e-06i }, { -5.9779629312768e-06 + 7.697430546424961e-06i, -8.112956000914034e-05 + 4.2266618922314703e-05i, 4.6701108759724356e-05 + 1.0516923620093275e-05i, -0.0033822858236873293 + 0.001553168264075862i, -6.556470407959001e-06 + 3.888922167990061e-06i, -2.0232232308426367e-05 + 1.0483843615383155e-05i, 0.0007350541825506247 + -2.1959102502044315e-06i, 0.12897973967652787 + 1.009663273127126e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, true, false, true, true}), ElementsAreArray({ DoubleNear(0.12705602187451334, 1.0e-7), DoubleNear(0.12690726671061067, 1.0e-7), DoubleNear(0.12113614436598394, 1.0e-7), DoubleNear(0.12078961675310809, 1.0e-7), DoubleNear(0.12317871845944887, 1.0e-7), DoubleNear(0.12288517246586389, 1.0e-7), DoubleNear(0.12906731969394003, 1.0e-7), DoubleNear(0.12897973967652787, 1.0e-7) }));

    EXPECT_EQ(s.getReducedDensityMatrix({false, false, false, false, false, true, true, true}), Matrix({ { 0.127617090142342 + -4.734914175151539e-19i, -0.003516737048391004 + -0.009845454599280278i, 2.783142908208044e-05 + 4.092596862889257e-05i, -1.45484818470128e-05 + 2.186924849518558e-05i, -0.005211774130651531 + 0.006522839664584614i, -0.001831030434788805 + -0.0015358146858072328i, -3.7174246937123952e-06 + -6.729836613670902e-05i, 2.043180475493803e-07 + 0.00011783289397300053i }, { -0.0035167370483910046 + 0.00984545459928028i, 0.12634619844278203 + -7.453889935837843e-19i, -4.900300143038295e-05 + -5.112883943799102e-05i, 1.4900227342558444e-05 + -2.9394308704435397e-05i, 0.00037170430732114406 + -0.012516871544332958i, 0.0004779721258284322 + -0.005004187129290079i, -2.785474893842784e-05 + -5.6452053342993286e-05i, -0.0001606763675449965 + -1.756180513657071e-05i }, { 2.7831429082080446e-05 + -4.092596862889254e-05i, -4.9003001430382964e-05 + 5.112883943799102e-05i, 0.12241680560780117 + -5.319366908757006e-19i, -0.006676603835359329 + -0.006936874524665107i, -5.6667645337148985e-05 + 3.9858180806345695e-05i, 6.807050408496977e-05 + 0.00012338689667976949i, -0.003603421848016046 + 0.002448954047525139i, 0.004633155692695628 + -0.004114888642674711i }, { -1.4548481847012784e-05 + -2.1869248495185604e-05i, 1.4900227342558461e-05 + 2.9394308704435397e-05i, -0.00667660383535933 + 0.006936874524665107i, 0.11950895551129084 + 1.4907779871675686e-19i, 2.7877678914671448e-05 + -0.0001176565453908632i, -1.678579059494e-05 + -6.281103536770229e-05i, -0.0027923568320369287 + -0.008131193883028569i, -0.0033049878029617263 + -0.005458189866103278i }, { -0.005211774130651531 + -0.0065228396645846155i, 0.0003717043073211458 + 0.012516871544332958i, -5.6667645337149026e-05 + -3.9858180806345695e-05i, 2.7877678914671404e-05 + 0.00011765654539086315i, 0.11569306304243934 + -7.860465750519907e-19i, 0.0016809749091184277 + -0.005754081935712382i, 3.921026963275082e-05 + -2.7458473025403173e-05i, 3.317588510220674e-05 + -5.953968163786922e-05i }, { -0.001831030434788806 + 0.001535814685807234i, 0.00047797212582843286 + 0.005004187129290078i, 6.807050408496983e-05 + -0.00012338689667976946i, -1.678579059494002e-05 + 6.281103536770228e-05i, 0.001680974909118429 + 0.005754081935712382i, 0.1303708278828734 + -3.4558944247975454e-19i, 3.8223621671946956e-05 + 6.804323640023372e-05i, -7.847920265883376e-05 + 5.195222354838521e-06i }, { -3.7174246937124062e-06 + 6.729836613670902e-05i, -2.7854748938427888e-05 + 5.645205334299327e-05i, -0.003603421848016044 + -0.002448954047525139i, -0.0027923568320369296 + 0.008131193883028569i, 3.921026963275082e-05 + 2.745847302540315e-05i, 3.822362167194697e-05 + -6.804323640023372e-05i, 0.12117053732486938 + 1.4365678785432934e-18i, -0.0008408263148888071 + -0.010117550466578116i }, { 2.0431804754944807e-07 + -0.00011783289397300053i, -0.00016067636754499648 + 1.7561805136570712e-05i, 0.004633155692695626 + 0.004114888642674712i, -0.0033049878029617246 + 0.005458189866103278i, 3.317588510220673e-05 + 5.953968163786922e-05i, -7.847920265883376e-05 + -5.195222354838532e-06i, -0.0008408263148888071 + 0.010117550466578116i, 0.13687652204559853 + 1.8600843521704435e-18i } }));

    EXPECT_THAT(s.getReducedDensityMatrixDiagonal({false, false, false, false, false, true, true, true}), ElementsAreArray({ DoubleNear(0.127617090142342, 1.0e-7), DoubleNear(0.12634619844278203, 1.0e-7), DoubleNear(0.12241680560780117, 1.0e-7), DoubleNear(0.11950895551129084, 1.0e-7), DoubleNear(0.11569306304243934, 1.0e-7), DoubleNear(0.1303708278828734, 1.0e-7), DoubleNear(0.12117053732486938, 1.0e-7), DoubleNear(0.13687652204559853, 1.0e-7) }));


}
}

}
